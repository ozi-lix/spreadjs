(function(t){function a(o){if(l[o])return l[o].exports;var p=l[o]={i:o,l:!1,exports:{}};return t[o].call(p.exports,p,p.exports,a),p.l=!0,p.exports}var l={};return a.m=t,a.c=l,a.i=function(o){return o},a.d=function(o,p,g){a.o(o,p)||Object.defineProperty(o,p,{configurable:!1,enumerable:!0,get:g})},a.n=function(o){var p=o&&o.__esModule?function(){return o['default']}:function(){return o};return a.d(p,'a',p),p},a.o=function(o,p){return Object.prototype.hasOwnProperty.call(o,p)},a.p='',a(a.s=24)})([function(t,a,l){'use strict';var o=l(17);l.d(a,'a',function(){return p});var p=GC.Spread.Sheets.Designer.getResources();for(var g in o.a)p[g]=o.a[g]},function(t,a){'use strict';function o(y){if(GC.Spread.Sheets.TableSheet&&GC.Spread.Sheets.TableSheet.TableSheet)return y instanceof GC.Spread.Sheets.TableSheet.TableSheet}a.b=o,a.c=function(y){let C=new GC.Spread.Sheets.Worksheet(y.name());try{C.suspendPaint(),C.suspendCalcService(),C.suspendDirty(),C.suspendEvent(),C.fromJSON(y.applyFreeHeaderArea());let M=y.getSelections(GC.Spread.Sheets.SheetArea.colHeader);if(M.length&&0<M.length){let b=M[0];C.setSelection(b.row,b.col,b.rowCount,b.colCount)}}catch(M){}return C},a.a=function(y){let C=y.getActiveSheet();if(!C){let M=y.getActiveSheetTab();!o(M)&&M&&M.getSheet&&(C=M.getSheet())}return C},a.g=function(y){let C=y&&y.slicers.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.h=function(y){let C=y&&y.pictures.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.i=function(y){let C=y&&y.charts.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.f=function(y){let C=y&&y.shapes.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.d=function(y){return GC.Spread.Report&&GC.Spread.Report.ReportSheet&&y instanceof GC.Spread.Report.ReportSheet},a.e=function(y){let C=y.getActiveSheetTab();return o(C)?y.getActiveSheet()||C:C&&C.getSheet?C.getSheet():y.getActiveSheet()}},function(t,a,l){'use strict';var o=l(0),p=l(1);l.d(a,'a',function(){return u});let g;var u;(function(m){m.runCommand=function(f,F,y,C){let M=f.commandManager(),b='Designer.'+F;M.getCommand(b)||M.register(b,y,void 0,!1,!1,!1,!1);let D=l.i(p.e)(f)||l.i(p.a)(f);if(D=D,!C.sheetName){let v;v=D?D.name():f.getActiveSheetTab()&&f.getActiveSheetTab().name(),C.sheetName=v}else D=f.getSheetFromName(C.sheetName);if(l.i(p.b)(D)?!C.selections&&(C.selections=D&&D.getSelections(GC.Spread.Sheets.SheetArea.colHeader)):(!C.selections&&(C.selections=D&&D.getSelections()),C.activeRowIndex===g&&(C.activeRowIndex=D&&D.getActiveRowIndex()),C.activeColIndex===g&&(C.activeColIndex=D&&D.getActiveColumnIndex())),!C.selections)if(D)C.selections=D.getSelections();else{let v=f.getActiveSheetTab();l.i(p.b)(v)&&(C.selections=v&&v.getSelections(GC.Spread.Sheets.SheetArea.colHeader))}return C.cmd=b,M.execute(C)};m.DesignerActionBase=class{constructor(f,F){this._spread=f,this._sheet=f.getSheetFromName(F.sheetName)||f.getSheetTab(F.sheetName)}canExecute(){return!0}spread(){return this._spread}sheet(){return this._sheet}undoImp(f,F){return f.suspendPaint(),GC.Spread.Sheets.Commands.undoTransaction(f,F),f.resumePaint(),!0}execute(f,F,y){let C=this,M=!1;if(y)M=C.undoImp.call(C,f,F,y);else if(C.canExecute()){let b=GC.Spread.Sheets.Commands;b.startTransaction(f,F),f.suspendPaint();try{M=C.executeImp(f,F,y)}finally{f.resumePaint(),b.endTransaction(f,F)}}return void 0===M||!1===M||'designer.changeShapeStyle'===F.cmd||'designer.insertShape'===F.cmd,M}execInSelections(f,F,y){let C,M,b=F.selections;for(let D=0;D<b.length;D++){let v=b[D],H=v.col,T=v.row,E=v.rowCount,B=v.colCount;if(-1===H&&-1===T)y(f,-1,-1);else if(-1===T)for(C=0;C<B;C++)y(f,-1,H+C);else if(-1===H)for(C=0;C<E;C++)y(f,T+C,-1);else for(C=0;C<E;C++)for(M=0;M<B;M++)y(f,T+C,H+M)}}execInSelectionsForSetStyle(f,F,y){let C,M,b=F.selections;for(let D=0;D<b.length;D++){let P,A,v=b[D],H=v.col,T=v.row,E=v.rowCount,B=v.colCount;if(!(-1===H||-1===T))for(C=0;C<E;C++)for(M=0;M<B;M++)y(f,T+C,H+M);else if(-1===H&&-1===T){for(P=0;P<E;P++)y(f,P,-1);for(A=0;A<B;A++)y(f,-1,A);for(P=0;P<E;P++)for(A=0;A<B;A++)y(f,P,A)}else if(-1===H){for(P=0;P<E;P++)y(f,P+T,-1);for(P=0;P<E;P++)for(A=0;A<B;A++)y(f,P+T,A)}else if(-1===T){for(A=0;A<B;A++)y(f,-1,A+H);for(P=0;P<E;P++)for(A=0;A<B;A++)y(f,P,A+H)}}}execInSelectionsForRow(f,F,y){let C=F.selections;for(let M=0;M<C.length;M++){let b=C[M],D=-1===b.row?0:b.row;for(let v=0;v<b.rowCount;v++)y(f,D+v)}}execInSelectionsForCol(f,F,y){let C=F.selections;for(let M=0;M<C.length;M++){let b=C[M],D=-1===b.col?0:b.col;for(let v=0;v<b.colCount;v++)y(f,D+v)}}execInSelectionsForCell(f,F,y){let C=F.selections;for(let M=0;M<C.length;M++){let b=C[M],D=-1===b.col?0:b.col,v=-1===b.row?0:b.row;for(let H=0;H<b.rowCount;H++)for(let T=0;T<b.colCount;T++)y(f,v+H,D+T)}}getActualFont(f,F,y){let C=f.getStyle(F,y),M=C?C.font:'14.6667px Calibri',b=f.getActualStyle(F,y).font;return M===b?b||o.a.defaultFont:M||o.a.defaultFont}clearSpansInSelection(f,F){if(f&&F){let y=[],C=F.row,M=F.col,b=F.rowCount,D=F.colCount;f.getSpans().forEach(function(v){v.intersect(C,M,b,D)&&y.push(v)}),y.forEach(function(v){f.removeSpan(v.row,v.col)})}}getKey(f,F){return[f,F].join(',')}getPosition(f){let F=f&&f.split(',');return F&&2===F.length?{row:+F[0],column:+F[1]}:null}setFontStyle(f,F,y,C,M,b){let D=this;F.font||(F.font=D.getActualFont(f,M,b));let v=document.createElement('span');v.style.font=F.font,'font-family'===y&&D.needAddDoubleQuotes(C)&&(C='"'+C+'"'),v.style[y]=C,F.font=v.style.font,f.setStyle(M,b,F)}needAddDoubleQuotes(f){if('string'==typeof f){let F=f.trim(),y=F[0],C=F[F.length-1];return-1<F.indexOf(' ')&&('"'!==y||'"'!==C)}}undoSetStyle(f,F){let y=this,C=y._sheet,M=y._spread,b=F._styles;if(b){M.suspendPaint();for(let D of Object.keys(b)){let v=y.getPosition(D),H=b[D];if(v){let T=v.row,E=v.column,B=C.getStyle(T,E);B[f]='backColor'===f?H||void 0:H,C.setStyle(T,E,B)}}M.resumePaint()}return!0}setStyle(f,F,y,C,M,b){let D=this,v=D._sheet,H=D._spread,T=v,E=l.i(p.b)(v);E?T=l.i(p.c)(v):l.i(p.d)(v)&&v.getSheet&&(T=v.getSheet()),C._styles={},H.suspendPaint(),D.execInSelectionsForSetStyle(T,C,function(B,P,A){let O=B.getStyle(P,A);O||(O=new GC.Spread.Sheets.Style),C._styles[D.getKey(P,A)]=O[F],M&&(y=M.apply(D,[B,P,A,O,y].concat(b||[])),O[F]=y,B.setStyle(P,A,O)),0<=['font-size','font-weight','font-style'].indexOf(f)?D.setFontStyle(B,O,f,y,P,A):'font-family'===f?(O.themeFont=g,D.setFontStyle(B,O,f,y,P,A)):(O[F]=y,B.setStyle(P,A,O),'wordWrap'===F&&D._sheet.defaults.rowHeight===D._sheet.getRowHeight(P)&&B.autoFitRow(P))}),H.resumePaint(),E&&v.applyFreeHeaderArea(T.toJSON())}getTextDecoration(f,F,y,C,M,b){let D=this;C.textDecoration||(C.textDecoration=D.getActualDecoration(f,F,y));let v=C.textDecoration||GC.Spread.Sheets.TextDecorationType.none;return M?1==(1&v)&&8==(8&b)?(v^=1,v|=8):8==(8&v)&&1==(1&b)?(v^=8,v|=1):v|=b:v^=b,v}getActualDecoration(f,F,y){return l.i(p.b)(f)&&(f=l.i(p.c)(f)),f.getActualStyle(F,y).textDecoration}}})(u||(u={}))},function(t,a,l){'use strict';var o=l(8),p=l(0);l.d(a,'i',function(){return g}),l.d(a,'a',function(){return u}),l.d(a,'b',function(){return m}),l.d(a,'h',function(){return x}),l.d(a,'e',function(){return S}),l.d(a,'c',function(){return f}),l.d(a,'g',function(){return F}),l.d(a,'d',function(){return y}),l.d(a,'f',function(){return C});let g={ClickViewport:'ClickViewport',ClickCorner:'ClickCorner',ClickColHeader:'ClickColHeader',ClickRowHeader:'ClickRowHeader',PivotTableSelected:'PivotTableSelected',TableSheetClickCorner:'TableSheetClickCorner',TableSheetClickViewport:'TableSheetClickViewport',TableSheetClickRowHeader:'TableSheetClickRowHeader',TableSheetClickColHeader:'TableSheetClickColHeader',GanttSheetClickRowHeader:'GanttSheetClickRowHeader',GanttSheetClickColHeader:'GanttSheetClickColHeader',GanttSheetClickFields:'GanttSheetClickFields'},u={type:'groupHeader',text:'${res.contextMenu.paste}',commandName:'designer.pasteElectron',iconClass:'gc-spread-pasteOptions',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`},m={commandName:'designer.pasteAllElectron',iconClass:'gc-spread-pasteAll',group:'designer.pasteElectron',text:'${res.contextMenu.pasteAll}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader} `,execute:o.b.execute},x={commandName:'designer.tableSheetPasteElectron',iconClass:'gc-spread-pasteOptions',text:'${res.contextMenu.tableSheetPaste}',visibleContext:`${g.TableSheetClickCorner} || ${g.TableSheetClickViewport} || ${g.TableSheetClickRowHeader} || ${g.TableSheetClickColHeader}`,execute:o.d.execute},S={commandName:'designer.pasteFormattingElectron',iconClass:'gc-spread-pasteFormatting',group:'designer.pasteElectron',text:'${res.contextMenu.pasteFormatting}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.e.execute},f={commandName:'designer.pasteFormulasElectron',iconClass:'gc-spread-pasteFormula',group:'designer.pasteElectron',text:'${res.contextMenu.pasteFormula}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.c.execute},F={commandName:'designer.pasteFormulasAndFormattingElectron',iconClass:'gc-spread-pasteFormulaFormatting',group:'designer.pasteElectron',text:'${res.contextMenu.pasteFormulaFormatting}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.g.execute},y={commandName:'designer.pasteValuesElectron',iconClass:'gc-spread-pasteValues',group:'designer.pasteElectron',text:'${res.contextMenu.pasteValue}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader}  || ${g.ClickRowHeader}`,execute:o.d.execute},C={commandName:'designer.pasteValuesAndFormattingElectron',iconClass:'gc-spread-pasteValuesFormatting',group:'designer.pasteElectron',text:'${res.contextMenu.pasteValuesFormatting}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.f.execute}},function(t,a,l){'use strict';function o(v,H){let T=window.osenv;try{let E=T.getSystemFonts();E?(H.length=0,E.forEach((B)=>{B&&H.push({text:B.fontLocalizedName,value:B.fontOriginName})})):p(H)}catch(E){p(H)}}function p(v){let H=x.a.ribbon.fontFamilies,T='ff',E=1,B=T+E;for(;H[B];)v.push({text:H[B].text,value:H[B].name}),E++,B=T+E}function g(v,H=!0){let T=null,E=null,B='',P='normal',A='normal',O='normal',N=v.split(/\s+/);for(let _=0;_<N.length;_++)switch(N[_]){case'normal':break;case'italic':B=-1===B.indexOf('bold')?N[_]:'bold italic';break;case'bold':B=-1===B.indexOf('italic')?N[_]:'bold italic',P='bold';break;case'small-caps':A=N[_];break;case'100':case'200':case'300':case'400':case'500':case'600':case'700':case'800':case'900':P=N[_];break;default:if(!E){let R=N[_].split('/');E=R[0],-1!==E.indexOf('px')&&H&&(E=u(parseFloat(E))+'pt'),1<R.length&&(O=R[1],-1!==O.indexOf('px')&&H&&(O=u(parseFloat(O))+'pt'));break}T?T+=' '+N[_]:T=N[_];}return B||(B='normal'),{fontStyle:B,fontVariant:A,fontWeight:P,fontSize:E,lineHeight:O,fontFamily:T}}function u(v){if(null==M){let H=document.createElement('span');H.style.fontSize='96pt',H.style.display='none',document.body.appendChild(H);try{M=window.getComputedStyle(H).fontSize}finally{document.body.removeChild(H)}}if(M&&-1!==M.indexOf('px')){let H=parseFloat(M);return Math.round(96*v/H)}return Math.round(72*v/96)}function m(v,H){S.a.runCommand(v,'setFontFamily',b,{value:H})}var x=l(0),S=l(2),f=l(1);l.d(a,'a',function(){return C});const y={Trial:3,Valid:0,Expired:1,Unlicensed:2,Invalid:4};a.b=y;let C={title:'${res.ribbon.home.fontFamily}',type:'comboBox',text:'Calibri',comboWidth:100,commandName:'fontFamilyNative',dropdownList:[],dropdownMaxHeight:500,enableContext:'AllowFormatCells',execute:async(v,H)=>{null!==H&&H!==void 0&&m(v.Spread,H)},getState:(v,H)=>{let T=window.osenv,E=T._ms[2]&&T._ms[2]();v.setData('fileMenuShow',E===y.Expired||E===y.Invalid||E===y.Unlicensed),v.setData('activeShow',E===y.Expired||E===y.Invalid||E===y.Unlicensed||E===y.Trial);let B=v.Spread.getActiveSheet()||v.Spread.getActiveSheetTab();if(B&&(l.i(f.b)(B)?B=l.i(f.c)(B):l.i(f.d)(B)&&B.getSheet&&(B=B.getSheet()),!!B)){let P=B.getActualStyle(B.getActiveRowIndex(),B.getActiveColumnIndex()),A='';if(P&&P.font){let O=g(P.font);if(O.fontFamily){let N=O.fontFamily.split(','),_=N[0];_.match(/^["'].*["']$/)&&(_=_.substring(1,_.length-1));let R=new RegExp('^(.*,s*)?["\']?'+_+'["\']?s*(,.*)?$');for(let L in x.a.ribbon.fontFamilies)if(R.test(x.a.ribbon.fontFamilies[L].name)){_=x.a.ribbon.fontFamilies[L].text;break}A=_}}else{let O=g(x.a.defaultFont);A=O.fontFamily||''}return H&&o(v,H.dropdownList),A}}},M=null,b={canUndo:!0,execute:function(v,H,T){let E=new D(v,H);return E.execute(v,H,T)}};class D extends S.a.DesignerActionBase{executeImp(v,H){let E=this;E.setStyle('font-family','font',H.value,H)}}},function(t,a,l){'use strict';function o(S){let y,F=[];for(let C=0;C<arguments.length-1;C++)F[C]=arguments[C+1];return 1<F.length?S.replace(/{(1)}/gm,F[0]).replace(/{(2)}/gm,F[1]):(y=/{(\d+)}/gm,S.replace(y,function(C,M){return F[~~M]}))}var p=l(0),g=l(4);l.d(a,'a',function(){return m});const u='zh-cn';let m={title:p.a.ribbon.accessBar.active,commandName:'activeElectron',iconClass:'gc-accessbar-active',execute:(S)=>{let F=window.osenv;F&&F._hasOpenedActiveDialog&&GC.Spread.Sheets.Designer.closeDialog('activeDialogTemplate');var y=window._ssCulture,C=S.getWorkbook();let M=F._ms[2]&&F._ms[2](),b='',D='',v=!1;switch(M){case g.b.Unlicensed:b=p.a.L.f,D=p.a.B&&p.a.B.n,v=!0;break;case g.b.Trial:let A=F._ms[0]&&F._ms[0]();b=A.h?o(p.a.L.t,F._ls.n)+'\r\n'+o(p.a.L.d,-1===C.ls.m?p.a.L.T[1]:p.a.L.T[2],F._ls.d):p.a.L.f;break;case g.b.Expired:b=p.a.L.e,D=p.a.B&&p.a.B.e,v=!0;break;case g.b.Invalid:b=p.a.L.i;}if(v&&y===u){var H=document.querySelector('.gc-lc-invalid-ss-container'),T=C.getHost();if(T&&!H){H=document.createElement('div'),H.classList.add('gc-lc-invalid-ss-container'),H.style.width=T.offsetWidth+'px',H.style.height=T.offsetHeight+120+'px',H.innerText=D,T.parentElement&&T.parentElement.appendChild(H),T.style.display='none';var E=S.getData('container'),B=E&&E.querySelector('.ribbon-panel');B&&B.classList.add('gc-lc-invalid-ribbon-panel')}}if(GC.Spread.Sheets.Designer.registerTemplate('activeDialogTemplate',x(b,y)),F._hasOpenedActiveDialog=!0,GC.Spread.Sheets.Designer.showDialog('activeDialogTemplate',void 0,(A)=>{let O=window.osenv;F._hasOpenedActiveDialog=!1,A&&A.licenseKey&&A.licenseKey.trim()&&O._ms[1]&&(O._ms[1](A.licenseKey),GC.Spread.Sheets.Designer.showMessageBox(p.a.L.U,p.a.L.l,GC.Spread.Sheets.Designer.MessageBoxIcon.info,()=>{O.restartApp()},void 0,GC.Spread.Sheets.Designer.MessageBoxButtons.ok))}),y===u){var P=document.getElementById('openWebLink');P&&(P.onclick=function(A){A.preventDefault(),window.open('https://www.grapecity.com.cn/developer/spreadjs/register?pid=615')})}},visibleContext:'activeShow'},x=function(S,f){var F={templateName:'activeDialogTemplate',title:p.a.L.l,content:[{type:'FlexContainer',children:[{type:'TextBlock',text:S,margin:'5px 0'},{type:'TextBlock',text:p.a.L.k,margin:'5px 0'},{type:'TextEditor',multiLine:!0,style:'height:170px',bindingPath:'licenseKey',margin:'5px 0'}]}],width:'550px'};if(f===u&&p.a.B){var y={type:'TextBlock',text:'<span style=\'font-size: large;font-weight: 900;\'>'+p.a.B.l+'</span>',style:'text-align: center;margin-top: 10px;margin-bottom:10px;',useRawContent:!0},C={type:'TextBlock',text:'<button type=\'button\' id=\'openWebLink\' style=\'width:120px;text-align:center;position:relative;left:35%;height:33px;background:rgb(148,25,102);border:none;cursor:pointer;color:white;border-radius:3px\'>'+p.a.B.b+'</button>',useRawContent:!0};F.content[0].children.splice(1,0,y),F.content[0].children.splice(2,0,C)}return F}},function(t,a,l){'use strict';function o(y){let C=y.Spread,M=l.i(m.a)(C);if(l.i(m.f)(M))g(C);else if(l.i(m.g)(M)||l.i(m.h)(M)||l.i(m.i)(M))p(C);else{let b=window.osenv;u(C,function(v,H){b.setClipboardData({text:v,html:H})})}}function p(y){y.commandManager().execute({cmd:'copyFloatingObjects',sheetName:l.i(m.a)(y).name()})}function g(y){y.commandManager().execute({cmd:'copyShapes',sheetName:l.i(m.a)(y).name()})}function u(y,C){x.a.runCommand(y,'copy',F,{callback:C})}var m=l(1),x=l(2);l.d(a,'a',function(){return S});let S={title:'${res.ribbon.home.copy}',iconClass:'ribbon-button-copy',commandName:'copyElectron',execute:(y)=>{o(y)}};class f extends x.a.DesignerActionBase{executeImp(y,C){let D=C.sheetName,v={};v.cmd='copy',v.sheetName=D,v.ignoreClipboard=!0,v.callback=function(){C.callback(v.copyData.copyText,v.copyData.copyHtml)},y.commandManager().execute(v)}}let F={canUndo:!1,execute:function(y,C,M){let b=new f(y,C);return b.execute(y,C,M)}}},function(t,a,l){'use strict';function o(y){let C=y.Spread,M=l.i(m.a)(C);if(l.i(m.f)(M))g(C);else if(l.i(m.g)(M)||l.i(m.h)(M)||l.i(m.i)(M))p(C);else{u(C,function(D,v){let H=window.osenv;H.setClipboardData({text:D,html:v})})}}function p(y){y.commandManager().execute({cmd:'cutFloatingObjects',sheetName:l.i(m.a)(y).name()})}function g(y){y.commandManager().execute({cmd:'cutShapes',sheetName:l.i(m.a)(y).name()})}function u(y,C){x.a.runCommand(y,'cut',f,{callback:C})}var m=l(1),x=l(2);l.d(a,'a',function(){return S});let S={title:'${res.ribbon.home.cut}',iconClass:'ribbon-button-cut',commandName:'cutElectron',enableContext:'!IsIncludeLockedCell',execute:(y)=>{o(y)}},f={canUndo:!1,execute:function(y,C,M){let b=new F(y,C);return b.execute(y,C,M)}};class F extends x.a.DesignerActionBase{executeImp(y,C){let D=C.sheetName,v={};v.cmd='cut',v.sheetName=D,v.ignoreClipboard=!0,v.callback=function(){C.callback(v.cutData.copyText,v.cutData.copyHtml)},y.commandManager().execute(v)}}},function(t,a,l){'use strict';function o(H,T){let E,B=window.osenv,P=B.getClipboardText(),A=B.getClipboardHTML();if(E='',P){let O='"',N=O.length,_=!1;for(let L,R=0;R<P.length;R++)L=P[R],!_&&'\n'===L&&P[R-1]&&'\r'!==P[R-1]&&(L='\r\n'),E+=L,E.length>=N&&O===E.substr(E.length-N,N)&&(_=!_)}T===M.All?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.all,E,A):T===M.Formatting?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.formatting,E,A):T===M.Formulas?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.formulas,E,A):T===M.FormulasAndFormatting?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.formulasAndFormatting,E,A):T===M.Values?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.values,E,A):T===M.ValuesAndFormatting?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.valuesAndFormatting,E,A):void 0}function p(H,T,E,B){u.a.runCommand(H,'paste',D,{value:T,text:E,html:B,isFromDesigner:!0})}var g=l(1),u=l(2);l.d(a,'a',function(){return m}),l.d(a,'b',function(){return x}),l.d(a,'e',function(){return S}),l.d(a,'c',function(){return f}),l.d(a,'g',function(){return F}),l.d(a,'f',function(){return y}),l.d(a,'d',function(){return C});let m={title:'${res.ribbon.home.paste}',text:'${res.ribbon.home.paste}',iconClass:'ribbon-button-paste',bigButton:!0,commandName:'pasteElectron',enableContext:'!IsIncludeLockedCell',subCommands:['paste-all-electron','paste-formulas-electron','paste-values-electron','paste-formatting-electron','paste-valuesAndFormatting-electron','paste-formulasAndFormatting-electron']},x={text:'${res.ribbon.home.all}',title:'${res.ribbon.home.all}',direction:'=IF(ribbonHeight>toolbarHeight, "vertical", "horizontal")',iconClass:'ribbon-button-paste',bigButton:'=ribbonHeight>toolbarHeight',commandName:'paste-all-electron',enableContext:`!IsIncludeLockedCell`,execute:(H)=>{o(H,M.All)}},S={text:'${res.ribbon.home.formatting}',commandName:'paste-formatting-electron',execute:(H)=>{o(H,M.Formatting)}},f={text:'${res.ribbon.home.formulas}',commandName:'paste-formulas-electron',execute:(H)=>{o(H,M.Formulas)}},F={text:'${res.ribbon.home.formulasAndFormatting}',commandName:'paste-formulasAndFormatting-electron',execute:(H)=>{o(H,M.FormulasAndFormatting)}},y={text:'${res.ribbon.home.valuesAndFormatting}',commandName:'paste-valuesAndFormatting-electron',execute:(H)=>{o(H,M.ValuesAndFormatting)}},C={text:'${res.ribbon.home.values}',commandName:'paste-values-electron',execute:(H)=>{o(H,M.Values)}};const M={All:'paste-all-electron',Formulas:'paste-formulas-electron',Values:'paste-values-electron',Formatting:'paste-formatting-electron',ValuesAndFormatting:'paste-valuesAndFormatting-electron',FormulasAndFormatting:'paste-formulasAndFormatting-electron'};let D={canUndo:!1,execute:function(H,T,E){let B=new v(H,T);return B.execute(H,T,E)}};class v extends u.a.DesignerActionBase{executeImp(H,T){let B=this,P=l.i(g.a)(H);if(P)if(P.isPasteFloatingObject&&P.isPasteFloatingObject())H.commandManager().execute({cmd:'pasteFloatingObjects',sheetName:P.name()});else if(P.isPasteShapes&&P.isPasteShapes())H.commandManager().execute({cmd:'pasteShapes',sheetName:P.name()});else{let A=T.text,O=T.html;H.commandManager().execute({cmd:'paste',sheetName:P.name(),pasteText:A,pasteHtml:O,isFromDesigner:T.isFromDesigner,pasteOption:T.value})}}}},function(t,a,l){'use strict';async function o(Y){return new Promise(($)=>{setTimeout(()=>{$()},Y)})}function p(Y,$){Y.getActiveSheet()?Y.bind('ClipboardStatusChanged',function(G,K){K.isReset&&!K.isSystemPasted&&$.setClipboardData({text:'',html:''})}):J.offAll()}function g(Y){let $=Y;if(Y&&'object'==typeof Y)for(let G in $={},Y)Y.hasOwnProperty(G)&&($[G]=Y[G]);return $}function u(){if(GC.Spread.Sheets.FormulaPanel){let Y=document.activeElement;if(Y.classList.contains('cm-content')){let $=document.querySelector('.gc-formula-editor-container');return $&&$.contains(Y)?GC.Spread.Sheets.FormulaPanel.findControl($):void 0}}}function m(Y,$){Y&&(!Y.docProps.coreDocProps&&(Y.docProps.coreDocProps={}),Y.docProps.coreDocProps.modified=$)}var x=l(16),S=l(4),f=l(20),F=l(8),y=l(3),C=l(19),M=l(7),b=l(14),D=l(6),v=l(13),H=l(22),T=l(21),E=l(5),B=l(11),P=l(12),A=l(10),O=l(15),N=l(23),_=l(0),R=l(1);let L='',V=!1,W=new x.a(window.gc_native_app);window.addEventListener('unload',function(){W.saveConfigFile()}),window.osenv=W;const I={currentFolder:'currentFolder',fileMenuSetting:'fileMenuSetting'};GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle=function(Y){let $,G=Y.getData('currentFilePath'),K=Y.getData('osEnv');!0===Y.getData('isFileModified')?G&&''!==G&&($=K.getFileInfo(G).fileName,Y.setData('modifiedFileName','* '+$+' - '+_.a.title),document.title=Y.getData('modifiedFileName')):''===G?document.title=_.a.title:($=K.getFileInfo(G).fileName,document.title=$+' - '+_.a.title,Y.setData('shouldModifiedHandlerExecute',!0))},GC.Spread.Sheets.Designer.FileMenuHandler.save=async function(Y,$,G){let K,X=Y.getData('isFirstImporting');return K=!Y.getData('currentFilePath')||Y.getData('isExcel')||X?await GC.Spread.Sheets.Designer.FileMenuHandler.saveAs(Y,void 0,$,G):await GC.Spread.Sheets.Designer.FileMenuHandler.saveCore(Y,Y.getData('currentFilePath'),{},$,!1),Promise.resolve(K)},GC.Spread.Sheets.Designer.FileMenuHandler.saveAs=async function(Y){let q,X=GC.Spread.Sheets.Designer.FileMenuHandler.getFileMenuOption(Y),Q=Y.getData('InternalSaveFileType');q='sjs'===Q?_.a.sjsFileFilter:'xlsx'===Q?_.a.excelFileFilter:'csv'===Q?_.a.csvFileFilter:_.a.spreadFileFilter;let Z={title:_.a.exportFileDialogTitle,nameFilters:[q]},ee=await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,Z,X);return L=Y.getData('currentFileNameInElectron'),L?(Y.setData('currentFilePath',L),Y.setData('isFileModified',!1),Y.getData('isFirstImporting')&&Y.getData('isExcel')&&Y.setData('isExcel',!1),Y.setData('isFirstImporting',!1)):Y.setData('currentFileNameInElectron',Y.getData('currentFilePath')),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle(Y),Promise.resolve(ee)},GC.Spread.Sheets.Designer.FileMenuHandler.onNewFile=async function(Y){if(Y.getData('isFileModified')){let $=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch($){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:let G=Y.getData('currentFilePath'),K=await GC.Spread.Sheets.Designer.FileMenuHandler.save(Y,!1),X=Y.getData('currentFilePath');K&&G===X&&(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore(Y));break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:Y.setData('isFileModified',!1),GC.Spread.Sheets.Designer.FileMenuHandler.resetCore(Y);break;case GC.Spread.Sheets.Designer.MessageBoxResult.cancel:}}else GC.Spread.Sheets.Designer.FileMenuHandler.resetCore(Y)},GC.Spread.Sheets.Designer.FileMenuHandler.exportJson=async function(Y,$){let G={title:_.a.exportFileDialogTitle,nameFilters:[_.a.spreadFileFilter]},K=await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,G,$);return Promise.resolve(K)},GC.Spread.Sheets.Designer.FileMenuHandler.exportJS=async function(Y,$){let G={title:_.a.exportFileDialogTitle,nameFilters:[_.a.ssJSONToJSFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.exportExcel=async function(Y,$){let G={title:_.a.exportFileDialogTitle,nameFilters:[_.a.excelFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.exportCsv=async function(Y,$){let G=$.exportCsvSetting;if(G&&!Y.Spread.sheets[G.sheetIndex]){let X=Y.getData('container');return GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),void(await GC.Spread.Sheets.Designer.showMessageBox(_.a.exportCsvSheetIndexError,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning,GC.Spread.Sheets.Designer.MessageBoxButtons.ok))}let K={title:_.a.exportFileDialogTitle,nameFilters:[_.a.csvFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,K,$)},GC.Spread.Sheets.Designer.FileMenuHandler.exportPdf=async function(Y,$){let G={title:_.a.exportFileDialogTitle,nameFilters:[_.a.pdfFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.export=async function(Y,$,G){let K=$,X=Promise.resolve(!1);K||(K={title:_.a.exportFileDialogTitle,nameFilters:[_.a.sjsFileFilter,_.a.spreadFileFilter,_.a.ssJSONToJSFilter,_.a.excelFileFilter,_.a.csvFileFilter,_.a.allFileFilter]}),m(Y.Spread,new Date);let q=Y.getData('osEnv'),Q=q.showSaveDialog(K);if('cancelled'===Q.status)return Y.setData('currentFileNameInElectron',''),X;if(Q.fileName){Y.setData('currentFileNameInElectron',Q.fileName);let Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveCore(Y,Q.fileName,G,!1,!0);return Promise.resolve(Z)}return X},GC.Spread.Sheets.Designer.FileMenuHandler.saveCore=async function(Y,$,G,K,X){let q;G&&G.exportJsonSetting&&G.exportJsonSetting.sheetToExport&&void 0!==G.exportJsonSetting.sheetToExport.selectedValue&&(q=+G.exportJsonSetting.sheetToExport.selectedValue);let Z,Q=GC.Spread.Sheets.Designer.FileMenuHandler.getFileExtension($);return'ssjson'===Q||'json'===Q?Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveJson(Y,$,K,X,!1,q):'js'===Q?Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveJson(Y,$,K,X,!0,q):'csv'===Q||'pdf'===Q||'xlsx'===Q||'sjs'===Q?Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveOtherFormat(Y,$,G,K,X):void 0,Z},GC.Spread.Sheets.Designer.FileMenuHandler.saveJson=async function(Y,$,G,K,X,q){let Q=Y.Spread;q!==void 0&&(Q=GC.Spread.Sheets.Designer.FileMenuHandler.cloneSpreadBySheetIndex(Y.Spread,q));let Z=GC.Spread.Sheets.Designer.FileMenuHandler.spreadToJSON(Y,Q),ee=Y.getData('treeNodeFromJson')||Y.getData('updatedTreeNode')||Y.getData('oldTreeNodeFromJson');ee&&(Z.designerBindingPathSchema='string'==typeof ee?JSON.parse(ee):ee);let te=Y.getData('osEnv'),ie=te.save($,JSON.stringify(Z),X);return'failed'===ie.status?(await GC.Spread.Sheets.Designer.showMessageBox(ie.message,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error),Promise.resolve(!1)):(K||(Y.setData('currentFilePath',$),Y.setData('isFileModified',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle(Y),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList(Y,$)),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y),G&&te.exit(),Promise.resolve(!0))},GC.Spread.Sheets.Designer.FileMenuHandler.saveOtherFormat=async function(Y,$,G,K,X){let q=Y.getData('container');GC.Spread.Sheets.Designer.FileMenuHandler.showLoadingPlaceHolder(q);let Q=GC.Spread.Sheets.Designer.FileMenuHandler.getFileExtension($),Z={spread:void 0,exportFileType:Q,needStringify:!1};if(G)switch(Q){case'xlsx':if(G.useExcelSJSFormat){let re=g(G.exportXlsxOptions);re.fileType=GC.Spread.Sheets.FileType.excel,Z.sjsExcel={setting:re},Z.spread=Y.Spread}else{let re='';G.exportExcelSetting&&(re=G.exportExcelSetting.password||'');let se={includeBindingSource:G.exportExcelSetting&&G.exportExcelSetting.includeBindingSource,columnHeadersAsFrozenRows:G.exportExcelSetting&&G.exportExcelSetting.exportColumnHeaders,saveAsView:G.exportExcelSetting&&G.exportExcelSetting.saveAsView,ignoreFormula:G.exportExcelSetting&&G.exportExcelSetting.ignoreFormula,ignoreStyle:G.exportExcelSetting&&G.exportExcelSetting.ignoreStyle,rowHeadersAsFrozenColumns:G.exportExcelSetting&&G.exportExcelSetting.exportRowHeaders};Z.spread=Y.Spread.toJSON(se),Z.excel={password:re},Z.needStringify=!0}break;case'csv':let ne=G.exportCsvSetting;if(ne)try{Z.csv={encoding:ne.encoding},Z.spread=Y.Spread.sheets[ne.sheetIndex].getCsv(ne.row,ne.column,ne.rowCount,ne.columnCount,ne.rowDelimiter,ne.columnDelimiter),Z.needStringify=!0}catch(re){return GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(q),void(await GC.Spread.Sheets.Designer.showMessageBox(re.message,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning,GC.Spread.Sheets.Designer.MessageBoxButtons.ok))}break;case'pdf':let ae=G.exportPdfSetting;if(ae){let re;ae.sheetToExport&&void 0!==ae.sheetToExport.selectedValue&&null!==ae.sheetToExport.selectedValue&&(re=+ae.sheetToExport.selectedValue),Z.spread=Y.Spread,Z.pdf={setting:ae,sheetIndex:re}}break;case'sjs':Z.sjs={setting:g(G.saveOptions)},Z.spread=Y.Spread;}else Z.spread=GC.Spread.Sheets.Designer.FileMenuHandler.spreadToJSON(Y,Y.Spread),Z.needStringify=!0;let ee=Y.getData('osEnv');Z.needStringify&&(Z=JSON.parse(JSON.stringify(Z)));let ie,te=await ee.exportFile($,Z);try{'success'===te.status?(!X&&(Y.setData('currentFilePath',$),Y.setData('isFileModified',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle(Y),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList(Y,$)),K&&ee.exit(),ie=Promise.resolve(!0)):(await GC.Spread.Sheets.Designer.showMessageBox(te.message,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error),ie=Promise.resolve(!1))}catch(ne){}finally{GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(q),Y.refresh()}return ie},GC.Spread.Sheets.Designer.FileMenuHandler.processPropertyChanged=function(Y,$,G){if($){let X=Y.getData(I.fileMenuSetting)||{};X[$.replace('.','_')]=G,$.endsWith('.calcOnDemand')&&G?X[$.replace('.calcOnDemand','_incrementalCalculation')]=!1:$.endsWith('.incrementalCalculation')&&G&&(X[$.replace('.incrementalCalculation','_calcOnDemand')]=!1),'printSetting'===$&&G&&Y.setData(StatesNames.PrintPreviewFileMenuUpdateCache,!0),Y.setData(I.fileMenuSetting,X);if(-1<['activeCategory_main','activeCategory_export','activeCategory_import'].indexOf($)){let Q=document.querySelector(`.category-content-container [data-${$}=${G}]`);if(Q){for(let Z=0;Z<Q.children.length;Z++){const ee=Q.children[Z];ee.setAttribute('aria-hidden','true')}Y.Spread.options.enableAccessibility&&Q.focus(),setTimeout(()=>{for(let Z=0;Z<Q.children.length;Z++){const ee=Q.children[Z];ee.removeAttribute('aria-hidden')}},500)}}}let K=GC.Spread.Sheets.Designer.FileMenuHandler.getFileMenuOption(Y);switch($){case'activeCategory_hide':GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y);break;case'activeCategory_main':GC.Spread.Sheets.Designer.FileMenuHandler.processSelectMainCategory(Y,G);break;case'templateSetting':GC.Spread.Sheets.Designer.FileMenuHandler.processNewTemplate(Y),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y),Y.setData('currentFileNameInElectron','');break;case'recentWorkbookFiles_open':let X=G.clickItem;if(X){let q=X.filePath+'\\'+X.fileName;Y.setData('currentFileNameInElectron',q),GC.Spread.Sheets.Designer.FileMenuHandler.directOpen(Y,q)}GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y);break;case'button_import_ssjson':GC.Spread.Sheets.Designer.FileMenuHandler.importJson(Y,K);break;case'button_export_ssjson':GC.Spread.Sheets.Designer.FileMenuHandler.exportJson(Y,K);break;case'button_import_excel_io':GC.Spread.Sheets.Designer.FileMenuHandler.importExcel(Y,K);break;case'button_export_io_excel':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcel(Y,K);break;case'button_open_sjs':GC.Spread.Sheets.Designer.FileMenuHandler.openSJS(Y,K);break;case'button_save_sjs':GC.Spread.Sheets.Designer.FileMenuHandler.saveSJS(Y,K);break;case'button_import_excel':GC.Spread.Sheets.Designer.FileMenuHandler.importExcelSJSFormat(Y,K);break;case'button_export_excel':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelSJSFormat(Y,K);break;case'button_import_csv':GC.Spread.Sheets.Designer.FileMenuHandler.importCsv(Y,K);break;case'button_export_javascript':GC.Spread.Sheets.Designer.FileMenuHandler.exportJS(Y,K);break;case'button_export_csv':GC.Spread.Sheets.Designer.FileMenuHandler.exportCsv(Y,K);break;case'button_export_pdf':GC.Spread.Sheets.Designer.FileMenuHandler.exportPdf(Y,K);break;case'exportExcelSetting.exportRowAndColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelRowAndColumnHandler(Y,K);break;case'exportExcelSetting.exportRowHeaders':case'exportExcelSetting.exportColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelRowOrColumnHandler(Y,K);break;case'importExcelSetting.importRowAndColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.importExcelRowAndColumnHandler(Y,K);break;case'importExcelSetting.importRowHeaders':case'importExcelSetting.importColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.importExcelRowOrColumnHandler(Y,K);break;case'docProps':GC.Spread.Sheets.Designer.FileMenuHandler.updateDocProps(Y,G);}},GC.Spread.Sheets.Designer.FileMenuHandler.resetCore=async function(Y){Y.setData('isInParameterPanelDesignMode',!1);let $=Y._getGlobalEvent();$.fire('DesignerReset'),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle(Y),p(Y.Spread,W)},GC.Spread.Sheets.Designer.FileMenuHandler.openSJS=async function(Y,$){let G={title:_.a.importFileDialogTitle,nameFilters:[_.a.sjsFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.saveSJS=async function(Y,$){let G={title:_.a.exportFileDialogTitle,nameFilters:[_.a.sjsFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.importCsv=async function(Y,$){let G={title:_.a.importFileDialogTitle,nameFilters:[_.a.csvFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.importJson=async function(Y,$){let G={title:_.a.importFileDialogTitle,nameFilters:[_.a.spreadFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.importExcel=async function(Y,$){let G={title:_.a.importFileDialogTitle,nameFilters:[_.a.excelFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.importExcelSJSFormat=async function(Y,$){let G={title:_.a.importFileDialogTitle,nameFilters:[_.a.excelFileFilter]};0!==$.importXlsxOptions.openMode&&($.importXlsxOptions.progress=(K)=>{if(0<K.progress&&Y.getData('FileMenu_show')){GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y);let X=Y.getData('container');GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X)}}),$.useExcelSJSFormat=!0,await GC.Spread.Sheets.Designer.FileMenuHandler.import(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelSJSFormat=async function(Y,$){let G={title:_.a.exportFileDialogTitle,nameFilters:[_.a.excelFileFilter]};$.useExcelSJSFormat=!0,await GC.Spread.Sheets.Designer.FileMenuHandler.export(Y,G,$)},GC.Spread.Sheets.Designer.FileMenuHandler.import=async function(Y,$,G){let K=$;K||(K={title:_.a.importFileDialogTitle,nameFilters:[_.a.spreadFileFilter,_.a.excelFileFilter,_.a.csvFileFilter,_.a.allFileFilter]});let X=Y.getData('osEnv'),q=await X.showOpenDialog(K);if('cancelled'!==q.status&&q.fileName){Y.setData('isFirstImporting',!0);let Q=q.fileName.substring(q.fileName.lastIndexOf('.')+1);switch(Q.toLowerCase()){case'ssjson':await GC.Spread.Sheets.Designer.FileMenuHandler.openJson(Y,q.fileName,!0);break;case'xlsx':case'csv':case'sjs':await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormat(Y,q.fileName,G,!0);}}},GC.Spread.Sheets.Designer.FileMenuHandler.openJson=async function(Y,$,G){if(Y.getData('isFileModified')){let K=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch(K){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:await GC.Spread.Sheets.Designer.FileMenuHandler.save(Y,void 0,void 0),await GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore(Y,$,G);break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:Y.setData('isFileModified',!1),await GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore(Y,$,G);break;case GC.Spread.Sheets.Designer.MessageBoxResult.cancel:}}else await GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore(Y,$,G)},GC.Spread.Sheets.Designer.FileMenuHandler.openBrowse=async function(Y,$){let G='';$&&$.openFileOption&&(G=$.openFileOption.filePath);let K={title:_.a.openFileDialogTitle,dirName:G,nameFilters:[_.a.allSpreadFileFilter,_.a.spreadFileFilter,_.a.excelFileFilter,_.a.sjsFileFilter,_.a.allFileFilter]},X=Y.getData('osEnv'),q=await X.showOpenDialog(K);'cancelled'===q.status||q.fileName&&(await GC.Spread.Sheets.Designer.FileMenuHandler.directOpen(Y,q.fileName))},GC.Spread.Sheets.Designer.FileMenuHandler.directOpen=async function(Y,$){let G=$.substring($.lastIndexOf('.')+1);switch(G.toLowerCase()){case'ssjson':case'json':await GC.Spread.Sheets.Designer.FileMenuHandler.openJson(Y,$);break;case'xlsx':case'csv':case'sjs':await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormat(Y,$,{encoding:'UTF8'});break;default:return void(await GC.Spread.Sheets.Designer.FileMenuHandler.showMessageBox(_.a.openFileFormatError,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error));}},GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore=async function(Y,$,G){let K=Y.getData('osEnv'),X=K.open($);if(Y.setData('InternalSaveFileType','ssjson'),'failed'===X.status)await GC.Spread.Sheets.Designer.FileMenuHandler.showMessageBox(X.message,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else try{let q=X.data,Q=q[0],ee=JSON.parse('\uFEFF'===Q||'FFFE'===Q?q.substr(1):q);G?(Y.Spread.fromJSON(ee),ee.designerBindingPathSchema&&(Y.Spread.designerBindingPathSchema=ee.designerBindingPathSchema,Y.setData('treeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),Y.setData('oldTreeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),delete ee.designerBindingPathSchema),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat(Y.Spread),Y.setData('isFileModified',!0)):(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore(Y),Y.Spread.fromJSON(ee),ee.designerBindingPathSchema&&(Y.Spread.designerBindingPathSchema=ee.designerBindingPathSchema,Y.setData('treeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),Y.setData('oldTreeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),delete ee.designerBindingPathSchema),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat(Y.Spread),Y.setData('isFileModified',!1),Y.setData('FieldListVisible',!1),Y.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList(Y,$)),GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList(Y),GC.Spread.Sheets.Designer.FileMenuHandler.setStateNames(Y),GC.Spread.Sheets.Designer.FileMenuHandler.updatePanel(Y),Y.setData('currentFilePath',X.fileName),Y.setData('isExcel',!1),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle(Y)}catch(q){('no sheet'===q||-1!==q.message.indexOf('fromJSON'))&&(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore(Y),await GC.Spread.Sheets.Designer.showMessageBox(_.a.openFileFormatError,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error))}},GC.Spread.Sheets.Designer.FileMenuHandler.setStateNames=function(Y){Y.setData('FieldListVisible',!1),Y.setData('selectionPane_Visible',!1),Y.setData('schemaPanel_Visible',!1),Y.setData('isInParameterPanelDesignMode',!1),Y.setData('reportCellPanel_Visible',!0)},GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat=function(Y){if(!Y.getActiveSheet()&&!Y.getActiveSheetTab())if(0<Y.getSheetCount())Y.setActiveSheetIndex(0);else if(0<Y.getSheetTabCount())Y.setActiveSheetTab(0);else throw new Error('no sheet');for(let $=0;$<Y.getSheetCount();$++){let G=Y.getSheet($).getActiveColumnIndex(),K=Y.getSheet($).getActiveRowIndex();G!==void 0&&K!==void 0?Y.getSheet($).setActiveCell(K,G):Y.getSheet($).setActiveCell(0,0)}},GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList=function(Y,$){let G=Y.getData('recentFileManger');G&&G.addRecentFile($)},GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormat=async function(Y,$,G,K){if(Y.getData('isFileModified')){let X=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch(X){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:await GC.Spread.Sheets.Designer.FileMenuHandler.save(Y,void 0,void 0),await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore(Y,$,G,K);break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:Y.setData('isFileModified',!1),await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore(Y,$,G,K);break;case GC.Spread.Sheets.Designer.MessageBoxResult.cancel:}}else await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore(Y,$,G,K)},GC.Spread.Sheets.Designer.FileMenuHandler.showLoadingPlaceHolder=function(Y){let $=Y.querySelector('.gc-loadingPlaceHolderContainer');$||($=document.createElement('div'),$.classList.add('gc-loadingPlaceHolderContainer'),Y.appendChild($))},GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder=function(Y){let $=Y.querySelector('.gc-loadingPlaceHolderContainer');$&&$.parentElement&&$.parentElement.removeChild($)},GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore=async function(Y,$,G,K){let X=Y.getData('container');GC.Spread.Sheets.Designer.FileMenuHandler.showLoadingPlaceHolder(X);let q=function(Q,Z){Z.setData('currentFilePath',Q),Z.setData('isFileModified',!0),Z.setData('isExcel',!0),GC.Spread.Sheets.Designer.FileMenuHandler.setStateNames(Z),GC.Spread.Sheets.Designer.FileMenuHandler.updatePanel(Y),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Z),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle(Z)};try{await o(400);let Q=Y.getData('osEnv'),Z=$.substring($.lastIndexOf('.')+1);Z=Z.toLowerCase(),Y.setData('InternalSaveFileType',Z);let ee=G;'csv'===Z&&G&&G.importCsvSetting&&(ee={encoding:G.importCsvSetting.encoding});let te=await Q.importFile($,ee);if('success'===te.status){let ie={};if('sjs'===Z){let ne=!0;if(Y.getData('isFileModified')&&K&&(ne=await GC.Spread.Sheets.Designer.FileMenuHandler.saveModifyFile(Y)),!ne)return;let ae=(re)=>{Y.Spread.open(te.data,()=>{GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X);let se=Y._getGlobalEvent();se&&se.fire('FileLoaded',{type:'FileLoaded'},{designer:Y,fileType:4}),GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList(Y),q($,Y)},async(se)=>{GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),await GC.Spread.Sheets.Designer.showMessageBox(se.errorMessage,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y)},g(re))};K?(delete ee.openOptions.lazyLoad,ae(ee.openOptions)):(ae(),Y.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList(Y,$))}else if('csv'===Z){ie=te.data;let ne='\\r\\n',ae=',';if(G&&G.importCsvSetting){let se=G.importCsvSetting;ne=se.rowDelimiter||ne,ae=se.columnDelimiter||ae}let re=l.i(R.a)(Y.Spread);re.reset(),ne=ne.replace('\\n','\n').replace('\\r','\r'),65279===ie.charCodeAt(0)&&(ie=ie.slice(1)),re.setCsv(0,0,ie,ne,ae||','),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),q($,Y)}else if(G.useExcelSJSFormat){let ne=function(ae){Y.Spread.import(te.data,()=>{GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList(Y),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X);let re=Y._getGlobalEvent();re&&re.fire('FileLoaded',{type:'FileLoaded'},{designer:Y,fileType:2}),q($,Y)},async(re)=>{GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),await GC.Spread.Sheets.Designer.showMessageBox(re.errorMessage||re,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning)},ae)};if(!K)ne(),Y.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList(Y,$);else{delete ee.openOptions.lazyLoad;let ae=g(ee.importXlsxOptions);ae.fileType=GC.Spread.Sheets.FileType.excel,ne(ae)}}else{try{ie=te.data}catch(ne){GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Y),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),await GC.Spread.Sheets.Designer.showMessageBox('Parse file data error.',_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error)}try{if(!K)await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore(Y),Y.Spread.fromJSON(ie),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat(Y.Spread),Y.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList(Y,$);else{let ae={};G&&G.importExcelSetting&&(ae={doNotRecalculateAfterLoad:G.importExcelSetting&&G.importExcelSetting.importDoNotRecalculateAfterLoad,frozenColumnsAsRowHeaders:G.importExcelSetting&&G.importExcelSetting.importColumnHeaders,frozenRowsAsColumnHeaders:G.importExcelSetting&&G.importExcelSetting.importRowHeaders,ignoreFormula:G.importExcelSetting&&G.importExcelSetting.ignoreFormula,ignoreStyle:G.importExcelSetting&&G.importExcelSetting.ignoreStyle,incrementalLoading:G.importExcelSetting&&G.importExcelSetting.incrementalLoading}),Y.Spread.fromJSON(ie,ae),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat(Y.Spread)}Y.setData('currentFilePath',$),Y.setData('isExcel',!0),Y.setData('isFileModified',!0),GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList(Y);let ne=Y.Spread.sheets;ne.forEach((ae)=>{let re=ae.options.protectionOptions;re&&(re.formatRows&&(re.allowOutlineRows=!0),re.formatColumns&&(re.allowOutlineColumns=!0),ae.options.protectionOptions=re)}),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),q($,Y)}catch(ne){'no sheet'===ne?(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore(Y),await GC.Spread.Sheets.Designer.showMessageBox(_.a.openFileFormatError,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error)):await GC.Spread.Sheets.Designer.showMessageBox(ne.toString(),_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning)}}}else if(GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),!te.errorData)await GC.Spread.Sheets.Designer.showMessageBox(te.message,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else if(K)await GC.Spread.Sheets.Designer.showMessageBox(te.errorData.errorMessage,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else if(0===te.errorData.errorCode||1===te.errorData.errorCode)await GC.Spread.Sheets.Designer.showMessageBox(te.errorData.errorMessage,_.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else{let ie=await GC.Spread.Sheets.Designer.showDialog('passwordDialog',{});ie&&(!G&&(G={importExcelSetting:{}}),G.importExcelSetting&&(G.importExcelSetting.password=ie.password),GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore(Y,$,G,K))}}finally{}},GC.Spread.Sheets.Designer.FileMenuHandler.processSelectMainCategory=function(Y,$){'Save'===$?GC.Spread.Sheets.Designer.FileMenuHandler.processSave(Y):'Exit'===$?GC.Spread.Sheets.Designer.FileMenuHandler.exit(Y):void 0},GC.Spread.Sheets.Designer.FileMenuHandler.processSave=async function(Y){await GC.Spread.Sheets.Designer.FileMenuHandler.save(Y)},GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown=!1,GC.Spread.Sheets.Designer.FileMenuHandler.exit=async function(Y){if(Y||window.osenv.closeAllWindows(),Y.setData('FileMenu_show',!1),Y.getData('isFileModified')){if(GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown)return;GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown=!0;let G=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch(GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown=!1,G){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:await GC.Spread.Sheets.Designer.FileMenuHandler.save(Y,!0);break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:break;default:return;}}let $=Y.getData('osEnv');$.closeAllWindows()},O.a.commandMap={fontFamilyNative:S.a,insertPictureNative:f.a,pasteElectron:F.a,"paste-all-electron":F.b,"paste-formulas-electron":F.c,"paste-values-electron":F.d,"paste-formatting-electron":F.e,"paste-valuesAndFormatting-electron":F.f,"paste-formulasAndFormatting-electron":F.g,"designer.pasteElectron":y.a,"designer.pasteAllElectron":y.b,"designer.pasteFormulasElectron":y.c,"designer.pasteValuesElectron":y.d,"designer.pasteFormattingElectron":y.e,"designer.pasteValuesAndFormattingElectron":y.f,"designer.pasteFormulasAndFormattingElectron":y.g,"designer.tableSheetPasteElectron":y.h,cutElectron:M.a,"designer.cutElectron":b.a,copyElectron:D.a,"designer.copyElectron":v.a,saveSchemaElectron:H.a,loadSchemaElectron:T.a,activeElectron:E.a,resetElectron:B.a,saveElectron:P.a,openElectron:A.a,fileMenuButtonNative:C.a};let J;window.ipcRenderer&&window.ipcRenderer.on('closing',()=>{GC.Spread.Sheets.Designer.FileMenuHandler.exit(J)}),GC.Spread.Sheets.Designer.registerTemplate('fileMenuPanelTemplate',N.a),J=new GC.Spread.Sheets.Designer.Designer(document.getElementById('gc-designer-container'),O.a);let z=J.getData('osEnv'),U=!J.getData('needActive')||3===z._ms[2]();J.setData('AllowAccessBarOpen',U),J.setData('AllowAccessBarSave',U),J.setData('AllowAccessBarReset',U),p(J.Spread,W),window.ipcRenderer.on('save',async()=>{window.ipcRenderer.send('isSaving',!0),V=!0;let G=u();G?G.commandManager().execute({cmd:'commitContentToActiveCell'}):await GC.Spread.Sheets.Designer.FileMenuHandler.processSave(J),window.ipcRenderer.send('isSaving',!1)})},function(t,a,l){'use strict';var o=l(0);l.d(a,'a',function(){return p});let p={title:o.a.ribbon.accessBar.open,commandName:'openElectron',iconClass:'gc-accessbar-open',execute:async(g)=>{await GC.Spread.Sheets.Designer.FileMenuHandler.openBrowse(g,{});let u=g.getData('currentFilePath');g.setData('currentFileNameInElectron',u)},enableContext:`AllowAccessBarOpen && !IsInTableSheetDesignMode && !DataManagerActive && !activeSpreadIsDesignSpread`}},function(t,a,l){'use strict';var o=l(0);l.d(a,'a',function(){return p});let p={title:o.a.ribbon.accessBar.New,commandName:'resetElectron',iconClass:'gc-accessbar-new',execute:async(g)=>{await GC.Spread.Sheets.Designer.FileMenuHandler.processNewTemplate(g)},enableContext:`AllowAccessBarReset && !IsInTableSheetDesignMode && !DataManagerActive && !activeSpreadIsDesignSpread`}},function(t,a,l){'use strict';var o=l(0),p=l(4);l.d(a,'a',function(){return g});let g={title:o.a.ribbon.accessBar.save,commandName:'saveElectron',iconClass:'gc-accessbar-save',execute:async(u)=>{let m=window.osenv;m.needActive()&&m._ms[2]()!==p.b.Trial||(await GC.Spread.Sheets.Designer.FileMenuHandler.processSave(u))},enableContext:`AllowAccessBarSave && !IsInTableSheetDesignMode && !DataManagerActive && !activeSpreadIsDesignSpread`}},function(t,a,l){'use strict';var o=l(0),p=l(6),g=l(3);l.d(a,'a',function(){return u});let u={text:'${res.contextMenu.copy}',commandName:'designer.copyElectron',iconClass:'gc-spread-copy',visibleContext:`${g.i.ClickViewport} || ${g.i.ClickCorner} || ${g.i.ClickColHeader} || ${g.i.ClickRowHeader} ||
    ${g.i.TableSheetClickViewport} || ${g.i.TableSheetClickCorner} || ${g.i.TableSheetClickColHeader} || ${g.i.TableSheetClickRowHeader} ||
    ${g.i.GanttSheetClickRowHeader} || ${g.i.GanttSheetClickFields} || ${g.i.GanttSheetClickColHeader}`,execute:p.a.execute}},function(t,a,l){'use strict';var o=l(0),p=l(7),g=l(3);l.d(a,'a',function(){return u});let u={text:'${res.contextMenu.cut}',commandName:'designer.cutElectron',iconClass:'gc-spread-cut',visibleContext:`${g.i.ClickViewport} && !${g.i.PivotTableSelected} || ${g.i.ClickCorner} || ${g.i.ClickColHeader} || ${g.i.ClickRowHeader} ||
    ${g.i.TableSheetClickViewport} || ${g.i.TableSheetClickCorner} || ${g.i.TableSheetClickColHeader} || ${g.i.TableSheetClickRowHeader} ||
    ${g.i.GanttSheetClickFields} || ${g.i.GanttSheetClickRowHeader} || ${g.i.GanttSheetClickColHeader}`,enableContext:'!IsIncludeLockedCell',execute:p.a.execute}},function(t,a,l){'use strict';function u(Z,ee){let te=Z&&Z.ribbon;if(te)for(var ie of te)if(ie.id===ee)return ie}function m(Z,ee,te){let ie=Z&&Z.ribbon;if(ie)for(var ne in ie)ie[ne]&&ie[ne].id===ee&&(ie[ne]=te)}l.d(a,'a',function(){return Q});let Q=GC.Spread.Sheets.Designer.DefaultConfig;(function(Z){var ee=u(Z,'home'),te=JSON.stringify(ee);te=te.replace(`"command":"${'pasteAll'}"`,`"command":"${'paste-all-electron'}"`).replace('fontFamily','fontFamilyNative').replace('"cut","copy"','"cutElectron","copyElectron"'),m(Z,'home',JSON.parse(te))})(Q),function(Z){var ee=u(Z,'insert'),te=JSON.stringify(ee);te=te.replace('insertPicture','insertPictureNative'),m(Z,'insert',JSON.parse(te))}(Q),function(Z){var ee=u(Z,'data'),te=JSON.stringify(ee);te=te.replace('loadSchema','loadSchemaElectron').replace('saveSchema','saveSchemaElectron'),m(Z,'data',JSON.parse(te))}(Q),function(Z){var ee=Z.contextMenu,te=JSON.stringify(ee);te=te.replace('contextMenuCut','designer.cutElectron').replace('contextMenuCopy','designer.copyElectron').replace('contextMenuPaste','designer.pasteElectron').replace('designerPasteAll','designer.pasteAllElectron').replace('pasteFormula','designer.pasteFormulasElectron').replace('designerPasteValues','designer.pasteValuesElectron').replace('designerPasteFormatting','designer.pasteFormattingElectron').replace('pasteValuesFormatting','designer.pasteValuesAndFormattingElectron').replace('pasteFormulaFormatting','designer.pasteFormulasAndFormattingElectron').replace('gc.spread.contextMenu.pasteValues','designer.tableSheetPasteElectron'),Z.contextMenu=JSON.parse(te)}(Q),Q.fileMenu='fileMenuButtonNative',Q.quickAccessBar=['resetElectron','saveElectron','openElectron','activeElectron']},function(t,a,l){'use strict';function o(b,D){let v=[b,D].map((H)=>{return new Date(H.getFullYear(),H.getMonth(),H.getDate())});return(v[0].valueOf()-v[1].valueOf())/8.64e7}var p=l(0);const g={status:'failed',message:'not implemented.'},u={status:'cancelled',message:'not implemented.'},m='sid',x=GC.Spread.Sheets.Designer.showMessageBox,S=GC.Spread.Sheets.Designer.MessageBoxIcon,f=GC.Spread.Sheets.Designer.MessageBoxButtons,F={Trial:3,Valid:0,Expired:1,Unlicensed:2,Invalid:4},y='zh-cn';class C{constructor(){}notifyReady(){}showOpenDialog(){return Promise.reject({status:'',fileName:''})}open(){return{status:'',message:'',data:'',fileName:''}}save(){return g}exit(){}importFile(){return Promise.resolve(g)}showSaveDialog(){return u}exportFile(){return Promise.resolve(g)}needActive(){return!1}setClipboardData(){}getClipboardText(){return''}getBase64(){return''}getClipboardHTML(){return''}getSystemFonts(){return null}closeAllWindows(){}setClipboardText(){}setClipboardHTML(){}getFileInfo(){return{}}joinPath(b){return b&&b.toString()}config(b,D){return void 0===D?this.getConfig(b):(this.setConfig(b,D),window.osenv)}getConfig(b){this.initConfig(!0);let D=b.split('.'),v=this._config;if(v){for(let T,H=0;H<D.length;H++){if(T=v[D[H]],void 0===T)return;v=T}if(b===m){let H=parseInt(v,36);return isNaN(H)?null:new Date(H)}return v}}initConfig(){this._config===void 0&&(this._config={})}setConfig(b,D){this.initConfig(!1);let v=b.split('.'),H=this._config;if(H){for(let E,T=0;T<v.length-1;T++)E=H[v[T]],void 0===E&&(H[v[T]]=E={}),H=E;H[v[v.length-1]]=D}}restartApp(){}}a.a=class extends C{constructor(b){super();this.originApp=b;let E=this;this.isNative=!0,this._systemFontList=b.getSystemFonts(),window.ipcRenderer.on('shown',()=>{let P=document.querySelector('.gc-accessbar-active');var A=window._ssCulture;if(P){let N=P.parentElement;if(N&&'none'!==window.getComputedStyle(N).display){var O=function(){var R=setTimeout(()=>{N.click(),E.enableFilemenu=!0,clearTimeout(R)},500)};let _=E._ms[0];if(_){let R=_();A===y?(R&&!R.h||R.h&&(R.e||!R.v))&&O():R&&(!R.h&&!R.v||!R.v||R.e)&&O()}}}}),window.ipcRenderer.on('openFileError',function(){x(p.a.openFileErrorMessage,p.a.title,S.warning)}),window.ipcRenderer.on('fontReady',function(P,A){E._systemFontList=A.split('||||')}),GC.Spread.Sheets.Workbook.lm=1;let B=new GC.Spread.Sheets.Workbook;this._mode=B.ls&&B.ls.m,B.destroy(),null!==this._mode&&this._mode!==void 0&&this._vls(b._g()),this._ms=[function(P){return E._i(P)},function(P){E._uls(P)},function(){return E._gls()},function(){return E._gtdl()}]}initConfig(b){if(this._config===void 0){let D=this.originApp.getConfig();this._config=D?JSON.parse(D):{},b&&(this._config[m]=this._config[m]||Date.now().toString(36))}}needActive(){/*@@info*/return false;let b=this._i();return!(b.v&&b.h&&(2===b.t||0>b.t))}showSaveDialog(b){return this.originApp.showSaveDialog(b)}showOpenDialog(b){return new Promise((D)=>{this.originApp.showOpenDialog(b,(H)=>{D(H)})})}async getSelectedFileUrl(){let b=await this.showOpenDialog({title:p.a.selectFileURLDialogTitle,nameFilters:[]});return'cancelled'===b.status?'':b.fileName?this.originApp.getFileUrl(b.fileName):''}getBase64(b){return this.originApp.getBase64(b)}save(b,D,v){return this.originApp.save(b,D,v)}open(b){return this.originApp.open(b)}exportFile(b,D){return new Promise((v)=>{this.originApp.exportFile(b,D,(T)=>{v(T)})})}importFile(b,D){return new Promise((v)=>{let T=b.substring(b.lastIndexOf('.')+1);switch(T.toLowerCase()){case'xlsx':this.originApp.importExcel(b,D,(E)=>{v(E)});break;case'csv':this.originApp.importCsv(b,D,(E)=>{v(E)});break;case'sjs':this.originApp.openSJS(b,D,(E)=>{v(E)});}})}exit(){this.originApp.exit(),this.originApp.closeAllWindows()}restartApp(){this.originApp.restart(),this.originApp.closeAllWindows()}getClipboardText(){return this.originApp.getClipboardText()}setClipboardText(b){this.originApp.setClipboardText(b)}getClipboardHTML(){return this.originApp.getClipboardHTML()}setClipboardHTML(b){this.originApp.setClipboardHTML(b)}setClipboardData(b){this.originApp.setClipboardData(b)}getSystemFonts(){return this._systemFontList}notifyReady(){window.ipcRenderer.send('ready')}closeAllWindows(){this.saveConfigFile(),this.originApp.closeAllWindows()}saveConfigFile(){!this.configSaved&&this.originApp&&this._config&&(this.configSaved=!0,this.originApp.setConfig(JSON.stringify(this._config)))}getFileInfo(b){return this.originApp.getFileInfo(b)}joinPath(b){return this.originApp.joinPath(b)}_i(b){if(b||!this._ls){let D=new GC.Spread.Sheets.Workbook;this._ls=this._convert(D.ls||{isVd:function(v){return v},hl:!0});try{D.destroy()}catch(v){}}return this._ls}_vls(b){return GC.Spread.Sheets.LicenseKey=b,this._i(!0)}_gls(){/*@@info*/return F.Valid;let b=this._i();return b.v?1===b.t?F.Trial:F.Valid:b.e?F.Expired:b.h?F.Invalid:F.Unlicensed}_uls(b){null!==this._mode&&this._mode!==void 0&&(b=b.trim().replace(/[\r\n]/g,''),this.originApp._u(this._mode,b))}_gtdl(){let b=this._i();return b.v&&!b.e&&b.d||0}_convert(b){var D=window._ssCulture;b=b||{};let v=b.e&&b.adr&&b.adr.dsr,H={t:[0,-1,1].indexOf(b.m),n:b.n,e:v,d:b.d,h:b.hl,v:b.isVd&&b.isVd(!0)};if(!(-1===b.m&&!H.v))-1===b.m&&H.v&&H.h&&void 0===H.d&&(H.h=H.v=!1,GC.Spread.Sheets.LicenseKey='');else if(!H.h){if(D===y)H.e=!1;else{let T=this.getConfig(m);if(!T)H.e=!0;else{let E=30-o(new Date,T);30<E||1>E?H.e=!1:(H.e=!1,H.d=E,H.v=!0)}}GC.Spread.Sheets.LicenseKey=''}else GC.Spread.Sheets.LicenseKey=v?'':'error';return H}}},function(t,a,l){'use strict';var o=l(18);const p={_l:['/3i0Y350Y1n0Y26302t2V353A2v0W35363b0W2w363c352u1B0w2D2v332v2T3b0W3b2Y2v0W26291w2','50w2S3c3B3b36350W3b360w2R2t3B303D2r3B2v0W3b2Y2v0W2u2V3a302x352v391b0Y190Y3b0Y1n0','Y1y3D2r333c2R3b3036350w3D2v393a3036350w153i1D3k0W2u2R3g153a160w332v2W3b161b0W2d2','V332V2t3B0w3B2y2V0w26291W250W2s3C3b3B36350w3B360W2r2T3b303d2R3b2V0w3B2y2V0w2U2v3','A302X352V390W2s2V2w36392V0w3B2y2V0w3B39302r330w2V352U3a1B0y190y2E0y1N0y1Y3d2R333','C2r3B3036350W3d2V393A3036350W153I1d3K0w2U2r3G153A160W332V2w3B161B0y190y2V0y1N0y2','J363C390W33302t2V353A2v0W303A0w2V3f3730392v2U1b0W2d2V332V2t3B0w3B2y2V0w26291W250','W2s3C3b3B36350w3B360W2r2T3b303d2R3b2V0w3B2y2V0w2U2v3A302X352V391B0y190y300y1N0y2','E2y2V0w3739363d302u2V2u0W33302t2V353A2v0W322V3g0W303A0w30353D2r33302U1b0W2d2V332','V2t3B0w3B2y2V0w26291W250W2s3C3b3B36350w3B360W2r2T3b303d2R3b2V0w3B2y2V0w2U2v3A302','X352V390W3e303b2Y0w2R0w3D2r33302U0w33302T2v353a2V1b0Y3k=='],_L:['/3i0Y330Y1n0Y26302t2V353A2v0W23352w3639342r3B3036350Y190Y2e0Y1n2L0y3C353235363e3','50y190y2V3d2R333C2r3B3036350Y190Y3739362U3c2T3b3036350y2N190Y320Y1n0Y26302t2V353','A2v0W322V3g1N0y190y3B0y1N0y2J363C390W2t36373G0w303a0W33302t2V353A2v2U0w3B360W3i1','D3k1B0y190y2V0y1N0y2E2y2V0w33302T2v353a2V0w2Y2r3A0w2V3f3730392v2U190W37332v2R3a2','V0w2V353B2v390w2R35363b2Y2v390w322v3G1b0Y190Y2u0Y1n0Y2j363c390w3I1e3K0w322v3G0w3','E3033330W2v3F3730392V0w30350W3i1F3k0W2u2R3g153a161b0Y190Y2w0Y1n0Y26302t2V353A2v0','W35363b0W2w363c352u1B0w1Y353B2v390w3B2y2V0w33302T2v353a2V0w322v3G0w30350W3b2Y2v0','W3a2V2t3B3036350W2s2V33363e0W3b360w3C3a2V0w2R33330w2R3d2R30332r2S332V0w2W2v2R3b3','C392V3a1B0y190y300y1N0y2E2y2V0w3739363d302u2V2u0W33302t2V353A2v0W322V3g0W303A0w3','0353D2r33302U190W37332v2R3a2V0w2V353B2v390w2R35363b2Y2v390w322v3G1b0Y190Y2f0Y1n0','Y2e2Y2r35323A0w2W36390w3G363C390W2t3636372v392r3B3036351B0w2E2y2V0w2R373733302t2','R3b3036350w3E3033330W2r3C3b360w392v3A3b2R393B0w3B360W2r3737333g0W3b2Y2v0W3739363','D302U2v2U0w33302T2v353a2V0w322v3G1b0Y3k=='],recent:'Recent'};a.a=p,p.l=l.i(o.a)(p._l,35),p.L=l.i(o.a)(p._L,35)},function(t,a){'use strict';function p(g){let u,m,x,S,f,F;for(u='',x=g.length,m=0;m<x;)switch(S=g[m],m+=1,S>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(S);break;case 12:case 13:f=g[m],m+=1,u+=String.fromCharCode((31&S)<<6|63&f);break;case 14:f=g[m],m+=1,F=g[m],m+=1,u+=String.fromCharCode((15&S)<<12|(63&f)<<6|(63&F)<<0);}return u}a.a=function(g,u){let m=g.join(''),x=[],S=m[0],f=['+','/'].indexOf(S)+1;for(let F=f&&1||0,y=m.length-(f&&f+1||0);F<y;F+=2)x.push(parseInt(m[F]+m[F+1],u));return m=p(x),JSON.parse(m)}},function(t,a,l){'use strict';function o(u){return!u.getData('IsInTableSheetDesignMode')&&!u.getData('DataManagerActive')&&!u.getData('activeSpreadIsDesignSpread')}var p=l(5);l.d(a,'a',function(){return g});let g={commandName:'fileMenuButtonNative',text:'${res.ribbon.home.file}',execute:(u)=>{let m=window.osenv;m.enableFilemenu?p.a.execute(u):o(u)&&GC.Spread.Sheets.Designer.FileMenuHandler.showFileMenu(u)}}},function(t,a,l){'use strict';async function o(B){let P=await p(B.Spread);P&&B.setData('isFileModified',!0)}async function p(B){let P={title:C.a.insertPictureDialogTitle,nameFilters:[C.a.pictureFormatFilter.png,C.a.pictureFormatFilter.jpeg,C.a.pictureFormatFilter.bmp,C.a.pictureFormatFilter.allFiles]},A=window.osenv,O=await A.showOpenDialog(P);if('cancelled'===O.status)return!1;if(O.fileName){let N=g(A,O.fileName),_=await F(O.fileName);return y(B,N,_.naturalWidth,_.naturalHeight)}return!1}function g(B,P){let A=B.getBase64(P);return P.endsWith('.svg')&&!A.startsWith('data:image')&&(A='data:image/svg+xml;base64,'+A),A}function u(B,P,A,O,N){let _=m(B,P,A);if(O&&N){let R=x(B);_.x=Math.min(_.x,R.width-O),_.y=Math.min(_.y,R.height-N)}return _}function m(B,P,A){const O=20;return{x:O+S(B,0,A),y:O+f(B,0,P)}}function x(B){return{width:S(B,0,B.getColumnCount()),height:f(B,0,B.getRowCount())}}function S(B,P,A){let O=0;for(let N=P;N<A;N++)O+=B.getColumnWidth(N);return O}function f(B,P,A){let O=0;for(let N=P;N<A;N++)O+=B.getRowHeight(N);return O}function F(B){return new Promise((P)=>{const O=document.createElement('img'),N=()=>{P({naturalWidth:O.naturalWidth,naturalHeight:O.naturalHeight})};O.addEventListener('load',N),O.addEventListener('error',N),O.addEventListener('abort',N),O.src=B})}function y(B,P,A,O){let N=l.i(b.a)(B);if(!N)return!1;let _=N.getActiveRowIndex(),R=N.getActiveColumnIndex();if(N.defaults.rowHeight===void 0||N.defaults.colWidth===void 0)return!1;let L=N.defaults.rowHeight,V=N.defaults.colWidth;return M.a.runCommand(B,'insertPicture',T,{activeRowIndex:_,activeColIndex:R,base64Content:P,rowHeight:L,colWidth:V,naturalWidth:A,naturalHeight:O})}var C=l(0),M=l(2),b=l(1);l.d(a,'a',function(){return H});const D=816;let H={title:'${res.ribbon.insert.insertPicture}',text:'${res.ribbon.insert.picture}',iconClass:'ribbon-button-picture',bigButton:!0,commandName:'insertPictureNative',enableContext:'AllowEditObject',execute:async(B)=>{await o(B)}},T={canUndo:!0,execute:function(B,P,A){let O=new E(B,P);return O.execute(B,P,A)}};class E extends M.a.DesignerActionBase{_getPictureName(B){let P=l.i(b.a)(B).pictures.all(),A=P.length,O={};for(let N=0;N<A;N++)O[P[N].name()]=!0;for(let _,N=0;N<A;N++)if(_='picture'+N,!O[_])return _;return'picture'+A}executeImp(B,P){let O=this,N=P.activeRowIndex,_=P.activeColIndex,R=P.rowHeight,L=P.colWidth;try{let V=l.i(b.a)(B),W=P.base64Content;if(W.startsWith('data:image')||(W='data:image/png;base64,'+W),V.shapes){let I=P.naturalWidth,J=P.naturalHeight;I&&J?I>D&&(J=J/I*D,I=D):I=J=void 0;let z=u(V,N,_,I,J);V.shapes.addPictureShape('',W,z.x,z.y,I,J)}else{let I=O._getPictureName(B);V.pictures.add(I,W,_*L,N*R)}return!0}catch(V){return!1}}}},function(t,a,l){'use strict';async function o(P){let A=window.osenv,O={title:f.a.ribbon.data.loadSchema,nameFilters:[f.a.ribbon.data.loadDataSourceFilter.json,f.a.ribbon.data.loadDataSourceFilter.txt]},N=await A.showOpenDialog(O);if('cancelled'!==N.status&&N.fileName){let _=A.open(N.fileName);if('failed'===_.status)y(N.message,f.a.title,C.error);else if(_.data)try{await p(P);let R=JSON.parse(_.data);R.$schema||Array.isArray(R)||P.setData('originalDataSource',new GC.Spread.Sheets.Bindings.CellBindingSource(R)),P.setData('treeNodeFromJson',_.data),P.setData('oldTreeNodeFromJson',_.data)}catch(R){y(f.a.ribbon.data.loadDataError,f.a.title,C.error)}}}async function p(P){let A=!!P.getData('FieldListVisible');A||(await g(P))}async function g(P){let A=!!P.getData('FieldListVisible'),O=GC.Spread.Sheets.Events.SelectionChanged+'.bindingPath';if(A){P.setData('FieldListVisible',!A),u(),P.Spread.unbind(O);let N=P.getData('bindingIndicatorManager');N.hideDataBindingSettingIndicator();let _=P.getData('originalDataSource');if(_){let R=l.i(F.a)(P.Spread);R.setDataSource(_)}}else{P.setData('FieldListVisible',!A),P.setData('ShowShapePropertyPanel',A),P.setData('chartAltTextPanel_Visible',A),P.setData('shapeAltTextPanel_Visible',A),P.setData('PictureAltTextPanel_Visible',A),P.setData('ChartElementContext',A),m();let N=P.getData('bindingIndicatorManager');if(!N){let _=P.getData('container');N=new GC.Spread.Sheets.Designer.BindingIndicatorManager(P.Spread,_),P.setData('bindingIndicatorManager',N)}P.Spread.bind(O,()=>{N.refreshBindingPathIndicator()}),N.refreshBindingPathIndicator()}await x(P.Spread)}function u(){D.Text.prototype.getText=v,D.CheckBox.prototype.getText=H,D.Button.prototype.getText=T,D.HyperLink.prototype.getText=E,D.ComboBox.prototype.getText=B}function m(){GC.Spread.Sheets.CellTypes.Text.prototype.getText=function(P,A){let O=A.sheet.getBindingPath(A.row,A.col);return O?'['+O+']':v.apply(this,arguments)},GC.Spread.Sheets.CellTypes.CheckBox.prototype.getText=function(P,A){let O=A.sheet.getBindingPath(A.row,A.col);return O?'['+O+']':H.apply(this,arguments)},GC.Spread.Sheets.CellTypes.Button.prototype.getText=function(P,A){let O=A.sheet.getBindingPath(A.row,A.col);return O?'['+O+']':T.apply(this,arguments)},GC.Spread.Sheets.CellTypes.HyperLink.prototype.getText=function(P,A){let O=A.sheet.getBindingPath(A.row,A.col);return O?'['+O+']':E.apply(this,arguments)},GC.Spread.Sheets.CellTypes.ComboBox.prototype.getText=function(P,A){let O=A.sheet.getBindingPath(A.row,A.col);return O?'['+O+']':B.apply(this,arguments)}}async function x(P,A=!0){A&&(await S(0));let O=document.querySelector('.spreadWrapper>.ss');O.classList.add('gc-temp-removeContent'),P.refresh(),O.classList.remove('gc-temp-removeContent')}function S(P){return new Promise((A)=>{setTimeout(()=>{A()},P)})}var f=l(0),F=l(1);l.d(a,'a',function(){return b});const y=GC.Spread.Sheets.Designer.showMessageBox,C=GC.Spread.Sheets.Designer.MessageBoxIcon,M=GC.Spread.Sheets.Designer.MessageBoxButtons;let b={title:'${res.ribbon.data.loadSchemaTitle}',text:'${res.ribbon.data.loadSchema}',iconClass:'ribbon-button-loadschema',commandName:'loadSchemaElectron',execute:async(P)=>{await o(P)},enableContext:'AllowDataBinding'},D=GC.Spread.Sheets.CellTypes,v=D.Text.prototype.getText,H=D.CheckBox.prototype.getText,T=D.Button.prototype.getText,E=D.HyperLink.prototype.getText,B=D.ComboBox.prototype.getText},function(t,a,l){'use strict';async function o(S){let f=window.osenv,F={title:p.a.ribbon.data.saveSchema,nameFilters:[p.a.ribbon.data.saveDataSourceFilter.json]},y=f.showSaveDialog(F);if('cancelled'!==y.status)try{if(y.fileName){let C=S.getData('updatedTreeNode')||S.getData('oldTreeNodeFromJson'),M=f.save(y.fileName,C,!1);'failed'===M.status&&g(M.message,p.a.title,u.error,m.ok)}}catch(C){}}var p=l(0);l.d(a,'a',function(){return x});const g=GC.Spread.Sheets.Designer.showMessageBox,u=GC.Spread.Sheets.Designer.MessageBoxIcon,m=GC.Spread.Sheets.Designer.MessageBoxButtons;let x={title:'${res.ribbon.data.saveSchemaTitle}',text:'${res.ribbon.data.saveSchema}',iconClass:'ribbon-button-saveschema',commandName:'saveSchemaElectron',execute:async(S)=>{await o(S)},enableContext:'AllowDataBinding'}},function(t,a,l){'use strict';var o=l(0);l.d(a,'a',function(){return W});const p={Hide:'Hide',New:'New',OpenSJS:'OpenSJS',SaveSJS:'SaveSJS',Import:'Import',Export:'Export',Exit:'Exit',Print:'Print',Recent:'Recent',Info:'Info'},g={RecentWorkbooks:'RecentWorkbooks',Computer:'Computer',SSJson:'SSJson',Excel:'Excel',Csv:'Csv',Pdf:'Pdf',ExcelIO:'Excel IO'};let u={type:'Container',visibleWhen:'activeCategory_main=New',children:[{type:'TextBlock',margin:'50px 0 15px 50px',style:'font-size:36px;line-height:80px',text:o.a.fileMenu.new},{type:'FileMenuListNew',bindingPath:'templateSetting'}]},m={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadSheetJsonFile},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importSpreadSheetFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_import_ssjson',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.SSJson},S={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 10px 50px',text:o.a.fileMenu.openFlags},...function(I){let J=[{text:o.a.fileMenu.importExportOptions.incrementalLoad,tips:o.a.fileMenu.importOptionsTips.incrementalLoad,name:'incrementalLoad'},{text:o.a.fileMenu.importExportOptions.lazyLoad,tips:o.a.fileMenu.importOptionsTips.lazyLoad,name:'lazyLoad'},{name:''},{text:o.a.fileMenu.importExportOptions.includeStyles,tips:o.a.fileMenu.importOptionsTips.includeStyles,name:'includeStyles'},{text:o.a.fileMenu.importExportOptions.includeFormulas,tips:o.a.fileMenu.importOptionsTips.includeFormulas,name:'includeFormulas'},{text:o.a.fileMenu.importExportOptions.fullRecalc,tips:o.a.fileMenu.importOptionsTips.fullRecalc,name:'fullRecalc'},{name:''},{text:o.a.fileMenu.importExportOptions.includeUnusedStyles,tips:o.a.fileMenu.importOptionsTips.includeUnusedStyles,name:'includeUnusedStyles'},{text:o.a.fileMenu.importExportOptions.incrementalCalculation,tips:o.a.fileMenu.importOptionsTips.incrementalCalculation,name:'incrementalCalculation'},{text:o.a.fileMenu.importExportOptions.calcOnDemand,tips:o.a.fileMenu.importOptionsTips.calcOnDemand,name:'calcOnDemand'},{text:o.a.fileMenu.importExportOptions.dynamicReferences,tips:o.a.fileMenu.importOptionsTips.dynamicReferences,name:'dynamicReferences'},{text:o.a.fileMenu.importExportOptions.convertSheetTableToDataTable,tips:o.a.fileMenu.importOptionsTips.convertSheetTableToDataTable,name:'convertSheetTableToDataTable'},{name:''},{text:o.a.fileMenu.importExportOptions.frozenRowsAsColumnHeaders,tips:o.a.fileMenu.importOptionsTips.frozenRowsAsColumnHeaders,name:'frozenRowsAsColumnHeaders'},{text:o.a.fileMenu.importExportOptions.frozenColumnsAsRowHeaders,tips:o.a.fileMenu.importOptionsTips.frozenColumnsAsRowHeaders,name:'frozenColumnsAsRowHeaders'}];return J.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${I}px`,text:z.text,bindingPath:'importXlsxOptions.'+z.name,tips:z.tips}})}(50),{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'importXlsxOptions.password',placeholder:o.a.fileMenu.importPassword},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_import_excel',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.Excel},f={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 0 50px',text:o.a.fileMenu.openFlags},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.incrementalLoading,bindingPath:'importExcelSetting.incrementalLoading'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importIgnoreStyle,bindingPath:'importExcelSetting.ignoreStyle'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importIgnoreFormula,bindingPath:'importExcelSetting.ignoreFormula'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importDoNotRecalculateAfterLoad,bindingPath:'importExcelSetting.importDoNotRecalculateAfterLoad',className:'file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importRowAndColumnHeaders,bindingPath:'importExcelSetting.importRowAndColumnHeaders',className:'file-menu-text file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.importRowHeaders,bindingPath:'importExcelSetting.importRowHeaders',className:'file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.importColumnHeaders,bindingPath:'importExcelSetting.importColumnHeaders',className:'file-menu-excel-option'},{type:'TextBlock',margin:'5px 0 0 50px',text:o.a.fileMenu.importPassword},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'importExcelSetting.password'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_import_excel_io',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.ExcelIO},F={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.csvFile},{type:'TextBlock',margin:'15px 0 0 50px',text:o.a.fileMenu.importRowDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'importCsvSetting.rowDelimiter'},{type:'TextBlock',margin:'15px 0 0 50px',text:o.a.fileMenu.importColumnDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'importCsvSetting.columnDelimiter'},{type:'TextBlock',margin:'15px 0 0 50px',text:o.a.fileMenu.importEncoding},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'importCsvSetting.encoding'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importCsvFile,width:120,height:120,iconClass:'icon-common icon-csv',bindingPath:'button_import_csv',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.Csv},C={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadJSFile},...function(I){let J=[{name:'incrementalLoad',text:o.a.fileMenu.openSaveOptions.incrementalLoad,tips:o.a.fileMenu.openOptionsTips.incrementalLoad},{name:'lazyLoad',text:o.a.fileMenu.openSaveOptions.lazyLoad,tips:o.a.fileMenu.openOptionsTips.lazyLoad},{name:''},{name:'includeStyles',text:o.a.fileMenu.openSaveOptions.includeStyles,tips:o.a.fileMenu.openOptionsTips.includeStyles},{name:'includeFormulas',text:o.a.fileMenu.openSaveOptions.includeFormulas,tips:o.a.fileMenu.openOptionsTips.includeFormulas},{name:'fullRecalc',text:o.a.fileMenu.openSaveOptions.fullRecalc,tips:o.a.fileMenu.openOptionsTips.fullRecalc},{name:''},{name:'includeUnusedStyles',text:o.a.fileMenu.openSaveOptions.includeUnusedStyles,tips:o.a.fileMenu.openOptionsTips.includeUnusedStyles},{name:'incrementalCalculation',text:o.a.fileMenu.openSaveOptions.incrementalCalculation,tips:o.a.fileMenu.openOptionsTips.incrementalCalculation,canChangeThreeState:!0,isThreeState:!0},{name:'calcOnDemand',text:o.a.fileMenu.openSaveOptions.calcOnDemand,tips:o.a.fileMenu.openOptionsTips.calcOnDemand,canChangeThreeState:!0,isThreeState:!0},{name:'dynamicReferences',text:o.a.fileMenu.openSaveOptions.dynamicReferences,tips:o.a.fileMenu.openOptionsTips.dynamicReferences}];return J.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${I}px`,text:z.text,bindingPath:'openOptions.'+z.name,tips:z.tips,canChangeThreeState:!!z.canChangeThreeState,isThreeState:!!z.isThreeState}})}(50),{type:'Button',margin:'20px 50px',text:o.a.fileMenu.openSJSFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_open_sjs',iconPosition:'top'}]},b={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadJSFile},...function(I){let J=[{name:'includeStyles',text:o.a.fileMenu.openSaveOptions.includeStyles,tips:o.a.fileMenu.saveOptionsTips.includeStyles},{name:'includeFormulas',text:o.a.fileMenu.openSaveOptions.includeFormulas,tips:o.a.fileMenu.saveOptionsTips.includeFormulas},{name:'includeUnusedNames',text:o.a.fileMenu.openSaveOptions.includeUnusedNames,tips:o.a.fileMenu.saveOptionsTips.includeUnusedNames},{name:''},{name:'saveAsView',text:o.a.fileMenu.openSaveOptions.saveAsView,tips:o.a.fileMenu.saveOptionsTips.saveAsView},{name:'includeAutoMergedCells',text:o.a.fileMenu.openSaveOptions.includeAutoMergedCells,tips:o.a.fileMenu.saveOptionsTips.includeAutoMergedCells},{name:'includeCalcModelCache',text:o.a.fileMenu.openSaveOptions.includeCalcModelCache,tips:o.a.fileMenu.saveOptionsTips.includeCalcModelCache},{name:'saveR1C1Formula',text:o.a.fileMenu.openSaveOptions.saveR1C1Formula,tips:o.a.fileMenu.saveOptionsTips.saveR1C1Formula},{name:'includeBindingSource',text:o.a.fileMenu.openSaveOptions.includeBindingSource,tips:o.a.fileMenu.saveOptionsTips.includeBindingSource},{name:'includeEmptyRegionCells',text:o.a.fileMenu.openSaveOptions.includeEmptyRegionCells,tips:o.a.fileMenu.saveOptionsTips.includeEmptyRegionCells}];return J.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${I}px`,text:z.text,bindingPath:'saveOptions.'+z.name,tips:z.tips}})}(50),{type:'Button',margin:'20px 50px',text:o.a.fileMenu.saveSSFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_save_sjs',iconPosition:'top'}]},D={type:'Container',visibleWhen:'activeCategory_main=Import',children:[{type:'TextBlock',margin:'50px 0 15px 50px',text:o.a.fileMenu.import,style:'font-size:36px;line-height:80px'},{type:'ColumnSet',margin:'0 0 0 50px',children:[{type:'Column',children:[{type:'List',className:'file-menu-list',items:[{text:o.a.fileMenu.excelFile,value:g.Excel},{text:o.a.fileMenu.csvFile,value:g.Csv},{text:' ',enabled:!1},{text:o.a.fileMenu.spreadSheetJsonFile,value:g.SSJson}],bindingPath:'activeCategory_import'}],width:'350px'},{type:'Column',children:[m,S,f,F],width:'stretch'}]}]},v={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadSheetJsonFile},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportSpreadSheetFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_export_ssjson',iconPosition:'top'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportJSFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_export_javascript',iconPosition:'top'},{type:'ColumnSet',children:[{type:'Column',children:[{type:'TextBlock',margin:'0 0 0 50px',text:o.a.fileMenu.exportSheetLabel,style:'line-height:30px;'}],width:'230px'},{type:'Column',children:[{type:'ListComboEditor',margin:'3px 0 0 10px',bindingPath:'exportJsonSetting.sheetToExport'}],width:'220px'}]}],visibleWhen:'activeCategory_export='+g.SSJson},T={type:'Container',id:'c_computerContent',className:'sub-category-content file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 10px 50px',text:o.a.fileMenu.saveFlags},...function(I){let J=[{text:o.a.fileMenu.importExportOptions.includeStyles,tips:o.a.fileMenu.exportOptionsTips.includeStyles,name:'includeStyles'},{text:o.a.fileMenu.importExportOptions.includeFormulas,tips:o.a.fileMenu.exportOptionsTips.includeFormulas,name:'includeFormulas'},{text:o.a.fileMenu.importExportOptions.includeUnusedNames,tips:o.a.fileMenu.exportOptionsTips.includeUnusedNames,name:'includeUnusedNames'},{name:''},{text:o.a.fileMenu.importExportOptions.saveAsView,tips:o.a.fileMenu.exportOptionsTips.saveAsView,name:'saveAsView'},{text:o.a.fileMenu.importExportOptions.includeBindingSource,tips:o.a.fileMenu.exportOptionsTips.includeBindingSource,name:'includeBindingSource'},{text:o.a.fileMenu.importExportOptions.includeEmptyRegionCells,tips:o.a.fileMenu.exportOptionsTips.includeEmptyRegionCells,name:'includeEmptyRegionCells'},{text:o.a.fileMenu.importExportOptions.includeAutoMergedCells,tips:o.a.fileMenu.exportOptionsTips.includeAutoMergedCells,name:'includeAutoMergedCells'},{name:''},{text:o.a.fileMenu.importExportOptions.rowHeadersAsFrozenColumns,tips:o.a.fileMenu.exportOptionsTips.rowHeadersAsFrozenColumns,name:'rowHeadersAsFrozenColumns'},{text:o.a.fileMenu.importExportOptions.columnHeadersAsFrozenRows,tips:o.a.fileMenu.exportOptionsTips.columnHeadersAsFrozenRows,name:'columnHeadersAsFrozenRows'}];return J.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${I}px`,text:z.text,bindingPath:'exportXlsxOptions.'+z.name,tips:z.tips}})}(50),{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'exportXlsxOptions.password',placeholder:o.a.fileMenu.exportPassword},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_export_excel',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.Excel},E={type:'Container',id:'c_computerContent',className:'sub-category-content file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 0 50px',text:o.a.fileMenu.saveFlags},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportIgnoreStyle,bindingPath:'exportExcelSetting.ignoreStyle'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportIgnoreFormulas,bindingPath:'exportExcelSetting.ignoreFormula'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportIncludeBindingSource,bindingPath:'exportExcelSetting.includeBindingSource'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportSaveAsViewed,bindingPath:'exportExcelSetting.saveAsView'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportSaveBothCustomRowAndColumnHeaders,className:'category-content-text',bindingPath:'exportExcelSetting.exportRowAndColumnHeaders'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.exportSaveCustomRowHeaders,bindingPath:'exportExcelSetting.exportRowHeaders',className:'file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.exportSaveCustomColumnHeaders,bindingPath:'exportExcelSetting.exportColumnHeaders',className:'file-menu-excel-option'},{type:'TextBlock',margin:'5px 0 0 50px',text:o.a.fileMenu.exportPassword},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'exportExcelSetting.password'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_export_io_excel',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.ExcelIO},B={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.csvFile},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportSheetIndex},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.sheetIndex'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportEncoding},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.encoding'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportRow},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.row'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportColumn},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.column'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportRowCount},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.rowCount'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportColumnCount},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.columnCount'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportRowDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.rowDelimiter'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportColumnDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.columnDelimiter'},{type:'Button',margin:'10px 50px',text:o.a.fileMenu.exportCsvFile,width:120,height:120,iconClass:'icon-common icon-csv',bindingPath:'button_export_csv',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.Csv},P={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.pdfFile},{type:'LabelLine',margin:'0 50px',text:o.a.fileMenu.pdfBasicSetting},{type:'ColumnSet',children:[{type:'Column',children:[{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfTitle,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfAuthor,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfApplication,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfSubject,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfKeyWords,style:'line-height:30px;width:100px'}],width:'auto'},{type:'Column',children:[{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.title'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.author'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.creator'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.subject'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.keywords'}],width:'auto'}]},{type:'LabelLine',margin:'10px 0 0 50px',text:o.a.fileMenu.pdfExportSetting},{type:'ColumnSet',children:[{type:'Column',children:[{type:'TextBlock',margin:'0 0 0 80px',text:o.a.fileMenu.exportSheetLabel,style:'line-height:30px;'}],width:'230px'},{type:'Column',children:[{type:'ListComboEditor',margin:'3px 0 0 10px',bindingPath:'exportPdfSetting.sheetToExport'}],width:'220px'}]},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportPdfFile,width:120,height:120,iconClass:'icon-common icon-pdf',bindingPath:'button_export_pdf',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.Pdf},A={type:'Container',visibleWhen:'activeCategory_main=Export',children:[{type:'TextBlock',margin:'50px 0 15px 50px',text:o.a.fileMenu.export,style:'font-size:36px;line-height:80px'},{type:'ColumnSet',margin:'0 0 0 50px',children:[{type:'Column',children:[{type:'List',className:'file-menu-list',items:[{text:o.a.fileMenu.excelFile,value:g.Excel},{text:o.a.fileMenu.csvFile,value:g.Csv},{text:o.a.fileMenu.pdfFile,value:g.Pdf},{text:' ',enabled:!1},{text:o.a.fileMenu.spreadSheetJsonFile,value:g.SSJson}],bindingPath:'activeCategory_export'}],width:'350px'},{type:'Column',children:[v,E,T,B,P],width:'stretch'}]}]},N={type:'Container',visibleWhen:'activeCategory_main=Info',children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.fileMenu.info.title,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[{type:'Container',className:'file-menu-setting-container',margin:'0 0 15px 46px',children:[{type:'FileMenuInfoEditor',bindingPath:'docProps'}]}]}]}]},_={type:'Container',visibleWhen:`activeCategory_main=${p.OpenSJS}`,children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.fileMenu.open,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[C]}]}]},R={type:'Container',visibleWhen:`activeCategory_main=${p.SaveSJS}`,children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.fileMenu.save,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[b]}]}]},L={type:'Container',visibleWhen:`activeCategory_main=${p.Recent}`,children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.recent,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.recentWorkbooks},{type:'FileMenuFileList',margin:'0 10px 0 50px',bindingPath:'recentWorkbookFiles_open'}],visibleWhen:'activeCategory_open='+g.RecentWorkbooks}]}]},V={type:'FlexContainer',children:[{type:'ColumnSet',children:[{type:'Column',children:[{type:'Container',className:'gc-file-menu-category',children:[{type:'Container',className:'back-button-container',children:[{type:'Container',className:'back-button-icon'},{type:'Button',className:'back-button',bindingPath:'activeCategory_hide'}]},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.new,value:p.New}]},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.recent,value:p.Recent}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.open,value:p.OpenSJS},{text:o.a.fileMenu.save,value:p.SaveSJS}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.import,value:p.Import},{text:o.a.fileMenu.export,value:p.Export}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.print.title,value:p.Print}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.info.title,value:p.Info}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.exit,value:p.Exit}]}]}],width:'220px'},{type:'Column',className:'category-content-container',children:[u,D,A,{type:'Container',visibleWhen:'activeCategory_main=Print',children:[{type:'FileMenuPrintEditor',bindingPath:'printSetting'}]},_,R,L,N],width:'stretch'}]}]},W={templateName:'fileMenuPanelTemplate',content:[V]}},function(t,a,l){'use strict';Object.defineProperty(a,'__esModule',{value:!0});l(9)}]);
