(function(t){function a(o){if(l[o])return l[o].exports;var p=l[o]={i:o,l:!1,exports:{}};return t[o].call(p.exports,p,p.exports,a),p.l=!0,p.exports}var l={};return a.m=t,a.c=l,a.i=function(o){return o},a.d=function(o,p,g){a.o(o,p)||Object.defineProperty(o,p,{configurable:!1,enumerable:!0,get:g})},a.n=function(o){var p=o&&o.__esModule?function(){return o['default']}:function(){return o};return a.d(p,'a',p),p},a.o=function(o,p){return Object.prototype.hasOwnProperty.call(o,p)},a.p='',a(a.s=24)})([function(t,a,l){'use strict';var o=l(17);l.d(a,'a',function(){return p});var p=GC.Spread.Sheets.Designer.getResources();for(var g in o.a)p[g]=o.a[g]},function(t,a){'use strict';function o(F){if(GC.Spread.Sheets.TableSheet&&GC.Spread.Sheets.TableSheet.TableSheet)return F instanceof GC.Spread.Sheets.TableSheet.TableSheet}a.b=o,a.c=function(F){let C=new GC.Spread.Sheets.Worksheet(F.name());try{C.suspendPaint(),C.suspendCalcService(),C.suspendDirty(),C.suspendEvent(),C.fromJSON(F.applyFreeHeaderArea());let M=F.getSelections(GC.Spread.Sheets.SheetArea.colHeader);if(M.length&&0<M.length){let D=M[0];C.setSelection(D.row,D.col,D.rowCount,D.colCount)}}catch(M){}return C},a.a=function(F){let C=F.getActiveSheet();if(!C){let M=F.getActiveSheetTab();!o(M)&&M&&M.getSheet&&(C=M.getSheet())}return C},a.g=function(F){let C=F&&F.slicers.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.h=function(F){let C=F&&F.pictures.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.i=function(F){let C=F&&F.charts.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.f=function(F){let C=F&&F.shapes.all();if(C)for(let M=0;M<C.length;M++)if(C[M].isSelected())return!0;return!1},a.d=function(F){return GC.Spread.Report&&GC.Spread.Report.ReportSheet&&F instanceof GC.Spread.Report.ReportSheet},a.e=function(F){let C=F.getActiveSheetTab();return o(C)?F.getActiveSheet()||C:C&&C.getSheet?C.getSheet():F.getActiveSheet()}},function(t,a,l){'use strict';var o=l(0),p=l(1);l.d(a,'a',function(){return m});let g;var m;(function(u){u.runCommand=function(f,y,F,C){let M=f.commandManager(),D='Designer.'+y;M.getCommand(D)||M.register(D,F,void 0,!1,!1,!1,!1);let v=l.i(p.e)(f)||l.i(p.a)(f);if(v=v,!C.sheetName){let b;b=v?v.name():f.getActiveSheetTab()&&f.getActiveSheetTab().name(),C.sheetName=b}else v=f.getSheetFromName(C.sheetName);if(l.i(p.b)(v)?!C.selections&&(C.selections=v&&v.getSelections(GC.Spread.Sheets.SheetArea.colHeader)):(!C.selections&&(C.selections=v&&v.getSelections()),C.activeRowIndex===g&&(C.activeRowIndex=v&&v.getActiveRowIndex()),C.activeColIndex===g&&(C.activeColIndex=v&&v.getActiveColumnIndex())),!C.selections)if(v)C.selections=v.getSelections();else{let b=f.getActiveSheetTab();l.i(p.b)(b)&&(C.selections=b&&b.getSelections(GC.Spread.Sheets.SheetArea.colHeader))}return C.cmd=D,M.execute(C)};u.DesignerActionBase=class{constructor(f,y){this._spread=f,this._sheet=f.getSheetFromName(y.sheetName)||f.getSheetTab(y.sheetName)}canExecute(){return!0}spread(){return this._spread}sheet(){return this._sheet}undoImp(f,y){return f.suspendPaint(),GC.Spread.Sheets.Commands.undoTransaction(f,y),f.resumePaint(),!0}execute(f,y,F){let C=this,M=!1;if(F)M=C.undoImp.call(C,f,y,F);else if(C.canExecute()){let D=GC.Spread.Sheets.Commands;D.startTransaction(f,y),f.suspendPaint();try{M=C.executeImp(f,y,F)}finally{f.resumePaint(),D.endTransaction(f,y)}}return void 0===M||!1===M||'designer.changeShapeStyle'===y.cmd||'designer.insertShape'===y.cmd,M}execInSelections(f,y,F){let C,M,D=y.selections;for(let v=0;v<D.length;v++){let b=D[v],H=b.col,T=b.row,E=b.rowCount,P=b.colCount;if(-1===H&&-1===T)F(f,-1,-1);else if(-1===T)for(C=0;C<P;C++)F(f,-1,H+C);else if(-1===H)for(C=0;C<E;C++)F(f,T+C,-1);else for(C=0;C<E;C++)for(M=0;M<P;M++)F(f,T+C,H+M)}}execInSelectionsForSetStyle(f,y,F){let C,M,D=y.selections;for(let v=0;v<D.length;v++){let B,O,b=D[v],H=b.col,T=b.row,E=b.rowCount,P=b.colCount;if(!(-1===H||-1===T))for(C=0;C<E;C++)for(M=0;M<P;M++)F(f,T+C,H+M);else if(-1===H&&-1===T){for(B=0;B<E;B++)F(f,B,-1);for(O=0;O<P;O++)F(f,-1,O);for(B=0;B<E;B++)for(O=0;O<P;O++)F(f,B,O)}else if(-1===H){for(B=0;B<E;B++)F(f,B+T,-1);for(B=0;B<E;B++)for(O=0;O<P;O++)F(f,B+T,O)}else if(-1===T){for(O=0;O<P;O++)F(f,-1,O+H);for(B=0;B<E;B++)for(O=0;O<P;O++)F(f,B,O+H)}}}execInSelectionsForRow(f,y,F){let C=y.selections;for(let M=0;M<C.length;M++){let D=C[M],v=-1===D.row?0:D.row;for(let b=0;b<D.rowCount;b++)F(f,v+b)}}execInSelectionsForCol(f,y,F){let C=y.selections;for(let M=0;M<C.length;M++){let D=C[M],v=-1===D.col?0:D.col;for(let b=0;b<D.colCount;b++)F(f,v+b)}}execInSelectionsForCell(f,y,F){let C=y.selections;for(let M=0;M<C.length;M++){let D=C[M],v=-1===D.col?0:D.col,b=-1===D.row?0:D.row;for(let H=0;H<D.rowCount;H++)for(let T=0;T<D.colCount;T++)F(f,b+H,v+T)}}getActualFont(f,y,F){let C=f.getStyle(y,F),M=C?C.font:'14.6667px Calibri',D=f.getActualStyle(y,F).font;return M===D?D||o.a.defaultFont:M||o.a.defaultFont}clearSpansInSelection(f,y){if(f&&y){let F=[],C=y.row,M=y.col,D=y.rowCount,v=y.colCount;f.getSpans().forEach(function(b){b.intersect(C,M,D,v)&&F.push(b)}),F.forEach(function(b){f.removeSpan(b.row,b.col)})}}getKey(f,y){return[f,y].join(',')}getPosition(f){let y=f&&f.split(',');return y&&2===y.length?{row:+y[0],column:+y[1]}:null}setFontStyle(f,y,F,C,M,D){let v=this;y.font||(y.font=v.getActualFont(f,M,D));let b=document.createElement('span');b.style.font=y.font,'font-family'===F&&v.needAddDoubleQuotes(C)&&(C='"'+C+'"'),b.style[F]=C,y.font=b.style.font,f.setStyle(M,D,y)}needAddDoubleQuotes(f){if('string'==typeof f){let y=f.trim(),F=y[0],C=y[y.length-1];return-1<y.indexOf(' ')&&('"'!==F||'"'!==C)}}undoSetStyle(f,y){let F=this,C=F._sheet,M=F._spread,D=y._styles;if(D){M.suspendPaint();for(let v of Object.keys(D)){let b=F.getPosition(v),H=D[v];if(b){let T=b.row,E=b.column,P=C.getStyle(T,E);P[f]='backColor'===f?H||void 0:H,C.setStyle(T,E,P)}}M.resumePaint()}return!0}setStyle(f,y,F,C,M,D){let v=this,b=v._sheet,H=v._spread,T=b,E=l.i(p.b)(b);E?T=l.i(p.c)(b):l.i(p.d)(b)&&b.getSheet&&(T=b.getSheet()),C._styles={},H.suspendPaint(),v.execInSelectionsForSetStyle(T,C,function(P,B,O){let A=P.getStyle(B,O);A||(A=new GC.Spread.Sheets.Style),C._styles[v.getKey(B,O)]=A[y],M&&(F=M.apply(v,[P,B,O,A,F].concat(D||[])),A[y]=F,P.setStyle(B,O,A)),0<=['font-size','font-weight','font-style'].indexOf(f)?v.setFontStyle(P,A,f,F,B,O):'font-family'===f?(A.themeFont=g,v.setFontStyle(P,A,f,F,B,O)):(A[y]=F,P.setStyle(B,O,A),'wordWrap'===y&&v._sheet.defaults.rowHeight===v._sheet.getRowHeight(B)&&P.autoFitRow(B))}),H.resumePaint(),E&&b.applyFreeHeaderArea(T.toJSON())}getTextDecoration(f,y,F,C,M,D){let v=this;C.textDecoration||(C.textDecoration=v.getActualDecoration(f,y,F));let b=C.textDecoration||GC.Spread.Sheets.TextDecorationType.none;return M?1==(1&b)&&8==(8&D)?(b^=1,b|=8):8==(8&b)&&1==(1&D)?(b^=8,b|=1):b|=D:b^=D,b}getActualDecoration(f,y,F){return l.i(p.b)(f)&&(f=l.i(p.c)(f)),f.getActualStyle(y,F).textDecoration}}})(m||(m={}))},function(t,a,l){'use strict';var o=l(8),p=l(0);l.d(a,'i',function(){return g}),l.d(a,'a',function(){return m}),l.d(a,'b',function(){return u}),l.d(a,'h',function(){return x}),l.d(a,'e',function(){return S}),l.d(a,'c',function(){return f}),l.d(a,'g',function(){return y}),l.d(a,'d',function(){return F}),l.d(a,'f',function(){return C});let g={ClickViewport:'ClickViewport',ClickCorner:'ClickCorner',ClickColHeader:'ClickColHeader',ClickRowHeader:'ClickRowHeader',PivotTableSelected:'PivotTableSelected',TableSheetClickCorner:'TableSheetClickCorner',TableSheetClickViewport:'TableSheetClickViewport',TableSheetClickRowHeader:'TableSheetClickRowHeader',TableSheetClickColHeader:'TableSheetClickColHeader',GanttSheetClickRowHeader:'GanttSheetClickRowHeader',GanttSheetClickColHeader:'GanttSheetClickColHeader',GanttSheetClickFields:'GanttSheetClickFields'},m={type:'groupHeader',text:'${res.contextMenu.paste}',commandName:'designer.pasteElectron',iconClass:'gc-spread-pasteOptions',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`},u={commandName:'designer.pasteAllElectron',iconClass:'gc-spread-pasteAll',group:'designer.pasteElectron',text:'${res.contextMenu.pasteAll}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader} `,execute:o.b.execute},x={commandName:'designer.tableSheetPasteElectron',iconClass:'gc-spread-pasteOptions',text:'${res.contextMenu.tableSheetPaste}',visibleContext:`${g.TableSheetClickCorner} || ${g.TableSheetClickViewport} || ${g.TableSheetClickRowHeader} || ${g.TableSheetClickColHeader}`,execute:o.d.execute},S={commandName:'designer.pasteFormattingElectron',iconClass:'gc-spread-pasteFormatting',group:'designer.pasteElectron',text:'${res.contextMenu.pasteFormatting}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.e.execute},f={commandName:'designer.pasteFormulasElectron',iconClass:'gc-spread-pasteFormula',group:'designer.pasteElectron',text:'${res.contextMenu.pasteFormula}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.c.execute},y={commandName:'designer.pasteFormulasAndFormattingElectron',iconClass:'gc-spread-pasteFormulaFormatting',group:'designer.pasteElectron',text:'${res.contextMenu.pasteFormulaFormatting}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.g.execute},F={commandName:'designer.pasteValuesElectron',iconClass:'gc-spread-pasteValues',group:'designer.pasteElectron',text:'${res.contextMenu.pasteValue}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader}  || ${g.ClickRowHeader}`,execute:o.d.execute},C={commandName:'designer.pasteValuesAndFormattingElectron',iconClass:'gc-spread-pasteValuesFormatting',group:'designer.pasteElectron',text:'${res.contextMenu.pasteValuesFormatting}',visibleContext:`!${g.PivotTableSelected} && ${g.ClickViewport} || ${g.ClickCorner} || ${g.ClickColHeader} || ${g.ClickRowHeader}`,execute:o.f.execute}},function(t,a,l){'use strict';function o(b,H){let T=window.osenv;try{let E=T.getSystemFonts();E?(H.length=0,E.forEach((P)=>{P&&H.push({text:P.fontLocalizedName,value:P.fontOriginName})})):p(H)}catch(E){p(H)}}function p(b){let H=x.a.ribbon.fontFamilies,T='ff',E=1,P=T+E;for(;H[P];)b.push({text:H[P].text,value:H[P].name}),E++,P=T+E}function g(b,H=!0){let T=null,E=null,P='',B='normal',O='normal',A='normal',_=b.split(/\s+/);for(let N=0;N<_.length;N++)switch(_[N]){case'normal':break;case'italic':P=-1===P.indexOf('bold')?_[N]:'bold italic';break;case'bold':P=-1===P.indexOf('italic')?_[N]:'bold italic',B='bold';break;case'small-caps':O=_[N];break;case'100':case'200':case'300':case'400':case'500':case'600':case'700':case'800':case'900':B=_[N];break;default:if(!E){let R=_[N].split('/');E=R[0],-1!==E.indexOf('px')&&H&&(E=m(parseFloat(E))+'pt'),1<R.length&&(A=R[1],-1!==A.indexOf('px')&&H&&(A=m(parseFloat(A))+'pt'));break}T?T+=' '+_[N]:T=_[N];}return P||(P='normal'),{fontStyle:P,fontVariant:O,fontWeight:B,fontSize:E,lineHeight:A,fontFamily:T}}function m(b){if(null==M){let H=document.createElement('span');H.style.fontSize='96pt',H.style.display='none',document.body.appendChild(H);try{M=window.getComputedStyle(H).fontSize}finally{document.body.removeChild(H)}}if(M&&-1!==M.indexOf('px')){let H=parseFloat(M);return Math.round(96*b/H)}return Math.round(72*b/96)}function u(b,H){S.a.runCommand(b,'setFontFamily',D,{value:H})}var x=l(0),S=l(2),f=l(1);l.d(a,'a',function(){return C});const F={Trial:3,Valid:0,Expired:1,Unlicensed:2,Invalid:4};a.b=F;let C={title:'${res.ribbon.home.fontFamily}',type:'comboBox',text:'Calibri',comboWidth:100,commandName:'fontFamilyNative',dropdownList:[],dropdownMaxHeight:500,enableContext:'AllowFormatCells',execute:async(b,H)=>{null!==H&&H!==void 0&&u(b.Spread,H)},getState:(b,H)=>{let T=window.osenv,E=T._ms[2]&&T._ms[2]();b.setData('fileMenuShow',E===F.Expired||E===F.Invalid||E===F.Unlicensed),b.setData('activeShow',E===F.Expired||E===F.Invalid||E===F.Unlicensed||E===F.Trial);let P=b.Spread.getActiveSheet()||b.Spread.getActiveSheetTab();if(P&&(l.i(f.b)(P)?P=l.i(f.c)(P):l.i(f.d)(P)&&P.getSheet&&(P=P.getSheet()),!!P)){let B=P.getActualStyle(P.getActiveRowIndex(),P.getActiveColumnIndex()),O='';if(B&&B.font){let A=g(B.font);if(A.fontFamily){let _=A.fontFamily.split(','),N=_[0];N.match(/^["'].*["']$/)&&(N=N.substring(1,N.length-1));let R=new RegExp('^(.*,s*)?["\']?'+N+'["\']?s*(,.*)?$');for(let L in x.a.ribbon.fontFamilies)if(R.test(x.a.ribbon.fontFamilies[L].name)){N=x.a.ribbon.fontFamilies[L].text;break}O=N}}else{let A=g(x.a.defaultFont);O=A.fontFamily||''}return H&&o(b,H.dropdownList),O}}},M=null,D={canUndo:!0,execute:function(b,H,T){let E=new v(b,H);return E.execute(b,H,T)}};class v extends S.a.DesignerActionBase{executeImp(b,H){let E=this;E.setStyle('font-family','font',H.value,H)}}},function(t,a,l){'use strict';function o(S){let F,y=[];for(let C=0;C<arguments.length-1;C++)y[C]=arguments[C+1];return 1<y.length?S.replace(/{(1)}/gm,y[0]).replace(/{(2)}/gm,y[1]):(F=/{(\d+)}/gm,S.replace(F,function(C,M){return y[~~M]}))}var p=l(0),g=l(4);l.d(a,'a',function(){return u});const m='zh-cn';let u={title:p.a.ribbon.accessBar.active,commandName:'activeElectron',iconClass:'gc-accessbar-active',execute:(S)=>{let y=window.osenv;y&&y._hasOpenedActiveDialog&&GC.Spread.Sheets.Designer.closeDialog('activeDialogTemplate');var F=window._ssCulture,C=S.getWorkbook();let M=y._ms[2]&&y._ms[2](),D='',v='',b=!1;switch(M){case g.b.Unlicensed:D=p.a.L.f,v=p.a.B&&p.a.B.n,b=!0;break;case g.b.Trial:let O=y._ms[0]&&y._ms[0]();D=O.h?o(p.a.L.t,y._ls.n)+'\r\n'+o(p.a.L.d,-1===C.ls.m?p.a.L.T[1]:p.a.L.T[2],y._ls.d):p.a.L.f;break;case g.b.Expired:D=p.a.L.e,v=p.a.B&&p.a.B.e,b=!0;break;case g.b.Invalid:D=p.a.L.i;}if(b&&F===m){var H=document.querySelector('.gc-lc-invalid-ss-container'),T=C.getHost();if(T&&!H){H=document.createElement('div'),H.classList.add('gc-lc-invalid-ss-container'),H.style.width=T.offsetWidth+'px',H.style.height=T.offsetHeight+120+'px',H.innerText=v,T.parentElement&&T.parentElement.appendChild(H),T.style.display='none';var E=S.getData('container'),P=E&&E.querySelector('.ribbon-panel');P&&P.classList.add('gc-lc-invalid-ribbon-panel')}}if(GC.Spread.Sheets.Designer.registerTemplate('activeDialogTemplate',x(D,F)),y._hasOpenedActiveDialog=!0,GC.Spread.Sheets.Designer.showDialog('activeDialogTemplate',void 0,(O)=>{let A=window.osenv;y._hasOpenedActiveDialog=!1,O&&O.licenseKey&&O.licenseKey.trim()&&A._ms[1]&&(A._ms[1](O.licenseKey),GC.Spread.Sheets.Designer.showMessageBox(p.a.L.U,p.a.L.l,GC.Spread.Sheets.Designer.MessageBoxIcon.info,()=>{A.restartApp()},void 0,GC.Spread.Sheets.Designer.MessageBoxButtons.ok))}),F===m){var B=document.getElementById('openWebLink');B&&(B.onclick=function(O){O.preventDefault(),window.open('https://www.grapecity.com.cn/developer/spreadjs/register?pid=615')})}},visibleContext:'activeShow'},x=function(S,f){var y={templateName:'activeDialogTemplate',title:p.a.L.l,content:[{type:'FlexContainer',children:[{type:'TextBlock',text:S,margin:'5px 0'},{type:'TextBlock',text:p.a.L.k,margin:'5px 0'},{type:'TextEditor',multiLine:!0,style:'height:170px',bindingPath:'licenseKey',margin:'5px 0'}]}],width:'550px'};if(f===m&&p.a.B){var F={type:'TextBlock',text:'<span style=\'font-size: large;font-weight: 900;\'>'+p.a.B.l+'</span>',style:'text-align: center;margin-top: 10px;margin-bottom:10px;',useRawContent:!0},C={type:'TextBlock',text:'<button type=\'button\' id=\'openWebLink\' style=\'width:120px;text-align:center;position:relative;left:35%;height:33px;background:rgb(148,25,102);border:none;cursor:pointer;color:white;border-radius:3px\'>'+p.a.B.b+'</button>',useRawContent:!0};y.content[0].children.splice(1,0,F),y.content[0].children.splice(2,0,C)}return y}},function(t,a,l){'use strict';function o(F){let C=F.Spread,M=l.i(u.a)(C);if(l.i(u.f)(M))g(C);else if(l.i(u.g)(M)||l.i(u.h)(M)||l.i(u.i)(M))p(C);else{let D=window.osenv;m(C,function(b,H){D.setClipboardData({text:b,html:H})})}}function p(F){F.commandManager().execute({cmd:'copyFloatingObjects',sheetName:l.i(u.a)(F).name()})}function g(F){F.commandManager().execute({cmd:'copyShapes',sheetName:l.i(u.a)(F).name()})}function m(F,C){x.a.runCommand(F,'copy',y,{callback:C})}var u=l(1),x=l(2);l.d(a,'a',function(){return S});let S={title:'${res.ribbon.home.copy}',iconClass:'ribbon-button-copy',commandName:'copyElectron',execute:(F)=>{o(F)}};class f extends x.a.DesignerActionBase{executeImp(F,C){let v=C.sheetName,b={};b.cmd='copy',b.sheetName=v,b.ignoreClipboard=!0,b.callback=function(){C.callback(b.copyData.copyText,b.copyData.copyHtml)},F.commandManager().execute(b)}}let y={canUndo:!1,execute:function(F,C,M){let D=new f(F,C);return D.execute(F,C,M)}}},function(t,a,l){'use strict';function o(F){let C=F.Spread,M=l.i(u.a)(C);if(l.i(u.f)(M))g(C);else if(l.i(u.g)(M)||l.i(u.h)(M)||l.i(u.i)(M))p(C);else{m(C,function(v,b){let H=window.osenv;H.setClipboardData({text:v,html:b})})}}function p(F){F.commandManager().execute({cmd:'cutFloatingObjects',sheetName:l.i(u.a)(F).name()})}function g(F){F.commandManager().execute({cmd:'cutShapes',sheetName:l.i(u.a)(F).name()})}function m(F,C){x.a.runCommand(F,'cut',f,{callback:C})}var u=l(1),x=l(2);l.d(a,'a',function(){return S});let S={title:'${res.ribbon.home.cut}',iconClass:'ribbon-button-cut',commandName:'cutElectron',enableContext:'!IsIncludeLockedCell',execute:(F)=>{o(F)}},f={canUndo:!1,execute:function(F,C,M){let D=new y(F,C);return D.execute(F,C,M)}};class y extends x.a.DesignerActionBase{executeImp(F,C){let v=C.sheetName,b={};b.cmd='cut',b.sheetName=v,b.ignoreClipboard=!0,b.callback=function(){C.callback(b.cutData.copyText,b.cutData.copyHtml)},F.commandManager().execute(b)}}},function(t,a,l){'use strict';function o(H,T){let E,P=window.osenv,B=P.getClipboardText(),O=P.getClipboardHTML();if(E='',B){let A='"',_=A.length,N=!1;for(let L,R=0;R<B.length;R++)L=B[R],!N&&'\n'===L&&B[R-1]&&'\r'!==B[R-1]&&(L='\r\n'),E+=L,E.length>=_&&A===E.substr(E.length-_,_)&&(N=!N)}T===M.All?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.all,E,O):T===M.Formatting?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.formatting,E,O):T===M.Formulas?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.formulas,E,O):T===M.FormulasAndFormatting?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.formulasAndFormatting,E,O):T===M.Values?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.values,E,O):T===M.ValuesAndFormatting?p(H.Spread,GC.Spread.Sheets.ClipboardPasteOptions.valuesAndFormatting,E,O):void 0}function p(H,T,E,P){m.a.runCommand(H,'paste',v,{value:T,text:E,html:P,isFromDesigner:!0})}var g=l(1),m=l(2);l.d(a,'a',function(){return u}),l.d(a,'b',function(){return x}),l.d(a,'e',function(){return S}),l.d(a,'c',function(){return f}),l.d(a,'g',function(){return y}),l.d(a,'f',function(){return F}),l.d(a,'d',function(){return C});let u={title:'${res.ribbon.home.paste}',text:'${res.ribbon.home.paste}',iconClass:'ribbon-button-paste',bigButton:!0,commandName:'pasteElectron',enableContext:'!IsIncludeLockedCell',subCommands:['paste-all-electron','paste-formulas-electron','paste-values-electron','paste-formatting-electron','paste-valuesAndFormatting-electron','paste-formulasAndFormatting-electron']},x={text:'${res.ribbon.home.all}',title:'${res.ribbon.home.all}',direction:'=IF(ribbonHeight>toolbarHeight, "vertical", "horizontal")',iconClass:'ribbon-button-paste',bigButton:'=ribbonHeight>toolbarHeight',commandName:'paste-all-electron',enableContext:`!IsIncludeLockedCell`,execute:(H)=>{o(H,M.All)}},S={text:'${res.ribbon.home.formatting}',commandName:'paste-formatting-electron',execute:(H)=>{o(H,M.Formatting)}},f={text:'${res.ribbon.home.formulas}',commandName:'paste-formulas-electron',execute:(H)=>{o(H,M.Formulas)}},y={text:'${res.ribbon.home.formulasAndFormatting}',commandName:'paste-formulasAndFormatting-electron',execute:(H)=>{o(H,M.FormulasAndFormatting)}},F={text:'${res.ribbon.home.valuesAndFormatting}',commandName:'paste-valuesAndFormatting-electron',execute:(H)=>{o(H,M.ValuesAndFormatting)}},C={text:'${res.ribbon.home.values}',commandName:'paste-values-electron',execute:(H)=>{o(H,M.Values)}};const M={All:'paste-all-electron',Formulas:'paste-formulas-electron',Values:'paste-values-electron',Formatting:'paste-formatting-electron',ValuesAndFormatting:'paste-valuesAndFormatting-electron',FormulasAndFormatting:'paste-formulasAndFormatting-electron'};let v={canUndo:!1,execute:function(H,T,E){let P=new b(H,T);return P.execute(H,T,E)}};class b extends m.a.DesignerActionBase{executeImp(H,T){let P=this,B=l.i(g.a)(H);if(B)if(B.isPasteFloatingObject&&B.isPasteFloatingObject())H.commandManager().execute({cmd:'pasteFloatingObjects',sheetName:B.name()});else if(B.isPasteShapes&&B.isPasteShapes())H.commandManager().execute({cmd:'pasteShapes',sheetName:B.name()});else{let O=T.text,A=T.html;H.commandManager().execute({cmd:'paste',sheetName:B.name(),pasteText:O,pasteHtml:A,isFromDesigner:T.isFromDesigner,pasteOption:T.value})}}}},function(t,a,l){'use strict';async function o($){return new Promise((q)=>{setTimeout(()=>{q()},$)})}function p($,q){$.getActiveSheet()?$.bind('ClipboardStatusChanged',function(G,K){K.isReset&&!K.isSystemPasted&&q.setClipboardData({text:'',html:''})}):V.offAll()}function g($){let q=$;if($&&'object'==typeof $)for(let G in q={},$)$.hasOwnProperty(G)&&(q[G]=$[G]);return q}function m(){if(GC.Spread.Sheets.FormulaPanel){let $=document.activeElement;if($.classList.contains('cm-content')){let q=document.querySelector('.gc-formula-editor-container');return q&&q.contains($)?GC.Spread.Sheets.FormulaPanel.findControl(q):void 0}}}function u($,q){$&&(!$.docProps.coreDocProps&&($.docProps.coreDocProps={}),$.docProps.coreDocProps.modified=q)}var x=l(16),S=l(4),f=l(20),y=l(8),F=l(3),C=l(19),M=l(7),D=l(14),v=l(6),b=l(13),H=l(22),T=l(21),E=l(5),P=l(11),B=l(12),O=l(10),A=l(15),_=l(23),N=l(0),R=l(1);let L='',I=!1,J=new x.a(window.gc_native_app);window.addEventListener('unload',function(){J.saveConfigFile()}),window.osenv=J;const W={currentFolder:'currentFolder',fileMenuSetting:'fileMenuSetting'};GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle=function($){let q,G=$.getData('currentFilePath'),K=$.getData('osEnv');!0===$.getData('isFileModified')?G&&''!==G&&(q=K.getFileInfo(G).fileName,$.setData('modifiedFileName','* '+q+' - '+N.a.title),document.title=$.getData('modifiedFileName')):''===G?document.title=N.a.title:(q=K.getFileInfo(G).fileName,document.title=q+' - '+N.a.title,$.setData('shouldModifiedHandlerExecute',!0))},GC.Spread.Sheets.Designer.FileMenuHandler.save=async function($,q,G){let K,X=$.getData('isFirstImporting');return K=!$.getData('currentFilePath')||$.getData('isExcel')||X?await GC.Spread.Sheets.Designer.FileMenuHandler.saveAs($,void 0,q,G):await GC.Spread.Sheets.Designer.FileMenuHandler.saveCore($,$.getData('currentFilePath'),{},q,!1),Promise.resolve(K)},GC.Spread.Sheets.Designer.FileMenuHandler.saveAs=async function($){let Q,X=GC.Spread.Sheets.Designer.FileMenuHandler.getFileMenuOption($),Y=$.getData('InternalSaveFileType');Q='sjs'===Y?N.a.sjsFileFilter:'xlsx'===Y?N.a.excelFileFilter:'csv'===Y?N.a.csvFileFilter:N.a.spreadFileFilter;let Z={title:N.a.exportFileDialogTitle,nameFilters:[Q]},ee=await GC.Spread.Sheets.Designer.FileMenuHandler.export($,Z,X);return L=$.getData('currentFileNameInElectron'),L?($.setData('currentFilePath',L),$.setData('isFileModified',!1),$.getData('isFirstImporting')&&$.getData('isExcel')&&$.setData('isExcel',!1),$.setData('isFirstImporting',!1)):$.setData('currentFileNameInElectron',$.getData('currentFilePath')),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle($),Promise.resolve(ee)},GC.Spread.Sheets.Designer.FileMenuHandler.onNewFile=async function($){if($.getData('isFileModified')){let q=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch(q){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:let G=$.getData('currentFilePath'),K=await GC.Spread.Sheets.Designer.FileMenuHandler.save($,!1),X=$.getData('currentFilePath');K&&G===X&&(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore($));break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:$.setData('isFileModified',!1),GC.Spread.Sheets.Designer.FileMenuHandler.resetCore($);break;case GC.Spread.Sheets.Designer.MessageBoxResult.cancel:}}else GC.Spread.Sheets.Designer.FileMenuHandler.resetCore($)},GC.Spread.Sheets.Designer.FileMenuHandler.exportJson=async function($,q){let G={title:N.a.exportFileDialogTitle,nameFilters:[N.a.spreadFileFilter]},K=await GC.Spread.Sheets.Designer.FileMenuHandler.export($,G,q);return Promise.resolve(K)},GC.Spread.Sheets.Designer.FileMenuHandler.exportJS=async function($,q){let G={title:N.a.exportFileDialogTitle,nameFilters:[N.a.ssJSONToJSFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.exportExcel=async function($,q){let G={title:N.a.exportFileDialogTitle,nameFilters:[N.a.excelFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.exportCsv=async function($,q){let G=q.exportCsvSetting;if(G&&!$.Spread.sheets[G.sheetIndex]){let X=$.getData('container');return GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),void(await GC.Spread.Sheets.Designer.showMessageBox(N.a.exportCsvSheetIndexError,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning,GC.Spread.Sheets.Designer.MessageBoxButtons.ok))}let K={title:N.a.exportFileDialogTitle,nameFilters:[N.a.csvFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export($,K,q)},GC.Spread.Sheets.Designer.FileMenuHandler.exportPdf=async function($,q){let G={title:N.a.exportFileDialogTitle,nameFilters:[N.a.pdfFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.export=async function($,q,G){let K=q,X=Promise.resolve(!1);K||(K={title:N.a.exportFileDialogTitle,nameFilters:[N.a.sjsFileFilter,N.a.spreadFileFilter,N.a.ssJSONToJSFilter,N.a.excelFileFilter,N.a.csvFileFilter,N.a.allFileFilter]}),u($.Spread,new Date);let Q=$.getData('osEnv'),Y=Q.showSaveDialog(K);if('cancelled'===Y.status)return $.setData('currentFileNameInElectron',''),X;if(Y.fileName){$.setData('currentFileNameInElectron',Y.fileName);let Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveCore($,Y.fileName,G,!1,!0);return Promise.resolve(Z)}return X},GC.Spread.Sheets.Designer.FileMenuHandler.saveCore=async function($,q,G,K,X){let Q;G&&G.exportJsonSetting&&G.exportJsonSetting.sheetToExport&&void 0!==G.exportJsonSetting.sheetToExport.selectedValue&&(Q=+G.exportJsonSetting.sheetToExport.selectedValue);let Z,Y=GC.Spread.Sheets.Designer.FileMenuHandler.getFileExtension(q);return'ssjson'===Y||'json'===Y?Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveJson($,q,K,X,!1,Q):'js'===Y?Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveJson($,q,K,X,!0,Q):'csv'===Y||'pdf'===Y||'xlsx'===Y||'sjs'===Y?Z=await GC.Spread.Sheets.Designer.FileMenuHandler.saveOtherFormat($,q,G,K,X):void 0,Z},GC.Spread.Sheets.Designer.FileMenuHandler.saveJson=async function($,q,G,K,X,Q){let Y=$.Spread;Q!==void 0&&(Y=GC.Spread.Sheets.Designer.FileMenuHandler.cloneSpreadBySheetIndex($.Spread,Q));let Z=GC.Spread.Sheets.Designer.FileMenuHandler.spreadToJSON($,Y),ee=$.getData('treeNodeFromJson')||$.getData('updatedTreeNode')||$.getData('oldTreeNodeFromJson');ee&&(Z.designerBindingPathSchema='string'==typeof ee?JSON.parse(ee):ee);let te=$.getData('osEnv'),ne=te.save(q,JSON.stringify(Z),X);return'failed'===ne.status?(await GC.Spread.Sheets.Designer.showMessageBox(ne.message,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error),Promise.resolve(!1)):(K||($.setData('currentFilePath',q),$.setData('isFileModified',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle($),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList($,q)),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($),G&&te.exit(),Promise.resolve(!0))},GC.Spread.Sheets.Designer.FileMenuHandler.saveOtherFormat=async function($,q,G,K,X){let Q=$.getData('container');GC.Spread.Sheets.Designer.FileMenuHandler.showLoadingPlaceHolder(Q);let Y=GC.Spread.Sheets.Designer.FileMenuHandler.getFileExtension(q),Z={spread:void 0,exportFileType:Y,needStringify:!1};if(G)switch(Y){case'xlsx':if(G.useExcelSJSFormat){let re=g(G.exportXlsxOptions);re.fileType=GC.Spread.Sheets.FileType.excel,Z.sjsExcel={setting:re},Z.spread=$.Spread}else{let re='';G.exportExcelSetting&&(re=G.exportExcelSetting.password||'');let le={includeBindingSource:G.exportExcelSetting&&G.exportExcelSetting.includeBindingSource,columnHeadersAsFrozenRows:G.exportExcelSetting&&G.exportExcelSetting.exportColumnHeaders,saveAsView:G.exportExcelSetting&&G.exportExcelSetting.saveAsView,ignoreFormula:G.exportExcelSetting&&G.exportExcelSetting.ignoreFormula,ignoreStyle:G.exportExcelSetting&&G.exportExcelSetting.ignoreStyle,rowHeadersAsFrozenColumns:G.exportExcelSetting&&G.exportExcelSetting.exportRowHeaders};Z.spread=$.Spread.toJSON(le),Z.excel={password:re},Z.needStringify=!0}break;case'csv':let ie=G.exportCsvSetting;if(ie)try{Z.csv={encoding:ie.encoding},Z.spread=$.Spread.sheets[ie.sheetIndex].getCsv(ie.row,ie.column,ie.rowCount,ie.columnCount,ie.rowDelimiter,ie.columnDelimiter),Z.needStringify=!0}catch(re){return GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(Q),void(await GC.Spread.Sheets.Designer.showMessageBox(re.message,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning,GC.Spread.Sheets.Designer.MessageBoxButtons.ok))}break;case'pdf':let ae=G.exportPdfSetting;if(ae){let re;ae.sheetToExport&&void 0!==ae.sheetToExport.selectedValue&&null!==ae.sheetToExport.selectedValue&&(re=+ae.sheetToExport.selectedValue),Z.spread=$.Spread,Z.pdf={setting:ae,sheetIndex:re}}break;case'sjs':Z.sjs={setting:g(G.saveOptions)},Z.spread=$.Spread;}else Z.spread=GC.Spread.Sheets.Designer.FileMenuHandler.spreadToJSON($,$.Spread),Z.needStringify=!0;let ee=$.getData('osEnv');Z.needStringify&&(Z=JSON.parse(JSON.stringify(Z)));let ne,te=await ee.exportFile(q,Z);try{'success'===te.status?(!X&&($.setData('currentFilePath',q),$.setData('isFileModified',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle($),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList($,q)),K&&ee.exit(),ne=Promise.resolve(!0)):(await GC.Spread.Sheets.Designer.showMessageBox(te.message,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error),ne=Promise.resolve(!1))}catch(ie){}finally{GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(Q),$.refresh()}return ne},GC.Spread.Sheets.Designer.FileMenuHandler.processPropertyChanged=function($,q,G){if(q){let X=$.getData(W.fileMenuSetting)||{};X[q.replace('.','_')]=G,q.endsWith('.calcOnDemand')&&G?X[q.replace('.calcOnDemand','_incrementalCalculation')]=!1:q.endsWith('.incrementalCalculation')&&G&&(X[q.replace('.incrementalCalculation','_calcOnDemand')]=!1),'printSetting'===q&&G&&$.setData(StatesNames.PrintPreviewFileMenuUpdateCache,!0),$.setData(W.fileMenuSetting,X);if(-1<['activeCategory_main','activeCategory_export','activeCategory_import'].indexOf(q)){let Y=document.querySelector(`.category-content-container [data-${q}=${G}]`);if(Y){for(let Z=0;Z<Y.children.length;Z++){const ee=Y.children[Z];ee.setAttribute('aria-hidden','true')}$.Spread.options.enableAccessibility&&Y.focus(),setTimeout(()=>{for(let Z=0;Z<Y.children.length;Z++){const ee=Y.children[Z];ee.removeAttribute('aria-hidden')}},500)}}}let K=GC.Spread.Sheets.Designer.FileMenuHandler.getFileMenuOption($);switch(q){case'activeCategory_hide':GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($);break;case'activeCategory_main':GC.Spread.Sheets.Designer.FileMenuHandler.processSelectMainCategory($,G);break;case'templateSetting':GC.Spread.Sheets.Designer.FileMenuHandler.processNewTemplate($),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($),$.setData('currentFileNameInElectron','');break;case'recentWorkbookFiles_open':let X=G.clickItem;if(X){let Q=X.filePath+'\\'+X.fileName;$.setData('currentFileNameInElectron',Q),GC.Spread.Sheets.Designer.FileMenuHandler.directOpen($,Q)}GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($);break;case'button_import_ssjson':GC.Spread.Sheets.Designer.FileMenuHandler.importJson($,K);break;case'button_export_ssjson':GC.Spread.Sheets.Designer.FileMenuHandler.exportJson($,K);break;case'button_import_excel_io':GC.Spread.Sheets.Designer.FileMenuHandler.importExcel($,K);break;case'button_export_io_excel':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcel($,K);break;case'button_open_sjs':GC.Spread.Sheets.Designer.FileMenuHandler.openSJS($,K);break;case'button_save_sjs':GC.Spread.Sheets.Designer.FileMenuHandler.saveSJS($,K);break;case'button_import_excel':GC.Spread.Sheets.Designer.FileMenuHandler.importExcelSJSFormat($,K);break;case'button_export_excel':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelSJSFormat($,K);break;case'button_import_csv':GC.Spread.Sheets.Designer.FileMenuHandler.importCsv($,K);break;case'button_export_javascript':GC.Spread.Sheets.Designer.FileMenuHandler.exportJS($,K);break;case'button_export_csv':GC.Spread.Sheets.Designer.FileMenuHandler.exportCsv($,K);break;case'button_export_pdf':GC.Spread.Sheets.Designer.FileMenuHandler.exportPdf($,K);break;case'exportExcelSetting.exportRowAndColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelRowAndColumnHandler($,K);break;case'exportExcelSetting.exportRowHeaders':case'exportExcelSetting.exportColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelRowOrColumnHandler($,K);break;case'importExcelSetting.importRowAndColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.importExcelRowAndColumnHandler($,K);break;case'importExcelSetting.importRowHeaders':case'importExcelSetting.importColumnHeaders':GC.Spread.Sheets.Designer.FileMenuHandler.importExcelRowOrColumnHandler($,K);break;case'docProps':GC.Spread.Sheets.Designer.FileMenuHandler.updateDocProps($,G);}},GC.Spread.Sheets.Designer.FileMenuHandler.resetCore=async function($){$.setData('isInParameterPanelDesignMode',!1);let q=$._getGlobalEvent();q.fire('DesignerReset'),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle($),p($.Spread,J)},GC.Spread.Sheets.Designer.FileMenuHandler.openSJS=async function($,q){let G={title:N.a.importFileDialogTitle,nameFilters:[N.a.sjsFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.saveSJS=async function($,q){let G={title:N.a.exportFileDialogTitle,nameFilters:[N.a.sjsFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.export($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.importCsv=async function($,q){let G={title:N.a.importFileDialogTitle,nameFilters:[N.a.csvFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.importJson=async function($,q){let G={title:N.a.importFileDialogTitle,nameFilters:[N.a.spreadFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.importExcel=async function($,q){let G={title:N.a.importFileDialogTitle,nameFilters:[N.a.excelFileFilter]};await GC.Spread.Sheets.Designer.FileMenuHandler.import($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.importExcelSJSFormat=async function($,q){let G={title:N.a.importFileDialogTitle,nameFilters:[N.a.excelFileFilter]};0!==q.importXlsxOptions.openMode&&(q.importXlsxOptions.progress=(K)=>{if(0<K.progress&&$.getData('FileMenu_show')){GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($);let X=$.getData('container');GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X)}}),q.useExcelSJSFormat=!0,await GC.Spread.Sheets.Designer.FileMenuHandler.import($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.exportExcelSJSFormat=async function($,q){let G={title:N.a.exportFileDialogTitle,nameFilters:[N.a.excelFileFilter]};q.useExcelSJSFormat=!0,await GC.Spread.Sheets.Designer.FileMenuHandler.export($,G,q)},GC.Spread.Sheets.Designer.FileMenuHandler.import=async function($,q,G){let K=q;K||(K={title:N.a.importFileDialogTitle,nameFilters:[N.a.spreadFileFilter,N.a.excelFileFilter,N.a.csvFileFilter,N.a.allFileFilter]});let X=$.getData('osEnv'),Q=await X.showOpenDialog(K);if('cancelled'!==Q.status&&Q.fileName){$.setData('isFirstImporting',!0);let Y=Q.fileName.substring(Q.fileName.lastIndexOf('.')+1);switch(Y.toLowerCase()){case'ssjson':await GC.Spread.Sheets.Designer.FileMenuHandler.openJson($,Q.fileName,!0);break;case'xlsx':case'csv':case'sjs':await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormat($,Q.fileName,G,!0);}}},GC.Spread.Sheets.Designer.FileMenuHandler.openJson=async function($,q,G){if($.getData('isFileModified')){let K=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch(K){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:await GC.Spread.Sheets.Designer.FileMenuHandler.save($,void 0,void 0),await GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore($,q,G);break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:$.setData('isFileModified',!1),await GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore($,q,G);break;case GC.Spread.Sheets.Designer.MessageBoxResult.cancel:}}else await GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore($,q,G)},GC.Spread.Sheets.Designer.FileMenuHandler.openBrowse=async function($,q){let G='';q&&q.openFileOption&&(G=q.openFileOption.filePath);let K={title:N.a.openFileDialogTitle,dirName:G,nameFilters:[N.a.allSpreadFileFilter,N.a.spreadFileFilter,N.a.excelFileFilter,N.a.sjsFileFilter,N.a.allFileFilter]},X=$.getData('osEnv'),Q=await X.showOpenDialog(K);'cancelled'===Q.status||Q.fileName&&(await GC.Spread.Sheets.Designer.FileMenuHandler.directOpen($,Q.fileName))},GC.Spread.Sheets.Designer.FileMenuHandler.directOpen=async function($,q){let G=q.substring(q.lastIndexOf('.')+1);switch(G.toLowerCase()){case'ssjson':case'json':await GC.Spread.Sheets.Designer.FileMenuHandler.openJson($,q);break;case'xlsx':case'csv':case'sjs':await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormat($,q,{encoding:'UTF8'});break;default:return void(await GC.Spread.Sheets.Designer.FileMenuHandler.showMessageBox(N.a.openFileFormatError,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error));}},GC.Spread.Sheets.Designer.FileMenuHandler.openJsonCore=async function($,q,G){let K=$.getData('osEnv'),X=K.open(q);if($.setData('InternalSaveFileType','ssjson'),'failed'===X.status)await GC.Spread.Sheets.Designer.FileMenuHandler.showMessageBox(X.message,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else try{let Q=X.data,Y=Q[0],ee=JSON.parse('\uFEFF'===Y||'FFFE'===Y?Q.substr(1):Q);G?($.Spread.fromJSON(ee),ee.designerBindingPathSchema&&($.Spread.designerBindingPathSchema=ee.designerBindingPathSchema,$.setData('treeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),$.setData('oldTreeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),delete ee.designerBindingPathSchema),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat($.Spread),$.setData('isFileModified',!0)):(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore($),$.Spread.fromJSON(ee),ee.designerBindingPathSchema&&($.Spread.designerBindingPathSchema=ee.designerBindingPathSchema,$.setData('treeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),$.setData('oldTreeNodeFromJson',JSON.stringify(ee.designerBindingPathSchema)),delete ee.designerBindingPathSchema),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat($.Spread),$.setData('isFileModified',!1),$.setData('FieldListVisible',!1),$.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList($,q)),GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList($),GC.Spread.Sheets.Designer.FileMenuHandler.setStateNames($),GC.Spread.Sheets.Designer.FileMenuHandler.updatePanel($),$.setData('currentFilePath',X.fileName),$.setData('isExcel',!1),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle($)}catch(Q){('no sheet'===Q||-1!==Q.message.indexOf('fromJSON'))&&(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore($),await GC.Spread.Sheets.Designer.showMessageBox(N.a.openFileFormatError,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error))}},GC.Spread.Sheets.Designer.FileMenuHandler.setStateNames=function($){$.setData('FieldListVisible',!1),$.setData('selectionPane_Visible',!1),$.setData('schemaPanel_Visible',!1),$.setData('isInParameterPanelDesignMode',!1),$.setData('reportCellPanel_Visible',!0)},GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat=function($){if(!$.getActiveSheet()&&!$.getActiveSheetTab())if(0<$.getSheetCount())$.setActiveSheetIndex(0);else if(0<$.getSheetTabCount())$.setActiveSheetTab(0);else throw new Error('no sheet');for(let q=0;q<$.getSheetCount();q++){let G=$.getSheet(q).getActiveColumnIndex(),K=$.getSheet(q).getActiveRowIndex();G!==void 0&&K!==void 0?$.getSheet(q).setActiveCell(K,G):$.getSheet(q).setActiveCell(0,0)}},GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList=function($,q){let G=$.getData('recentFileManger');G&&G.addRecentFile(q)},GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormat=async function($,q,G,K){if($.getData('isFileModified')){let X=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch(X){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:await GC.Spread.Sheets.Designer.FileMenuHandler.save($,void 0,void 0),await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore($,q,G,K);break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:$.setData('isFileModified',!1),await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore($,q,G,K);break;case GC.Spread.Sheets.Designer.MessageBoxResult.cancel:}}else await GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore($,q,G,K)},GC.Spread.Sheets.Designer.FileMenuHandler.showLoadingPlaceHolder=function($){let q=$.querySelector('.gc-loadingPlaceHolderContainer');q||(q=document.createElement('div'),q.classList.add('gc-loadingPlaceHolderContainer'),$.appendChild(q))},GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder=function($){let q=$.querySelector('.gc-loadingPlaceHolderContainer');q&&q.parentElement&&q.parentElement.removeChild(q)},GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore=async function($,q,G,K){let X=$.getData('container');GC.Spread.Sheets.Designer.FileMenuHandler.showLoadingPlaceHolder(X);let Q=function(Y,Z){Z.setData('currentFilePath',Y),Z.setData('isFileModified',!0),Z.setData('isExcel',!0),GC.Spread.Sheets.Designer.FileMenuHandler.setStateNames(Z),GC.Spread.Sheets.Designer.FileMenuHandler.updatePanel($),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu(Z),GC.Spread.Sheets.Designer.FileMenuHandler.updateWindowTitle(Z)};try{await o(400);let Y=$.getData('osEnv'),Z=q.substring(q.lastIndexOf('.')+1);Z=Z.toLowerCase(),$.setData('InternalSaveFileType',Z);let ee=G;'csv'===Z&&G&&G.importCsvSetting&&(ee={encoding:G.importCsvSetting.encoding});let te=await Y.importFile(q,ee);if('success'===te.status){let ne={};if('sjs'===Z){let ie=!0;if($.getData('isFileModified')&&K&&(ie=await GC.Spread.Sheets.Designer.FileMenuHandler.saveModifyFile($)),!ie)return;let ae=(re)=>{$.Spread.open(te.data,()=>{GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X);let le=$._getGlobalEvent();le&&le.fire('FileLoaded',{type:'FileLoaded'},{designer:$,fileType:4}),GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList($),Q(q,$)},async(le)=>{GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),await GC.Spread.Sheets.Designer.showMessageBox(le.errorMessage,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning),GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($)},g(re))};K?(delete ee.openOptions.lazyLoad,ae(ee.openOptions)):(ae(),$.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList($,q))}else if('csv'===Z){ne=te.data;let ie='\\r\\n',ae=',';if(G&&G.importCsvSetting){let le=G.importCsvSetting;ie=le.rowDelimiter||ie,ae=le.columnDelimiter||ae}let re=l.i(R.a)($.Spread);re.reset(),ie=ie.replace('\\n','\n').replace('\\r','\r'),65279===ne.charCodeAt(0)&&(ne=ne.slice(1)),re.setCsv(0,0,ne,ie,ae||','),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),Q(q,$)}else if(G.useExcelSJSFormat){let ie=function(ae){$.Spread.import(te.data,()=>{GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList($),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X);let re=$._getGlobalEvent();re&&re.fire('FileLoaded',{type:'FileLoaded'},{designer:$,fileType:2}),Q(q,$)},async(re)=>{GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),await GC.Spread.Sheets.Designer.showMessageBox(re.errorMessage||re,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning)},ae)};if(!K)ie(),$.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList($,q);else{delete ee.openOptions.lazyLoad;let ae=g(ee.importXlsxOptions);ae.fileType=GC.Spread.Sheets.FileType.excel,ie(ae)}}else{try{ne=te.data}catch(ie){GC.Spread.Sheets.Designer.FileMenuHandler.hideFileMenu($),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),await GC.Spread.Sheets.Designer.showMessageBox('Parse file data error.',N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error)}try{if(!K)await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore($),$.Spread.fromJSON(ne),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat($.Spread),$.setData('isFirstImporting',!1),GC.Spread.Sheets.Designer.FileMenuHandler.updateRecentList($,q);else{let ae={};G&&G.importExcelSetting&&(ae={doNotRecalculateAfterLoad:G.importExcelSetting&&G.importExcelSetting.importDoNotRecalculateAfterLoad,frozenColumnsAsRowHeaders:G.importExcelSetting&&G.importExcelSetting.importColumnHeaders,frozenRowsAsColumnHeaders:G.importExcelSetting&&G.importExcelSetting.importRowHeaders,ignoreFormula:G.importExcelSetting&&G.importExcelSetting.ignoreFormula,ignoreStyle:G.importExcelSetting&&G.importExcelSetting.ignoreStyle,incrementalLoading:G.importExcelSetting&&G.importExcelSetting.incrementalLoading}),$.Spread.fromJSON(ne,ae),GC.Spread.Sheets.Designer.FileMenuHandler.checkOpenFileFormat($.Spread)}$.setData('currentFilePath',q),$.setData('isExcel',!0),$.setData('isFileModified',!0),GC.Spread.Sheets.Designer.FileMenuHandler.initTableTotalRowList($);let ie=$.Spread.sheets;ie.forEach((ae)=>{let re=ae.options.protectionOptions;re&&(re.formatRows&&(re.allowOutlineRows=!0),re.formatColumns&&(re.allowOutlineColumns=!0),ae.options.protectionOptions=re)}),GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),Q(q,$)}catch(ie){'no sheet'===ie?(await GC.Spread.Sheets.Designer.FileMenuHandler.resetCore($),await GC.Spread.Sheets.Designer.showMessageBox(N.a.openFileFormatError,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error)):await GC.Spread.Sheets.Designer.showMessageBox(ie.toString(),N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.warning)}}}else if(GC.Spread.Sheets.Designer.FileMenuHandler.hideLoadingPlaceHolder(X),!te.errorData)await GC.Spread.Sheets.Designer.showMessageBox(te.message,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else if(K)await GC.Spread.Sheets.Designer.showMessageBox(te.errorData.errorMessage,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else if(0===te.errorData.errorCode||1===te.errorData.errorCode)await GC.Spread.Sheets.Designer.showMessageBox(te.errorData.errorMessage,N.a.title,GC.Spread.Sheets.Designer.MessageBoxIcon.error);else{let ne=await GC.Spread.Sheets.Designer.showDialog('passwordDialog',{});ne&&(!G&&(G={importExcelSetting:{}}),G.importExcelSetting&&(G.importExcelSetting.password=ne.password),GC.Spread.Sheets.Designer.FileMenuHandler.openOtherFormatCore($,q,G,K))}}finally{}},GC.Spread.Sheets.Designer.FileMenuHandler.processSelectMainCategory=function($,q){'Save'===q?GC.Spread.Sheets.Designer.FileMenuHandler.processSave($):'Exit'===q?GC.Spread.Sheets.Designer.FileMenuHandler.exit($):void 0},GC.Spread.Sheets.Designer.FileMenuHandler.processSave=async function($){await GC.Spread.Sheets.Designer.FileMenuHandler.save($)},GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown=!1,GC.Spread.Sheets.Designer.FileMenuHandler.exit=async function($){if($||window.osenv.closeAllWindows(),$.setData('FileMenu_show',!1),$.getData('isFileModified')){if(GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown)return;GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown=!0;let G=await GC.Spread.Sheets.Designer.FileMenuHandler.showUnsavedWarning();switch(GC.Spread.Sheets.Designer.FileMenuHandler.isUnsavedWarningShown=!1,G){case GC.Spread.Sheets.Designer.MessageBoxResult.yes:await GC.Spread.Sheets.Designer.FileMenuHandler.save($,!0);break;case GC.Spread.Sheets.Designer.MessageBoxResult.no:break;default:return;}}let q=$.getData('osEnv');q.closeAllWindows()},A.a.commandMap={fontFamilyNative:S.a,insertPictureNative:f.a,pasteElectron:y.a,"paste-all-electron":y.b,"paste-formulas-electron":y.c,"paste-values-electron":y.d,"paste-formatting-electron":y.e,"paste-valuesAndFormatting-electron":y.f,"paste-formulasAndFormatting-electron":y.g,"designer.pasteElectron":F.a,"designer.pasteAllElectron":F.b,"designer.pasteFormulasElectron":F.c,"designer.pasteValuesElectron":F.d,"designer.pasteFormattingElectron":F.e,"designer.pasteValuesAndFormattingElectron":F.f,"designer.pasteFormulasAndFormattingElectron":F.g,"designer.tableSheetPasteElectron":F.h,cutElectron:M.a,"designer.cutElectron":D.a,copyElectron:v.a,"designer.copyElectron":b.a,saveSchemaElectron:H.a,loadSchemaElectron:T.a,activeElectron:E.a,resetElectron:P.a,saveElectron:B.a,openElectron:O.a,fileMenuButtonNative:C.a};let V;window.ipcRenderer&&window.ipcRenderer.on('closing',()=>{GC.Spread.Sheets.Designer.FileMenuHandler.exit(V)}),GC.Spread.Sheets.Designer.registerTemplate('fileMenuPanelTemplate',_.a),V=new GC.Spread.Sheets.Designer.Designer(document.getElementById('gc-designer-container'),A.a);let z=V.getData('osEnv'),U=!V.getData('needActive')||3===z._ms[2]();V.setData('AllowAccessBarOpen',U),V.setData('AllowAccessBarSave',U),V.setData('AllowAccessBarReset',U),p(V.Spread,J),window.ipcRenderer.on('save',async()=>{window.ipcRenderer.send('isSaving',!0),I=!0;let G=m();G?G.commandManager().execute({cmd:'commitContentToActiveCell'}):await GC.Spread.Sheets.Designer.FileMenuHandler.processSave(V),window.ipcRenderer.send('isSaving',!1)})},function(t,a,l){'use strict';var o=l(0);l.d(a,'a',function(){return p});let p={title:o.a.ribbon.accessBar.open,commandName:'openElectron',iconClass:'gc-accessbar-open',execute:async(g)=>{await GC.Spread.Sheets.Designer.FileMenuHandler.openBrowse(g,{});let m=g.getData('currentFilePath');g.setData('currentFileNameInElectron',m)},enableContext:`AllowAccessBarOpen && !IsInTableSheetDesignMode && !DataManagerActive && !activeSpreadIsDesignSpread`}},function(t,a,l){'use strict';var o=l(0);l.d(a,'a',function(){return p});let p={title:o.a.ribbon.accessBar.New,commandName:'resetElectron',iconClass:'gc-accessbar-new',execute:async(g)=>{await GC.Spread.Sheets.Designer.FileMenuHandler.processNewTemplate(g)},enableContext:`AllowAccessBarReset && !IsInTableSheetDesignMode && !DataManagerActive && !activeSpreadIsDesignSpread`}},function(t,a,l){'use strict';var o=l(0),p=l(4);l.d(a,'a',function(){return g});let g={title:o.a.ribbon.accessBar.save,commandName:'saveElectron',iconClass:'gc-accessbar-save',execute:async(m)=>{let u=window.osenv;u.needActive()&&u._ms[2]()!==p.b.Trial||(await GC.Spread.Sheets.Designer.FileMenuHandler.processSave(m))},enableContext:`AllowAccessBarSave && !IsInTableSheetDesignMode && !DataManagerActive && !activeSpreadIsDesignSpread`}},function(t,a,l){'use strict';var o=l(0),p=l(6),g=l(3);l.d(a,'a',function(){return m});let m={text:'${res.contextMenu.copy}',commandName:'designer.copyElectron',iconClass:'gc-spread-copy',visibleContext:`${g.i.ClickViewport} || ${g.i.ClickCorner} || ${g.i.ClickColHeader} || ${g.i.ClickRowHeader} ||
    ${g.i.TableSheetClickViewport} || ${g.i.TableSheetClickCorner} || ${g.i.TableSheetClickColHeader} || ${g.i.TableSheetClickRowHeader} ||
    ${g.i.GanttSheetClickRowHeader} || ${g.i.GanttSheetClickFields} || ${g.i.GanttSheetClickColHeader}`,execute:p.a.execute}},function(t,a,l){'use strict';var o=l(0),p=l(7),g=l(3);l.d(a,'a',function(){return m});let m={text:'${res.contextMenu.cut}',commandName:'designer.cutElectron',iconClass:'gc-spread-cut',visibleContext:`${g.i.ClickViewport} && !${g.i.PivotTableSelected} || ${g.i.ClickCorner} || ${g.i.ClickColHeader} || ${g.i.ClickRowHeader} ||
    ${g.i.TableSheetClickViewport} || ${g.i.TableSheetClickCorner} || ${g.i.TableSheetClickColHeader} || ${g.i.TableSheetClickRowHeader} ||
    ${g.i.GanttSheetClickFields} || ${g.i.GanttSheetClickRowHeader} || ${g.i.GanttSheetClickColHeader}`,enableContext:'!IsIncludeLockedCell',execute:p.a.execute}},function(t,a,l){'use strict';function m(Z,ee){let te=Z&&Z.ribbon;if(te)for(var ne of te)if(ne.id===ee)return ne}function u(Z,ee,te){let ne=Z&&Z.ribbon;if(ne)for(var ie in ne)ne[ie]&&ne[ie].id===ee&&(ne[ie]=te)}l.d(a,'a',function(){return Y});let Y=GC.Spread.Sheets.Designer.DefaultConfig;(function(Z){var ee=m(Z,'home'),te=JSON.stringify(ee);te=te.replace(`"command":"${'pasteAll'}"`,`"command":"${'paste-all-electron'}"`).replace('fontFamily','fontFamilyNative').replace('"cut","copy"','"cutElectron","copyElectron"'),u(Z,'home',JSON.parse(te))})(Y),function(Z){var ee=m(Z,'insert'),te=JSON.stringify(ee);te=te.replace('insertPicture','insertPictureNative'),u(Z,'insert',JSON.parse(te))}(Y),function(Z){var ee=m(Z,'data'),te=JSON.stringify(ee);te=te.replace('loadSchema','loadSchemaElectron').replace('saveSchema','saveSchemaElectron'),u(Z,'data',JSON.parse(te))}(Y),function(Z){var ee=Z.contextMenu,te=JSON.stringify(ee);te=te.replace('contextMenuCut','designer.cutElectron').replace('contextMenuCopy','designer.copyElectron').replace('contextMenuPaste','designer.pasteElectron').replace('designerPasteAll','designer.pasteAllElectron').replace('pasteFormula','designer.pasteFormulasElectron').replace('designerPasteValues','designer.pasteValuesElectron').replace('designerPasteFormatting','designer.pasteFormattingElectron').replace('pasteValuesFormatting','designer.pasteValuesAndFormattingElectron').replace('pasteFormulaFormatting','designer.pasteFormulasAndFormattingElectron').replace('gc.spread.contextMenu.pasteValues','designer.tableSheetPasteElectron'),Z.contextMenu=JSON.parse(te)}(Y),Y.fileMenu='fileMenuButtonNative',Y.quickAccessBar=['resetElectron','saveElectron','openElectron','activeElectron']},function(t,a,l){'use strict';function o(D,v){let b=[D,v].map((H)=>{return new Date(H.getFullYear(),H.getMonth(),H.getDate())});return(b[0].valueOf()-b[1].valueOf())/8.64e7}var p=l(0);const g={status:'failed',message:'not implemented.'},m={status:'cancelled',message:'not implemented.'},u='sid',x=GC.Spread.Sheets.Designer.showMessageBox,S=GC.Spread.Sheets.Designer.MessageBoxIcon,f=GC.Spread.Sheets.Designer.MessageBoxButtons,y={Trial:3,Valid:0,Expired:1,Unlicensed:2,Invalid:4},F='zh-cn';class C{constructor(){}notifyReady(){}showOpenDialog(){return Promise.reject({status:'',fileName:''})}open(){return{status:'',message:'',data:'',fileName:''}}save(){return g}exit(){}importFile(){return Promise.resolve(g)}showSaveDialog(){return m}exportFile(){return Promise.resolve(g)}needActive(){return!1}setClipboardData(){}getClipboardText(){return''}getBase64(){return''}getClipboardHTML(){return''}getSystemFonts(){return null}closeAllWindows(){}setClipboardText(){}setClipboardHTML(){}getFileInfo(){return{}}joinPath(D){return D&&D.toString()}config(D,v){return void 0===v?this.getConfig(D):(this.setConfig(D,v),window.osenv)}getConfig(D){this.initConfig(!0);let v=D.split('.'),b=this._config;if(b){for(let T,H=0;H<v.length;H++){if(T=b[v[H]],void 0===T)return;b=T}if(D===u){let H=parseInt(b,36);return isNaN(H)?null:new Date(H)}return b}}initConfig(){this._config===void 0&&(this._config={})}setConfig(D,v){this.initConfig(!1);let b=D.split('.'),H=this._config;if(H){for(let E,T=0;T<b.length-1;T++)E=H[b[T]],void 0===E&&(H[b[T]]=E={}),H=E;H[b[b.length-1]]=v}}restartApp(){}}a.a=class extends C{constructor(D){super();this.originApp=D;let E=this;this.isNative=!0,this._systemFontList=D.getSystemFonts(),window.ipcRenderer.on('shown',()=>{let B=document.querySelector('.gc-accessbar-active');var O=window._ssCulture;if(B){let _=B.parentElement;if(_&&'none'!==window.getComputedStyle(_).display){var A=function(){var R=setTimeout(()=>{_.click(),E.enableFilemenu=!0,clearTimeout(R)},500)};let N=E._ms[0];if(N){let R=N();O===F?(R&&!R.h||R.h&&(R.e||!R.v))&&A():R&&(!R.h&&!R.v||!R.v||R.e)&&A()}}}}),window.ipcRenderer.on('openFileError',function(){x(p.a.openFileErrorMessage,p.a.title,S.warning)}),window.ipcRenderer.on('fontReady',function(B,O){E._systemFontList=O.split('||||')}),GC.Spread.Sheets.Workbook.lm=1;let P=new GC.Spread.Sheets.Workbook;this._mode=P.ls&&P.ls.m,P.destroy(),null!==this._mode&&this._mode!==void 0&&this._vls(D._g()),this._ms=[function(B){return E._i(B)},function(B){E._uls(B)},function(){return E._gls()},function(){return E._gtdl()}]}initConfig(D){if(this._config===void 0){let v=this.originApp.getConfig();this._config=v?JSON.parse(v):{},D&&(this._config[u]=this._config[u]||Date.now().toString(36))}}needActive(){let D=this._i();return!(D.v&&D.h&&(2===D.t||0>D.t))}showSaveDialog(D){return this.originApp.showSaveDialog(D)}showOpenDialog(D){return new Promise((v)=>{this.originApp.showOpenDialog(D,(H)=>{v(H)})})}async getSelectedFileUrl(){let D=await this.showOpenDialog({title:p.a.selectFileURLDialogTitle,nameFilters:[]});return'cancelled'===D.status?'':D.fileName?this.originApp.getFileUrl(D.fileName):''}getBase64(D){return this.originApp.getBase64(D)}save(D,v,b){return this.originApp.save(D,v,b)}open(D){return this.originApp.open(D)}exportFile(D,v){return new Promise((b)=>{this.originApp.exportFile(D,v,(T)=>{b(T)})})}importFile(D,v){return new Promise((b)=>{let T=D.substring(D.lastIndexOf('.')+1);switch(T.toLowerCase()){case'xlsx':this.originApp.importExcel(D,v,(E)=>{b(E)});break;case'csv':this.originApp.importCsv(D,v,(E)=>{b(E)});break;case'sjs':this.originApp.openSJS(D,v,(E)=>{b(E)});}})}exit(){this.originApp.exit(),this.originApp.closeAllWindows()}restartApp(){this.originApp.restart(),this.originApp.closeAllWindows()}getClipboardText(){return this.originApp.getClipboardText()}setClipboardText(D){this.originApp.setClipboardText(D)}getClipboardHTML(){return this.originApp.getClipboardHTML()}setClipboardHTML(D){this.originApp.setClipboardHTML(D)}setClipboardData(D){this.originApp.setClipboardData(D)}getSystemFonts(){return this._systemFontList}notifyReady(){window.ipcRenderer.send('ready')}closeAllWindows(){this.saveConfigFile(),this.originApp.closeAllWindows()}saveConfigFile(){!this.configSaved&&this.originApp&&this._config&&(this.configSaved=!0,this.originApp.setConfig(JSON.stringify(this._config)))}getFileInfo(D){return this.originApp.getFileInfo(D)}joinPath(D){return this.originApp.joinPath(D)}_i(D){if(D||!this._ls){let v=new GC.Spread.Sheets.Workbook;this._ls=this._convert(v.ls||{isVd:function(b){return b},hl:!0});try{v.destroy()}catch(b){}}return this._ls}_vls(D){return GC.Spread.Sheets.LicenseKey=D,this._i(!0)}_gls(){let D=this._i();return D.v?1===D.t?y.Trial:y.Valid:D.e?y.Expired:D.h?y.Invalid:y.Unlicensed}_uls(D){null!==this._mode&&this._mode!==void 0&&(D=D.trim().replace(/[\r\n]/g,''),this.originApp._u(this._mode,D))}_gtdl(){let D=this._i();return D.v&&!D.e&&D.d||0}_convert(D){var v=window._ssCulture;D=D||{};let b=D.e&&D.adr&&D.adr.dsr,H={t:[0,-1,1].indexOf(D.m),n:D.n,e:b,d:D.d,h:D.hl,v:D.isVd&&D.isVd(!0)};if(!(-1===D.m&&!H.v))-1===D.m&&H.v&&H.h&&void 0===H.d&&(H.h=H.v=!1,GC.Spread.Sheets.LicenseKey='');else if(!H.h){if(v===F)H.e=!1;else{let T=this.getConfig(u);if(!T)H.e=!0;else{let E=30-o(new Date,T);30<E||1>E?H.e=!1:(H.e=!1,H.d=E,H.v=!0)}}GC.Spread.Sheets.LicenseKey=''}else GC.Spread.Sheets.LicenseKey=b?'':'error';return H}}},function(t,a,l){'use strict';var o=l(18);const p={_l:['+3i0y350y1n0y6k4g4u6k5g3n6k555c6h3n3p6m50586l3p5a6j3u5c6j584q6i5f4r6g3n4g6m4r4n6','n483o6k403w6n464y6g3n4h6k5g3n6k555c6m4y5f6m4y4l6j4d4s6h3n3p0y190y3b0y1n0y6m50496','l484s6k423v6k4h3q6j3w4t6i5e4d0w153i1d3k0w6j4o4t166t5d406j43506l3p5a6j3u5c6j584q6','i5f4r6g3n4g6m4r4n6n483o6k403w6n464y6g3n4h6m5f476j3s4p6k4x4n6j5d436k423v6k4h3q6h3','n3p0y190y2e0y1n0y6m50496l484s6l3w3v6j3w4t6i5e4d6j4o4t6k49510w153i1d3k0w6j4o4t166','h3n3p0y190y2v0y1n0y6m4y596j43506m503o6j58536m5g3u6k4g4j6h3n3p6m50586l3p5a6j3u5c6','m4r4n6n483o6k403w6n464y6k4h4p6k5g3n6k555c6m4y5f6m4y4l6j4d4s6h3n3p0y190y300y1n0y6','k4b4k6k493v6m4y596j43506m503o6j503t6n464p6h3n3p6m50586l3p5a6j3u5c6m4r4n6n483o6k4','03w6n464y6k4h4p6k5g3n6k555c6m4y5f6m4y4l6j4d4s6h3n3p0y3k='],_L:['+3i0y330y1n0y6m4y596j43506m503o6i5g4l6k3o500y190y2e0y1n2l0y6k4b4k6k493v0y190y6m50','496l484s6l3w3v0y190y6k4x4n6j5d436l3w3v0y2n190y320y1n0y6m5f476j3s4p6m4y596j43506m','503o6j503t6n464p1n0y190y3b0y1n0y6k4x4o6l3w3v6k4g4w6k423v6k4h3q6i5b420w3i1d3k1b0y','190y2v0y1n0y6m4y596j43506m503o6j58536m5g3u6k4g4j190w6m50586m5f476j3s4p6k4g3w6k49','3v6l4e3r6m4y596j43506m503o6j503t6n464p6h3n3p0y190y2u0y1n0y6k3p4s6l4e3r0w3i1e3k0w','6j503t6n464p6j513t6i5d4e6j4g4s0w3i1f3k0w6j4o4t6j44426m5g3u6k4g4j6h3n3p0y190y2w0y','1n0y6m4y5f6m4y4l6j4d4s6k4g4u6k3w5f6j3v516k4g3w6k493v6l4e3r6k423v6k4h3q6i5g4l6k3o','506h3n3p6m50586m5f476j3s4p6k4g3w6k493v6l4e3r6m4y596j43506m503o6j503t6n464p6h3n3p','0y190y300y1n0y6k4b4k6k493v6m4y596j43506m503o6j503t6n464p190w6m50586m5f476j3s4p6k','4g3w6k493v6l4e3r6m4y596j43506m503o6j503t6n464p6h3n3p0y190y2f0y1n0y6m4y5f6m4y4l6j','4d4s6j513t6n3u416j44506j5a576j5b486l484s6m4y596j43506m503o6j503t6n464p6h3n3p0y3k='],_B:['+3i0y350y1n0w0y6m4y5f6m4y4l6j4d4s6k4g4u6k3w5f6j3v516k4g3w6k493v6l4e3r6k423v6k4h3q','6i5g4l6k3o506t5d406m50586l3p5a6j3u5c6g3n4g6m4r4n6n483o6k403w6n464y6g3n4h6k5g3n6k','555c6m4y5f6m4y4l6j4d4s6h3n3p0y190y2v0y1n0w0y6k423v6k4h3q6j58536m5g3u6k4g4j6t5d40','6j43506n3n4e6m5g3u6l3p5a6j3u5c6g3n4g6m4r4n6n483o6k403w6n464y6g3n4h6m5f476j3s4p6k','4g3w6k493v6l4e3r6k423v6k4h3q6m4y596j43506k3v4a6l48546m50580w1g1d0w6j4o4t6j3s416m','555a6m50496l484s0y190y330y1n0w0y6l4y3n6j41496i593n6k4x4p6t5d406m42586j434a0w1g1d','0w6j4o4t6j3s416m555a6m50496l484s6m4y596j43506m503o6t5d3v6j3s4s6j3x4j6m3q5e6t5d3w','0y190y2s0y1n0w0y6l48546m50586j3s416m555a6m4y596j43500y3k='],recent:'\u6700\u8FD1'};a.a=p,p.l=l.i(o.a)(p._l,35),p.L=l.i(o.a)(p._L,35),p.B=l.i(o.a)(p._B,35)},function(t,a){'use strict';function p(g){let m,u,x,S,f,y;for(m='',x=g.length,u=0;u<x;)switch(S=g[u],u+=1,S>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:m+=String.fromCharCode(S);break;case 12:case 13:f=g[u],u+=1,m+=String.fromCharCode((31&S)<<6|63&f);break;case 14:f=g[u],u+=1,y=g[u],u+=1,m+=String.fromCharCode((15&S)<<12|(63&f)<<6|(63&y)<<0);}return m}a.a=function(g,m){let u=g.join(''),x=[],S=u[0],f=['+','/'].indexOf(S)+1;for(let y=f&&1||0,F=u.length-(f&&f+1||0);y<F;y+=2)x.push(parseInt(u[y]+u[y+1],m));return u=p(x),JSON.parse(u)}},function(t,a,l){'use strict';function o(m){return!m.getData('IsInTableSheetDesignMode')&&!m.getData('DataManagerActive')&&!m.getData('activeSpreadIsDesignSpread')}var p=l(5);l.d(a,'a',function(){return g});let g={commandName:'fileMenuButtonNative',text:'${res.ribbon.home.file}',execute:(m)=>{let u=window.osenv;u.enableFilemenu?p.a.execute(m):o(m)&&GC.Spread.Sheets.Designer.FileMenuHandler.showFileMenu(m)}}},function(t,a,l){'use strict';async function o(P){let B=await p(P.Spread);B&&P.setData('isFileModified',!0)}async function p(P){let B={title:C.a.insertPictureDialogTitle,nameFilters:[C.a.pictureFormatFilter.png,C.a.pictureFormatFilter.jpeg,C.a.pictureFormatFilter.bmp,C.a.pictureFormatFilter.allFiles]},O=window.osenv,A=await O.showOpenDialog(B);if('cancelled'===A.status)return!1;if(A.fileName){let _=g(O,A.fileName),N=await y(A.fileName);return F(P,_,N.naturalWidth,N.naturalHeight)}return!1}function g(P,B){let O=P.getBase64(B);return B.endsWith('.svg')&&!O.startsWith('data:image')&&(O='data:image/svg+xml;base64,'+O),O}function m(P,B,O,A,_){let N=u(P,B,O);if(A&&_){let R=x(P);N.x=Math.min(N.x,R.width-A),N.y=Math.min(N.y,R.height-_)}return N}function u(P,B,O){const A=20;return{x:A+S(P,0,O),y:A+f(P,0,B)}}function x(P){return{width:S(P,0,P.getColumnCount()),height:f(P,0,P.getRowCount())}}function S(P,B,O){let A=0;for(let _=B;_<O;_++)A+=P.getColumnWidth(_);return A}function f(P,B,O){let A=0;for(let _=B;_<O;_++)A+=P.getRowHeight(_);return A}function y(P){return new Promise((B)=>{const A=document.createElement('img'),_=()=>{B({naturalWidth:A.naturalWidth,naturalHeight:A.naturalHeight})};A.addEventListener('load',_),A.addEventListener('error',_),A.addEventListener('abort',_),A.src=P})}function F(P,B,O,A){let _=l.i(D.a)(P);if(!_)return!1;let N=_.getActiveRowIndex(),R=_.getActiveColumnIndex();if(_.defaults.rowHeight===void 0||_.defaults.colWidth===void 0)return!1;let L=_.defaults.rowHeight,I=_.defaults.colWidth;return M.a.runCommand(P,'insertPicture',T,{activeRowIndex:N,activeColIndex:R,base64Content:B,rowHeight:L,colWidth:I,naturalWidth:O,naturalHeight:A})}var C=l(0),M=l(2),D=l(1);l.d(a,'a',function(){return H});const v=816;let H={title:'${res.ribbon.insert.insertPicture}',text:'${res.ribbon.insert.picture}',iconClass:'ribbon-button-picture',bigButton:!0,commandName:'insertPictureNative',enableContext:'AllowEditObject',execute:async(P)=>{await o(P)}},T={canUndo:!0,execute:function(P,B,O){let A=new E(P,B);return A.execute(P,B,O)}};class E extends M.a.DesignerActionBase{_getPictureName(P){let B=l.i(D.a)(P).pictures.all(),O=B.length,A={};for(let _=0;_<O;_++)A[B[_].name()]=!0;for(let N,_=0;_<O;_++)if(N='picture'+_,!A[N])return N;return'picture'+O}executeImp(P,B){let A=this,_=B.activeRowIndex,N=B.activeColIndex,R=B.rowHeight,L=B.colWidth;try{let I=l.i(D.a)(P),J=B.base64Content;if(J.startsWith('data:image')||(J='data:image/png;base64,'+J),I.shapes){let W=B.naturalWidth,V=B.naturalHeight;W&&V?W>v&&(V=V/W*v,W=v):W=V=void 0;let z=m(I,_,N,W,V);I.shapes.addPictureShape('',J,z.x,z.y,W,V)}else{let W=A._getPictureName(P);I.pictures.add(W,J,N*L,_*R)}return!0}catch(I){return!1}}}},function(t,a,l){'use strict';async function o(B){let O=window.osenv,A={title:f.a.ribbon.data.loadSchema,nameFilters:[f.a.ribbon.data.loadDataSourceFilter.json,f.a.ribbon.data.loadDataSourceFilter.txt]},_=await O.showOpenDialog(A);if('cancelled'!==_.status&&_.fileName){let N=O.open(_.fileName);if('failed'===N.status)F(_.message,f.a.title,C.error);else if(N.data)try{await p(B);let R=JSON.parse(N.data);R.$schema||Array.isArray(R)||B.setData('originalDataSource',new GC.Spread.Sheets.Bindings.CellBindingSource(R)),B.setData('treeNodeFromJson',N.data),B.setData('oldTreeNodeFromJson',N.data)}catch(R){F(f.a.ribbon.data.loadDataError,f.a.title,C.error)}}}async function p(B){let O=!!B.getData('FieldListVisible');O||(await g(B))}async function g(B){let O=!!B.getData('FieldListVisible'),A=GC.Spread.Sheets.Events.SelectionChanged+'.bindingPath';if(O){B.setData('FieldListVisible',!O),m(),B.Spread.unbind(A);let _=B.getData('bindingIndicatorManager');_.hideDataBindingSettingIndicator();let N=B.getData('originalDataSource');if(N){let R=l.i(y.a)(B.Spread);R.setDataSource(N)}}else{B.setData('FieldListVisible',!O),B.setData('ShowShapePropertyPanel',O),B.setData('chartAltTextPanel_Visible',O),B.setData('shapeAltTextPanel_Visible',O),B.setData('PictureAltTextPanel_Visible',O),B.setData('ChartElementContext',O),u();let _=B.getData('bindingIndicatorManager');if(!_){let N=B.getData('container');_=new GC.Spread.Sheets.Designer.BindingIndicatorManager(B.Spread,N),B.setData('bindingIndicatorManager',_)}B.Spread.bind(A,()=>{_.refreshBindingPathIndicator()}),_.refreshBindingPathIndicator()}await x(B.Spread)}function m(){v.Text.prototype.getText=b,v.CheckBox.prototype.getText=H,v.Button.prototype.getText=T,v.HyperLink.prototype.getText=E,v.ComboBox.prototype.getText=P}function u(){GC.Spread.Sheets.CellTypes.Text.prototype.getText=function(B,O){let A=O.sheet.getBindingPath(O.row,O.col);return A?'['+A+']':b.apply(this,arguments)},GC.Spread.Sheets.CellTypes.CheckBox.prototype.getText=function(B,O){let A=O.sheet.getBindingPath(O.row,O.col);return A?'['+A+']':H.apply(this,arguments)},GC.Spread.Sheets.CellTypes.Button.prototype.getText=function(B,O){let A=O.sheet.getBindingPath(O.row,O.col);return A?'['+A+']':T.apply(this,arguments)},GC.Spread.Sheets.CellTypes.HyperLink.prototype.getText=function(B,O){let A=O.sheet.getBindingPath(O.row,O.col);return A?'['+A+']':E.apply(this,arguments)},GC.Spread.Sheets.CellTypes.ComboBox.prototype.getText=function(B,O){let A=O.sheet.getBindingPath(O.row,O.col);return A?'['+A+']':P.apply(this,arguments)}}async function x(B,O=!0){O&&(await S(0));let A=document.querySelector('.spreadWrapper>.ss');A.classList.add('gc-temp-removeContent'),B.refresh(),A.classList.remove('gc-temp-removeContent')}function S(B){return new Promise((O)=>{setTimeout(()=>{O()},B)})}var f=l(0),y=l(1);l.d(a,'a',function(){return D});const F=GC.Spread.Sheets.Designer.showMessageBox,C=GC.Spread.Sheets.Designer.MessageBoxIcon,M=GC.Spread.Sheets.Designer.MessageBoxButtons;let D={title:'${res.ribbon.data.loadSchemaTitle}',text:'${res.ribbon.data.loadSchema}',iconClass:'ribbon-button-loadschema',commandName:'loadSchemaElectron',execute:async(B)=>{await o(B)},enableContext:'AllowDataBinding'},v=GC.Spread.Sheets.CellTypes,b=v.Text.prototype.getText,H=v.CheckBox.prototype.getText,T=v.Button.prototype.getText,E=v.HyperLink.prototype.getText,P=v.ComboBox.prototype.getText},function(t,a,l){'use strict';async function o(S){let f=window.osenv,y={title:p.a.ribbon.data.saveSchema,nameFilters:[p.a.ribbon.data.saveDataSourceFilter.json]},F=f.showSaveDialog(y);if('cancelled'!==F.status)try{if(F.fileName){let C=S.getData('updatedTreeNode')||S.getData('oldTreeNodeFromJson'),M=f.save(F.fileName,C,!1);'failed'===M.status&&g(M.message,p.a.title,m.error,u.ok)}}catch(C){}}var p=l(0);l.d(a,'a',function(){return x});const g=GC.Spread.Sheets.Designer.showMessageBox,m=GC.Spread.Sheets.Designer.MessageBoxIcon,u=GC.Spread.Sheets.Designer.MessageBoxButtons;let x={title:'${res.ribbon.data.saveSchemaTitle}',text:'${res.ribbon.data.saveSchema}',iconClass:'ribbon-button-saveschema',commandName:'saveSchemaElectron',execute:async(S)=>{await o(S)},enableContext:'AllowDataBinding'}},function(t,a,l){'use strict';var o=l(0);l.d(a,'a',function(){return J});const p={Hide:'Hide',New:'New',OpenSJS:'OpenSJS',SaveSJS:'SaveSJS',Import:'Import',Export:'Export',Exit:'Exit',Print:'Print',Recent:'Recent',Info:'Info'},g={RecentWorkbooks:'RecentWorkbooks',Computer:'Computer',SSJson:'SSJson',Excel:'Excel',Csv:'Csv',Pdf:'Pdf',ExcelIO:'Excel IO'};let m={type:'Container',visibleWhen:'activeCategory_main=New',children:[{type:'TextBlock',margin:'50px 0 15px 50px',style:'font-size:36px;line-height:80px',text:o.a.fileMenu.new},{type:'FileMenuListNew',bindingPath:'templateSetting'}]},u={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadSheetJsonFile},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importSpreadSheetFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_import_ssjson',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.SSJson},S={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 10px 50px',text:o.a.fileMenu.openFlags},...function(W){let V=[{text:o.a.fileMenu.importExportOptions.incrementalLoad,tips:o.a.fileMenu.importOptionsTips.incrementalLoad,name:'incrementalLoad'},{text:o.a.fileMenu.importExportOptions.lazyLoad,tips:o.a.fileMenu.importOptionsTips.lazyLoad,name:'lazyLoad'},{name:''},{text:o.a.fileMenu.importExportOptions.includeStyles,tips:o.a.fileMenu.importOptionsTips.includeStyles,name:'includeStyles'},{text:o.a.fileMenu.importExportOptions.includeFormulas,tips:o.a.fileMenu.importOptionsTips.includeFormulas,name:'includeFormulas'},{text:o.a.fileMenu.importExportOptions.fullRecalc,tips:o.a.fileMenu.importOptionsTips.fullRecalc,name:'fullRecalc'},{name:''},{text:o.a.fileMenu.importExportOptions.includeUnusedStyles,tips:o.a.fileMenu.importOptionsTips.includeUnusedStyles,name:'includeUnusedStyles'},{text:o.a.fileMenu.importExportOptions.incrementalCalculation,tips:o.a.fileMenu.importOptionsTips.incrementalCalculation,name:'incrementalCalculation'},{text:o.a.fileMenu.importExportOptions.calcOnDemand,tips:o.a.fileMenu.importOptionsTips.calcOnDemand,name:'calcOnDemand'},{text:o.a.fileMenu.importExportOptions.dynamicReferences,tips:o.a.fileMenu.importOptionsTips.dynamicReferences,name:'dynamicReferences'},{text:o.a.fileMenu.importExportOptions.convertSheetTableToDataTable,tips:o.a.fileMenu.importOptionsTips.convertSheetTableToDataTable,name:'convertSheetTableToDataTable'},{name:''},{text:o.a.fileMenu.importExportOptions.frozenRowsAsColumnHeaders,tips:o.a.fileMenu.importOptionsTips.frozenRowsAsColumnHeaders,name:'frozenRowsAsColumnHeaders'},{text:o.a.fileMenu.importExportOptions.frozenColumnsAsRowHeaders,tips:o.a.fileMenu.importOptionsTips.frozenColumnsAsRowHeaders,name:'frozenColumnsAsRowHeaders'}];return V.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${W}px`,text:z.text,bindingPath:'importXlsxOptions.'+z.name,tips:z.tips}})}(50),{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'importXlsxOptions.password',placeholder:o.a.fileMenu.importPassword},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_import_excel',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.Excel},f={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 0 50px',text:o.a.fileMenu.openFlags},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.incrementalLoading,bindingPath:'importExcelSetting.incrementalLoading'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importIgnoreStyle,bindingPath:'importExcelSetting.ignoreStyle'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importIgnoreFormula,bindingPath:'importExcelSetting.ignoreFormula'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importDoNotRecalculateAfterLoad,bindingPath:'importExcelSetting.importDoNotRecalculateAfterLoad',className:'file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.importRowAndColumnHeaders,bindingPath:'importExcelSetting.importRowAndColumnHeaders',className:'file-menu-text file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.importRowHeaders,bindingPath:'importExcelSetting.importRowHeaders',className:'file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.importColumnHeaders,bindingPath:'importExcelSetting.importColumnHeaders',className:'file-menu-excel-option'},{type:'TextBlock',margin:'5px 0 0 50px',text:o.a.fileMenu.importPassword},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'importExcelSetting.password'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_import_excel_io',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.ExcelIO},y={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.csvFile},{type:'TextBlock',margin:'15px 0 0 50px',text:o.a.fileMenu.importRowDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'importCsvSetting.rowDelimiter'},{type:'TextBlock',margin:'15px 0 0 50px',text:o.a.fileMenu.importColumnDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'importCsvSetting.columnDelimiter'},{type:'TextBlock',margin:'15px 0 0 50px',text:o.a.fileMenu.importEncoding},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'importCsvSetting.encoding'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.importCsvFile,width:120,height:120,iconClass:'icon-common icon-csv',bindingPath:'button_import_csv',iconPosition:'top'}],visibleWhen:'activeCategory_import='+g.Csv},C={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadJSFile},...function(W){let V=[{name:'incrementalLoad',text:o.a.fileMenu.openSaveOptions.incrementalLoad,tips:o.a.fileMenu.openOptionsTips.incrementalLoad},{name:'lazyLoad',text:o.a.fileMenu.openSaveOptions.lazyLoad,tips:o.a.fileMenu.openOptionsTips.lazyLoad},{name:''},{name:'includeStyles',text:o.a.fileMenu.openSaveOptions.includeStyles,tips:o.a.fileMenu.openOptionsTips.includeStyles},{name:'includeFormulas',text:o.a.fileMenu.openSaveOptions.includeFormulas,tips:o.a.fileMenu.openOptionsTips.includeFormulas},{name:'fullRecalc',text:o.a.fileMenu.openSaveOptions.fullRecalc,tips:o.a.fileMenu.openOptionsTips.fullRecalc},{name:''},{name:'includeUnusedStyles',text:o.a.fileMenu.openSaveOptions.includeUnusedStyles,tips:o.a.fileMenu.openOptionsTips.includeUnusedStyles},{name:'incrementalCalculation',text:o.a.fileMenu.openSaveOptions.incrementalCalculation,tips:o.a.fileMenu.openOptionsTips.incrementalCalculation,canChangeThreeState:!0,isThreeState:!0},{name:'calcOnDemand',text:o.a.fileMenu.openSaveOptions.calcOnDemand,tips:o.a.fileMenu.openOptionsTips.calcOnDemand,canChangeThreeState:!0,isThreeState:!0},{name:'dynamicReferences',text:o.a.fileMenu.openSaveOptions.dynamicReferences,tips:o.a.fileMenu.openOptionsTips.dynamicReferences}];return V.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${W}px`,text:z.text,bindingPath:'openOptions.'+z.name,tips:z.tips,canChangeThreeState:!!z.canChangeThreeState,isThreeState:!!z.isThreeState}})}(50),{type:'Button',margin:'20px 50px',text:o.a.fileMenu.openSJSFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_open_sjs',iconPosition:'top'}]},D={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadJSFile},...function(W){let V=[{name:'includeStyles',text:o.a.fileMenu.openSaveOptions.includeStyles,tips:o.a.fileMenu.saveOptionsTips.includeStyles},{name:'includeFormulas',text:o.a.fileMenu.openSaveOptions.includeFormulas,tips:o.a.fileMenu.saveOptionsTips.includeFormulas},{name:'includeUnusedNames',text:o.a.fileMenu.openSaveOptions.includeUnusedNames,tips:o.a.fileMenu.saveOptionsTips.includeUnusedNames},{name:''},{name:'saveAsView',text:o.a.fileMenu.openSaveOptions.saveAsView,tips:o.a.fileMenu.saveOptionsTips.saveAsView},{name:'includeAutoMergedCells',text:o.a.fileMenu.openSaveOptions.includeAutoMergedCells,tips:o.a.fileMenu.saveOptionsTips.includeAutoMergedCells},{name:'includeCalcModelCache',text:o.a.fileMenu.openSaveOptions.includeCalcModelCache,tips:o.a.fileMenu.saveOptionsTips.includeCalcModelCache},{name:'saveR1C1Formula',text:o.a.fileMenu.openSaveOptions.saveR1C1Formula,tips:o.a.fileMenu.saveOptionsTips.saveR1C1Formula},{name:'includeBindingSource',text:o.a.fileMenu.openSaveOptions.includeBindingSource,tips:o.a.fileMenu.saveOptionsTips.includeBindingSource},{name:'includeEmptyRegionCells',text:o.a.fileMenu.openSaveOptions.includeEmptyRegionCells,tips:o.a.fileMenu.saveOptionsTips.includeEmptyRegionCells}];return V.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${W}px`,text:z.text,bindingPath:'saveOptions.'+z.name,tips:z.tips}})}(50),{type:'Button',margin:'20px 50px',text:o.a.fileMenu.saveSSFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_save_sjs',iconPosition:'top'}]},v={type:'Container',visibleWhen:'activeCategory_main=Import',children:[{type:'TextBlock',margin:'50px 0 15px 50px',text:o.a.fileMenu.import,style:'font-size:36px;line-height:80px'},{type:'ColumnSet',margin:'0 0 0 50px',children:[{type:'Column',children:[{type:'List',className:'file-menu-list',items:[{text:o.a.fileMenu.excelFile,value:g.Excel},{text:o.a.fileMenu.csvFile,value:g.Csv},{text:' ',enabled:!1},{text:o.a.fileMenu.spreadSheetJsonFile,value:g.SSJson}],bindingPath:'activeCategory_import'}],width:'350px'},{type:'Column',children:[u,S,f,y],width:'stretch'}]}]},b={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.spreadSheetJsonFile},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportSpreadSheetFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_export_ssjson',iconPosition:'top'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportJSFile,width:120,height:120,iconClass:'icon-common icon-ssjson',bindingPath:'button_export_javascript',iconPosition:'top'},{type:'ColumnSet',children:[{type:'Column',children:[{type:'TextBlock',margin:'0 0 0 50px',text:o.a.fileMenu.exportSheetLabel,style:'line-height:30px;'}],width:'230px'},{type:'Column',children:[{type:'ListComboEditor',margin:'3px 0 0 10px',bindingPath:'exportJsonSetting.sheetToExport'}],width:'220px'}]}],visibleWhen:'activeCategory_export='+g.SSJson},T={type:'Container',id:'c_computerContent',className:'sub-category-content file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 10px 50px',text:o.a.fileMenu.saveFlags},...function(W){let V=[{text:o.a.fileMenu.importExportOptions.includeStyles,tips:o.a.fileMenu.exportOptionsTips.includeStyles,name:'includeStyles'},{text:o.a.fileMenu.importExportOptions.includeFormulas,tips:o.a.fileMenu.exportOptionsTips.includeFormulas,name:'includeFormulas'},{text:o.a.fileMenu.importExportOptions.includeUnusedNames,tips:o.a.fileMenu.exportOptionsTips.includeUnusedNames,name:'includeUnusedNames'},{name:''},{text:o.a.fileMenu.importExportOptions.saveAsView,tips:o.a.fileMenu.exportOptionsTips.saveAsView,name:'saveAsView'},{text:o.a.fileMenu.importExportOptions.includeBindingSource,tips:o.a.fileMenu.exportOptionsTips.includeBindingSource,name:'includeBindingSource'},{text:o.a.fileMenu.importExportOptions.includeEmptyRegionCells,tips:o.a.fileMenu.exportOptionsTips.includeEmptyRegionCells,name:'includeEmptyRegionCells'},{text:o.a.fileMenu.importExportOptions.includeAutoMergedCells,tips:o.a.fileMenu.exportOptionsTips.includeAutoMergedCells,name:'includeAutoMergedCells'},{name:''},{text:o.a.fileMenu.importExportOptions.rowHeadersAsFrozenColumns,tips:o.a.fileMenu.exportOptionsTips.rowHeadersAsFrozenColumns,name:'rowHeadersAsFrozenColumns'},{text:o.a.fileMenu.importExportOptions.columnHeadersAsFrozenRows,tips:o.a.fileMenu.exportOptionsTips.columnHeadersAsFrozenRows,name:'columnHeadersAsFrozenRows'}];return V.map((z)=>{return''===z.name?{type:'TextBlock',text:' ',style:'height:20px'}:{type:'CheckBox',margin:`0 0 0 ${W}px`,text:z.text,bindingPath:'exportXlsxOptions.'+z.name,tips:z.tips}})}(50),{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'exportXlsxOptions.password',placeholder:o.a.fileMenu.exportPassword},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_export_excel',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.Excel},E={type:'Container',id:'c_computerContent',className:'sub-category-content file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.excelFile},{type:'TextBlock',margin:'0 0 0 50px',text:o.a.fileMenu.saveFlags},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportIgnoreStyle,bindingPath:'exportExcelSetting.ignoreStyle'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportIgnoreFormulas,bindingPath:'exportExcelSetting.ignoreFormula'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportIncludeBindingSource,bindingPath:'exportExcelSetting.includeBindingSource'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportSaveAsViewed,bindingPath:'exportExcelSetting.saveAsView'},{type:'CheckBox',margin:'0 0 0 50px',text:o.a.fileMenu.exportSaveBothCustomRowAndColumnHeaders,className:'category-content-text',bindingPath:'exportExcelSetting.exportRowAndColumnHeaders'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.exportSaveCustomRowHeaders,bindingPath:'exportExcelSetting.exportRowHeaders',className:'file-menu-excel-option'},{type:'CheckBox',margin:'0 0 0 80px',text:o.a.fileMenu.exportSaveCustomColumnHeaders,bindingPath:'exportExcelSetting.exportColumnHeaders',className:'file-menu-excel-option'},{type:'TextBlock',margin:'5px 0 0 50px',text:o.a.fileMenu.exportPassword},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',isPassword:!0,bindingPath:'exportExcelSetting.password'},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportExcelFile,width:120,height:120,iconClass:'icon-common icon-excel',bindingPath:'button_export_io_excel',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.ExcelIO},P={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.csvFile},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportSheetIndex},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.sheetIndex'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportEncoding},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.encoding'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportRow},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.row'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportColumn},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.column'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportRowCount},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.rowCount'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportColumnCount},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.columnCount'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportRowDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.rowDelimiter'},{type:'TextBlock',margin:'10px 0 0 50px',text:o.a.fileMenu.exportColumnDelimiter},{type:'TextEditor',margin:'5px 0 0 50px',style:'width:200px',bindingPath:'exportCsvSetting.columnDelimiter'},{type:'Button',margin:'10px 50px',text:o.a.fileMenu.exportCsvFile,width:120,height:120,iconClass:'icon-common icon-csv',bindingPath:'button_export_csv',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.Csv},B={type:'Container',className:'file-menu-setting-container',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.pdfFile},{type:'LabelLine',margin:'0 50px',text:o.a.fileMenu.pdfBasicSetting},{type:'ColumnSet',children:[{type:'Column',children:[{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfTitle,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfAuthor,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfApplication,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfSubject,style:'line-height:30px;width:100px'},{type:'TextBlock',margin:'5px 0 0 80px',text:o.a.fileMenu.pdfKeyWords,style:'line-height:30px;width:100px'}],width:'auto'},{type:'Column',children:[{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.title'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.author'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.creator'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.subject'},{type:'TextEditor',margin:'10px 0 0 80px',bindingPath:'exportPdfSetting.keywords'}],width:'auto'}]},{type:'LabelLine',margin:'10px 0 0 50px',text:o.a.fileMenu.pdfExportSetting},{type:'ColumnSet',children:[{type:'Column',children:[{type:'TextBlock',margin:'0 0 0 80px',text:o.a.fileMenu.exportSheetLabel,style:'line-height:30px;'}],width:'230px'},{type:'Column',children:[{type:'ListComboEditor',margin:'3px 0 0 10px',bindingPath:'exportPdfSetting.sheetToExport'}],width:'220px'}]},{type:'Button',margin:'20px 50px',text:o.a.fileMenu.exportPdfFile,width:120,height:120,iconClass:'icon-common icon-pdf',bindingPath:'button_export_pdf',iconPosition:'top'}],visibleWhen:'activeCategory_export='+g.Pdf},O={type:'Container',visibleWhen:'activeCategory_main=Export',children:[{type:'TextBlock',margin:'50px 0 15px 50px',text:o.a.fileMenu.export,style:'font-size:36px;line-height:80px'},{type:'ColumnSet',margin:'0 0 0 50px',children:[{type:'Column',children:[{type:'List',className:'file-menu-list',items:[{text:o.a.fileMenu.excelFile,value:g.Excel},{text:o.a.fileMenu.csvFile,value:g.Csv},{text:o.a.fileMenu.pdfFile,value:g.Pdf},{text:' ',enabled:!1},{text:o.a.fileMenu.spreadSheetJsonFile,value:g.SSJson}],bindingPath:'activeCategory_export'}],width:'350px'},{type:'Column',children:[b,E,T,P,B],width:'stretch'}]}]},_={type:'Container',visibleWhen:'activeCategory_main=Info',children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.fileMenu.info.title,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[{type:'Container',className:'file-menu-setting-container',margin:'0 0 15px 46px',children:[{type:'FileMenuInfoEditor',bindingPath:'docProps'}]}]}]}]},N={type:'Container',visibleWhen:`activeCategory_main=${p.OpenSJS}`,children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.fileMenu.open,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[C]}]}]},R={type:'Container',visibleWhen:`activeCategory_main=${p.SaveSJS}`,children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.fileMenu.save,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[D]}]}]},L={type:'Container',visibleWhen:`activeCategory_main=${p.Recent}`,children:[{type:'TextBlock',margin:'50px 0 0px 50px',text:o.a.recent,style:'font-size:36px;'},{type:'ColumnSet',margin:'20px 0 0 50px',children:[{type:'Column',children:[{type:'TextBlock',margin:'0 0 15px 50px',style:'color:green;font-size:22px;',text:o.a.fileMenu.recentWorkbooks},{type:'FileMenuFileList',margin:'0 10px 0 50px',bindingPath:'recentWorkbookFiles_open'}],visibleWhen:'activeCategory_open='+g.RecentWorkbooks}]}]},I={type:'FlexContainer',children:[{type:'ColumnSet',children:[{type:'Column',children:[{type:'Container',className:'gc-file-menu-category',children:[{type:'Container',className:'back-button-container',children:[{type:'Container',className:'back-button-icon'},{type:'Button',className:'back-button',bindingPath:'activeCategory_hide'}]},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.new,value:p.New}]},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.recent,value:p.Recent}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.open,value:p.OpenSJS},{text:o.a.fileMenu.save,value:p.SaveSJS}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.import,value:p.Import},{text:o.a.fileMenu.export,value:p.Export}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.print.title,value:p.Print}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.info.title,value:p.Info}]},{type:'LabelLine',margin:'5px 0 0 0',className:'seprater-line'},{type:'List',className:'file-menu-category-list',bindingPath:'activeCategory_main',items:[{text:o.a.fileMenu.exit,value:p.Exit}]}]}],width:'220px'},{type:'Column',className:'category-content-container',children:[m,v,O,{type:'Container',visibleWhen:'activeCategory_main=Print',children:[{type:'FileMenuPrintEditor',bindingPath:'printSetting'}]},N,R,L,_],width:'stretch'}]}]},J={templateName:'fileMenuPanelTemplate',content:[I]}},function(t,a,l){'use strict';Object.defineProperty(a,'__esModule',{value:!0});l(9)}]);
