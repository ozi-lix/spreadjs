/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var e,r,n;function i(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},e[n].call(t.exports,t,t.exports,i)),t.exports}e={"./dist/plugins/hyperlink/hyperlink.js":function(P,n,t){var e,k,f,p,l,r,g,u,t,i,C,o,h,c,s,a,m,d,v,w,$,E,F,T,I,R,V,W,q,B,D,y,J,K,x,b,H,z,_,G,Q,j,A,X,Y,Z,nn,tn,en,rn,O,n,on,un;function M(n,t){return on.call(this,n,t)||this}function S(n,t){return un.call(this,n,t)||this}function U(n,t,e,r){return C(r)&&(r=3),!C(n.getHyperlink(t,e,r))}function ln(){var n=r(K);return u(n).css(w,$).css(E,0).css(R,2).css(V,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(W,D).css(B,J).css(F,"9pt Arial"),n}function sn(n,t,e){var r,i,o,r,i,o,e;e&&(i=(r=n&&n.qc()).getElementsByClassName(x)[0],o=!1,C(i)&&((i=ln()).className=x,r.insertBefore(i,s),o=!0),r=u(i),!o&&r.isVisible()||(r.text(e),o=(i=n.rt.it()).left+t.x,e=i.top+t.y+20,r.css(I,e).css(T,o),r.show()))}function L(n){var t,n,t,n=(n&&n.qc()).getElementsByClassName(x)[0];C(n)||u(n).hide()}function an(n,t){C(t)||(t.drawUnderline&&(C(n.textDecoration)?n.textDecoration=1:0!==n.textDecoration&&1!=(1&n.textDecoration)&&(n.textDecoration+=1)),t.isVisited?t.visitedLinkColor===s?n.foreColor="rgba(0,0,0,0)":t.visitedLinkColor===c?n.foreColor=H:n.foreColor=t.visitedLinkColor:C(t.linkColor)?t.linkColor===c&&(n.foreColor||n.foreColor===s)||(n.foreColor=b):n.foreColor=t.linkColor)}function N(n){if(n&&n.cellType){var n=n.cellType.typeName;if(!rn[n])return 1}}function cn(n,t,e,r,i,o,u){var l,s,a,n,u,l=0,s=0,a=n.width,n=n.height,u=fn(u);return u&&(a-=u),l=o=o||0,1===r?l=(a-t)/2:2===r?l=a-t-o:5===r&&(l=(a-t)/2),1===i?s=(n-e)/2:2===i&&(s=n-e),u&&(l+=u),{x:l,y:s}}function fn(n){var t={context:n,value:0};return i.et(n.sheet,"getOutlineColumnOffset",t),t.value}function pn(n,t){var e,n,e=yn(t),n=n-3-e;return 5===t.hAlign&&(n-=e),--n}function hn(n,t,e,r){var t,e,t=pn(t,e),e=k.q.Q3e(n);return 1===e.length&&0===e[0].prefixSpaceCount?a(0,k.q.Wt(e[0].word,r,!0)):t}function dn(n,t,e,r){var i,o,u,i=l(t),o,u;return{x:0,y:0,width:5===e.hAlign?hn(n,r,e,t):a(0,k.q.Wt(n,t,!0)),height:n.split(/\r\n|\r|\n/).length*i}}function vn(n,t,e,r,i,o){var n,e,n=dn(n,e,t,r.width),e=cn(r,n.width,n.height,t.hAlign,t.vAlign,i,o);return n.x=e.x,n.y=e.y,n}function wn(n,t,e,r,i,o){var u,l,u,s,a,c,f,l,u,l,u,p,h,d,v,w,y,l=i.sheet,u=l.Dn;if(!C(e)){if(e.textOrientation)return!0;if(s=l.getValue(i.row,i.col,i.sheetArea),o=o||l.getText(i.row,i.col,i.sheetArea))for(o=o.replace(/\s+/g," "),a=e&&e.font?e.font:u.Nn(),a=u._n(a),c=[o],f=yn(e),l=null!=(u=l.outlineColumn.Tme)?u:0,!e.wordWrap&&5!==e.hAlign||(u=r.width-3-f-l,5===e.hAlign&&(u-=f),o=(c=k.q.un(o,u,a)).join("\r\n")),3===(l=e.hAlign)&&(l=g(l,s,e.formatter||e._autoFormatter),e.hAlign=l),u=vn(o,e,a,r,f,i),p=r.y+u.y,h=0;h<c.length;h++)if(d=vn(c[h],e,a,r,f,i),v=r.x+d.x,w=m(v+d.width,r.x+r.width),p=m((y=p)+d.height,r.y+r.height),v<=n&&n<w&&y<=t&&t<p)return!0}return!1}function yn(n){return 8*(n.textIndent||0)}function kn(n,t){var n,e,t,n=n.replace(/:\/*/,"://"),e=(n=n.endsWith("://")?n:n.replace(/\/+$/,"")).endsWith("/")?"":"/",t=t.replace(/^\/+/,"");return"".concat(n).concat(e).concat(t)}e=this&&this.__extends||(O=function(n,t){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}O(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HyperlinkTargetType=void 0,k=t("Core"),f=t("Common"),p=t("SheetsCalc"),l=k.mt.vt,r=k.mt.En,g=k.mt.gt,u=k.GC$,t=k.Commands.ActionBase,i=k.CellTypes.Base,C=f.Common.lt.ht,o=f.Common.lt.tv,h=f.Common.zf.TY,c=void 0,s=null,a=Math.max,m=Math.min,d=window.open,v=f.Common.zf.fJ,w="position",$="absolute",E="margin",F="font",T="left",I="top",R="padding",V="border",W="box-sizing",q="pointer",B="background-color",D="content-box",y="default",J="white",K="div",x="gc-spread-hyperlink-tooltip",H="followedHyperlink",z=b="hyperlink",_="openUrl",G="generateHyperlink",Q=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,j=/^(mailto:\/\/)?([a-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([a-z0-9\-])+\.([a-z0-9\-]){2,63}(\?subject=.+)?$/gi,A=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|www\.[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9]+\.[^\s]{2,}|www\.[a-z0-9]+\.[^\s]{2,})/gi,(n=X=n.HyperlinkTargetType||(n.HyperlinkTargetType={}))[n.blank=0]="blank",n[n.self=1]="self",n[n.parent=2]="parent",n[n.top=3]="top",k.GC$.extend(k.Y8.prototype,{getHyperlink:function(n,t,e){var r,i,i;return i={row:n,col:t,sheetArea:e=C(e)?3:e,isLinkGet:!1,hyperlink:c},k.Y8.et(r=this,"getHyperlink",i),i.isLinkGet||(i=r.W_(e).J_(n,t))&&!C(i.hyperlink)?i.hyperlink:s},setHyperlink:function(n,t,e,r){var i,o,u,l,l,s,o,a,i=this;if(C(r)&&(r=3),(o=e&&e.url)&&o.match(A)&&0<o.match(A).length?v(o,u="www.")&&(e.url="http://"+o):o&&o.match(j)&&0<o.match(j).length&&(v(o,l="mailto:")||(e.url=l+o)),l=0<i.P8?[["sheetModels",r],c]:c,s=i.W_(r).J_(n,t,!0,l?l[0]:c),C(s))l&&(l.length=0);else{if(o=s.hyperlink,C(e)){if(C(s.hyperlink))return;s.hyperlink=null,delete s.hyperlink,i.Mf.$Dr({type:"setHyperlink",row:n,col:t,sheetArea:r,hyperlink:null})}else{for(a in s.hyperlink={url:"",linkColor:c,visitedLinkColor:c,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},s.hyperlink)e[a]!==c&&(s.hyperlink[a]=e[a]);i.Mf.$Dr({type:"setHyperlink",row:n,col:t,sheetArea:r,hyperlink:s.hyperlink})}l&&(l[0].push("hyperlink"),l[1]=o,l[2]=s.hyperlink)}l&&0<l.length&&i.G8.push(l)}}),k.GC$.extend(k.Worksheet.prototype,{getHyperlink:function(n,t,e){var r,i;return 0===e?s:(C(e)&&(e=3),i=(r=this).Ut,o(i.getHyperlink(n,t,e)))},setHyperlink:function(n,t,e,r){var i,o,u,l;0===r||(C(r)&&(r=3),u=(o=(i=this).Ut).getRowCount(r),l=o.getColumnCount(r),n<0)||u<=n||t<0||l<=t||(o.do("setHyperlink",n,t,e,r),this.zw())}}),e(M,on=t),M.prototype.execute=function(){var n,n,t,e,r,i,o,u,t,l,n,l,l,s,l,s,a,a,a,a,c,o,t=this,e=t.Mf,r=!1,i=e.parent,o=e,u=t.tT.url;if(!C(u))if(t=t.tT.target||0,0===(u=(n=null==(n=null==(n=i.docProps)?void 0:n.appDocProps)?void 0:n.hyperlinkBase)!==(l="sjs://")||u.startsWith(n)?u:n+u).indexOf(l)||"#"===u[0]){if(l=l.length,l="#"===u[0]?u.substr(1):u.substr(l),(s=(s=(0,p.formulaToRanges)(e,l,0,0,!(s=void 0)))&&0===s.length?(0,p.formulaToRanges)(e,l,0,0,!1,!0):s)&&0<s.length){if(l=s[0].sheetName,s=s[0].ranges[0],l!==e.name()&&i.getSheetFromName(l).visible()===k.SheetTabVisible.visible){if(a=i.getSheetFromName(l),i.ki(k.Events.ActiveSheetChanging,a={oldSheet:o,newSheet:a,cancel:!1}),a.cancel)return;i.setActiveSheet(l),a=i.getActiveSheetIndex(),i.w2.Tg(a),o!==(e=i.getActiveSheet())&&i.ki(k.Events.ActiveSheetChanged,{oldSheet:o,newSheet:e})}i.getSheetFromName(l).visible()===k.SheetTabVisible.visible&&(e.OA(s.row,s.col),e.setSelection(s.row,s.col,s.rowCount,s.colCount))}}else C(u)||(a="mailto:",u.match(A)&&0<u.match(A).length?v(u,c="www.")&&(u="http://"+u):u.match(j)&&0<u.match(j).length?v(u,a)||(u=a+u):n&&(u=kn(n,u)),v(u,a)&&1<f.Common.zf.DU(u,"?")&&(u=(o=u.split("?"))[0]+"?"+o.slice(1).join("%3F")),d(h(u),["_blank","_self","_parent","_top"][t]));return!1},Y=M,k.Commands[_]={canUndo:!1,execute:function(n,t,e){return k.Commands.zA(n,Y,t,e)}},e(S,un=t),S.prototype.execute=function(){var n,t,e,r,i,o,e,u,l,l,n=this,t=n.Mf,e=n.tT,r=e.url,i=e.row,o=e.col,e=e.sheetArea;if(null===r)u=null;else{if("string"!=typeof r)return!1;if(!((l=(!(l=r.match(A))||l.length<1)&&(!(l=r.match(j))||l.length<1)?r.match(Q):l)&&0<l.length&&0===r.indexOf(l[0])&&r.length===l[0].length))return!1;u={url:r,linkColor:b,visitedLinkColor:H}}return t.Ut.startTransaction(),t.suspendPaint(),t.suspendEvent(),t.setHyperlink(i,o,u,e),t.resumeEvent(),t.resumePaint(),l=k.Commands.TI(t.name()),n.tT[l]=t.Ut.endTransaction(),!0},S.prototype.undo=function(){var n,t,e,n,t=this.Mf;return t.suspendPaint(),t.suspendEvent(),e=k.Commands.TI(t.name()),t.Ut.undo(this.tT[e]),t.resumeEvent(),t.resumePaint(),!0},Z=S,k.Commands[G]={canUndo:!0,execute:function(n,t,e){return k.Commands.zA(n,Z,t,e)}},k.Workbook.ch(z,nn={init:function(){this.commandManager().register(_,k.Commands[_]),this.commandManager().register(G,k.Commands[G])}}),k.Worksheet.ch(z,tn={setHyperlinkWhenEditing:function(n){var t,e,r,n,i,o,t=n.url,e=n.row,r=n.col,n=n.sheetArea,i=this,o=i.getParent();o.options.allowAutoCreateHyperlink&&o.commandManager().execute({cmd:G,sheetName:i.name(),url:t,row:e,col:r,sheetArea:n})}}),i.ch(z,en={applyHyperlinkStyle:function(n){var t,e,r,i,t,t=n.sheet,e=n.row,r=n.col,i=n.style,t=t.getHyperlink(e,r,n.sheetArea);N(i)||an(i,t)},getCellTextHitInfo:function(n){var t,e,r,i,o,u,l,s,a,c,f,c,t=n.context.sheetArea,e=n.cellStyle,r=n.context,i=r.sheet,o=r.row,u=r.col;U(i,o,u,t)&&!N(e)&&((l=n.cellRect)&&(s=i.C0(o),a=i.S0(u),c=i.Fi(),f=void 0,i.getSpan(o,u,t)||!C(t)&&3!==t?2===t?f=c.B1(s):1===t&&(f=c.L1(a)):f=c.c9(s,a),f)&&(l=l.getIntersectRect(f)),!C(t)||3===t)&&e&&l&&(c=i.getText(o,u,t),n.paddingHitInfo={row:o,col:u,x:n.x,y:n.y,sheetArea:t,sheet:i,isFocusAware:!0,isReservedLocation:wn(n.x,n.y,e,l,r,c)})},processMouseUpOnCellPadding:function(n){var t,e,r,i,o,e,e,u,e,u,i,t=n.sheet,e=n.cellStyle,r=n.row,i=n.col,o=n.sheetArea;t&&!t.isEditing()&&U(t,r,i,o)&&!N(e)&&n.isReservedLocation&&(e=t.Dg(),L(t),e&&(e.style.cursor=y),(e=t.Ut.getHyperlink(r,i,o)).isVisited=!0,u=e.command,C(u)||""===u||u===_?t.getParent().commandManager().execute({cmd:_,sheetName:t.name(),url:e.url,target:e.target}):"string"==typeof u?t.getParent().commandManager().execute({cmd:u,row:r,col:i,sheetName:t.name(),sheetArea:o}):"function"==typeof u&&u.call(s,t,r,i,o),e=t.getColumnCount(),u=new k.Range(r,-1,1,e),(i=t.j1(u,n.sheetArea)).y-=2,i.height+=4,t.repaint(i))},processMouseMoveOnCellPadding:function(n){var t,e,r,i,o,i,t,t=n.row,e=n.col,r=n.sheet,i=n.cellStyle,o=n.sheetArea;!U(r,t,e,o)||N(i)||!r||r.isEditing()&&r.getActiveRowIndex()===t&&r.getActiveColumnIndex()===e||(i=r.Dg(),t=r.getHyperlink(t,e,o),n.isReservedLocation?i&&(sn(r,n,t.tooltip),i.style.cursor=q):(L(r),i&&(i.style.cursor=y)))},processMouseLeaveOnCellPadding:function(n){var t,e,r,n,e,t=n.sheet,e=n.row,r=n.col,n=n.sheetArea;L(t),U(t,e,r,n)&&t&&(e=t.Dg())&&(e.style.cursor=y)},onUpdateContainer:function(n){var t,e,r,n,t=n.cellStyle,e=n.context.row,r=n.context.col,n=n.context.sheet.getHyperlink(e,r);N(t)||an(t,n)}}),rn={0:!0,1:!0,2:!0,3:!0,4:!0}},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},r={},n=i("./dist/plugins/hyperlink/hyperlink.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Hyperlink=n}();