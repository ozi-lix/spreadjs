/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,o,n;function u(n){var t,t,t=o[n];return void 0!==t||(t=o[n]={exports:{}},i[n].call(t.exports,t,t.exports,u)),t.exports}i={"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(n,t,i){var o,r,s,i,v,u,e,c,l,f,a,h,d,m,C,p,g,w,O,I;function y(n,t,i,o){return b(n,t,i,o)}function _(n,t,i,o){n.ki(s.Events.OutlineColumnCheckStatusChanged,{sheet:n,sheetName:n.name(),row:t,col:i,status:o})}function b(n,t,i,o){var o,u,e,r,s,c,l,f,a,h,h,o=v(o)?n.getActiveColumnIndex():o;if(!n.outlineColumn.Un(o))return null;if(u=t?1:-1,e=n.getActiveRowIndex(),r=n.getSelections()[0].rowCount,c=!0,v(i))for(c=!(i={}),s=e;s<r+e;s++)0===s||(l=n.rowOutlines.getLevel(s),t&&(f=n.rowOutlines.getLevel(s-1))<l&&!i[s-1])||(a=l+u,h=n.outlineColumn.options(),(h=(v(h.maxLevel)?n.outlineColumn.Fpt():h).maxLevel)&&h<a+1)||a+1<0||(i[s]={row:s,original:l+1,current:a+1},c=!0);return c?i:null}function j(n,t,i){var o,u,e;if(t){for(u in o=v(i)?n.getActiveColumnIndex():i,n.outlineColumn.Xst(),n.suspendPaint(),t)r.Common.kh(t,u)&&(e=t[u],n.getCell(e.row,o).textIndent(e.current));n.resumePaint(),n.outlineColumn.$st()}}function x(n,t,i,o){var u,e,r,s,c,l,f,a,u=0,e=0,s=n.rowOutlines.getLevel(t);if(n.outlineColumn.mst.updateCheckStatus(t,o),null!==(c=t<=n.getRowCount()-2?n.rowOutlines.find(t+1,s+1):null)&&null!==o)for(l=c.start;l<c.end+1;l++)n.outlineColumn.mst.updateCheckStatus(l,o);for(c=n.rowOutlines.find(t,s);null!==c&&null!==c.parent;){if(0<c.start){for(u=c.start-1,e=n.rowOutlines.getLevel(u),n.outlineColumn.mst.updateCheckStatus(u,o),l=(r=n.rowOutlines.find(1+u,e+1)).start;l<r.end+1;l++)if((f=n.outlineColumn.mst.vst[l].checkBox.checkStatus)!==o){n.outlineColumn.mst.updateCheckStatus(u,a="number"==typeof f&&"number"==typeof o&&3);break}l===r.end+1&&!0===o&&n.outlineColumn.mst.updateCheckStatus(u,!0)}c=c.parent}}function k(n){var t=n.Mf,i=s.Commands.TI(t.name()),n=n.tT[i];t.Ut.undo(n)}function G(n,t){return g.call(this,n,t)||this}function S(n,t){return w.call(this,n,t)||this}function A(n,t){return O.call(this,n,t)||this}function H(n,t){return I.call(this,n,t)||this}o=this&&this.__extends||(p=function(n,t){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}p(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.setCheckStatus=t.outlineColumnCheckStatus=t.commands=void 0,r=i("Common"),s=i("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return s.Commands}}),i=s.Commands.ActionBase,v=r.Common.lt.ht,u="increaseCellIndent",e="decreaseCellIndent",c="updateOutlineColumnCheckStatus",l="updateOutlineColumnOption",t.outlineColumnCheckStatus=f="outlineColumnCheckStatus",a=s.Commands.zA,t.setCheckStatus=x,o(G,g=i),G.prototype.canExecute=function(){return!!y(this.Mf,!0,this.tT.changingRows,this.tT.changingColumns)},G.prototype.canUndo=function(){return!0},G.prototype.execute=function(){var n,t;return!!this.canExecute()&&((n=this.Mf).Ut.startTransaction(),n.outlineColumn.mst.Ppt(),v(this.tT.changingColumns)&&(this.tT.changingColumns=n.getActiveColumnIndex()),this.tT.changingRows=b(n,!0,this.tT.changingRows,this.tT.changingColumns),j(this.Mf,this.tT.changingRows,this.tT.changingColumns),t=s.Commands.TI(n.name()),this.tT[t]=n.Ut.endTransaction(),!0)},G.prototype.undo=function(){var n,t,i,n,n=this,t=n.Mf,i=s.Commands.TI(t.name()),n=n.tT[i];return t.Ut.undo(n),!0},h=G,o(S,w=i),S.prototype.canExecute=function(){return!!y(this.Mf,!1,this.tT.changingRows,this.tT.changingColumns)},S.prototype.canUndo=function(){return!0},S.prototype.execute=function(){var n,t;return!!this.canExecute()&&((n=this.Mf).Ut.startTransaction(),n.outlineColumn.mst.Ppt(),v(this.tT.changingColumns)&&(this.tT.changingColumns=n.getActiveColumnIndex()),this.tT.changingRows=b(n,!1,this.tT.changingRows,this.tT.changingColumns),j(n,this.tT.changingRows,this.tT.changingColumns),t=s.Commands.TI(n.name()),this.tT[t]=n.Ut.endTransaction(),!0)},S.prototype.undo=function(){return k(this),!0},d=S,o(A,O=i),A.prototype.canExecute=function(){return!0},A.prototype.canUndo=function(){return!0},A.prototype.execute=function(){var n,t,n,i,o,i,n=this,t=n.Mf,n=n.tT,i=n.options,o=JSON.parse(JSON.stringify(t.outlineColumn.NB));return t.Ut.startTransaction(),t.outlineColumn.NB=i,t.outlineColumn.refresh(),n[i=s.Commands.TI(t.name())]=t.Ut.endTransaction(),n[i].oldOptions=o,!0},A.prototype.undo=function(){return k(this),this.Mf.outlineColumn.refresh(),!0},m=A,o(H,I=i),H.prototype.canExecute=function(){return!0},H.prototype.canUndo=function(){return!0},H.prototype.execute=function(){var n,t,n,i,o,u,e,n=this,t=n.Mf,n=n.tT,i=n.row,o=n.col,u=n.status;return t.Ut.startTransaction(),x(t,i,o,u),t.outlineColumn.refresh(),n[e=s.Commands.TI(t.name())]=t.Ut.endTransaction(),_(t,i,o,u),!0},H.prototype.undo=function(){return k(this),this.Mf.outlineColumn.refresh(),!0},C=H,s.Commands[u]={canUndo:!0,execute:function(n,t,i){return t.cmd=u,a(n,h,t,i)}},s.Commands[e]={canUndo:!0,execute:function(n,t,i){return t.cmd=e,a(n,d,t,i)}},s.Commands[l]={canUndo:!0,execute:function(n,t,i){return t.cmd=l,a(n,m,t,i)}},s.Commands[c]={canUndo:!0,execute:function(n,t,i){return t.cmd=c,a(n,C,t,i)}},s.Commands.Gpt=function(n){var t=s.mt.Qf(),i=!t,t=t;n.register(u,s.Commands[u],221,i,!1,!0,t),n.register(e,s.Commands[e],219,i,!1,!0,t),n.register(c,s.Commands[c]),n.register(l,s.Commands[l])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(n,t,i){var o,u,o=this&&this.__createBinding||(Object.create?function(n,t,i,o){void 0===o&&(o=i);var u=Object.getOwnPropertyDescriptor(t,i);u&&("get"in u?t.__esModule:!u.writable&&!u.configurable)||(u={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,o,u)}:function(n,t,i,o){n[o=void 0===o?i:o]=t[i]}),u=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||o(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),u(i("./dist/plugins/outlineColumn/outlineColumn.js"),t),u(i("./dist/plugins/outlineColumn/outlineColumn-actions.js"),t),u(i("./dist/plugins/outlineColumn/outlineColumn.ns.js"),t)},"./dist/plugins/outlineColumn/outlineColumn.js":function(T,n,t){var c,i,o,s,t,u,e,l,r,f,a,h,v,m,C,d,p,g,w,O,I,y,_,b,u,j,x,k,G,D,B,J;function L(n){return n.expandIndicator||n.collapseIndicator}function S(n,t){return n&&n.outlineColumn&&n.outlineColumn.options()&&n.outlineColumn.options().columnIndex===t}function P(n,t,i){var o,u,e,r,o=t.x+i.x,u=i.y+i.height/2-t.height/2,e=t.height,r=t.width;i.x+i.width<o+r||(n.save(),n.beginPath(),n.strokeStyle="black",n.strokeRect(o,u,r,e),n.fillStyle="white",n.fillRect(o,u,r,e),3===t.checkStatus?(n.beginPath(),n.fillStyle="black",n.rect(o+r/5,u+e/5,r-.4*r,e-.4*e),n.fill()):!0!==t.checkStatus&&1!==t.checkStatus||(n.beginPath(),n.lineWidth=r/5,n.moveTo(o+r/6,u+e/2),n.lineTo(o+2*r/5,u+5/7*e),n.lineTo(o+5/6*r,u+e/6),n.stroke()),n.restore())}function U(n,t,i,o){var u,e,r,s,c,u=t.collapsed,e=t.x+i.x,r=i.y+i.height/2-t.height/2,s=t.height,c=t.width;i.x+i.width<e+c||(u?t.expandIndicator?A(n,t.expandIndicator,t,i,o):(n.save(),n.fillStyle="black",n.beginPath(),n.moveTo(e,r),n.lineTo(e,r+s),n.lineTo(e+c,r+s/2),n.fill(),n.restore()):t.collapseIndicator?A(n,t.collapseIndicator,t,i,o):(n.save(),n.fillStyle="black",n.beginPath(),n.moveTo(e,r+s),n.lineTo(e+c,r+s),n.lineTo(e+c,r),n.fill(),n.restore()))}function A(n,t,i,o,u){var e,r,s,i,c,e=i.x+o.x,r=o.y+o.height/2-i.height/2,s=i.width,i=i.height;if(!(o.x+o.width<e+s)&&t&&"none"!==t&&u)try{u.getState(t)?(c=u.getImage(t),n.drawImage(c,0,0,c.width,c.height,e,r,s,i)):u.addImage(t)}catch(n){}}function H(n,t,i,o){var n={sheet:n,sheetName:n.name(),isRowGroup:!0,index:t,level:i};return o&&(n.cancel=!1),n}function F(n,t,i,o){var u,e,u,r,u=n.options,e;n.isActualProtected()&&!u.protectionOptions.allowOutlineRows?n.jT(c.InvalidOperationType.groupProtected,j().Exp_GROUP_PROTECTED):(u=n.rowOutlines.getLevel(t),h(o)&&(o=!n.rowOutlines.getCollapsed(t)),r=H(n,t+1,u+1,!0),n.ki(c.Events.RangeGroupStateChanging,r),r&&!1===r.cancel&&(i?n.Qy().execute({cmd:"expandRowOutline",sheetName:n.name(),index:t,level:u+1,collapsed:o}):(0,s.expandOutlineAction)(o,t,u+1,n,!0),n.ki(c.Events.RangeGroupStateChanged,H(n,t+1,u+1,!1))))}function z(n,t,i,o){var i,t,t={cmd:"updateOutlineColumnCheckStatus",row:t,col:i,status:o=h(o)?typeof(i=n.outlineColumn.getCheckStatus(t))===_?1===i?2:1:!i:o,sheetName:n.name()};n.Qy().execute(t)}function W(n,t,i){var o,u,e,r,o=n.getLevel(t);if(i!==o+1)for(u=i-(o+1),e=0,r=Math.abs(u);e<r;e++)0<u?n.group(t,1):n.ungroupRange(t,1)}function K(n){var t,i,o,u,t=n.outlineColumn;if(t.mst.vst&&!a(t.mst.vst)&&n.rowOutlines.items&&!a(n.rowOutlines.items))for(i=n.rowOutlines.items,o=0;o<i.length;o++)(u=i[o])?t.mst.updateIndicatorCollapsed(o,n.rowOutlines.isCollapsed(o+1)):t.mst.CRe(o)}function X(n,t,i,o,u,e,r){var s,c,l,f,a,h,v,d,i,s;R(i,"showIndicator")?(c=n.zoom(),l=n.getRowCount(),f=!!n.rowOutlines.isCollapsed(t+1),a=m*c,h=C*c,d=v=null,i.expandIndicator&&(v=i.expandIndicator,f)&&(a=O*c,h=I*c),i.collapseIndicator&&(d=i.collapseIndicator,f||(a=O*c,h=I*c)),t<l-1&&((i=n.getActualStyle(t+1,o))&&i.textIndent>u?r.indicator={x:e.value+p*c,y:-h/2,width:a,height:h,collapsed:f,collapseIndicator:d,expandIndicator:v}:delete r.indicator),e.value+=2*p*c+a):delete r.indicator}function R(n,t){return(h(n[t])?x:n)[t]}function E(n,t,i){for(var o,u,e,r,s,o=-1,u=0,e=n.children,r=n.start;r<=n.end;r++)if(s=void 0,e&&e[u]&&e[u].start-1===r?(s=E(e[u],t,i),r=e[u].end,u++):s=t[r]&&t[r].checkBox&&t[r].checkBox.checkStatus,-1===o)o=s;else if(o!==s){o=typeof s===_&&typeof o===_&&3;break}for(;u<n.children.length;u++)E(e[u],t,i);return i.updateCheckStatus(n.start-1,o),o}function Y(n){var t,i,n,t=n.rowOutlines,i=n.outlineColumn.mst,n=t.find(0,-1);n.children&&n.children.forEach(function(n){E(n,i.vst,i)})}function q(n,t,i,o,u,e){var r,i,n,r;(h(i.showCheckBox)?x:i).showCheckBox?(i=!h(e.checkBox)&&1!==e.checkBox&&e.checkBox.checkStatus,n=n.zoom(),e.checkBox={x:u.value+p*n,y:-d*n,width:2*d*n,height:2*d*n,checkStatus:i},u.value+=2*p*n+2*d*n):delete e.checkBox}function Q(n,t,i,o,u){var e,i,n,i,t,r,e;(h(i.showImage)?x:i).showImage&&(i=i.images,n=n.zoom(),i)&&i.length?(i=t>i.length-1?i[i.length-1]:i[t],t=o.value+p*n,u.images={image:i,x:t,y:r=0,width:g*n,height:w*n},o.value+=2*p*n+g*n):delete u.images}function V(n,t,i){var o,u,e,r,s,s,s,o=n.outlineColumn.options(),u=o&&o.columnIndex;h(u)||(e={value:0},r=0,(s=n.getActualStyle(t,u))&&s.textIndent&&(r=s.textIndent),0!==t&&3<=r-(s=n.rowOutlines.getLevel(t-1))&&(r=s+2),e.value+=8*r,s=e.value,W(n.rowOutlines,t,r),X(n,t,o,u,r,e,i),q(n,t,o,u,e,i),Q(n,r,o,e,i),n.outlineColumn.Tme=e.value-s,i.cellContent={left:e.value,x:e.value,y:0,width:-e.value,height:0})}function M(n){var i=this;i.Mf=n,i.NB=v(x,function(n,t){i.$Dr(n,t)}),i.Upt=0}function N(n){var t=this;t.Mf=n,t.vst={}}function Z(n,t){var i,o,u,e,r,s,c;function l(n,t){var i;return x[n]===t}if(i=n.NB,o=n.mst.vst,!h(i)){if(u={},f(x,function(n){e=i[n],h(e)||l(n,e)||(u[n]=e)}),r={},i.showCheckBox)for(s in o)o.hasOwnProperty(s)&&(c=o[s].checkBox.checkStatus)&&(r[s]={checked:c});a(r)||(u.data=r),t.outlineColumnOptions=u}}function $(n,t){var i,o,u;if(t){if(o=void 0,i=t.data){for(u in o={},t)"data"!==u&&(o[u]=t[u]);n.Hpt(i)}n.options(h(o)?t:o),n.refresh()}}Object.defineProperty(n,"__esModule",{value:!0}),n.OutlineColumn=void 0,c=t("Core"),i=t("Common"),o=t("./dist/plugins/outlineColumn/outlineColumn-actions.js"),s=t("Outlines"),t=t("./dist/plugins/outlineColumn/outlineColumn.ns.js"),u=i.Common.Uf,e=u.tR,l=i.Common.J8,r=i.Common.X8,f=c.GC$.each,a=c.GC$.isEmptyObject,h=i.Common.lt.ht,v=c.util.b0,m=5,d=C=6,p=3,I=O=w=g=16,y=void 0,_="number",b=null,u=new i.Common.ResourceManager(t.SR,"OutlineColumn"),j=u.getResource.bind(u),x={columnIndex:y,showCheckBox:!1,showImage:!1,images:y,showIndicator:!0,expandIndicator:y,collapseIndicator:y,maxLevel:10},M.prototype.L0=function(){var n=this;n.Mf=b,n.mst=b,n.NB=b},M.prototype.$Dr=function(n,t,i){var o=this.Mf;o&&o.$Dr({type:"setOutlineColumnOptions",propName:n,value:t,options:i})},M.prototype.a7=function(n,t){return this.NB&&this.NB.columnIndex===t?this.mst.vst[n].cellContent.left:null},M.prototype.K_r=function(n){var t,i,t=this.NB;for(i in x)x.hasOwnProperty(i)&&n[i]!==t[i]&&(t[i]=n[i])},M.prototype.options=function(n){var t,i,i,o,u,t,o=this,u=o.NB;return e(arguments)?(null!=(i=null==(t=null==(t=o.Mf)?void 0:t.parent)?void 0:t.suspendOp)&&i.call(t),o.K_r(n),null!=(i=null==t?void 0:t.resumeOp)&&i.call(t),o.$Dr(b,b,n),o.refresh(),o):u},M.prototype.refresh=function(){var n=this.Mf;h(this.NB)||h(this.NB.columnIndex)||0===this.Upt&&(n.suspendPaint(),n.outlineColumn.mst.updateModel(),n.resumePaint())},M.prototype.setCheckStatus=function(n,t){var i=this.NB.columnIndex;h(i)||z(this.Mf,n,i,t)},M.prototype.dst=function(n){this.Mf.outlineColumn.mst.setAllItemCheckStatus(n),this.refresh()},M.prototype.getCheckStatus=function(n){var t,i;if(e(arguments))return this.Mf.outlineColumn.mst.getCheckStatus(n);for(t=[],i=this.Mf.getRowCount(),n=0;n<i;n++)t[n]=this.Mf.outlineColumn.mst.getCheckStatus(n);return t},M.prototype.setCollapsed=function(n,t){F(this.Mf,n,!1,t)},M.prototype.getCollapsed=function(n){var t,i;if(e(arguments))return this.Mf.outlineColumn.mst.getCollapsed(n);for(t=[],i=this.Mf.getRowCount(),n=0;n<i;n++)t[n]=this.Mf.outlineColumn.mst.getCollapsed(n);return t},M.prototype.reset=function(){var n;h(this.NB)||h(this.NB.columnIndex)||(n=this.Mf,this.K_r(x),n.suspendPaint(),n.outlineColumn.mst.updateModel(),n.resumePaint())},M.prototype.Un=function(n){return this.NB&&this.NB.columnIndex===n},M.prototype.xB=function(){return this.NB&&!h(this.NB.columnIndex)},M.prototype.Xst=function(){this.Upt++},M.prototype.$st=function(){0<this.Upt&&this.Upt--,0===this.Upt&&this.refresh()},M.prototype.zpt=function(n,t){this.Mf.outlineColumn.mst.insertRows(n,t)},M.prototype.yE=function(n,t){this.Mf.outlineColumn.mst.deleteRows(n,t)},M.prototype.Fpt=function(){return x},M.prototype.Vpt=function(){return{TRIANGLE_HEIGHT:m,TRIANGLE_BASE:C,CHECKBOX_RADIUS:d,GAP:p,IMAGE_WIDTH:g,IMAGE_HEIGHT:w,INDICATOR_IMAGE_WIDTH:O,INDICATOR_IMAGE_HEIGHT:I}},M.prototype.Hpt=function(n){var t,i,o,t=this;for(i in n)n.hasOwnProperty(i)&&((o=t.mst.vst[i]=t.mst.vst[i]||{}).checkBox={checkStatus:n[i].checked})},M.prototype.ect=function(n,t){var i=this.NB.columnIndex;h(i)||(0,o.setCheckStatus)(this.Mf,n,i,t)},M.prototype.ost=function(){return this.mst.vst},k=M,n.OutlineColumn=k,N.prototype.L0=function(){this.Mf=b},N.prototype.$Dr=function(n){var t=this.Mf;t&&t.$Dr({type:"setOutlineColumnOptions",propName:"data",value:n})},N.prototype.updateIndicatorCollapsed=function(n,t){var i=this;h(i.vst[n])||h(i.vst[n].indicator)||(i.vst[n].indicator.collapsed=t)},N.prototype.updateCheckStatus=function(n,t,i){var o,u,e;void 0===i&&(i=!0),(o=this).Ppt(n),h(o.vst[n])||((u=o.vst[n].checkBox)&&(e=u.checkStatus,(u.checkStatus=t)!==e)&&i&&o.$Dr({row:n,checkStatus:t}),o.Ppt(n,!0))},N.prototype.setAllItemCheckStatus=function(n,t){var i,o,u,e,r;for(e in void 0===t&&(t=!0),u=!1,o=(i=this).vst)o.hasOwnProperty(e)&&((r=o[e].checkBox)&&(r.checkStatus=n),u=!0);t&&u&&i.$Dr({checkStatus:n})},N.prototype.getCheckStatus=function(n){var t=this;return h(t.vst[n])||h(t.vst[n].checkBox)?null:t.vst[n].checkBox.checkStatus},N.prototype.getCollapsed=function(n){var t=this;return!h(t.vst[n])&&!h(t.vst[n].indicator)&&t.vst[n].indicator.collapsed},N.prototype.CRe=function(n){var t=this,i=t.Mf;t.vst[n]=t.vst[n]||{},V(i,n,t.vst[n])},N.prototype.updateModel=function(){var n,t,i,o,u,e,u,r,n=this,t=n.Mf,i=t.getRowCount();for(t.rowOutlines.direction(0),o=0;o<i;o++)n.CRe(o);u=t.outlineColumn.options(),(e=(h(u.showCheckBox)?x:u).showCheckBox)&&Y(t),(u=t.NMi)&&u.options.allowAddNew&&delete n.vst[r=i-1]},N.prototype.insertRows=function(n,t){var i=this;i.Ypt(n,t),i.Zpt(n,t)},N.prototype.Ypt=function(n,t){var i,o,o,u,e,i=this.Mf,o=i.outlineColumn.options();h(o)||(o=o.columnIndex,h(o))||(e=0,(u=i.getActualStyle(n-1,o))&&u.textIndent&&(e=u.textIndent),i.getRange(n,o,t,1).textIndent(e))},N.prototype.Zpt=function(n,t,i){var o,u,e,e,r,e,s;if(void 0===i&&(i=!0),r=(e=(e=(u=(o=this).vst)[n-1])&&e.checkBox)&&e.checkStatus,e=o.Mf.getRowCount(),l(u,e,n,t),!c.GC$.isEmptyObject(u)&&i){for(s=0;s<t;s++)u[n+s]={checkBox:{checkStatus:r}};o.$Dr({row:n,count:t,checkStatus:r})}},N.prototype.deleteRows=function(n,t){this.Wpt(n,t)},N.prototype.Wpt=function(n,t){var i,o,i,i=this,o=i.vst,i=i.Mf.getRowCount();r(o,i,n-1,t)},N.prototype.Qpt=function(n,t){var i,i,i=this.vst[t];i&&!n[t]&&(i=i.checkBox,n[t]={checked:i&&i.checkStatus})},N.prototype.Kpt=function(n){var t,i,o,t=this,i=this.vst;for(o in i)i.hasOwnProperty(o)&&t.Qpt(n,o)},N.prototype.Jpt=function(n){var t,i,t=this.vst;for(i in n)h(n[i].checked)||(t[i].checkBox.checkStatus=n[i].checked)},N.prototype.Xpt=function(n){var t=this.Mf.Ut.G8;return t?(t.outlineColumnChanges||(t.outlineColumnChanges={items:{}}),t.currentOutlineColumnChanges||(t.currentOutlineColumnChanges={items:{}}),n?t.currentOutlineColumnChanges:t.outlineColumnChanges):y},N.prototype.Ppt=function(n,t){var i=this,t=i.Xpt(t);t&&!t.all&&(h(n)?(t.all=!0,i.Kpt(t.items)):i.Qpt(t.items,n))},N.prototype.qpt=function(n){this.Jpt(n.items)},G=N,c.GC$.extend(c.Y8.prototype,{qpt:function(n){var t=this,i=t.$pt,o=i.mst;i.xB()&&(o.updateModel(),n&&o.qpt(n),t.Mf.zw())}}),c.Y8.ch("outlineColumn",{init:function(){var n=this,t=n.Mf;n.$pt=new k(t),n.$pt.mst=new G(t)},applyChanges:function(n){var t,n,i,i,t=n.changes,n=n.isUndo;t&&((i=t.outlineColumnOption)&&this.$pt.options(n?i.oldValue:i.value),i=n?t.outlineColumnChanges:t.currentOutlineColumnChanges)&&this.qpt(i)},undo:function(n){var t=n.outlineColumnChanges;t&&!n.oldOptions&&this.qpt(t)},dispose:function(n){var t=this,i;!1!==(n&&n.clearCache)&&t.$pt&&(t.$pt.mst&&(t.$pt.mst.L0(),t.$pt.mst=b),t.$pt.L0(),t.$pt=b)}}),c.Worksheet.ch("outlineColumn",D={init:function(){var n=this;n.outlineColumn=n.Ut.$pt},dispose:function(n){var n,t;!1!==n.clearCache&&(t=(n=this).outlineColumn)&&(t.L0(),n.outlineColumn=b)},toJson:function(n){Z(this.outlineColumn,n)},fromJson:function(n){$(this.outlineColumn,n.outlineColumnOptions)},wh:function(n){n.lossless||(n.lossless={}),Z(this.outlineColumn,n.lossless)},yh:function(n){$(this.outlineColumn,n&&n.lossless&&n.lossless.outlineColumnOptions)},onLayoutChanged:function(n){var t,i,o,u,e,n,n,t=this,i=t.outlineColumn,o=n.changeType,u=n.row,e=n.rowCount,n=n.sheetArea,n=h(n)||3===n;"addRows"===o&&n?(i.mst.Ppt(),i.zpt(u,e),i.mst.Ppt(null,!0),i.refresh()):"deleteRows"===o&&n?(i.mst.Ppt(),i.yE(u,e),i.mst.Ppt(null,!0),i.refresh()):"zoomSheet"===o?i.refresh():"invalidateLayout"===o&&K(t)},onLayoutChangedFromOp:function(n){var t,i,o,u,e,n,n,t=this,i=t.outlineColumn,o=n.changeType,u=n.row,e=n.rowCount,n=n.sheetArea,n=h(n)||3===n;"addRows"===o&&n?i.mst.Zpt(u,e,!1):"deleteRows"===o&&n?(i.yE(u,e),i.refresh()):"zoomSheet"===o?i.refresh():"updateCollapsed"===o&&K(t)},sortRangeChanged:function(n){for(var t,i,o,u,t=this.outlineColumn,i=n.column,o=n.columnCount,u=i;t.Un(u)&&u<=i+o;)t.refresh(),u+=1}}),c.CellTypes.Base.ch("outlineColumn",B={paintCellPadding:function(n){var t,i,o,u,e,r,n,s,s,t=n.options.rect,i=n.options.context.sheet,o=n.options.context,u=o.row,e=o.col,r=o.sheetArea,n=n.ctx;o.dataRange&&(s=o.dataRange.convertContext({sheet:i,row:u,col:e,sheetArea:r}))&&(i=s.sheet,u=s.row,e=s.col,r=s.sheetArea),S(i,e)&&0<t.width&&0<t.height&&(r!==c.SheetArea.colHeader||!i.NMi)&&(s=i.outlineColumn.mst.vst[u])&&(n.save(),s.indicator&&U(n,s.indicator,t,o.imageLoader),s.checkBox&&P(n,s.checkBox,t),s.images&&A(n,s.images.image,s.images,t,o.imageLoader),n.restore(),s.cellContent)&&(t.x+=s.cellContent.left,t.width-=s.cellContent.left)},getCellPaddingRect:function(n){var t,i,n,o,u,n,t=n.options.rect,i=n.options.context.sheet,n=n.options.context,o=n.row,u;S(i,n.col)&&0<t.width&&0<t.height&&(n=i.outlineColumn.mst.vst[o])&&n.cellContent&&(t.x+=n.cellContent.left,t.width-=n.cellContent.left)},getCellPaddingHitInfo:function(n){var t,i,o,u,e,r,s,c,t,e,t,l,e,f,t=n.context,i=t.sheet,o=t.col,u=t.row,e=t.sheetArea,r=n.x,s=n.y,c=n.cellRect;if(t.dataRange&&(t=t.dataRange.convertContext({sheet:i,row:u,col:o,sheetArea:e}))&&(i=t.sheet,u=t.row,o=t.col),e=i.outlineColumn,n.paddingHitInfo=null,e&&e.NB){for(t=e.mst.vst[u],l=e.NB.columnIndex,c=c.clone();l<o;)c.x-=i.getColumnWidth(--o);t&&o===l&&(f=e=void 0,t.indicator&&(e=t.indicator.x,(f=t.indicator.x+c.x)<=r)&&r<f+t.indicator.width&&(n.paddingHitInfo={x:r,y:s,row:u,col:o,outlineColumnHitInfo:{indicator:!0}}),t.checkBox&&(e=e||t.checkBox.x,(f=t.checkBox.x+c.x)<=r)&&r<f+t.checkBox.width&&(n.paddingHitInfo={x:r,y:s,row:u,col:o,outlineColumnHitInfo:{checkBox:!0}}),t.images&&(e=e||t.images.x,(f=t.images.x+c.x)<=r)&&r<f+t.images.width&&(n.paddingHitInfo={x:r,y:s,row:u,col:o,outlineColumnHitInfo:{image:!0}}),e)&&r>=c.x&&r<c.x+e&&(n.paddingHitInfo={x:r,y:s,row:u,col:o,outlineColumnHitInfo:{blank:!0}})}},processMouseDownOnCellPadding:function(n){var t,i,o,n,u,t=n.sheet,i=n.row,o=n.col,n=n.outlineColumnHitInfo;h(n)||(c.Worksheet.et(t,"preProcessOutlineColumnMouseDown",u={r:b}),u.r)||(n.indicator?F(t,i,!0):n.checkBox?z(t,i,o):n.image||n.blank)},getOutlineColumnOffset:function(n){var t,i,t,t=n.context.sheet,i;S(t,n.context.col)&&(R(t=t.outlineColumn.options(),"showIndicator")&&(n.value+=p,L(t)?n.value+=O:n.value+=m,n.value+=p),R(t,"showCheckBox")&&(n.value+=p,n.value+=2*d,n.value+=p),R(t,"showImage"))&&(n.value+=p,n.value+=g,n.value+=p)}}),c.Workbook.ch("outlineColumn",J={init:function(){o.commands.Gpt(this.commandManager())},onCultureChanged:function(){j()}})},"./dist/plugins/outlineColumn/outlineColumn.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var i=i("./dist/plugins/outlineColumn/outlineColumn.res.en.js");t.SR={en:i}},"./dist/plugins/outlineColumn/outlineColumn.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_GROUP_PROTECTED=void 0,t.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},Outlines:function(n){n.exports=GC.Spread.Sheets.Outlines}},o={},n=u("./dist/plugins/outlineColumn/outlineColumn.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).OutlineColumn=n}();