/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){var n,e,t;function s(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,s)),i.exports}n={"./dist/plugins/celltype/actionUtils.js":function(t,i){"use strict";function n(t,i){t&&t.suspendCalcService(i)}function e(t,i){t&&t.resumeCalcService(i)}function s(t,i){var n,t,n=t._f(i);return n||(t=t.Ofe(i))&&(n=t.Mf),n}function r(t,i){if(t.sheets){var i=s(t,i.sheetName);if(i)return i}return t}function o(t,i,n,e){var t,i,t=r(t,n),i=new i(t,n,e);return e?i.undo(t):i.execute(t)}function u(t,i){t.suspendPaint(),i||t.suspendEvent()}function c(t,i){i||t.resumeEvent(),t.resumePaint()}Object.defineProperty(i,"__esModule",{value:!0}),i.afterAction=i.beforeAction=i.executeCommand=i.getWorksheet=i.resumeCalcService=i.suspendCalcService=void 0,i.suspendCalcService=n,i.resumeCalcService=e,i.getWorksheet=r,i.executeCommand=o,i.beforeAction=u,i.afterAction=c},"./dist/plugins/celltype/addrowcolumnbuttoncelltype.js":function(t,i,n){"use strict";var e,s,r,o,n,s,u,c,a,l,M,h,g;function I(t){return o(t)||"string"==typeof t&&""===t.trim()}function f(t){var i,t=t.sheet.Dg();return t&&(t.style.cursor="pointer"),!0}function N(t){var t=t.sheet;return t.isEditing()&&t.endEdit(),!0}function d(t,i){var n,i,e,i,s,s,e,n=t.sheet;return!o(n)&&(e=(i=i(n)).cmd,i=i.selection,!I(e))&&(r.CellTypes.Base.et(n,"beforeAddRowOrColumnByCellType",s={r:null}),s.r?void 0:(s=n.rt,n.Qy().execute({cmd:e,sheetName:n.name(),selections:[i],hitInfo:{x:t.x,y:t.y,row:t.row,col:t.col,cellRect:t.cellRect,sheetArea:t.sheetArea,cellStyle:t.cellStyle}}),(e=n.hitTest((s.fk||t).x,(s.fk||t).y))&&(s.cw(e),s.fw(e)),!0))}function D(){var t=null!==h&&h.apply(this,arguments)||this;return t.typeName="96",t.Y_e="add-column-button",t}function v(){var t=null!==g&&g.apply(this,arguments)||this;return t.typeName="97",t.Y_e="add-row-button",t}e=this&&this.__extends||(M=function(t,i){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}M(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.AddRowButton=i.AddColumnButton=void 0,s=n("Common"),r=n("Core"),o=s.Common.lt.ht,n=r.CellTypes.ti,s=r.CellTypes.ColumnHeader,u=r.CellTypes.RowHeader,e(D,h=s),D.prototype.getHitInfo=function(t,i,n,e,s){return{x:t,y:i,row:s.row,col:s.col,sheet:s.sheet,cellRect:e,sheetArea:s.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:1}}},D.prototype.processMouseMove=f,D.prototype.processMouseDown=N,D.prototype.processMouseUp=function(t){return d(t,function(t){return{cmd:t.uEe(),selection:{row:-1,rowCount:t.getRowCount(),col:t.getColumnCount(),colCount:1}}})},c=D,i.AddColumnButton=c,n[96]=c,e(v,g=u),v.prototype.getHitInfo=function(t,i,n,e,s){return{x:t,y:i,row:s.row,col:s.col,sheet:s.sheet,cellRect:e,sheetArea:s.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:2}}},v.prototype.processMouseMove=f,v.prototype.processMouseDown=N,v.prototype.processMouseUp=function(t){return d(t,function(t){return{cmd:t.aEe(),selection:{row:t.getRowCount(),rowCount:1,col:-1,colCount:t.getColumnCount()}}})},a=v,i.AddRowButton=a,n[97]=a,r.Worksheet.ch(l="addRowColumnButton",{init:function(){var t=this;t.cEe=new c,t.fEe=new a}})},"./dist/plugins/celltype/buttoncelltype.js":function(t,i,n){"use strict";var e,s,d,u,c,l,r,a,D,n,s,o,M,h,g,I,v,w,f,N,j,b,y;function T(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,g,h,e),s=t.getValueForKey(i,n,I,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,I,h,e))}function A(){var t,n,t=y.call(this)||this;return t.typeName="6",n=t,o(N,function(t,i){n["_"+t]=i}),t}e=this&&this.__extends||(b=function(t,i){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}b(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Button=void 0,s=n("Common"),d=n("Core"),u=n("./dist/plugins/celltype/cellbuttons.js"),c=d.Events.SelectionChanged,l=s.Common.lt.ht,r=d.mt.vi,a=d.CellTypes.Context,D=d.CellTypes.Text,n=d.CellTypes.Base,s=d.GC$,o=s.each,h=void 0,g="_isFirstMouseUp",I="_mouseupToken",v="#707070",w="#34B4E3",f=".buttonCellType",N={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:M=null,buttonClickColor:M,buttonState:0},e(A,y=n),A.prototype.paintValue=function(t,i,n,e,s,r,o,u){var c,a,l,M,h,g,I,f,a,l,a,N;t&&(a=(c=this)._marginLeft,l=c._marginTop,M=n+a,h=e+l,g=s-a-c._marginRight,I=r-l-c._marginBottom,0<g-2)&&0<I-2&&(f=n<M+g&&M<n+s&&e<h+I&&h<e+r)&&(t.save(),(M<n||n+s<M+g||h<e||e+r<h+I)&&(t.rect(n,e,s,r),t.clip()),t.beginPath(),t.strokeStyle!==(a=v)&&(t.strokeStyle=a),t.strokeRect(M+.5,h+.5,g-1,I-1),l=void 0,a=c._buttonState,N=c._text,l=2===a?c._buttonClickColor||w:(l=c._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==l&&(t.fillStyle=l),d.W.setFillStyle(t,l,n,e,s,r,function(){t.fillRect(M+1,h+1,g-2,I-2)}),t.restore(),N)&&D.prototype.paintValue.call(c,t,N,M,h,g,I,o,u)},A.prototype.getText=function(t,i){return t},A.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},A.prototype.getHitInfo=function(t,i,n,e,s){var r,o,u,c,a,r,e,r=this;return s&&(o=s.sheetArea,l(o)||3===o)&&e?(u=e.x+r._marginLeft,c=e.x+e.width-r._marginRight,a=e.y+r._marginTop,r=e.y+e.height-r._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:o,sheet:s.sheet,cellStyle:n},u<=t&&t<=c&&a<=i&&i<=r&&(e.isReservedLocation=!0),e):M},A.prototype.processMouseDown=function(t){var i,n,i=this,n=t&&t.sheet;return!(!n||!t.isReservedLocation||i.pG||(i.pG=!0,i._buttonState=2,(0,u.G_e)(n,t.cellRect),0))},A.prototype.processMouseUp=function(t){var i,n,e,s,r,o,t,i=this,n=t&&t.sheet;if(i.pG&&n&&t.isReservedLocation){if((i._buttonState=0,u.G_e)(n,t.cellRect),i.pG=!1,e=t.row,s=t.col,r=t.sheetArea,!(o=n.Ut.getValueForKey(e,s,g,r)))return i.j3(n,e,s,r),n.Ut.do("setValueForKey",e,s,g,!0,r),t=setTimeout(function(){T(n,e,s,r)},250),n.Ut.do("setValueForKey",e,s,I,t,r),!0;T(n,e,s,r)}return!1},A.prototype.processMouseLeave=function(t){var i,n,i=this,n=t&&t.sheet;n&&i.pG&&((i._buttonState=0,u.G_e)(n,t.cellRect),i.pG=!1)},A.prototype.processKeyDown=function(t,i){var n,e,s,n=i.sheet,e=this;return!(!n||e.bG)&&(s=n.getCellRect(i.row,i.col),e._buttonState=2,n.repaint(s),n.D3(c+f,function(){n._3(c+f),e.bG=!1,e._buttonState=0,n.repaint(s)}),e.bG=!0)},A.prototype.processKeyUp=function(t,i){var n,e,s,r,o,n=i.sheet,e=this;return!(!n||!e.bG||(s=i.row,r=i.col,o=n.getCellRect(s,r),e._buttonState=0,n.repaint(o),n._3(c+f),e.j3(n,s,r,i.sheetArea),e.bG=!1))},A.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},A.prototype.getAutoFitWidth=function(t,i,n,e,s){var r,o,r=this,o;return a.Bt(t,r._text,n,e,s)+r._marginLeft+r._marginRight},A.prototype.getAutoFitHeight=function(t,i,n,e,s){var r,o,r=this,o;return a.tn(t,r._text,n,e,s)+r._marginTop+r._marginBottom},A.prototype.QD=function(t){this.isReservedKey(t)&&r(t)},A.prototype.isImeAware=function(t){return!1},A.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return o(N,function(t,i){"buttonState"!==t&&(s=n["_"+t])!==i&&(e[t]=s)}),e},A.prototype.fromJSON=function(n){var e=this;o(N,function(t){var i=n[t];l(i)||(e["_"+t]=i)})},A.prototype.jn=function(t){},A.prototype.Ke=function(){},j=A,i.Button=j,o(N,function(i){j.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),d.CellTypes.ti[6]=j},"./dist/plugins/celltype/cellbuttons.js":function(n,r,t){"use strict";var T,i,t,b,W,y,A,I,o,H,V,J,F,X,N,d,h,_,C,g,K,z,q,p,$,s,D,v,w,j,m,x,L,O,c,f,a,S,i,l,k,e,t;function tt(t){switch(t){case m:return T.ButtonPosition.left;case x:return T.ButtonPosition.right;case L:return T.ButtonPosition.leftOfText;case O:return T.ButtonPosition.rightOfText}}function it(t){switch(t){case T.ButtonPosition.left:return m;case T.ButtonPosition.right:return x;case T.ButtonPosition.leftOfText:return L;case T.ButtonPosition.rightOfText:return O}}function nt(t){for(var i,n,e,i=t.split(" "),e=0;e<i.length;e++)if(0<=i[e].indexOf(s)){n=i[e];break}switch(n){case D:return m;case v:return x;case w:return L;case j:return O}}function et(t){switch(t){case m:return D;case x:return v;case L:return w;case O:return j}}function st(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,N,y,e),s=t.getValueForKey(i,n,d,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,d,y,e))}function rt(t,i,n){var e,s;switch(n){case k.topLeft:return new T.Rect(t.x,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),new T.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topRight:return e=t.width-i.width,e=Math.max(0,e),new T.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleLeft:return s=(t.height-i.height)/2,s=Math.max(0,s),new T.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new T.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleRight:return e=t.width-i.width,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new T.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomLeft:return s=t.height-i.height,s=Math.max(0,s),new T.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new T.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomRight:return e=t.width-i.width,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new T.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height))}}function M(t,i,n){for(var e,s,e=[],s=0;s<t.length;s++)e.push({width:Q(t[s].button,i,n),height:jt(t[s].button,n),isStick:t[s].button.Ltr});return e}function E(t,i,n,e,s,r){for(var o,u,c,a,l,M,h,o=[],u=[],c=0;c<t.length;c++)a=i[t[c].index],b(a)?u.push(t[c]):o.push(a);for(l=ct(o),c=0;c<u.length;c++)M=Q(u[c].button,n,e),(h=!r||l.width+M<=r.width)&&(l.width+=M);return l.height=l.height||(r?r.height:0),l}function ot(t,i,n,e,s,r,o,u,c,a,l,M){var n,h,u,i,o,g,n,a,s,I,f,N,n=Y(i,n,o,u,!0,[t]);if(0<n.length){switch(Z(n,i,o),t){case T.ButtonPosition.left:h=D;break;case T.ButtonPosition.right:h=v;break;case T.ButtonPosition.leftOfText:h=w;break;case T.ButtonPosition.rightOfText:h=j;break;default:return}switch(u=E(n,a,s,e,!0,r),i="0",o=W(),((g=T.mt.Tt).mozilla||1<o)&&(i="1px"),n=u.width,a=u.height,s=it(t),b(c.canvasSizes)&&(c.canvasSizes={}),(I=c.canvasSizes)[s]={width:n,height:a},N=ut(h,n,a,f={width:n+"px",height:a+"px",display:"block",position:"absolute",bottom:i,overflow:"hidden",paddingTop:"0"}),t){case T.ButtonPosition.left:N.style.left="0";break;case T.ButtonPosition.right:N.style.right="0";break;case T.ButtonPosition.leftOfText:N.style.left="0";break;case T.ButtonPosition.rightOfText:N.style.right="0";break;default:return}l.appendChild(N)}}function ut(t,i,n,e){var s,r,s=document.createElement("canvas");for(r in s.className=t+" "+$,e)e.hasOwnProperty(r)&&(s.style[r]=e[r]);return s.width=i,s.height=n,s}function ct(t){var i,n,e,s,r;if(t.length<=0)return new T.Rect(0,0,0,0);for(i=t[0].x,n=t[0].y,e=t[0].x+t[0].width,s=t[0].y+t[0].height,r=1;r<t.length;r++)i=Math.min(i,t[r].x),n=Math.min(n,t[r].y),e=Math.max(e,t[r].x+t[r].width),s=Math.max(s,t[r].y+t[r].height);return new T.Rect(i,n,e-i,s-n)}function U(t,i,n,e,s,r,o,u){var c,o,a,l,M,h,g;if(!b(t))for(b(u[n])&&(u[n]={}),Z(i,e.sheet,e.row),c=t.getContext("2d"),o=E(i,o,s,e,!0),c.setTransform(parseFloat(t.style.width)/o.width,0,0,parseFloat(t.style.height)/o.height,0,0),M=new T.Rect(l=a=0,0,parseFloat(t.style.width),parseFloat(t.style.height)),h=0;h<i.length&&(g=B(c,a,0,Q(i[h].button,s,e),e.sheet.getRowHeight(e.row),i[h].button,s,e,r,u[n],i[h].index,M),!b(g));h++)a+=g.width}function at(n,e,s,r,o,t){var t,i,i,i,i;b(t.eventListeners)&&(t.eventListeners={}),b(t.eventListeners[e])&&(t.eventListeners[e]={}),i=(t=t.eventListeners[e]).mouseDownListener=function(t){var i;At(u({x:t.offsetX,y:t.offsetY,context:s,cellRect:o,cellStyle:r,buttonArea:e},!0),!0,n)},n.addEventListener("mousedown",i),i=t.mouseUpListener=function(t){var i;Ct(u({x:t.offsetX,y:t.offsetY,context:s,cellRect:o,cellStyle:r,buttonArea:e},!0),!0,n)},n.addEventListener("mouseup",i),i=t.mouseMoveListener=function(t){var i;zt(u({x:t.offsetX,y:t.offsetY,context:s,cellRect:o,cellStyle:r,buttonArea:e},!0),!0,n)},n.addEventListener("mousemove",i),i=t.mouseLeaveListener=function(t){var t={x:t.offsetX,y:t.offsetY,context:s,cellRect:o,cellStyle:r,buttonArea:e};t.x<0&&(t.x=0),t.x>=parseFloat(n.style.width)&&(t.x=parseFloat(n.style.width)-1),pt(u(t,!0),!0,n)},n.addEventListener("mouseleave",i)}function lt(t,i,n,e,s,r,o,u,c,a,l,M){var i,h,g,n,I,f,N,d,i=Y(i,n,o,u,!0,[t]);if(0<i.length){switch(g=h=void 0,t){case T.ButtonPosition.left:h=D,g=m;break;case T.ButtonPosition.right:h=v,g=x;break;case T.ButtonPosition.leftOfText:h=w,g=L;break;case T.ButtonPosition.rightOfText:h=j,g=O;break;default:return}if(n=M.querySelector("."+h),!b(n)){switch(I=parseFloat(n.style.width),f=r.options.contentRect,N=r.options.leftExternalRect,d=r.options.rightExternalRect,t){case T.ButtonPosition.left:f.x+=I,f.width-=I;break;case T.ButtonPosition.right:f.width-=I;break;case T.ButtonPosition.leftOfText:N.width+=I;break;case T.ButtonPosition.rightOfText:d.width+=I}U(n,i,g,e,s,c,a,l),at(n,g,e,s,r.options.cellRect,c)}}}function Mt(t,i,n,e,s,r,o){var i,n,u,c,a,l,M,i=Y(i,n,e,s,!0,[t]);if(i&&0<i.length)switch(n=it(t),u=r&&r[n]&&r[n].width||0,c=o.contentContainer,a=o.contentRect,l=o.leftExternalRect,M=o.rightExternalRect,t){case T.ButtonPosition.left:gt(c,"left",u),a.x+=u,a.width-=u;break;case T.ButtonPosition.leftOfText:gt(c,"left",u),l.width+=u;break;case T.ButtonPosition.right:a.width-=u;break;case T.ButtonPosition.rightOfText:M.width+=u}}function ht(t){return+t.replace("px","")||0}function gt(t,i,n){var e=0;t.style[i]&&(e=ht(t.style[i])),t.style[i]="".concat((e+=n)-1,"px")}function It(t,i){b(i.mouseDownListener)||t.removeEventListener("mousedown",i.mouseDownListener),b(i.mouseUpListener)||t.removeEventListener("mouseup",i.mouseUpListener),b(i.mouseMoveListener)||t.removeEventListener("mousemove",i.mouseMoveListener),b(i.mouseLeaveListener)||t.removeEventListener("mouseleave",i.mouseLeaveListener)}function Z(t,i,n){for(var e,s,r,e=i.BO(),s=0;s<t.length;s++)(r=St(t[s].button,n))&&e.addImage(r)}function G(t){var i=t.isPrinting,t=t.printZoomFactor;return i&&"number"==typeof t&&1!==t}function ft(t,i){return 2===i.columnHeaderFitMode&&i.cornerX&&(t.width=i.cornerX-t.x,t.height=t.height-(i.cornerY-t.y)-1,t.y=i.cornerY-1),t}function Nt(t,i,n){switch(n){case T.ButtonPosition.leftOfText:return new T.Rect(t.x,t.y,i.x-t.x,t.height);case T.ButtonPosition.rightOfText:return new T.Rect(i.x+i.width,t.y,t.x+t.width-i.x-i.width,t.height)}}function dt(t,i,n,e,s,r,o){var u,c,a,l,M,h,g,I,f;if(t&&!(i.length<=0)){if(s=xt(s),Z(i,u=r.sheet,r.row),2===r.columnHeaderFitMode&&r.cornerX&&(c=r.cellRect.x+r.cellRect.width-(n.x+n.width),(n=n.clone()).width=r.cornerX-n.x-c,n.height=n.height-(r.cornerY-n.y)-1,n.y=r.cornerY-1),a=Nt(n,e,o?T.ButtonPosition.leftOfText:T.ButtonPosition.rightOfText),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),l=R(u,r.row,r.col,r.sheetArea),M=xt(s),b(l.layout)&&(l.layout={}),o){for(h=a.x+a.width,g=i.length-1;0<=g&&(f=B(t,h-=I=Q(i[g].button,M,r),n.y,Q(i[g].button,M,r),a.height,i[g].button,M,r,l,l.layout,i[g].index,n),!b(f));g--);e.x=h}else{for(h=a.x,g=0;g<i.length&&(f=B(t,h,n.y,Q(i[g].button,M,r),a.height,i[g].button,M,r,l,l.layout,i[g].index,n),!b(f));g++)h+=f.width;e.width=h-e.x}t.restore()}}function Dt(t,i,n,e,s){if(!(t+n<s.x||t>s.x+s.width||i+e<s.y||i>s.y+s.height))return t+n>s.x+s.width&&(n=s.x+s.width-t),i+e>s.y+s.height&&(e=s.y+s.height-i),t<s.x&&(t=s.x),i<s.y&&(i=s.y),new T.Rect(t,i,n,e)}function B(t,i,n,e,s,r,o,u,c,a,l,M){var h,c,h=g;if(c.buttonDownIndex===l?h=K:c.buttonHoverIndex===l&&(h=z),c=Dt(i,n,e,s=o.vAlign===T.VerticalAlign.center?M.height:s,M),!b(c))return vt(t,c.x,c.y,c.width,c.height,r,o,u,h,M),a[l]=new T.Rect(c.x,c.y,c.width,c.height),a[l].offsetX=c.x-M.x,a[l].offsetY=c.y-M.y,u.cornerY&&(a[l].offsetY+=u.cornerY),a[l]}function vt(t,i,n,e,s,r,o,u,c,a){var l,M,h,h,g,g,I,g,f,l,l,c,I,l,f,N,d,D,v,D,i,D,w,n,e,j;t.save(),t.beginPath(),l=r.useButtonStyle,M=G(u),h=u.printZoomFactor,h=M?h:u.sheet.zoom(),i+=g=l?C*h:0,n+=g,e-=2*g,s-=2*g,g=H,I=r.hoverBackColor||F,g&&t.strokeStyle!==g&&(t.strokeStyle=g),l&&t.strokeRect(i+.5,n+.5,e-1,s-1),g=kt(r.enabled,u.row),l?f=!1===r.enabled?r.buttonBackColor||J:c===K?V:c===z||u.visualState===T.VisualState.hover?I:((l=t.createLinearGradient(i+e/2,n,i+e/2,n+s)).addColorStop(.125,"#F6FAFB"),l.addColorStop(1,"#D2DBEB"),r.buttonBackColor||l):(f=r.buttonBackColor||"white",c===z&&(r.enabled||b(r.enabled))&&(f=I)),(l=o.font)&&t.font!==l&&(t.font=l),t.fillStyle!==f&&(t.fillStyle=f),t.rect(i+=1,n+=1,e-=2,s-=2),t.clip(),t.beginPath(),t.fillRect(i,n,e,s),c=new T.Rect(i,n,e,s),I=new T.Rect(i,n,e,s),l=_*h,f=St(r,u.row),r.caption&&f&&(N=(p.Bt(A,r.caption,o,h,u)+2*C)*h,d=bt(r)*h,D=new T.Rect(0,0,N+d+l,s),D=rt(v=new T.Rect(i,n,e,s),D,k.MiddleCenter),r.captionAlign===T.CaptionAlignment.left?(I=new T.Rect(D.x,n,N,s),c=D.x+N+l<i+e-2?new T.Rect(D.x+N+l,n,Math.max(0,d),s):new T.Rect(0,0,0,0)):(c=new T.Rect(D.x,n,Math.min(d,e),s),I=D.x+d+l<i+e-2?new T.Rect(D.x+d+l,n,Math.min(e-2-d-l,N),s):new T.Rect(0,0,0,0))),r.caption&&(i=(p.Bt(A,r.caption,o,h,u)+2*C)*h,D=(p.tn(A,r.caption,o,h,u)+2*C)*h,n=rt(I,w=new T.Rect(0,0,i,D),k.MiddleCenter),e=new q,o=o.clone(),!1===g&&(o.foreColor=X),o.cellButtons=y,o.decoration=y,e.paintValue(t,r.caption,n.x,n.y-(j=M?0:2),n.width,n.height,o,u)),f&&wt(t,r,c.x,c.y,c.width,c.height,f,u,a),t.restore()}function wt(t,i,n,e,s,r,o,u,c){var a,l,a,n,s,r,M,h,u,u,M,e,n,g;t.save(),t.rect(n+2,e+2,s-4,r-4),t.clip(),t.beginPath(),(l=(a=u.sheet).BO()).getState(o)?l.qh(o)&&(a=G(u)?u.printZoomFactor:a.zoom(),n=new T.Rect(n,e,s,r),s=bt(i)-2,r=yt(i)-2,h=rt(n,M=new T.Rect(0,0,s*a,r*a),k.MiddleCenter),i.position!==T.ButtonPosition.leftOfText&&i.position!==T.ButtonPosition.rightOfText||((u=u.textRect)&&(h.y=I(u.y-u.height/2-M.height/2,e+4)),h.y+h.height>n.y+n.height&&(h.y=I(h.y-(h.y+h.height-n.y-n.height),n.y))),M=(u=l.getImage(o)).width,e=u.height,T.mt.Tt.msie&&i.imageType&&(e=i.imageType===T.ButtonImageType.custom?(f[o]||(u.style.position="absolute",u.style.left="-10000px",u.style.top="-100000px",document.body.appendChild(u),f[o]={width:u.width,height:u.height},document.body.removeChild(u)),M=f[o].width,f[o].height):M=12),c&&T.mt.Tt.msie&&h.x+h.width>c.x+c.width?0<(n=c.x+c.width-h.x)&&t.drawImage(u,0,0,n*(g=M/(s*a)),e,h.x,h.y,n,r*a):t.drawImage(u,0,0,M,e,h.x,h.y,s*a,r*a)):l.addImage(o),t.restore()}function Q(t,i,n,e){var s,r,i,o,u,n;return void 0===e&&(e=!0),s=G(n)?n.printZoomFactor:n.sheet.zoom(),r=2*C+3,b(t.width)?(i=p.Bt(A,t.caption,i,s,n),o=t.useButtonStyle,(u=St(t,n.row))&&(i=bt(t)+i,r=(o?r:0)+_),e?(i+r+7)*s:i+r+7):(n=I(1,t.width),isNaN(n)&&(n=1),e?n*s:n)}function jt(t,i,n){var e,s,e,i,t;return void 0===n&&(n=!0),e=i.sheet,s=G(i)?i.printZoomFactor:e.zoom(),e=e.getRowHeight(i.row),i=t.imageSize?t.imageSize.height:A,t=I(1,i||e),isNaN(t)&&(t=1),n?t*s:t}function Y(t,i,n,e,s,r){var o,u,c,a,l,M,o=[];if(!i||0===i.length)return[];for(u=!1,c=t.Ut.getValueForKey(n,e,h),t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===e&&!0!==c&&(u=!0),a=0;a<i.length;a++)if(l=i[a].visible,!s||!i[a].iMe)for(M=0;M<r.length;M++)(i[a].position===r[M]||b(i[a].position)&&r[M]===T.ButtonPosition.right)&&(l&&"function"==typeof l&&l(n)||i[a].visibility===T.ButtonVisibility.onEditing&&s||i[a].visibility!==T.ButtonVisibility.onEditing&&u||i[a].visibility===T.ButtonVisibility.always||b(i[a].visibility))&&o.push({index:a,button:i[a]});return o}function bt(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.width&&(i=o(t.imageSize.width)),"number"==typeof t.imageSize.width)?t.imageSize.width:i)===A||isNaN(i)||i<0?16:i}function yt(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.height&&(i=o(t.imageSize.height)),"number"==typeof t.imageSize.height)?t.imageSize.height:i)===A||isNaN(i)||i<0?16:i}function R(t,i,n,e,s){var r,o,r={isMouseDownReservedLocation:!1};return e===T.SheetArea.corner?r:((o=t.Ut.getValueForKey(i,n,c,e))||s||Tt(t,i,n,e,o=r),o)}function Tt(t,i,n,e,s){t.Ut.setValueForKey(i,n,c,s,e)}function u(t,i){var n,e,s,r,o,u,c,a,a,l,M,h,g,I,f,N,d,D,v,w,j,b,y,a,t,l,t,l;if(void 0===i&&(i=!1),n=t.context.row,e=t.context.col,s=t.cellRect,r=t.cellStyle,o=t.context,c=(u={x:t.x,y:t.y,row:n,col:e,cellRect:s,cellStyle:r,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:o}).sheet,!1!==t.cellStyle.locked&&c.isActualProtected()&&!c.NMi&&(a={row:n,col:e,sheetArea:t.context.sheetArea,isLocked:!0},T.Worksheet.et(c,"getCellActualLockedInfo",a),a.isLocked))return null;if(a=R(c,u.row,u.col,u.sheetArea,!0),l=t.cellStyle.cellButtons,!a||!l||l.length<=0)return null;if(M=a.layout,!(M=i?a.editorLayout[t.buttonArea]:M))return null;for(f in h=-1,g=u.x,I=u.y,M)if(M.hasOwnProperty(f)){if(N=void 0,d=M[f],i)N=new T.Rect(d.x,d.y,d.width,d.height);else{if(D=d.offsetX,c.parent&&!c.parent.options.scrollByPixel&&0<(v=c.frozenColumnCount())&&v<(w=c.getViewportLeftColumn(1))&&(j=c.getSpan(n,e,u.sheetArea))&&j.col<=w&&w<j.col+j.colCount)for(b=w-v,y=0;y<b;y++)D-=c.getColumnWidth(v+y+1,u.sheetArea);N=new T.Rect(s.x+D,s.y+d.offsetY,d.width,d.height)}if(N&&N.contains(g,I)){h=+f;break}}return-1!==h?u.cellButtonHitInfo={hitButtonIndex:h,buttonConfig:l[h],buttonArea:t.buttonArea}:(a=c.getCellType(u.row,u.col))&&(t=E(Y(c,l,n,e,i,[T.ButtonPosition.left]),M,r,o,!1),l=E(Y(c,l,n,e,i,[T.ButtonPosition.right]),M,r,o,!1),t=new T.Rect(s.x+t.width,s.y,s.width-t.width-l.width,s.height),l=a.getHitInfo(u.x,u.y,r,t,o))&&l.isReservedLocation&&(u.isReservedLocation=!0),u}function At(t,i,n){var e,s,r,r,o,u,u,c,a,l,s,c,l,a,i,M,h;return void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(e=t.sheet,r={r:A},T.CellTypes.Base.et(e,"preProcessCellButtonMouseDown",r),!r.r)&&(r=t.row,o=t.col,u=t.sheetArea,r===e.ui&&o===e.ci||u!==T.SheetArea.viewport||e.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(s=t.cellButtonHitInfo.buttonConfig.hasOverLay),u=R(e,r,o,t.sheetArea),t.cellButtonHitInfo&&(a=t.cellButtonHitInfo.hitButtonIndex,c=t.cellButtonHitInfo.buttonConfig),l=kt(c&&c.enabled,t.row),e)&&(!u.isMouseDownReservedLocation||s)&&c&&(l||b(l))&&0<=a&&(u.buttonDownIndex=a,u.isMouseDownReservedLocation=!0,i&&n?(s=t.cellStyle,c=u.layout,l=t.context,a=u.editorLayout,i=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,M=s.cellButtons,i&&U(n,h=Y(e,M,r,o,!0,[tt(i)]),i,l,s,u,c,a)):P(e,t.cellRect),1)}function Ct(t,i,n){var e,s,r,o,u,c,o,o,a,l,M,c,h,g,I,f,n;if(void 0===i&&(i=!1),t&&(e=t&&t.sheet,s=t.row,r=t.col,o={r:A},T.CellTypes.Base.et(e,"preProcessCellButtonMouseUp",o),!o.r)&&(u=R(e,t.row,t.col,t.sheetArea),c=t.cellButtonHitInfo,u.isMouseDownReservedLocation)&&e){if(c&&0<=c.hitButtonIndex&&c.buttonConfig.command&&(o=c.buttonConfig.command,i||e.getActiveRowIndex()===s&&e.getActiveColumnIndex()===r||e.eR(s,r,1,1,2),"string"==typeof o?e.getParent().commandManager().execute({cmd:o,row:s,col:r,sheetName:e.name(),sheetArea:t.sheetArea}):"function"==typeof o&&o.call(A,e,s,r,t.sheetArea)),i&&0<=u.buttonDownIndex&&n&&(u.buttonDownIndex=-1,o=t.cellStyle,a=u.layout,l=t.context,M=u.editorLayout,c=c&&c.buttonArea,h=o.cellButtons,c)&&U(n,g=Y(e,h,s,r,!0,[tt(c)]),c,l,o,u,a,M),u.buttonDownIndex=-1,i||P(e,t.cellRect),u.isMouseDownReservedLocation=!1,I=t.sheetArea,!(f=e.Ut.getValueForKey(s,r,N,I)))return Lt(e,s,r,I),e.Ut.do("setValueForKey",s,r,N,!0,I),n=setTimeout(function(){st(e,s,r,I)},250),void e.Ut.do("setValueForKey",s,r,d,n,I);st(e,s,r,I)}}function zt(t,i,n){var e,s,r,r,i,o,u,c,a,l,M;void 0===i&&(i=!1),t&&(s=R(e=t&&t.sheet,t.row,t.col,t.sheetArea),r=-1,(r=t.cellButtonHitInfo?t.cellButtonHitInfo.hitButtonIndex:r)!==(b(s.buttonHoverIndex)?-1:s.buttonHoverIndex))&&(s.buttonHoverIndex=r,i?(r=t.cellStyle,i=s.layout,o=t.context,u=s.editorLayout,c=r.cellButtons,a=t.row,l=t.col,n&&mt(c,e,a,l,M=n.parentElement,o,r,s,i,u)):P(e,t.cellRect))}function P(t,i){var n,e,s,i,n,n=i.x-(0<i.x?2:0),e=i.y-(0<i.y?2:0),s=i.width+4,i=i.height+4,n=new T.Rect(n,e,s,i);t.repaint(n)}function pt(t,i,n){var e,s,i,r,o,u,c,a,l,M;void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(s=R(e=t&&t.sheet,t.row,t.col,t.sheetArea),i?(s.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(i=t.cellStyle,r=s.layout,o=t.context,u=s.editorLayout,c=i.cellButtons,a=t.row,l=t.col,n)&&mt(c,e,a,l,M=n.parentElement,o,i,s,r,u)):(e&&(s.buttonHoverIndex=-1,s.buttonDownIndex=-1,s.isMouseDownReservedLocation=!1),P(e,t.cellRect)))}function mt(t,i,n,e,s,r,o,u,c,a){for(var l,M,h,g,l=0;l<S.length;l++)M=it(S[l]),U(h=s.querySelector("."+et(M)),g=Y(i,t,n,e,!0,[tt(M)]),M,r,o,u,c,a)}function xt(t){var t=t.clone(!0);return t.hAlign=T.HorizontalAlign.left,t.vAlign=T.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function Lt(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)}function Ot(t,i,n,e,s){var r,o,u,r=t.Il(i,n,s);if(r&&r.cellButtons&&0<r.cellButtons.length&&0<(o=r.cellButtons.filter(function(t){return 1===t.visibility})).length){e&&t.Ut.do("setValueForKey",i,n,h,!0,s);try{u=t.getCellRect(i,n,1===s?-1:void 0,2===s?-1:void 0),t.repaint(u)}finally{e&&t.Ut.do("setValueForKey",i,n,h,y,s)}}}function St(t,i){var n,e,i,s,n=null,e=t.imageType;if(b(t.imageType))return null;switch(s=(i=kt(t.enabled,i))||b(i),e){case T.ButtonImageType.dropdown:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.left:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case T.ButtonImageType.right:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case T.ButtonImageType.clear:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.ok:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.plus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.minus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.redo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.undo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.search:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.separator:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.spinLeft:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case T.ButtonImageType.spinRight:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case T.ButtonImageType.ellipsis:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case T.ButtonImageType.expand:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case T.ButtonImageType.collapse:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case T.ButtonImageType.custom:n=t.imageSrc}return n}function kt(t,i){return"function"==typeof t?t(i):t}Object.defineProperty(r,"__esModule",{value:!0}),r.G_e=void 0,T=t("Core"),i=t("Common"),t=t("./dist/plugins/celltype/celltypes.ns.js"),b=i.Common.lt.ht,W=T.Bf.Zl,y=void 0,A=null,I=Math.max,o=parseInt,H="#707070",V="#34B4E3",J="#e6e6e6",F="lightgray",X="#CACACA",N="_isFirstMouseUp",d="_mouseupToken",h="_leaveCell",g=_=0,K=C=2,z=3,q=T.CellTypes.Base,p=T.CellTypes.Context,$="gc-cell-button-canvas",D=(s="gc-editor-")+"left-cellbuttons",v=s+"right-cellbuttons",w=s+"left-of-text-cellbuttons",j=s+"right-of-text-cellbuttons",m="leftButtonArea",x="rightButtonArea",L="leftOfTextButtonArea",O="rightOfTextButtonArea",c="_cellButtonParam",f={},a=T.GC$,S=[T.ButtonPosition.left,T.ButtonPosition.right,T.ButtonPosition.leftOfText,T.ButtonPosition.rightOfText],i=new i.Common.ResourceManager(t.SR,"CellTypes"),l=i.getResource.bind(i),(t=k=k||{})[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight",T.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var i,n,e,s,r,o,u,c,a,l,o,M,h,g,I,f,N,d,D,i=t.options.context,n=t.options.style;if(!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.options.context.sheet,s=i.row,r=i.col,o=Y(e,n.cellButtons,s,r,!1,[T.ButtonPosition.left,T.ButtonPosition.right]))&&0<o.length&&(u=xt(n),Z(o,e,t.options.context.row),c=t.ctx)){for(a=ft(t.options.rect.clone(),i),c.save(),c.rect(a.x,a.y,a.width,a.height),c.clip(),c.beginPath(),l=a.x,o=a.x+a.width,M=R(e,i.row,i.col,i.sheetArea),b(M.layout)&&(M.layout={}),h=M.layout,g=Y(e,n.cellButtons,s,r,!1,[T.ButtonPosition.left]),I=0;I<g.length&&(f=B(c,l,a.y,Q(g[I].button,u,i),a.height,g[I].button,u,i,M,h,g[I].index,a),!b(f));I++)l+=f.width;for(N=l,l=o,I=(d=Y(e,n.cellButtons,s,r,!1,[T.ButtonPosition.right])).length-1;0<=I&&(f=B(c,l-=D=Q(d[I].button,u,i),a.y,D,a.height,d[I].button,u,i,M,h,d[I].index,a),!b(f));I--);c.restore(),(a=t.options.rect).width=a.x+a.width-(o-l)-N,a.x=N}},beforePaintText:function(t){var i,n,e,s,r,t,i=t.context,n=t.style;!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.context.sheet,s=i.row,r=i.col,(t=t.externals).left=t.left.concat(M(Y(e,n.cellButtons,s,r,!1,[T.ButtonPosition.leftOfText]),n,i)),t.right=t.right.concat(M(Y(e,n.cellButtons,s,r,!1,[T.ButtonPosition.rightOfText]),n,i)))},beforeFillTextArea:function(t){var i,n,e,s,r,e,o,u,c,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,r=t.textRect,dt(e,a=Y(o=(e=t.context).sheet,n,u=e.row,c=e.col,!1,[T.ButtonPosition.leftOfText]),s,r,i,e,!0))},afterFillTextArea:function(t){var i,n,e,s,r,e,o,u,c,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,r=t.textRect,dt(e,a=Y(o=(e=t.context).sheet,n,u=e.row,c=e.col,!1,[T.ButtonPosition.rightOfText]),s,r,i,e,!1))},onCreateCellEditor:function(t){var i,n,e,s,r,o,u,c,a,t,l,M,h,g,I,i=t.options.dom;if(i&&i.children&&(n=i.children[0])&&n.children&&(e=n.children[0])&&(r=(s=t.context).sheet,o=s.row,u=s.col,c=t.options.cellStyle,a=(c=b(c)?r.getActualStyle(o,u):c).cellButtons,!(b(a)||a&&a.length<=0))){for(t=t.options.cellRect,l=new T.Rect(t.x,t.y,t.width,t.height),M=R(r,o,u,s.sheetArea),b(M.layout)&&(M.layout={}),h=M.layout,g=!1,I=0;I<a.length;I++)a[I].position!==T.ButtonPosition.leftOfText&&a[I].position!==T.ButtonPosition.rightOfText||(g=!0);for(g&&(n.style.overflow="hidden"),I=0;I<S.length;I++)ot(S[I],r,a,s,c,l,o,u,M,h,i,n)}},onActivateCellEditor:function(t){var i,n,e,s,r,o,u,c,a,l,M,h,i=t.context,n=i.sheet,e=i.row,s=i.col,r=t.options.cellStyle,o=r.cellButtons;if(!(b(o)||o.length<=0))for(u=R(n,e,s,i.sheetArea),b(u.editorLayout)&&(u.editorLayout={}),c=u.layout,a=u.editorLayout,l=xt(r),M=t.options.dom,h=0;h<S.length;h++)lt(S[h],n,o,i,l,t,e,s,u,c,a,M)},onDeactivateCellEditor:function(t){var i,n,e,s,r,n,o,u,c,a,l,M,h,i=t.context,n=i.sheet,e=i.row,s=i.col,r,n=n.getActualStyle(e,s,i.sheetArea).cellButtons;if(n&&0<n.length)for(u=(o=R(i.sheet,e,s,i.sheetArea,!0))&&o.eventListeners,a=(c=t.options.dom).querySelectorAll("."+$),l=0;l<a.length;l++)h=nt((M=a[l]).className),b(h)||b(u)||b(u[h])||(It(M,u[h]),delete o.eventListeners[h])},onUpdateContainer:function(t){var i,n,e,s,i,r,o,u,i=t.context,n=i.sheet,e=i.row,s=i.col,i=R(i.sheet,e,s,i.sheetArea,!0),r=i&&i.canvasSizes,o=t.cellStyle.cellButtons;if(!(b(o)||o.length<=0))for(t.context.preventOverflow=!o.every(function(t){return t.iMe}),u=0;u<S.length;u++)Mt(S[u],n,o,e,s,r,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=u(t)},processMouseDownOnCellPadding:function(t){At(t)},processMouseUpOnCellPadding:function(t){Ct(t)},processMouseMoveOnCellPadding:function(t){zt(t)},processMouseLeaveOnCellPadding:function(t){pt(t)},getCellButtonAutoHeight:function(e){var s,r,t,o,t,u,s=e.context.sheet,r=e.context.row,t=e.context.col,o=e.cellStyle;o.cellButtons&&0!==o.cellButtons.length&&(t=Y(s,o.cellButtons,r,t,!1,[T.ButtonPosition.left,T.ButtonPosition.right]),u=0,t.forEach(function(t){var i,n,i=p.tn(A,t.button.caption,o,s.zoom(),e.context)-2,n;St(t.button,r)&&(i=I(i,bt(t.button))),u=I(i,u)}),e.value=u+ +C)},getCellButtonAutoWidth:function(i){var t,n,e,s,t,r,t=i.context.sheet,n=i.context.row,e=i.context.col,s=i.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(t=Y(t,s.cellButtons,n,e,!1,[T.ButtonPosition.left,T.ButtonPosition.right,T.ButtonPosition.leftOfText,T.ButtonPosition.rightOfText]),r=0,t.forEach(function(t){r+=Q(t.button,s,i.context,!1)}),i.value=r)}}),r.G_e=P,T.Worksheet.ch(e="cellButtons",{setHost:function(){var n=this;n.bind(T.Events.EnterCell+"."+e,function(t,i){Ot(n,i.row,i.col,!1,i.sheetArea)}),n.bind(T.Events.LeaveCell+"."+e,function(t,i){Ot(n,i.row,i.col,!0,i.sheetArea)}),n.bind(T.Events.TopRowChanged+"."+e,function(t,i){Ot(n,i.row,i.col,!0,i.sheetArea)})},dispose:function(t){var i=this;i.unbind(T.Events.EnterCell+"."+e),i.unbind(T.Events.LeaveCell+"."+e),i.unbind(T.Events.TopRowChanged+"."+e)},processMouseDown:function(t){var i=t.hitInfo.cellTypeHitInfo;i&&i.cellButtonHitInfo&&At(i)&&(t.r=!0)}}),T.Workbook.ch(e,{onCultureChanged:function(){l()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,i,n){"use strict";var e,s,r,o,u,c,a,l,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var s=Object.getOwnPropertyDescriptor(i,n);s&&("get"in s?i.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,s)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),s=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.fur=i.ti=i.EditorType=i.Context=i.Base=void 0,o=(r=n("Core")).CellTypes.Base,u=r.CellTypes.Context,c=r.CellTypes.EditorType,a=r.CellTypes.ti,i.Base=o,i.Context=u,i.EditorType=c,i.ti=a,i.Hi=r.CellTypes.Hi,i.zi=r.CellTypes.zi,Object.defineProperty(i,"Corner",{set:function(t){t!==i.Hi.Corner&&(i.Hi.Corner=t)},get:function(){return i.Hi.Corner}}),Object.defineProperty(i,"ColumnHeader",{set:function(t){t!==i.Hi.ColumnHeader&&(i.Hi.ColumnHeader=t)},get:function(){return i.Hi.ColumnHeader}}),Object.defineProperty(i,"RowHeader",{set:function(t){t!==i.Hi.RowHeader&&(i.Hi.RowHeader=t)},get:function(){return i.Hi.RowHeader}}),Object.defineProperty(i,"Text",{set:function(t){t!==i.zi.Text&&(i.zi.Text=t)},get:function(){return i.zi.Text}}),s(n("./dist/plugins/celltype/checkboxcelltype.js"),i),s(n("./dist/plugins/celltype/buttoncelltype.js"),i),s(n("./dist/plugins/celltype/hyperlinkcelltype.js"),i),s(n("./dist/plugins/celltype/data-binding.js"),i),s(n("./dist/plugins/celltype/comboboxcelltype.js"),i),s(n("./dist/plugins/celltype/addrowcolumnbuttoncelltype.js"),i),n("./dist/plugins/celltype/cellbuttons.js"),s(n("./dist/plugins/celltype/editor/colorpicker.js"),i),s(n("./dist/plugins/celltype/editor/timepicker.js"),i),s(n("./dist/plugins/celltype/editor/calendar.js"),i),s(n("./dist/plugins/celltype/editor/calculator.js"),i),s(n("./dist/plugins/celltype/editor/monthPicker.js"),i),s(n("./dist/plugins/celltype/editor/listControl.js"),i),s(n("./dist/plugins/celltype/dropdown-action.js"),i),s(n("./dist/plugins/celltype/radiochecklistcelltype.js"),i),s(n("./dist/plugins/celltype/celltypes.ns.js"),i),s(n("./dist/plugins/celltype/rangecelltype.js"),i),s(n("./dist/plugins/celltype/dataobjectcelltype.js"),i),s(n("./dist/plugins/celltype/editor/popupControl.js"),i),s(n("./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js"),i),s(n("./dist/plugins/celltype/diagonalCellType/index.js"),i),l=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),Object.defineProperty(i,"fur",{enumerable:!0,get:function(){return l.fur}})},"./dist/plugins/celltype/celltypes.ns.js":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/celltype/celltypes.res.en.js");i.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Calendar_BuiltIn_Yesterday=i.Calendar_BuiltIn_Today=i.Calendar_Today=i.Calendar_FirstYear=i.Calendar_EraName_4=i.Calendar_EraName_3=i.Calendar_EraName_2=i.Calendar_EraName_1=i.Calendar_Time_PM=i.Calendar_Time_AM=i.Calendar_Months_12=i.Calendar_Months_11=i.Calendar_Months_10=i.Calendar_Months_9=i.Calendar_Months_8=i.Calendar_Months_7=i.Calendar_Months_6=i.Calendar_Months_5=i.Calendar_Months_4=i.Calendar_Months_3=i.Calendar_Months_2=i.Calendar_Months_1=i.Calendar_ShortMonths_12=i.Calendar_ShortMonths_11=i.Calendar_ShortMonths_10=i.Calendar_ShortMonths_9=i.Calendar_ShortMonths_8=i.Calendar_ShortMonths_7=i.Calendar_ShortMonths_6=i.Calendar_ShortMonths_5=i.Calendar_ShortMonths_4=i.Calendar_ShortMonths_3=i.Calendar_ShortMonths_2=i.Calendar_ShortMonths_1=i.Calendar_Weeks_7=i.Calendar_Weeks_6=i.Calendar_Weeks_5=i.Calendar_Weeks_4=i.Calendar_Weeks_3=i.Calendar_Weeks_2=i.Calendar_Weeks_1=i.Calendar_ShortWeeks_7=i.Calendar_ShortWeeks_6=i.Calendar_ShortWeeks_5=i.Calendar_ShortWeeks_4=i.Calendar_ShortWeeks_3=i.Calendar_ShortWeeks_2=i.Calendar_ShortWeeks_1=i.Cancel=i.OK=void 0,i.FileUpload_Title=i.DataObject_MeetTable=i.DataObject_MeetSpan=i.DataObject_MeetLock=i.MultiColumn_InvalidDataSource=i.Calculator_OverFlowInfo=i.Calculator_SqrtParameterException=i.Calculator_InvalidInputInfo=i.Calculator_DivideByZeroInfo=i.StandardColor=i.ThemeColor=i.Quarter_Format_4=i.Quarter_Format_3=i.Quarter_Format_2=i.Quarter_Format_1=i.Calendar_NextTenYear=i.Calendar_LastTenYear=i.Calendar_NextYear=i.Calendar_LastYear=i.Calendar_NextMonth=i.Calendar_LastMonth=i.Calendar_BuiltIn_LastMonth=i.Calendar_BuiltIn_ThisMonth=i.Calendar_BuiltIn_Last7Days=void 0,i.OK="OK",i.Cancel="Cancel",i.Calendar_ShortWeeks_1="MON",i.Calendar_ShortWeeks_2="TUE",i.Calendar_ShortWeeks_3="WED",i.Calendar_ShortWeeks_4="THU",i.Calendar_ShortWeeks_5="FRI",i.Calendar_ShortWeeks_6="SAT",i.Calendar_ShortWeeks_7="SUN",i.Calendar_Weeks_1="Monday",i.Calendar_Weeks_2="Tuesday",i.Calendar_Weeks_3="Wednesday",i.Calendar_Weeks_4="Thursday",i.Calendar_Weeks_5="Friday",i.Calendar_Weeks_6="Saturday",i.Calendar_Weeks_7="Sunday",i.Calendar_ShortMonths_1="JAN",i.Calendar_ShortMonths_2="FEB",i.Calendar_ShortMonths_3="MAR",i.Calendar_ShortMonths_4="APR",i.Calendar_ShortMonths_5="MAY",i.Calendar_ShortMonths_6="JUN",i.Calendar_ShortMonths_7="JUL",i.Calendar_ShortMonths_8="AUG",i.Calendar_ShortMonths_9="SEP",i.Calendar_ShortMonths_10="OCT",i.Calendar_ShortMonths_11="NOV",i.Calendar_ShortMonths_12="DEC",i.Calendar_Months_1="JANUARY",i.Calendar_Months_2="FEBRUARY",i.Calendar_Months_3="MARCH",i.Calendar_Months_4="APRIL",i.Calendar_Months_5="MAY",i.Calendar_Months_6="JUNE",i.Calendar_Months_7="JULY",i.Calendar_Months_8="AUGUST",i.Calendar_Months_9="SEPTEMBER",i.Calendar_Months_10="OCTOBER",i.Calendar_Months_11="NOVEMBER",i.Calendar_Months_12="DECEMBER",i.Calendar_Time_AM="AM",i.Calendar_Time_PM="PM",i.Calendar_EraName_1="M",i.Calendar_EraName_2="T",i.Calendar_EraName_3="S",i.Calendar_EraName_4="H",i.Calendar_FirstYear="1",i.Calendar_Today="Today",i.Calendar_BuiltIn_Today="Today",i.Calendar_BuiltIn_Yesterday="Yesterday",i.Calendar_BuiltIn_Last7Days="Last 7 Days",i.Calendar_BuiltIn_ThisMonth="This Month",i.Calendar_BuiltIn_LastMonth="Last Month",i.Calendar_LastMonth="Go to previous month",i.Calendar_NextMonth="Go to next month",i.Calendar_LastYear="Go to previous year",i.Calendar_NextYear="Go to next year",i.Calendar_LastTenYear="Go to previous ten years",i.Calendar_NextTenYear="Go to next ten years",i.Quarter_Format_1="Q1",i.Quarter_Format_2="Q2",i.Quarter_Format_3="Q3",i.Quarter_Format_4="Q4",i.ThemeColor="Theme Colors",i.StandardColor="Standard Colors",i.Calculator_DivideByZeroInfo="Cannot divide by zero.",i.Calculator_InvalidInputInfo="Invalid Input.",i.Calculator_SqrtParameterException="Invalid input for function.",i.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",i.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",i.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",i.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",i.DataObject_MeetTable="Cannot insert data because a table in the way.",i.FileUpload_Title="+ Upload"},"./dist/plugins/celltype/checkboxcelltype.js":function(U,t,i){"use strict";var n,e,T,s,l,v,o,c,i,D,r,w,a,u,M,A,h,g,j,b,y,C,z,I,f,Z,N,G,d,p,m,x,B,L,O,S,k,e,Q;function Y(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,m,u,e),s=t.getValueForKey(i,n,x,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,x,u,e))}function E(){var t,n,t=Q.call(this)||this;return t.typeName="5",t._boxSize=L,t.aQi=!0,n=t,r(O,function(t,i){n["_"+t]=i}),t}function R(t){return 5*t}function P(t,i,n,e,s,r,o,u){var c,a,l,M,h,g,I,n,f,N,d,D,v,w,j,o,b,a,e,y,i,c=5*o,a=i.hAlign,l=n.x,M=n.width,h=0,g=i.vAlign,I=n.y,n=n.height,f=0,N=0,d=1<e.split("\n").length,D=l,v=I,w=M,j=n,o=L*o;return 0===t||1===t?(1===a?h=l+M/2-o/2:w=2===a?(h=l+M-c-o,M-c+2):(D=(h=l+c)-1,M-c+1),j=(a=T.q.un(e,b=w-3-1,i.font)).length*r,d=d||1<a.length,f=o+j,v=0===t?(1===g?(N=I+n/2-f/2+j-3,j+=6):N=2===g?I+n-c-f+j:I+c+j,N-j):(1===g?(N=I+n/2-f/2-3,j+=6):N=2===g?I+n-c-f:I+c,N+o)):(N=1===g?I+n/2-o/2:2===g?I+n-c-o:I+c,i=r/2-(e=A(u.fontInfo.fontSize))/2+(y=8<e?Math.floor((e-8)/5+2):1)-1,d=d||M-o-c-4<s,w=M-o-c,2===g?j=n+i+2-c:0===g&&(j=n-((v=I-(2+i)+c)-I)),2===t?(h=l+M-c-o,w=M-o):D=(h=l+c)+o+1),{multiLine:d,startX:h,startY:N,textX:D,textY:v,textW:w,textH:j}}function W(t,i,n,e,s){var r,i,o,n,u,c,r=5*s,i=i.hAlign,o=n.x-1,n=n.width+1,u=0,c=0;return 0===t||1===t?(c=o+r,1===i?c=o+n/2-L*s/2:2===i&&(c=o+n-r-L*s)):2===t?(u=L*s+e,c=o+r+e,1===i?c=o+n/2-u/2+e:2===i&&(c=o+n-r-u+e)):(u=L*s+e,c=o+r,1===i?c=o+n/2-u/2:2===i&&(c=o+n-r-u)),c-o}function H(t,i,n,e,s){var r,i,o,n,u,c,r=5*s,i=i.vAlign,o=n.y-1,n=n.height+1,u=0,c=0;return 0===t?(u=L*s+e,c=o+r+e,1===i?c=o+n/2-u/2+e:2===i&&(c=o+n-r-u+e)):1===t?(u=L*s+e,c=o+r,1===i?c=o+n/2-u/2:2===i&&(c=o+n-r-u)):(c=o+r,1===i?c=o+n/2-L*s/2:2===i&&(c=o+n-r-L*s)),c-o}function V(t,i,n,e,s){var r,r,r,o,o;t.enable()&&(r=i.getValue(n,e,s),r=t.wG(r),r={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:r,autoFormat:!0},i.dataRanges&&(o=i.dataRanges.getByPosition(n,e))&&(o=o.convertContext({sheet:i,row:n,col:e,sheetArea:s}))&&o.sheet!==i&&(r.sheetName=o.sheet.name(),r.row=o.row,r.col=o.col),i.Qy().execute(r),t.j3(i,n,e,s))}function J(t,i,n,e,s){var r,o;!1!==t.enable()&&(r=s&&s.sheet,o=t.getEditorValue(i,s),t.setEditorValue(i,o,s),t.updateEditor(i,n,e,s),t.j3(r,r.ui,r.ci,s.sheetArea))}n=this&&this.__extends||(k=function(t,i){return(k=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}k(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBox=t.CheckBoxTextAlign=void 0,e=i("Common"),T=i("Core"),s=T.mt.En,l=e.Common.lt.ht,v=T.mt.vt,o=T.mt.vi,c=T.CellTypes.Context,i=T.CellTypes.Base,D=T.GC$,r=D.each,w=T.mt.yt,a=null,u=void 0,M=Math.max,A=parseInt,h="position",g="absolute",j="font",b="left",y="right",C="top",z="alphabetic",I=".gcEditingInput",f="background-color",Z="white",N="green",G="div",d="normal 11pt calibri",p="white-space",m="_isFirstMouseUp",x="_mouseupToken",(e=B=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right",O={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(L=12),boxSize:L},n(E,Q=i),E.prototype.Poe=function(t,i,n,e,s,r,o,u){var c=this,a=A(n.startX),l=A(n.startY),M=A(n.textX),h=A(n.textY),g=A(n.textW),n=A(n.textH);c.Goe(t,a,l,s,r,o),c.paintText(t,i,M,h,g,n,u,e,i,null)},E.prototype.Goe=function(t,i,n,e,s,r){t.save(),t.strokeStyle=this.aQi?"black":"#B3B3B3",t.strokeRect(i+.5,n+.5,2*e+.05,2*e+.05),t.fillStyle=Z,t.fillRect(i+1,n+1,2*e-1,2*e-1),this._isThreeState&&l(r)?(t.beginPath(),t.fillStyle=N,t.rect(i+3*s,n+3*s,2*(e-2.5*s),2*(e-2.5*s)),t.fill()):!0==!!r&&(t.beginPath(),t.lineWidth=2.5*s,t.moveTo(i+3*s,n+e),t.lineTo(i+e,n+2*e-3.5*s),t.lineTo(i+2*e-1.5*s,n+3*s),t.stroke()),t.restore()},E.prototype.paintValue=function(t,i,n,e,s,r,o,u){var c,a,l,M,h,g,I,f,N,N,d,D,d,D,d,s,r,r,s,d,n,r,e,s,c,a,o;t&&(t.save(),t.rect(n,e,s,r),t.clip(),t.beginPath(),c=o.hAlign,a=o.font,l=o.foreColor,h=(M=this)._textAlign,g=M.getText(i,u),f=I=0,(N=u.sheet)&&(I=N.Qt(g,a),f=v(a)),N=N.zoom(),d=u.isPrinting,D=u.printZoomFactor,++n,++e,--s,--r,D=(d=this.CG(f,N=d&&"number"==typeof D&&1!==D?D:N)).radius,d=d.scaleFactor,s=new T.Rect(n,e,s,r),o.wordWrap&&(r=P(h,o,s,g,I,f,N*d,u)).multiLine?M.Poe(t,g,r,u,D,N,i,o):(r=W(h,o,s,I,N*d),s=H(h,o,s,f,N*d),d=A((n+r).toString()),n=A((e+s).toString()),r=b,e=d+1,1===c?(r="center",e+=D):2===c&&(r=y,e+=2*D),a&&t.font!==a&&T.mt.bt(t,a),l&&(t.fillStyle=l),s=o.textDecoration,o=f/2-(c=parseInt(u.fontInfo.fontSize,10))/2+(a=8<c?Math.floor((c-8)/5+2):1)-1,t.textBaseline!==z&&(t.textBaseline=z),2===h?(t.textAlign=y,t.fillText(g,d+1-2,n+D+f/2-o),s&&M.le(t,s,d+1-2,n+D+f/2-o,I,c,a)):0===h&&(t.textAlign=r,t.fillText(g,e,n-2-o),s)&&M.le(t,s,e,n-2-o,I,f),M.Goe(t,d,n,D,N,i),l&&(t.fillStyle=l),3===h?(t.textAlign=b,t.fillText(g,d+1+2*D+2,n+D+f/2-o),s&&M.le(t,s,d+1+2*D+2,n+D+f/2-o,I,c,a)):1===h&&(t.textAlign=r,t.fillText(g,e,n+2*D+2+f-o),s)&&M.le(t,s,e,n+2*D+2+f-o,I,c,a)),t.restore())},E.prototype.CG=function(t,i){var n,e,s,r,n,e=this._boxSize,s=L/2,r=1;return"auto"===e&&(s=t/4,r=t/2/L),"number"==typeof e&&0<e&&(s=i*e/2,r=e/L),{radius:s,scaleFactor:r}},E.prototype.bi=function(t,i,n){var e,i,t,s,r,o,e,i=i.font,t=this.getText(t,n),s=0,r;return n.sheet&&(s=v(i),t)&&(s*=(o=t.split(/\r\n|\r|\n/)).length),s},E.prototype.getText=function(t,i){return this.SG(t)},E.prototype.focus=function(t,i){t&&t.parentNode.focus()},E.prototype.createEditorElement=function(t,i){var n,n,n,i,t,e,e,i,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,n=T.mt.gi(n)+1e3;return D(i).css("z-index",n).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(n=D(i.firstChild)).css("overflow","hidden"),(i=D(s("input"))).attr("type","checkbox"),i.attr("class","gc-checkbox-cell-type-input"),e=(t=this.TG(t))/L,i.css("transform","scale("+e+")"),n.append(i),(e=D(s("span"))).css(h,g).css(j,w(d)).css("cursor","default").css(p,"nowrap").css("word-break","break-all"),n.append(e),(i=D(s(G))).css(h,g).css(f,N).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),n.append(i),a},E.prototype.TG=function(t){var i,n,i,e,i=t.sheet,n=i.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*n:"auto"===this._boxSize?(e="",e=(i=i.Z_(t.row,t.col))&&i.font?i.font:d,n*v(e)/2):L/2},E.prototype.wG=function(t){var t,t=this._isThreeState?!l(t)&&(!0!=!!t||a):!t;return t},E.prototype.setEditorValue=function(t,i,n){var t,e,s,t,r,n,o,u,c,a;t&&this.aQi&&(e=(t=t.parentNode.children)[0],s=t[1],t=t[2],e)&&s&&t&&(r=this,o=(n=n&&n.sheet)&&n.Ai,a=c=void 0,(u=n&&n.Pgr)?(c=!!(a=i),r._isThreeState&&(l(a)?D(t).show():D(t).hide())):(o||(a=r.wG(i)),r._isThreeState?l(a)?(c=!1,D(t).show()):(c=!!a,D(t).hide()):c=!!a),e.checked=c,D(s).text(r.SG(a)))},E.prototype.getEditorValue=function(t,i){if(t){var t=t.parentNode.children,n=t[0],e=t[1],t=t[2];if(n&&e&&t&&(!this._isThreeState||!D(t).isVisible()))return n.checked}return a},E.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},E.prototype.activateEditor=function(i,n,e,s){var t,t,r,t=s&&s.sheet;i&&t&&(t=D(i.parentNode.parentNode),r=this,t.bind("mousedown"+I,function(t){o(t)}),t.bind("mouseup"+I,function(){J(r,i,n,e,s)}),t.bind("keydown"+I,function(t){var i=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===i)return r.AG=!0,o(t),!1;8===i&&o(t)}}),t.bind("keyup"+I,function(t){!r.AG||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(r.AG=!1,J(r,i,n,e,s))}),D(i).bind("click",function(t){o(t)}))},E.prototype.updateEditor=function(t,i,n,e){var s,r,t,o,u,c,o,t,c,a,l,M,h,a,l,r,s,g,a,c,e,I,f,n,l,f,n,u,N,d,M,c,s=e&&e.sheet;t&&s&&(r=s.Dn,u=(o=(t=t.parentNode).children)[0],c=o[1],o=o[2],u)&&c&&o&&(D(t).width(n.width).height(n.height),c=(t=D(c)).text(),a=i.foreColor,l=i.font,M=i.hAlign,h=i.textDecoration,a&&t.css("color",a),a=void 0,a=l||r.Nn(),1<(l=s.zoom())&&(a=r._n(a)),t.css(j,w(a)),r=s.Gi(c,a),s=v(a),c&&(s*=(g=c.split(/\r\n|\r|\n/)).length),f=W(c=(a=this)._textAlign,i,n,r,l*(I=(e=this.TG(e))/L)),n=H(c,i,n,s,l*I),D(u).css("margin-left",f).css("margin-top",n),l=u.offsetLeft,f=u.offsetTop,n=u.offsetWidth,u=u.offsetHeight,(d=N=0)===c?(N=l,1===M?N=l+e/2-r/2:2===M&&(N=l+e-r),d=f-s,N-=(I-1)*L/2,d-=(I-1)*L/2):1===c?(N=l,1===M?N=l+e/2-r/2:2===M&&(N=l+e-r),d=f+u,N-=(I-1)*L/2,d+=(I-1)*L/2):(2===c?(N=l-r-2,d=f+e/2-s/2,N-=(I-1)*L/2):(N=l+n+2,d=f+e/2-s/2,N+=(I-1)*L/2),d-=(I-1)*L/2),t.css(b,N).css(C,d),i.wordWrap?t.css(p,"normal"):t.css(p,"nowrap"),a._isThreeState?(M=l+(n-o.offsetWidth)/2,c=f+(u-o.offsetHeight)/2,D(o).css(b,M).css(C,c).toggle().toggle()):D(o).hide(),h)&&a.Qe(t,h)},E.prototype.SG=function(t){var i=this,n=i._caption;return i._isThreeState&&l(t)?i._textIndeterminate||n:!0==!!t?i._textTrue||n:i._textFalse||n},E.prototype.getHitInfo=function(t,i,n,e,s){if(s&&this.aQi){var r=s.sheetArea;if(l(r)||3===r)return{x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:3,isReservedLocation:!0,sheet:s.sheet,cellStyle:n}}return a},E.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},E.prototype.processMouseUp=function(t){var i,n,e,s,r,o,u,e,i=this,n=t&&t.sheet;if(n&&i.pG&&t.isReservedLocation){if(T.CellTypes.Base.et(n,"beforeEditCheckboxCellType",e={r:a}),e.r)return;if(i.pG=!1,s=t.row,r=t.col,o=t.sheetArea,!(u=n.Ut.getValueForKey(s,r,m,o)))return V(i,n,s,r,o),n.Ut.do("setValueForKey",s,r,m,!0,o),e=setTimeout(function(){Y(n,s,r,o)},250),n.Ut.do("setValueForKey",s,r,x,e,o),!0;Y(n,s,r,o)}return!1},E.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},E.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},E.prototype.processKeyUp=function(t,i){var n,e,n=i.sheet,e={r:a};if(T.CellTypes.Base.et(n,"beforeEditCheckboxCellType",e),!e.r)return V(this,n,i.row,i.col,i.sheetArea),!0},E.prototype.getAutoFitWidth=function(t,i,n,e,s){var r,o,u,t,n,r=this,o=r._textAlign,u=c.Bt(t,r.SG(t),n,e,s),t=r.bi(t,n,s),n=2*r.CG(t,e).radius;return 0===o||1===o?u=M(u,n):u+=n,u+5+2},E.prototype.getAutoFitHeight=function(t,i,n,e,s){var r,o,u,u,t,n,r=this,o=r._textAlign,u=r.SG(t),u=c.tn(u,u,n,e,s),t=r.bi(t,n,s),n=2*r.CG(t,e).radius;return 0===o||1===o?u+=n:u=M(u,n),u+5},E.prototype.QD=function(t){this.isReservedKey(t)&&o(t)},E.prototype.isImeAware=function(t){return!1},E.prototype.Ke=function(){},E.prototype.Je=function(t){var t={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&B[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(t)},E.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return r(O,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},E.prototype.fromJSON=function(n){var e=this;r(O,function(t){var i=n[t];l(i)||(e["_"+t]=i)})},E.prototype.Tfe=function(t){var i,n=this._textAlign;return 2===n||3===n?L*t+5*t:0},E.prototype.enable=function(t){if(!(0<arguments.length))return this.aQi;this.aQi=Boolean(t)},S=E,t.CheckBox=S,r(O,function(i){S.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:("boxSize"===i&&("number"==typeof t&&0<t&&(this["_"+i]=t),"auto"!==t)||(this["_"+i]=t),this)}}),T.CellTypes.ti[5]=S},"./dist/plugins/celltype/comboboxcelltype.js":function(s,t,i){"use strict";var r,G,B,Q,D,Y,l,M,v,R,g,u,h,o,P,W,H,V,I,f,w,N,d,J,j,b,F,X,_,K,c,y,T,q,$,A,C,z,tt,it,a,p,nt,et,st,m,rt,ot,x,ut,L,ct,at,lt,O,Mt,ht,gt,It,ft,Nt,dt,Dt,vt,wt,jt,S,bt,yt,Tt,At,Ct,zt,i,k;function E(t,i){t.appendChild(i)}function pt(t,i){t.removeChild(i)}function U(t){return t&&t.parentNode.parentNode.comboBox}function mt(t,i,n,e){var s=t.cellPadding,r=0,t=t.labelOptions;return(s=n?t?t.margin:"0":s)&&(r=typeof(r=parseInt(Lt(s)[i],10))===X&&0<r?r:0),e===f?r:r*e}function n(t,i,n,e,s,r,o,u,c){var a,i,c,t,n,e,n,t,c,a=this;a.xG=t,a.sfe=i,a.dfe=c,i=t.firstChild,h(t).bind(J,function(t){a.NG(t)}).css([nt,y,T,C,z,"overflow"],[o||0,n,e,s,r,"visible"]).attr([q],["gcComboBox"]),c=w(0,s-17),a._editable=!1,a.DG=t=M(x),a._G=n=M("textarea"),E(i,a.EG=t),xt(t),xt(n),h(n).bind("keyup",function(){var t,i,t=a.EG.value;a._text=t,i=a.jG(t),a.editorValue(i),a.OG(t,!0,i),a.RG()}).bind(j,function(){a.BG()}).bind(b,function(){a.RG()}),h(t).bind(d,function(){a.LG?a.ki(S,{isMouse:!0}):a.PG()}).bind(j,function(){a.BG()}).bind(b,function(){a.RG()}),a.GG(0,0,c,r),E(i,e=a.UG=M(x)),h(e).css([at,_,p,it],[A,K,m,st]).attr(q,"gcDropDownButton").bind(d,function(){var t,i;!v(a.HG)&&(t=a.HG,a.HG=f,(i=(new Date).valueOf())-t<100)||(a.LG?a.ki(S,{isMouse:!0}):a.PG())}),n=M("canvas"),a.fg=n,a.zG(c,0,s-c,r),E(e,n),E(i,t=a.VG=M(x)),a.YG=!1,a.ZG=u||s,h(t).css([_,at,p,nt,tt,et,"cursor",it,z,lt],[K,"1px solid",m,o||0,A,A,"default",st,r,a.ZG+O]),h(t).attr(q,"gcDropDownWindow").attr($,-1),a.WG(0,+r),a.QG=0,E(t,c=a.KG=M(x)),a.JG=new D.x4(t,c),a._itemHeight=22,a.qG=20,a.$G=-1,a._editorValueType=0,a._items=[],a.eU=bt,a.iU=""}function xt(t){h(t).css(["margin","overflow","resize",_,"padding",tt,p,"white-space",it,at],[0,"hidden",A,K,vt+"px 0px 0px "+Dt+O,A,m,"nowrap",st,A]).attr(q,"gcComboBoxEditor").attr($,-1)}function e(){var t,n,t=k.call(this)||this;return t.typeName="7",t.v6=!1,t.rU=!1,n=t,o(Tt,function(t,i){n["_"+t]=i="items"===t?[]:i}),n.jGr=function(t,i){return l.prototype.format.call(n,t,i)},n._dataSource=new Y.DataBindingSource(n.jGr),t}function Lt(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===F&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function Z(t,i){return t.hasOwnProperty(i)}r=this&&this.__extends||(zt=function(t,i){return(zt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}zt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),G=this&&this.__awaiter||function(t,o,n,u){function c(i){return i instanceof n?i:new n(function(t){t(i)})}return new(n=n||Promise)(function(i,n){function e(t){try{r(u.next(t))}catch(t){n(t)}}function s(t){try{r(u.throw(t))}catch(t){n(t)}}function r(t){t.done?i(t.value):c(t.value).then(e,s)}r((u=u.apply(t,o||[])).next())})},B=this&&this.__generator||function(t,n){var e={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s,r,o,u,u={next:i(0),throw:i(1),return:i(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(i){return function(t){return c([i,t])}}function c(i){if(s)throw new TypeError("Generator is already executing.");for(;e=u&&i[u=0]?0:e;)try{if(s=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,(i=o?[2&i[0],o.value]:i)[0]){case 0:case 1:o=i;break;case 4:return e.label++,{value:i[1],done:!1};case 5:e.label++,r=i[1],i=[0];continue;case 7:i=e.ops.pop(),e.trys.pop();continue;default:if(!(o=0<(o=e.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){e=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3]))e.label=i[1];else if(6===i[0]&&e.label<o[1])e.label=o[1],o=i;else{if(!(o&&e.label<o[2])){o[2]&&e.ops.pop(),e.trys.pop();continue}e.label=o[2],e.ops.push(i)}}i=n.call(t,e)}catch(t){i=[6,t],r=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.EditorValueType=void 0,Q=i("Common"),D=i("Core"),Y=i("./dist/plugins/celltype/data-binding.js"),l=D.CellTypes.Base,M=D.mt.En,v=Q.Common.lt.ht,R=Q.Common.ft,g=D.mt,u=g.vi,h=D.GC$,o=h.each,P=g.yt,W=g.Ct,H=g.M0,V=document,I=null,f=void 0,w=Math.max,N=parseInt,d="click",J="keydown",j="mouseover",b="mouseout",F="string",X="number",_="position",K="absolute",c="font",y="left",T="top",q="gcUIElement",$="tabindex",A="none",C="width",z="height",tt="outline",it="box-sizing",a="color",p="background-color",nt="z-index",et="display",st="content-box",m="white",rt="black",ot="title",x="div",ut="span",L="text",ct="value",at="border",lt="min-width",O="px",Mt=g.wt,ht="dataBinding",gt="items",(i=It=t.EditorValueType||(t.EditorValueType={}))[i.text=0]="text",i[i.index=1]="index",i[i.value=2]="value",ft=17,vt=Dt=1,wt=Dt,jt=18,S="EndEdit.gcEditingInput",bt="lightgrey",Tt={editorValueType:dt=0,items:I,itemHeight:22,editable:!(yt="#1E90FF"),maxDropDownItems:Nt=20,allowFloat:!0},n.prototype.getComboBox=function(){return this.xG},n.prototype.dispose=function(){var t=this;h(t.xG).unbind(J),h(t._G).unbind("keyup").unbind(j).unbind(b),h(t.DG).unbind(d).unbind(j).unbind(b),h(t.UG).unbind(d),h(t.KG).find("div").forEach(function(t){h(t).unbind(j).unbind(b).unbind(d)}),t.JG.dispose()},n.prototype.updateLocationAndSize=function(t,i,n,e,s){var r,o,r=this,o=w(0,n-17);r.GG(0,0,o,e),r.zG(o,0,n-o,e),r.WG(0,+e+(s||0))},n.prototype.updateStyle=function(t,i,n){var e=this;n=P(n),t=t||f,h(e.EG).css(p,t).css(a,i).css(c,n),h(e.UG).css(p,t).css(a,i).css(c,n),h(e.VG).css(p,t).css(a,i).css(c,n),e.iU=i,h(e.xG).css(p,"transparent"),e.eU=R.Tv(R._(t),R._(bt))?m:bt},n.prototype.updateImeMode=function(t){h(this.EG).css("ime-mode",t)},n.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},n.prototype.editorValue=function(t){var i,n,i=this;return 0===arguments.length?i.oU:(t!==i.oU&&(i.oU=t,n=i.aU(t),i.text(n),i.OG(n,!0,t)),i)},n.prototype.aU=function(t){var i,n,e,s,r,o,u,c,a,l,e=this,s=e._items,r=s.length,o=e._editorValueType;if(e.uU=!0,1===o)(n=(u=s[t])&&Z(u,L)?u.text:u)===f&&(n=t,e.uU=!1);else if(0===o){for(n=t,a=0;a<r&&!((u=s[a])&&Z(u,L)&&u.text===t||u===t);a++);r<=a&&(e.uU=!1)}else if(2===o){for(l=null==t?void 0:t.toString(),c=0;c<r;c++)if((u=s[c])&&Z(u,ct)&&(null==(i=u.value)?void 0:i.toString())===l){n=u.text;break}r<=c&&(n=t,e.uU=!1)}return n=v(t)?"":n},n.prototype.jG=function(t){var i,n,e,i,s,r,o,u,i=this,n=i._items,e=n.length,i=i._editorValueType,s=t;if(1===i)for(o=0;o<e;o++)((r=n[o])&&Z(r,L)&&r.text===t||r===t)&&(s=o);else if(2===i)for(u=0;u<e;u++)(r=n[u])&&Z(r,L)&&r.text===t?s=r.value:r===t&&(s=f);return s},n.prototype.OG=function(t,i,n){var e,s,r,o,u,c,a,l,s=-1;if(!v(t)&&""!==t)for(o=(r=this._items).length,e=0;e<o;e++)if(a=c=void 0,c=Z(u=r[e],L)?u.text:u,Z(u,ct)&&(a=u.value),(l=i?c:c.toString().substr(0,t.length))===t){if(s=e,v(n))break;if(!v(a)&&a===n)break}this.sU(s)},n.prototype.RG=function(){h(this.EG).removeAttr(ot)},n.prototype.BG=function(){var t,i,n,e,t=this,i=t.Wt(t._text),n=h(t.EG),e;n.width()+Dt<i?n.attr(ot,t._text):n.removeAttr(ot)},n.prototype.GG=function(t,i,n,e){n-=0,e-=0,h(this.EG).css(y,t).css(T,i).css(C,n-Dt).css(z,e-vt)},n.prototype.editable=function(t){var i,n,e,s,r,s,i=this;return 0===arguments.length?i._editable:i._editable!==t?(i._editable=t,n=i.xG.firstChild,e=i.EG,s=h(e),r={left:N(s.css(y)),top:N(s.css(T)),width:N(s.css(C)),height:N(s.css(z))},s={backColor:s.css(p),foreColor:s.css(a),font:e.style.font},pt(n,e),i.EG=t?i._G:i.DG,E(n,i.EG),h(i.EG).css(p,s.backColor).css(a,s.foreColor).css(c,s.font),i.GG(r.left,r.top,r.width,r.height),i):void 0},n.prototype.text=function(t){var i=this,n=i.EG;if(0===arguments.length)return i._text;t!==i._text&&(i._text=t,i._editable?n.value=t:n.textContent=t)},n.prototype.focus=function(){var t=this,i=t.EG;i.focus(),t._editable&&(i.selectionStart=i.value.length)},n.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},n.prototype.zG=function(t,i,n,e){var s,r,s,t,i;n-=0,e-=0,r=(s=this).fg,h(s.UG).css(y,t).css(T,i).css(C,n).css(z,e),h(r).attr(C,n).attr(z,e),s=r.width,t=r.height,(i=r.getContext("2d"))&&(i.beginPath(),i.lineWidth=2,i.fillStyle=rt,i.moveTo(s-17+4,(t-2)/2-2.5),i.lineTo(s-17+7,(t-2)/2+3.5),i.lineTo(s-17+10,(t-2)/2-2.5),i.fill())},n.prototype.showDropDownList=function(){var n=this;n.XIr?n.XIr().then(function(t){var i,t,i,t,i=t.isSuccess,t=t.items;i&&(n.items(t),i=n.oU,t=n.aU(i),n.text(t),n.OG(t,!0,i)),n.$Ir()}):n.$Ir()},n.prototype.$Ir=function(){var i=this,t=i.JG;i.YG=!0,h(i.VG).bind(J,function(t){i.NG(t)}).show(),i.cU=!1,i.fU(),this.adjustPosition(),i.cU&&t.pS(h(i.KG.children).height()),t.w4(!1),i.lU(yt,m),i.hU(i.$G),i.focus()},n.prototype.adjustPosition=function(){var t,i,n,e,s,r,o,u,c,a,l,a,M,M,M,a,t=this,i=h(t.VG);i&&(n=parseInt(i.css("left"),10),e=parseInt(i.css("top"),10),s=i.width(),r=i.height(),isNaN(n)||isNaN(e)||isNaN(s)||isNaN(r)||(u=o=0,!(c=.8)!==this.dfe?(l=(a=V.documentElement).clientWidth,a=a.clientHeight,M=i[0].getBoundingClientRect(),a<r&&(i.css("max-height",Math.round(.8*a)+O),r=Math.round(.8*a)),l<s&&(i.css("max-width",Math.round(.8*l)+O),s=Math.round(.8*l)),M.left+s>l&&(u=M.left+s-l),M.top+r>a&&(o=M.top+r-a)):(a=(M=t.sfe).clientHeight,l=M.clientWidth,a<r&&(r=Math.round(.8*a),i.css("max-height",r+O)),l<s&&(s=Math.round(.8*l),i.css("max-width",s+O)),M=i[0].getBoundingClientRect(),a=t.sfe.getBoundingClientRect(),o=w(0,M.bottom-a.bottom),u=w(0,M.right-a.right)),(n<0||e<0||0<o||0<u)&&((n-=u)<0&&(n-=22),i.css({left:n+O,top:(e-=o+5)+O}))))},n.prototype.shiftPadding=function(t,i){var n=this.xG.firstChild;t===y?h(n).css({left:(+h(n).css(y).replace(O,"")||0)-i}):t===T&&h(n).css({top:(+h(n).css(T).replace(O,"")||0)-i})},n.prototype.closeDropDownList=function(){var t=this;t.YG=!1,h(t.VG).unbind(J).hide(),t.lU("",t.iU),t.focus()},n.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},n.prototype.listHeight=function(t){var i=this,n=h(i.VG);if(0===arguments.length)return n.height();0<t&&(n.height(t),i.JG.w4(!1))},n.prototype.WG=function(t,i){h(this.VG).css(y,t).css(T,i)},n.prototype.items=function(t){var i,n,e,s,r,o,i=this;if(0===arguments.length)return i._items;if(t){for(i._items=t,n=i.KG,e=void 0,h(n).find("div").forEach(function(t){h(t).unbind(j).unbind(b).unbind(d)}),e=n.firstChild;e;)pt(n,e),e=n.firstChild;for(s=i.QG=0,r=t.length;s<r;s++)o=t[s],i.dU(Z(o,L)?o.text:o);return i}},n.prototype.dU=function(t){var i,n,e,i=this,n=M(x),e=M(ut);e.textContent=t.toString(),e.style.padding="0 18px 0 "+wt+O,e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",E(n,e),E(i.KG,n),i.QG++,h(n).bind(d,function(){var t=h(n).index();i.selectedIndex(t),i.closeDropDownList(),i.ki(S,{isMouse:!0})}).bind(j,function(){var t=h(n);n.oldBackColor=t.css(p),t.css(p,i.eU)}).bind(b,function(){h(n).css(p,n.oldBackColor||"")}).css(lt,i.ZG+"px")},n.prototype.vU=function(){var t=this;t.S5=M(ut),h(t.S5).css([et,c],[A,t.VG.style.font]).appendTo(V.body)},n.prototype.mU=function(){pt(V.body,this.S5)},n.prototype.Mt=function(t){return this.S5.textContent=t,h(this.S5).width()+2+wt},n.prototype.lU=function(t,i){var n=this,e=n.$G;0<=e&&e<n.QG&&h(n.KG.children[e]).css([p,a],[t,i])},n.prototype.NG=function(t){var i,n,e,s,r,o,i=this,n=t.keyCode,e=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===e||39===e)&&9!==e&&i.editable()||(s=i.QG,r=i.$G,o=0,38===e||40===e?(0<=(o=0<=r&&r<s?r+(38===e?-1:1):o)&&o<s&&i.selectedIndex(o),i.YG&&i.hU(o),u(t)):13===e||37===e||39===e||9===e?(i.selectedIndex(i.$G),(i.YG||i.editable())&&i.closeDropDownList(),i.ki(S,{keyCode:n,shiftKey:t.shiftKey}),(i.YG||i.editable())&&u(t)):27===e?(i.closeDropDownList(),i.ki(S,{keyCode:n}),u(t)):i.editable()||32!==e||u(t))},n.prototype.getSelectedValue=function(t,i,n){var i,e,i=i[t];return v(i)||(1===n?e=t:0===n?e=Z(i,L)?i.text:i:2===n&&Z(i,ct)&&(e=i.value)),e},n.prototype.sU=function(t){var i=this;i.lU("",i.iU),i.$G=t,i.lU(yt,m),i.hU(t)},n.prototype.selectedIndex=function(t){var i,t,i=this;if(0===arguments.length)return i.$G;0<=t&&t<i.QG&&(i.sU(t),t=i.getSelectedValue(i.$G,i._items,i._editorValueType),v(t)||i.editorValue(t))},n.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;0<t&&(this.qG=t)},n.prototype.allowFloat=function(t){var i=this;if(0===arguments.length)return i.dfe;i.dfe=t},n.prototype.Wt=function(t){this.vU();var t=this.Mt(t);return this.mU(),t},n.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;0<t&&(this._itemHeight=t)},n.prototype.fU=function(){var t,i,i,n,e,s,t=this;t.vU(),i=t._items[0],i=w(t._itemHeight,h(t.S5).text(v(i)?"":i).height()),h(t.KG.children).css(z,i),(e=t.QG)<=(s=t.qG)?n=e*i:(n=s*i,t.cU=!0),t.listHeight(n),t.mU()},n.prototype.hU=function(t){var t;0<=t&&t<this.QG&&(t=this.KG.children[t],this.JG.xS(t))},n.prototype.bind=function(t,i,n){h(this.xG).bind(t,i,n)},n.prototype.unbind=function(t,i){h(this.xG).unbind(t,i)},n.prototype.ki=function(t,i){h(this.xG).trigger(t,i)},n.prototype.tkr=function(t){this.XIr=t},At=n,r(e,k=l),e.prototype.isReservedKey=function(t,i){return this.rU},e.prototype.actualItems=function(){var t;return null!=(t=this._dataSource.items())?t:this.DGr},e.prototype.qe=function(t,i,n,e,s){k.prototype.qe.call(this,t,i,n,e,s),this._dataSource.loadDataSource(t,!1,null==e?void 0:e.formatter),this._Gr(e)},e.prototype._Gr=function(n){var e=this;v(null==n?void 0:n.formatter)?this.DGr=this._items:this.DGr=this._items.map(function(t){var i;return"object"!=typeof t||t instanceof Date?{text:i=e.jGr(t,n.formatter),value:i}:{text:e.jGr(t.text,n.formatter),value:t.value}})},e.prototype.je=function(t,i,n,e){return this._editorValueType===It.text?i.formatter?this.jGr(n,i.formatter):n:this.getItemValue(n)},e.prototype.paintValue=function(t,i,n,e,s,r,o,u){var c,a,l,M,h,a,g,a,g,I,f,N,d,I,f,N,I,f,c=this,a=u.sheet,l=a.zoom?a.zoom():1,M=17,h=w(0,s-17-1);c._dataSource.needLoadDataSource()?c._dataSource.loadDataSource(a,!0,null==o?void 0:o.formatter):(v(c.DGr)&&c._Gr(o),3===o.hAlign&&(o.hAlign=0),o.wordWrap&&(o.wordWrap=!1),a=u.isPrinting,g=u.printZoomFactor,a&&"number"==typeof g&&1!==g&&(l=g),0<h&&0<r&&(a={},g=void 0,u.quotePrefix=o.quotePrefix,I=o.formatter&&"General"!==o.formatter,f=o._autoFormatter&&o._autoFormatter.formatCached&&"General"!==o._autoFormatter.formatCached,N=void 0,d=this.getItemValue(i),N=I?o.formatter:f?o._autoFormatter:D.CellTypes.Context.Nt(t,d,h+1,o,l),g=this.format(Mt(i),N,a,u),g=(I=c.getText(i,u))!==i?g||(i=I):g)&&(f=new D.Rect(n,e,s,r),k.prototype.adjustRectForIconSet.call(this,o.hAlign,u.sheet,u.row,u.col,u.sheetArea,f,a.content&&k.prototype.hasInfilling.call(this,a.content)),n=f.x,s=f.width,N=o.isVerticalText,W(d)&&!N&&!0!==o.shrinkToFit&&(g!==(I=D.CellTypes.Context.Et(t,g,h+1,o,l))&&(delete a.content,o.textIndent=0),g=I),f=c.Pn(t,g,o,u,n,e,s,r),this.paintText(t,i,n,e,h,r,o,u,g,a,void 0,f.externals)),t.save(),(s<17||r<17)&&(t.rect(n,e,s,r),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=rt,t.moveTo(n+s-17+3,e+(r-2)/2-2.5),t.lineTo(n+s-17+6,e+(r-2)/2+3.5),t.lineTo(n+s-17+9,e+(r-2)/2-2.5),t.fill(),t.restore())},e.prototype.getText=function(t,i){return t},e.prototype.getEditingElement=function(){return this._editingElement},e.prototype.createEditorElement=function(s,t){var i,r,o,u,n,n,n,e,c,a,l,M,l,h,h,M,i=this,r=s&&s.sheet,o=s.row,u=s.col,n=r&&r.parent,n=n&&n.Ti,n=g.gi(n)+1e3,e=r.defaults,c=this,a=r.getActualStyle(s.row,s.col),l=a.cellPadding,M=0;return l&&(M=parseFloat(Lt(l)[3])||0),l=0,l=(h=r.getSpan(o,u))?H(r,h.col,h.col+h.colCount,!1):r.nn(s.col)-M,(h=new At(t,r.qc(),0,0,e.colWidth,e.rowHeight,n,l)).editorValueType(c._editorValueType),this._Gr(a),h.items(c.actualItems()),h.itemHeight(c._itemHeight),h.itemCountPerPage(c._maxDropDownItems),h.editable(c._editable),h.allowFloat(c.allowFloat()),h.tkr(function(){return G(i,void 0,void 0,function(){var i,n,e,n;return B(this,function(t){switch(t.label){case 0:return r.reportDataModel&&(i=r.reportDataModel.mji.POt)&&i.setContext&&(n=null==(n=c._dataSource.dataBinding())?void 0:n.dataSource,i.setContext({row:o,col:u,formula:n,triggerUpdatePrecedents:!0})),[4,c._dataSource.loadDataSource(s.sheet,!1,a.formatter)];case 1:return[2,{isSuccess:e=t.sent(),items:c._dataSource.items()}]}})})}),M=h.getComboBox(),this._editingElement=M,Object.defineProperty(M,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),M.comboBox=h,I},e.prototype.mUr=function(t,i){var n;if(null!=(n=this._dataSource)&&n.needLoadDataSource())return this._dataSource.loadDataSource(t,!1,i)},e.prototype.dataBinding=function(t){var i=this;return 0===arguments.length?i._dataSource.dataBinding():(i._dataSource.dataBinding(t),i)},e.prototype.getEditorValue=function(t,i){var t=U(t);return t&&(this.v6=!t.uU),t&&t.editorValue()},e.prototype.setEditorValue=function(t,i,n){var t=U(t);t&&t.editorValue(i)},e.prototype.focus=function(t,i){var t=U(t);t&&t.focus()},e.prototype.selectAll=function(t,i){var t=U(t);t&&t.selectAll()},e.prototype.activateEditor=function(t,i,n,e){var s,c,a,e,s=this,c=e.sheet,a=U(t);if(a){if(D.CellTypes.Base.et(c,"beforeActivateComboboxCellTypeEditor",e={r:I}),e.r)return;a.editorValueType(s._editorValueType),a.items(s.actualItems()),a.itemHeight(s._itemHeight),a.itemCountPerPage(s._maxDropDownItems),a.editable(s._editable),a.bind(S,function(t,i){var n,e,s,n,r,o,u,n=i.keyCode,e=i.shiftKey;if(n){if(n=(s=c.Qy()).getShortcutKey(n,!1,e||!1,!1,!1),r=s.getCommands(n))for(o=0,u=r.length;o<u;o++)if("navigationLeft"!==r[o].Zc&&"navigationRight"!==r[o].Zc||(c.Di=1),r[o].execute(c.parent,{sheetName:c.name()}))return!0}else i.isMouse&&a.LG&&c.endEdit()})}s.rU=!0},e.prototype.deactivateEditor=function(t,i){var n,e,s,r,o,u;if(t&&(n=U(t))){if(e=i.sheet.getActualStyle(i.row,i.col,i.sheetArea).cellPadding)for(s=[y,T],r=[3,0],o=0;o<s.length;o++)u=typeof(u=parseInt(Lt(e)[r[o]],10))===X&&0<u?u:0,n.shiftPadding(s[o],u);n.unbind(S),n.closeDropDownList(),n.LG=!1}this.rU=!1},e.prototype.updateImeMode=function(t,i){var t;this.isImeAware()&&(t=U(t))&&t.updateImeMode(i)},e.prototype.updateEditor=function(t,i,n,e){var s,t,s,s,r,s=t&&e&&e.sheet;s&&(t=U(t),i&&t&&(s=s.Dn,t.updateStyle(i.backColor,i.foreColor||rt,s._n(i.font||s.Nn()))),n)&&t&&(s=0,i&&e&&e.sheet&&e.sheet.NMi&&(s=mt(i,0,!1,r=e.sheet.zoom())),t.updateLocationAndSize(n.x,n.y,n.width,n.height,s))},e.prototype.format=function(t,i,n,e){var s,t;return v(t)?"":(t=(s=this).getItemValue(t),l.prototype.format.call(s,t,i,n))},e.prototype.getItemValue=function(t){var i,n,e,s,r,o,u,n,c,a,n=this,e=n._editorValueType,s=n.actualItems();if(s)if(u=s.length,1===e){if(0<=(n=N(t))&&n<u&&(r=s[n])!==f&&r!==I)return o=Z(r,L)?r.text:r}else if(2===e)for(c=null==t?void 0:t.toString(),a=0;a<u;a++)if((r=s[a])&&Z(r,ct)&&(null==(i=r.value)?void 0:i.toString())===c)return o=r.text;return t},e.prototype.parse=function(t,i,n){var e,s,r,o,u,c,a,e=this,s=e._editorValueType,r=e.actualItems(),c=l.prototype.parse.call(e,t,i);if(r){if(a=r.length,0===s)return c;if(1===s){for(u=0;u<a;u++)if((o=r[u])&&Z(o,L)&&o.text===c||o===c)return u}else if(2===s)for(u=0;u<a;u++)if((o=r[u])&&Z(o,L)&&o.text===c)return o.value}return c},e.prototype.getHitInfo=function(t,i,n,e,s){var r,o,u,u,u,i;return s&&(r=s.sheetArea,o=s.sheet,v(r)||3===r)&&e&&(u=Lt(n.cellPadding),u=parseInt(u[1],10)||0,u=e.x+e.width-u,i={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:r,sheet:o},u-17<=t)&&t<u?(i.isReservedLocation=!0,i):I},e.prototype.processMouseDown=function(t){var i,n,n,i=t.sheet,n=t.sheetArea;(v(n)||3===n)&&t.isReservedLocation&&i&&(t.row===i.ui&&t.col===i.ci||i.setActiveCell(t.row,t.col),i.startEdit(),n=U(i.li))&&(g.Tt.mozilla&&(n.HG=(new Date).valueOf()),n.showDropDownList(),n.LG=!0)},e.prototype.getAutoFitWidth=function(t,i,n,e,s){var r;return n&&n.wordWrap&&(n.wordWrap=!1),D.CellTypes.Context.Bt(t,i,n,e,s)+17},e.prototype.getAutoFitHeight=function(t,i,n,e,s){return n&&n.wordWrap&&(n.wordWrap=!1),D.CellTypes.Context.tn(t,i,n,e,s)},e.prototype.isImeAware=function(t){return!0},e.prototype.lfe=function(t,i){var i=k.prototype.lfe.call(this,t,i);return t.readonly||this._editable||(i.readonly=!0),i},e.prototype.Ke=function(){},e.prototype.Je=function(t){var t={editorValueType:t.editorValueType&&It[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(t)},e.prototype.toJSON=function(t){var e,s,r,i,e=this,s={typeName:e.typeName};return o(Tt,function(t,i){var n;r=e["_"+t],("items"===t?r&&0<r.length:r!==i)&&(s[t]=r)}),i=e.dataBinding(),v(i)||(t&&t.gp?s[gt]=e._dataSource.items():s[ht]=i),s},e.prototype.fromJSON=function(n){var e,t,e=this;o(Tt,function(t){var i=n[t];v(i)||(e["_"+t]=i)}),t=n[ht],v(t)||e.dataBinding(t)},Ct=e,t.ComboBox=Ct,o(Tt,function(i){Ct.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),D.CellTypes.ti[7]=Ct},"./dist/plugins/celltype/data-binding.js":function(t,i,n){"use strict";var e,f,s,r,N,d,D,o,v,w,u,c;function a(t){this.bbt=t}e=this&&this.__awaiter||function(t,o,n,u){function c(i){return i instanceof n?i:new n(function(t){t(i)})}return new(n=n||Promise)(function(i,n){function e(t){try{r(u.next(t))}catch(t){n(t)}}function s(t){try{r(u.throw(t))}catch(t){n(t)}}function r(t){t.done?i(t.value):c(t.value).then(e,s)}r((u=u.apply(t,o||[])).next())})},f=this&&this.__generator||function(t,n){var e={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s,r,o,u,u={next:i(0),throw:i(1),return:i(2)};return"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(i){return function(t){return c([i,t])}}function c(i){if(s)throw new TypeError("Generator is already executing.");for(;e=u&&i[u=0]?0:e;)try{if(s=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,(i=o?[2&i[0],o.value]:i)[0]){case 0:case 1:o=i;break;case 4:return e.label++,{value:i[1],done:!1};case 5:e.label++,r=i[1],i=[0];continue;case 7:i=e.ops.pop(),e.trys.pop();continue;default:if(!(o=0<(o=e.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){e=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3]))e.label=i[1];else if(6===i[0]&&e.label<o[1])e.label=o[1],o=i;else{if(!(o&&e.label<o[2])){o[2]&&e.ops.pop(),e.trys.pop();continue}e.label=o[2],e.ops.push(i)}}i=n.call(t,e)}catch(t){i=[6,t],r=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},Object.defineProperty(i,"__esModule",{value:!0}),i.DataBindingSource=void 0,s=n("CalcEngine"),r=n("Common"),N=n("SheetsCalc"),d=n("CalcEngine"),D=r.Common.lt.ht,o=!!s,v=void 0,w=r.Common.lt.Nh,u=function(t){return!!D(t)||"string"==typeof t&&""===t.trim()},a.prototype.dataBinding=function(t){return 0===arguments.length?this.Zgr:this.Zgr=t},a.prototype.loadDataSource=function(t,i,n){var e,i,e=this;return this.Hmr=i,this.FIr||(this.Wgr()?Promise.resolve(!1):(i=this.Qgr(t,n),this.FIr=i,this.FIr.then(function(){e.FIr=null}),i))},a.prototype.items=function(){return this._items},a.prototype.needLoadDataSource=function(){return D(this._items)&&!this.Wgr()},a.prototype.Wgr=function(){var t;return!o||!!D(this.Zgr)||!this.Zgr.dataSource},a.prototype.Jgr=function(t,i){var t,t,t,t,t=null==(t=null==(t=t.parent)?void 0:t.dataManager())?void 0:t.tables;return!D(t)&&(t=Object.keys(t),i=i.toLowerCase(),t.some(function(t){return t.toLowerCase()===i}))},a.prototype.Qgr=function(t,i){var n,e,s,n,r,s,n=this.Zgr,e=n.dataSource,s=n.text,n=n.value,s=this.Jgr(t,e)?s||n?(s=s||n)===(n=n||s)?(e='SORT(UNIQUE(QUERY("'.concat(e,'", "').concat(s,'")))'),r=0):(e='SORT(UNIQUE(QUERY("'.concat(e,'", {"').concat(s,'","').concat(n,'"})))'),r=0,1):(e='SORT(UNIQUE(QUERY("'.concat(e,'")))'),r=0):u(s)&&u(n)?r=0:(u(s)&&(s=n),u(n)&&(n=s),r=Number(s),Number(n));return this.Kgr(t,e,r,s,i)},a.prototype.Kgr=function(a,l,M,h,g){var I;return e(this,void 0,void 0,function(){var i,n,e,s,s,r,o,u,c,c=this;return f(this,function(t){switch(t.label){case 0:i=a,n=!1,t.label=1;case 1:return t.trys.push([1,3,,4]),l=l.trimStart(),s=(0,N.formulaToExpression)(i,l),[4,(0,N.xbt)(i,s,0,0)];case 2:return s=t.sent(),(r=d.Convert.LE(s)||d.Convert.Nh(s))?((e=d.Convert.iV(s,0,!1,!1,!1)).isError||e.isConvertError||(n=!0),!e[0]||!e[0][0]||"object"!=typeof e[0][0]||e[0][0]instanceof Date||(e=e.map(function(t){return Object.values(t[0])}))):("string"==typeof s&&(s=JSON.parse(s)),w(s)&&0<s.length&&(e="object"==typeof s[0]?s.map(function(t){return Object.values(t)}):s.map(function(t){return[t]}),n=!0)),[3,4];case 3:return o=t.sent(),n=!1,[3,4];case 4:return u=function(t){return D(t)?"":c.bbt?c.bbt(t,g):t},n?(this._items=e.map(function(t){var t;return{text:u(t[M]),value:null!=(t=t[h])?t:""}}),this.Hmr&&(this.Hmr=!1,D(i.Emr))&&(i.Emr=window.setTimeout(function(){i.repaint(),i.Emr=v},50))):this._items=null!=(I=this._items)?I:[],[2,n]}})})},i.DataBindingSource=a},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,i,M){"use strict";var n,e,s,h,r,r,g,c,r,I,f,s,o,a;function l(t){return t&&"object"==typeof t&&!(t instanceof e.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function u(t){return l(t)?N(t,""):[]}function N(t,i){for(var n,e,s,r,o,u,c,a,n=[],e,s=0,r=Object.keys(t);s<r.length;s++)o=r[s],c=i?i+"."+o:o,"function"!=typeof(u=t[o])&&(l(u)?(a=N(u,c),n.push({text:o,value:u,path:c,layout:{displayAs:h.LayoutDisplayAs.popup},items:a})):n.push({text:o,value:u,path:c}));return n}function d(t){var i=a.call(this)||this;return i.typeName="18",i.pU=t,i}n=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.DataObject=void 0,e=M("CalcEngine"),s=M("Common"),h=M("Core"),r=M("./dist/plugins/celltype/celltypes.ns.js"),r=new s.Common.ResourceManager(r.SR,"CellTypes"),g=r.getResource.bind(r),c="vc",r=h.CellTypes.Text,I=s.Common.lt.ht,f=void 0,n(d,a=r),d.prototype.Xe=function(t,i,n,e,s){var r=t.Z_(i,n,s,!0);r||((r=new h.Style).cellType=this),t.Ut.do("setStyle",i,n,r,s)},d.prototype.qe=function(c,a,t,i,l){var n,e,n,e=u(c.getValue(a,t,l));0<e.length?(i.formatter=this.pU,i.cellButtons=[{command:"openList",imageType:h.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],i.dropDowns=[{type:h.DropDownType.list,option:{items:e,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(t,i,n){for(var e,s,r,o,o,u,o,u,u,e=M("SheetsCalc"),s=n.sheetArea,r=n.col+1;r<t.getColumnCount(s);r++){if(t.isActualProtected()&&t.getCell(n.row,r,s).locked()){t.jT(16,g().DataObject_MeetLock);break}if(t.Ut.findSpan(n.row,r,s)){t.jT(16,g().DataObject_MeetSpan);break}if(3===s&&t.tables&&t.tables.find(n.row,r)||t.pivotTables&&t.pivotTables.findPivotTable(n.row,r)){t.jT(16,g().DataObject_MeetTable);break}if(I(t.getValue(n.row,r,s))){if(h.CellTypes.Base.et(c,"beforeEditDataObjectCellType",o={r:null}),o.r)return;o=e.rangesToFormula([new h.Range(n.row,n.col,1,1)],a,r,15,1===c.parent.options.referenceStyle),u=n.path,o={cmd:"editCell",sheetName:t.name(),row:n.row,col:r,sheetArea:s,newValue:"="+o+'."'+u+'"',autoFormat:!1},c.dataRanges&&(u=c.dataRanges.getByPosition(n.row,r))&&(u=u.convertContext({sheet:c,row:n.row,col:r,sheetArea:l}))&&u.sheet!==c&&(o.sheetName=u.sheet.name(),o.row=u.row,o.col=u.col,o.sheetArea=u.sheetArea),t.Qy().execute(o);break}}}}]):(i.cellButtons=f,i.dropDowns=f),i.formatter&&h.util.St(i.formatter)&&c.SL(a,t,i.formatter)},d.prototype.paint=function(t,i,n,e,s,r,o,u){this.pU!==o.formatter||this.bU?(this.Xe(u.sheet,u.row,u.col,i,u.sheetArea),this.bU=!1):u.sheet.Ut.W_(u.sheetArea).getValueForKey(u.row,u.col,c)&&(this.Xe(u.sheet,u.row,u.col,i,u.sheetArea),u.sheet.Ut.W_(u.sheetArea).setValueForKey(u.row,u.col,c,f)),a.prototype.paint.call(this,t,i,n,e,s,r,o,u)},d.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},d.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},i.DataObject=s=d,h.CellTypes.ti[18]=s},"./dist/plugins/celltype/diagonalCellType/autoFitCell.js":function(t,i,n){"use strict";var u,M,h,e,s;function r(t,i,n,e,s,r,o){this.YC=t,this.ZC=i,this.YSr=n,this._lineHeight=e,this.QSr=r,this.Hur=o,this.JSr=s}Object.defineProperty(i,"__esModule",{value:!0}),i.AutoFitCell=void 0,u=n("./dist/plugins/celltype/diagonalCellType/geometry.js"),M=Math.max,h=Math.abs,e=1,r.prototype.getAutoFitWidth=function(){var t,i,n,e,s,r,o,u,c,a,l,t=this,i=t.YSr,n=i.length,e=t.Hur,s=t.YC,r=t.ZC,o=t.QSr,u=t.lGr(s,r,n);if(2===n)return e?o?M(t.KSr(i[0],u[0]),t.XSr(i[1],u[1])):M(t.qSr(i[0],u[0]),t.$Sr(i[1],u[1])):o?M(t.qSr(i[0],u[0]),t.$Sr(i[1],u[1])):M(t.KSr(i[0],u[0]),t.XSr(i[1],u[1]));if(3===n)return c=1.5,e?o?M(t.KSr(i[0],u[0])*c,t.hGr(s,r,i,u,1),t.XSr(i[2],u[2])):M(t.qSr(i[0],u[0]),t.hGr(s,r,i,u,1),t.$Sr(i[2],u[2])*c):o?M(t.qSr(i[0],u[0])*c,t.hGr(s,r,i,u,1),t.$Sr(i[2],u[2])):M(t.KSr(i[0],u[0]),t.hGr(s,r,i,u,1),t.XSr(i[2],u[2])*c);for(a=[],l=0;l<n;l++)a.push(t.tTr(i[l],u[l]).width);return M.apply(M,a)},r.prototype.getAutoFitHeight=function(){var t,i,n,e,s,r,o,u,c,a,l,t=this,i=t.YSr,n=i.length,e=t.Hur,s=t.YC,r=t.ZC,o=t.QSr,u=t.lGr(s,r,n);if(2===n)return e?o?M(t.nTr(i[0],u[0]),t.eTr(i[1],u[1])):M(t.iTr(i[0],u[0]),t.rTr(i[1],u[1])):o?M(t.iTr(i[0],u[0]),t.rTr(i[1],u[1])):M(t.nTr(i[0],u[0]),t.eTr(i[1],u[1]));if(3===n)return c=1.5,e?o?M(t.nTr(i[0],u[0]),t.dGr(s,r,i,u,1),t.eTr(i[2],u[2])*c):M(t.iTr(i[0],u[0])*c,t.dGr(s,r,i,u,1),t.rTr(i[2],u[2])):o?M(t.iTr(i[0],u[0]),t.dGr(s,r,i,u,1),t.rTr(i[2],u[2])*c):M(t.nTr(i[0],u[0])*c,t.dGr(s,r,i,u,1),t.eTr(i[2],u[2]));for(a=[],l=0;l<n;l++)a.push(t.tTr(i[l],u[l]).height);return M.apply(M,a)},r.prototype.hGr=function(t,i,n,e,s,r){var o,u,c,a,l;for(void 0===r&&(r=10),o=this,c=1/(u=0);;){if(a=o.tTr(n[s],e[s]).width,c<(l=h(a-t)))return t;if(l<1||++u>=r)return a;c=l,e=o.lGr(t=a,i,n.length)}},r.prototype.dGr=function(t,i,n,e,s,r){var o,u,c,a,l;for(void 0===r&&(r=10),o=this,c=1/(u=0);;){if(a=o.tTr(n[s],e[s]).height,c<(l=h(a-i)))return i;if(l<1||++u>=r)return a;c=l,e=o.lGr(t,i=a,n.length)}},r.prototype.lGr=function(t,i,n){var e,s,e,t,e=this,s=e.Hur,e=e.QSr,t=(0,u.divideAreas)(0,0,t,i,n,e,s);return t=s?(0,u.convertRightToLeftAreasToStandardAreas)(t):t},r.prototype.KSr=function(t,i){var n,e,s,r,t,o,n=this,e=n._lineHeight,s,r,t=t+2*n.JSr,o;return e*t/((0,u.getDistance)(i.vertexes[1],i.vertexes[2])-e)+t},r.prototype.XSr=function(t,i){var n,e,s,r,t,o,n=this,e=n._lineHeight,s,r,t=t+2*n.JSr,o;return e*t/((0,u.getDistance)(i.vertexes[0],i.vertexes[2])-e)+t},r.prototype.qSr=function(t,i){var n,e,s,r,t,o,n=this,e=n._lineHeight,s,r,t=t+2*n.JSr,o;return e*t/((0,u.getDistance)(i.vertexes[0],i.vertexes[1])-e)+t},r.prototype.$Sr=function(t,i){var n,e,s,r,t,o,n=this,e=n._lineHeight,s,r,t=t+2*n.JSr,o;return e*t/((0,u.getDistance)(i.vertexes[2],i.vertexes[1])-e)+t},r.prototype.nTr=function(t,i){var n,i,n=this,i=(0,u.getDistance)(i.vertexes[0],i.vertexes[1]);return n.getMinAreaHeight(i,t)},r.prototype.eTr=function(t,i){var n,i,n=this,i=(0,u.getDistance)(i.vertexes[2],i.vertexes[1]);return n.getMinAreaHeight(i,t)},r.prototype.iTr=function(t,i){var n,i,n=this,i=(0,u.getDistance)(i.vertexes[1],i.vertexes[2]);return n.getMinAreaHeight(i,t)},r.prototype.rTr=function(t,i){var n,i,n=this,i=(0,u.getDistance)(i.vertexes[0],i.vertexes[2]);return n.getMinAreaHeight(i,t)},r.prototype.tTr=function(t,i){var n,e,s,n,r,i,o,r,i,r,n=this,e=n._lineHeight,s=n.JSr,n=n.QSr,r=i.angle,i=i.mainDirection,o=i.start,r=.5*e/Math.tan(.5*r),i=(0,u.getPointOnLineByDistance)(i,r+t+2*s),r=n?0:.5*e;return{width:h(i.x-o.x),height:h(i.y-o.y)+r}},r.prototype.getMinAreaHeight=function(t,i){for(var n,e,s,r,o,n=this,e=n._lineHeight,s=n.JSr,r=2;!(i<t*r-r*(2*s)-(1+r)*r/2*(o=t/r));)r+=1;return r*e},i.AutoFitCell=r},"./dist/plugins/celltype/diagonalCellType/diagonal-spread.js":function(t,i,n){"use strict";var e,v,r,o,u;function s(t,i){var n,e,i,s,s,n=i.row,e=i.col,i=i.sheetArea,s=t.getCellType(n,e,i);return!!s&&"20"===s.typeName&&(s=t.getValue(n,e,i),!o(s))&&!!(u(s)||r.Convert.LE(s)||r.Convert.Nh(s))}function w(){return"pic-".concat(Math.ceil(1e9*Math.random()).toString())}function c(t,i){var n,e,e,s,r,t,n=[],e=t.getUsedRange(v.UsedRangeType.style);return e&&n.push({minRow:e.row,maxRow:e.row+e.rowCount,minCol:e.col,maxCol:e.col+e.colCount}),e=t.getRowCount(),s=t.getColumnCount(),r=i.columnHeadersAsFrozenRows?t.getRowCount(v.SheetArea.colHeader):0,t=i.rowHeadersAsFrozenColumns?t.getColumnCount(v.SheetArea.rowHeader):0,i.columnHeadersAsFrozenRows&&n.push({minRow:0,maxRow:r+1,minCol:t,maxCol:s}),i.rowHeadersAsFrozenColumns&&n.push({minRow:r,maxRow:e,minCol:0,maxCol:t+1}),n}function j(t,i){for(var n,e,s,n={width:0,height:0},e=0;e<i.rowCount;e++)n.height+=+t.getRowHeight(e+i.row);for(s=0;s<i.colCount;s++)n.width+=+t.getColumnWidth(s+i.col);return n}function b(t,i){return t.some(function(t){return t.row===i.row&&t.col===i.col&&t.rowCount===i.rowCount&&t.colCount===i.colCount})}Object.defineProperty(i,"__esModule",{value:!0}),i.skr=void 0,e=n("Common"),v=n("Core"),r=n("CalcEngine"),o=e.Common.lt.ht,u=e.Common.lt.Nh,i.skr=s,v.Worksheet.ch("diagonalCellType",{allowStartEdit:function(t){!1!==t.isAllow&&s(this,t)&&(t.isAllow=!1)},getExtraExportShapes:function(t){var i,N,d,D,n,e,s,r,o,i=t.saveOptions,N=t.shapes,d=this;if((null==i?void 0:i.fileType)===v.OpenSaveFileType.excel&&i.saveAsView){for(D=[],e=function(t){for(var i,n,e,s,r,o,u,c,a,u,l,M,l,h,g,I,f,c,n=t.maxRow,e=t.maxCol,s=t.minRow;s<n;s++)for(r=t.minCol;r<e;r++)if((o=d.getStyle(s,r))&&o.cellType&&"20"===o.cellType.typeName&&(u=o.cellType,c=d.getValue(s,r),!((a=u.EE(c)).length<2))){if(u=d.getSpan(s,r)){if(b(D,u))continue;D.push(u)}else u=new v.Range(s,r,1,1);M=(l=j(d,u)).width,l=l.height,h="";try{(g=document.createElement("canvas")).width=M,g.height=l,I=g.getContext("2d"),f={sheet:d,row:s,col:r,sheetArea:3},I.fillStyle=(null==(i=d.currentTheme())?void 0:i.getColor(o.backColor))||"white",I.fillRect(0,0,M,l),o.cellType.paintValue(I,c,0,0,M,l,o,f),h=g.toDataURL()}catch(t){continue}c={name:w(),x:0,y:0,width:M,height:l,startRow:s,startColumn:r,endRow:s+u.rowCount,endColumn:r+u.colCount,startRowOffset:2,startColumnOffset:2,endRowOffset:-2,endColumnOffset:-2,shapeBase64Data:h},N.push(c)}},s=0,r=n=c(d,t.saveOptions);s<r.length;s++)e(o=r[s]);return N}}})},"./dist/plugins/celltype/diagonalCellType/geometry.js":function(t,i){"use strict";var g,f,M,h,n;function e(t,i){this.wSu=t,this.oTr=i}function s(t){this.wSu=t}function r(t,i){var n,t,e,s,n=t.start,t=t.end,e,s;return{start:{x:n.x,y:n.y+i},end:{x:t.x,y:t.y+i}}}function o(t,i){var n,i,n=i.x-t.x,i=i.y-t.y;return Math.sqrt(n*n+i*i)}function I(t){var i,t,i=t.end.x-t.start.x,t=t.end.y-t.start.y;return Math.sqrt(i*i+t*t)}function N(t,i){var n,t,e,t,s,r,o,u,c,n=t.start,t=t.end,e=t.x-n.x,t=t.y-n.y,s=Math.sqrt(e*e+t*t),r,o,u,c;return{x:n.x+e/s*i,y:n.y+t/s*i}}function d(t,i){var n,t,e,t,s,e,r,n=t.start,t=t.end,e=t.x-n.x,t=t.y-n.y,s=e*Math.cos(i)-t*Math.sin(i),e=e*Math.sin(i)+t*Math.cos(i),r;return{start:n,end:{x:n.x+s,y:n.y+e}}}function D(t,i){var n,t,e,i,s,r,t,o,u,i,c,a,e,a,l,M,h,n=t.start,t=t.end,e=i.start,i=i.end,r=t.x-n.x,t=t.y-n.y,u=i.x-e.x,i=i.y-e.y,c=r*i-t*u;return!(Math.abs(c)<g)&&(l=((a=e.x-n.x)*t-(e=e.y-n.y)*r)/c,0<=(a=(a*i-e*u)/c))&&0<=l&&l<=1?{x:M=n.x+a*r,y:h=n.y+a*t}:null}function v(t,i){var n,i,n=i.x-t.x,i=i.y-t.y;return Math.sqrt(n*n+i*i)<g}function u(t){return{x:t.end.x-t.start.x,y:t.end.y-t.start.y}}function c(t){return{x:-1*t.x,y:-1*t.y}}function a(t,i){var n,t,i,e,n=t.x*i.x+t.y*i.y,t=Math.sqrt(t.x*t.x+t.y*t.y),i=Math.sqrt(i.x*i.x+i.y*i.y),e;return Math.acos(n/(t*i))}function l(t,i){return{x:i.x-t.x,y:i.y-t.y}}function w(t,i,n,e,s,r,o){var u,c,a,l,M,u,c,a,l,M;return new h([{x:t,y:i},{x:t+n,y:i},{x:t+n,y:i+e},{x:t,y:i+e}]).divideAreas(s,r,o)}function j(t){var i,n,t,i=function(t){var i=t.vertexes;return new f([i[1],i[2],i[0]],t.mainDirection)},n=function(t){var i=t.vertexes;return new f([i[2],i[0],i[1]],t.mainDirection)},t=Array.from(t);return 3<(t=t.reverse()).length||(t[0]=i(t[0]),t[t.length-1]=n(t[t.length-1])),t}Object.defineProperty(i,"__esModule",{value:!0}),i.convertRightToLeftAreasToStandardAreas=i.divideAreas=i.getVector=i.angleBetweenVectors=i.reverseDirection=i.getLineDirection=i.isEqual=i.intersectRayAndLineSeg=i.rotateLine=i.getPointOnLineByDistance=i.getLineLength=i.getDistance=i.moveLineY=i.Polygon=void 0,g=.001,Object.defineProperty(e.prototype,"diagonal",{get:function(){return{start:this.wSu[0],end:this.wSu[this.wSu.length-1]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexes",{get:function(){return this.wSu},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mainDirection",{get:function(){return this.oTr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textLine",{get:function(){for(var t,i,n,e,s,r,i=this,n=i.wSu,e=n.length,s=i.oTr,r=1;r<e-1&&!(t=D(s,{start:n[r],end:n[r+1]}));r++);if(t)return{start:s.start,end:t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){var t,i,n,e,t,i=this.vertexes,n,e;return a(l(i[0],i[1]),l(i[0],i[i.length-1]))},enumerable:!1,configurable:!0}),f=e,i.Polygon=f,(n=M=M||{})[n.topLeft=0]="topLeft",n[n.topRight=1]="topRight",n[n.bottomRight=2]="bottomRight",n[n.bottomLeft=3]="bottomLeft",s.prototype.divideAreas=function(t,i,n){var n,i,i,e,s,r,o,i,u,c,a,l;return t<2?[]:(i=i?n?M.bottomRight:M.bottomLeft:n?M.topRight:M.topLeft,i=(n=this).aTr(i),2===t?[e=new f([i[0].start,i[0].end,i[1].end],null),s=new f([i[0].start,i[2].start,i[2].end],null)]:(r=i[0],o=i[1],i=i[2],3===t?(c=N(o,2*(u=I(o))/3),e=new f([r.start,r.end,c],null),a=N(i,(u=I(i))/3),[e,s=new f([r.start,c,o.end,a],{start:r.start,end:o.end}),l=new f([r.start,a,i.end],null)]):n.uTr(r,[o,i],t)))},s.prototype.uTr=function(t,i,n){for(var e,s,r,o,u,c,a,l,M,h,g,I,e=[],s=Math.PI/2/n,r=s/2,o=0,u=0,c=!1;u<n-1;)(M=D(a=d(t,s),l=i[o]))?(h=[t.start,t.end],c&&!v(t.end,i[o-1].end)&&h.push(i[o-1].end),h.push(M),g=d(t,r),e.push(new f(h,g)),c=!1,u++,t={start:t.start,end:M}):(o++,c=!0);return I=[t.start,t.end],0!==o||v(t.end,i[o].end)||I.push(i[o].end),I.push(i[1].end),e.push(new f(I,d(t,r))),e},s.prototype.aTr=function(t){for(var i,n,e,s,r,o,i=this,n=[],e=4,s=0;s<4;s++)r=i.wSu[(t+s)%4],o=i.wSu[(t+s+1)%4],n.push({start:r,end:o});return n},h=s,i.moveLineY=r,i.getDistance=o,i.getLineLength=I,i.getPointOnLineByDistance=N,i.rotateLine=d,i.intersectRayAndLineSeg=D,i.isEqual=v,i.getLineDirection=u,i.reverseDirection=c,i.angleBetweenVectors=a,i.getVector=l,i.divideAreas=w,i.convertRightToLeftAreasToStandardAreas=j},"./dist/plugins/celltype/diagonalCellType/index.js":function(t,i,n){"use strict";var e,s,r,a,o,v,l,u,c,h,n,M,g,I,f,N,d,D,w,j,b,r,y,s,T;function A(){var t=T.call(this)||this;return t.allowOverflow=!1,t.typeName="20",t.sTr=b.topLeftToBottomRight,t.cTr=M,t}e=this&&this.__extends||(y=function(t,i){return(y=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}y(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Diagonal=i.DivergeDirection=void 0,s=n("CalcEngine"),r=n("Common"),a=n("Core"),o=n("CalcEngine"),v=n("./dist/plugins/celltype/diagonalCellType/geometry.js"),l=n("./dist/plugins/celltype/diagonalCellType/autoFitCell.js"),u=n("./dist/plugins/celltype/diagonalCellType/diagonal-spread.js"),c=!!s,h=r.Common.lt.ht,n=a.CellTypes.TextCellType,M=new a.LineBorder("black",a.LineStyle.thin),g="_divergeDirection",I="_lineBorder",f=r.Common.lt.Nh,N=a.mt.vt,d=a.W.x2e,D=",",w=10,j=4,(s=b=i.DivergeDirection||(i.DivergeDirection={}))[s.topLeftToBottomRight=0]="topLeftToBottomRight",s[s.bottomLeftToTopRight=1]="bottomLeftToTopRight",e(A,T=n),A.prototype.paintValue=function(t,i,n,e,s,r,o,u){var c,a,l,M,i,l,c=this,a=c.EE(i),l=u.sheet,M=l.options.rightToLeft;a.length<=1?T.prototype.paintValue.call(this,t,i,n,e,s,r,o,u):(h(u.fontInfo)&&(u.fontInfo=d(o,l.zoom())),h(u.lineHeight)&&(u.lineHeight=N(u.fontInfo.font)),10<a.length&&(a.length=10),i=(0,v.divideAreas)(n,e,s,r,a.length,c.sTr===b.bottomLeftToTopRight,M),c.lTr(t,i.slice(0,i.length-1).map(function(t){return t.diagonal})),t.save(),this.pe(t,u.sheet,o),l=i,M&&(l=(0,v.convertRightToLeftAreasToStandardAreas)(i)),this.dTr(t,u,a,l,M),t.restore())},A.prototype.divergeDirection=function(t){var i=this;return 0===arguments.length?i.sTr:(h(t)||(i.sTr=t),i)},A.prototype.lineBorder=function(t){var i=this;return 0===arguments.length?i.cTr:(h(t)||(i.cTr=t),i)},A.prototype.toJSON=function(){var t,i,t=this,i={typeName:t.typeName};return t.sTr!==b.topLeftToBottomRight&&(i[g]=t.sTr),t.cTr!==M&&(i[I]=t.cTr.toJSON()),i},A.prototype.fromJSON=function(t){var i,t,n,i=this;i.sTr!==t[g]&&(i.sTr=t[g]),t=t[I],h(t)||((n=new a.LineBorder).fromJSON(t),n.color===M.color&&n.style===M.style)||(i.cTr=n)},A.prototype.getAutoFitWidth=function(t,i,n,e,s){var r,o,u,r=this,o=r.EE(t);return o.length<2?T.prototype.getAutoFitWidth.call(this,t,i,n,e,s):h(a.q.J())?0:(u=r.vGr(o,n,e,s)).getAutoFitWidth()},A.prototype.getAutoFitHeight=function(t,i,n,e,s){var r,o,u,r=this,o=r.EE(t);return o.length<2?T.prototype.getAutoFitHeight.call(this,t,i,n,e,s):h(a.q.J())?0:(u=r.vGr(o,n,e,s)).getAutoFitHeight()},A.prototype.vGr=function(t,i,n,e){var e,s,r,o,u,s,c,e,i,t,u,c,r=this,o=e.sheet,u=e.row,s=e.col,c=e.sheetArea,e=null!=(e=e.lineHeight)?e:N(i.font)/n;return r.pe(a.q.J(),o,i),i=t.map(function(t){return a.q.Wt(t)/n}),t=o.Gt(u,c),u=o.nn(s,c),c=null==(s=o.options)?void 0:s.rightToLeft,new l.AutoFitCell(u,t,i,e,4,r.sTr===b.bottomLeftToTopRight,c)},A.prototype.lfe=function(t,i){var n;return(0,u.skr)(t.sheet,t)&&(t.readonly=!0),t},A.prototype.wkr=function(t){var i,n,e,s,t,n;return!!T.prototype.wkr.call(this,t)&&(i=this,n=t.sheet,e=t.row,s=t.col,t=t.sheetArea,n={sheet:n,sheetName:n.name(),sheetArea:t,readonly:!1,row:e,col:s},!i.isReadonly(n))},A.prototype.dTr=function(t,i,n,e,s){var r,o,u,r=this,o=n.length;if(2===o)s?r.sTr===b.bottomLeftToTopRight?(r.vTr(t,i,n[0],e[0]),r.gTr(t,i,n[1],e[1])):(r.mTr(t,i,n[0],e[0]),r.pTr(t,i,n[1],e[1])):r.sTr===b.bottomLeftToTopRight?(r.mTr(t,i,n[0],e[0]),r.pTr(t,i,n[1],e[1])):(r.vTr(t,i,n[0],e[0]),r.gTr(t,i,n[1],e[1]));else if(3===o)s?r.sTr===b.bottomLeftToTopRight?(r.vTr(t,i,n[0],e[0]),r.bTr(t,i,n[1],e[1],s),r.gTr(t,i,n[2],e[2])):(r.mTr(t,i,n[0],e[0]),r.bTr(t,i,n[1],e[1],s),r.pTr(t,i,n[2],e[2])):r.sTr===b.bottomLeftToTopRight?(r.mTr(t,i,n[0],e[0]),r.bTr(t,i,n[1],e[1],s),r.pTr(t,i,n[2],e[2])):(r.vTr(t,i,n[0],e[0]),r.bTr(t,i,n[1],e[1],s),r.gTr(t,i,n[2],e[2]));else for(u=0;u<o;u++)r.bTr(t,i,n[u],e[u],s)},A.prototype.vTr=function(t,i,n,e){var s,r,o,u,i,c,n,a,l,M,h,M;if(n&&(s=this,r=i.lineHeight,!((o=(0,v.getDistance)(e.vertexes[1],e.vertexes[2]))<r))){for(u=s.wTr(i),i={start:e.vertexes[2],end:e.vertexes[0]},c={start:e.vertexes[1],end:e.vertexes[0]},c=(0,v.moveLineY)(c,r),n=s.yTr(t,n,r,o,c,i,!1),t.save(),s.MTr(t,e),t.beginPath(),a=0,l=n;a<l.length;a++)h=(M=l[a]).text,M=M.position,t.fillText(h,M.x+4,M.y-r+u);t.restore()}},A.prototype.gTr=function(t,i,n,e){var s,r,o,u,i,c,n,a,l,M,h,M;if(n&&(s=this,r=i.lineHeight,!((o=(0,v.getDistance)(e.vertexes[2],e.vertexes[0]))<r))){for(u=s.CTr(i),i={start:e.vertexes[0],end:e.vertexes[1]},c={start:e.vertexes[2],end:e.vertexes[1]},c=(0,v.moveLineY)(c,-r),n=s.yTr(t,n,-r,o,c,i,!0),t.save(),s.MTr(t,e),t.beginPath(),a=0,l=n;a<l.length;a++)h=(M=l[a]).text,M=M.position,t.fillText(h,M.x+4,M.y+r-u);t.restore()}},A.prototype.mTr=function(t,i,n,e){var s,r,o,u,i,c,n,a,l,M,h,M;if(n&&(s=this,r=i.lineHeight,!((o=(0,v.getDistance)(e.vertexes[1],e.vertexes[0]))<r))){for(u=s.wTr(i),i={start:e.vertexes[2],end:e.vertexes[0]},c={start:e.vertexes[1],end:e.vertexes[2]},c=(0,v.moveLineY)(c,r),n=s.yTr(t,n,r,o,c,i,!0),t.save(),s.MTr(t,e),t.beginPath(),a=0,l=n;a<l.length;a++)h=(M=l[a]).text,M=M.position,t.fillText(h,M.x+4,M.y-r+u);t.restore()}},A.prototype.pTr=function(t,i,n,e){var s,r,o,u,i,c,n,a,l,M,h,M;if(n&&(s=this,r=i.lineHeight,!((o=(0,v.getDistance)(e.vertexes[1],e.vertexes[2]))<r))){for(u=s.CTr(i),i={start:e.vertexes[0],end:e.vertexes[1]},c={start:e.vertexes[2],end:e.vertexes[0]},c=(0,v.moveLineY)(c,-r),n=s.yTr(t,n,-r,o,c,i,!1),t.save(),s.MTr(t,e),t.beginPath(),a=0,l=n;a<l.length;a++)h=(M=l[a]).text,M=M.position,t.fillText(h,M.x+4,M.y+r-u);t.restore()}},A.prototype.bTr=function(t,i,n,e,s){var r,o,i,r,u,c,a,l,M,M,s,h;n&&(o=this,i=i.lineHeight,r=null!=(r=e.textLine)?r:e.mainDirection,u=(0,v.getLineDirection)(r),c={x:100,y:0},M=e.angle,M=.5*i/Math.tan(.5*M),s?(s=t.measureText(n).width,l=(h=(0,v.getLineLength)(r))<M+s?r.end:(0,v.getPointOnLineByDistance)(r,M+s),a=(0,v.angleBetweenVectors)(c,(0,v.reverseDirection)(u)),o.sTr!==b.bottomLeftToTopRight&&(a*=-1)):(l=(0,v.getPointOnLineByDistance)(r,M),a=(0,v.angleBetweenVectors)(c,u),o.sTr===b.bottomLeftToTopRight&&(a*=-1)),t.save(),o.MTr(t,e),t.translate(l.x,l.y+i/2),t.rotate(a),t.fillText(n,0,0),t.restore())},A.prototype.STr=function(t,i,n,e,s){for(var r,o,u,c,r=Math.abs(i),o=0,u=r;(c=(0,v.intersectRayAndLineSeg)(e,s))&&!(t<(o+=(0,v.getDistance)(e.start,c)-8))&&!(n<(u+=r));)e=(0,v.moveLineY)(e,i);return e},A.prototype.yTr=function(t,i,n,e,s,r,o){var u,c,a,l,M,h,g,I,f,N,d,D,u=this,c=Math.abs(n),a=[],l=0,M=t.measureText(i).width;for(n<0&&(s=u.STr(M,n,e,s,r)),h=M/i.length;l<i.length&&a.length*c<e&&(g=(0,v.intersectRayAndLineSeg)(s,r));){if(I=(0,v.getDistance)(g,s.start)-8,f=Math.floor(I/h),N=i.substring(l,l+f),D=f,(d=t.measureText(N).width)<I)for(;l+D<i.length&&t.measureText(i.substring(l,l+D+1)).width<I;)D++;else if(I<d){for(;0<D&&t.measureText(i.substring(l,l+D-1)).width>I;)D--;D--}a.push({position:o?s.start:g,text:D===f?N:i.substring(l,l+D)}),l+=D,s=(0,v.moveLineY)(s,c)}return a},A.prototype.MTr=function(t,i){var n,e,n=i.vertexes;for(t.beginPath(),t.moveTo(n[0].x,n[0].y),e=1;e<n.length;e++)t.lineTo(n[e].x,n[e].y);t.closePath(),t.clip()},A.prototype.wTr=function(t){var i,t,n,e,i=t.lineHeight,t=parseInt(t.fontInfo.fontSize.toString(),10),n,e;return i-(i/2-t/2+(8<t?Math.floor((t-8)/5+2):1)-1)},A.prototype.CTr=function(t){var i,t,n,e,i=t.lineHeight,t=parseInt(t.fontInfo.fontSize.toString(),10),n,e;return 2+(i/2-t/2+(8<t?Math.floor((t-8)/5+2):1)-1)},A.prototype.lTr=function(t,i){for(var n,n,e,s,r,o,u,u,n=null!=(n=this.cTr)?n:M,e=n.color,s=n.style,r=0,o=i;r<o.length;r++)u=o[r],u=(0,a.Zx)(u.start.x,u.start.y,u.end.x,u.end.y,e,s,!1),h(u)||u._e(t)},A.prototype.EE=function(t){var n,i,e,s;return h(t)?[]:(n=function(t){return t.map(function(t){return h(t)?"":t.toString()})},f(t)?n(t):c&&(o.Convert.LE(t)||o.Convert.Nh(t))?(e=!((i=o.Convert.iV(t,0,!1,!1,!1)).isError||i.isConvertError))?(i=i[0]&&i[0][0]&&"object"==typeof i[0][0]?i.map(function(t){return Object.values(t[0])}):i).reduce(function(t,i){return t.concat(n(i))},[]):[]:(s=t.toString()).split(D))},i.Diagonal=r=A,a.CellTypes.ti[20]=r},"./dist/plugins/celltype/dropdown-action.js":function(a,t,i){"use strict";var y,T,A,C,z,p,m,x,N,L,t,d,O,S,k,e,s,r,E,i,D,U,Z,G,B,Q,Y,R,P,W,n,o,v,u;function V(t,i){return n.createElement(t,i)}function c(b){return{canUndo:!1,execute:function(t,i,n){var e,t,s,r,o,u,c,a,l,M,h,g,I,l,f,N,d,D,v,l,M,t,w,s,j,l,M,s,e=(0,T._f)(t,i.sheetName);if(!e||t.jg().name()!==i.sheetName)return!1;if(t=i.row,s=i.col,(k(t)||k(s))&&(t=e.getActiveRowIndex(),s=e.getActiveColumnIndex()),r=i.sheetArea,k(r)&&(r=3),t<0||t>=e.getRowCount(r)||s<0||s>=e.getColumnCount(r))return!1;if(e.showCell(t,s,T.VerticalPosition.nearest,T.HorizontalPosition.nearest),c=e.getCellRect(t,s,o=1===r?-1:void 0,u=2===r?-1:void 0),e.parent&&!e.parent.options.scrollByPixel&&!e.isEditing()){if(0<(a=e.frozenColumnCount())&&a<(l=e.getViewportLeftColumn(1))&&(M=e.getSpan(t,s,r))&&M.col<=l&&l<M.col+M.colCount&&0<(h=l-a))for(g=0;g<h;g++)c.width=c.width-e.getColumnWidth(a+g+1,r);if(0<(I=e.frozenRowCount())&&I<(l=e.getViewportTopRow(1))&&(M=e.getSpan(t,s,r))&&M.row<=l&&0<(f=(l<M.row+M.rowCount?l:M.rowCount)-I))for(g=0;g<f;g++)c.height=c.height-e.getRowHeight(I+g+1,r)}switch(N=V("div"),d=J(e,t,s,r),(k(i.row)||k(i.col))&&(i.row=e.getActiveRowIndex(),i.col=e.getActiveColumnIndex()),l=i.row,M=i.col,t=e.Il(l,M,r),w=F(b),(l=(s=t.dropDowns)&&0<s.length)&&(M=s.filter(function(t){return t.type===w})[0])&&(void 0!==M.option&&null!==M.option&&(v=M.option),j=M),b){case U:D=new x.ColorPicker(N);break;case Z:D=v&&v.showDateRange?(d=H(d,"dateRange"),new L.RangeCalendar(N,y(y({},v),{calendarPage:T.CalendarPage.day,showTime:!1}))):(d=H(d,"dateTime"),new L.Calendar(N));break;case G:d=H(d,"date"),D=new p.TimePicker(N);break;case B:d=(d=H(d,"number")).toString(),D=new A.Calculator(N);break;case Q:d=H(d,"date"),D=new m.MonthPicker(N);break;case Y:(D=new C.List(N)).formula=e.getFormula(i.row,i.col);break;case R:d=v&&v.showNumberRange?H(d,"numberRange"):H(d,"number"),D=new z.Slider(N);break;case P:D=new O.WorkFlow(N),"string"!=typeof d&&d!==E&&(d=d.toString());break;case W:D=new S.MultiColumn(N,E,e)}return s={r:E},T.CellTypes.Base.et(e,"beforePopupDropdownCellType",s),s.r?void 0:(X(D,d,c,e,i,t,l,j,v),!0)}}}function J(t,i,n,e){return t.getValue(i,n,e)}function H(t,i){var i,n;return"date"===i?"string"==typeof t?(t=s.yU(t))===E&&(t=new Date):t instanceof Date||(t=new Date):"dateTime"===i?"string"==typeof t?t=s.yU(t):t&&!(0,L.isValidDate)(t)&&(t=E):"dateRange"===i?(t&&"object"==typeof t&&(t={start:r(t.start),end:r(t.end)}),(0,L.isValidDateRange)(t)||(t=E)):"number"===i?"string"==typeof t?t=e.yU(t):"number"!=typeof t&&(t=0):"numberRange"===i&&(n=i=0,t&&"object"==typeof t&&("string"===t.start?i=e.yU(t.start):isNaN(t.start)||(i=t.start),"string"===t.end?n=e.yU(t.end):isNaN(t.end)||(n=t.end)),t={start:i,end:n}),t}function w(t,i,n,e){var s,r,o,u,n,i,u,i,u,n,o,c,a,s=n.row,r=n.col;(k(s)||k(r))&&(s=t.getActiveRowIndex(),r=t.getActiveColumnIndex()),o=n.sheetArea,k(o)&&(o=3),i&&i.submitCommand?"string"==typeof i.submitCommand?t.getParent().commandManager().execute({cmd:i.submitCommand,sheetName:t.name(),row:s,col:r,newValue:e.value}):"function"==typeof i.submitCommand&&((u={}).row=n.row,u.col=n.col,u.sheetArea=o,u.path=e.path,i.submitCommand.call(null,t,e.value,u)):(n={cmd:"editCell",sheetName:t.name(),row:s,col:r,newValue:e.text,autoFormat:!e.noAutoFormat,sheetArea:o,isUndo:!1},t.dataRanges&&(i=t.dataRanges.getByPosition(s,r))&&(u=i.convertContext({sheet:t,row:s,col:r,sheetArea:o}))&&u.sheet!==t&&(n.sheetName=u.sheet.name(),n.row=u.row,n.col=u.col,n.sheetArea=u.sheetArea),t.getParent().commandManager().execute(n),t.ci===r&&t.ui===s&&(i=t.getCellType(s,r),u={sheet:t,row:s,col:r,sheetArea:T.SheetArea.viewport},n=i.isImeAware(u),t.isEditing()?(o=t.Il(s,r,o),c=t.getCellRect(s,r),t.li.Li=e.value,a=i.je(t.li,o,e.value,u),i.updateEditor(t.li,o,c,u),i.setEditorValue(t.li,a||e.text,u)):n&&t.rt.JBe(i,s,r,e.text)))}function F(t){var i=-1;switch(t){case U:i=T.DropDownType.colorPicker;break;case Z:i=T.DropDownType.dateTimePicker;break;case G:i=T.DropDownType.timePicker;break;case B:i=T.DropDownType.calculator;break;case Q:i=T.DropDownType.monthPicker;break;case Y:i=T.DropDownType.list;break;case R:i=T.DropDownType.slider;break;case P:i=T.DropDownType.workflowList;break;case W:i=T.DropDownType.multiColumn}return i}function j(t,i,n,e,s){var i,i,i=i.cellButtons;t&&i&&0<i.length&&(i=t.Ut.getValueForKey(n,e,o,s))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(n,e)))}function X(i,t,n,e,s,r,o,u,c){var a,l,M,h,g,c,t,c,I,I,t,c,n,f;D.ef(),a=e.parent,l=e.qc(),M=s.row,h=s.col,g=s.sheetArea,i.setOptions(c&&y(y({},c),{row:M,col:h})),i.setValue(t),c=l.getBoundingClientRect(),t=n.x+c.left,c=n.y+c.top,(I=b(a))&&(t+=I.x,c+=I.y),I=new N.Rectangle(t,c,n.width,n.height),c=(t=i.getOptions())&&!k(t.dropDownAlignment)?t.dropDownAlignment:T.DropDownAlignment.Far,n=t&&!k(t.dropDownDirection)?t.dropDownDirection:void 0,f=new N.PopupControl(i.getContainer(),I,{align:c,hostElement:l,direction:n}),v+=1,o&&i.wU(),f.open(),i.scrollToSelect(),o&&i.refresh(),i.on(d.BaseDropdown.Event_ValueChanged,function(t){t.notCloseDropDown||f.close(),_(s,t)&&w(e,u,s,t)}),a&&(a.CC=a.CC||[],a.CC.push(f)),i.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),f.on("close",function(){j(e,r,M,h,g),i&&i.dispose(),--v,f=null;var t=a.CC.indexOf(f);a.CC.splice(t,1),D.cf()})}function b(t){var i,n,e,s;if(t&&(i=t.options.tabStripVisible)&&0!==(n=t.options.tabStripPosition)){switch(e={x:0,y:0},s=t.w2.ot(),n){case 1:e.y=s.height;break;case 2:e.x=s.width}return e}}function _(t,i){return!0!==i.notSubmit&&(3===t.sheetArea||t.cmd!==B||!isNaN(i.value))}y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var i,n,e,s,n=1,e=arguments.length;n<e;n++)for(s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0,T=i("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return T.Commands}}),A=i("./dist/plugins/celltype/editor/calculator.js"),C=i("./dist/plugins/celltype/editor/listControl.js"),z=i("./dist/plugins/celltype/editor/slider.js"),p=i("./dist/plugins/celltype/editor/timepicker.js"),m=i("./dist/plugins/celltype/editor/monthPicker.js"),x=i("./dist/plugins/celltype/editor/colorpicker.js"),N=i("./dist/plugins/celltype/editor/popupControl.js"),L=i("./dist/plugins/celltype/editor/calendar.js"),t=i("Common"),d=i("./dist/plugins/celltype/editor/baseControl.js"),O=i("./dist/plugins/celltype/editor/workflowPicker.js"),S=i("./dist/plugins/celltype/editor/multiColumnPicker.js"),k=t.Common.lt.ht,e=t.Common.st,s=t.Common.ct,r=T.mt.Bve,E=null,i=window,D=i.gcGlobal,U="openColorPicker",Z="openDateTimePicker",G="openTimePicker",B="openCalculator",Q="openMonthPicker",Y="openList",R="openSlider",P="openWorkflowList",W="openMultiColumn",n=document,o="_cellButtonParam",T.Commands[U]=c(U),T.Commands[Z]=c(Z),T.Commands[G]=c(G),T.Commands[B]=c(B),T.Commands[Q]=c(Q),T.Commands[Y]=c(Y),T.Commands[R]=c(R),T.Commands[P]=c(P),T.Commands[W]=c(W),v=0,T.Workbook.ch("registerOpendropdownCommand",u={init:function(){this.commandManager().register(U,T.Commands[U]),this.commandManager().register(Z,T.Commands[Z]),this.commandManager().register(G,T.Commands[G]),this.commandManager().register(B,T.Commands[B]),this.commandManager().register(Q,T.Commands[Q]),this.commandManager().register(Y,T.Commands[Y]),this.commandManager().register(R,T.Commands[R]),this.commandManager().register(P,T.Commands[P]),this.commandManager().register(W,T.Commands[W])}}),T.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<v&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,i,n){"use strict";var e,n,s,r,o,u,c;function a(t){var i=u.call(this)||this;return i.Wc=t,i}function l(t){var i=c.call(this)||this;return i.Ti=t,i}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseDropdown=i.BaseControl=void 0,n=n("./dist/plugins/celltype/editor/eventbase.js"),u=n.EventBase,e(a,u),a.prototype.init=function(t,i,n){this.Ti=this.Wc.querySelector("."+i),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,i,n),this.Wc.appendChild(this.Ti))},a.prototype.GetContainer=function(){return this.Wc},a.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},a.prototype.CreateElement=function(t,i,n,e){var s,r,s=document.createElement(t);if(i&&(s.className=i),n)for(r in n)n[r]&&s.setAttribute(r,n[r]);return e&&e.appendChild(s),s},i.BaseControl=a,c=n.EventBase,e(l,c),l.prototype.getOptions=function(){return this.MU},l.prototype.updateStyle=function(t,i,n){},l.prototype.scrollToSelect=function(){},l.prototype.getContainer=function(){return this.Ti},l.prototype.refresh=function(){},l.prototype.wU=function(){},l.prototype.dispose=function(){},l.Event_ValueChanged="ValueChangedEvent",i.BaseDropdown=l},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,i,n){"use strict";var e,s,c,n,M,h,g,r,o,I,f,N,u,a,l;function d(t,i,n){var t=l.call(this,t)||this;return t.setOptions(i),t.CU=n,t}function D(t,i,n){var e={sheet:t};M(n)||(e.isEsc=n),t.ki(i,e)}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseSpreadPicker=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),c=n("Core"),n=n("Common"),M=n.Common.lt.ht,h=Math.min,g=Math.max,r=null,o=".baseSpreadNS",I=800,f=400,N=100,l=s.BaseDropdown,e(d,l),d.prototype.setOptions=function(t){var i,t,i,i=this;(i.MU=t)&&(t=i.Ti,(i=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(i),this.SU=i,this.TU=this.AU(i))},d.prototype.setValue=function(t){var i,n,i=this;i.MU&&(n=i.TU,setTimeout(function(){var t;window.gcGlobal.cf(),n&&n.focus(!0)},1e3))},d.prototype.wU=function(){var t,i,n,e,s,n,t=this;t.SU&&(i=t.Ti,(n=t.MU)&&(e=n.width,s=n.height),n=t.IU(e,s),M(e)&&(e=n.width),M(s)&&(s=n.height),(0,c.GC$)(i).width(e).height(s))},d.prototype.refresh=function(){this.TU&&this.TU.refresh()},d.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=r),t.SU&&(t.SU=r),t.TU&&(t.TU.unbind(c.Events.DropdownSpreadMouseClick+o),t.TU.unbind(c.Events.DropdownSpreadKeyboardEnter+o),t.TU.L0(),t.TU=r)},d.prototype.IU=function(t,i){for(var n,e,s,r,o,u,c,a,a,t,t,i,l,n,e=this.TU,s=e.getActiveSheet(),r=s.getColumnCount(),o=0,u=0;u<r;u++)o+=s.getColumnWidth(u,3);return c=o,a=s.getRowCount(3)+s.getRowCount(1),a=s.getRowHeight(0,3)*a,c<I&&M(t)||c<=t?e.options.showHorizontalScrollbar=!1:(t=0,a+=t=e._hScrollbar?e._hScrollbar.ZC():t),a<f&&M(i)||a<i?e.options.showVerticalScrollbar=!1:(t=0,c+=t=(i=e._vScrollbar)?(l=i.lS(!1))||e.NC():t),{width:h(c,I),height:h(g(a,N),f)}},d.prototype.AU=function(t){var t,i,n,e,t=new c.Workbook(t,{sheetCount:1});return t.xU=!0,(i=t.options).allowUserDragDrop=!1,i.allowDragHeaderToMove=c.AllowDragHeaderToMove.none,i.allowUserDragFill=!1,i.allowUserResize=!1,i.allowUserZoom=!1,i.tabStripVisible=!1,i.allowContextMenu=!1,i.allowUserDeselect=!1,i.scrollbarMaxAlign=!0,(n=t.getActiveSheet()).RD=!0,e=this,t.bind(c.Events.DropdownSpreadMouseClick+o,function(t,i){e.submitData(i)}),t.bind(c.Events.DropdownSpreadKeyboardEnter+o,function(t,i){e.submitData(i)}),t},d.prototype.submitData=function(t){},i.BaseSpreadPicker=d,c.GC$.extend(c.Worksheet.prototype,{BD:function(){D(this,c.Events.DropdownSpreadMouseClick)},GD:function(t){D(this,c.Events.DropdownSpreadKeyboardEnter,t)},Mhe:function(t,i,n){var u,e,e,u=this,e=u.whe(),e=e&&e[t]&&e[t][i];e&&(u.suspendPaint(),e.forEach(function(t){var i,n,e,s,r,o,s,r,i=t.row,n=t.col,e=t.dataSource,s=t.dependSheetName,r=t.targetSheetName;s===u.name()&&(s=(s=(o=u.getParent()).Gm(r))._gi===c.SheetType.reportSheet&&s.getSheet?s.getSheet():s)&&(r=s.getStyle(i,n))&&r.dropDowns&&r.dropDowns.some(function(t){return t.type===c.DropDownType.multiColumn&&t.option.dataSource===e})&&s.YI(t.row,t.col,null)}),u.resumePaint())},whe:function(){var t,i,t=this,i=t.Che;return i=i||(t.Che=[])}})},"./dist/plugins/celltype/editor/calculator.js":function(t,i,n){"use strict";var e,r,s,o,u,n,c,a,l,M,h,g,I,f,N,d,D,v,w,j,b,y;function T(t){var t=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return t=isNaN(t)?0:t}function A(){}function C(){}function z(){}function p(t,i,n,e,s,r,o,u,c,a,l){var M=this;M.Y6=t,M._x=i,M._y=n,M.NU=e,M.kU=s,M.DU=r,M._U=o,M.EU=u,M.jU=c,M.OU=a,M.RU=l,M.BU=N}function m(t){var i,n,e,i=y.call(this,t)||this,n=i;return n.Ti=document.createElement("div"),n.Ti.classList.add("gc-calculator-container"),n.Ti.innerHTML=a,(e=n.Ti.querySelector(".okbtn")).textContent=c().OK,t.appendChild(i.Ti),n.LU(),n.FU(),n.PU(),n.GU(),n.UU("0"),i}e=this&&this.__extends||(b=function(t,i){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}b(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Calculator=i.CalculatorErrorInfo=void 0,r=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),o=n("Common"),u=n("Core"),n=new o.Common.ResourceManager(s.SR,"CellTypes"),c=n.getResource.bind(n),a='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,M=Math.abs,h=Math.pow,g=Math.round,I=Math.sqrt,f=Math.max,N=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),A.Init=function(){var t;A.GetBrowserType(),A.IsIE=void 0!==A.ie||void 0!==A.edge},A.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?A.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?A.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(A.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(A.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(d=A).Init(),C.IsErrorText=function(t){return t===c().Calculator_DivideByZeroInfo||t===c().Calculator_InvalidInputInfo||t===c().Calculator_SqrtParameterException||t===c().Calculator_OverFlowInfo},D=C,i.CalculatorErrorInfo=D,z.IsDotContained=function(t){var i;return-1!==(t+"").indexOf(".")},z.GetDotPosition=function(t){var i,n,e,i=t+"",n=0,e=0;for(e=i.length;0<e;e--){if("."===i.substring(e-1,e))return n;n++}return 0===e?0:n},z.FormatOutput=function(t){var i,n,e;if(null==t)return null;if(n=0,e=(i=t+"").length,z.IsDotContained(i))for(;"0"===i.substring(e-1,e)&&""!==i&&-1===i.indexOf("e");)i=i.substring(0,e-1),e--;return i},z.FormatResult=function(t){var i,n,t,e,s,r,s,i=(t=isNaN(t)?0:t)+"",n="";return t<0&&(n="-",i=i.substring(1,i.length)),t=i.length,e="",-1!==(s=i.indexOf("e"))&&(e=i.substring(s,t),t=(i=i.substring(0,s)).length),z.IsDotContained(i)&&16<t&&(r=0,i=1<parseFloat(i)?(r=z.GetDotPosition(i)-(t-16),i.toString().substring(0,17)):(r=z.GetDotPosition(i)-(t-17),i.toString().substring(0,18)),i=(0<r?g(parseFloat(i)*h(10,r))/h(10,r):g(parseFloat(i))).toString()),t=i.length,!z.IsDotContained(i)&&15<t&&(r=t-15,i=(g(parseFloat(i)/h(10,r))*h(10,r)).toString()),i=n+i+e,s=parseFloat(i),z.IsOverFlow(s.toString())?c().Calculator_OverFlowInfo:s},z.SingleMathOperation=function(t,i){var t,i,t=parseFloat(t);if(isNaN(t)&&(t=0),"SQRT"===i){if(t<0)return c().Calculator_InvalidInputInfo;t=I(t)}if("POW"===i&&(t=h(t,2)),"1/x"===i){if(0===t)return c().Calculator_DivideByZeroInfo;i=z.GetDotPosition(t.toString()),t=h(10,i)/(h(10,i)*t)}return z.FormatResult(t)},z.DoubleMathOperation=function(t,i,n){var t,i,e,s,r,o,t=parseFloat(t),i=parseFloat(i);if(z.IsDotContained(t.toString())||z.IsDotContained(i.toString())){if(r=s=0,z.IsDotContained(t.toString())&&(s=z.GetDotPosition(t.toString())),z.IsDotContained(i.toString())&&(r=z.GetDotPosition(i.toString())),o=f(s,r),"+"===n&&(e=((t*=h(10,o))+(i*=h(10,o)))/h(10,o)),"-"===n&&(e=((t*=h(10,o))-(i*=h(10,o)))/h(10,o)),"*"===n&&(e=(t*=h(10,s))*(i*=h(10,r))/h(10,s+r)),"/"===n){if(t*=h(10,o),0===(i*=h(10,o)))return c().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=(t*=h(10,s))*(i*=h(10,r))/h(10,s+r+2))}else{if("+"===n&&(e=t+i),"-"===n&&(e=t-i),"*"===n&&(e=t*i),"/"===n){if(0===i)return c().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=t*i/100)}return z.FormatResult(e)},z.IsOverFlow=function(t){var t=parseFloat(t);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},v=z,p.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},p.prototype.Click=function(t){var i,t,i=this;return 0<=t&&t<=11&&(i.OU&&(i.zU(t),i.OU=!1),i.VU(t),10!==t)&&(i.RU="ClickNumericButton"),(12<=t&&t<=19||27===t)&&(i.OU?(i.zU(t),i.OU=!1):(i.YU(t),i.RU="ClickMathButton")),24===t&&(i.OU&&(i.zU(t),i.OU=!1),i.ZU()),25!==t&&26!==t||(i.zU(t),i.OU=!1),i.OU?null:((t={}).outputText=i.WU(),D.IsErrorText(i.Y6)&&(i.OU=!0),t.result=void 0===i.Y6||null===i.Y6?"":i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,t)},p.prototype.VU=function(t){var i=this;if(null!==i.Y6&&void 0!==i.Y6||(i.Y6=""),!(14<i.DU&&10!==t))switch(11!==t&&10!==t&&(0!==t||i.Y6+""!="0"&&""!==i.Y6)&&i.DU++,10!==t&&(i.EU=!0),i.kU){case 0:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0!==t?i.Y6=""+t:"0"!==i.Y6&&(i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0."),""===i.Y6||v.IsDotContained(i.Y6)?""!==i.Y6&&v.IsDotContained(i.Y6)||(i.Y6="0."):i.Y6=i.Y6+"."),i.kU=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i.jU||(i._y=i.Y6);break;case 2:0<=t&&t<=9&&(i.Y6="",i.Y6=i.Y6+t),11===t&&(i.Y6="0."),10===t&&(i.Y6="0"),i.kU=3,i._y=i.Y6;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i._y=i.Y6}},p.prototype.YU=function(t){var i=this;switch(i.DU=0,i.EU=!1,i.jU&&(i.jU=!1),i.Y6=v.FormatOutput(i.Y6),i.kU){case 0:""===i.Y6&&(i.Y6=0),(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6),i.kU=1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&i.HU();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?i._y=i.Y6:i._x=i.Y6)),19===t&&(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6)):"-0."===i.Y6&&(i.Y6="0."),i.jU=!0,i.EU=!1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&(null!==i.NU&&void 0!==i.NU?(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]).toString(),i._y=i.Y6):i.HU());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i.kU=3,i._y=i.Y6)),19===t&&(i._y=i._x,i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0),12<=t&&t<=15&&(i.NU=t,i._y=i.Y6),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[17]),D.IsErrorText(i.Y6)||(i._y=i.Y6,i.kU=3));break;case 3:16<=t&&t<=18&&17!==t&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i._y=i.Y6)),12<=t&&t<=15&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i._y=null,i.NU=t,i.kU=2)),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]),D.IsErrorText(i.Y6)||(i._y=i.Y6)),19===t&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0)}i.Y6+=""},p.prototype.ZU=function(){var t,i,n,t=this;if(0<t.DU&&t.DU--,(0===t.kU||1===t.kU||3===t.kU)&&!0===t.EU)switch(t.Y6+="",(i=0)<(n=t.Y6.length)&&(t.Y6=t.Y6.substring(0,n-1)),"-0"===t.Y6&&(t.Y6="0"),"-"===t.Y6&&(t.Y6=""),""===t.Y6&&(t.EU=!1),t.kU){case 0:case 1:t._x=t.Y6;break;case 3:t._y=t.Y6}},p.prototype.zU=function(t){var i=this;i.DU=0,i.EU=!1,i.Y6="",25===t&&(1!==i.kU||null===i.NU||void 0===i.NU||i.jU||(i._y=0),2===i.kU)&&(i.kU=3),26===t&&i.HU()},p.prototype.WU=function(){var t,i,t=this,i="";return i=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},p.prototype.mf=function(t){var i=t.keyCode;switch(t.shiftKey&&(i|=65536),t.ctrlKey&&(i|=131072),t.altKey&&(i|=262144),i){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(d.IsIE)break;return 12;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===i&&d.firefox||187===i&&!d.firefox?19:-1}},w=p,y=r.BaseDropdown,e(m,y),m.prototype.setValue=function(t){var i,t,i=this;t=i.QU(t);try{if(!i.q8(t))throw new Error(c().Calculator_InvalidInputInfo);t=""===t?"0":t,i.Y6=i.KU(t),i._text=i.JU(t),i._x=parseFloat(i.Y6),i._y=null,i.NU=null,i.kU=0,i.DU=i.XU(parseFloat(i.Y6)),0<i.DU?i.EU=!0:i.EU=!1,i.jU=!1,i.OU=!1,i.RU=null}catch(t){i._text=c().Calculator_InvalidInputInfo,i.Y6="",i._x=null,i._y=null,i.OU=!0}return i.qU(i.OU),i.UU(i._text),(t={}).outputText=i._text,t.result=i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,i.$U=new w(i.Y6,i._x,i._y,i.NU,i.kU,i.DU,i._U,i.EU,i.jU,i.OU,i.RU),i},m.prototype.setOptions=function(){},m.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},m.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},m.prototype.FU=function(){var t=this;t.$U=new w(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},m.prototype.PU=function(){var t=this;t.qU(t.OU)},m.prototype.GU=function(){var n,e,s,t,i,n=this,e=this,s=e.Ti,t,i=function(t){!0!==e.mf(t)&&(t.preventDefault(),t.stopPropagation())};s.addEventListener("click",function(t){for(var i,t,t,i=t.srcElement||t.target;i&&!i.classList.contains("button");)i=i.parentElement;i&&(i.getAttribute("data-value")?(t=i.getAttribute("data-value"),t=m.eH(t),s.focus(),-1!==t&&e.iH(t)):i.classList.contains("okbtn")&&("ClickNumericButton"===e.RU&&e.iH(19),n.fire(r.BaseDropdown.Event_ValueChanged,{value:e._text,text:e._text})))}),s.addEventListener("keydown",i),s.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},m.prototype.UU=function(t){var i,n,i=this.Ti.querySelector(".gc-main-screen .gc-main"),n=i.value;null!=n&&n.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(i.value=t,this.tH(i))},m.prototype.tH=function(t){var i=this;if(null!==i.rH&&void 0!==i.rH||(i.rH=T(t)),i.oH(t))for(;i.oH(t);)i.aH(t);else i.uH(t)},m.prototype.oH=function(t){var i,n,e,i,s,r;return 1<t.scrollWidth-t.clientWidth||!(!u.mt.Tt.edge&&!u.mt.Tt.msie||t.clientWidth<=0)&&(n=(i=window.getComputedStyle(t)).fontWeight,e=i.fontSize,i=i.fontFamily,(r=u.q.Wt(t.value,s=n+" "+e+" "+i))+40>t.clientWidth)},m.prototype.aH=function(t){var i=T(t);t.style.fontSize="".concat(i-1,"px")},m.prototype.uH=function(t){for(var i,n,i=this,n=T(t);!i.oH(t)&&n<i.rH;)if(t.style.fontSize="".concat(++n,"px"),i.oH(t)){for(;i.oH(t);)i.aH(t);break}},m.prototype.QU=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return(t=null==t?"":t).toString();throw new Error(t+" type is not a string.")},m.prototype.sH=function(t,i){var n,e,s,r;if(0===i.length)return"";for(n="",s=e=0;e<i.length;e++){for(r=!1,s=0;s<t.length;s++)i.substring(e,e+1)===t.substring(s,s+1)&&(r=!0);!0===r&&(n+=i.substring(e,e+1))}return n},m.prototype.q8=function(t){var i;return this.sH("-.0123456789",t)===t&&(-1===(i=t.indexOf("-"))||0===i)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},m.prototype.KU=function(t){var t,i,t,n,e,s,r,t=parseFloat(t),i=t<0?!0:!1,t=M(t),n=l(t),e=v.GetDotPosition(t.toString()),s=(t*h(10,e)-n*h(10,e))/h(10,e);if(999999999999999<n)throw new Error(c().Calculator_InvalidInputInfo);return 999999999999999!==n?(r=0===n?15:15-n.toString().length,s=g(s*h(10,r))/h(10,r),e=v.GetDotPosition(s.toString()),t=(n*h(10,e)+s*h(10,e))/h(10,e),n=l(t),e=v.GetDotPosition(t.toString()),0===(s=(t*h(10,e)-n*h(10,e))/h(10,e))&&(t=n),i?"-"+t:""+t):0===s?n:void 0},m.prototype.JU=function(t){var t=t.toString();return t=""===t?"0":t},m.prototype.XU=function(t){var t,i,n,t,e,s,t=M(t),i=l(t),n=v.GetDotPosition(t.toString()),t=(t*h(10,n)-i*h(10,n))/h(10,n),e,s;return(0===i?0:i.toString().length)+(0==t?0:n)},m.prototype.qU=function(t){for(var i=10;i<=18;i++)this.cH(i,t);this.cH(27,t)},m.prototype.cH=function(t,i){var t,t,t=N[t],t=this.Ti.querySelector('[data-value="'+t.toLowerCase()+'"]');t&&(i?t.classList.add("disabled"):t.classList.remove("disabled"))},m.eH=function(t){var i=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i=parseInt(t,10);break;case"+/-":i=10;break;case".":i=11;break;case"+":i=12;break;case"-":i=13;break;case"*":i=14;break;case"/":i=15;break;case"sqrt":i=16;break;case"%":i=17;break;case"1/x":i=18;break;case"=":i=19;break;case"MC":i=20;break;case"MR":i=21;break;case"MS":i=22;break;case"M+":i=23;break;case"BS":i=24;break;case"CE":i=25;break;case"C":i=26;break;case"pow":i=27;break;default:i=-1}return i},m.prototype.iH=function(t){var i,t,i=this,t=i.$U.Click(t);null!=t&&(null!==t.result&&void 0!==t.result&&(i.Y6=t.result),null!==t.outputText&&void 0!==t.outputText&&(i.nH=t.outputText,i._text=i.nH,i.UU(i.nH)),null!==t.isOperationInvalid&&void 0!==t.isOperationInvalid&&t.isOperationInvalid!==i.OU&&(i.OU=t.isOperationInvalid,i.qU(i.OU)),t.memoryNumber!==i._U&&(i._U=t.memoryNumber),t.lastOperation!==i.RU)&&(i.RU=t.lastOperation)},m.prototype.mf=function(t){var t=this.$U.mf(t);return null==t||-1!==t&&void this.iH(t)},i.Calculator=m},"./dist/plugins/celltype/editor/calendar.js":function(U,o,t){"use strict";var i,r,Z,G,u,n,c,a,t,f,n,l,B,M,Q,Y,R,P,W,H,V,J,F,X,h,N,_,K,q,$,tt,it,nt,et,st,d,D,g,I,rt,v,w,ot,e,ut,ct,j,at,lt,b,y,T,Mt,ht,gt,It,ft,Nt,dt,Dt,vt,wt,jt,bt,yt,A,Tt,C,At,Ct,zt,pt,z,mt,p,m,xt,Lt,Ot,St,x,kt,Et,Ut,Zt,Gt,Bt,Qt,Yt,Rt,Pt,t,Wt,Ht,Vt;function L(t){return B.createElement(t)}function Jt(){}function Ft(){this.yearTds=[]}function Xt(){this.monthTds=[]}function _t(){this.weekThs=[],this.dayTds=[]}function Kt(){this.calendarYearSection=new xt,this.calendarMonthSection=new Lt,this.calendarDaySection=new Ot,this.timeItemLIs=[]}function s(){}function qt(t,i,n,e){this.year=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function $t(t,i,n,e){this.month=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function ti(t,i,n,e){this.date=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function O(t){var t;this.fH=40,this.lH=100,this.owner=t,this.calendarPage=a.CalendarPage.month,this.the=null,this.Ggr={start:x.getDefaultDate(),end:x.getDefaultDate()},this.selectedDate=null!=(t=null==t?void 0:t.Ugr)?t:new Date,this.updateDayFocusDate(),this.focusDateTimeIndex=-1,m.initResource()}function S(t){var i=Wt.call(this)||this;return i.hH=!1,i.jS=t,i}function k(t,i,n,e){var s=Ht.call(this,t)||this;return s.dH=7,s.HG=!0,n&&(s.parent=n,s.nhe=!0,s.HG=!1,s.ehe=e),s._data=new Bt(s),s.Dn=new Qt(s),s.Dn.on(u.BaseDropdown.Event_ValueChanged,function(t){var i,i,i=c.Common.CultureManager.getCultureInfo().DateTimeFormat,i=new c.Formatter.GeneralFormatter(i.defaultDatePattern).format(t.value);s.fire(u.BaseDropdown.Event_ValueChanged,{text:i,value:t.value})}),s.Dn.on(Qt.Event_GetHost,function(t){t.host=s.Ti}),s.nhe||(s.Ti.innerHTML=""),s.Ti.appendChild(s.Dn.createCalendarDom()),s.Dn.attachEvent(),s.nhe||s.setValue(new Date),s.Dn.showCalendarPage(a.CalendarPage.day),s.Dn.setCalendarActivePart(p.Date),i&&s.setOptions(i),s}function E(t,i){var t=Vt.call(this,t)||this;return t.ihe=0,t.Zmr=t.Hgr(i.defaultDateTime),t.the=t.Zmr,t.rhe(i),t.aY(),t}i=this&&this.__extends||(Pt=function(t,i){return(Pt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Pt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var i,n,e,s,n=1,e=arguments.length;n<e;n++)for(s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)},Object.defineProperty(o,"__esModule",{value:!0}),o.RangeCalendar=o.Calendar=o.isValidDateRange=o.isValidDate=void 0,Z=t("./dist/plugins/celltype/editor/eventbase.js"),G=t("./dist/plugins/celltype/editor/timepicker.js"),u=t("./dist/plugins/celltype/editor/baseControl.js"),n=t("./dist/plugins/celltype/celltypes.ns.js"),c=t("Common"),a=t("Core"),t=new c.Common.ResourceManager(n.SR,"CellTypes"),f=t.getResource.bind(t),n=c.Common.lt,l=n.ht,B=document,M="gc-calendar-container",Q="gc-date-ranges-calendar",Y="gc-range-calendar-container",R="gc-date-range-container",P="gc-date-time-container",W="gc-date-part-container",H="gc-time-part-container",V="gc-ok-button-container",J="gc-date-container",F="gc-week-container",X="gc-today-container",h="gc-content-container",N="gc-header-container",_="gc-header-title",K="gc-content-td-date",q="gc-content-td-time",$="gc-date-time-vertical-partline",tt="gc-date-time-horizontal-partline",it="gc-year-page",nt="gc-year-select-div",et="gc-month-page",st="gc-day-page",d="gc-left-arrow",D="gc-right-arrow",g="gc-arrow-disable",I="gc-is-focused",rt="gc-cl-select",v="gc-cl-is-selected",w="gc-cl-disabled-text",ot="gc-cl-select-container",e="gc-focus-part-indicator",ut="gc-cl-datepicker",ct="gc-cl-dropdown",j="gc-cl-datepicker-filter",at="gc-cl-datepicker-filter-month",lt="gc-cl-grid-align-spread",b="gc-cl-align-middle",y="gc-cl-button-icon-container",T="gc-cl-datepicker-month",Mt="gc-cl-day",ht="gc-cl-week",gt="gc-cl-show-inline-block",It="gc-builtIn-date-Range-child-div",ft="gc-builtIn-date-ranges-div",Nt="gc-date-ranges-result-div",dt="gc-date-ranges-result-button",Dt="gc-builtIn-date-range-childDiv-select",vt="gc-date-ranges-result-buttonDiv",wt="gc-date-ranges-result-input",jt="gc-cl-p-bottom-x-small",bt="gc-cl-shrink-none",yt="gc-cl-grow",A="gc-cl-grid",Tt="gc-uiButton",C="gc-cl-button",At="gc-cl-button-brand",Ct="year-index",zt="month-index",pt="week-index",z="day-index",mt="dateRange-index",(t=p=p||{})[t.Date=1]="Date",t[t.Time=2]="Time",Jt.initResource=function(){Jt.resource={shortWeeks:[f().Calendar_ShortWeeks_1,f().Calendar_ShortWeeks_2,f().Calendar_ShortWeeks_3,f().Calendar_ShortWeeks_4,f().Calendar_ShortWeeks_5,f().Calendar_ShortWeeks_6,f().Calendar_ShortWeeks_7],shortMonths:[f().Calendar_ShortMonths_1,f().Calendar_ShortMonths_2,f().Calendar_ShortMonths_3,f().Calendar_ShortMonths_4,f().Calendar_ShortMonths_5,f().Calendar_ShortMonths_6,f().Calendar_ShortMonths_7,f().Calendar_ShortMonths_8,f().Calendar_ShortMonths_9,f().Calendar_ShortMonths_10,f().Calendar_ShortMonths_11,f().Calendar_ShortMonths_12],weeks:[f().Calendar_Weeks_7,f().Calendar_Weeks_1,f().Calendar_Weeks_2,f().Calendar_Weeks_3,f().Calendar_Weeks_4,f().Calendar_Weeks_5,f().Calendar_Weeks_6],months:[f().Calendar_Months_1,f().Calendar_Months_2,f().Calendar_Months_3,f().Calendar_Months_4,f().Calendar_Months_5,f().Calendar_Months_6,f().Calendar_Months_7,f().Calendar_Months_8,f().Calendar_Months_9,f().Calendar_Months_10,f().Calendar_Months_11,f().Calendar_Months_12],timePrefix:[f().Calendar_Time_AM,f().Calendar_Time_PM],eraNames:[f().Calendar_EraName_1,f().Calendar_EraName_2,f().Calendar_EraName_3,f().Calendar_EraName_4],earFirstYear:f().Calendar_FirstYear,today:f().Calendar_Today,lastMonth:f().Calendar_LastMonth,nextMonth:f().Calendar_NextMonth,lastYear:f().Calendar_LastYear,nextYear:f().Calendar_NextYear,lastTenYears:f().Calendar_LastTenYear,nextTenYears:f().Calendar_NextTenYear}},Jt.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},m=Jt,xt=Ft,Lt=Xt,Ot=_t,St=Kt,s.dateEqual=function(t,i,n){if(!t&&!i)return!0;if(!t)return!1;if(!i)return!1;try{return n?t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()&&t.getHours()===i.getHours()&&t.getMinutes()===i.getMinutes()&&t.getSeconds()===i.getSeconds():t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}catch(t){return!1}},s.getMonthMaxDay=function(t,i){return-1!==[1,3,5,7,8,10,12].indexOf(i)?31:-1!==[4,6,9,11].indexOf(i)?30:t%4==0&&t%100!=0?29:28},s.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},s.addMilliseconds=function(t,i){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+i),new Date(t.valueOf())},s.getEraDate=function(t){var i,n,e,i={era:-1,eraYear:-1};if(s.isValidEraDate(t))for(n=0;n<s.eraCount;n++)if(t<(e=n+1!==s.eraCount?s.eraDates[n+1]:s.addMilliseconds(s.eraMax,1))){i.era=n,i.eraYear=t.getFullYear()-s.eraDates[n].getFullYear()+1;break}return i},s.getEraYearString=function(t){var i,i,i=new Date(t,5,30),i=s.getEraDate(i);return-1===i.era||-1===i.eraYear?t.toString():t.toString()+"\u5e74"},s.getShortEraYearString=function(t){var t,t,i,t=new Date(t,11,31),t=s.getEraDate(t);return-1===t.era||-1===t.eraYear?"":(i=1===t.eraYear?m.resource.earFirstYear:t.eraYear,m.resource.eraNames[t.era]+i+"\u5e74")},s.getDateLocaleLabel=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?m.resource.timePrefix[0]:m.resource.timePrefix[1])+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},s.getBuiltInDateRanges=function(){var t,i,n,e,s,r,o,e,t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return i.setDate(t.getDate()-1),(n=new Date(t)).setDate(t.getDate()-6),e=t.getFullYear(),s=t.getMonth(),r=new Date(e,s,1),o=new Date(e,s-1,1),e=new Date(e,s+1,0),[[f().Calendar_BuiltIn_Today,{start:new Date(t.getFullYear(),t.getMonth(),t.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[f().Calendar_BuiltIn_Yesterday,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:i}],[f().Calendar_BuiltIn_Last7Days,{start:new Date(n.getFullYear(),n.getMonth(),n.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[f().Calendar_BuiltIn_ThisMonth,{start:new Date(r.getFullYear(),r.getMonth(),1),end:new Date(r.getFullYear(),r.getMonth(),e.getDate())}],[f().Calendar_BuiltIn_LastMonth,{start:new Date(o.getFullYear(),o.getMonth(),1),end:new Date(r.getFullYear(),r.getMonth(),0)}]]},s.getDefaultDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},s.getNextMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()+1,n=new Date(i,t,1);return 12===t&&(n.setFullYear(i+1),n.setMonth(0)),n},s.getPreviousMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()-1,n=new Date(i,t,1);return-1==t&&(n.setFullYear(i-1),n.setMonth(11)),n},s.getFirstDayOfMonth=function(t){var i,t,i=t.getFullYear(),t=t.getMonth();return new Date(i,t,1)},s.getShortDate=function(t){var i,t;return l(t)?t:(i=t.start,t=t.end,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())})},s.eraCount=4,s.eraMax=new Date(2087,11,31,23,59,59),s.eraMin=new Date(1868,8,8),s.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),x=s,qt.prototype.getLabel=function(){return this.year.toString()},kt=qt,$t.prototype.getLabel=function(){return m.resource.shortMonths[this.month]},Et=$t,ti.prototype.getLabel=function(){return this.date.getDate().toString()},Ut=ti,o.isValidDate=Zt=function(t){return t instanceof Date&&!isNaN(t.getTime())},o.isValidDateRange=Gt=function(t){return t instanceof Object&&(0,o.isValidDate)(t.start)&&(0,o.isValidDate)(t.end)&&t.start<=t.end},O.getMonthName=function(t){return m.resource.months[t]},O.getShortMonthName=function(t){return m.resource.shortMonths[t]},Object.defineProperty(O.prototype,"RangeCalendar",{get:function(){return this.owner&&this.owner.parent},enumerable:!1,configurable:!0}),O.prototype.updateDayFocusDate=function(){var t,t,t,i,t,i,i,n,t,i,i,t,n=this.owner;n.nhe?(t=null!=(t=null!=(t=this.the)?t:null==(t=n.parent)?void 0:t.Zmr)?t:this.Ggr,n.isDateOrDateRangeOutOfRange(t)&&(t={start:i=new Date(null!=(i=n.$gr)?i:n.qgr),end:i}),1===n.ehe?this.focusDate=x.getFirstDayOfMonth(t.start):2===n.ehe&&(i=void 0,i=t.end.getFullYear()===t.start.getFullYear()&&t.end.getMonth()===t.start.getMonth()?x.getNextMonth(t.start):x.getFirstDayOfMonth(t.end),this.focusDate=i)):(t=null!=(i=null!=(t=this.selectedDate)?t:n.Ugr)?i:x.getDefaultDate(),n.isDateOrDateRangeOutOfRange(t)&&(t=new Date(null!=(i=n.$gr)?i:n.qgr)),this.focusDate=new Date(t.valueOf()))},O.prototype.updateDayItems=function(){var t,i,n,e,s,r,o,u,c,a,l,o,M,h,t,t,g,I,f,I,N;for(this.dayItems=[],i=this.focusDate.getFullYear(),n=this.focusDate.getMonth(),c=u=((o=(s=(e=new Date(i,n,1)).getDay())-(r=this.owner.dH))<0?7+o:o)%7;0<c;c--)(a=new Date(i,n,1)).setDate(a.getDate()-c),l=new Ut(a,!1,!0,!1),this.dayItems.push(l);for(M=(o=this.Xgr(i,n))[0],h=o[1],c=1;c<=42-u;c++)a=new Date(i,n,c),l=new Ut(a),this.owner.nhe?(t=null!=(t=this.the)?t:this.Ggr,(x.dateEqual(a,t.start)||x.dateEqual(a,t.end))&&(l.selected=!0),a>t.start&&(a<t.end||this.ohe&&a<=this.ohe)&&!l.disabled&&(l.focused=!0),t=this.owner.qgr&&this.owner.qgr.getFullYear(),g=this.owner.$gr&&this.owner.$gr.getFullYear(),f=(I=this.Mmr(i))[0],I=I[1],N=g&&i<g||t&&t<i,(i===t&&(a.getMonth()>I||a.getMonth()===I&&h<c)||i===g&&(a.getMonth()<f||a.getMonth()===f&&c<M)||N||a.getMonth()!==n)&&(l.disabled=!0)):(x.dateEqual(a,this.selectedDate)&&(l.selected=!0),x.dateEqual(a,this.focusDate)&&(l.focused=!0),(a.getMonth()!==n||c<M||h<c)&&(l.disabled=!0)),this.dayItems.push(l)},O.prototype.updateMonthItems=function(){var t,i,n,t,t,e,s,e,e,s,e;for(this.monthItems=[],i=0;i<12;i++)n=new Et(i),this.owner.nhe?(t=null!=(t=this.the)?t:this.Ggr,n.selected=t.start.getMonth()===i||t.end.getMonth()===i,n.focused=t.start.getMonth()<i&&t.end.getMonth()>i):(t=this.selectedDate,s=(e=this.focusDate)&&e.getFullYear(),e=e&&e.getMonth(),n.selected=t&&t.getMonth()===i&&t.getFullYear()===s,n.focused=e===i,s=(e=this.Mmr(s))[0],e=e[1],n.disabled=e<i||i<s),this.monthItems.push(n)},O.prototype.updateYearItems=function(){var t,i,n,e,s,t;for(this.yearItems=[],i=this.owner.qgr&&this.owner.qgr.getFullYear(),n=this.owner.$gr&&this.owner.$gr.getFullYear(),e=this.focusDateYearRangeStart-1;e<=this.focusDateYearRangeEnd+1;e++)s=new kt(e),this.owner.nhe?(t=null!=(t=this.the)?t:this.Ggr,s.selected=t.start.getFullYear()===e||t.end.getFullYear()===e,s.focused=t.start.getFullYear()<e&&t.end.getFullYear()>e):(s.selected=this.selectedDate&&this.selectedDate.getFullYear()===e,s.focused=this.focusDate&&this.focusDate.getFullYear()===e,s.disabled=e<this.focusDateYearRangeStart||e<n||e>this.focusDateYearRangeEnd||i<e),this.yearItems.push(s)},O.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},O.prototype.getShortWeekName=function(t){var i,n,i,n;return m.resource.shortWeeks[t=(this.owner.dH+t-1)%7]},O.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return O.getMonthName(t)},O.prototype.updateCalendarData=function(t,i){t?(this.the=t.selectedDateRange,this.ohe=t.hoverDate):i||this.RangeCalendar.notifyCalendarData({selectedDateRange:this.the,hoverDate:this.ohe})},O.prototype.Jmr=function(t){var i,n,i,e,n,i=this.owner,n=i.$gr,i=i.qgr,e=[void 0,void 0];return n&&(0,o.isValidDate)(n)&&(e[0]=n.getFullYear(),e[1]=n.getFullYear()+this.fH),i&&(0,o.isValidDate)(i)&&(l(e[0])&&(e[0]=i.getFullYear()-this.lH),e[1]=i.getFullYear()),l(e[0])&&l(e[1])&&(n=null!=t?t:(new Date).getFullYear(),e[0]=n-this.lH,e[1]=n+this.fH),e},O.prototype.Mmr=function(t){var i,n,e,s,i=this.owner,n=[-1,12],e=i.$gr&&(0,o.isValidDate)(i.$gr)?i.$gr.getFullYear():void 0,s=i.qgr&&(0,o.isValidDate)(i.qgr)?i.qgr.getFullYear():void 0;return e===t&&(n[0]=i.$gr.getMonth()),s===t&&(n[1]=i.qgr.getMonth()),n=t<e||s<t?[void 0,void 0]:n},O.prototype.Xgr=function(t,i){var n,e,n,s,n=this.owner,e=n.$gr,n=n.qgr,s=[void 0,void 0];return e&&(0,o.isValidDate)(e)&&e.getFullYear()===t&&e.getMonth()===i&&(s[0]=e.getDate()),n&&(0,o.isValidDate)(n)&&n.getFullYear()===t&&n.getMonth()===i&&(s[1]=n.getDate()),s},Bt=O,Wt=Z.EventBase,i(S,Wt),Object.defineProperty(S.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),S.prototype.createCalendarDom=function(){var t,i,n,e,s,e,t,t=this.jS;return this.mH=new St,i=L("div"),this.jS.nhe?i.className=M+" "+R:i.classList.add(M),t.HG?i.classList.add(P):i.classList.add(J),n=L("table"),e=L("tr"),(s=L("td")).classList.add(K),t.HG&&s.classList.add(q),s.appendChild(this.gH()),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.HG&&(e=L("tr"),t=L("td"),s.appendChild(this.pH()),s.appendChild(this.bH()),t.appendChild(this.yH()),t.appendChild(this.wH()),e.appendChild(t),n.appendChild(e)),this.mH.outerContainerDiv=i},S.prototype.wH=function(){var t,i,t=L("div");return t.classList.add(V),(i=L("button")).textContent=f().OK,i.className=C+" "+At+" "+Tt,t.appendChild(i),this.mH.okButton=i,t},S.prototype.pH=function(){var t=L("div");return t.classList.add($),t},S.prototype.yH=function(){var t=L("div");return t.classList.add(tt),t},S.prototype.gH=function(){var t=L("div");return t.className=W+" "+ut+" "+ct,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t},S.prototype.MH=function(){var t=L("div");return t.classList.add(it),t.appendChild(this.TH()),t.appendChild(this.AH()),t},S.prototype.TH=function(){var t,i,n,e,s,s,r,o,o,t=L("div");return t.className=N+" "+j+" "+A,(i=L("div")).className=at+" "+A+" "+lt+" "+yt,(n=L("div")).classList.add(b),(e=L("button")).className=C+" "+y,e.title=f().Calendar_LastTenYear,e.setAttribute("type","button"),(s=L("div")).classList.add(d),e.appendChild(s),(s=L("span")).classList.add(b),(r=L("button")).className=C+" "+y,r.title=f().Calendar_NextTenYear,r.setAttribute("type","button"),(o=L("div")).classList.add(D),r.appendChild(o),i.appendChild(e),i.appendChild(s),i.appendChild(r),(o=this.mH.calendarYearSection).headerDiv=t,o.lastYearRangeButton=e,o.focusDateYearRangeName=s,o.nextYearRangeButton=r,t.appendChild(i),t},S.prototype.AH=function(){var t,i,t=L("table");return t.className=h+" "+T,(i=L("div")).appendChild(t),this.mH.calendarYearSection.currentYearRangeTable=t,this.IH(),i},S.prototype.IH=function(){for(var t,i,n,e,s,r,o,t=this.mH.calendarYearSection,i=L("tbody"),n=0;n<3;n++){for(e=L("tr"),s=0;s<4;s++)(r=L("td")).setAttribute(Ct,(4*n+s).toString()),(o=L("span")).classList.add(Mt),o.setAttribute(Ct,(4*n+s).toString()),o.innerText=(4*n+s+1).toString(),r.appendChild(o),e.appendChild(r),t.yearTds.push(r);i.appendChild(e)}t.currentYearRangeTable.appendChild(i)},S.prototype.CH=function(){var t=L("div");return t.classList.add(et),t.appendChild(this.xH()),t.appendChild(this.NH()),t},S.prototype.xH=function(){var t,i,n,e,s,s,r,o,o,t=L("div");return t.className=N+" "+j+" "+A,(i=L("div")).className=at+" "+A+" "+lt+" "+yt,(n=L("div")).classList.add(b),(e=L("button")).className=C+" "+y,e.title=f().Calendar_LastYear,e.setAttribute("type","button"),(s=L("div")).classList.add(d),e.appendChild(s),(s=L("span")).className=_+" "+b,(r=L("button")).className=C+" "+y,r.title=f().Calendar_NextYear,r.setAttribute("type","button"),(o=L("div")).classList.add(D),r.appendChild(o),i.appendChild(e),i.appendChild(s),i.appendChild(r),(o=this.mH.calendarMonthSection).headerDiv=t,o.lastYearButton=e,o.currentYearName=s,o.nextYearButton=r,t.appendChild(i),t},S.prototype.NH=function(){var t,i,t=L("table");return t.className=h+" "+T,(i=L("div")).appendChild(t),this.mH.calendarMonthSection.currentYearTable=t,this.kH(),i},S.prototype.kH=function(){for(var t,i,n,e,s,r,o,t=this.mH.calendarMonthSection,i=L("tbody"),n=0;n<3;n++){for(e=L("tr"),s=0;s<4;s++)(r=L("td")).setAttribute(zt,(4*n+s+1).toString()),(o=L("span")).classList.add(Mt),o.setAttribute(zt,(4*n+s+1).toString()),o.innerText=(4*n+s+1).toString(),r.appendChild(o),e.appendChild(r),t.monthTds.push(r);i.appendChild(e)}t.currentYearTable.appendChild(i)},S.prototype.SH=function(){var t=L("div");return t.classList.add(st),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),this.jS.nhe||t.appendChild(this.OH()),t},S.prototype._H=function(){var t,i,n,e,s,s,r,o,o,u,c,a,a,l,M,h,g,I,a,t=L("div");for(t.className=N+" "+j+" "+A,(i=L("div")).className=at+" "+A+" "+lt+" "+yt,(n=L("div")).classList.add(b),(e=L("button")).className=C+" "+y,e.title=f().Calendar_LastMonth,e.setAttribute("type","button"),(s=L("div")).classList.add(d),e.appendChild(s),(s=L("span")).className=_+" "+b,(r=L("button")).className=C+" "+y,r.title=f().Calendar_NextMonth,r.setAttribute("type","button"),(o=L("div")).classList.add(D),r.appendChild(o),i.appendChild(e),i.appendChild(s),i.appendChild(r),(o=L("div")).className=nt+" "+bt,(u=L("div")).classList.add(ot),(c=L("select")).classList.add(rt),a=new Date,l=(a=this.jS._data.Jmr(a.getFullYear()))[0],M=a[1],h=l;h<=M;h++)(g=L("option")).text=h.toString(),g.value=h.toString(),c.options.add(g);return(I=L("div")).classList.add(ot),u.appendChild(c),o.appendChild(u),t.appendChild(o),t.appendChild(i),(a=this.mH.calendarDaySection).headerDiv=t,a.lastMonthButton=e,a.currentMonthName=s,a.nextMonthButton=r,a.yearSelect=c,t},S.prototype.EH=function(){var t,i,n,e,s,r,o,t=L("div");for(t.className=F+" "+j+" "+A,(i=L("table")).className=h+" "+T,n=L("thead"),e=L("tr"),s=0;s<7;s++)(r=L("th")).setAttribute(pt,s.toString()),(o=L("span")).classList.add(ht),o.setAttribute(pt,s.toString()),o.innerText=this.jS._data.getShortWeekName(s),r.appendChild(o),e.appendChild(r),this.mH.calendarDaySection.weekThs.push(r);return n.appendChild(e),i.appendChild(n),t.appendChild(i),t},S.prototype.jH=function(){var t,i,n,e,s,r,o,u,c,a,t=this.mH.calendarDaySection,i=L("div"),n=L("div"),e=L("table");for(e.className=h+" "+T,s=L("tbody"),r=0;r<6;r++){for(o=L("tr"),u=0;u<7;u++)(c=L("td")).setAttribute(z,(7*r+u).toString()),(a=L("span")).classList.add(Mt),a.setAttribute(z,(7*r+u).toString()),c.appendChild(a),o.appendChild(c),t.dayTds.push(c);s.appendChild(o)}return e.appendChild(s),n.appendChild(e),i.appendChild(n),t.dayContentTable=e,i},S.prototype.OH=function(){var t,i,n,e,s,r,t=L("div");return t.classList.add(X),(i=L("table")).classList.add(h),n=L("tbody"),e=L("tr"),s=L("td"),(r=L("i")).className=gt+" "+jt,r.innerText=m.resource.today,s.appendChild(r),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.appendChild(i),this.mH.calendarDaySection.todayTd=s,this.mH.calendarDaySection.todayTable=i,t},S.prototype.bH=function(){var i,t,i=this,t=L("div");return t.className=H+" "+ut+" "+ct,t.tabIndex=0,this.mH.timeContainerDiv=t,this.RH=new G.TimePicker(t),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(u.BaseDropdown.Event_ValueChanged,function(t){i.BH(t)}),t},S.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},S.prototype.LH=function(){switch(this.jS._data.calendarPage){case a.CalendarPage.year:this.PH();break;case a.CalendarPage.month:this.GH();break;case a.CalendarPage.day:this.UH()}},S.prototype.jmr=function(t,i){var n,e,s,r,o,u,n,e=this.mH.calendarDaySection.yearSelect;for(e.innerHTML="",s=document.createDocumentFragment(),r=0;r<i-t+1;r++)o=t+r,(u=L("option")).text=o.toString(),u.value=o.toString(),s.appendChild(u);e.appendChild(s)},S.prototype.Dmr=function(){var t,i,n,e,n,i,s,i,r,t,o,r,i,u,t,i=this.jS._data,n=this.mH.calendarDaySection;n.currentMonthName.innerText=i.getCurrentMonthName(),e=i.focusDate.getFullYear(),n=n.yearSelect,s=(i=i.Jmr())[0],i=i[1],r=parseInt(n.options[0].value,10),t=parseInt(n.options[n.options.length-1].value,10),o=i-s+1,s===r&&i===t||this.jmr(s,i),r=s<=e&&e<=i,i=n.options.length!==o&&(null==(t=n.options[n.options.length-1])?void 0:t.value)===e.toString(),(u=r||i)?(n.selectedIndex=i?o:e-s,n.options[o]&&n.selectedIndex<=o-1&&n.options[o].remove()):((t=L("option")).text=e.toString(),t.value=e.toString(),n.options.add(t,o),n.selectedIndex=o)},S.prototype._mr=function(){var t,i,n,e,s,t,n,n,r,s,t,n,o,u,c,a,i,r,t=this.jS._data,i=this.mH.calendarDaySection;if(i.currentMonthName.innerText=t.getCurrentMonthName(),n=t.focusDate.getFullYear(),e=i.yearSelect,n=(s=t.focusDate.getMonth())>(t=t.Mmr(n))[0],i.lastMonthButton.disabled=!n,i.lastMonthButton.classList.toggle(g,!n),n=s<t[1],i.nextMonthButton.disabled=!n,i.nextMonthButton.classList.toggle(g,!n),this.jS.nhe&&(r=this.jS.parent).she&&r.che)if(s=i.lastMonthButton,t=i.nextMonthButton,n=this.jS.ehe,o=r.she._data.focusDate,u=r.che._data.focusDate,1===n){for(c=0;c<e.options.length;c++)a=parseInt(e.options[c].value,10),e.options[c].disabled=a>u.getFullYear()||a===u.getFullYear()&&0===u.getMonth();o.getFullYear()===u.getFullYear()?o.getMonth()>=u.getMonth()-1?(t.disabled=!0,t.classList.add(g)):(t.disabled=!1,t.classList.remove(g)):(i=o.getFullYear()+1===u.getFullYear()&&11===o.getMonth()&&0===u.getMonth(),t.disabled=i,t.classList.toggle(g,i))}else if(2===n){for(c=0;c<e.options.length;c++)(a=parseInt(e.options[c].value,10))<o.getFullYear()||a===o.getFullYear()&&11===o.getMonth()?e.options[c].disabled=!0:e.options[c].disabled=!1;o.getFullYear()===u.getFullYear()?u.getMonth()<=o.getMonth()+1?(s.disabled=!0,s.classList.add(g)):(s.disabled=!1,s.classList.remove(g)):(r=o.getFullYear()+1===u.getFullYear()&&11===o.getMonth()&&0===u.getMonth(),s.disabled=r,s.classList.toggle(g,r))}},S.prototype.HH=function(){this.Dmr(),this._mr()},S.prototype.PH=function(){var t,i,n,e,s,r,o,u,o,c,a,l,a,a,t=this.jS._data,i=this.mH.calendarYearSection;if(t.updateYearRange(),t.updateYearItems(),i.focusDateYearRangeName.innerText=t.focusDateYearRangeStart.toString()+" - "+t.focusDateYearRangeEnd.toString(),n=i.yearTds,0!==(e=t.yearItems).length){for(s=0;s<3;s++)for(r=0;r<4;r++)u=e[o=4*s+r],(c=(o=n[o]).querySelector("span")).innerText=u.getLabel(),u.disabled?o.classList.add(w):o.classList.remove(w),u.selected?o.classList.add(v):o.classList.remove(v),u.focused?c.classList.add(I):c.classList.remove(I);a=this.jS.$gr&&this.jS.$gr.getFullYear(),l=this.jS.qgr&&this.jS.qgr.getFullYear(),a=a>=t.focusDateYearRangeStart,i.lastYearRangeButton.disabled=a,i.lastYearRangeButton.classList.toggle(g,a),a=l<=t.focusDateYearRangeEnd,i.nextYearRangeButton.disabled=a,i.nextYearRangeButton.classList.toggle(g,a)}},S.prototype.GH=function(){var t,i,n,e,s,r,o,u,c,u,a,l,t,M,t,t,t=this.jS._data,i=this.mH.calendarMonthSection;for(t.updateMonthItems(),n=t.focusDate.getFullYear(),e=t.monthItems,s=i.monthTds,i.currentYearName.innerText=n.toString(),r=0;r<3;r++)for(o=0;o<4;o++)c=e[u=4*r+o],(a=(u=s[u]).querySelector("span")).innerText=c.getLabel(),l=c.disabled,u.classList.toggle(w,l),c.selected?u.classList.add(v):u.classList.remove(v),c.focused?a.classList.add(I):a.classList.remove(I);t=this.jS.$gr&&this.jS.$gr.getFullYear(),M=this.jS.qgr&&this.jS.qgr.getFullYear(),i.lastYearButton.disabled=t=n<=t,i.lastYearButton.classList.toggle(g,t),i.nextYearButton.disabled=t=M<=n,i.nextYearButton.classList.toggle(g,t)},S.prototype.UH=function(){this.HH(),this.zH()},Object.defineProperty(S.prototype,"RangeCalendar",{get:function(){return this.jS&&this.jS.parent},enumerable:!1,configurable:!0}),S.prototype.zH=function(){var t,i,n,e,s,r,o,r,u,t,c,c,t=this.jS._data;if(t.updateDayItems(),0!==(i=t.dayItems).length){for(n=this.mH.calendarDaySection.dayTds,e=0;e<6;e++)for(s=0;s<7;s++)o=i[r=7*e+s],(u=(r=n[r]).querySelector("span")).innerText=o.getLabel(),o.disabled?r.classList.add(w):r.classList.remove(w),o.focused?u.classList.add(I):u.classList.remove(I),o.selected?r.classList.add(v):r.classList.remove(v);(t=this.mH.calendarDaySection.todayTable)&&(c=(c=new Date)>this.jS.qgr||c<this.jS.$gr,t.style.display=c?"none":"")}},S.prototype.FH=function(){var t,i;this.RH.setValue(this.jS._data.selectedDate),(t=this.mH.okButton)&&(i=!this.jS._data.selectedDate,t.disabled=i,t.classList.toggle(g,i))},S.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},S.prototype.VH=function(){var i=this;this.mH.outerContainerDiv.addEventListener("keydown",function(t){i.YH(t)})},S.prototype.YH=function(t){"Tab"===t.key?(this.jS.HG&&(this.jS._data.calendarActivePart===p.Date?this.setCalendarActivePart(p.Time):this.setCalendarActivePart(p.Date)),t.preventDefault()):this.jS._data.calendarActivePart!==p.Date||this.jS.nhe||this.ZH(t)},S.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case a.CalendarPage.year:this.WH(t);break;case a.CalendarPage.month:this.QH(t);break;case a.CalendarPage.day:this.KH(t)}},S.prototype.WH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(a.CalendarPage.month);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:n.setFullYear(i.focusDateYearRangeStart);break;case 35:n.setFullYear(i.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}i.updateYearRange(),this.LH()},S.prototype.QH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(a.CalendarPage.day);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},S.prototype.KH=function(t){var i,n,e,s,r,o,i=this.jS._data,n=i.focusDate,e=n.getFullYear(),s=n.getMonth(),r=n.getDate(),o=x.getMonthMaxDay(e,s+1);switch(t.keyCode){case 13:return i.selectedDate=new Date(n.valueOf()),void this.oz();case 32:i.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(r-1);break;case 39:n.setDate(r+1);break;case 38:n.setDate(r-7);break;case 40:n.setDate(r+7);break;case 36:n.setDate(1);break;case 35:n.setDate(o);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}i.selectedDate=new Date(n.valueOf()),this.updateCalendarDom()},S.prototype.attachDateEvent=function(){var i=this;this.mH.dateContainerDiv.addEventListener("click",function(t){var t=t.target;t&&(t===i.mH.calendarDaySection.yearSelect||t.parentElement===i.mH.calendarDaySection.yearSelect)||i.setCalendarActivePart(p.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},S.prototype.attachYearEvent=function(){var i=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){i.$H(),i.LH()}),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){i.tz(),i.LH()}),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){i.az(t)})},S.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},S.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},S.prototype.qH=function(){this.showCalendarPage(a.CalendarPage.month)},S.prototype.az=function(t){var t,t,i,t,n,e,e,t=t.srcElement||t.target;t&&(t=+t.getAttribute(Ct),t=(i=this.jS._data.yearItems)[t],n=this.jS.qgr&&this.jS.qgr.getFullYear(),e=this.jS.$gr&&this.jS.$gr.getFullYear(),e=t.year<e||t.year>n,0===i.length||e||(this.jS._data.focusDate.setFullYear(t.year),this.qH()))},S.prototype.attachMonthEvent=function(){var i=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",function(t){i.JH(),i.LH()}),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",function(t){i.XH(),i.LH()}),this.jS.nhe||this.mH.calendarMonthSection.currentYearName.addEventListener("click",function(t){i.iz()}),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",function(t){i.uz(t)})},S.prototype.JH=function(t){var t,t,t=t||1,t=Math.max(this.jS._data.focusDate.getFullYear()-t,0);this.jS._data.focusDate.setFullYear(t)},S.prototype.XH=function(t){var t,t,t=t||1,t=Math.min(this.jS._data.focusDate.getFullYear()+t,9999);this.jS._data.focusDate.setFullYear(t)},S.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(a.CalendarPage.year)},S.prototype.rz=function(){this.showCalendarPage(a.CalendarPage.day)},S.prototype.uz=function(t){var t,i,n,t=t.srcElement||t.target;!t||(i=+t.getAttribute(zt),n=t.classList.contains(w)||"TD"===t.parentElement.tagName&&+t.parentElement.classList.contains(w))||(this.jS._data.focusDate.setMonth(i-1),this.rz())},S.prototype.attachDayEvent=function(){var i,t,i=this,t=this.mH.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){i.nz(),i.hH||(i.jS.nhe?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.nextMonthButton.addEventListener("click",function(t){i.ez(),i.hH||(i.jS.nhe?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.todayTable&&t.todayTable.addEventListener("click",function(t){i.fz()}),this.jS.nhe?t.dayContentTable.addEventListener("mouseover",function(t){i.ahe(t)}):t.currentMonthName.addEventListener("click",function(t){i.cz()}),t.dayContentTable.addEventListener("click",function(t){i.jS.nhe?i.uhe(t):i.lz(t)}),t.yearSelect.addEventListener("change",function(t){i.hz(t)}),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},S.prototype.nz=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()-t,e=i.focusDate.getDate();t<0&&(t+=12,--n),s=x.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s)),i.focusDate=n},S.prototype.ez=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()+t,e=i.focusDate.getDate();11<t&&(t-=12,n+=1),s=x.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s),i.focusDate.getHours(),i.focusDate.getMinutes(),i.focusDate.getSeconds()),i.focusDate=n},S.prototype.cz=function(){this.showCalendarPage(a.CalendarPage.month)},S.prototype.lz=function(t){var i,t,t,n,e,n,t,t,i=this.jS._data,t=t.srcElement||t.target;if(t){if(t=t.getAttribute(z),l(t))return;if(0===(n=i.dayItems).length)return;if((n=(e=n[+t]).date)<this.jS.$gr||n>this.jS.qgr)return;t=(t=i.selectedDate)?new Date(t.valueOf()):new Date,i.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.updateCalendarDom(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},S.prototype.uhe=function(t){var i,n,t,t,e,e,t,e,i,s,s,s,i,n,e,n=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),l(t)||0===(e=n.dayItems).length||(t=(e=e[+t]).date)<this.jS.$gr||t>this.jS.qgr||(e=e.disabled,s=(i=r({},null!=(i=n.the)?i:n.Ggr))?new Date(i.start.valueOf()):x.getDefaultDate(),0===this.RangeCalendar.ihe?(i.start=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),i.end=i.start,this.RangeCalendar.ihe++):1===this.RangeCalendar.ihe&&(s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),i.start<=s?(i.end=s,this.RangeCalendar.ihe=0):(i.end=i.start=s,this.RangeCalendar.ihe=1)),n.the=i,n.updateCalendarData(),e&&(s=this.jS._data.focusDate,i=this.jS.parent,n=x.getFirstDayOfMonth(t),1===this.jS.ehe?s<t?i.che._data.focusDate=n:t<this.jS._data.focusDate&&(this.jS._data.focusDate=n):2===this.jS.ehe&&(e=i.she,s<t?(e._data.focusDate=x.getPreviousMonth(t),this.jS._data.focusDate=n):t<this.jS._data.focusDate&&(e._data.focusDate=n))),this.RangeCalendar.updateRangeCalendarDom()))},S.prototype.ahe=function(t){var t,i,t,t,n,e,n,t,s,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),l(t)||0!==(n=i.dayItems).length&&(n=(e=n[+t]).date,t=null!=(t=i.the)?t:i.Ggr,i.ohe=null,t.start&&1===this.RangeCalendar.ihe&&(s=t?new Date(t.start.valueOf()):x.getDefaultDate(),(n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()))>t.start)&&(i.ohe=n),i.updateCalendarData(),this.RangeCalendar.updateRangeCalendarDom()))},S.prototype.fz=function(){var t,i,i,n,t=this.jS,i=t._data.selectedDate,i=i?new Date(i.valueOf()):null,n=new Date;i&&(n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),n.setSeconds(0)),t._data.selectedDate=n,t._data.focusDate=new Date(n.valueOf()),this.updateCalendarDom(),t.HG||this.oz()},S.prototype.hz=function(t){var t,i,n,e,s,t=t.srcElement||t.target;t&&(i=+t.value,n=this.jS.$gr,e=this.jS.qgr,s=this.jS._data.focusDate,i===(n&&n.getFullYear())&&n.getMonth()>s.getMonth()?(this.jS._data.focusDate.setFullYear(+t.value),this.jS._data.focusDate.setMonth(n.getMonth())):i===(e&&e.getFullYear())&&e.getMonth()<s.getMonth()?(this.jS._data.focusDate.setFullYear(+t.value),this.jS._data.focusDate.setMonth(e.getMonth())):this.jS._data.focusDate.setFullYear(+t.value),this.jS.nhe?(this.RangeCalendar.checkFocusDateValid(),this.RangeCalendar.updateRangeCalendarDom()):this.LH())},S.prototype.attachTimeEvent=function(){var i=this;this.mH.timeContainerDiv.addEventListener("click",function(t){i.setCalendarActivePart(p.Time)}),this.mH.okButton.addEventListener("click",function(t){i.oz()})},S.prototype.BH=function(t){var i,n,t,i=this.jS._data,n=i.selectedDate?new Date(i.selectedDate.valueOf()):new Date,t=t.value;n.setHours(t.getHours()),n.setMinutes(t.getMinutes()),n.setSeconds(t.getSeconds()),i.selectedDate=n,i.focusDate=new Date(n.valueOf())},S.prototype.oz=function(){var t=this.jS._data;this.fire(u.BaseDropdown.Event_ValueChanged,{value:t.selectedDate})},S.prototype.showCalendarPage=function(t){var i,n,e,i=this.host.querySelector("."+it),n=this.host.querySelector("."+et),e=this.host.querySelector("."+st);switch(i.style.display="none",n.style.display="none",e.style.display="none",t){case a.CalendarPage.year:i.style.display="";break;case a.CalendarPage.month:n.style.display="";break;case a.CalendarPage.day:e.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},S.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(e),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(e),t){case p.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(e),this.mH.outerContainerDiv.focus();break;case p.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(e),this.mH.outerContainerDiv.focus()}},S.Event_GetHost="GetHost",Qt=S,Ht=u.BaseDropdown,i(k,Ht),k.prototype.setOptions=function(t){var i,n,e,s,s,s,e;t&&(i=t.minDate,n=t.maxDate,i&&(0,o.isValidDate)(i)&&(this.$gr=new Date(i.getFullYear(),i.getMonth(),i.getDate())),n&&(0,o.isValidDate)(n)&&(this.qgr=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999)),n&&i&&n<i&&(this.$gr=void 0,this.qgr=void 0),(0,o.isValidDate)(t.defaultDateTime)&&!this.isDateOrDateRangeOutOfRange(t.defaultDateTime)?this.Ugr=t.defaultDateTime:(0,o.isValidDateRange)(t.defaultDateTime)&&!this.isDateOrDateRangeOutOfRange(t.defaultDateTime)?this.Ugr=t.defaultDateTime[this.ehe&&1!==this.ehe?"end":"start"]:this.nhe?(e=this._data.Ggr,this.isDateOrDateRangeOutOfRange(e)?(s=new Date(null!=i?i:n),this._data.selectedDate=null,this._data.focusDate=1===this.ehe?s:x.getNextMonth(s),this._data.the=null,this.parent.the=null):(s=e.start,this._data.focusDate=1===this.ehe?s:x.getNextMonth(s),this._data.the=e,this.parent.the=e)):!this.nhe&&this.isDateOrDateRangeOutOfRange(this._data.selectedDate)&&(this._data.selectedDate=null,this._data.focusDate=new Date(null!=i?i:n)),t.showTime||this.nhe||(this.HG=t.showTime,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),s=t&&t.calendarPage?t.calendarPage:a.CalendarPage.day,(e=t&&t.startDay?t.startDay:a.CalendarStartDay.saturday)!==this.dH&&(this.dH=e,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),this.Dn.showCalendarPage(s),this.Dn.setCalendarActivePart(p.Date))},k.prototype.setValue=function(t,i){var n,e,t,n=this._data,e=null!=t?t:this.Ugr;e&&(t&&this.isDateOrDateRangeOutOfRange(t)?e=null:this.Ugr&&this.isDateOrDateRangeOutOfRange(t)&&(e=this.nhe?n.the:n.selectedDate),this.nhe?(t=e,n.the=t&&{start:t.start,end:t.end},n.updateCalendarData(void 0,i),n.updateDayFocusDate()):this.nhe||(n.selectedDate=e,n.updateDayFocusDate(),n.updateYearRange()))},k.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},k.prototype.isDateOrDateRangeOutOfRange=function(t){var i;return(0,o.isValidDate)(t)?t<this.$gr||t>this.qgr:!!(0,o.isValidDateRange)(t)&&(t.start<this.$gr||t.end>this.qgr)},Yt=k,o.Calendar=Yt,Vt=u.BaseDropdown,i(E,Vt),E.prototype.Hgr=function(t){return(0,o.isValidDate)(t)?{start:t,end:t}:(0,o.isValidDateRange)(t)?t:null},E.prototype.pkr=function(t){var i={showTime:!1,calendarPage:a.CalendarPage.day};return l(t.showBuiltInDateRange)&&(i.showBuiltInDateRange=!0),r(r({},t),i)},E.prototype.setOptions=function(t){var t=this.pkr(t);this.she.setOptions(t),this.che.setOptions(t)},E.prototype.setValue=function(t){var i,t,i=!1,t=t;t||(t=this.the,i=!0),this.she.setValue(t,i),this.che.setValue(t,i),this.updateRangeCalendarDom()},E.prototype.updateRangeCalendarDom=function(){var t,i,t;this.she.Dn.updateCalendarDom(),this.che.Dn.updateCalendarDom(),i=this.she._data.Ggr,t=null!=(t=this.the)?t:this.she.isDateOrDateRangeOutOfRange(i)?null:i,this.updateDataRangeResult(t)},E.prototype.fhe=function(){var t,e,t=x.getBuiltInDateRanges(),e=L("div");return e.className=M+" "+ft,t.forEach(function(t,i){var n,i,n=L("div");n.className=It,n.setAttribute(mt,i+""),i=B.createTextNode(t[0]),n.appendChild(i),e.appendChild(n)}),this.lhe=e},E.prototype.rhe=function(t){var i,n,n;this.Ti.innerHTML="",(i=L("div")).className=M+" "+Y,t&&!1===t.showBuiltInDateRange||i.appendChild(this.fhe()),(n=L("div")).classList.add(Q),this.she=new Yt(n,t,this,1),i.appendChild(n),(n=L("div")).classList.add(Q),this.che=new Yt(n,t,this,2),i.appendChild(n),this.Ti.appendChild(i),this.Ti.appendChild(this.hhe())},E.prototype.aY=function(){var i=this;this.lhe&&this.lhe.addEventListener("click",function(t){i.dhe(t)}),this.vhe.addEventListener("click",function(t){i.onOkButtonClick(t)}),this.mhe.addEventListener("click",function(t){i.onCancelButtonClick(t)}),this.on(Qt.Event_GetHost,function(t){t.host=i.Ti})},E.prototype.hhe=function(){var t,i,i,n,i,n,t=L("div");return t.className=Nt,(i=L("div")).classList.add(wt),t.appendChild(i),this.ghe=i,this.updateDataRangeResult(this.the),(i=L("div")).className=vt,(n=L("button")).textContent=f().Cancel,n.className=dt,i.appendChild(n),t.appendChild(i),this.mhe=n,(i=L("div")).className=vt,(n=L("button")).textContent=f().OK,n.className=dt,i.appendChild(n),t.appendChild(i),this.vhe=n,t},E.prototype.dhe=function(t){var t,t,i,t,t=t.srcElement||t.target;t&&(t=t.getAttribute(mt),l(t)||(t=(i=x.getBuiltInDateRanges())[t],this.isDateRangeAllowed(t[1])&&(this.the={start:t[1].start,end:t[1].end},this.notifyCalendarData(),this.fire(u.BaseDropdown.Event_ValueChanged,{text:x.getShortDate(this.the)}))))},E.prototype.updateDataRangeResult=function(t){var i,n,e,s,r,r;if(t&&(0,o.isValidDateRange)(t)&&(this.ghe.innerHTML="".concat(t.start.toLocaleDateString("en-US"),"-").concat(t.end.toLocaleDateString("en-US"))),this.lhe){for(i=x.getBuiltInDateRanges(),n=!0,e=0;e<this.lhe.children.length;e++)s=this.lhe.children[e],r=parseInt(s.getAttribute(mt),10),s.className=It,r=i[r]&&i[r][1],x.dateEqual(r.start,null==t?void 0:t.start)&&x.dateEqual(r.end,null==t?void 0:t.end)&&(s.className=It+" "+Dt),this.isDateRangeAllowed(r)?(n=!1,s.classList.remove(w)):s.classList.add(w);this.lhe.style.display=n?"none":""}this.vhe&&(this.vhe.disabled=!(0,o.isValidDateRange)(t),this.vhe.classList.toggle(g,!(0,o.isValidDateRange)(t)))},E.prototype.onOkButtonClick=function(t){this.fire(u.BaseDropdown.Event_ValueChanged,{text:x.getShortDate(this.the)})},E.prototype.onCancelButtonClick=function(t){this.fire(u.BaseDropdown.Event_ValueChanged,{notSubmit:!0})},E.prototype.isDateRangeAllowed=function(t){var i=t.start,t=t.end;return(!this.she.$gr||i>=this.she.$gr)&&(!this.she.qgr||t<=this.che.qgr)&&i<=t},E.prototype.checkFocusDateValid=function(){var t,i,t,t=this.she._data.focusDate,i;this.che._data.focusDate<=t&&(t=x.getNextMonth(t),this.che._data.focusDate=t)},E.prototype.notifyCalendarData=function(t){t?(this.the=t.selectedDateRange,this.ohe=t.hoverDate):t={selectedDateRange:this.the,hoverDate:this.ohe},this.she&&this.she._data.updateCalendarData(t),this.che&&this.che._data.updateCalendarData(t)},o.RangeCalendar=E},"./dist/plugins/celltype/editor/colorpicker.js":function(t,i,n){"use strict";var e,s,r,o,u,n,c,l,n,a,M,h,g;function I(t,i){var t=g.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(h=function(t,i){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.ColorPicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),r=n("Core"),o=n("./dist/plugins/celltype/editor/baseControl.js"),u=n("./dist/plugins/celltype/celltypes.ns.js"),n=n("Common"),c=n.Common.lt.ht,l="group-name",n=new n.Common.ResourceManager(u.SR,"CellTypes"),a=n.getResource.bind(n),g=o.BaseDropdown,e(I,g),I.prototype.setOptions=function(t){var i;t&&(this.options=this.options||{},c(t.colorBlockSize)||(i=parseInt(t.colorBlockSize,10),!isNaN(i)&&0<=i&&(this.options.colorBlockSize=t.colorBlockSize)),c(t.groups)||(this.options.groups=t.groups)),this._6()},I.prototype.setValue=function(t){c(t)||(this.vz=t,this.mz=null,this._6())},I.prototype.Hc=function(){for(var i,t,n,e,i=this,t=I.DefaultColorGroup(),n=[],e=0;e<t.length;e++)n.push({name:t[e].name,colors:t[e].colors,needScaleColor:t[e].needScaleColor});this.options={colorBlockSize:I.DefaultCellWidth,groups:n},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},I.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.bz()),this.yz()},I.prototype.yz=function(){var t,i,n,e,t=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=t[i].getAttribute("color"),e=t[i].getAttribute(l),this.vz===n&&(!this.mz||this.mz&&this.mz===e)&&t[i].classList.add("selected")},I.prototype.wz=function(){for(var t,i,n,e,s,r,t=0,i=this.options.groups,n=0;n<i.length;n++)for(e=i[n],s=0;s<e.colors.length;s++)r=e.colors[s],t=Math.max(t,r.length);return t},I.prototype.bz=function(){for(var t,i,n,e,s,r,r,t=[],i=this.options.colorBlockSize||I.DefaultCellWidth,n=this.wz(),e=this.options.groups,s=0;s<e.length;s++)r=this.Mz(e[s],i,n),t.push(r),e[s].needScaleColor&&(r=this.Cz(e[s].colors[0]),t.push(this.Mz(r,i,n)));return{items:t}},I.prototype.Cz=function(t){var i,n,e,s,r,o,u,c,a,l,M,h,g,I,f,N,i={},n=[],s=[-(e=n.length=5),-15,-25,-35,-50],r=[-10,-25,-50,-75,-90],o=[80,60,40,-25,-50],u=document.createElement("span"),c=t.length;u.style.display="none",document.body.appendChild(u);try{for(a=0;a<c;a++)for(M=(l=this.Sz(t[a],u))[0],h=l[1],g=l[2],I=this.Tz(M,h,g),f=0;f<5;f++)n[f]||((N=[]).length=c,n[f]=N),n[f][a]=1===I?this.Az(M,h,g,s[f]):.8<=I?this.Az(M,h,g,r[f]):0===I?this.Az(M,h,g,Math.abs(s[5-f-1])):I<=.2?this.Az(M,h,g,Math.abs(r[5-f-1])):this.Az(M,h,g,o[f]);i.colors=n}finally{document.body.removeChild(u)}return i},I.prototype.Sz=function(t,i){var n,e,s,r,t;return i.style.color=t,t=(r=window.getComputedStyle(i).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[n=parseInt(t[0],10),e=parseInt(t[1],10),s=parseInt(t[2],10)]},I.prototype.Az=function(t,i,n,e){var t,i,n;return e/=100,t=this.Iz(t,i,n),i=parseInt((0<e?(240-t.luminosity)*e:t.luminosity*e).toString(),10),n=this.xz(t.hue,t.luminosity+i,t.saturation),this.Nz(n.r,n.g,n.b)},I.prototype.kz=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},I.prototype.Nz=function(t,i,n){return"#"+this.kz(t)+this.kz(i)+this.kz(n)},I.prototype.xz=function(t,i,n){var e,s,r,o,u;return 0===n?e=s=r=parseInt((255*i/240).toString(),10):(u=o=void 0,o=2*i-(u=i<=120?(i*(240+n)+120)/240:i+n-(i*n+120)/240),e=parseInt(((255*this.Dz(o,u,t+80)+120)/240).toString(),10),s=parseInt(((255*this.Dz(o,u,t)+120)/240).toString(),10),r=parseInt(((255*this.Dz(o,u,t-80)+120)/240).toString(),10)),{a:255,r:e,g:s,b:r}},I.prototype.Dz=function(t,i,n){return n<0&&(n+=240),240<n&&(n-=240),n<40?t+((i-t)*n+20)/40:n<120?i:n<160?t+((i-t)*(160-n)+20)/40:t},I.prototype.Tz=function(t,i,n){var e;return this.Iz(t,i,n).luminosity/240},I.prototype.Iz=function(t,i,n){var e,s,r,o,u,c,u,c,a,n,o=Math.max(Math.max(t,i),n),u=Math.min(Math.min(t,i),n),c=o+u,e=parseInt(((240*c+255)/510).toString(),10),u=o-u;return 0==u?(s=0,r=160):(s=e<=120?parseInt(((240*u+c/2)/c).toString(),10):parseInt(((240*u+(510-c)/2)/(510-c)).toString(),10),c=(40*(o-t)+u/2)/u,a=(40*(o-i)+u/2)/u,n=(40*(o-n)+u/2)/u,(r=t===o?parseInt((n-a).toString(),10):i===o?parseInt((80+c-n).toString(),10):parseInt((160+a-c).toString(),10))<0&&(r+=240),240<r&&(r-=240)),{luminosity:e,saturation:s,hue:r}},I.prototype.Mz=function(o,u,c){var a,t,a=this,t={items:function(){var t,i,n,e,s,r,t=document.createElement("div");for(t.classList.add("gc-color-picker-group-row"),t.style.width=(u+7)*c+"px",i=0;i<o.colors.length;i++){for((n=document.createElement("div")).classList.add("gc-color-picker-color-row"),e=o.colors[i],s=0;s<e.length;s++)(r=document.createElement("div")).setAttribute(l,o.name),r.setAttribute("color",e[s]),r.style.backgroundColor=e[s],r.style.width=u+"px",r.style.height=u+"px",r.classList.add("gc-color-picker-color-cell"),a.vz===e[s]&&a.mz===o.name&&r.classList.add("selected"),n.appendChild(r);t.appendChild(n)}return t},layout:{direction:r.LayoutDirection.horizontal,displayAs:r.LayoutDisplayAs.inline}};return o.name&&(t.text=o.name),t},I.prototype.pz=function(t){var t,i,t,t=t.srcElement||t.target;t&&(i=t.getAttribute("color"),t=t.getAttribute(l),i)&&t&&(this.vz=i,this.mz=t,this._z(i),this.yz())},I.prototype._z=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{value:t,text:t})},I.DefaultCellWidth=10,I.DefaultColorGroup=function(){return[{name:a().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:a().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},i.ColorPicker=I},"./dist/plugins/celltype/editor/eventbase.js":function(t,i){"use strict";var n;function e(){this.Ez={}}Object.defineProperty(i,"__esModule",{value:!0}),i.EventBase=void 0,e.prototype.on=function(t,i){var n=this.Ez[t];(n=null==n?this.Ez[t]=[]:n).push(i)},e.prototype.off=function(t,i){var n,i;t?null!=(n=this.Ez[t])&&(i?(i=n.indexOf(i),n.splice(i,1)):n=[],this.Ez[t]=n):this.Ez={}},e.prototype.fire=function(t,i){var n,t,n=this,t=this.Ez[t];null!=t&&t.forEach(function(t){try{t.call(n,i)}catch(t){}})},i.EventBase=e},"./dist/plugins/celltype/editor/listControl.js":function(U,t,i){"use strict";var n,u,c,r,M,h,o,e,s,a,l,g,I,f,N,d,D,v,w,j,b,y,T,A,C,z,p,Z,G,m,B,x,L;function O(t){return e.createElement(t)}function Q(t,i){return t.substring(0,i)+t.substring(i+1,t.length)}function Y(t,i){if(r.Common.Uf.OS(t,i))return 1;if(r.Common.ct.W0(i))for(var n=0;n<t.length;n++)if(t[n]-i==0)return 1}function R(t,i){for(var n,e,n=r.Common.ct.W0(i),e=t.length-1;0<=e;e--)(t[e]===i||n&&t[e]-i==0)&&t.splice(e,1)}function P(t){var i,n,e,s,r;if(h(t)||0===t.length)return[];for(i=[],e=n=0;e<t.length;e++)"\\"===(s=t.charAt(e))?","!==(r=t.charAt(e+1))&&"\\"!==r||(t=Q(t,e)):","===s&&(i.push(t.substring(n,e)),n=e+1);return i.push(t.substring(n,t.length)),i}function W(t){for(var i,n,e,i=[],n=0;n<t.length;n++)(e=t[n])&&"string"==typeof e&&(e=e.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),i[n]=e;return i.join(",")}function S(){this.jz=new WeakMap}function k(t,i,n){var e=L.call(this,t)||this;return e.Ti=O("div"),e.Ti.classList.add(a),t.appendChild(e.Ti),e.cE=new s,e.Oz=n&&n.Oz||{y4:void 0},e.Rz={items:[],doms:[]},e.setOptions(i),e}function E(t){if(t.hasOwnProperty("items"))E(t.items);else if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i].hasOwnProperty("items")?E(t[i]):t[i].hasOwnProperty("text")&&!t[i].hasOwnProperty("value")&&(t[i].value=t[i].text);return t}n=this&&this.__extends||(x=function(t,i){return(x=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}x(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0,u=i("./dist/plugins/celltype/editor/popupControl.js"),c=i("./dist/plugins/celltype/editor/baseControl.js"),r=i("Common"),M=i("Core"),h=r.Common.lt.ht,o=r.Common.Uf.hD,e=document,S.prototype.set=function(t,i,n){var e=this.jz.get(t);e||this.jz.set(t,e={}),e[i]=n},S.prototype.get=function(t,i){var t=this.jz.get(t);return t&&t[i]},S.prototype.clear=function(){this.jz=new WeakMap},s=S,a="gc-list-control",l="gc-list-control-container",g="gc-list-control-group",I="gc-list-control-group-text",f="gc-list-control-item",N="gc-list-control-hassubitem",d="gc-list-control-selected-item",D="gc-list-control-item-text",v="gc-list-control-item-text-ellipsis",w="gc-list-control-item-ellipsis",j="gc-list-control-item-icon",b="gc-list-control-emptyicon",y="gc-list-control-subitem",T="gc-list-alignment-horizontal",A="gc-list-alignment-vertical",C="gc-list-control-noitem",z="gc-list-control-listseparator",p="hide-children",Z="gc-list-control-tree",G="gc-list-control-tree-text",m="gc-list-control-tree-content",L=c.BaseDropdown,n(k,L),k.prototype.setOptions=function(t){h(t)||(this.MU=E(t),this.Ti.innerHTML="",this.Dn())},k.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=P(t);else if(h(t))t=[];else if(r.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var i=0;i<t.length;i++)t[i]=""+t[i]}}else t=[t];this.Oz.y4=t,this.Bz()},k.prototype.scrollToSelect=function(){},k.prototype.updateStyle=function(t,i,n){this.Ti.style.font=n},k.prototype.Dn=function(){var t=O("div");t.classList.add(l),this.MU.Oue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},k.prototype.Lz=function(t,i){var n;i&&(this.Pz(t,i.layout),i.items)&&(Array.isArray(i.items)?this.Gz(t,i.items):(n=i.items())instanceof HTMLElement&&(t.appendChild(n),t.classList.add(f),this.Pz(n,i.layout)))},k.prototype.Pz=function(t,i){i&&i.direction===M.LayoutDirection.horizontal?t.classList.add(T):t.classList.add(A)},k.prototype.Gz=function(t,i){for(var n,e,s,r,o,u,c,r,a,l,l,n=i.some(function(t){return!!t.icon}),e=0;e<i.length;e++)i[e].items?(s=i[e]).layout&&s.layout.displayAs===M.LayoutDisplayAs.inline?((r=O("div")).classList.add(g),(o=O("span")).innerText=s.text,!h(s.text)&&""!==s.text||o.classList.add(p),o.classList.add(I),r.appendChild(o),Array.isArray(s.items)?this.Lz(r,s):(u=s.items())instanceof HTMLElement&&((c=O("div")).classList.add(f),this.Pz(u,s.layout),c.appendChild(u),r.appendChild(c)),t.appendChild(r)):s.layout&&s.layout.displayAs===M.LayoutDisplayAs.tree?((r=O("div")).classList.add(Z),(a=O("div")).classList.add(f),a.classList.add(N),(o=O("span")).innerText=s.text,o.classList.add(G),a.appendChild(o),s.layout.collapsible&&((l=O("span")).classList.add(y),a.appendChild(l),this.Uz(a)),r.appendChild(a),(l=O("div")).classList.add(m),Array.isArray(s.items)?this.Lz(l,s):(u=s.items())instanceof HTMLElement&&((c=O("div")).classList.add(f),this.Pz(u,s.layout),c.appendChild(u),l.appendChild(c)),r.appendChild(l),t.appendChild(r)):this.Hz(t,i[e],!1,!0):this.Hz(t,i[e],n)},k.prototype.Hz=function(t,i,n,e){var s,r,r,n,r,n,r,n,r;void 0===e&&(e=!1),(s=O("div")).classList.add(f),this.MU.textEllipsis&&s.classList.add(w),"-"===i.text?(s.classList.add(C),(r=O("div")).classList.add(z),s.appendChild(r)):(n&&((r=O("div")).classList.add(j),i.icon?r.style.backgroundImage="url(".concat(i.icon,")"):r.classList.add(b),s.appendChild(r)),(n=O("span")).classList.add(D),this.MU.textEllipsis&&n.classList.add(v),r=i.text,h(i.text)&&(r=h(i.value)?"":i.value),n.innerText=r,s.appendChild(n),s.setAttribute("text",r),n=h(i.value)?null:i.value,(r=o(this.Rz.items,n))<0&&(r=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(n)),this.Rz.doms[r].push(s),this.cE.set(s,"items",i),e&&((n=O("span")).classList.add(y),s.classList.add(N),this.cE.set(s,"sub-items",i),s.appendChild(n),this.zz(s))),this.MU.Oue&&(s.setAttribute("role","option"),s.setAttribute("tabindex","0"),r=i.text||i.value,h(r)||s.setAttribute("aria-label",r)),t.appendChild(s)},k.prototype.qj=function(t,i){var n,e,n=this.Rz.doms[t];if(i)for(e=0;e<n.length;e++)n[e].classList.contains(N)||n[e].classList.add(d);else for(e=0;e<n.length;e++)n[e].classList.contains(d)&&n[e].classList.remove(d)},k.prototype.Bz=function(){for(var t,i,n,e,s,r,i=this,n=i.MU,t=h(i.formula)?n&&n.multiSelect?e=i.Oz.y4:[i.Oz.y4]:["="+i.formula],s=0;s<i.Rz.items.length;s++)r=i.Rz.items[s],Y(t,r=n&&n.multiSelect&&1!==n.valueType?""+r:r)?i.qj(s,!0):i.qj(s,!1)},k.prototype.Fz=function(){var s=this;this.Ti.querySelector("."+l).addEventListener("click",function(t){var i,i,n,t,i,e,i=s.Vz(t.target,".".concat(f));i&&(i.classList.contains(N)?s.Yz(t):(i=s.cE.get(i,"items"),n=s.MU,!i&&r.Common.lt.Eh(n&&n.onItemSelected)&&(i={value:n.onItemSelected(t)}),h(i)||(t=i.value,i=i.path,n&&n.multiSelect&&(Y(e=(e=s.Oz.y4).slice(0),t=n.multiSelect&&1!==n.valueType?""+t:t)?R(e,t):r.Common.Uf.ZP(e,t),s.Oz.y4=t=e,s.Bz(),1!==n.valueType)&&(t=W(t)),s.fire(c.BaseDropdown.Event_ValueChanged,{path:i,value:t,text:t,notCloseDropDown:n&&n.multiSelect,noAutoFormat:!0}))))})},k.prototype.Vz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},k.prototype.Yz=function(t){var i,n,e,s,r,r,o,i=this,n=this.Vz(t.target,".".concat(f));n.classList.contains(N)&&(e=this.cE.get(n,"sub-items"))&&e.items&&(s=O("div"),r=this.MU,e.multiSelect=r&&r.multiSelect,e.valueType=r&&r.valueType,e.onItemSelected=r&&r.onItemSelected,(r=new k(s,e,this)).Bz(),(o=new u.PopupControl(s,n,{align:M.DropDownAlignment.Near,hostElement:n,direction:M.DropDownDirection.Right})).open(),r.on(c.BaseDropdown.Event_ValueChanged,function(t){i.fire(c.BaseDropdown.Event_ValueChanged,t),i.MU&&i.MU.multiSelect?i.Bz():o.close()}),this.cE.set(n,"sub-items-popup",o),t.stopPropagation(),t.preventDefault())},k.prototype.zz=function(t){var n=this;t.addEventListener("mouseenter",function(t){n.Yz(t)}),t.addEventListener("mouseleave",function(t){var t,i,t=t.target;t.classList.contains(N)&&(i=n.cE.get(t,"sub-items-popup"))&&(i.close(),n.cE.set(t,"sub-items-pop",void 0))})},k.prototype.Uz=function(t){var e=this;t.addEventListener("click",function(t){var i,i,n,i=t.target,i=e.Vz(i,".".concat(N));i&&(n=i.parentElement.querySelector("."+m))&&(i.parentElement.classList.contains(p)?i.parentElement.classList.remove(p):i.parentElement.classList.add(p),t.stopPropagation(),t.preventDefault())})},t.List=k},"./dist/plugins/celltype/editor/monthPicker.js":function(t,i,n){"use strict";var e,u,s,c,r,n,a,o,l,M,h,g,I,f,N,d,D,v;function w(t){return o.createElement(t)}function j(t,i){var t=v.call(this,t)||this;return t.setOptions(i),t.Fz(),t}e=this&&this.__extends||(D=function(t,i){return(D=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}D(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MonthPicker=void 0,u=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),c=n("Common"),r=c.Common.lt.ht,n=new c.Common.ResourceManager(s.SR,"CellTypes"),a=n.getResource.bind(n),o=document,l="gc-month-picker-separator",M="gc-month-picker-year-item",h="gc-month-picker-month-item",g="gc-month-picker-qtr-item",I="selected",f="data-month",N="data-qtr",v=u.BaseDropdown,e(j,v),j.prototype.setOptions=function(t){var i,n,n,e,e,e,i=this,n=new Date,n={startYear:n.getFullYear()-10,stopYear:n.getFullYear(),height:300};t&&(r(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e))||(n.startYear=e),!r(t.stopYear)&&0<t.stopYear&&(e=parseInt(t.stopYear,10),isNaN(e)||(n.stopYear=e)),n.stopYear<n.startYear&&(n.stopYear=t.startYear),r(t.height)||(e=parseInt(t.height,10),isNaN(e))||(n.height=e)),n.height=Math.max(1,n.height),i.MU=n,i.Ti.innerHTML="",i.Zz()},j.prototype.setValue=function(t){var i,n,e,s,t,r,i=this;t&&(n=t.getMonth()+1,e=t.getFullYear()),this.MU.startYear&&this.MU.stopYear&&this.MU.startYear<this.MU.stopYear&&e>this.MU.stopYear&&(e=this.MU.stopYear),"number"==typeof n&&(t=i.Ti.querySelector("[".concat(f,"='").concat(e,"-").concat(n,"']")))&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),i.Wz=t)},j.prototype.scrollToSelect=function(){var t,t,t=this.Wz;t&&(t=t.offsetTop,this.Ti.scrollTop=t)},j.prototype.Qz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},j.prototype.Fz=function(){var o=this;this.Ti.addEventListener("click",function(t){var i,t,n,e,s,t,t,e,r,n,i=o,t=i.Qz(t.target,".".concat(h,",.").concat(g));t&&!t.getAttribute(N)&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),e=n=null,(i.Wz=t).getAttribute(f)&&(n=+(t=(s=t.getAttribute(f)).split("-"))[1],e=+t[0]),t=new Date(e,n-1,1,0,0,0,0),e=c.Common.CultureManager.Fe().DateTimeFormat,n=(r=new c.Formatter.GeneralFormatter(e.shortDatePattern)).format(t),i.fire(u.BaseDropdown.Event_ValueChanged,{text:n,value:t}))})},j.prototype.Zz=function(){var t,i,n,e,s,t=this;for(0<=this.MU.height?t.Ti.style.maxHeight=this.MU.height+"px":t.Ti.style.height="auto",t.Ti.classList.add("gc-month-picker-container"),i=t.MU.startYear;i<=t.MU.stopYear;i++)n=document.createElement("div"),t.Jz(n),(e=document.createElement("div")).classList.add("gc-month-picker-year-container"),t.Xz(i,e),(s=document.createElement("div")).classList.add("gc-month-picker-month-container"),t.qz(i,1,s),t.qz(i,2,s),t.qz(i,3,s),t.qz(i,4,s),n.appendChild(e),n.appendChild(s),this.Ti.appendChild(n)},j.prototype.Jz=function(t){var i=w("div");i.classList.add(l),t.appendChild(i)},j.prototype.Xz=function(t,i){var n=w("div");n.classList.add(M),n.innerText="".concat(t),i.appendChild(n)},j.prototype.qz=function(t,i,n){var e,s,r,o,u,e=document.createElement("div"),s=w("div"),r=w("div"),o=w("div"),u=w("div");switch(s.classList.add(h),r.classList.add(h),o.classList.add(h),u.classList.add(g),i){case 1:s.innerText=a().Calendar_ShortMonths_1,s.setAttribute(f,"".concat(t,"-").concat(1)),r.innerText=a().Calendar_ShortMonths_2,r.setAttribute(f,"".concat(t,"-").concat(2)),o.innerText=a().Calendar_ShortMonths_3,o.setAttribute(f,"".concat(t,"-").concat(3)),u.innerText=a().Quarter_Format_1,u.setAttribute(N,"".concat(t,"-").concat(1));break;case 2:s.innerText=a().Calendar_ShortMonths_4,s.setAttribute(f,"".concat(t,"-").concat(4)),r.innerText=a().Calendar_ShortMonths_5,r.setAttribute(f,"".concat(t,"-").concat(5)),o.innerText=a().Calendar_ShortMonths_6,o.setAttribute(f,"".concat(t,"-").concat(6)),u.innerText=a().Quarter_Format_2,u.setAttribute(N,"".concat(t,"-").concat(2));break;case 3:s.innerText=a().Calendar_ShortMonths_7,s.setAttribute(f,"".concat(t,"-").concat(7)),r.innerText=a().Calendar_ShortMonths_8,r.setAttribute(f,"".concat(t,"-").concat(8)),o.innerText=a().Calendar_ShortMonths_9,o.setAttribute(f,"".concat(t,"-").concat(9)),u.innerText=a().Quarter_Format_3,u.setAttribute(N,"".concat(t,"-").concat(3));break;case 4:s.innerText=a().Calendar_ShortMonths_10,s.setAttribute(f,"".concat(t,"-").concat(10)),r.innerText=a().Calendar_ShortMonths_11,r.setAttribute(f,"".concat(t,"-").concat(11)),o.innerText=a().Calendar_ShortMonths_12,o.setAttribute(f,"".concat(t,"-").concat(12)),u.innerText=a().Quarter_Format_4,u.setAttribute(N,"".concat(t,"-").concat(4))}e.appendChild(s),e.appendChild(r),e.appendChild(o),e.appendChild(u),n.appendChild(e),i<4&&this.Jz(n)},i.MonthPicker=j},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,i,n){"use strict";var e,a,l,s,M,r,o,u,n,D,r,h,g,c,I,f,N;function d(t){return Array.isArray(t)}function v(t){return"string"==typeof t}function w(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function j(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function b(t,i){var n,s,r,o,e,u,c,n=t[0],s=[];if(d(n))for(o=y(r=t,i),e=function(t,i){var n=r[t],e={};o.forEach(function(t,i){e[t]=n[i]}),s.push(e)},u=0,c=r.length;u<c;u++)e(u,c);else s=t;return s}function y(t,i){var n=[];return i&&0<i.length?i.forEach(function(t){n.push(t.name)}):n=t.shift(),n}function T(t,i,n){return N.call(this,t,i,n)||this}function A(t,i){var n=[];return t.yMt(i,0,0,n),n=C(n)}function C(t){for(var i,n,e,s,r,i=[],n=[],e=0;e<t.length;e++)r=""+(s=t[e]).row+s.col+s.rowCount+s.colCount+s.sheetName,i.indexOf(r)<0&&(i.push(r),n.push(s));return n}function z(s,t,r,o,u,c){var a={row:r,col:o,dataSource:u,dependSheetName:void 0,targetSheetName:c.name()};t.forEach(function(t){var t,i,n,e,i=t.row,n=t.col,e=null!=(t=t.sheetName)?t:c.name();void 0===s[i]&&(s[i]=[]),void 0===s[i][n]&&(s[i][n]=[]),s[i][n].some(function(t){return t.row===r&&t.col===o&&t.dataSource===u&&t.dependSheetName===e})||(a.dependSheetName=e,s[i][n].push(a))})}function p(t,i,n){var e=n.row,s=n.rowCount,r=n.col,n=n.colCount;"addRows"===t?m(i,e,s):"deletingRows"===t?x(i,e,s):"addColumns"===t?L(i,r,n):"deletingColumns"===t&&O(i,r,n)}function m(t,i,n){var e,s,r,o,u,c,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(r in s)if(s.hasOwnProperty(r)&&(o=s[r]))for(u=0,c=o;u<c.length;u++)(a=c[u]).row>=i&&(a.row+=n)}function x(t,i,n){var e,s,r,o,u,c,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(r in s)if(s.hasOwnProperty(r)&&(o=s[r])){for(u=[],c=0,a=o;c<a.length;c++)(l=a[c]).row<i?u.push(l):l.row<i+n||(l.row-=n,u.push(l));s[r]=u}}function L(t,i,n){var e,s,r,o,u,c,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(r in s)if(s.hasOwnProperty(r)&&(o=s[r]))for(u=0,c=o;u<c.length;u++)(a=c[u]).col>=i&&(a.col+=n)}function O(t,i,n){var e,s,r,o,u,c,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(r in s)if(s.hasOwnProperty(r)&&(o=s[r])){for(u=[],c=0,a=o;c<a.length;c++)(l=a[c]).col<i?u.push(l):l.col<i+n||(l.col-=n,u.push(l));s[r]=u}}e=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MultiColumn=void 0,a=n("Core"),l=n("SheetsCalc"),s=n("CalcEngine"),M=n("CalcEngine"),r=n("Common"),o=n("./dist/plugins/celltype/editor/baseControl.js"),u=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),n=n("./dist/plugins/celltype/celltypes.ns.js"),D=r.Common.lt.ht,r=new r.Common.ResourceManager(n.SR,"CellTypes"),h=r.getResource.bind(r),g=!!s,c=".multiColumnNS",N=u.BaseSpreadPicker,e(T,N),T.prototype.setOptions=function(t){var i,n,e,s,t,r,n,o,e;if(N.prototype.setOptions.call(this,t),(i=this).MU=t){if(n=i.TU,e=t.dataSource,s=t.bindingInfos,t=t.border,r=i.SU,n=n.getActiveSheet(),e){o=!0,w(n),n.options.isProtected=!0,n.options.rowHeaderVisible=!1,n.selectionPolicy(a.SelectionPolicy.single),n.selectionUnit(a.SelectionUnit.row);try{i.$z(n,e,s)}catch(t){o=!1,i.dispose()}finally{o&&n&&((e=new a.Style)._showTip=!1,n.setStyle(-1,-1,e,a.SheetArea.viewport),j(n))}}D(t)||(r.style.border=t)}},T.prototype.setValue=function(t){var i,n,e,n,i,i=this;i.MU&&(N.prototype.setValue.call(this,t),n=i.TU,e=n.getActiveSheet(),n=i.tV(t),e.suspendPaint(),-1!==n?(e.clear(0,-1,-1,-1,a.SheetArea.colHeader,a.StorageType.style),e.setSelection(n,-1,1,-1)):(e.clearSelection(),(i=new a.Style).backColor="rgb(225, 225, 225)",i.foreColor="rgb(33, 115, 70)",i.font="bold 11pt Calibri",i.borderBottom=new a.LineBorder("rgb(33, 115, 70)",a.LineStyle.medium),e.setStyle(0,-1,i,a.SheetArea.colHeader),e.D3(a.Events.ActiveCellChanged+c,function(t,i){e.setSelection(0,-1,1,-1),e._3(a.Events.ActiveCellChanged+c)})),e.resumePaint())},T.prototype.dispose=function(){var t,i,n,t,i,n;this.TU.getActiveSheet()._3(a.Events.ActiveCellChanged+c),N.prototype.dispose.call(this)},T.prototype.$z=function(t,i,n){var e,i;i&&(i=this.nV(i))&&(t.setDataSource(b(i,n)),n)&&t.bindColumns(n)},T.prototype.nV=function(t){var t,i,n,e,s,e,n,r,o,u,s,c,e,r,s,e,r,t=t,i=this.CU;if(v(t)){if(g){if(s=(e=this.MU).row,e=e.col,n=(0,l.formulaToExpression)(i,t),r=void 0,i.reportDataModel?(r=i.reportDataModel.mji.POt)&&r.setContext&&r.setContext({row:s,col:e,formula:t,triggerUpdatePrecedents:!0}):(r=i.Uw(),z(o=i.whe(),u=A(i,n),s,e,t,i)),s=i.getCalcService().evaluateParsedFormula(r,n,(0,M.eV)(0,0),!0),e=!1,r=void 0,!(e=!(c=M.Convert.LE(s)||M.Convert.Nh(s))||(r=M.Convert.iV(s,0,!1,!1,!1)).isError||r.isConvertError?e:!0))throw new Error(h().MultiColumn_InvalidDataSource);n=r}}else t instanceof a.Range?n=i.getArray(t.row,t.col,t.rowCount,t.colCount):d(t)?n=t:t.viewName&&(n=(r=(e=(s=i.parent)&&s.dataManager().rV)&&e[t.viewName])&&r.oV());return n},T.prototype.tV=function(t){var i,n,e,s,r,o,u,c,a,l,M,h,g,I,f,N,d,i=this,n=-1;if(t)if(s=(e=i.TU).getActiveSheet(),o=(r=Object.keys(t)).length,c=(u=s.getDataSource()).length,a=!1,l=i.MU.valuePath,D(l))for(M=0;M<c;M++){for(h=u[M],a=!0,g=0;g<o;g++)if(h[l=r[g]]!==t[l]&&void 0!==h[l]){a=!1;break}if(a){n=M;break}}else for(f=(I=t instanceof Date)?t+"":t,M=0;M<c;M++)if(N=u[M][l],(d=I&&N instanceof Date?N+"":N)===f){n=M;break}return n},T.prototype.submitData=function(t){var i,n,e,s,r,t,n,t,i=this,n=t.sheet,e;t.isEsc?s={notSubmit:!0}:-1<(t=(r=n.getSelections()[0]).row)&&(n=n.getDataItem(t),t=i.MU.valuePath,s={value:n=D(t)?n:n[t],text:n}),D(s)||i.fire(o.BaseDropdown.Event_ValueChanged,s)},i.MultiColumn=T,a.Worksheet.ch("dropDowns",{onLayoutChanged:function(t){var i,n,e;!D(t.sheetArea)&&3!==t.sheetArea||(n=(i=this).whe(),p(e=t.changeType,n,t))},onLayoutChangedFromOp:function(t){p(t.changeType,this.whe(),t)},updatePrecedents:function(t){var i,n,e,s,r,o,t,i=this,n=i.whe(),e=t.row,s=t.col,r=t.cells,o=t.formula,t=i.getStyle(e,s);t&&t.dropDowns&&t.dropDowns.some(function(t){return t.type===a.DropDownType.multiColumn&&t.option.dataSource===o})&&z(n,r,e,s,o,i)}})},"./dist/plugins/celltype/editor/popupControl.js":function(t,i,n){"use strict";var e,w,n,j,b,s,r,o,u,c;function a(t,i,n,e){this._x=t,this._y=i,this.YC=n,this.ZC=e}function l(t,i,n){var e=c.call(this,null)||this;return e.sourceElement=t,e.target=i,e.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:w.DropDownDirection.Down,align:w.DropDownAlignment.Near,horAdj:j.Flip|j.Slide,verAdj:j.Flip|j.Slide},e.globalMousedownEventHandler=function(t){var i,n;if(e.rf){for(n=i=t.target;n&&n!==e.sourceElement;)n=n.parentElement;n||(e.close(),t.stopPropagation(),t.preventDefault())}},e.windowResizeEventHandler=function(){e.rf&&e.close()},e.MU=e.defaultOption,e.rf=!1,n&&e.mergeOption(n),e.aV=null===e.MU.hostElement||void 0===e.MU.hostElement||!(e.MU.hostElement instanceof HTMLElement),e}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PopupControl=i.Rectangle=i.DropDownAdjustment=void 0,w=n("Core"),n=n("./dist/plugins/celltype/editor/baseControl.js"),(u=j=i.DropDownAdjustment||(i.DropDownAdjustment={}))[u.None=0]="None",u[u.Flip=1]="Flip",u[u.Slide=2]="Slide",a.CreateFromDom=function(t){return new a(t.left,t.top,t.width,t.height)},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),a.prototype.Offset=function(){for(var t,i,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this._x+=t[0].X,this._y+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this._x+=t[0],this._y+=t[1])},b=a,i.Rectangle=b,s="ribbon-dropdowngroup-popup",c=n.BaseControl,e(l,c),l.prototype.open=function(){this.rf||(this.MU.Oue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},l.prototype.beforeOpen=function(){this.bindEvent()},l.prototype.dispose=function(){var i=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,i.globalMousedownEventHandler,!0)})),this.aV?(this.sourceElement.classList.remove(s),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this._oldPosition):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},l.prototype.close=function(){var t;this.rf&&(this.rf=!1,this.MU.Oue&&(t=this.target).setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout(function(){t.focus()})),this.dispose(),this.fire("close"))},l.prototype.mergeOption=function(t){for(var i in t)void 0!==t[i]&&(this.MU[i]=t[i])},l.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},l.prototype.calcPosition=function(){var t,i,n,n,t,e,s,r,o,r,o,n,i=this.target instanceof b,t=i?this.target:b.CreateFromDom(this.target.getBoundingClientRect()),n=new b(0,0,window.innerWidth,window.innerHeight),n=this.calculateDropDownLocation(n,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),t=this.cV.offsetParent,e=t.getBoundingClientRect(),s=t===document.body,r=document.documentElement,o=(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0),r=(window.pageYOffset||r.scrollTop)-(r.clientTop||0),o=n.X-(s?-o:e.left-t.scrollLeft),n=n.Y-(s?-r:e.top-t.scrollTop);i&&(o<0&&(o=0),n<0)&&(n=0),this.cV.style.left="".concat(o,"px"),this.cV.style.top="".concat(n,"px")},l.prototype.calculateDropDownLocation=function(t,i,n,e,s,r,o){var u,c,a,l,M,h,g,I,f,N,d,o,r,D,v,i,u={X:t.x,Y:t.y};switch(t.Offset(-u.X,-u.Y),i.Offset(-u.X,-u.Y),c=i.left,a=i.right,l=i.top,M=i.bottom,h=l,g=t.height-M,I=c,f=t.width-a,N=(o&j.Flip)===j.Flip,d=(r&j.Flip)===j.Flip,o=(o&j.Slide)===j.Slide,r=(r&j.Slide)===j.Slide,e){case w.DropDownDirection.Up:n.height>h&&N&&(e=w.DropDownDirection.Down);break;case w.DropDownDirection.Down:n.height>g&&N&&(e=w.DropDownDirection.Up);break;case w.DropDownDirection.Left:n.width>I&&d&&(e=w.DropDownDirection.Right);break;case w.DropDownDirection.Right:n.width>f&&d&&(e=w.DropDownDirection.Left)}switch(v=D=0,e){case w.DropDownDirection.Up:v=l-n.height;break;case w.DropDownDirection.Down:v=M;break;case w.DropDownDirection.Left:D=c-n.width;break;case w.DropDownDirection.Right:D=a}return e===w.DropDownDirection.Up||e===w.DropDownDirection.Down?s===w.DropDownAlignment.Near?D=c:s===w.DropDownAlignment.Center?D=c-(n.width-i.width)/2:s===w.DropDownAlignment.Far&&(D=a-n.width):e!==w.DropDownDirection.Right&&e!==w.DropDownDirection.Left||(s===w.DropDownAlignment.Near?v=l:s===w.DropDownAlignment.Center?v=l-(n.height-i.height)/2:s===w.DropDownAlignment.Far&&(v=M-n.height)),i=new b(D,v,n.width,n.height),r&&(i.width>t.width?i.x=0:(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.width-i.width))),o&&(i.height>t.height?i.y=0:(i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.height-i.height))),i.Offset(u),i.Location},l.prototype.render=function(){var i=this;this.aV?(this._oldPosition=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(s),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(s),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.Oue&&setTimeout(function(){var t;i.cV&&(t=i.cV.querySelector("[role=menu],[role=listbox]"))&&t.focus()},500)},l.prototype.bindEvent=function(){var i=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,i.globalMousedownEventHandler,!0)})),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},i.PopupControl=l},"./dist/plugins/celltype/editor/slider.js":function(t,i,n){"use strict";var e,s,r,o,u,c,a,l,M,h,g,I,f,N,d,D,v,w,j,b;function y(t){return document.createElement(t)}function T(t){var i=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(l(0,(i[1]||"").length-parseInt(i[2],10)))}function A(t){var t,i,t=T(t||0),i=0;return i=0<=t.indexOf(".")?t.length-t.indexOf(".")-1:i}function C(){}function z(t,i){this.Wc=i,this.fV={},this.fV=g.extend(this.fV,t)}function p(t,i){this.Wc=i,this.lV={},this.lV=g.extend(this.lV,t)}function m(t,i){this.Wc=t,this.hV={},this.dV="",this.hV=g.extend(this.hV,i),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}function x(t,i){this.Wc=i,this.vV={},this.mV=!1,this.gV=a,this.isSelected=!1,this.Ame=a,this.vV=g.extend(this.vV,t),this.gV=new N(this.Wc,this.pV())}function L(t,i){this.Wc=i,this.bV={},this.bV=g.extend(this.bV,t)}function O(t,i,n,e,s){this.Wc=t,this.yV=i,this.wV=n,this.endHandle=e,this.MU=s,this.MV=a,this.CV=a,this.MV=new f(this.SV(),this.Wc),this.CV=new D(this.TV(),this.Wc)}function S(t,i){var e=b.call(this,t)||this;return e.yV=a,e.wV=a,e.phe=a,e.bhe=a,e.AV=a,e.Ime=function(t){var t,t,t;g.pauseEvent(t),t=e.AV.getKeyboardValueMutator(t),g.isEmpty(t)||(t=t(e._V.value),(t=e.AV.trimAlignValue(t))!==e._V.value&&(e.setValue(t),e._V.onChange(t),e._V.onAfterChange(t),e.fire(s.BaseDropdown.Event_ValueChanged,{value:t,text:t.toString(),notCloseDropDown:!0})))},e.IV=function(t){0===t.button&&(document.addEventListener("mouseup",e.xV,!1),document.addEventListener("pointerup",e.xV,!1),document.addEventListener("MSPointerUp",e.xV,!1),document.addEventListener("mousemove",e.NV,!1),document.addEventListener("pointermove",e.NV,!1),document.addEventListener("MSPointerMove",e.NV,!1),e.NV(t))},e.NV=function(t){var t,i,t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Sme(i,t):e._startValue!==i&&(e.setValue(i),e._V.onChange(i))},e.xV=function(t){var i,n;e.NV(t),document.removeEventListener("mousemove",e.NV),document.removeEventListener("mouseup",e.xV),document.removeEventListener("pointermove",e.NV),document.removeEventListener("pointerup",e.xV),document.removeEventListener("MSPointerMove",e.NV),document.removeEventListener("MSPointerUp",e.xV),i=e.kV(t,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Sme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e._startValue=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),g.pauseEvent(t)},e.EV=function(t){var i=t.target||t.srcElement;document.addEventListener("touchend",e.jV,!1),i.classList.contains("".concat(e._V.prefixCls,"-handle"))?document.addEventListener("touchmove",e.OV,!1):e.OV(t)},e.OV=function(t){var t,t,i,t=t.targetTouches[0],t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Sme(i,t):e._startValue!==i&&(e.setValue(i),e._V.onChange(i))},e.jV=function(t){var i,i,n;document.removeEventListener("touchmove",e.OV),document.removeEventListener("touchend",e.jV),i=t.changedTouches[0],i=e.kV(i,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Sme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e._startValue=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),g.pauseEvent(t)},e.init(i),e}e=this&&this.__extends||(j=function(t,i){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}j(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Slider=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("Common"),o=n("Core"),u=r.Common.lt.ht,c=r.Common.zf.j0,a=null,l=Math.max,M=Math.min,h=Math.abs,C.isEmpty=function(t){return void 0===t||t===a||""===t||Array.isArray(t)&&0===t.length},C.isEmptyObject=function(t){var i,n,i=!0;for(n in t)if(n){i=!1;break}return i},C.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},C.isObject=function(t){var i=typeof t;return"function"==i||"object"==i&&!!t},C.allKeys=function(t){var i,n,i=[];if(!C.isObject(t))return[];for(n in t)t.hasOwnProperty(n)&&i.push(n);return i},C.parseStyleObject=function(t){var i,n,e,s,r,o,r;if(!C.isObject(t))return"";for(i="",e=0,s=(n=C.allKeys(t)).length;e<s;e++)o=t[r=n[e]],r=r.replace(/([A-Z])/g,"-$1"),i+="".concat(r.toLowerCase(),": ").concat(o,"; ");return i.trim()},C.extend=function(t,i,n){var e,s,r,o,u;for(void 0===n&&(n={}),e=C.allKeys(t),r=0,o=(s=C.allKeys(i)).length;r<o;r++)n[u=s[r]]=i[u];for(r=0,o=e.length;r<o;r++)void 0===n[u=e[r]]&&(n[u]=t[u]);return n},C.noop=function(){},C.measureWidth=function(t,i){var n,e,n=0,e=y("span");e.classList.add(i);try{e.innerText=t,e.style.display="none",document.body.appendChild(e),n=(0,o.GC$)(e).width()}finally{document.body.removeChild(e)}return n},g=C,z.prototype.render=function(){var t,i;if(!this.fV.included)return a;t=this.RV(),(i=this.Wc.querySelector(".".concat(this.fV.className)))===a&&((i=y("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(i)),i.setAttribute("style",g.parseStyleObject(t))},z.prototype.setLength=function(t,i){this.fV.length=t,u(i)||(this.fV.offset=i),this.render()},z.prototype.RV=function(){return this.fV.direction===o.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},I=z,p.prototype.render=function(){var t,i,n,e,s,t=this.Wc.querySelector(".".concat(this.lV.className));if(t===a){for((t=y("div")).className="".concat(this.lV.className),n=0,e=(i=this.BV()).length;n<e;n++)s=this.LV(i[n]),t.appendChild(s);this.Wc.appendChild(t)}},p.prototype.LV=function(t){var i,n,n,n,i=y("span"),n=this.lV.max-this.lV.min,n=h(t-this.lV.min)/n*100+"%",n=this.lV.direction===o.LayoutDirection.vertical?{bottom:n}:{left:n};return i.classList.add("".concat(this.lV.prefixCls,"-dot")),i.setAttribute("style",g.parseStyleObject(n)),i.setAttribute("key",t.toString()),i},p.prototype.BV=function(){var t,i,n,t=Object.keys(this.lV.marks).map(function(t){return Number(t)});if(t.sort(function(t,i){return t-i}),i=t,this.lV.dots)for(n=this.lV.min;n<=this.lV.max;n+=this.lV.step)-1===i.indexOf(n)&&i.push(n);return i},f=p,m.prototype.render=function(t,i){var t,i,n,n,e,n;this.hV.offset=t,t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),i=new r.Formatter.GeneralFormatter(this.hV.formatString).format(i),g.isEmpty(t)&&(n=c(i),this.dV=this.dV.replace(/{{value}}/,n),(n=y("div")).innerHTML=this.dV,this.Wc.appendChild(n.firstElementChild),t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(e=t.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=i,n=this.GV(i),t.setAttribute("style",g.parseStyleObject(n)),this.hV.tooltipVisible?this.show():this.hide()},m.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));g.isEmpty(t)||(t.style.display="inline-block")},m.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));g.isEmpty(t)||(t.style.display="none")},m.prototype.GV=function(t){var t,t=0===(t=g.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip")))?12:t/2+4;return this.hV.direction===o.LayoutDirection.vertical?{left:"-".concat(t,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(t+4,"px)")}},N=m,x.prototype.render=function(){var t,i,n,e,t=this.UV(),i=this.GV(),n=this.vV.tabIndex||0;!this.vV.disabled&&n!==a||(n=a),(e=this.Wc.querySelector(".".concat(this.vV.className)))===a&&((e=y("div")).className=t,this.Wc.appendChild(e),e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",this.vV.min.toString()),e.setAttribute("aria-valuemax",this.vV.max.toString()),e.setAttribute("aria-valuenow",this.vV.value.toString()),e.setAttribute("aria-disabled",String(this.vV.disabled)),e.addEventListener("blur",this.xme.bind(this)),e.addEventListener("mouseenter",this.Nme.bind(this)),e.addEventListener("keydown",this.xme.bind(this)),e.addEventListener("mousedown",this._me.bind(this)),e.addEventListener("touchstart",this._me.bind(this)),document.addEventListener("touchend",this.Dme.bind(this)),document.addEventListener("mouseup",this.Dme.bind(this))),e.tabIndex=n,e.setAttribute("style",g.parseStyleObject(i)),this.Ame=e},x.prototype._me=function(t){this.Ame.focus(),this.isSelected=!0,this.gV.show()},x.prototype.Dme=function(t){var i=this.Ame;document.activeElement===i&&(this.HV(!1),i.blur(),this.isSelected=!1)},x.prototype.xme=function(){this.HV(!1)},x.prototype.Nme=function(){this.gV.show()},x.prototype.isSelectedByMouse=function(t){return u(t)||(this.isSelected=t),this.isSelected},x.prototype.setOffset=function(t,i){this.vV.offset=t,this.render(),this.gV.render(t,i)},x.prototype.HV=function(t){this.mV=t},x.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},x.prototype.GV=function(){return this.vV.direction===o.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},x.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},x.prototype.dispose=function(){this.Ame&&(this.Ame.removeEventListener("blur",this.xme.bind(this)),this.Ame.removeEventListener("mouseenter",this.Nme.bind(this)),this.Ame.removeEventListener("keydown",this.xme.bind(this)),this.Ame.removeEventListener("mousedown",this._me.bind(this)),this.Ame.removeEventListener("touchstart",this._me.bind(this))),this.Ame=a,document.removeEventListener("touchend",this.Dme.bind(this)),document.removeEventListener("mouseup",this.Dme.bind(this))},d=x,L.prototype.render=function(){var t,i,n,e,s,s,t=this.Wc.querySelector(".".concat(this.bV.className));if(t===a){for((t=y("div")).className="".concat(this.bV.className),i=this.zV(),this.VV(i),n=0,e=i.length;n<e;n++)s=i[n],(s=this.YV(s))!==a&&t.appendChild(s);this.Wc.appendChild(t)}},L.prototype.VV=function(t){var i,n,e,e;for(this.ZV=0,i=1,n=t.length;i<n;i++)(e=this.bV.marks[t[0]])&&(e=g.measureWidth(e.label,"".concat(this.bV.className,"-text")),!this.ZV||this.ZV<e)&&(this.ZV=e)},Object.defineProperty(L.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),L.prototype.zV=function(){var t;return g.allKeys(this.bV.marks).sort(function(t,i){return t-i})},L.prototype.YV=function(i){var n,t,e,s,r,r,t,n=this,t=this.bV.marks[i],e=g.isObject(t)?t.label:t;return g.isEmptyObject(e)?a:(s="".concat(this.bV.className,"-text"),r=this.WV(i),r=g.extend(r,t.style),(t=y("span")).classList.add(s),t.setAttribute("style",g.parseStyleObject(r)),t.setAttribute("key",i.toString()),t.addEventListener("mousedown",function(t){n.bV.onClickLabel(t,i)}),t.innerHTML=c(e),t)},L.prototype.WV=function(t){var i=this.bV.max-this.bV.min;return this.bV.direction===o.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/i*100+"%"}:{left:(t-this.bV.min)/i*100+"%",transform:"translateX(-50%)"}},D=L,O.prototype.render=function(){var t=y("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.endHandle&&this.endHandle.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===o.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},O.prototype.calcValueByPosition=function(t,i){var t,t,t=t-this.QV(),t=this.KV(t);return i?t:this.trimAlignValue(t)},O.prototype.trimAlignValue=function(t){return g.isEmpty(t)?a:this.JV(t)},O.prototype.calcOffset=function(){var t;return 100*(l(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},O.prototype.getKeyboardValueMutator=function(t){var i=this;switch(t.keyCode){case 38:case 39:return function(t){return i.calculateNextValue("increase",t)};case 40:case 37:return function(t){return i.calculateNextValue("decrease",t)};case 35:return function(t){return i.MU.max};case 36:return function(t){return i.MU.min}}},O.prototype.calculateNextValue=function(t,i){var n,e,e,e,n={increase:function t(i,n){return i+n},decrease:function t(i,n){return i-n}},e=Object.keys(this.MU.marks).indexOf(String(i)),e=n[t](e,1),e=Object.keys(this.MU.marks)[e];return this.MU.step?n[t](i,this.MU.step):!g.isEmptyObject(this.MU.marks)&&this.MU.marks[e]?this.MU.marks[e]:i},O.prototype.JV=function(t){var t=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===a?t:parseFloat(t.toFixed(this.qV()))},O.prototype.qV=function(){var t,i;if(u(this.MU.precision)){for(i in t=l(A(this.MU.max),A(this.MU.min),A(this.MU.step)),this.MU.marks)t=l(A(parseFloat(i)),t);this.MU.precision=t}return this.MU.precision},O.prototype.XV=function(i){var t,n,n,n,n,t=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==a&&(n=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),n=M((i-this.MU.min)/this.MU.step,n),n=Math.round(n)*this.MU.step+this.MU.min,t.push(M(n,this.MU.max))),n=t.map(function(t){return h(i-t)}),t[n.indexOf(M.apply(void 0,n))]},O.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},O.prototype.TV=function(){var n=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?g.noop:function(t,i){n.$V(t,i)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},O.prototype.$V=function(t,i){},O.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===o.LayoutDirection.vertical?t.top:t.left},O.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===o.LayoutDirection.vertical?t.height:t.width},O.prototype.KV=function(t){var i,n,t,i=this.MU.min,n=this.MU.max,t=h(l(t,0)/this.tY());return(t=this.MU.direction===o.LayoutDirection.vertical?l(1-t,0):t)*(n-i)+i},v=O,b=s.BaseDropdown,e(S,b),S.prototype.setValue=function(t){var i,n,i;this._V.disabled||(this._V.showNumberRange?(u(this.yhe)&&(this.yhe={}),i=t.start,n=t.end,i=parseFloat(i),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),M(this._V.max,i)),this._V.numberRange.start=i,this.yhe.start=i,this.phe.setOffset(this.calcOffset(i),i),n=parseFloat(n),n=isNaN(n)?this._V.max:(n=l(this._V.min,n),M(this._V.max,n)),n=l(i,n),this._V.numberRange.end=n,this.yhe.end=n,this.yV.setLength(this.calcRangeOffset(),this.calcOffset(i)),this.bhe.setOffset(this.calcOffset(n),n)):(i=parseFloat(t),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),M(this._V.max,i)),this._V.value=i,this._startValue=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),i)))},S.prototype.calcOffset=function(t){var t,t,t=u(t)?this._V.value:t,t=l(t-this._V.min,0)/(this._V.max-this._V.min);return 100*(t=M(t,1))},S.prototype.calcRangeOffset=function(){var t,t,t=this._V.numberRange.end-this._V.numberRange.start,t=l(t,0)/(this._V.max-this._V.min);return 100*(t=M(t,1))},S.prototype.setOptions=function(t){this.init(t)},S.prototype.init=function(t){var t,i,t,n,n;this.nY(t),this.eY(),this.Ti.innerHTML="",(t=y("div")).className="gc-slider-container",this.Ti.appendChild(t),this._V.direction===o.LayoutDirection.vertical?(t.classList.add("".concat(this._V.prefixCls,"-vertical")),t.style.height=this._V.height+"px"):t.style.width=this._V.width+"px",(i=y("div")).className=this.UV(),t.appendChild(i),this.yV=new I(this.iY(),i),this._V.showNumberRange?((t=this.rY()).value=this._V.numberRange.start,n=y("div"),i.appendChild(n),this.phe=new d(t,n),t.tabIndex++,t.value=this._V.numberRange.end,n=y("div"),i.appendChild(n),this.bhe=new d(t,n),this.AV=new v(i,this.yV,this.phe,this.bhe,this.oY())):(this.wV=new d(this.rY(),i),this.AV=new v(i,this.yV,this.wV,a,this.oY())),this.AV.render(),this.aY(i)},S.prototype.aY=function(t){this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",this.Ime))},S.prototype.Sme=function(t,i){var n,e,n,s,i,r,o,r,o,n=this._V.numberRange,e=n.start,n=n.end,s=h(i-e),i=h(n-i),r=this.phe,o=this.bhe;e===n?(n<t?(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})):t<e&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})),r.isSelectedByMouse(!1),o.isSelectedByMouse(!1)):(r=this.bhe.isSelectedByMouse(),o=this.phe.isSelectedByMouse(),(r&&s<i||i<s&&!o)&&n!==t&&(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})),(o&&i<s||s<i&&!r)&&e!==t&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})))},S.prototype.kV=function(t,i){var n=0,n;return n=this._V.direction===o.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY,i):this.AV.calcValueByPosition(t.clientX,i)},S.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:o.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General",showNumberRange:!1,numberRange:{start:0,end:100}}},S.prototype.eY=function(){(g.isEmpty(this._V)||g.isEmptyObject(this._V))&&(this._V={}),this._V=g.extend(this.uY(),this._V)},S.prototype.nY=function(t){var n=this;t&&(u(t.scaleVisible)||(this._V.dots=t.scaleVisible),u(t.direction)||(this._V.direction=t.direction),u(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),u(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),u(t.showNumberRange)||(this._V.showNumberRange=!!t.showNumberRange),this._V.marks={},t.marks)&&t.marks.forEach(function(t){var t,i,t=parseFloat(t);isNaN(t)||t>=n._V.min&&t<=n._V.max&&(i=new r.Formatter.GeneralFormatter(n._V.formatString),n._V.marks[t]={label:i.format(t)})})},S.prototype.sY=function(t,i){var t;u(t)||(t=parseFloat(t),isNaN(t))||(this._V[i]=t)},S.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},S.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString,showNumberRange:this._V.showNumberRange,numberRange:this._V.numberRange}},S.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks,showNumberRange:this._V.showNumberRange}},S.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===o.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),g.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},S.prototype.dispose=function(){var t=this.yV.Wc;t&&(t.removeEventListener("mousedown",this.IV),t.removeEventListener("pointerdown",this.IV),t.removeEventListener("MSPointerDown",this.IV),t.removeEventListener("touchstart",this.EV),t.removeEventListener("keyup",this.Ime)),this.yV.Wc=a,this.wV&&this.wV.dispose(),this.wV=a,this.phe&&this.phe.dispose(),this.phe=a,this.bhe&&this.bhe.dispose(),this.bhe=a,b.prototype.dispose.call(this)},i.Slider=S},"./dist/plugins/celltype/editor/timepicker.js":function(t,i,n){"use strict";var e,s,r,o,u,c,a,l,M;function h(t,i){var t=M.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.TimePicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),r=n("./dist/plugins/celltype/editor/baseControl.js"),o="undefined",u=n("Common"),c=u.Common.lt.ht,M=r.BaseDropdown,e(h,M),h.prototype.setOptions=function(t){var i,i,i,i;t&&(null!==(i=this.cY(t.min))&&(this.MU.min=i),null!==(i=this.cY(t.max))&&(this.MU.max=i),null!==(i=this.cY(t.step))&&(this.MU.step=i),c(t.formatString)||(this.MU.formatString=t.formatString),c(t.height)||(i=parseInt(t.height,10),isNaN(i))||(this.MU.height=i),this.MU.height=Math.max(1,this.MU.height)),this._6()},h.prototype.setValue=function(t){c(t)||(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},h.prototype.scrollToSelect=function(){var t,t,t=this.gz.querySelector(".selected");null!==t&&(t=t.offsetTop,this.Wc.scrollTop=t)},h.prototype.Hc=function(){var i=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},h.prototype.cY=function(t){var i,n,n,n,i=null;return c(t)||(i={},c(t.hour)||(n=parseInt(t.hour,10),isNaN(n))||(i.hour=n),c(t.minute)||(n=parseInt(t.minute,10),isNaN(n))||(i.minute=n),c(t.second))||(n=parseInt(t.second,10),isNaN(n))||(i.second=n),i},h.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.lY()),this.yz()},h.prototype.yz=function(){var t,i,n,e,s,t=this.gz.querySelectorAll(".gc-time-picker-li");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=+t[i].getAttribute("hour"),e=+t[i].getAttribute("minute"),s=+t[i].getAttribute("second"),this.hY(this.Bz,{hour:n,minute:e,second:s})&&t[i].classList.add("selected")},h.prototype.lY=function(){var s=this;return{items:function(){var t,i,n,e,t=s.dY(),i=document.createElement("div");for(i.classList.add("gc-time-picker-container"),s.Wc=i,s.MU.height<0?i.style.height="auto":i.style.maxHeight=s.MU.height+"px",(n=document.createElement("ul")).classList.add("gc-time-picker-ul"),e=0;e<t.length;e++)n.appendChild(s.vY(t[e]));return 24*t.length>s.MU.height&&0<=s.MU.height?i.style.overflowY="scroll":i.style.overflowY="hidden",i.appendChild(n),i}}},h.prototype.vY=function(t){var i=document.createElement("li");return i.classList.add("gc-time-picker-li"),i.setAttribute("hour",t.hour.toString()),i.setAttribute("minute",t.minute.toString()),i.setAttribute("second",t.second.toString()),i.innerText=this.mY(t),i},h.prototype.dY=function(){for(var t,i,n,t=this.gY(this.MU.min),i=this.gY(this.MU.max),n=[];t<=i;)n.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return n},h.prototype.pY=function(t,i){return typeof i.hour!=o&&t.setHours(t.getHours()+i.hour),typeof i.minute!=o&&t.setMinutes(t.getMinutes()+i.minute),typeof i.second!=o&&t.setSeconds(t.getSeconds()+i.second),t},h.prototype.mY=function(t){var i,n,t,i=new Date;return i.setHours(t.hour),i.setMinutes(t.minute),i.setSeconds(t.second),(t=(n=new u.Formatter.GeneralFormatter(this.MU.formatString)).format(i))&&""!==t&&null!==t?t:this.bY(i)},h.prototype.bY=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?"AM":"PM")+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},h.prototype.gY=function(t){var i=new Date;return i.setHours(t.hour||0),i.setMinutes(t.minute||0),i.setSeconds(t.second||0),i},h.prototype.hY=function(t,i){return!(!t||!i)&&(t=this.yY(t),i=this.yY(i),t.hour===i.hour)&&t.minute===i.minute&&t.second===i.second},h.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},h.prototype.pz=function(t){var t,i,n,t,e,s,s,t=t.target;t&&(i=+t.getAttribute("hour"),n=+t.getAttribute("minute"),t=+t.getAttribute("second"),(e=this.fY||new Date).setHours(i),e.setMinutes(n),e.setSeconds(t),e.setMilliseconds(0),s=(new u.Common.CultureInfo).DateTimeFormat,s=new u.Formatter.GeneralFormatter(s.defaultDatePattern).format(e),this.fire(r.BaseDropdown.Event_ValueChanged,{value:e,text:s}),this.Bz={hour:i,minute:n,second:t},this.yz())},i.TimePicker=h},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,i,n){"use strict";var e,s,r,n,c,o,u,a;function l(t,i){var n=a.call(this,t)||this;return n.wY=new r.List(t),n.wY.on(s.BaseDropdown.Event_ValueChanged,function(t){n.fire(s.BaseDropdown.Event_ValueChanged,t)}),n.setOptions(i),n}function M(t,i){var e,s,r,n,o,u,e={items:[]},s=t.items,r=s.filter(function(t){return t.value===i})[0];if(c(r)&&s&&0<s.length)(n=e.items).push({text:s[0].value,value:s[0].value});else if(r&&r.transitions&&0<r.transitions.length)for(o=function(t){var i,t,n,i=r.transitions[t];"number"==typeof i&&s[i]&&(i=s[i].value),(t=s.filter(function(t){return t.value===i})[0])&&(n=e.items).push({text:t.value,value:t.value})},u=0;u<r.transitions.length;u++)o(u);return e}e=this&&this.__extends||(u=function(t,i){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}u(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.WorkFlow=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/editor/listControl.js"),n=n("Common"),c=n.Common.lt.ht,a=s.BaseDropdown,e(l,a),l.prototype.setOptions=function(t){this.MU=t},l.prototype.setValue=function(t){var t;this.MU&&(t=M(this.MU,t),this.wY.setOptions(t))},l.prototype.updateStyle=function(t,i,n){this.wY.updateStyle(t,i,n)},i.WorkFlow=l},"./dist/plugins/celltype/fileUploadCellType/action.js":function(t,i,n){"use strict";var I,f,N,e;function s(t,i){this.X5=f.beforeAction,this.q5=f.afterAction;var n=this;n.Mf=t,n.tT=i}Object.defineProperty(i,"__esModule",{value:!0}),i.UPLOAD_FILE=void 0,I=n("Core"),f=n("./dist/plugins/celltype/actionUtils.js"),N=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),s.prototype.execute=function(){var t,i,n,e,s,r,o,u,c,a,l,M,h,g,t=this,i=t.Mf,n=t.tT,e=i.parent.i4(),s=!0;I.Commands.II(e),t.X5(i,!0),(0,f.suspendCalcService)(i);try{r=n.row,o=n.col,u=n.newValue,c=n.fileGUID,a=n.newFileWrapper,l=n.oldFileWrapper,M=n.valuePath,h=i.getValue(r,o),(g=(0,N.getValueByValuePath)(u,M))?(a.id=c,i.Ut.setFileGUID(r,o,c),i.setValue(r,o,g),i.Ut.L0r(a)):(i.setValue(r,o,g),i.Ut.setFileGUID(r,o,void 0),i.Ut.R0r(l)),i.eT(n.row,n.col,h,g)}catch(t){s=!1}finally{I.Commands.xI(e,n),(0,f.resumeCalcService)(i,!1),t.q5(i,!0)}return s},s.prototype.undo=function(){var t,i,n,e,s,t=this,i=t.Mf,n=t.tT,e=!0;t.X5(i,!0),(0,f.suspendCalcService)(i);try{s=I.Commands.TI(i.name()),i.Ut.undo(n[s]),i.eT(n.row,n.col,n.newValue,n.oldValue)}catch(t){e=!1}finally{(0,f.resumeCalcService)(i,!1),t.q5(i,!0)}return e},s.prototype.canExecute=function(){return!0},s.prototype.canUndo=function(){return!0},e=s,i.UPLOAD_FILE="uploadFile",I.Commands[i.UPLOAD_FILE]={canUndo:!0,execute:function(t,i,n){return(0,f.executeCommand)(t,e,i,n)}}},"./dist/plugins/celltype/fileUploadCellType/definition-comments.js":function(){},"./dist/plugins/celltype/fileUploadCellType/feature-register.js":function(t,i,n){"use strict";var e,s;function r(){e.Worksheet.ch("fileUploadCellType",{preUploadFile:function(t){var i,i,i,n,i,n=t.sheet.isReportTemplateSheet,i="19"===(null==(i=null==(i=null==(i=t.sheet.sw.cellTypeHitInfo)?void 0:i.cellStyle)?void 0:i.cellType)?void 0:i.typeName);t.cancel=n&&i}}),e.Workbook.ch("registerUploadFileCommand",{init:function(){this.commandManager().register(s.UPLOAD_FILE,e.Commands[s.UPLOAD_FILE])}})}Object.defineProperty(i,"__esModule",{value:!0}),i.registerFeatures=void 0,e=n("Core"),s=n("./dist/plugins/celltype/fileUploadCellType/action.js"),i.registerFeatures=r},"./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js":function(t,i,n){"use strict";var e,n,s,r,o;function u(){return null!==o&&o.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Uxn=void 0,n=n("Core"),o=n.Ase,e(u,o),u.prototype.rQ=function(t,i){this.Dn(),this.vRe(t,i),this.Nye(),this.kye(i)},u.prototype.Dn=function(){this.Wc.html(this.Hxn())},u.prototype.vRe=function(t,i){var n,e,s,n;o.prototype.$c.call(this),e=(n=this.Wc.get(0)).querySelector(".gc-sjs-file-preview-dialog-title-text"),s=n.querySelector(".gc-sjs-file-preview-dialog-image"),n=n.querySelector(".gc-sjs-file-preview-dialog-container"),e.textContent=t,s.src=i,s.alt=i,n.style.maxHeight=this.Fc.height()-50+"px"},u.prototype.jye=function(t){var i,t,i,t=t.target.dataset.cmd;t&&"close"===t&&this.close()},u.prototype.Nye=function(){var i,t,n,e,i=this,t=function(t){i.jye(t)},n=function(t){"Escape"!==t.key&&27!==t.keyCode||i.close()};this.Wc.bind("click",t),document.addEventListener("keyup",n),e=this.bindMoveEvent(this.Wc[0].querySelector(".gc-sjs-file-preview-dialog-title")),this.wpt=function(){i.Wc.unbind("click",t),document.removeEventListener("keyup",n),e()}},u.prototype.kye=function(t){var r,o,r=this,o=new Image;r.Wc.css(["display"],["none"]),o.onload=function(){var t,i,n,i,t,e,s,i,t=o.width,i=o.height,n=r.Wc.width(),i=i/t*n,t=r.Fc.width(),e,s,i=(r.Fc.height()-i)/2;r.Wc.css(["position","left","top","display"],["absolute",(t-n)/2+"px",(0<i?i:20)+"px","block"])},o.src=t},u.prototype.close=function(){this.wpt&&this.wpt(),o.prototype.close.call(this)},u.prototype.Hxn=function(){return'\n<div class="gc-sjs-file-preview-dialog-container">\n  <div class="gc-sjs-file-preview-dialog-title">\n      <span class="gc-sjs-file-preview-dialog-title-text"></span>\n      <span class="cancel-icon" data-cmd="close">\xd7</span>\n  </div>\n  <div class="gc-sjs-file-preview-dialog-content">\n        <img class="gc-sjs-file-preview-dialog-image" src="#" alt="#" width="100%" />\n  </div>\n</div>\n      '},i.Uxn=u},"./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js":function(t,i,n){"use strict";var e,s,r,h,o,u,j,l,b,n,r,c,M,a,g,I;function f(){var t=I.call(this)||this;return t.typeName="19",t._text=(0,j.getSR)().FileUpload_Title,t.zxn=M,t.Wxn=M,t.$xn=22,t.Hc(),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var i,n,e,s,n=1,e=arguments.length;n<e;n++)for(s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)},Object.defineProperty(i,"__esModule",{value:!0}),i.FileUpload=void 0,r=n("Common"),h=n("Core"),o=n("./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js"),u=n("./dist/plugins/celltype/fileUploadCellType/feature-register.js"),j=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),n("./dist/plugins/celltype/fileUploadCellType/definition-comments.js"),l=r.Common.lt.ht,b=h.CellTypes.Text,n=h.CellTypes.Base,r=h.GC$,c=r.each,M=null,e(f,I=n),f.prototype.fur=function(t,i){(0,j.fur)(t,i)},f.prototype.thumbnailSize=function(t){return t&&(t.width?this.oZn.width=t.width:delete this.oZn.width,t.height?this.oZn.height=t.height:delete this.oZn.height),this.oZn},f.prototype.Hc=function(){var n=this;c(j.defaultFileUploadProps,function(t,i){n["_"+t]=i}),n.oZn={}},f.prototype.TRe=function(t,i,n){var e;return this.Ile(this.UBe(t,i,n))&&(this._isPreviewEnabled||this._isDownloadEnabled||this._isClearEnabled)},f.prototype.Hne=function(t,i,n){var e,e,s,r,o,s,r=t.Oi&&t.HO(i,n),o;return((null==(e=this.zxn)?void 0:e.row)===i&&(null==(e=this.zxn)?void 0:e.col)===n||r)&&this.TRe(t,i,n)},f.prototype.i2e=function(t,i){var t,n,t,n="",t=null==t?void 0:t.split(".");return(n=t&&1<t.length?t.pop():null!=(t=j.MIMETYPE_TO_FILE_EXTENSION_MAP[i])?t:"").toLowerCase()},f.prototype.o2e=function(t,i,n){var t,t,t,n,t,t=null!=(t=null==(t=null==(t=t.getParent())?void 0:t.options)?void 0:t.builtInFileIcons)?t:n;return null!=(n=null==t?void 0:t[i])?n:j.ICON_MAP.commonFile},f.prototype.Ile=function(t){return(0,j.Ile)(t)},f.prototype.dEe=function(t,i,n){var e,i,s,n,t,t,e=[],i=this.UBe(t,i,n,!0);return i?(s=this.i2e(i.name,i.type),n=-1!==j.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return s===t}),t=(t=t.BO()).getState(i.dataUrl)&&!t.qh(i.dataUrl),this._isPreviewEnabled&&(n&&!t||this.previewCommand)&&e.push("preview"),!this._isDownloadEnabled||n&&t||e.push("download"),e):[]},f.prototype.vEe=function(t,i,n){return this.dEe(t,i,n).map(function(t){return j.ICON_MAP[t]})},f.prototype.mEe=function(t,i,n,e){var t,i,s,t=this.vEe(t,i,n).length,i=.2*e>this.$xn?this.$xn:.2*e,s;return{iconSize:i,space:(e-i*t)/(t+1)}},f.prototype.gEe=function(t){var i=t.BO();Object.values(j.ICON_MAP).forEach(function(t){i.addImage(t,"anonymous")})},f.prototype.UBe=function(t,i,n,e,s){var r,o,u,c,o,a,o,e,r=t.Ut.getFileGUID(i,n),o=t.GRe(),u=t.getValue(i,n),c=o.Mdt(r,!0),o=o._0r(r),a=this._valuePath;if(o||!u)return c&&(e?c:(o={dataUrl:c.dataUrl,blob:c.blob,name:c.name},e=(0,j.getValueByValuePath)(o,a,c),(0,j.isFileInfoEqual)(e,u)||s?o:void(0,j.fur)({row:i,col:n,value:u,valuePath:a,fileGUID:r},t,void 0,!0)));(0,j.fur)({row:i,col:n,value:u,fileGUID:r,valuePath:a},t,void 0,!0)},f.prototype.kfr=function(t,i,n,e){var i,n,i=(0,j.jfr)(i),n={width:n,height:e};return!i||i.hasAttribute("width")||i.hasAttribute("height")?n:(0,j.EJi)(n.width,n.height,t.canvas.width,t.canvas.height)},f.prototype.paintValue=function(t,i,n,e,s,r,o,u){var c,a,l,M,h,g,I,f,f,c=this;t&&(a=n+c._marginLeft,l=e+c._marginTop,M=s-c._marginLeft-c._marginRight,h=r-c._marginTop-c._marginBottom,g=n<a+M&&a<n+s&&e<l+h&&l<e+r,I=c._text,f=c.UBe(u.sheet,u.row,u.col,void 0,u.isPrinting),f=c.Ile(f),0<M-2)&&0<h-2&&g&&(t.save(),(a<n||n+s<a+M||l<e||e+r<l+h)&&(t.rect(n,e,s,r),t.clip()),t.beginPath(),f?(c.pEe(t,a,l,M,h,o,u),this.Hne(u.sheet,u.row,u.col)&&c.bEe(t,n,e,s,r,o,u)):c.ORe(t,I,a,l,M,h,o,u),t.restore())},f.prototype.getText=function(t){return t},f.prototype.Fn=function(t,i,n,e,s){var r,o,u,u,c,n,a,e,l,M,r=s.sheet,o=s.row,u=s.col,u=this.UBe(r,o,u,!0),c=this.marginTop()+this.marginBottom(),n=I.prototype.Fn.call(this,t,u&&t?u.name:(0,j.getSR)().FileUpload_Title,n,e,s)+c;return u&&t&&(a=3,e=parseFloat(r.getRowHeight(o,h.SheetArea.viewport)+"")-3,l=this.i2e(u.name,u.type),(M=-1!==j.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return l===t}))?n=e:n*=2.5),n},f.prototype.Ln=function(t,i,n,e,s){var r,o,u,o,c,n,a,e,l,M,r=s.sheet,o=s.row,u=s.col,o=this.UBe(r,o,u,!0),c=this.marginTop()+this.marginBottom(),n=I.prototype.Ln.call(this,t,o&&t?o.name:(0,j.getSR)().FileUpload_Title,n,e,s)+c;return n=o&&t&&(a=3,e=parseFloat(r.getColumnWidth(u,h.SheetArea.viewport)+"")-3,l=this.i2e(o.name,o.type),M=-1!==j.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return l===t}))?e:n},f.prototype.ORe=function(t,i,n,e,s,r,o,u){var c,c,a,l,c,M,h,g,I,M,c,h,g,I,M,I,M,h,g,c,a=this,l=3,c=(null==(c=a.zxn)?void 0:c.row)===u.row&&(null==(c=a.zxn)?void 0:c.col)===u.col,M=u.sheet.currentTheme().colors().accent1(),h=M.r,g=M.g,I=M.b,M=M.a,c=c?"rgba(".concat(h,",").concat(g,",").concat(I,",").concat(M,")"):"rgb(217,217,217)",h=n+1,g=e+1,I=s-2,M=r-2;t.setLineDash([3,2]),t.moveTo(h+3,g),t.lineTo(h+I-3,g),t.arc(h+I-3,g+3,3,1.5*Math.PI,2*Math.PI),t.lineTo(h+I,g+M-3),t.arc(h+I-3,g+M-3,3,0,.5*Math.PI),t.lineTo(h+3,g+M),t.arc(h+3,g+M-3,3,.5*Math.PI,Math.PI),t.lineTo(h,g+3),t.arc(h+3,g+3,3,Math.PI,1.5*Math.PI),t.lineTo(h,g+3),t.closePath(),c&&t.strokeStyle!==c&&(t.strokeStyle=c),t.lineWidth=2,t.stroke(),M=(I=u.sheet.currentTheme().colors().background2()).r,h=I.g,g=I.b,c=I.a,t.fillStyle="rgba(".concat(M,", ").concat(h,", ").concat(g,", ").concat(c,")"),t.fill(),b.prototype.paintValue.call(a,t,i,n,e,s,r,o,u)},f.prototype.pEe=function(t,i,n,e,s,r,o){var u,c,c,u,u,a,l,M,h,g,a,h,g,I,c,M,g,I,M,u,f,N,d,u,D,c,u,a,c,v,w,l=this,M=o.sheet,h=o.row,g=o.col;this.gEe(M),a=l.thumbnailSize(),(h=this.UBe(M,h,g,!0))&&(g=h.dataUrl,c=(I=l.i2e(h.name,h.type))&&-1<j.IMAGE_FILE_EXTENSIONS.indexOf(I),M=l.o2e(M,I,o.builtInFileIcons),(M=(I=o.imageLoader).getImage(g=c?g:M))||I.addImage(g,"anonymous"),u=I.getState(g),"string"!=typeof g&&g&&g.toString&&!u&&(g=g.toString(),u=c=!0),u)&&(c?I.qh(g)?(f=null!=(u=a.width)?u:e-2,N=null!=(c=a.height)?c:s-2,d=l.kfr(t,M.src,M.width,M.height),t.drawImage(M,0,0,d.width,d.height,i+1,n+1,f,N)):(u=I.getImage(j.ICON_MAP.errorFile))&&t.drawImage(u,0,0,u.width,u.height,i+1,n+1,null!=(c=a.width)?c:e-2,null!=(u=a.height)?u:s-2):(D=4,c=e<.6*(s-2)?.6*(e-2):.6*(s-2)-8,u=(e-2-(f=null!=(u=a.width)?u:c))/2+1,a=(.6*(s-2)-(N=null!=(a=a.height)?a:c))/2+1,I.qh(g)?(d=l.kfr(t,M.src,M.width,M.height),t.drawImage(M,0,0,d.width,d.height,i+u,n+a,f,N)):(c=I.getImage(j.ICON_MAP.commonFile),t.drawImage(c,0,0,c.width,c.height,i+u,n+a,f,N)),b.prototype.paintValue.call(l,t,h.name,i,w=n+.6*(s-2),e,.4*(s-2),r,o)))},f.prototype.bEe=function(t,i,n,e,s,r,o){this.wEe(t,i,n,e,s),this.yEe(t,i,n,e,s,r,o)},f.prototype.wEe=function(t,i,n,e,s){t.save(),t.beginPath(),t.rect(i,n,e,s),t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(i,n,e,s),t.restore()},f.prototype.yEe=function(t,i,n,e,s,r,o){this.FBe(t,i,n,e,s,o),this.LBe(t,i,n,e,s,o)},f.prototype.FBe=function(e,s,t,r,i,o){var u,c,n,a,l,M,h,u=this,c=o.sheet.BO();e.save(),e.beginPath(),n=this.mEe(o.sheet,o.row,o.col,r),a=n.iconSize,l=n.space,M=t+(i-a)/2,h=this.dEe(o.sheet,o.row,o.col),this.vEe(o.sheet,o.row,o.col).forEach(function(t,i){var t,n,i;c.getImage(t)||u.gEe(o.sheet),c.getState(t)&&c.qh(t)&&(t=c.getImage(t),n=s+(i+1)*l+i*a,h[i]===u.Wxn&&(e.fillStyle="rgba(255, 255, 255, 0.3)",i=.2*r>u.$xn?4:2,e.fillRect(n-i,M-i,a+2*i,a+2*i)),e.drawImage(t,n,M,a,a))}),e.restore()},f.prototype.LBe=function(t,i,n,e,s,r){var o,i,u,c,e,n,a,r;this.isClearEnabled()&&(o=r.sheet.BO(),t.save(),t.beginPath(),e=i+e-(i=this.mEe(r.sheet,r.row,r.col,e).iconSize)-4,n=n+(c=u=2)+2,a=j.ICON_MAP.clear,o.getImage(a)||this.gEe(r.sheet),o.getState(a)&&o.qh(a)&&(r=o.getImage(a),"clear"===this.Wxn&&(t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(e-2,n-2,i+4,i+4)),t.drawImage(r,e,n,i,i)),t.restore())},f.prototype.processMouseUp=function(t){var i,i,n,e,s,i={cancel:!1,sheet:t.sheet};if(h.Worksheet.et(t.sheet,"preUploadFile",i),!i.cancel&&this.MEe(t))return i=t.sheet,n=t.row,e=t.col,this.Hne(i,n,e)?(this.CEe(t),!0):!(this.TRe(i,n,e)||(this.gEe(i),!i)||!t.isReservedLocation||((s=this.SEe(t)).click(),0))},f.prototype.processMouseEnter=function(t){var i,n,t;return!!this.MEe(t)&&(i=t.sheet,n=t.row,t=t.col,this.zxn={row:n,col:t},i.zw(),!0)},f.prototype.processMouseLeave=function(t){return this.MEe(t)&&(this.zxn=M,t.sheet.zw()),!1},f.prototype.processMouseMove=function(t){var i,i,n,e,s,i;return!!this.MEe(t)&&(n=t.sheet,e=t.row,s=t.col,this.zxn&&(null==(i=this.zxn)?void 0:i.col)===s&&(null==(i=this.zxn)?void 0:i.row)===e||(this.zxn={row:e,col:s}),!!this.Hne(n,e,s))&&((i=this.AEe(t))!==this.Wxn&&(this.Wxn=i,n.zw()),!0)},f.prototype.getHitInfo=function(t,i,n,e,s){var r,o,u,c,a,r,e,r=this;return s&&(o=s.sheetArea,l(o)||3===o)&&e?(u=e.x+r._marginLeft,c=e.x+e.width-r._marginRight,a=e.y+r._marginTop,r=e.y+e.height-r._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:o,sheet:s.sheet,cellStyle:n},u<=t&&t<=c&&a<=i&&i<=r&&(e.isReservedLocation=!0),e):M},f.prototype.getOperationRects=function(t){var i,n,e,s,r,n,e,s,n,o,s,n,i={},n=t.sheet,e=t.row,s=t.col,r=this.dEe(n,e,s),n=this.mEe(n,e,s,t.cellRect.width),e=n.iconSize,s=n.space,n=t.cellRect.y+(t.cellRect.height-e)/2,o={x:t.cellRect.x+s-2,y:n-2,width:e+4,height:e+4},s={x:t.cellRect.x+e+2*s-2,y:n-2,width:e+4,height:e+4};return 2===r.length?(i[r[0]]=o,i[r[1]]=s):1===r.length&&(i[r[0]]=o),this.isClearEnabled()&&(n={x:t.cellRect.x+t.cellRect.width-e-6,y:t.cellRect.y-2,width:e+4,height:e+8},i.clear=n),i},f.prototype.AEe=function(t){var i,n,e,s,r,s,i,n,e,s,n,t,r,i=t.sheet,n=t.row,e=t.col,s=this.mEe(i,n,e,t.cellRect.width),r=s.iconSize,s=s.space,i=this.dEe(i,n,e),n=t.cellRect.y+(t.cellRect.height-r)/2,e=t.x>=t.cellRect.x+s-2&&t.x<=t.cellRect.x+r+s+2,s=t.x>=t.cellRect.x+r+2*s-2&&t.x<=t.cellRect.x+2*r+2*s+2,n=t.y>=n-2&&t.y<=n+r+2,t=t.x>=t.cellRect.x+t.cellRect.width-r-6&&t.x<=t.cellRect.x+t.cellRect.width-2&&t.y>=t.cellRect.y-2&&t.y<=t.cellRect.y+r+6&&this.isClearEnabled(),r=e&&n?i[0]:s&&n?i[1]:t?"clear":M;return r},f.prototype.SEe=function(t){var i,n,e,i=this,n="sjs-fake-file-upload-dom";return document.getElementById(n)&&document.getElementById(n).remove(),(e=document.createElement("input")).type="file",e.style.display="none",e.accept=i.accept(),e.id=n,e.addEventListener("change",function(){i.TEe(t,e),e.remove()}),document.body.appendChild(e),e},f.prototype.IEe=function(t,i,n,e){var s=this.UBe(t,i,n);(0,j.fur)({row:i,col:n,value:e,oldValue:s,valuePath:this._valuePath},t,!0)},f.prototype.TEe=function(t,i){var n,e,t,i,s,s,n=t.sheet,e=t.row,t=t.col,i=i.files[0];i&&(i.size>1024*this.maxSize()?(s={row:e,col:t,maxSize:this.maxSize(),fileSize:i.size},n.jT(h.InvalidOperationType.sizeLimitExceeded,n._An(),s)):(s={name:i.name,blob:i},this.IEe(n,e,t,s)))},f.prototype.xEe=function(t,i){var n,e,s,r,n=t.sheet,e=t.col,s=t.row,r=this.UBe(n,s,e);if(this.Ile(r)){switch(i){case"preview":this.NEe(r,t);break;case"download":this.kEe(n,s,e);break;case"clear":this._Ee(n,s,e)}this.zxn=M,this.Wxn=M}},f.prototype.MEe=function(t){var i=t.sheet,n=t.col,t=t.row;return!(i.isActualProtected()&&i.getCell(t,n).locked())},f.prototype.DEe=function(t){var i;new o.Uxn(document.body,2e3,!0).rQ(t.name,t.dataUrl)},f.prototype.NEe=function(t,i){var n,e,i,i,e;this.previewCommand?(n=i.sheet,e=i.col,i=i.row,i=s(s({},t),{sheetName:n.name(),row:i,col:e}),"function"==typeof this.previewCommand?this.previewCommand(i):"string"==typeof this.previewCommand&&null!=(e=n.getParent())&&e.commandManager().execute(s({cmd:this.previewCommand},i))):this.DEe(t)},f.prototype.kEe=function(t,i,n){var t,e,i,t=this.UBe(t,i,n,!0);t&&(e=window.URL.createObjectURL(t.blob),(i=document.createElement("a")).href=e,i.download=t.name,i.type=t.type,i.click(),setTimeout(function(){window.URL.revokeObjectURL(e)}))},f.prototype._Ee=function(t,i,n){this.IEe(t,i,n)},f.prototype.CEe=function(t){this.Wxn===M&&(this.Wxn=this.AEe(t)),this.xEe(t,this.Wxn)},f.prototype.Je=function(t){var t,i,i={marginTop:t.marginTop,marginRight:t.marginRight,marginBottom:t.marginBottom,marginLeft:t.marginLeft,maxSize:t.maxSize,accept:t.accept,isPreviewEnabled:t.isPreviewEnabled,isDownloadEnabled:t.isDownloadEnabled,isClearEnabled:t.isClearEnabled};t.hasOwnProperty("valuePath")&&(i.valuePath=null!=(t=t.valuePath)?t:null),this.fromJSON(i)},f.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return c(j.defaultFileUploadProps,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},f.prototype.fromJSON=function(n){var e=this;c(j.defaultFileUploadProps,function(t){var i=n[t];void 0!==i&&(e["_"+t]=i)})},a=f,i.FileUpload=a,c(j.defaultFileUploadProps,function(i){a.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t="valuePath"===i&&void 0===t?null:t,this)}}),(0,u.registerFeatures)(),h.CellTypes.ti[19]=a},"./dist/plugins/celltype/fileUploadCellType/utils.js":function(t,f,i){"use strict";var n,i,i,e,s,N,r,o,u,c;function a(t,i,n){if(n||t){if("string"==typeof i)return(n||t)[i];if(n&&n.hasOwnProperty(i))return n[i];if(e(i)&&n)return n.cellValue}return t}function l(t,i){var n,e,s,r,n=typeof t,e;if(n!=typeof i)return!1;if("string"==n)return t===i;if("object"==n){if(t instanceof Blob||i instanceof Blob)return t===i;if(t&&i)return t.blob===i.blob&&t.dataUrl===i.dataUrl&&t.name===i.name}return!0}Object.defineProperty(f,"__esModule",{value:!0}),f.EJi=f.jfr=f.isFileInfoEqual=f.getValueByValuePath=f.fur=f.Wgt=f.Ile=f.defaultFileUploadProps=f.MIMETYPE_TO_FILE_EXTENSION_MAP=f.IMAGE_FILE_EXTENSIONS=f.ICON_MAP=f.getSR=void 0,n=i("Common"),i=i("./dist/plugins/celltype/celltypes.ns.js"),i=new n.Common.ResourceManager(i.SR,"CellTypes"),e=n.Common.lt.ht,f.getSR=i.getResource.bind(i),f.ICON_MAP={commonFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y29tbW9uIGZpbGUgaW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImNvbW1vbi1maWxlLWltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNTAsMiBDNTIuMjA5MTM5LDIgNTQsMy43OTA4NjEgNTQsNiBMNTQsNTggQzU0LDYwLjIwOTEzOSA1Mi4yMDkxMzksNjIgNTAsNjIgTDE0LDYyIEMxMS43OTA4NjEsNjIgMTAsNjAuMjA5MTM5IDEwLDU4IEwxMCwxOC4xMDEwNzQyIEwyMS45NjMzNzg5LDE4LjEwMTA3NDIgQzI0LjE3MjUxNzksMTguMTAxMDc0MiAyNS45NjMzNzg5LDE2LjMxMDIxMzIgMjUuOTYzMzc4OSwxNC4xMDEwNzQyIEwyNS45NjMzNzg5LDIgTDUwLDIgWiBNMjMsMiBMMjMsMTUgTDEwLDE1IEwyMywyIFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70iIGZpbGw9IiM1MTUxNTEiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",errorFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZXJyb3IgSW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImVycm9yLUltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0i57yW57uEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjAwMDAwMCwgOC4wMDAwMDApIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICA8cG9seWdvbiBpZD0i5b2i54q257uT5ZCILXBhdGjlpIfku70tMiIgZmlsbD0iI0ZGRkZGRiIgcG9pbnRzPSI2MCA0LjI2MzI1NjQxZS0xNCAwIDQuMjYzMjU2NDFlLTE0IDAgNDguOTQ3MzY4NCA2MCA0OC45NDczNjg0Ij48L3BvbHlnb24+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0yNi44MjYsMCBMMzIsMTEuMzMwMDc4MSBMMjIsMjMuMTIxMDkzNyBMMjksMzguODQzNzUgTDI0LjEyOCw0OCBMNCw0OCBDMS43OTA4NjEsNDggLTEuMTk2OTk2ODhlLTE1LDQ2LjIwOTEzOSAwLDQ0IEwwLDQgQy0yLjcwNTQxNWUtMTYsMS43OTA4NjEgMS43OTA4NjEsLTEuMDYxNzI2MTNlLTE1IDQsMCBMMjYuODI2LDAgWiBNNTYsMCBDNTguMjA5MTM5LC00LjA1ODEyMjUxZS0xNiA2MCwxLjc5MDg2MSA2MCw0IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDk0LDQ4IEwzNiwzOC42MjY5NTMxIEwyOSwyMy40OTgwNDY5IEwzOSwxMS4yNTM5MDYyIEwzMy44MzYsMCBMNTYsMCBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjRTVFNUU1Ij48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNi4zNjU2ODUxLDE1IEwyMy4wMzEsMjIuMDA3IEwyMiwyMy4xMjEwOTM3IEwyOSwzOC44NDM3NSBMMjQuMTI3LDQ4IEw0LDQ4IEMxLjc5MDg2MSw0OCAyLjc2Njg4MDE4ZS0xNCw0Ni4yMDkxMzkgMi44NDIxNzA5NGUtMTQsNDQgTDIuODQyMTcwOTRlLTE0LDMxLjIxMTA3MTIgTDE2LjM2NTY4NTEsMTUgWiBNNDguMzkxNjc2OCwyNi4wMTg3NTQyIEw2MCwzNS42NDIyNzM1IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDkzLDQ4IEwzNiwzOC42MjY5NTMxIEwzMy4zMDcsMzIuODA4IEwzNy44MjA3NjkyLDM3LjU1MjcyODggTDM3LjgyMjI2NTUsMzcuMDA5MzkxNCBMNDguMzkxNjc2OCwyNi4wMTg3NTQyIFogTTQ4LDcgQzUwLjIwOTEzOSw3IDUyLDguNzkwODYxIDUyLDExIEM1MiwxMy4yMDkxMzkgNTAuMjA5MTM5LDE1IDQ4LDE1IEM0NS43OTA4NjEsMTUgNDQsMTMuMjA5MTM5IDQ0LDExIEM0NCw4Ljc5MDg2MSA0NS43OTA4NjEsNyA0OCw3IFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNEM0QzRDMiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",preview:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cHJldmlldyBpbWFnZTwvdGl0bGU+CiAgICA8ZyBpZD0icHJldmlldy1pbWFnZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTEwLjAwMDE0NzMsMyBDMTIuMjM1MDA1NSwzIDE0LjI1ODM2MzUsMy45OTU2OCAxNS44Njk3MjE0LDUuMTYyMDIgQzE3LjQ4NzcyMjEsNi4zMzMyNiAxOC43NTY4NjU1LDcuNzI0NTggMTkuNDk4NTA4Nyw4LjYyNjYgTDE5LjMxMiw4Ljc3MyBMMTkuNDk4OTM3Myw4LjYyNzE2IEMyMC4xMjc1NzYyLDkuMzkzMjQgMjAuMTY0OTM0NiwxMC40MjkxMTIxIDE5LjYwOTY0MjgsMTEuMjI2Njk4OSBMMTkuNDk4NTgwMSwxMS4zNzMzMyBMMTkuMzQzMTk5NywxMS41NjAxMTc4IEMxOC41ODYwOTU5LDEyLjQ1OTk1MTIgMTcuMzc5ODU1NCwxMy43NDQ4MjI3IDE1Ljg2OTcyMTQsMTQuODM3OTggQzE0LjI1ODM2MzUsMTYuMDA0MzIgMTIuMjM1MDA1NSwxNyAxMC4wMDAxNDczLDE3IEM3Ljc2NTI4OTE4LDE3IDUuNzQxOTMxMTMsMTYuMDA0MzIgNC4xMzA2NDQ3LDE0LjgzNzk4IEMyLjUxMzU3MjU1LDEzLjY2NzQ0IDEuMjQ1MDAwNTYsMTIuMjc3MSAwLjUwMzE0MzA4MiwxMS4zNzUwOCBDMC4xNzk1MDAwOCwxMC45ODU5NSAwLDEwLjUwMjMyIDAsMTAgQzAsOS40OTc2OCAwLjE3OTUwMDA4LDkuMDE0MDUgMC41MDMyMTQ1MSw4LjYyNDkyIEMxLjI0NTAwMDU2LDcuNzIyODMgMi41MTM2NDM5OCw2LjMzMjU2IDQuMTMwNjQ0Nyw1LjE2MjAyIEM1Ljc0MTkzMTEzLDMuOTk1NjggNy43NjUyODkxOCwzIDEwLjAwMDE0NzMsMyBaIE0xMC4wMDAxNTQ3LDQgQzguMTA1MDUzNyw0IDYuMjkyMDc3NzYsNC44NjgwNSA0LjcyODMyNjk0LDYuMDIzMDUgQzMuMTcxNjI2MTMsNy4xNzI4NzUgMS45MzA1MjU0OCw4LjU1NjcgMS4xOTQ5MjUxLDkuNDY5Njc1IEMxLjA2NDgwMDAzLDkuNjI4ODI1IDEsOS44MTQxNSAxLDEwIEMxLDEwLjE4NTg1IDEuMDY0ODAwMDMsMTAuMzcxMTc1IDEuMTkxNjI1MSwxMC41MjYzNSBDMS45MzA1MjU0OCwxMS40NDMzIDMuMTcxNjI2MTMsMTIuODI3MTI1IDQuNzI4MzI2OTQsMTMuOTc2OTUgQzYuMjkyMDc3NzYsMTUuMTMxOTUgOC4xMDUwNTM3LDE2IDEwLjAwMDE1NDcsMTYgQzExLjg5NTMzMDcsMTYgMTMuNzA4MjMxNiwxNS4xMzE5NSAxNS4yNzE5ODI0LDEzLjk3Njk1IEMxNi44Mjg2MDgyLDEyLjgyNzIgMTguMDY5NzA4OSwxMS40NDM0NSAxOC44MDUzMDkzLDEwLjUzMDQ3NSBDMTkuMDY0NzM0NCwxMC4yMDg0MjUgMTkuMDY1MTg0NCw5Ljc5MjcgMTguODA0OTM0Myw5LjQ2OTA3NSBDMTguMDY5MjU4OSw4LjU1NjEgMTYuODI4MzgzMiw3LjE3MjY1IDE1LjI3MTk4MjQsNi4wMjMwNSBDMTMuNzA4MjMxNiw0Ljg2ODA1IDExLjg5NTMzMDcsNCAxMC4wMDAxNTQ3LDQgWiBNOS45OTk5NjA0NSw2IEMxMi4xNzA5ODU2LDYgMTQsNy43NTIwNzQyOCAxNCwxMCBDMTQsMTIuMjQ3OTI1NyAxMi4xNzA5ODU2LDE0IDkuOTk5OTYwNDUsMTQgQzcuODI5MDE0MzcsMTQgNiwxMi4yNDc5MjU3IDYsMTAgQzYsNy43NTIwNzQyOCA3LjgyOTAxNDM3LDYgOS45OTk5NjA0NSw2IFogTTkuOTk5OTUwOTMsNyBDOC4yOTU3MTY2LDcgNyw4LjM5MjUzMDg5IDcsMTAgQzcsMTEuNjA3NDY5MSA4LjI5NTcxNjYsMTMgOS45OTk5NTA5MywxMyBDMTEuNzA0MTg1MywxMyAxMywxMS42MDc0NjkxIDEzLDEwIEMxMyw4LjM5MjUzMDg5IDExLjcwNDE4NTMsNyA5Ljk5OTk1MDkzLDcgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=",download:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZG93bmxvYWQgZmlsZXM8L3RpdGxlPgogICAgPGcgaWQ9ImRvd25sb2FkLWZpbGVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTEuMDg4Nzc5NSwyLjM3ODY0NTkgTDE1Ljk2NTI4NTUsNyBMMTUuOTY1Mjg1NSw3IEwxNS45NjUyODU1LDggTDExLjA4ODc3OTUsMTIuNjIxMzU0MSBDMTAuODg2Nzg2NiwxMi44MTI3NzgxIDEwLjU2OTA4NTEsMTIuODA4NTExNSAxMC4zNzIzMDU3LDEyLjYxMTczMjEgQzEwLjE4MDkxNTIsMTIuNDIwMzQxNiAxMC4xODA5MTUyLDEyLjExMDAzNjQgMTAuMzcyMzA1NywxMS45MTg2NDU5IEMxMC4zNzQ2MTksMTEuOTE2MzMyNiAxMC4zNzY5NTU0LDExLjkxNDA0MjUgMTAuMzc5MzE0NiwxMS45MTE3NzYgTDE0LjQ1MTI4NTUsNy45OTk3MTQ1IEwxNC40NTEyODU1LDcuOTk5NzE0NSBMNS40NjUyODU1LDcuOTk5OTg0OTUgQzUuMTg5MTUxNDQsNy45OTk5OTMyNiA0Ljk2NTI5MzgxLDcuNzc2MTQ5MTEgNC45NjUyODU1LDcuNTAwMDE1MDUgQzQuOTY1Mjg1NSw3LjUwMDAxMDAzIDQuOTY1Mjg1NSw3LjUwMDAwNTAyIDQuOTY1Mjg1NSw3LjUgQzQuOTY1Mjg1NSw3LjIyMzg1NTE5IDUuMTg5MTQwNjksNi45OTk5OTMyNiA1LjQ2NTI4NTUsNi45OTk5ODQ5NSBMMTQuNDUxMjg1NSw2Ljk5OTcxNDUgTDE0LjQ1MTI4NTUsNi45OTk3MTQ1IEwxMC4zNzkzMzc4LDMuMDg4MTk5ODcgQzEwLjE4NDE1MzcsMi45MDA3MDU5NCAxMC4xNzc5MTk2LDIuNTkwNDg0MDkgMTAuMzY1NDEzNSwyLjM5NTI5OTk5IEMxMC4zNjc2ODczLDIuMzkyOTMyOTQgMTAuMzY5OTg0OCwyLjM5MDU4ODc5IDEwLjM3MjMwNTcsMi4zODgyNjc5IEMxMC41NjkwODUxLDIuMTkxNDg4NDcgMTAuODg2Nzg2NiwyLjE4NzIyMTg1IDExLjA4ODc3OTUsMi4zNzg2NDU5IFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70tM+Wkh+S7vSIgZmlsbD0iI0ZGRkZGRiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuNDY1Mjg1LCA3LjUwMDAwMCkgc2NhbGUoLTEsIC0xKSByb3RhdGUoLTkwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMC40NjUyODUsIC03LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE3LjE0NjM2MzYsMTEuMTQ2MzYzNSBDMTcuMDUyNTc5MSwxMS4yNDAxNDggMTYuOTk5OTI0OSwxMS4zNjczNjg2IDE3LDExLjQ5OTk5OSBMMTcsMTUuOTk5OTk5IEw0LDE1Ljk5OTk5OSBMNCwxMS40OTk5OTkgQzQsMTEuMjIzODU3NSAzLjc3NjE0MjQ2LDEwLjk5OTk5OSAzLjUsMTAuOTk5OTk5IEMzLjIyMzg1NzcxLDEwLjk5OTk5OSAzLDExLjIyMzg1NzUgMywxMS40OTk5OTkgTDMsMTYuNDk5OTk5IEMzLDE2LjYzMjYzMTIgMy4wNTI1NzkxMiwxNi43NTk4NTE5IDMuMTQ2MzYzNjIsMTYuODUzNjM2NCBDMy4yNDAxNDgxMiwxNi45NDc0MjA5IDMuMzY3MzY4NzksMTcuMDAwMDc1MSAzLjUsMTYuOTk5OTk5IEwxNy41LDE2Ljk5OTk5OSBDMTcuNjMyNjMxNCwxNy4wMDAwNzUxIDE3Ljc1OTg1MiwxNi45NDc0MjA5IDE3Ljg1MzYzNjUsMTYuODUzNjM2NCBDMTcuOTQ3NDIxLDE2Ljc1OTg1MTkgMTgsMTYuNjMyNjMxMiAxOCwxNi40OTk5OTkgTDE4LDExLjQ5OTk5OSBDMTgsMTEuMzY3MzY4NiAxNy45NDc0MjEsMTEuMjQwMTQ4IDE3Ljg1MzYzNjUsMTEuMTQ2MzYzNSBDMTcuNzU5ODUyLDExLjA1MjU3OSAxNy42MzI2MzE0LDEwLjk5OTkyNDcgMTcuNSwxMC45OTk5OTkgQzE3LjM2NzM2ODgsMTAuOTk5OTI0NyAxNy4yNDAxNDgxLDExLjA1MjU3OSAxNy4xNDYzNjM2LDExLjE0NjM2MzUgWiIgaWQ9Iui3r+W+hCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==",clear:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y2xlYXIgdXBsb2FkZWQgZmlsZTwvdGl0bGU+CiAgICA8ZyBpZD0iY2xlYXItdXBsb2FkZWQtZmlsZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTE2LjgyNTEzNjUsNC4wMTU0OCBDMTcuMDU4Mjg3OCwzLjc4MzE4NTQgMTcuMDU4Mjg3OCwzLjQwNjUxODQzIDE2LjgyNTEzNjUsMy4xNzQyMjA5NSBDMTYuNTkzMzMyLDIuOTQxOTI2MzUgMTYuMjE3MTU1MSwyLjk0MTkyNjM1IDE1Ljk4NDQ5NDUsMy4xNzQyMjA5NSBMMTAuMDAwMjM0OCw5LjE1ODcyNDYyIEw0LjAxNTQ4LDMuMTc0MjIwOTUgQzMuNzgzMTg1NCwyLjk0MTkyNjM1IDMuNDA2NTE4NDMsMi45NDE5MjYzNSAzLjE3NDIyMDk1LDMuMTc0MjIwOTUgQzIuOTQxOTI2MzUsMy40MDY1MTU1NiAyLjk0MTkyNjM1LDMuNzgzMTgyNTMgMy4xNzQyMjA5NSw0LjAxNTQ4IEw5LjE1ODg1Mzc4LDEwLjAwMDExMjggTDMuMTc0MjIwOTUsMTUuOTg1MTExNiBDMi45NDE5MjYzNSwxNi4yMTc1MjgyIDIuOTQxOTI2MzUsMTYuNTkzNDYwNCAzLjE3NDIyMDk1LDE2LjgyNTg3NTYgQzMuNDA2NTE1NTYsMTcuMDU4MjkyMiAzLjc4MzE4MjUzLDE3LjA1ODI5MjIgNC4wMTU0OCwxNi44MjU4NzU2IEwxMC4wMDAyMzQ4LDEwLjg0MTM3MTkgTDE1Ljk4NDQ5NDUsMTYuODI1ODc1NiBDMTYuMjE3MTU2NSwxNy4wNTgyOTIyIDE2LjU5MzQ1NjEsMTcuMDU4MjkyMiAxNi44MjUxMzY1LDE2LjgyNTg3NTYgQzE3LjA1ODI4NzgsMTYuNTkzODI2MyAxNy4wNTgyODc4LDE2LjIxNzUyNjcgMTYuODI1MTM2NSwxNS45ODUxMTE2IEwxMC44NDEzNjQ3LDEwLjAwMDExMjggTDE2LjgyNTEzNjUsNC4wMTU0OCBaIiBpZD0i6Lev5b6EIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"},f.IMAGE_FILE_EXTENSIONS=["jpg","jpeg","png","gif","bmp","svg","ico","webp"],f.MIMETYPE_TO_FILE_EXTENSION_MAP={"image/jpeg":f.IMAGE_FILE_EXTENSIONS[1],"image/jpg":f.IMAGE_FILE_EXTENSIONS[0],"image/png":f.IMAGE_FILE_EXTENSIONS[2],"image/gif":f.IMAGE_FILE_EXTENSIONS[3],"image/bmp":f.IMAGE_FILE_EXTENSIONS[4],"image/svg+xml":f.IMAGE_FILE_EXTENSIONS[5],"image/x-icon":f.IMAGE_FILE_EXTENSIONS[6],"image/webp":f.IMAGE_FILE_EXTENSIONS[7]},f.defaultFileUploadProps={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,maxSize:2048,accept:"",isPreviewEnabled:!0,isDownloadEnabled:!0,isClearEnabled:!0,valuePath:"dataUrl"},f.Ile=s=function(t){return t&&"string"==typeof t.name&&(t.blob&&t.blob instanceof Blob||t.dataUrl&&"string"==typeof t.dataUrl)},N=function(t){var i,i,n,n={name:""};return"string"==typeof t?n.dataUrl=t:t instanceof Blob?(n.blob=t,n.name=null!=(i=t.name)?i:""):t instanceof Object&&(n=t)&&t.hasOwnProperty("blob")&&t.blob instanceof Blob&&!t.hasOwnProperty("name")&&(t.name=null!=(i=t.blob.name)?i:""),(0,f.Ile)(n)?n:void 0},f.Wgt=r=function(t){var i=crypto&&crypto.randomUUID&&crypto.randomUUID();return n.Common.lt.ht(i)&&(i="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),i=32===t?i.split("-").join(""):i},f.fur=o=function(t,u,c,a){var l,M,h,g,I,t,i,n,e,s,t,r,o,o,l=t.row,M=t.col,h=t.value,g=t.oldValue,I=t.valuePath,t=t.fileGUID,i=u.GRe(),n=u.Ut.getFileGUID(l,M),e=i.Mdt(n);e&&i.iPt([n]),(s=N(h))?(t=null!=t?t:(0,f.Wgt)(),r=function(t){var i,i,n,e,s,r,o,i,n,i,n,n=t.name,e=t.dataUrl;a&&(t[s=null===(s=I)?"cellValue":I]=h),r=!1,o=u.BO(),-1<t.type.indexOf("image")?(o.getImage(e)&&(r=!0),o.addImage(e,"anonymous")):(r=!0,i=null==(i=null==(i=u.getParent())?void 0:i.options)?void 0:i.builtInFileIcons,n=n.split(".").pop(),(i=null==i?void 0:i[n])&&(o.getImage(i)||(r=!1),o.addImage(i,"anonymous"))),c&&(n={name:t.name,blob:t.blob,dataUrl:e},u.getParent().commandManager().execute({cmd:"uploadFile",sheetName:u.name(),row:l,col:M,newValue:n,oldValue:g,fileGUID:t.id,oldFileWrapper:null,newFileWrapper:t,valuePath:I})),r&&o.Zh()},s.blob&&s.dataUrl?(o=i.MRe(s.name,s.blob,s.dataUrl,t),c||u.Ut.setFileGUID(l,M,t),r(o)):(o=i.Bdt({id:t,name:s.name,dataUrl:s.dataUrl,blob:s.blob,postCreateFile:function(t){a&&(t.cellValue=h)}}))&&(c||u.Ut.setFileGUID(l,M,t),o.then(function(t){r(t)}))):c?u.getParent().commandManager().execute({cmd:"uploadFile",sheetName:u.name(),row:l,col:M,newValue:void 0,oldValue:g,fileGUID:n,oldFileWrapper:e,newFileWrapper:null,valuePath:I}):u.Ut.setFileGUID(l,M,void 0)},f.getValueByValuePath=a,f.isFileInfoEqual=l,f.jfr=u=function(t){var i,t,n,e,i;if(t.startsWith("data:image/svg+xml"))return t=atob(t.split(",")[1]),(e=(n=new DOMParser).parseFromString(t,"image/svg+xml")).documentElement},f.EJi=c=function(t,i,n,e){var n,s,r,n=Math.min(n/t,e/i),s,r;return{width:t*n,height:i*n}}},"./dist/plugins/celltype/hyperlinkcelltype.js":function(U,t,i){"use strict";var n,e,j,i,N,i,s,v,r,u,y,T,o,c,a,b,d,A,l,M,h,g,I,C,f,D,w,z,Z,G,p,B,Q,m,Y,x,L,O,e,S;function R(t,i){t.removeChild(i)}function k(){var t,n,t=S.call(this)||this;return t.typeName="8",t.AQe=!1,t.allowOverflow=!1,(n=t)._id=t.MY(),c(x,function(t,i){n["_"+t]=i}),t._onAction=function(t){var i,t,n,e,s,i,t,n,s,n=t&&t.sheet,e=n&&n.getParent(),s=t.row,i=t.col,t=t.sheetArea,n=n.getValue(s,i,t),s=P(this._target);n&&(e&&null!=(t=null==(i=e.docProps)?void 0:i.appDocProps)&&t.hyperlinkBase&&(n=q(e.docProps.appDocProps.hyperlinkBase,n)),l(r(n),s))},t}function P(t){return["_blank","_self","_parent","_top"][t]}function W(t,i,n,e,s,r){var o,u,c,t,o=0,u=0,c=t.width,t=t.height;return o=r=r||0,1===e?o=(c-i)/2:2===e?o=c-i-r:5===e&&(o=(c-i)/2),1===s?u=(t-n)/2:2===s&&(u=t-n),{x:o,y:u}}function H(t,i,n,e){var t,n,t=X(t,n,i),n=t.width;return n+=!0==(1!==i.hAlign&&!v(e))?e:0,t.width=n,t}function V(t,i,n,e,s){var t,n,t=X(t,n,i,e.width),n=W(e,t.width,t.height,i.hAlign,i.vAlign,s);return t.x=n.x,t.y=n.y,t}function J(t,i){var n,t,n=E(i),t=t-3-n;return 5===i.hAlign&&(t-=n),--t}function F(t,i,n,e){var i,n,i=J(i,n),n=j.q.Q3e(t);return 1===n.length&&0===n[0].prefixSpaceCount?b(0,j.q.Wt(n[0].word,e,!0)):i}function X(t,i,n,e){var s,r,o,s=u(i),r,o;return{x:0,y:0,width:5===n.hAlign&&e?F(t,e,n,i):Math.max(0,j.q.Wt(t,i,!0)),height:t.split(/\r\n|\r|\n/).length*s}}function _(t,i,n,e,s,r){var o,u,s,c,a,l,s,o,M,h,g,I,f,N,o=s.sheet,u=o.Dn;if(!v(n)&&(r=r||(s=o.getValue(s.row,s.col,s.sheetArea),v(s))?r:s+""))for(e=n.cellType.An(e,n,o.zoom()),r=r.replace(/\s+/g," "),c=n&&n.font?n.font:u.Nn(),c=u._n(c),a=[r],l=E(n),!n.wordWrap&&5!==n.hAlign||(s=e.width-3-l,5===n.hAlign&&(s-=l),r=(a=j.q.un(r,s,c)).join("\r\n")),o=V(r,n,c,e,l),M=e.y+o.y,h=0;h<a.length;h++)if(g=V(a[h],n,c,e,l),I=e.x+g.x,f=d(I+g.width,e.x+e.width),M=d((N=M)+g.height,e.y+e.height),I<=t&&t<f&&N<=i&&i<M)return!0;return!1}function E(t){return 8*(t.textIndent||0)}function K(t,i,n,e,s){var r,e,o,o,u,n,o,c,a,l,M,h,g,I,f,o,r=e&&e.sheet;if(r){if(o=r.Dn,u=i.font||o.Nn(),1<n&&(u=o._n(u)),n=E(i),i.wordWrap||s){if(i.wordWrap){if(o=e.row,c=e.col,a=e.sheetArea,l=0,M=r.Ut.findSpan(o,c,a)){if(M.row>=o&&M.rowCount<=1&&M.col>=c&&c===M.col&&(l=r.nn(c,a),1<M.colCount))for(h=c+1;h<c+M.colCount;h++)l+=r.nn(h,a)}else l=r.nn(c,a);if(e=N(i,1),0<(o=N(i,3))&&(l-=o),0<e&&(l-=e),g=j.q.un(t,l-3-n,u),s&&1<t.split(/\r\n|\r|\n/).length){for(f=I=0;f<g.length;f++)I=Math.max(I,H(g[f],i,u,E(i)).width);return I}s||(t=g.join("\r\n"))}}else t=t.replace(/\s+/g," ");return o=H(t,i,u,E(i)),s?o.width:o.height}return 0}function q(t,i){var t,n,i,t=t.replace(/:\/*/,"://"),n=(t=t.endsWith("://")?t:t.replace(/\/+$/,"")).endsWith("/")?"":"/",i=i.replace(/^\/+/,"");return"".concat(t).concat(n).concat(i)}n=this&&this.__extends||(O=function(t,i){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}O(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=t.HyperLinkTargetType=void 0,e=i("Common"),i=(j=i("Core")).CellTypes.Context,N=i.gn,i=j.CellTypes.Text,s=j.mt.En,v=e.Common.lt.ht,r=e.Common.zf.TY,u=j.mt.vt,y=j.mt.Tt,T=y.mozilla,o=j.GC$,c=o.each,a=null,b=Math.max,d=Math.min,A=Math.floor,l=window.open,M="position",h="absolute",g="margin",I="font",C="left",f="top",D="padding",w="border",z="box-sizing",Z="background-color",G="content-box",p="default",B="white",Q="div",m="hyperlinkInfo",(e=Y=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[e.blank=0]="blank",e[e.self=1]="self",e[e.parent=2]="parent",e[e.top=3]="top",x={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},n(k,S=i),k.prototype.MY=function(){var t,i;return v(this._id)&&(this._id="0"),i="id_"+(t=parseInt(this._id,10)),this._id=++t+"",i},k.prototype.AY=function(t,i,n,e,s,r,o,u,c,a){var l,M,h,g,l,I,f,h,N,d,D,u,v,r,w,j,b,M=1,h=C,g=o.hAlign,l=o.vAlign,I=u.lineHeight,f=c.length;if(M+=i,1===g?(M=s/2,h="center"):2===g&&(M=s-1,M-=i,h="right"),t.textAlign!==h&&(t.textAlign=h),h=1,N="alphabetic",h+=I-(u=I/2-(d=parseInt(u.fontInfo.fontSize,10))/2+(D=8<d?A((d-8)/5+2):1)-1),1===l?I<r&&(h=T?(r-a)/2+1:y.msie?(r-a)/2+.5:(r-a)/2,A(h)!==h&&(h+=.5),h+=I/2-u):2===l&&(h=r-a-2.5-u),t.textBaseline!==N&&(t.textBaseline=N),v=e+h,5===g)o.textDecoration=null!=(l=o.textDecoration)?l:1,r=s-3-2*i,S.prototype.Z3e.call(this,t,c,n,v,--r,s/2,1+i,I,o,d,D);else for(w=0;w<f;w++)t.fillText(c[w],n+M,v),j=t.measureText(c[w]).width,(b=o.textDecoration)&&this.le(t,b,n+M,v,j,d,D),v+=I},k.prototype.IY=function(t,i,n,e,s,r,o,u,c){var a,l,M,h,g,I,h,f,N,d,D,v,o,u,w,a=o.hAlign,l=o.vAlign,M=u.lineHeight,g=c.length,f=0,N=0,D=0,v=0;for(2!==a&&(D=1),2===o.vAlign&&(v=-2.5),v-=b(0,Math.round(M/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),o=u.fontInfo.fontSize,u=A((o-12)/21+1),t.lineWidth=u,t.beginPath(),w=0;w<g;w++)h=t.measureText(c[w]).width,h=(I=D+n+(d=W(new j.Rect(n,e,s,r),h,M*g,a,l,i)).x)+h,f=v+e+d.y+M,A(f)===f&&(f+=.5),N=f,t.moveTo(I,f),t.lineTo(h,N),t.stroke(),v+=M},k.prototype.paintValue=function(t,i,n,e,s,r,o,u){var c,i,a,l,M,h,g,I,f,N,N,h,g,d,I,f,M,N,D,c=this;if(t&&(i=c.getText(i,u),!v(i))){for(a=(i+="").split(/\r\n|\r|\n/),l=0;l<a.length;)a[l]=a[l].replace(/\s+/g," "),l++;i=a.join("\r\n"),M=!1,h=u.sheet.Ut,g=u.row,I=u.col,f=u.sheetArea,(N=c.AQe?c._Qe(u.sheet,g,I,f):h.getValueForKey(g,I,m,f))&&(c._id===N.id?M=N.visited:h.do("setValueForKey",g,I,m,void 0,f)),t.save(),t.beginPath(),(N=M?c._visitedLinkColor:c._linkColor)&&t.fillStyle!==N&&(t.fillStyle=N),(h=o.font)&&t.font!==h&&j.mt.bt(t,h),g=E(o),u.sheet.outlineColumn&&u.sheet.outlineColumn.Un(u.col)&&(g=0),I=[],M=f=0,(d=o.wordWrap)||5===o.hAlign?(N=s-3-g,5===o.hAlign&&(N-=g),1<(f=(I=j.q.un(i,--N,h)).length)&&0!==o.vAlign&&(M=(f-1)*(D=u.lineHeight))):I.push(i),t.rect(n,e,s,r),t.clip(),t.beginPath(),c.AY(t,g,n,e,s,r,o,u,I,M),5!==o.hAlign&&c.IY(t,g,n,e,s,r,o,u,I),t.restore()}},k.prototype.Rn=function(t,i,n,e){this.Bto&&(v(i.textDecoration)?i.textDecoration=1:2!==i.textDecoration&&4!==i.textDecoration||(i.textDecoration+=1),S.prototype.Rn.call(this,t,i,n,e))},k.prototype.getText=function(t,i){var n=this._text||t;return n=(v(n)||""===n)&&i.sheet&&i.sheet.getActualText?i.sheet.getActualText(t,i):n},k.prototype.j3=function(t,i,n,e){var s;t.Ai||(s=t.parent)&&s.j3(t,i,n,e)},k.prototype.getHitInfo=function(t,i,n,e,s){var r,o,r=this;return s&&(o=s.sheetArea,v(o)&&(o=3),n)&&e?{x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:o,isFocusAware:!0,sheet:s.sheet,isReservedLocation:_(t,i,n,e,s,r._text)}:a},k.prototype.processMouseDown=function(t){var i=t&&t.sheet,n=this;i&&!i.isEditing()&&t.isReservedLocation&&(n.xY=!0)},k.prototype.processMouseUp=function(t){var i,i,i=t&&t.sheet;i&&!i.isEditing()&&(i=this,t.isReservedLocation&&i.xY&&i.NY(t),i.xY=!1)},k.prototype.processMouseMove=function(t){var i,n,e,s,i,i=t.row,n=t.col,e=t.sheet,s=this;!e||e.isEditing()&&e.getActiveRowIndex()===i&&e.getActiveColumnIndex()===n||(i=e.Dg(),t.isReservedLocation?i&&(s.kY(e,t),i.style.cursor="pointer"):(s.DY(e),i&&(i.style.cursor=p)))},k.prototype.processMouseLeave=function(t){var t,i,i,t=t.sheet,i=this;i.xY=!1,i.DY(t),t&&(i=t.Dg())&&(i.style.cursor=p)},k.prototype.kY=function(t,i){var n,e,s,n,r,n,i,n=this;n._linkToolTip&&((e=n._Y()).className="gc-spread-hyperlink-celltype-tooltip",(s=o(e)).text(n._linkToolTip),r=(n=t.rt.it()).left+i.x,n=n.top+i.y+20,0===s.parent().length)&&((i=t&&t.qc())&&i.insertBefore(e,a),s.css(f,n).css(C,r))},k.prototype.DY=function(t){var i,t,i=this;i.EY&&((t=t&&t.qc())&&i.EY.parentElement===t&&R(t,i.EY),i.EY=a)},k.prototype._Y=function(){var t,i,t=this;return t.EY||(i=s(Q),o(i).css(M,h).css(g,0).css(D,2).css(w,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(z,G).css(Z,B).css(I,"9pt Arial"),t.EY=i),t.EY},k.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},k.prototype.processKeyUp=function(t,i){var n,e;return!!i.sheet&&(this.NY(i),!0)},k.prototype.getAutoFitWidth=function(t,i,n,e,s){return K(this._text||t,n,e,s,!0)},k.prototype.getAutoFitHeight=function(t,i,n,e,s){return K(this._text||t,n,e,s)},k.prototype.isImeAware=function(t){return!!this.Bto&&S.prototype.isImeAware.call(this,t)},k.prototype.NY=function(t){var i,n,e,s,r,o,i=t&&t.sheet,n=this,e=t.row,s=t.col,r=t.sheetArea,o;n.onClickAction().call(this,t),this.AQe?n.DQe(i,e,s,r):i.Ut.do("setValueForKey",e,s,m,{id:n._id,visited:!0},r),i.repaint(i.getCellRect(e,s,1===r?-1:a,2===r?-1:a)),n.j3(i,e,s,r)},k.prototype._Qe=function(t,i,n,e){return a},k.prototype.DQe=function(t,i,n,e){},k.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},k.prototype.Je=function(t){var t={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&Y[t.target],activeOnClick:t.activeOnClick};this.fromJSON(t)},k.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return c(x,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},k.prototype.fromJSON=function(n){var e=this;c(x,function(t){var i=n[t];v(i)||(e["_"+t]=i)})},k.prototype.jn=function(t){if(this.Bto)return S.prototype.jn.call(this,t)},k.prototype.Ke=function(){var n,e,s,n=this,s=new k;return c(x,function(t,i){(e=n["_"+t])!==i&&(s["_"+t]=e)}),s._onAction=n._onAction,s},L=k,t.HyperLink=L,c(x,function(i){L.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),j.CellTypes.ti[8]=L},"./dist/plugins/celltype/radiochecklistcelltype.js":function(j,t,i){"use strict";var n,Q,i,b,y,Y,R,a,it,M,l,h,g,nt,i,e,o,P,W,v,T,r,H,V,J,u,s,e,i,A,c,I,C,e,e,z,p,m,f,N;function F(t,i){return t.hasOwnProperty(i)}function d(t,i){return t instanceof Date&&i instanceof Date?y(t)===y(i):!g(t)&&!g(i)&&t.toString&&i.toString?t.toString()===i.toString():t===i}function x(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===T&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function D(){var t,n,t=z.call(this)||this;return t.typeName="11",t.defaultPadding=5,n=t,o(u,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function L(){return null!==p&&p.apply(this,arguments)||this}function O(){var t=null!==m&&m.apply(this,arguments)||this;return t.typeName="12",t}function w(){var t,n,t=N.call(this)||this;return t.typeName="13",t.defaultPadding=0,n=t,o(c,function(t,i){n["_"+t]=i="items"===t?[]:i}),n._boxSize=0,delete n.boxSize,t}function S(t,i,n,e,s,r){var o,o,s,o,o,o=i.getValue(n,e,r),o=t.wG(o,s),s={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:o,autoFormat:!1};i.dataRanges&&(o=i.dataRanges.getByPosition(n,e))&&(o=o.convertContext({sheet:i,row:n,col:e,sheetArea:r}))&&o.sheet!==i&&(s.sheetName=o.sheet.name(),s.row=o.row,s.col=o.col),i.Qy().execute(s),t.triggerButtonClicked(i,n,e,r)}function X(t,i,n,e,s){var i,r,n,o,u,i=i.zoom(),r=K(t._boxSize,n.font,i),n=st(t,n),o,u=e;return R(n,r)*(u=t._items.length<e?t._items.length:u)+t._itemSpacing.vertical*i*(u-1)}function _(t,i,n,e,s){var r,o,u,i,c,r=i.zoom(),o=K(t._boxSize,n.font,r),u=t.defaultPadding*r,i=et(t,i,n,e,s),c=0;return i.forEach(function(t){c+=t}),c+=s*(o+u)+(s-1)*t._itemSpacing.horizontal*r}function et(t,i,n,e,s){for(var r,o,u,u,c,c,r=[],o=0;o<t._items.length;o++)u=F(t._items[o],W)?t._items[o].text:t._items[o],u=i.Qt(u,n.font),(c=t.jY()).hasMargin&&(u=u+c.paddingLeft+c.paddingRight),c=Y(o%s),r[c=t._direction===V.vertical?Y(o/e):c]=r[c]===h?u:Math.max(r[c],u);return r}function K(t,i,n){var e=H*n;return"number"==typeof t&&0<=t?e=t*n:"auto"===t&&(e=P(i)/2),e}function st(t,i){var i,t,i=P(i.font),t=t.jY();return i=t.hasMargin?i+t.paddingTop+t.paddingBottom:i}function q(t,i,n,e){var n,s,n=k(t)*n,s=n;return 1===t.hAlign?s=(i.width-e)/2:2===t.hAlign&&(s=i.width-n-e),s}function $(t,i,n,e){var n,s,n=2*n,s=n;return 1===t.vAlign?i.height-n>e&&(s=(i.height-e-n)/2+n):2===t.vAlign&&(s=i.height-e-n),s}function tt(t,i,n,e,s){var r,o,u,c;if(t._direction===V.vertical){if(t._isFlowLayout){if(s!==h)for(r=t._items.length;0<r;){if(!(s<(o=X(t,i,n,r,a(t._items.length/r)))))return[r=R(r,1),a(t._items.length/r)];r-=1}return[t._items.length,1]}return[r=R(1,t._maxRowCount),a(t._items.length/r)]}if(t._isFlowLayout){if(e!==h)for(u=t._items.length;0<u;){if(!(e<(c=_(t,i,n,a(t._items.length/u),u))))return u=R(u,1),[a(t._items.length/u),u];u-=1}return[1,t._items.length]}return u=R(1,t._maxColumnCount),[a(t._items.length/u),u]}function k(t){var i=t.textIndent;return 1===t.hAlign||0===i||i===l||i===h?2:8*i}function E(u,c){for(var t,i,a,l,n,n,t,M,h,g,I,f,N,i,t,d,D,e,s,r,t=c.cellRect.width,i=c.cellRect.height,a=c.sheet,l=a.zoom(),n=a.Z_(c.row,c.col),n=n&&n.font,t=tt(u,a,c.cellStyle,t-1,i),M=t[0],h=t[1],g=et(u,a,c.cellStyle,M,h),I=K(u._boxSize,n,l),f=u.defaultPadding*l,N=R(st(u,c.cellStyle),I),i=_(u,a,c.cellStyle,M,h),t=X(u,a,c.cellStyle,M,h),d=q(c.cellStyle,c.cellRect,l,i),D=$(c.cellStyle,c.cellRect,l,t),e=function(t){var i,i,n,e,s,r,o,n,n,i,i=F(u._items[t],W)?u._items[t].text:u._items[t],i=a.Qt(i,c.cellStyle.font),n=Y(t/h),e=t%h;if(u._direction===V.vertical&&(n=t%M,e=Y(t/M)),s=new Q.Rect,r=0,(o=g.filter(function(t,i){return i<e})).forEach(function(t){r+=t}),s.x=d+r+e*(I+f+u._itemSpacing.horizontal*l),s.y=D+n*N+u._itemSpacing.vertical*l*n,n=u.jY(),s.width=(u._textAlign!==J.right||n.hasMargin?g[e]:i)+I+f,s.height=N,n=c.x-c.cellRect.x,i=c.y-c.cellRect.y,s&&s.contains(n,i))return{value:{value:F(u._items[t],v)?u._items[t].value:u._items[t]}}},s=0;s<u._items.length;s++)if("object"==typeof(r=e(s)))return r.value}function U(t,i){var n,e,s,n=!1,e=F(t,v)?t.value:t;if(i!==l)if(Array.isArray(i)){for(s=0;s<i.length;s++)if(d(i[s],e)){n=!0;break}}else n=d(i,e);return n}function Z(t,i,n,e){var s,r,o,u,c;if(e)return i;for(t===l&&(t=[]),Array.isArray(t)||(t=[t]),s={},n.forEach(function(t){s[F(t,v)?t.value:t]=!0}),r=t.length-1;0<=r;r--)s[t[r]]||t.splice(r,1);if(-1===(u=(o=t.slice()).indexOf(i)))o.push(i);else for(r=o.length-1;0<=r;r--)d(o[r],i)&&o.splice(r,1);return c=[],n.forEach(function(t){-1!==o.indexOf(t.value)&&c.push(t.value)}),c}n=this&&this.__extends||(C=function(t,i){return(C=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}C(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonList=t.CheckBoxList=t.RadioButtonList=t.SelectionMode=t.TextAlign=t.Direction=void 0,Q=i("Core"),i=i("Common"),b=i.Common.lt.tv,y=i.Common.ct.o0,Y=Math.floor,R=Math.max,a=Math.ceil,it="left",M="alphabetic",l=null,h=void 0,g=i.Common.lt.ht,nt=Q.mt.bt,i=Q.CellTypes.Base,e=Q.GC$,o=e.each,P=Q.mt.vt,W="text",v="value",T="string",r="number",H=12,(e=V=t.Direction||(t.Direction={}))[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",(e=J=t.TextAlign||(t.TextAlign={}))[e.left=2]="left",e[e.right=3]="right",u={items:l,direction:V.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:J.right,boxSize:H},n(D,z=i),D.prototype.paintValue=function(t,i,n,e,s,r,o,u){var c,a,U,l,M,h,g,I,f,N,d,D,h,v,w,j,b,y,T,A,C,g,z,p,Z,m,x,L,O,S,k,E,E,G,B,c=this;if(t){for(t.save(),t.rect(n+1,e+1,s-2,r-2),t.clip(),t.beginPath(),U=a=0,M=(l=u.sheet).zoom(),h=o.font,g=u.isPrinting,I=u.printZoomFactor,f=K(c._boxSize,h,M=g&&"number"==typeof I&&1!==I?I:M),N=c.defaultPadding*M,d=f/2,D=new Q.Rect(n+1,e+1,s-2,r-2),j=_(c,l,o,v=(h=tt(c,l,o,s-2,r-2))[0],w=h[1]),b=X(c,l,o,v,w),y=et(c,l,o,v,w),T=st(c,o),A=n+q(o,D,M,j),C=e+$(o,D,M,b),(g=o.font)&&t.font!==g&&nt(t,u.fontInfo.font),o.foreColor&&(t.fillStyle=o.foreColor),z=o.textDecoration,Z=8<(p=u.fontInfo.fontSize)?Y((p-8)/5+2):1,m=0,m=(U=P(o.font))/2-p/2+Z-1,x=A,L=C,S=O=0,f<p&&(O=c.OY(f),S=(T-m-H)/2+1),k=0;k<c._items.length;k++)n+s<A||e+r<C||(E=F(c._items[k],W)?c._items[k].text:c._items[k],a=l.Qt(E,o.font),t.textAlign=it,E=c._direction===V.vertical?y[Y(k/v)]:y[k%w],G=0,G=c._textAlign===J.left?(c.RY(t,c._items[k],i,a,A,C+O,E,T,m),A=A+E+N,t.save(),c.BY(t,i,c._items[k],A,C+S,d),t.restore(),f):(t.save(),c.BY(t,i,c._items[k],A,C+S,d),A=A+f+N,t.restore(),c.RY(t,c._items[k],i,a,A,C+O,E,T,m),E),z&&(B=this.jY(),c.le(t,z,A-(c._textAlign===J.right?0:E+N)+B.paddingLeft,C+T-m-B.paddingBottom,a,p,Z)),c._direction===V.vertical?(C+=R(T,f)+c._itemSpacing.vertical*M,(k+1)%v==0&&(x=x+E+f+N+c._itemSpacing.horizontal*M,C=e+$(o,D,M,b)),A=x):(A=A+G+c._itemSpacing.horizontal*M,(k+1)%w==0&&(A=n+q(o,D,M,j),L=L+R(T,f)+c._itemSpacing.vertical*M),C=L));t.restore()}},D.prototype.OY=function(t){return(t-H)/2},D.prototype.getText=function(t,i){return t},D.prototype.RY=function(t,i,n,e,s,r,o,u,c){var i=F(i,W)?i.text:i;t.textBaseline!==M&&(t.textBaseline=M),t.fillText(i,s,r+u-c)},D.prototype.getItemsBound=function(u,t,i,n){var c,a,l,e,s,r,o,M,t,i,n,h,g,I,f,N,d,t,i,D,v,w,j,b,c=this,a=u.zoom(),l=u.getActualStyle(t,i,n),e,s=Q.W.V("11pt "+u.currentTheme().bodyFont(),a);for(l.font&&(s=Q.W.x2e(l,a)),l.font=s.font,t=(M=u.getCellRect(t,i,r=1===n?-1:void 0,o=2===n?-1:void 0)).width,i=M.height,n=tt(c,u,l,t-1,i),h=n[0],g=n[1],I=et(c,u,l,h,g),f=K(c._boxSize,s.font,a),N=c.defaultPadding*a,d=R(st(c,l),f),t=_(c,u,l,h,g),i=X(c,u,l,h,g),D=q(l,M,a,t),v=$(l,M,a,i),w=[],j=function(t){var i,i,n,e,s,r,o,n,i=F(c._items[t],W)?c._items[t].text:c._items[t],i=u.Qt(i,l.font),n=Y(t/g),e=t%g;c._direction===V.vertical&&(n=t%h,e=Y(t/h)),s=new Q.Rect,r=0,(o=I.filter(function(t,i){return i<e})).forEach(function(t){r+=t}),s.x=D+r+e*(f+N+c._itemSpacing.horizontal*a)+M.x,s.y=v+n*d+c._itemSpacing.vertical*a*n+M.y,n=c.jY(),s.width=(c._textAlign!==J.right||n.hasMargin?I[e]:i)+f+N,s.height=d,s.x>M.x+M.width||s.y>M.y+M.height?w[t]=null:w[t]=s},b=0;b<c._items.length;b++)j(b);return w},D.prototype.BY=function(t,i,n,e,s,r){},D.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},D.prototype.getAutoFitWidth=function(t,i,n,e,s){var s,r,o,u,c,s=s&&s.sheet,r=k(n),o=tt(this,s,n),u,c;return(_(this,s,n,o[0],o[1])+r)/e},D.prototype.getAutoFitHeight=function(t,i,n,e,s){var r,s,o,u,r=s&&s.sheet,s=tt(this,r,n,+r.getColumnWidth(s.col)*e),o,u;return X(this,r,n,s[0],s[1])/e},D.prototype.getHitInfo=function(t,i,n,e,s){var r,o,u,t,i,s,o,s,c,r,u,o,a,r=this;return s&&(o=s.sheetArea,u=s.sheet,e=n.cellType.An(e,n,u.zoom()),g(o)||3===o)&&e?(t={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:o,sheet:u},i=u.zoom(),n.font&&(n.font=Q.W.x2e(n,i).font),c=_(r,u,n,o=(s=tt(r,u,n,e.width-1,e.height-2))[0],s=s[1]),r=X(r,u,n,o,s),u=e.x+q(n,e,i,c),o=e.y+$(n,e,i,r),(a=new Q.Rect(u,o,c,r)).contains(t.x,t.y)&&(t.isReservedLocation=!0),t):l},D.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},D.prototype.processMouseLeave=function(t){if(z.prototype.processMouseLeave.call(this,t),!t)return!1;this.pG=!1},D.prototype.processMouseUp=function(t){var i,n,e,e,s,r,t;if(t&&(n=t.sheet,(i=this).pG)&&n&&t.isReservedLocation){if(e={r:l},Q.CellTypes.Base.et(n,"beforeEditRadioCheckListCellType",e),e.r)return;if(i.pG=!1,e=t.row,s=t.col,r=t.sheetArea,t=E(i,t))return S(i,n,e,s,t.value,r),!0}return!1},D.prototype.wG=function(t,i){return Z(t,i,this._items,!0)},D.prototype.triggerButtonClicked=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},D.prototype.Je=function(t){var t={items:t.items,direction:t.direction&&V[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&J[t.textAlign],boxSize:t.boxSize};this.fromJSON(t)},D.prototype.toJSON=function(){var e,s,r,e=this,s={typeName:e.typeName};return o(u,function(t,i){var n;r=e["_"+t],("items"===t?r&&0<r.length:r!==i)&&(s[t]="object"==typeof r?b(r,!1):r)}),s},D.prototype.fromJSON=function(n){var e=this;o(u,function(t){var i=n[t];g(i)||(e["_"+t]=i)})},n(L,p=s=D),L.prototype.BY=function(t,i,n,e,s,r){var n=F(n,v)?n.value:n;t.beginPath(),t.fillStyle="white",t.arc(e+r,s+r,r,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(e+r,s+r,r,0,2*Math.PI),t.stroke(),i!==l&&d(i,n)&&(t.beginPath(),t.strokeStyle="black",t.arc(e+r,s+r,.5*r,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},t.RadioButtonList=e=L,n(O,m=s),O.prototype.BY=function(t,i,n,e,s,r){t.strokeStyle="black",t.strokeRect(e+.5,s+.5,2*r+.05,2*r+.05),t.fillStyle="white",t.fillRect(e+1,s+1,2*r-1,2*r-1);var n=U(n,i);i!==l&&n&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(e+3,s+r),t.lineTo(e+r,s+2*r-3.5),t.lineTo(e+2*r-1.5,s+3),t.stroke())},O.prototype.wG=function(t,i){return Z(t,i,this._items,!1)},t.CheckBoxList=i=O,(f=A=t.SelectionMode||(t.SelectionMode={}))[f.single=0]="single",f[f.multiple=1]="multiple",c={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:l,itemSpacing:{horizontal:5,vertical:5},selectionMode:A.multiple},n(w,N=s),w.prototype.RY=function(t,i,n,e,s,r,o,u,c){var n,i,a,l,n;t.save(),t.beginPath(),n=U(i,n),i=F(i,W)?i.text:i,a=this._selectedBackColor,l=this._selectedForeColor,n&&(t.fillStyle=a,t.fillRect(s+1,r+1,o-1,u-1),t.fillStyle=l),t.textAlign="center",t.textBaseline!==M&&(t.textBaseline=M),n=this.jY(),t.fillText(i,s+n.paddingLeft+(o-n.paddingLeft-n.paddingRight)/2,r+n.paddingTop+u-n.paddingTop-n.paddingBottom-c),t.restore()},w.prototype.wG=function(t,i){return Z(t,i,this._items,this._selectionMode===A.single)},w.prototype.jY=function(){var t,i,n,e,s,t=0,i=0,n=0,e=0;return this._padding&&(s=x(this._padding),t=typeof(t=parseInt(s[0],10))==r&&0<t?t:0,e=typeof(e=parseInt(s[1],10))==r&&0<e?e:0,i=typeof(i=parseInt(s[2],10))==r&&0<i?i:0,n=typeof(n=parseInt(s[3],10))==r&&0<n?n:0),{hasMargin:!0,paddingTop:t,paddingBottom:i,paddingLeft:n,paddingRight:e}},w.prototype.OY=function(t){return 0},w.prototype.toJSON=function(){var e,s,r,e=this,r=N.prototype.toJSON.call(this);return o(c,function(t,i){var n;s=e["_"+t],("items"===t?s&&0<s.length:s!==i)&&(r[t]="object"==typeof s?b(s):s)}),r},w.prototype.fromJSON=function(n){N.prototype.fromJSON.call(this,n);var e=this;o(c,function(t){var i=n[t];g(i)||(e["_"+t]=i)})},I=w,t.ButtonList=I,o(u,function(u){s.prototype[u]=function(t){var i,n,e,s,r,o,o,o,i="_"+u,n=this;if(0===arguments.length)return n[i];if("items"===u){for(e=[],s=0;s<t.length;s++)r=t[s],g(r.text)||g(r.value)?g(r.text)?g(r.value)?g(r)||"object"==typeof r||e.push({text:r,value:r}):(r.text=r.value,e.push(r)):(r.value=r.text,e.push(r)):e.push(r);t=e}if("itemSpacing"===u)o=n[i],n[i]={horizontal:o.horizontal,vertical:o.vertical},g(t.horizontal)||(o=parseInt(t.horizontal,10),isNaN(o))||(n[i].horizontal=o),g(t.vertical)||(o=parseInt(t.vertical,10),isNaN(o))||(n[i].vertical=o);else if("boxSize"===u){if(g(t))return n[i];"number"==typeof t&&0<=t&&(n[i]=t),"auto"===t&&(n[i]=t)}else n[i]=t;return n}}),Q.CellTypes.ti[11]=e,Q.CellTypes.ti[12]=i,o(c,function(u){I.prototype[u]=function(t){var i,n,e,s,r,o,o,o,i="_"+u,n=this;if(0===arguments.length)return n[i];if("items"===u){for(e=[],s=0;s<t.length;s++)r=t[s],g(r.text)||g(r.value)?g(r.text)?g(r.value)?g(r)||"object"==typeof r||e.push({text:r,value:r}):(r.text=r.value,e.push(r)):(r.value=r.text,e.push(r)):e.push(r);t=e}return"itemSpacing"===u?(o=n[i],n[i]={horizontal:o.horizontal,vertical:o.vertical},g(t.horizontal)||(o=parseInt(t.horizontal,10),isNaN(o))||(n[i].horizontal=o),g(t.vertical)||(o=parseInt(t.vertical,10),isNaN(o))||(n[i].vertical=o)):n[i]=t,n}}),Q.CellTypes.ti[13]=I},"./dist/plugins/celltype/rangecelltype.js":function(t,i,n){"use strict";var e,jt,s,c,bt,yt,n,Tt,At,Ct,o,u,e,r,a;function h(t){return t.map(function(t){return{start:t.start,size:t.size}})}function l(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}function M(){}function g(t,i,n,e,s){var r,i,r=a.call(this)||this;return r.allowOverflow=!1,r.typeName="16",i=1===arguments.length?new jt.Range(0,0,t.getRowCount(),t.getColumnCount()):new jt.Range(i,n,e,s),t&&i&&(r.GY=(new o).yN(t,i),r.UY=(new u).yN(t,i)),r}function I(t,i,U,n,e,s,Z){var r,o,u,c,a,G,l,B,Q,i,M,h,g,Y,I,R,P,W,f,N,d,H,s,V,J,D,F,X,_,K,q,$,tt,it,v,nt,w,et,st,j,b,y,T,b,rt,A,C,z,p,m,x,L,b,b,p,m,ot,ut,ct,O,S,at,lt,Mt,ht,gt,It,k,T,m,ft,m,m,m,T,E,Nt,dt,Dt,vt,wt,E;if(void 0===Z&&(Z=1),r=i.x,o=i.y,u=i.width,c=i.height,a=n.sheet,G=n.sheetArea,l=n.isPrinting,B=n.needTopGridline,Q=n.needLeftGridline,i=null!=(i=n.printZoomFactor)?i:1,M=[],h=[],g=[],Y=!0,I=[],R=a.BO(),P=s.rowCount,W=s.colCount,f=s.rowSize,N=s.colSize,d=s.cellStyleList,H=s.sparklines,e.HY(U),V=(s=e.zY()).baseRow,J=s.baseCol,F=(D=e.VY).hl,D.cg(new jt.Rect(0,0,u,c)),(X=new jt.Yx(D,D._y(1,3),D.Yy(1,3),3)).L_e.Nx(!0),_=e.YY(!0),o+=1,--c,r+=1,--u,q=K=0,f=f.map(function(t){var i=t.size*c,n=Ct(i);return 1<=(q+=i-n)&&(n++,q--),{start:Ct(t.start*c),size:n}}),N=N.map(function(t){var i=t.size*u,n=Ct(i);return 1<=(K+=i-n)&&(n++,K--),{start:Ct(t.start*u),size:n}}),$=D.options.rightToLeft){for(tt=[],it=0,v=W-1;0<=v;v--)tt.push({start:it,size:N[v].size}),it+=N[v].size;tt.reverse(),N=tt}for(nt=D.conditionalFormats,w=0;w<P;w++){for(et={row:w+V,y:o,height:c},st=[],j=0;j<W;j++)if(d[w][j]&&(y=(b=d[w][j]).style,T=b.isSpan,b=b.span,rt=!1,A=_[w][j],!T||b)){if(y=y.clone(!0),C=Ct(r+N[j].start),z=Ct(o+f[w].start),m=p=void 0,x=T?b.colCount:1,L=T?b.rowCount:1,p=N[b=$?j-x:j+x]?N[b].start:u,b=Ct(p-N[j].start),m=f[w+L]?f[w+L].start:c,p=Ct(m-f[w].start),et.y=z,et.height=p,A.formatStyle&&(A.formatStyle.h5(y),y=A.formatStyle),y.v5(F),m=At,T){for(m={row:w,col:j,x:Ct(C),y:Ct(z),width:Ct(b),height:Ct(p),rowCount:L,colCount:x},ot={},ut={},ct=[],S=O=void 0,O=lt=at=0;O<x-1;O++)ht=(Mt=N[j+O])?Mt.size:0,at+=ut[O]=ht;for(ut[O]=Ct(b)-at,S=0;S<L-1;S++)ht=(gt=f[w+S])?gt.size:0,lt+=ot[S]=ht;for(ot[S]=Ct(p)-lt,S=0;S<L;S++){for(It=[],k=0;k<x;k++)d[S+w]&&d[S+w][j+k]&&It.push(d[S+w][j+k].style);ct.push(It)}m.spanSizeInfo={styleList:ct,rowSizes:ot,colSizes:ut}}X.PN(w,j,Ct(C),Ct(z),Ct(b),Ct(p),y,m,B&&0===w,Q&&0===j),(T=y.formatter)&&(jt.util.St(T)?(m=a.parent&&a.parent.xO(T))&&(ft=m.getExpression())&&(m=(0,yt.formulaToExpression)(a,T.replace("@",JSON.stringify(A.value)),0,0,void 0,!1),(m=(0,yt.evaluateExpression)(a,m,0,0))instanceof bt.CalcError||(A.value=m)):(m=(0,jt.Wmr)(T,A.value))&&(y.foreColor=m)),T=null,H[w][j]&&(T=H[w][j].clone())&&(T.ZY=D.name(),T.WY=T.QY(D),T.KY=T.JY(D),T.O_r=D),A&&A.value&&"SparklineExValue"===A.value.typeName&&(I.push({value:A.value,x:C,y:z,width:b,height:p,option:n}),rt=!0),A.validStyle&&h.push({style:A.validStyle,x:C,y:z,width:b,height:p}),st.push({col:j+J,x:C,y:z,width:b,height:p}),M.push({data:rt?null:A.value,row:w,col:j,x:C,y:z,width:b,height:p,style:y,sparkline:T,baseRow:w+V,baseCol:j+J,conditionalFormats:nt,imageLoader:R,cellLayout:{row:w,col:j,x:C,y:z,width:b,height:p}}),y&&y.decoration&&y.decoration.icons&&0<y.decoration.icons.length&&g.push({style:y,x:C,y:z,width:b,height:p})}0<st.length&&D.Dn.mfe(g,st,et,l,a,G)}for(t.save(),B&&(o-=2,c+=4),Q&&(r-=2,u+=4),t.rect(r,o,u,c),t.clip(),0<M.length&&D.Dn.eO(t,M,G,l,i,a,V,J,Z),X.paint(t,i,l),0<h.length&&D.Dn.EO(t,h),0<g.length&&D.Dn.que(t,g,{isPrinting:l,printZoomFactor:i,sheet:a,imageLoader:R}),t.restore(),w=0;w<I.length;w++)Nt=(E=I[w]).value,dt=E.x,Dt=E.y,vt=E.width,wt=E.height,E=E.option,Tt.dn(t,Nt,dt,Dt,vt,wt,E)}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.paintRangeTemplate=i.RangeTemplate=i.qY=i.$Y=void 0,jt=n("Core"),s=n("Bindings"),c=n("Sparkline"),bt=n("CalcEngine"),yt=n("SheetsCalc"),n=jt.CellTypes.Base,Tt=jt.CellTypes.Context,At=null,Ct=Math.floor,l.prototype.yN=function(t,i){var n=this,e=i.row,s=i.col,r=i.rowCount,o=i.colCount;return n.FY=e,n.PY=s,n.Sx=r,n.Tx=o,n.TP=n.ZF(t,i),n.tZ=n.nZ(t,i),n},l.prototype.eZ=function(){return this.tZ},l.prototype.nZ=function(t,i){for(var n,e,s,r,o,u,c,a,l,M,h,g,I,f,e,s,N,d,D,n=this,e=i.row,s=i.col,r=i.rowCount,o=i.colCount,u=0,c=[],a=0,l=[],M=0,h=e+r,g=s+o,I=e;I<h;I++)M=t.getRowHeight(I),a+=M,l.push(M);for(f=s;f<g;f++)M=t.getColumnWidth(f),u+=M,c.push(M);return M=0,e=l.map(function(t){var i=M/a,n;return M+=t,{start:i,size:t/a}}),M=0,s=c.map(function(t){var i=M/u,n;return M+=t,{start:i,size:t/u}}),N=n.ZF(t,i),{rowCount:r,colCount:o,rowSize:e,colSize:s,cellStyleList:d=n.iZ(t,i,N,e,s),sparklines:D=n.rZ(t,i),totalHeight:a,totalWidth:u}},l.prototype.oZ=function(t,i,n,e,s){for(var r,o,u,c,a,l,M,h,g,r=null,o=0,u=s;o<u.length;o++)if(a=(c=u[o]).rowOffset,l=c.colOffset,M=c.rowCount,h=c.colCount,(g=new jt.Range(a+n,l+e,M,h)).contains(t,i)){r=c;break}return r},l.prototype.aZ=function(t,i,n){for(var e,s,r,e,o,u,c,a,l,M,e=[0,0],s=e[0],r=e[1],e=t.rowOffset,o=t.colOffset,u,c,a=e+t.rowCount,l=o+t.colCount,M=e;M<a;M++)r+=i[M]?i[M].size:0;for(M=o;M<l;M++)s+=n[M]?n[M].size:0;return{width:s,height:r}},l.prototype.iZ=function(t,i,n,e,s){for(var r,o,u,c,a,l,M,h,g,I,r=i.row,o=i.col,u=i.rowCount,c=i.colCount,a=[],l=r;l<r+u;l++){for(M=[],h=o;h<o+c;h++)(g=this.oZ(l,h,r,o,n))&&g.rowOffset+r===l&&g.colOffset+o===h?(I=this.aZ(g,e,s),M.push({style:t.getActualStyle(l,h,3,!0),spanWidth:I.width,spanHeight:I.height,isSpan:!0,span:g})):M.push(g?{style:t.getActualStyle(l,h,3,!0),isSpan:!0}:{style:t.getActualStyle(l,h,3,!0)});a.push(M)}return a},l.prototype.ZF=function(t,i){for(var t,n,e,s,r,o,u,c,a,t=t.Ut.getSpans(),n=[],e=i.row,s=i.col,r=i.rowCount,o=i.colCount,u=0,c=t;u<c.length;u++)(a=c[u]).intersect(e,s,r,o)&&n.push({rowOffset:a.row-e,colOffset:a.col-s,rowCount:a.rowCount,colCount:a.colCount});return n},l.prototype.rZ=function(t,i){for(var n,e,s,r,o,u,c,a,l,n=i.row,e=i.col,s=i.colCount,r=i.rowCount,o=[],u=n;u<n+r;u++){for(c=[],a=e;a<e+s;a++)l=t.getSparkline(u,a),c.push(l?l.clone():null);o.push(c)}return o},l.prototype.toJSON=function(){var t,i,n,e,s,r,o,u,t,c,a,l,M,t=this.eZ(),i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,r=t.cellStyleList,o=t.sparklines,u=t.totalWidth,t=t.totalHeight,c,a,l,M;return{rowCount:i,colCount:n,rowSize:h(e),colSize:h(s),cellStyleList:r.map(function(t){return t.map(function(t){var i,n,e,s,t;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,{style:i.toJSON(),spanWidth:n,spanHeight:e,isSpan:s,span:t}):null})}),sparklines:o.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:u,totalHeight:t}},l.prototype.fromJSON=function(t){var i,n,e,s,r,o,u,t,e,s,r,o;t&&(i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,r=t.cellStyleList,o=t.sparklines,u=t.totalWidth,t=t.totalHeight,e=h(e),s=h(s),r=r.map(function(t){return t.map(function(t){var i,n,e,s,t,r;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,r=null,i&&(r=new jt.Style).fromJSON(i),{style:r,spanWidth:n,spanHeight:e,span:t,isSpan:s}):null})}),o=o.map(function(t){return t.map(function(t){var i,n;if(t&&c.SparklineSetting)return i=new c.Sparkline,n=new c.SparklineSetting(t.setting),i.fromJSON(t.sp),i.setting(n),i.sparklineType(t.sparklineType),i})}),this.tZ={rowCount:i,colCount:n,rowSize:e,colSize:s,cellStyleList:r,sparklines:o,totalWidth:u,totalHeight:t})},l.prototype.L0=function(){this.tZ=null},o=l,i.$Y=o,M.prototype.yN=function(t,i,n){var e=this;return e.Z5=i,e.VY=new jt.Worksheet,e.uZ=t.parent&&t.parent.options.allowDynamicArray,e.VY.getCalcService&&(e.VY.getCalcService().allowDynamicArray=e.uZ,e.sZ=e.cZ(t)),e.fZ(t,n),e},M.prototype.cZ=function(t){for(var i,n,e,s,r,o,u,c,a,l,M,h,g,I,M,i=this.Z5,n=i.row,e=i.col,s=i.colCount,r=i.rowCount,o=[],u=t.b3&&t.b3(),c=n;c<n+r;c++)for(a=e;a<e+s;a++)(l=t.getFormula(c,a))&&(M=u&&u.sT(c,a))&&M.isDynamicArray&&(h=M.row,g=M.col,I=M.rowCount,M=M.colCount,1<I&&o.push({row:h+1,col:g,rowCount:I-1,colCount:M}),1<M)&&o.push({row:h,col:g+1,rowCount:1,colCount:M-1});return o},M.prototype.lZ=function(){var t,i,n,e,s,r,o,u,c,r,t,i=this.sZ,n=this.VY;if(i)for(e=0,s=i;e<s.length;e++)o=(r=s[e]).row,u=r.col,c=r.rowCount,r=r.colCount,n.clear(o,u,c,r,3,1)},M.prototype.HY=function(t){var i,t;s.CellBindingSource&&((i=this.VY).suspendEvent(),t=new s.CellBindingSource(t),this.lZ(),i.setDataSource(t),i.resumeEvent())},M.prototype.fZ=function(t,i){var n,e,i,i,s,r,o,u,n,e=this.VY,i=t.toJSON({includeBindingSource:!0,ignoreFormula:!!i,mOi:!0});if(delete i.charts,delete i.shapes,e.suspendCalcService(),e.fromJSON(JSON.parse(JSON.stringify(i)),void 0,void 0,{mOi:!0}),e.dataRanges&&!e.dataRanges.isEmpty())for(i=e.dataRanges.all(),s=t.parent,r=0,o=i;r<o.length;r++)(u=o[r]).afterFromJSON(s);e.resumeCalcService(),this.hZ()},M.prototype.hZ=function(){for(var t,i,n,e,s,r,o,u,c,a,t=this,i=t.Z5,n=i.row,e=i.col,s=i.colCount,r=i.rowCount,o=[],u=[],c=n;c<n+r;c++){for(u=[],a=e;a<e+s;a++)u.push(t.dZ(c,a,3));o.push(u)}this.vZ=o},M.prototype.zY=function(){var t=this.Z5,i,n;return{baseRow:t.row,baseCol:t.col}},M.prototype.YY=function(t){for(var i,n,e,s,r,o,u,c,a,l,M,h,g,I,f,N,i=this.VY,n=this.Z5,e=n.row,s=n.col,r=n.colCount,o=n.rowCount,u=[],c=e;c<e+o;c++){for(a=[],M=l=void 0,h=s;h<s+r;h++)g=i.getText(c,h),I=i.getValue(c,h,3,1),f=i.Jt.$t(c,h,3,1),N=i.getBindingPath(c,h),l=this.mZ(c,h,3),M=this.gZ(i,c,h,I,t),a.push({value:f,formatStyle:l,text:g,validStyle:M,bindingPath:N});u.push(a)}return u},M.prototype.dZ=function(t,i,n){var e,t,e;return this.VY.b8&&(t=this.VY.getDataValidator(t,i,n))?t.highlightStyle():null},M.prototype.gZ=function(t,i,n,e,s){var s,t,e;return s&&t.isValid&&!t.isValid(i,n,e)?(t=(s=this.Z5).row,e=s.col,this.vZ[i-t][n-e]):null},M.prototype.mZ=function(t,i,n){var e=this.VY.conditionalFormats;return e?e.bL(new jt.Style,t,i,n):null},M.prototype.getCellValueInfo=function(t){for(var i,n,e,s,r,o,u,c,a,l,i=this.Z5,n=i.row,e=i.col,s=i.colCount,r=i.rowCount,o=[],u=t.Ut,c=n;c<n+r;c++){for(a=[],l=e;l<e+s;l++)a.push({bindPath:t.getBindingPath(c,l),formula:t.getFormula(c,l),value:u.getValue(c,l,3,At,1)});o.push(a)}return o},M.prototype.setValueToDataStruct=function(t,i,n,e){e[t]||(e[t]={}),e[t][i]=n},M.prototype.toJSON=function(){var t,i,n,e,s,r,o,u,t=this.VY,i=this.uZ,n=this.sZ.map(function(t){var i,n,e,s;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),e=this.Z5,s,r,o,u;return{spillRanges:n,allowDynamicArray:i,range:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},M.prototype.fromJSON=function(t){var i,n,t,e,s,r,t;t&&((n=(i=this).VY=new jt.Worksheet).suspendCalcService&&n.suspendCalcService(),i.sZ=t.spillRanges||t.spillRangs,i.uZ=t.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=i.uZ),n.fromJSON(JSON.parse(t.templatejson)),i.lZ(),e=(t=t.range).row,s=t.col,r=t.rowCount,t=t.colCount,i.Z5=new jt.Range(e,s,r,t),this.hZ(),n.resumeCalcService)&&n.resumeCalcService()},M.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},u=M,i.qY=u,e(g,a=n),g.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},g.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},g.prototype.updateTemplate=function(t,i){t&&i&&(this.GY.yN(t,i),this.UY.yN(t,i))},g.prototype.paintContent=function(t,i,n,e,s,r,o,u){var c,a,a,c=this.UY,a=this.GY;c&&a&&(a=this.GY.eZ(),o.cellPadding&&(u.needTopGridline=!0,u.needLeftGridline=!0),I(t,{x:n,y:e,width:s,height:r},i,u,c,a))},g.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},g.prototype.fromJSON=function(t){t.layout&&(this.GY=new o,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new u,this.UY.fromJSON(t.resolver))},i.RangeTemplate=e=g,jt.CellTypes.ti[16]=e,i.paintRangeTemplate=I},Common:function(t){"use strict";t.exports=GC.Spread},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},Core:function(t){"use strict";t.exports=GC.Spread.Sheets},Bindings:function(t){"use strict";t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(t){"use strict";t.exports=GC.Spread.Sheets.Sparklines}},e={},t=s("./dist/plugins/celltype/celltypes.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellTypes=t}();