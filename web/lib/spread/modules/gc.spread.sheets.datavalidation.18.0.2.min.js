/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,r,t,n,e;function o(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t](n,n.exports,o)),n.exports}i={"./dist/plugins/validation/datavalidation-event.js":function(i,t,n){var U,t,R,q,Q,Y,J,P,W,X,G,Z,H,N,K,_,z,$,tt,nt,it,rt,et,ot,at,ut,st,ft,ct,lt,ht,dt,vt,gt,mt,At,pt,bt;function wt(t){for(var n,i,r,e,n={},i=[],r=0;r<t.length;r++)n[e=t[r].text]||(n[e]=!0,i.push(t[r]));return i}Object.defineProperty(t,"__esModule",{value:!0}),U=n("Core"),t=n("Common"),R=n("CalcEngine"),q=n("./dist/plugins/validation/datavalidation.js"),Q=t.Common.lt.ht,Y=t.Common.ct,J=t.Common.zf,P=U.mt,W=U.Ec,X=P.pi(),G=P.Tt,Z=U.GC$,H=P.En,N=P.yt,K=P.vi,_=document,z=Math.max,$=Math.min,tt="position",nt="absolute",it="border",rt="padding",et="box-shadow",ot="font",at="background-color",ut="top",st="left",ft="z-index",ct="outline",lt="auto",ht="white",dt="none",vt="size",gt="gcUIElement",mt="min-height",At="min-width",pt="max-width",bt="word-wrap",Z.extend(U.nk.prototype,{PA:function(n,i){var r,e,t,o,a,u,s,u,a,f,f,f,c,s,l,h,d,v,u,a,s,t,u,g,m,A,p,b,w,C,O,k,V,M,y,a,s,t,f,u,a,s,f,T,D,S,u,f,j,x,F,I,I,t,F,L,E,u,x,t;function B(t,n){if(t&&t[n])return"function"==typeof t[n]?t[n]():t[n]}if((t=(e=(r=this).Mf)&&e.parent)&&(o=e.G1())&&((a=t.getActiveSheet())||(u=t.getActiveSheetTab())&&(a=u.Mf),a)&&e.name()===a.name()&&(u=n,a=i,(s=e).dataRanges&&(f=e.dataRanges.getByPosition(n,i))&&(f=f.convertContext({sheet:e,row:n,col:i,sheetArea:U.SheetArea.viewport}))&&(s=f.sheet,u=f.row,a=f.col),f=s.getDataValidator(u,a))&&(c=e.getCellRect(n,i),!r.Ek(c))&&(q.DefaultDataValidator.et(r,"beforeUpdateDataValidationUI",s={r:null}),!s.r)&&(l=e.options.rightToLeft,h=t.j2(),d=t.getHost(),v=P.gi(d),B(f,"showInputMessage")&&B(f,"inputMessage")&&(s=(u=J.Vi)((a=J.j0)(B(f,"inputTitle")),"\n","<br/>"),t=u(a(B(f,"inputMessage")),"\n","<br/>"),u=H("span"),Z(u).css(tt,nt).css(it,"1px #C0C0C0 solid").css(rt,"3px 8px 3px 8px").css(at,"#FFFFFF").css(et,"1px 2px 5px rgba(0,0,0,0.4)").css(ot,"normal normal normal 12px/normal Arial").width(lt).height(lt).css(ut,c.y+c.height+5).css(st,c.x+(l?0:c.width/2)).css(mt,"15px").css(At,"20px").css(pt,"200px").css(bt,"break-word").css(ft,v).html((Q(s)||""===s?"":"<b>"+s+"</b><br/>")+t).attr(gt,"gcValidationInputMessage").appendTo(h),e.KD=u),f)&&3===B(f,"type")&&B(f,"inCellDropdown")&&B(f,"condition")){for(g=wt(g=B(f,"condition").getValidListImp(e,n,i)),m=B(f,"condition").KJ(),A=g.length,p=H("select"),b=e.getText(n,i),w=-1,C=_.createDocumentFragment(),O=new RegExp(String.fromCharCode(32),"g"),k=String.fromCharCode(160),V=0;V<A;V++)M=g[V].text,Q(M)||R&&M instanceof R.CalcError||(w<0&&M===b&&(w=V),M instanceof Date&&(M=Y.Pe(M,"M/d/yyyy h:mm:ss")),(y=H("option")).value=M,y.text=M.replace(O,k),C.appendChild(y));p.appendChild(C),p.selectedIndex=0<w?w:0,a=e.getActualStyle(n,i),s=e.Dn,t=a&&a.font?a.font:s.Nn(),1<e.zoom()&&(t=s._n(t)),(f=e.Ut.getSpans(W(n,i,u=1,1)))&&0<f.length&&f[0]&&(u=f[0].colCount),a=i+u-1==e.getColumnCount()-1,s=e.Gt(n),f=e.parent&&e.parent.options.useTouchLayout,s=$(f?50:15,s),D=G.safari&&(X.ipad||X.iphone),S=X.android,F=x=j=f=u=void 0,F=D?(u=c.width+3,f=c.height+3,j=c.y-1.5,x=c.x-1.5,ht):(u=z(c.width+(a?0:s),e.defaults.colWidth),f=8<A?140:lt,j=c.y+c.height,x=(I=c.x+c.width+(a?0:s)-u)<e.uw().left?c.x:I,""),I=Z(p).css(ct,dt).css(tt,nt).css(ot,N(t)).css(ft,v).css(at,F).width(u).height(f).css(st,x).attr(gt,"gcValidationSelect").appendTo(h).attr(vt,2<A?A:2).hide().bind("click",function(){S||(r.jk(p,n,i,g,m),D&&Z(e.a6t).show())}).bind("keydown",function(t){13!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey?27!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||Z(p).hide():r.jk(p,n,i,g,m),D&&Z(e.a6t).show()}).bind("change",function(){S&&r.jk(p,n,i,g,m)}),t=Z(d).height(),f=I.outerHeight()+1,D||(t<f+j&&f<j?j=c.y-f:(F=d.getBoundingClientRect(),(u=(L=window.innerHeight)-((E=F.y)+j))<f&&I.height(u))),I.css(ut,j),D&&I.bind("blur",function(){r.jk(p,n,i,g,m),Z(e.a6t).show()}),e.gf=p,x=l?c.x-(a?0:s+3):c.x+c.width-(a?s:0),(t=H("input")).type="image",t.src=(0,q.Hrt)(),t.alt="v",Z(t).css(tt,nt).width(s).height(s).css(ut,c.y+c.height-(s+3)).css(st,x).css(ft,v).css(at,ht).css(it,"1px solid gray").attr(gt,"gcValidationButton").appendTo(h).bind("click",function(t){var n,n;e.isEditing()&&!e.endEdit()||(n=e.gf,Z(n).toggle().focus(),n=n.options[n.selectedIndex],Q(n)||n.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),D&&Z(e.a6t).toggle(),K(t))}),e.a6t=t}}})},"./dist/plugins/validation/datavalidation.js":function(y,t,n){var i,D,r,g,n,e,c,U,S,j,x,F,o,h,d,I,a,R,s,v,L,u,q,Q,Y,J,P,E,m,W,X,G,B,Z,H,T,N,K,_,z,$,A,tt,p,nt,f,n,it,rt,et,ot,at,ut,st,ft,ct,n,l,lt,ht,dt,vt,gt,b,i,mt,e,i,e,i,e,i,e;function At(t){if(I(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var n=u.Xf(v,t,!0);if(!isNaN(n)&&n.toString()===t)return n}return v}function pt(t){return!I(t)&&t instanceof Date?R(t):t}function bt(t,n){var i,r,e;if(!I(t))return 1===t||2===t?i=Ot(n.operator,n.value1,n.value2,1===t):3===t?n.value?i=jt(n.value):n.formula&&(i=St(n.formula)):4===t||5===t?(r=n.value1,e=n.value2,r&&"/OADate("===r.substr(0,8)&&(r=nt.dJ(r)),e&&"/OADate("===e.substr(0,8)&&(e=nt.dJ(e)),i=(5===t?Mt:Vt)(n.operator,r,e)):6===t?i=yt(n.operator,n.value1,n.value2):7===t&&void 0!==n.formula&&(i=Dt(n.formula)),i?i.condition():void 0}function wt(t,n,i,r,e,o){var a,u,s,f,c,l,h,d,o,o,s,f,u,v,d,n,r,i,e,e,l,a;return t.intersect(n,i,r,e)?(a=t.rowCount,u=t.colCount,s=p(0,t.row),f=p(0,t.col),h=l=c=!1,n=p(0,n),i=p(0,i),d=(o=o||[-1,-1])[0],o=o[1],-1===a&&(a=d-s,l=!0),-1===u&&(u=o-f,c=!0),-1===e&&(e=o-i,h=!0),s=(o=s)+a-1,u=(f=f)+u-1,d=(v=n)+(r=-1===r?d-n:r)-1,r=(n=i)+e-1,i=[],-1!==o&&-1!==f&&-1!==v&&-1!==n&&(0<n-f&&(e=A(o,f,l?-1:a,n-f),i.push(e)),0<u-r&&(e=A(o,1+r,l?-1:a,u-r),i.push(e)),0<v-o&&(l=A(o,p(n,f),v-o,c&&h?-1:tt(r,u)-p(n,f)+1),i.push(l)),0<s-d)&&(a=A(1+d,p(n,f),s-d,c&&h?-1:tt(r,u)-p(n,f)+1),i.push(a)),i.c6t=!0,i):[t]}function w(t,n){var n;if(!I(t))return"string"==typeof t&&(t=G(t)),t=3===n||!(t=4!==n&&5!==n||(n=parseFloat(t),isNaN(n))?t:z(t))||t instanceof Date?t:W(t)}function C(t){var n=this;n.assignId(),n.l6t=a(et),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n._S=[]}function O(i,t,n,r){return q(i,t,n,r,function(t,n){this.LEr(i,t)})}function Ct(){return"data:image/png;base64,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"}function k(t){return o&&t&&"="===t[0]}function Ot(t,n,i,r){var e,o,a,u,n,s,f,i,e=v,o=v,a=v,u=v;return k(n)?e=d(n,"="):o=n,k(i)?a=d(i,"="):u=i,n=v,6===t&&((s=h(1,3,o,e)).integerValue(r),(f=h(1,5,u,a)).integerValue(r),n=h(0,1,v,v,v,v,v,s,f)),7===t&&((s=h(1,4,o,e)).integerValue(r),(f=h(1,2,u,a)).integerValue(r),n=h(0,0,v,v,v,v,v,s,f)),0<=t&&t<=5&&(n=h(1,t,o,e)).integerValue(r),(i=new b(n)).type(r?1:2),i.comparisonOperator(t),i}function kt(t,n,i,r,e){var o,a,u,s,n,f,c,l,i,o=v,a=v,u=v,s=v;if(k(n)?o=d(n,"="):a=n,k(i)?u=d(i,"="):s=i,n=v,6===t&&(f=h(r,5,a,o),c=h(r,3,s,u),n=h(0,1,v,v,v,v,v,f,c)),7===t&&(f=h(r,2,a,o),c=h(r,4,s,u),n=h(0,0,v,v,v,v,v,f,c)),0<=t&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}n=h(r,l,a,o)}return(i=new b(n)).type(e),i.comparisonOperator(t),i}function Vt(t,n,i){return kt(t,n,i,5,4)}function Mt(t,n,i){return kt(t,n,i,13,5)}function yt(t,n,i){var r,e,o,a,n,u,s,i,r=v,e=v,o=v,a=v;return k(n)?r=d(n,"="):e=n,k(i)?o=d(i,"="):a=i,n=v,6===t&&(u=h(7,3,e,r),s=h(7,5,a,o),n=h(0,1,v,v,v,v,v,u,s)),7===t&&(u=h(7,4,e,r),s=h(7,2,a,o),n=h(0,0,v,v,v,v,v,u,s)),0<=t&&t<=5&&(n=h(7,t,e,r)),(i=new b(n)).type(6),i.comparisonOperator(t),i}function Dt(t){var t;return o?((t=new b(h(4,v,v,d(t,"="),4))).type(7),t):v}function St(t){var t;return o?((t=new b(r.Condition.fromFormula(t))).type(3),t):v}function jt(t){var t=new b(r.Condition.fromSource(t));return t.type(3),t}function xt(t){return t&&t.getExpressions&&0<t.getExpressions().length}function Ft(t){return this.JS(t)}function It(t,n){if(t&&n&&n.length)return n.map(Ft.bind(t))}function Lt(t,n,i){var r,e,o,r=t.rowCount,e=t.colCount,o=A(t.row,t.col,r,e);return 0===t.row&&r===n&&(o.row=-1),0===t.col&&e===i&&(o.col=-1),o}function Et(t,n){var i=t.getRowCount(),r=t.getColumnCount();return n.map(function(t){return Lt(t,i,r)})}function Bt(t,n){var i,t,i=t.cellCache;return i||(t.cellCache=i={}),(t=i[n])||(i[n]=t={}),t}function Tt(e,t,n,o,a,u,s){var f,c,l,h,d,i,r,v,g,m,A,p,b,w,C,f=o.h6t,c=e.row,l=e.col,h=e.rowCount,d=e.colCount,i=c+h,r=l+d;if(t<=i-1&&(h=t-c),n<=r-1&&(d=n-l),i===t&&0<h)for(v=function(t,n){var i,r,i,i=f.colCache;i||(f.colCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartRowIndex=c,(I(r.cacheRowCount)||!0===s&&a.smt().some(function(t){return t.intersect(u,n,1,1)}))&&(r.cacheRowCount=h)},g=0,m=l;g<d;g++,m++)v(g,m);else if(r===n&&0<d)for(A=function(t,n){var i,r,i,i=f.rowCache;i||(f.rowCache=i={}),(r=i[n])||(i[n]=r={}),(i=r.dv)&&i!==a&&i.FX(e,o),r.dv=a,r.cacheStartColIndex=l,(I(r.cacheColCount)||!1===s&&a.smt().some(function(t){return t.intersect(n,u,1,1)}))&&(r.cacheColCount=d)},p=0,b=c;p<h;p++,b++)A(p,b);else for(p=0,b=c;p<h;p++,b++)for(w=Bt(f,b),g=0,m=l;g<d;g++,m++)(C=w[m])&&C!==a&&C.FX(e,o),w[m]=a}function Ut(t,n){var i,r,e,o,a,u,s,f,c,l,h,d,v,g,m,A,p,b,g,m,w,C,O,k,V,M,O,k,y,D,S,j,i=n.h6t,r=t.row,e=t.col,o=t.rowCount,a=t.colCount,u=n.eJ,s=u.getRowCount(),f=u.getColumnCount(),c=i.colCache,l=i.rowCache,h=i.cellCache;if(c)for(d=e;d<e+a;d++)if(g=(v=c[d])&&v.cacheStartRowIndex,m=v&&v.cacheRowCount,v&&(g<=r&&r<g+m||g<=r+o&&r+o<=g+m)){if(A=!1,r<s){for(p=g;p<=r;p++)b=Bt(i,p),p<r&&(b[d]=v.dv);(m=r+o)-(g=v.cacheStartRowIndex)===v.cacheRowCount?c[d]=L:(v.cacheStartRowIndex=m,v.cacheRowCount-=m-g),A=!0}else r+o===s&&(c[d]=L,A=!0);A&&(w=v.dv)&&w.FX(t,n)}if(l)for(C=r;C<r+o;C++)if(O=(b=l[C])&&b.cacheStartColIndex,k=b&&b.cacheColCount,b&&(O<=e&&e<O+k||O<=e+a&&e+a<=O+k)){if(A=!1,e<f){for(V=O;V<=e;V++)M=Bt(i,C),V<e&&(M[V]=b.dv);(k=e+a)-(O=b.cacheStartColIndex)===b.cacheColCount?l[C]=L:(b.cacheStartColIndex=k,b.cacheColCount-=k-O),A=!0}else e+a===f&&(l[C]=L,A=!0);A&&(w=b.dv)&&w.FX(t,n)}if(h)for(C=0,y=r,D=o;C<D;C++,y++)if(b=h[y])for(d=0,S=e,j=a;d<j;d++,S++)(w=b[S])&&w.FX(t,n),b[S]=L}function Rt(t){switch(t){case"none":return l.anyValue;case"whole":return l.wholeNumber;case"decimal":return l.decimalValues;case"list":return l.list;case"date":return l.date;case"time":return l.time;case"textLength":return l.textLength;case"custom":return l.custom}}function qt(t){var n,i,r,n=[];if(t)for(i in t)(r=t[i])&&n.push(r);return n}function Qt(t,n,i){var r,e,o;if(t)for(e=(r=Object.keys(t)).length-1;0<=e&&n<=(o=+r[e]);e--)t[o+i]=t[o],delete t[o]}function V(t){this.eJ=t,this.YB={},this.h6t={},this.d6t=[]}function Yt(t){return t="string"==typeof t?'"'+t+'"':t}function Jt(t){var n=t.getFormulaString(L,L,L,!0);return I(n)?(n=t.expected(),Yt(P(n))):n}function Pt(t){var n,i;return I(t)?v:0===(n=t.conType())?Wt(t):1===n||7===n?(i=t.formula(),{firstFormula:i=I(i)?t.expected():i}):4===n?{firstFormula:I(t.formula())?t.expected():t.formula()}:12===n||5===n||13===n?{firstFormula:Jt(t)}:{firstFormula:v}}function Wt(t){var n,i;return I(t)?v:(i=n=v,{firstFormula:n=t.item1()?(0===t.item1().conType()?Wt:Pt)(t.item1()).firstFormula:n,secondFormula:i=t.item2()?(0===t.item2.conType?Wt:Pt)(t.item2()).firstFormula:i})}function M(t,n){var i,n;if(!I(t))return i=t,n=+(i=n&&k(t)?t.substr(1):i),isNaN(n)?t:n}function Xt(t){var n=t.row,i=t.col,r=t.rowCount,t=t.colCount;return-1===n&&-1===i?i=0:(-1!==n&&-1!==r&&n+r>D.MAX_ROW_COUNT&&(r=D.MAX_ROW_COUNT-n),-1!==i&&-1!==t&&i+t>D.MAX_COLUMN_COUNT&&(t=D.MAX_COLUMN_COUNT-i)),A(n,i,r,t)}function Gt(t){var t=t.map(Xt);return g.rangesToFormula(t,0,0,15,!1).split(", ").join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.createListValidator=t.createFormulaListValidator=t.createFormulaValidator=t.createTextLengthValidator=t.createTimeValidator=t.createDateValidator=t.createNumberValidator=t.kf=t.Hrt=t.DefaultDataValidator=t.HighlightPosition=t.HighlightType=t.ErrorStyle=t.DataValidationResult=t.CriteriaType=void 0,i=n("Common"),D=n("Core"),r=n("ConditionalFormatting"),g=n("SheetsCalc"),n=n("CalcEngine"),e=i.Common.ct,c=D.UsedRangeUtil.vh,U=D.UsedRangeUtil.hh,S=D.XFileConstants.Au,j=D.XFileConstants.Ou,x=D.XFileConstants.Ru,F="1",o=!!n,h=r.aJ,d=i.Common.zf.cJ,I=i.Common.lt.ht,a=i.Common.lt.tv,R=e.o0,s=D.GC$,v=null,L=void 0,u=D.mt,q=u.p0,Q=u.T1,Y=u.G0,J=u.e1,P=u.i1,E=u.vo,m=u.n1,W=u.g1,X=u.p1,G=D.Util.mr,B=D.Util.addXLFNPrefix,Z=D.Util.pr,H=D.Util.io,T=u.xr,N=u.C1,K=u.Hue,_=u.c1,z=u.Bve,$=D.range_parser.Oc,A=D.Ec,tt=Math.min,p=Math.max,nt=i.Common.ct,f=".validator",et={type:0,color:n="red"},ot={type:it=1,color:n,position:1},at={type:2,color:n,position:rt=5,image:null},(e=ut=ut||{})[e.none=0]="none",e[e.whole=1]="whole",e[e.decimal=2]="decimal",e[e.list=3]="list",e[e.date=4]="date",e[e.time=5]="time",e[e.textLength=6]="textLength",e[e.custom=7]="custom",(i=st=st||{})[i.stop=0]="stop",i[i.warning=1]="warning",i[i.information=2]="information",ft={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},ct={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},n=window,(e=l=t.CriteriaType||(t.CriteriaType={}))[e.anyValue=0]="anyValue",e[e.wholeNumber=1]="wholeNumber",e[e.decimalValues=2]="decimalValues",e[e.list=3]="list",e[e.date=4]="date",e[e.time=5]="time",e[e.textLength=6]="textLength",e[e.custom=7]="custom",(i=lt=t.DataValidationResult||(t.DataValidationResult={}))[i.forceApply=0]="forceApply",i[i.discard=1]="discard",i[i.retry=2]="retry",(e=ht=t.ErrorStyle||(t.ErrorStyle={}))[e.stop=0]="stop",e[e.warning=1]="warning",e[e.information=2]="information",(i=dt=t.HighlightType||(t.HighlightType={}))[i.circle=0]="circle",i[i.dogEar=1]="dogEar",i[i.icon=2]="icon",(e=vt=t.HighlightPosition||(t.HighlightPosition={}))[e.topLeft=0]="topLeft",e[e.topRight=1]="topRight",e[e.bottomRight=2]="bottomRight",e[e.bottomLeft=3]="bottomLeft",e[e.outsideLeft=4]="outsideLeft",e[e.outsideRight=5]="outsideRight",gt=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],C.prototype.value1=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item1()?i.item1():i;return i?(t=i.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):i.expected():v},C.prototype.value2=function(t,n){var i,i,t,i=this.condition(),i=i&&i.item2()?i.item2():i;return i?(t=i.formula(t,n))&&0<t.length?"="+d(s.trim(t.toString()),"="):i.expected():v},C.prototype.isValid=function(t,n,i,r,e){var o,a,u,s,f,e,o=this,a=o.condition(),u=I(e)||!0===e;if(a){if(o.ignoreBlank()&&(I(r)||""===r))return!0;if(f=void 0,!I(s=r))switch(o.type()){case 0:return!0;case 2:case 1:f=u?At(r):r,I(f)||(s=f);break;case 4:case 5:f=u?z(r):r,I(f)||(s=f)}t&&(t.EJ=!0),e=void 0;try{e=a.evaluate(t,n,i,s,s)}catch(t){e=!0}finally{t&&(t.EJ=!1)}return e}return!0},C.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(v),t._S.length=0},C.prototype.getValidList=function(t,n,i){var r=this.condition();return r!==v&&3===this.type()&&12===r.conType()?r.getValidList(t,n,i):v},C.prototype.highlightStyle=function(t){var n,i,r,e,n=this;if(0===arguments.length)return n.l6t;if(!I(t)){if(n.l6t.type!==t.type)switch(i=t.type){case 1:n.l6t=a(ot);break;case 2:n.l6t=a(at);break;default:n.l6t=a(et)}for(e in r=n.l6t)r.hasOwnProperty(e)&&t.hasOwnProperty(e)&&(r[e]=t[e]);return n.Mf&&(n.LEr("highlightStyle",n.l6t),n.Mf.repaint()),n}},C.prototype.FEr=function(){var t=this._S.map(Xt);return g.rangesToFormula(t,0,0,15,!1)},C.prototype.toJSON=function(i,r){var e,o,e=this,o={};return gt.forEach(function(t){var n=e[t]();e[t].isDefault(n)||(o[t]=n&&n.toJSON?n.toJSON(i,r):n)}),o.ranges=e.FEr(),o.highlightStyle=JSON.stringify(e.l6t),s.isEmptyObject(o)?L:(null!=r&&r.isServer&&(o[D.ID_SYMBOL]=e.jKe()),o)},C.prototype.fromJSON=function(e,o,a){var u,t,n,i,t;e&&!s.isEmptyObject(e)&&(u=this,e.ranges&&(u._S=g.formulaToRanges(a,e.ranges,0,0,!0)[0].ranges),e.highlightStyle&&(u.l6t=JSON.parse(e.highlightStyle)),gt.forEach(function(t){var n,i,r,n=e[t];Q(n)&&("condition"===t?((i=h()).fromJSON(e.condition,a,o),u.condition(i,!1),(r=i.ranges())&&r.length?u._S=r:i.ranges(u._S),i.context(a)):u[t](n,!1))}),(t=e.validatorInfo)&&(n=a.Lp.useR1C1,i=bt(e.type,t),t=t.operator,i&&(i.ranges(u._S),i.ignoreBlank(u.ignoreBlank()),i.context(a),n&&Y(i),u.condition(i)),I(t)||u.comparisonOperator(t)),e[D.ID_SYMBOL])&&u.UKn(e[D.ID_SYMBOL],!0)},C.prototype.clone=function(t){var n,n;return this.ZB?((n=this.condition())&&n.initExpression(),this):((n=new C).fromJSON(this.toJSON(t),!1,t||this.Mf),n._S=[],n)},C.prototype.context=function(t){var n;return t&&(this.DJ=t,n=this.condition())&&(n.ranges(this._S),n.context(t)),this.DJ},C.prototype.v6t=function(t){var n,i;if(t){for(n=this._S,i=0;i<n.length;i++)if(n[i].containsRange(t))return;n.push(t)}},C.prototype.FX=function(t,n,i){var r,e,o,a,u,s,f,c,l,h;void 0===i&&(i=!0),e=(r=this)._S,t&&e.length&&(o=t.row,a=t.col,u=t.rowCount,s=t.colCount,c=!(f=[]),l=r.Mf,h=l&&[l.getRowCount(),l.getColumnCount()],e.forEach(function(t){var t=wt(t,o,a,u,s,h);t.c6t&&(c=!0),f.push(t)}),r._S=[].concat.apply([],f),c)&&(n.m6t(r),i)&&l&&(0===r._S.length?l.$Dr({type:"removeDataValidator",range:t,validator:r}):l.$Dr({type:"removeDataValidatorRange",validator:r}))},C.prototype.smt=function(){return this._S},C.prototype.XJ=function(){var t=this;t.condition()&&t.condition().initExpression()},C.prototype.g6t=function(t){this.condition()&&this.condition().ranges(t)},C.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,c,l,s,h,d,v,r=this,e=!1;for(r.XJ(),a=0,u=(o=r._S).length;a<u;a++)f=(s=o[a]).row,c=s.rowCount,l=s.col,s=s.colCount,h=f===t.row&&c===t.rowCount&&t.col<=l&&s<=t.colCount,d=f===n.row&&c===n.rowCount&&n.col<=l&&s<=n.colCount,(v=h||d)&&(o[a]=A(f,l,c+i,s),e=!0);return e&&r.g6t(o),e},C.prototype.JO=function(t,n,i,r){var e,o,a,u,s,f,c;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),e=0;e<this._S.length;e++)if(a=(o=this._S[e]).row,i&&0<i.length){for(u=!1,s=0,f=i.length;s<f;s++)if((c=i[s])&&(!0!==r||c.containsRange(o)))if(r){if(c.row===a&&c.row+c.rowCount-n===a+o.rowCount&&a+o.rowCount===t){o.rowCount+=n,u=!0;break}if(t+n===a&&t===c.row&&c.row+c.rowCount===a+o.rowCount){o.row-=n,o.rowCount+=n;break}}else{if(c.row===a&&c.row+c.rowCount-n===a+o.rowCount&&a===t){o.rowCount+=n,u=!0;break}if(t<=a){o.row+=n;break}if(t<=a+o.rowCount){o.rowCount+=n;break}}if(u)break}else t<=a?o.row+=n:t<=a+o.rowCount&&(o.rowCount+=n);this.condition()&&this.condition().ranges(this._S)}},C.prototype.xP=function(n,i){var r;n<0||i<=0||(this.condition()&&this.condition().initExpression(),r=[],this._S.forEach(function(t){(0,D.ukr)(t,n,i),(0<t.rowCount||-1===t.row&&-1===t.rowCount)&&r.push(t)}),this._S=r,this.condition()&&this.condition().ranges(this._S))},C.prototype.qO=function(t,n,i,r){var e,o,a,u,s,f,c,l;if(!(t<0||n<=0)){for(this.condition()&&this.condition().initExpression(),e=0;e<this._S.length;e++){if(o=this._S[e],i&&0<i.length){for(u=a=!1,s=0,f=i.length;s<f;s++)if((c=i[s])&&!c.containsRange(o))a=!0;else{if(r&&c&&c.col===o.col-n&&c.col+c.colCount===o.col+o.colCount&&c.col===t){o.colCount+=n,o.col-=n,u=!0;break}if(c&&c.col===o.col&&c.col+c.colCount-n===o.col+o.colCount&&c.col===t){o.colCount+=n,u=!0;break}}if(a)continue;if(u)break}l=o.col,1===r?t===l+o.colCount&&(o.colCount+=n):r?l<=t&&t<=l+o.colCount&&(o.colCount+=n):t<=l?o.col+=n:t<=l+o.colCount&&(o.colCount+=n)}this.condition()&&this.condition().ranges(this._S)}},C.prototype.NP=function(n,i){var r;n<0||i<=0||(this.condition()&&this.condition().initExpression(),r=[],this._S.forEach(function(t){(0,D.akr)(t,n,i),(0<t.colCount||-1===t.col&&-1===t.colCount)&&r.push(t)}),this._S=r,this.condition()&&this.condition().ranges(this._S))},C.prototype.rv=function(t,n,i,r,e,o){var a,u,s,f,u,s,c,l,h,o,e,a=this;i?((u=T(t,"sqref"))&&(s=g.formulaToRanges(n,u.c_[0],0,0,!0)[0].ranges),a._S=s):a._S=g.formulaToRanges(n,t.sqref,0,0,!0)[0].ranges,D.Util.Co(o)&&D.Util.Ao(n,a._S,!0,e),f=Rt(t.type),u=ct[t.operator],I(f)||a.type(f),I(u)&&(u=6),a.comparisonOperator(u),t.allowBlank===F?a.ignoreBlank(!0):a.ignoreBlank(!1),I(t.error)||a.errorMessage(m(H(t.error))),I(t.errorTitle)||a.errorTitle(m(t.errorTitle)),I(t.errorStyle)||a.errorStyle(ht[t.errorStyle]),I(t.prompt)||a.inputMessage(m(H(t.prompt))),t.showDropDown===F&&a.inCellDropdown(!1),I(t.promptTitle)||a.inputTitle(m(t.promptTitle)),t.showErrorMessage!==F&&a.showErrorMessage(!1),t.showInputMessage!==F&&a.showInputMessage(!1),(s=t.c_)&&0<s.length&&(i?s.forEach(function(t){var n;t&&(n=T(t,"f"),h=m(n&&n.c_[0]),"formula1"===t.n_&&(c=w(h,f)),"formula2"===t.n_)&&(l=w(h,f))}):s.forEach(function(t){t&&(h=m(_(t)),"formula1"===t.n_&&(c=w(h,f)),"formula2"===t.n_)&&(l=w(h,f))})),I(f)||(o=void 0,1===f||2===f?o=Ot(u,M(c,r),M(l,r),1===f):3===f?(h=c||l)&&(o='"'===h[0]&&'"'===h[h.length-1]?jt(X(h)):St(W(h))):4===f||5===f?o=(5===f?Mt:Vt)(u,c,l):6===f?o=yt(u,M(c,r),M(l,r)):7===f&&void 0!==c&&(o=Dt(c)),o&&(e=o.condition())&&(e.ranges(a._S),e.ignoreBlank(a.ignoreBlank()),e.context(n),a.condition(e))),a.Mf=n,t.lossless&&t.lossless.highlightStyle&&(a.l6t=JSON.parse(t.lossless.highlightStyle))},C.prototype.LEr=function(t,n){var i=this,r=i.Mf;r&&r.$Dr({type:"updateDataValidator",propertyName:t,value:n,validator:i})},b=C,t.DefaultDataValidator=b,(0,D.$e)(b),i={errorStyle:O("errorStyle",0),ignoreBlank:O("ignoreBlank",!0,function(t){this.condition()&&this.condition().ignoreBlank(t)}),preciseCompareDate:O("preciseCompareDate",!1,function(t){this.condition()&&this.condition().preciseCompareDate(t)}),inCellDropdown:O("inCellDropdown",!0),showInputMessage:O("showInputMessage",!0),showErrorMessage:O("showErrorMessage",!0),inputTitle:O("inputTitle",""),errorTitle:O("errorTitle",""),inputMessage:O("inputMessage",""),errorMessage:O("errorMessage",""),comparisonOperator:O("comparisonOperator",6),condition:O("condition",v),type:O("type",0)},s.extend(b.prototype,i),(0,D.qDr)(b),t.Hrt=Ct,t.kf=k,t.createNumberValidator=Ot,t.createDateValidator=Vt,t.createTimeValidator=Mt,t.createTextLengthValidator=yt,t.createFormulaValidator=Dt,t.createFormulaListValidator=St,t.createListValidator=jt,s.extend(D.Worksheet.prototype,{getDataValidator:function(t,n,i){var t=this.hG(t,n,i);return t?t[0]:L},hG:function(t,n,i){return 3===(i=I(i)?3:i)?this.b8.p6t(t,n):L},setDataValidator:function(t,n,i,r,e,o){var a,u,s,f,i,r,a=this,u=a.b8;arguments.length<5&&(e=i,o=r,i=-1===t?-1:1,r=-1===n?-1:1),3===(o=I(o)?3:o)&&(s=a.getDataValidator(t,n,o),(f=1===i&&1===r)&&s===e||(a.Ut.b6t(),i=A(t,n,i,r),u.y6t(i),e&&u.w6t(e,i),a.Ut.b6t(!0),r="validator",f&&(a.Rj(r,t,n,o,s,e),-1!==t&&-1===n?a.dj(t,o,r,e,s):-1===t&&-1!==n&&a.vj(n,o,r,e,s)),a.zw()))},isValid:function(t,n,i,r){var e,o,e=this;try{if(e.Ubt=t,e.Hbt=n,e.zbt=i,e.Gbt=!0,o=e.getDataValidator(t,n))return o.isValid(e,t,n,i,r)}finally{e.Ubt=-1,e.Hbt=-1,e.zbt=v,e.Gbt=!1}return!0},G1:function(){var t,n,i,n,n,t=this;return!(t.M6t||(t.M6t=!0,(n=t.KD)&&((i=n.parentNode)&&i.removeChild(n),t.KD=v),(n=t.a6t)&&(s(n).unbind("click"),(i=n.parentNode)&&i.removeChild(n),t.a6t=v),(n=t.gf)&&(s(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(i=n.parentNode)&&i.removeChild(n),t.gf=v),t.M6t=!1))},xyt:function(){var t,n,i,r,e,o,a,t=this,n=[],i=t.b8,r=i&&i.YB;if(r)for(e in r)xt(a=(o=r[e])&&o.condition())&&n.push({validator:o,sheet:t});return n},Q5e:function(t,n){var t=this.getDataValidator(t,n);return t&&xt(t.condition())}}),s.extend(D.Workbook.prototype,{xyt:function(){var n,t,i,n=[],t,i;return this.sheets.forEach(function(t){var t=t.xyt();t&&t.length&&t.forEach(function(t){n.push(t)})}),n}}),s.extend(D.CellRange.prototype,{validator:function(t){var n,i,r,e,o,a,u,n=this,i=n.sheet,r=n.sheetArea,e=n.row,o=n.col,a=n.rowCount,u=n.colCount;return 0===arguments.length?i.getDataValidator(e,o,r):(i.setDataValidator(e,o,a,u,t,r),n)}}),V.prototype.getUsedRange=function(){var t,n,i,r,e,o,a,u,s,f,t,n=this.p6t(),i={};if(n)for(r=void 0,e=0,o=n;e<o.length;e++)for(u=0,s=r=(a=o[e]).smt();u<s.length;u++)f=s[u],c(i,U(f));return i},V.prototype.L0=function(){this.eJ=v},V.prototype.GJ=function(t){return It(this.eJ,t)},V.prototype.OX=function(t){return Et(this.eJ,t)},V.prototype.C8=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(I(n)?r.h6t={}:r.h6t.cellCache={},e)for(o in e)(a=e[o])&&(t&&delete a.C6t,r.fE(a,!0,n,i));r.S6t()},V.prototype.m6t=function(t){var n=this.d6t;-1===n.indexOf(t)&&n.push(t)},V.prototype.fE=function(n,t,i,r){var e=this,o=e.GJ(n.smt()),a=e.eJ,u=a.getRowCount(),s=a.getColumnCount();o&&(e.d6t.length=0,o.forEach(function(t){Tt(t,u,s,e,n,i,r)}),t||e.S6t())},V.prototype.RX=function(t,n){var i=this,t=i.GJ(t.smt());i.d6t.length=0,t.forEach(function(t){Ut(t,i)}),n||i.S6t()},V.prototype.BX=function(t){var n=this;t&&Ut(n.eJ.JS(t),n),n.S6t()},V.prototype.S6t=function(){var t,n,t=this.d6t;t.length&&(n=this.YB,t.forEach(function(t){t.smt().length?t.condition()&&t.condition().ranges(t.smt()):(delete n[t.jKe()],delete t.Mf)}),t.length=0)},V.prototype.BEr=function(t){var n,i,r,n,i=this.YB;for(r in i)if(i.hasOwnProperty(r)&&r===t)return i[r];return v},V.prototype.PEr=function(t,n,i){return n&&((t=t.Mf&&i!==t.Mf?t.clone(i):t).Mf=i,t.v6t(n)),t},V.prototype.w6t=function(t,n){var i=this,r=i.eJ;if(t=i.PEr(t,n,r),i.GEr(t,r))return r.$Dr({type:"addDataValidator",validator:t,range:n,sheet:r}),t},V.prototype.GEr=function(t,n){var i=this;if(n)return t.context(n),i.YB[t.jKe()]=t,i.fE(t),t},V.prototype.UEr=function(t,n){var i=new b;return i.fromJSON(t,void 0,n),i},V.prototype.y6t=function(t){var n,i;t&&(i=(n=this).eJ,n.BX(t),i.zw())},V.prototype.d5=function(){var t=this,n;t.eJ&&(t.YB={},t.C8())},V.prototype.p6t=function(t,i){var n,r,e,n,o,r,r,r,r,r,n=this,r=n.YB;return 0===arguments.length||(e=[],n=n.h6t,i===L&&(i=-1),-1===(t=t===L?-1:t)&&-1===i)?qt(r):((r=(r=n.colCache)&&r[i])&&(t>=r.cacheStartRowIndex&&t<r.cacheStartRowIndex+r.cacheRowCount||-1===t&&0===r.cacheStartRowIndex)?e.push(r.dv):(r=(r=n.rowCache)&&r[t])&&(i>=r.cacheStartColIndex&&i<r.cacheStartColIndex+r.cacheColCount||-1===i&&0===r.cacheStartColIndex)?e.push(r.dv):(r=n.cellCache)&&(-1!==t&&-1!==i?(o=r[t])&&o[i]&&e.push(o[i]):-1===t?s.each(r,function(t,n){var n=n[i];n&&-1===e.indexOf(n)&&e.push(n)}):(o=r[t])&&s.each(o,function(t,n){n&&-1===e.indexOf(n)&&e.push(n)})),e)},V.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,r=this,e,o=r.eJ.Ut,a=r.YB,u=!1;if(!I(a)){for(s in o.b6t(),a)(f=a[s])&&f.qJ(t,n,i)&&(u=!0);u&&r.C8()}},V.prototype.Lve=function(t,n,i){var r,e=this.h6t;e&&Qt(i?e.rowCache:e.colCache,t,n)},V.prototype.$J=function(t,n,i,r,e){var o,a,u,s,o=this,a=o.YB;if(a)for(u in a)(s=a[u])&&(i?s.JO(t,n,r,e):s.qO(t,n,r,e));e?o.C8():(o.Lve(t,n,i),o.C8(L,t,i))},V.prototype.JO=function(t,n,i,r){this.$J(t,n,!0,i,r)},V.prototype.qO=function(t,n,i,r){this.$J(t,n,!1,i,r)},V.prototype.tX=function(t,n,i){var r,e,o,a,r=this,e=r.YB;if(e)for(o in e)(a=e[o])&&(i?a.xP(t,n):a.NP(t,n),0===a._S.length)&&(e[o]=L);r.C8()},V.prototype.xP=function(t,n){this.tX(t,n,!0)},V.prototype.NP=function(t,n){this.tX(t,n,!1)},V.prototype.toJSON=function(t,n){var i,r,e,o,i=this.YB,r=[];for(e in i)(o=i[e])&&r.push(o.toJSON(t,n));return r},V.prototype.fromJSON=function(t,i,r){var e=this,o=e.eJ;e.YB={},t&&t.length&&(t.forEach(function(t){var n=new b;n.fromJSON(t,i,r),n.Mf=o,e.YB[n.jKe()]=n}),e.C8())},V.prototype.y8=function(t,n,i){this.eJ.setDataValidator(t,n,i)},mt=V,s.extend(D.Y8.prototype,{b6t:function(t){var n,i,r,e,o,a,u,n=this,i=n.G8;if(i&&(t||!i.originalValidators)){for(o in e=[],r=n.b8.YB)(a=r[o])&&(u=a._S.map(function(t){return A(t.row,t.col,t.rowCount,t.colCount)}),e.push({validator:a,ranges:u}));t?i.currentValidators=e:i.originalValidators=e}},T6t:function(t){var r,n,e;t&&(r=this.Mf,n=this.b8,e={},t.forEach(function(t){var n,i,n=t.validator;"Object"===n.constructor.name&&((i=new b).fromJSON(n,!1,r),n=i),n._S=t.ranges,n.condition()&&n.condition().ranges(n._S),e[n.jKe()]=n}),n.YB=e,n.C8(!1))},ATt:function(t,n,i,r){this.b6t(),this.b8.JO(t,n,i,r),this.b6t(!0)},A6t:function(t,n){this.b6t(),this.b8.xP(t,n),this.b6t(!0)},NTt:function(t,n,i,r){this.b6t(),this.b8.qO(t,n,i,r),this.b6t(!0)},kTt:function(t,n){this.b6t(),this.b8.NP(t,n),this.b6t(!0)},I6t:function(t){this.b6t(),this.b8.BX(t),this.b6t(!0)},x6t:function(){this.b6t(),this.b8.C8(),this.b6t(!0)}}),D.Y8.ch("validator",{init:function(){this.b8=new mt(this.Mf)},applyChanges:function(t){var n,t,t,n=t.changes,t=t.isUndo;n&&(t=t?n.originalValidators:n.currentValidators)&&this.T6t(t)},undo:function(t){var t=t.originalValidators;t&&this.T6t(t)},dispose:function(t){var n;!1!==(t&&t.clearCache)&&this.b8&&(this.b8.L0(),this.b8=v)}}),D.Worksheet.ch("validator",{getUsedRange:function(t){var n,i,r;t.type&D.UsedRangeType.dataValidation&&(r=(i=(n=this).b8).getUsedRange(),c(t.range,r))},init:function(){var i=this;i.b8=i.Ut.b8,i._3(D.Events.FloatingElementSelected+f),i.D3(D.Events.FloatingElementSelected+f,function(t,n){"worksheet"!==n.type&&i.G1()})},dispose:function(t){var n=this;n.G1(),t.clearCache&&n.b8.d5(),!1!==t.clearCache&&n._3(D.Events.FloatingElementSelected+f)},onLayoutChanged:function(t){var n,i,r,e,o,a,u,s,f,n=t.changeType,i=t.row,r=t.rowCount,e=t.col,o=t.colCount,a=t.sheetArea,u=I(a)||3===a,s=this.Ut,f=this.tables;"addRows"===n&&u?s.ATt(i,r,f&&f.AJ(i,-1,r,-1,!0)):"deleteRows"===n&&u?s.A6t(i,r):"addColumns"===n&&u?s.NTt(e,o,f&&f.AJ(-1,e,-1,o,!1)):"deleteColumns"===n&&u?s.kTt(e,o):"clear"===n?3===a&&2==(2&t.type)&&s.I6t(A(i,e,r,o)):"setColumnCount"!==n&&"setRowCount"!==n||3!==a&&1!==a||s.x6t()},toJson:function(t,n){var i,r,r,i=this.b8,r=n&&n.ignoreStyle;i&&!r&&(r=i.toJSON(this,n))&&r.length&&(t.validations=r)},fromJson:function(t,n,i){var i,i,i=i&&i.ignoreStyle;t&&t.validations&&!i&&(i=t.validations,this.b8.fromJSON(i,n,this))},wh:function(t,n,i){var r,e,o,a,u,i,s,f,c,l,h,d,v,g,m,A,p,b,w,C,O,k,V,g,m,A,p,b,w,C,O,M,y,r=this,e=r.b8,o=i&&!1===i.includeStyles,a=i&&i.fileType===D.OpenSaveFileType.excel;if(!o&&e&&!r.NMi){for(l in u=e.YB,s=(i={n_:j,c_:[]}).c_,f=0,c=[],u)if((h=u[l])&&h._S&&0<h._S.length){if(f++,v=!(d={n_:x}),g=h.comparisonOperator(),m=h.ignoreBlank(),A=h.errorMessage(),p=h.errorTitle(),b=h.errorStyle(),w=h.inputMessage(),C=h.inCellDropdown(),O=h.inputTitle(),k=h.showErrorMessage(),V=h.showInputMessage(),6!==g&&(d.operator=ft[g]),!1!==m&&(d.allowBlank=F),A&&(d.error=E(Z(A))),p&&(d.errorTitle=E(p)),0!==b&&(d.errorStyle=st[b]),w&&(d.prompt=E(Z(w))),!1===C&&(d.showDropDown=F),O&&(d.promptTitle=E(O)),!1!==k&&(d.showErrorMessage=F),!1!==V&&(d.showInputMessage=F),g=h.condition(),m=h._S,d.sqref=Gt(m),g){if(A=h.type(),d.type=ut[A],b=(p=Pt(g)).firstFormula,w=p.secondFormula,a&&(N(b)||N(w)))continue;d.c_=[],C=r.name(),O=r.parent&&r.parent.r4(),J(b,C,O)||J(w,C,O)?(d.n_=x,I(b)||d.c_.push({n_:"formula1",c_:[{n_:"f",c_:[E(B(b))]}]}),I(w)||d.c_.push({n_:"formula2",c_:[{n_:"f",c_:[E(B(w))]}]}),d.c_.push({n_:"sqref",c_:[$(m)]}),v=!0):(I(b)||(4===A||5===A?d.c_.push({n_:"formula1",c_:[pt(b)+""]}):d.c_.push({n_:"formula1",c_:[E(B(b))]})),I(w)||(4===A||5===A?d.c_.push({n_:"formula2",c_:[pt(w)+""]}):d.c_.push({n_:"formula2",c_:[E(B(w))]})))}h.l6t&&(d.lossless={highlightStyle:JSON.stringify(h.l6t)}),(v?c:s).push(d)}0<s.length&&(i.count=f,t.c_.push(i)),0<c.length&&(M=T(t,S)).c_.push(y={n_:"ext",r_:[1,9],c_:[{n_:j,c_:c,r_:[2],count:c.length}]})}},yh:function(t,n,i){var r,e,o,a,u,s,f,c,l,h,s,t,d,v,r=this,e=r.b8,o=e.YB,a;if(!(i&&!1===i.includeStyles)&&e&&g){if(u=D.Util.ko(i),(f=(s=T(t,j))&&s.c_)&&0<f.length)for(c=f.length-1;0<=c;c--)l=f[c],(h=new b).rv(l,r,L,u,n,i),o[h.jKe()]=h;if(s=T(t,S),(t=K(s,"dataValidations"))&&t.c_&&0<t.c_.length)for(c=(d=t.c_).length-1;0<=c;c--)v=d[c],(h=new b).rv(v,r,!0,u,n,i),o[h.jKe()]=h;e.C8()}}}),D.Style.ch("validator",{fromJson:function(t){var n;"validator"===t.p&&((n=new b).fromJSON(t.v,t.noSchema,t.context),this.validator=n,t.r=!0)}}),n.gcGlobal.wf.push(function(t,n){!n&&t.G1&&t.G1()})},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},ConditionalFormatting:function(t){t.exports=GC.Spread.Sheets.ConditionalFormatting}},r={},n=t={},Object.defineProperty(n,"__esModule",{value:!0}),n.createListValidator=n.createFormulaListValidator=n.createFormulaValidator=n.createTextLengthValidator=n.createTimeValidator=n.createDateValidator=n.createNumberValidator=n.kf=n.Hrt=n.HighlightPosition=n.HighlightType=n.DefaultDataValidator=n.ErrorStyle=n.DataValidationResult=n.CriteriaType=void 0,o("./dist/plugins/validation/datavalidation-event.js"),e=o("./dist/plugins/validation/datavalidation.js"),Object.defineProperty(n,"CriteriaType",{enumerable:!0,get:function(){return e.CriteriaType}}),Object.defineProperty(n,"DataValidationResult",{enumerable:!0,get:function(){return e.DataValidationResult}}),Object.defineProperty(n,"ErrorStyle",{enumerable:!0,get:function(){return e.ErrorStyle}}),Object.defineProperty(n,"DefaultDataValidator",{enumerable:!0,get:function(){return e.DefaultDataValidator}}),Object.defineProperty(n,"HighlightType",{enumerable:!0,get:function(){return e.HighlightType}}),Object.defineProperty(n,"HighlightPosition",{enumerable:!0,get:function(){return e.HighlightPosition}}),Object.defineProperty(n,"Hrt",{enumerable:!0,get:function(){return e.Hrt}}),Object.defineProperty(n,"kf",{enumerable:!0,get:function(){return e.kf}}),Object.defineProperty(n,"createNumberValidator",{enumerable:!0,get:function(){return e.createNumberValidator}}),Object.defineProperty(n,"createDateValidator",{enumerable:!0,get:function(){return e.createDateValidator}}),Object.defineProperty(n,"createTimeValidator",{enumerable:!0,get:function(){return e.createTimeValidator}}),Object.defineProperty(n,"createTextLengthValidator",{enumerable:!0,get:function(){return e.createTextLengthValidator}}),Object.defineProperty(n,"createFormulaValidator",{enumerable:!0,get:function(){return e.createFormulaValidator}}),Object.defineProperty(n,"createFormulaListValidator",{enumerable:!0,get:function(){return e.createFormulaListValidator}}),Object.defineProperty(n,"createListValidator",{enumerable:!0,get:function(){return e.createListValidator}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).DataValidation=t}();