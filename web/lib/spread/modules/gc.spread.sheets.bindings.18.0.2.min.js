/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/data/binding.js":function(n,t,i){var r,e,f,e,i,a,s,v,l,c,u,h,g,u,d,o,m,p;function b(n){this.rT=n}function w(n){this.Hc(n)}function j(n){var t=n&&n.H3;t&&t.Q$()&&r.Worksheet.et(n,"resetBinding",{sheet:n})}function C(n,t){var i=n&&n.H3;return!(!i||!i.Q$(t)||(n.clearPendingChanges(),r.Worksheet.et(n,"initBinding",{sheet:n,data:t}),0))}function y(n,t,i){var r,e,u,o,f,a,s,c,c,c,r,n,f,r=n,e=r._dataSource,u={value:v,hasBinding:!1};if(e)if(o=r.Mf,(f=r.K$)===g){if((c=o?o.getBindingPath(t,i):v)&&"object"!=typeof c)return{value:e.getValue(c),hasBinding:!0}}else{if(t<0||n.getRowCount()<=t)return u;if(c=(o||n).getColumnCount(),i<0||c<=i)return u;if(o?(r.J$||r.IBe(o.Ut.EE(!1,3)),(a=r.J$[i])&&(s=a.name)):n.Pq&&(r.J$?(a=r.J$[i])&&(s=a.dataField):s=n.Pq[i]),f)return c=h[f],n=V(r=a&&a.value)?r:v,f=o&&o.onItemGotten?o.onItemGotten.bind(o):l,c.getValue(e,n,s,t,i,f)}return u}function I(n,t,i,r){var e,u,o,f,a,s,c,d,d,d,f,e,e=n,u=e._dataSource,o=!1;if(u)if(f=e.Mf,(a=e.K$)===g)(d=f?f.getBindingPath(t,i):v)&&"object"!=typeof d&&(u.setValue(d,r),o=!0);else{if(t<0||n.getRowCount()<=t)return o;if(d=(f||n).getColumnCount(),i<0||d<=i)return o;f?(e.J$||e.IBe(f.Ut.EE(!1,3)),(s=e.J$[i])&&(c=s.name)):n.Pq&&(e.J$?(s=e.J$[i])&&(c=s.dataField):c=n.Pq[i]),a&&(d=h[a],e=V(f=s&&s.value)?f:v,o=d.setValue(u,e,c,t,i,r,l))}return o}function _(i){var r=v;return i&&(O(i)?r=g:f.each(h,function(n,t){if(t.isDataSource(i))return r=n,!1})),r}function B(n,t){return n&&t&&t!==g?h[t].getProperties(n):v}function O(n){return o&&n instanceof o}function V(n){return"function"==typeof n}function M(n,t,i){var r,e,u,o,f;if(n&&t)if(r=n[t],s(r))for(u=(e=t.split(".")).length,o=0;o<u&&(f=e[o],n);o++)o===u-1?V(n[f])?n[f](i):n[f]=i:n=V(n[f])?(s(n[f]())&&n[f]({}),n[f]()):(s(n[f])&&(n[f]={}),n[f]);else V(r)?n[t](i):n[t]=i}function S(n,t,i){var r,e,u,o,f;if(!n||!t)return v;if(r=n[t],!s(r))return V(r)?r():r;e=null,i?(e=i[t])||(e=t.split("."),i[t]=e):e=t.split("."),u=e.length,o=0;do{if(n=V(n[f=e[o]])?n[f]():n[f],s(n))return v}while(++o<u);return n}function G(){this.pathCache={}}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=t.q$=t.setValueByPath=t.$$=t.CellBindingSource=void 0,r=i("Core"),e=i("Core"),f=e.GC$,e=i("Common"),i=i("./dist/plugins/data/data.ns.js"),a=f.isNumeric,s=e.Common.lt.ht,v=null,l=void 0,c="string",t.X$=u,h=t.X$=u={},g="cellBinding",u=new e.Common.ResourceManager(i.SR,"Bindings"),d=u.getResource.bind(u),r.Workbook.ch("binding",{onCultureChanged:function(){d()}}),b.prototype.setValue=function(n,t){M(this.rT,n,t)},b.prototype.getValue=function(n){return S(this.rT,n)},b.prototype.getSource=function(){return this.rT},o=b,t.CellBindingSource=o,w.prototype.bind=function(e,n){var t,i,r,n,r,u,o,t=this,i=t.Mf,r=t._dataSource;if(n&&t.ttt(n,{type:"bind",oldDataSource:r}),r&&(r.ntt&&(r.subscribe=r.ntt,delete r.ett,delete r.ntt),V(r.dispose))&&r.dispose(),t.itt(t.rtt),t.itt(t.ott),t.Hc(i),t._dataSource=e){if(!(n=t.K$=_(e)))throw new Error(d().Exp_NotSupportedDataSource);t.att=t.utt(),i&&f[f.sd]({jS:i.parent}),i&&(r=t.rtt,u=e.currentPosition,e.subscribe&&r.push(e.subscribe(t.stt,t)),u&&u.subscribe&&r.push(u.subscribe(t.ctt,t)),V(e.subscribe)&&!e.ntt&&(o=e.ntt=e.subscribe,e.ett=!1,e.subscribe=function(n,t){var i,r,i=[].concat.apply([],arguments),r;return i[0]=function(){if(!e.ett&&V(n))return n.apply(t,arguments)},o.apply(e,i)}),t.RA(),t.Mf.Ut.L5e()),t.Pq=B(e,n)}return C(i,e)},w.prototype.RA=function(){var n,t,i,r,e,r,u,o,n=this,t=n.Mf,i=n._dataSource;if(t&&i&&(r=n.K$,n.itt(n.ott),e=v,r!==g&&(r=t.getActiveRowIndex(),e=i.currentPosition?(-1<=r&&r<i.count()&&i.currentPosition(r),i.currentItem()):n.ftt(r)),e))for(o in u=function(){t&&t.repaint()},e)e[o]&&V(e[o].subscribe)&&n.ott.push(e[o].subscribe(u,v,v))},w.prototype.itt=function(n){var t,i;if(n)for(t=0;t<n.length;t++)(i=n[t])&&V(i.dispose)&&i.dispose()},w.prototype.getRowCount=function(){var n,t,n,i,n=this,t=n._dataSource,n=n.K$,i=0;return i=t&&n&&n!==g?h[n].getDataLength(t):i},w.prototype.getColumnCount=function(){var n,n,n,n,n=this.Pq;return n?n.length:(n=this._dataSource)&&(n=n[0],"null"===(n=f.getType(n))||n===c||"number"===n)?1:0},w.prototype.getSource=function(){return this._dataSource},w.prototype.ltt=function(){return this.Pq},w.prototype.htt=function(n){this.NTr()||(this.Pq=n)},w.prototype.ftt=function(n){var t=this._dataSource,i=this.K$,r=v;return r=t&&i&&i!==g?h[i].getDataItem(t,n):r},w.prototype.utt=function(){var n,t,i,r,n=this;if(!n.att&&!n.NTr())for(t=n.getRowCount(),i=0;i<t;i++)if(r=n.ftt(i)){n.att=r.entityAspect&&r.entityType||r.constructor;break}return n.att},w.prototype.getValue=function(n,t){return y(this,n,t)},w.prototype.setValue=function(n,t,i,r){var e,u,e=this;return r&&(u=y(e,n,t).value,e.ttt(r,{type:"setValue",row:n,col:t,oldValue:u})),I(e,n,t,i)},w.prototype.xBe=function(){return this.J$},w.prototype.IBe=function(n,t){var i,r,i=this;i.NTr()||(t&&(r=i.J$,i.ttt(t,{type:"setColumnBindingInfo",oldColumnBindingInfo:r,columnBindingInfo:n})),i.J$=n)},w.prototype.dtt=function(){var n=h[this.K$];return n&&n.canAdd&&n.canAdd()},w.prototype.vtt=function(){var n=h[this.K$];return n&&n.canInsert&&n.canInsert()},w.prototype.mtt=function(){var n=h[this.K$];return n&&n.canRemove&&n.canRemove()},w.prototype.allowSetCount=function(){var n,n,n=this.K$;return n===g||(n=h[n])&&n.allowSetCount&&n.allowSetCount()},w.prototype.kE=function(n,t,i){var r,e,u,o,r=this,e=r._dataSource;!e||n>r.getRowCount()||(u=r.K$,o=r.utt(),u&&u!==g&&!r.gtt&&(r.ptt=!0,r.jTr(i),h[u].addItems(e,n,t,o,l),i&&r.ttt(i,{type:"addItems",row:n,rowCount:t}),r.ptt=!1))},w.prototype.btt=function(n,t,i){var r,e,u,o,u,f,a,u,u,r=this,e=r.K$,u=r.getRowCount(),o=r._dataSource;if(o&&!(u<=n)&&e&&e!==g&&!r.gtt){if(r.ptt=!0,r.jTr(i),u=r.Mf,f=[],r.NTr())for(a=0;a<t;a++)f.push(h[e].getDataItem(o,n+a));u=u&&u.onItemRemoved?u.onItemRemoved.bind(u):l,u=h[e].removeItems(o,n,t,u),0<f.length&&(u=f),i&&u&&0<u.length&&r.ttt(i,{type:"removeItems",row:n,removedItems:u}),r.ptt=!1}},w.prototype.ytt=function(n,t){var i,r,i,i=this,r=i._dataSource,i=i.K$;h[i].undoRemoveItems(r,n,t)},w.prototype.kve=function(n){var t,i,r,t,t=this,i=t._dataSource,r=t.K$;if(i)return n=n<0||n>t.getColumnCount()?t.getColumnCount():n,r&&r!==g&&(t=h[r],!s(t.kve))?t.kve(i,n):void 0},w.prototype.zEr=function(){var n=this,t=n._dataSource,i=n.K$;n.Pq=B(t,i)},w.prototype.DTr=function(){var n,t=h[this.K$];return t&&t.canAddColumn&&t.canAddColumn()&&!s(t.qFe)},w.prototype.qFe=function(n,t,i){var r,e,u,o,r=this,e=r._dataSource,u=r.K$;e&&(t=t<0||t>r.getColumnCount()?r.getColumnCount():t,u)&&u!==g&&!r.gtt&&(o=h[u],s(o.qFe)||(r.jTr(i),r.ptt=!0,o.qFe(e,n,t),r.Pq=B(e,u),i&&r.ttt(i,{type:"addColumn",col:null!=t?t:r.getColumnCount(),columnInfo:n}),r.ptt=!1))},w.prototype._Tr=function(){var n,t=h[this.K$];return t&&t.canRemoveColumn&&t.canRemoveColumn()&&!s(t.iGe)},w.prototype.iGe=function(n,t){var i,r,e,u,i=this,r=i._dataSource,e=i.K$;!r||n<0||n>i.getColumnCount()||e&&e!==g&&!i.gtt&&(u=h[e],s(u.iGe)||(i.jTr(t),i.ptt=!0,u.iGe(r,n),i.Pq=B(r,e),t&&i.ttt(t,{type:"removeColumn",col:n}),i.ptt=!1))},w.prototype.OTr=function(){var n,t=h[this.K$];return t&&t.canUpdateColumn&&t.canUpdateColumn()&&!s(t.JEe)},w.prototype.JEe=function(n,t,i){var r,e,u,o,r=this,e=r._dataSource,u=r.K$;e&&(n=n<0||n>r.getColumnCount()?r.getColumnCount():n,u)&&u!==g&&!r.gtt&&(o=h[u],s(o.JEe)||(r.jTr(i),r.ptt=!0,o.JEe(e,n,t),r.Pq=B(e,u),i&&r.ttt(i,{type:"updateColumn",col:n,columnInfo:t}),r.ptt=!1))},w.prototype.NTr=function(){var n,t,t,n,t=this.K$,t=h[t];return t&&t.isDataDrivenMode&&t.isDataDrivenMode()},w.prototype.e5t=function(n,t){var i,r,i,i,i=this,r=i._dataSource,i=i.K$;return r&&i&&(i=h[i],!s(i.hasValue))?i.hasValue(r,n,t):void 0},w.prototype.nln=function(){var n,t=h[this.K$];return t&&t.canFilter&&t.canFilter()&&!s(t.Irn)},w.prototype.Irn=function(n,t){var i,r,e,e,i=this,r=i._dataSource,e=i.K$;r&&e&&e!==g&&!i.gtt&&(e=h[e],s(e.Irn)||(i.ptt=!0,e.Irn(r,n),t&&i.ttt(t,{type:"filterItems",conditions:n}),i.ptt=!1))},w.prototype.ETr=function(n,t){var i,r,e,i,i=this,r=i._dataSource,e=i.K$;return!r||n<0||n>i.getColumnCount()||!e||e===g||(i=h[e],s(i.ETr))?[]:i.ETr(r,n,t)},w.prototype.eln=function(){var n,t=h[this.K$];return t&&t.canSort&&t.canSort()&&!s(t.POn)},w.prototype.POn=function(n,t){var i,r,e,e,i=this,r=i._dataSource,e=i.K$;r&&e&&e!==g&&!i.gtt&&(e=h[e],s(e.POn)||(i.jTr(t),i.ptt=!0,e.POn(r,n),t&&i.ttt(t,{type:"sortItems",sortInfos:n}),i.ptt=!1))},w.prototype.Q$=function(n){return O(n||this._dataSource)},w.prototype.Hc=function(n){var t=this;t._dataSource=v,t.K$="",t.att=v,t.Pq=v,t.rtt=[],t.ott=[],t.J$=v,j(t.Mf=n)},w.prototype.stt=function(n){var t,i,r,e,u,o,t=this,i=t.Mf;if(i&&!t.ptt){if(n){if(t.gtt=!0,!isNaN(n.length)&&(i.setRowCountCore(n.length),r=i.Ut,s(t.Pq))&&0===r._E(!1,3)&&(t.Pq=B(t._dataSource),i.setColumnCount(t.getColumnCount()),e=t.ltt()))for(u=0,o=e.length;u<o;u++)r.do("setItem",!1,3,u,{name:e[u]});t.gtt=!1}i.zw()}},w.prototype.ctt=function(){var n,t,n,n,n=this,t=n.Mf,n=n._dataSource;t&&n&&n.currentPosition&&(n=n.currentPosition(),t.ui!==n)&&(t.t4(n,t.ci,l,l,2),t.zw())},w.prototype.RTr=function(n){var n,n;return!(!n||(n=this.K$,n=h[n],s(n))||s(n.vCn)||s(n.FCn)||this.Mf&&this.Mf.Ut&&!s(this.Mf.Ut.P8)&&this.Mf.Ut.P8<=0)},w.prototype.jTr=function(n){var n,t;this.RTr(n)&&(n=this._dataSource,t=this.K$,h[t].vCn(n))},w.prototype.LTr=function(n){var n,t;if(this.RTr(n))return n=this._dataSource,t=this.K$,h[t].FCn(n)},w.prototype.ttt=function(n,t){var i,i;this.Mf&&this.Mf.Ut&&!s(this.Mf.Ut.P8)&&this.Mf.Ut.P8<=0||((i=this.LTr(n))&&(t.FTr=i),i=(i=n.bindingChanges)||(n.bindingChanges=[]),t.bindingManager=this,i.push(t))},w.prototype.wtt=function(n){var t,i,r,t=this,i=n.type,r=n.row;"bind"===i?t.bind(n.dataSource):"setValue"===i?t.setValue(r,n.col,n.value):"addItems"===i?t.kE(r,n.rowCount):"removeItems"===i?t.btt(r,n.rowCount):"setColumnBindingInfo"===i&&t.IBe(n.columnBindingInfo)},w.prototype.Mtt=function(n){var i,t,r,i=this,t=n.type,r=n.row;if("bind"===t)i.bind(n.oldDataSource);else if("setValue"===t)i.setValue(r,n.col,n.oldValue);else if("addItems"===t){if(i.NTr())return i.BTr(n);i.btt(r,n.rowCount)}else if("removeItems"===t){if(i.NTr())return i.BTr(n);i.ytt(r,n.removedItems)}else if("setColumnBindingInfo"===t)i.IBe(n.oldColumnBindingInfo);else if(i.NTr()&&("addColumn"===t||"removeColumn"===t||"updateColumn"===t||"sortItems"===t))return i.BTr(n,function(n,t){i.Pq=B(n,t)})},w.prototype.BTr=function(n,t){var i,n,r,e,i,i=this,n=n.FTr;if(!s(n)&&0<n.length&&(r=i._dataSource,e=i.K$,i=h[e],!s(i.Mtt)))return i.Mtt(r,n).then(function(){return t&&t(r,e)})},w.prototype.toJSON=function(){var n,t,n=this._dataSource;return n?{type:t=this.K$,source:n=t===g?n.getSource():h[t].toJSON(n)}:v},w.prototype.fromJSON=function(n){var t,n,i,t=n&&n.source;t&&(i=void 0,i=(n=n.type)===g?new o(t):h[n].fromJSON(t))&&this.bind(i)},t.$$=w,t.setValueByPath=M,t.q$=S,G.prototype.isDataSource=function(n){return f.isArray(n)},G.prototype.getDataLength=function(n){return n.length},G.prototype.getDataItem=function(n,t){return n[t]},G.prototype.addItems=function(n,t,i,r){for(var e,u,e=0;e<i;e++)u={},r&&(u=r.createEntity?r.createEntity():new r),n.splice(t,0,u)},G.prototype.removeItems=function(n,t,i){var r=this.getDataLength(n);if(t<r)return n.splice(t,Math.min(i,r-t))},G.prototype.undoRemoveItems=function(n,t,i){for(var r=0,e=i.length;r<e;r++)n.splice(t+r,0,i[r])},G.prototype.getProperties=function(n){var t,i,r,e,t=n.length,i=v;if(0<t)for(e in i=[],r=n[0])V(r[e])||i.push(e);return i},G.prototype.getValue=function(n,t,i,r,e){var u=v,o=!1,n=this.getDataItem(n,r);return s(n)||(t?f.isEmptyObject(n)||(u=t(n),o=!0):i?(u=S(n,i,this.pathCache),o=!0):typeof n!=c&&!a(n)||0!==e||(u=n,o=!0)),{value:u,hasBinding:o}},G.prototype.setValue=function(n,t,i,r,e,u){var o=!1,f=this.getDataItem(n,r);return s(f)||(t?(f[i]=u,t(f,u),o=!0):i?(M(f,i,u),o=!0):typeof f!=c&&!a(f)||0!==e||(n[r]=u,o=!0)),o},G.prototype.fromJSON=function(n){return n},G.prototype.toJSON=function(n){return n},h.defaultBindingSource=new G},"./dist/plugins/data/data.dataview.js":function(n,t,i){var r,e,f,a,u;function o(){}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=void 0,r=i("Common"),e=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"X$",{enumerable:!0,get:function(){return e.X$}}),f=r.Common.lt.ht,a=null,o.prototype.isDataSource=function(n){var t=window.wijmo;return t&&t.data&&t.data.isDataView&&t.data.isDataView(n)},o.prototype.getDataLength=function(n){return n.count()},o.prototype.getDataItem=function(n,t){return n.item(t)},o.prototype.addItems=function(n,t,i,r){if(r)for(var e=0;e<i;e++)n.ett=!0,n.add(r.createEntity?r.createEntity():new r),n.ett=!1,n.commitEdit()},o.prototype.removeItems=function(n,t,i){var r,e,u,o,f,r=this.getDataLength(n);if(t<r){for(e=[],u=Math.min(i,r-t),o=0;o<u;o++)f=n.item(t),n.remove(f),e.push(f);return e}},o.prototype.undoRemoveItems=function(n,t,i){for(var r,e,u,r=n.getSource(),e=0,u=i.length;e<u;e++)r.splice(t+e,0,i[e]);n.refresh()},o.prototype.getProperties=function(n){var t,i,r,e,t=0,i=a,r=n.getProperties();if(r&&0<r.length)for(t=r.length,i=[],e=0;e<t;e++)i.push(r[e].name);return i},o.prototype.canInsert=function(){return!1},o.prototype.getValue=function(n,t,i,r,e){var u=a,o=!1,r=this.getDataItem(n,r);return f(r)||(t?(u=t(r),o=!0):i&&(u=n.getProperty(r,i),o=!0)),{value:u,hasBinding:o}},o.prototype.setValue=function(n,t,i,r,e,u){var o=!1,r=this.getDataItem(n,r);return f(r)||(t?(t(r,u),o=!0):i&&(n.setProperty(r,i,u),o=!0)),o},o.prototype.fromJSON=function(n){return n},o.prototype.toJSON=function(n){return n.local},e.X$.dataViewBinding=new o},"./dist/plugins/data/data.entry.js":function(n,t,i){var r,e,u,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.q$=t.setValueByPath=t.$$=t.CellBindingSource=void 0,i("./dist/plugins/data/worksheet-databind.js"),u=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"CellBindingSource",{enumerable:!0,get:function(){return u.CellBindingSource}}),Object.defineProperty(t,"$$",{enumerable:!0,get:function(){return u.$$}}),Object.defineProperty(t,"setValueByPath",{enumerable:!0,get:function(){return u.setValueByPath}}),Object.defineProperty(t,"q$",{enumerable:!0,get:function(){return u.q$}}),e(i("./dist/plugins/data/data.ko.js"),t),e(i("./dist/plugins/data/data.dataview.js"),t),e(i("./dist/plugins/data/data.ns.js"),t)},"./dist/plugins/data/data.ko.js":function(n,t,i){var g,r,a,s,m,u,c,d,f,p,o,e,i;function v(){}Object.defineProperty(t,"__esModule",{value:!0}),t.X$=void 0,g=i("Core"),r=i("Common"),a=i("./dist/plugins/data/binding.js"),Object.defineProperty(t,"X$",{enumerable:!0,get:function(){return a.X$}}),s=r.Common.lt.ht,m=g.GC$,u=m.isFunction,c=m.getType,d=m.isNumeric,f=null,p="string",o=window.ko,v.prototype.isDataSource=function(n){return o&&o.isObservable(n)},v.prototype.getDataLength=function(n){return n().length},v.prototype.getDataItem=function(n,t){return n()[t]},v.prototype.addItems=function(n,t,i,r){for(var e,u,e=0;e<i;e++)u={},r&&(u=r.createEntity?r.createEntity():new r),n.splice(t,0,u)},v.prototype.removeItems=function(n,t,i){var r=this.getDataLength(n);if(t<r)return n.splice(t,Math.min(i,r-t))},v.prototype.undoRemoveItems=function(n,t,i){for(var r=0,e=i.length;r<e;r++)n.splice(t+r,0,i[r])},v.prototype.getProperties=function(n){var n,t,i,r,e,n=n(),t,i=[];if(0<n.length)for(e in r=n[0])(!u(r[e])||o&&o.isObservable(r[e]))&&i.push(e);return i},v.prototype.getValue=function(n,t,i,r,e){var u=f,o=!1,n=this.getDataItem(n,r);return s(n)||(t?(u=t(n),o=!0):i?(u=(0,a.q$)(n,i),o=!0):c(n)!==p&&!d(n)||0!==e||(u=n,o=!0)),{value:u,hasBinding:o}},v.prototype.setValue=function(n,t,i,r,e,u){var o=!1,f=this.getDataItem(n,r);return s(f)||(t?(t(f,u),o=!0):i?((0,a.setValueByPath)(f,i,u),o=!0):c(f)!==p&&!d(f)||0!==e||(n()[r]=u,o=!0)),o},v.prototype.fromJSON=function(n){return o?o.observableArray(n):f},v.prototype.toJSON=function(n){return n()},a.X$.koBinding=new v,o&&((i=o.bindingHandlers)["gc-spread-sheets"]=i["gcspread-sheets"]=i.wijspread={init:function(n,t,i,r){var t,e,u,o,f,a,s,c,d,v,l,h;if(!m(n).data("workbook")&&(e=(t=t())&&t.sheets,u=new g.Workbook(m("#"+n.id)[0],t),e)){for(f=o=void 0,a=e.length,s=u.getSheetCount();s<a;)o=u.S2(u.T2(s)),u.A2(s,0,o),s=u.getSheetCount();for(c=0;c<a;c++)o=u.getSheet(c),d=(f=e[c]).name,v=f.autoGenerateColumns,l=f.data,h=f.columns,typeof d==p&&0<d.length&&o.ub(d),"boolean"==typeof v&&(o.autoGenerateColumns=v),l&&o.setDataSource(l),h&&0<h.length&&(o.autoGenerateColumns=!1,o.bindColumns(h))}},update:function(n,t,i,r){}})},"./dist/plugins/data/data.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var i=i("./dist/plugins/data/data.res.en.js");t.SR={en:i}},"./dist/plugins/data/data.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_NotSupportedDataSource=void 0,t.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(n,t,i){var b,t,s,v,a,i,r,l,u,o,w,e;function f(n,t,i){n.Ut.do("setItem",!1,3,t,i="string"==typeof i?{name:i}:i);var r=i&&i.formatter,e=i&&i.cellType;r&&n.setFormatter&&n.setFormatter(-1,t,r),e&&n.setCellType(-1,t,e),i&&!v(i.width)&&n.setColumnWidth(t,i.width)}function c(n,t,i,r,e,u){var o,o,f,a,s,c,d,v,l,h,g,m,g,m,p,o,f=n.H3,a="dataManagerBindingSource"===f.K$,s=n.NMi,c=null==e?void 0:e.sharedStrings,d=null==e?void 0:e.styleManager;if(s&&s._gi===b.SheetType.ganttSheet){for(v=0;v<i;v++)if(!s.zDi(v))for(l=0;l<r;l++)h=s.Rpi(v,l),u?n.c8(t,v,l,h,c):n.s8(t,v,l,h,a)}else for(v=0;v<i;v++)for(l=0;l<r;l++)m=(g=f.getValue(v,l)).value,g&&g.hasBinding&&(w.W0(g=m)&&(g=w.Q0(m)),p=m=void 0,(o=null==(o=null==(o=f.xBe())?void 0:o[l])?void 0:o.formatter)&&d&&((m=n.getStyle(v,l))?"string"==typeof m&&(m=n.u8(m)):m=new b.Style,m.formatter=o,p=d.getStyleIndex(m,3,n.name())),u?n.c8(t,v,l,g,c,p):n.s8(t,v,l,g,a,m))}function d(n,t,i,r){var n=n.getSpan(t,i,r);return!(!n||n.row===t&&n.col===i)}function h(n,t,i,r){for(var e,u,o,f,a,f,e=n.options.colHeaderAutoTextIndex,u=0;u<i;u++)if(0<=e&&u===e||-1===e&&u===i-1)for(o=0;o<r;o++)f=t[u]&&t[u][o]&&t[u][o].value,a=n.Ut.q_(!1,3,o),v(f)&&a&&!d(n,u,o,1)&&(f=a.displayName||a.name)&&n.s8(t,u,o,f)}function g(n,t){var n,i;return"Object"===t.constructor.name&&(n=n.findByName(t.tableName))&&(n.H3?t=n.H3:((i=new s.$$).fromJSON(t),n.H3=t=i)),t}Object.defineProperty(t,"__esModule",{value:!0}),b=i("Core"),t=i("Common"),s=i("./dist/plugins/data/binding.js"),v=t.Common.lt.ht,a=b.GC$.isEmptyObject,i=b.GC$.extend,r=b.Worksheet.prototype,l=null,u="bindingPath",o=new RegExp("^\\d*(\\.\\d+)?\\*$"),w=t.Common.ct,i(r,e={getDataSource:function(){var n=this.H3;return n?n.getSource():l},setDataSource:function(n,t){var i,r,e,u,o,f,a,t,n,i=this,r=i.H3;if(r&&(r.getSource()!==n||i.NMi)){if(i.suspendPaint(),t&&i.sF(),i.suspendCalcService&&i.suspendCalcService(),n){if(e=i.Ut,(r=i.H3).Ctt=!0,!(u=r.bind(n,e.G8))){if(i.setRowCountCore(r.getRowCount()),i.autoGenerateColumns&&(i.setColumnCount(r.getColumnCount()),o=r.ltt()))for(f=0,a=o.length;f<a;f++)e.do("setItem",!1,3,f,{name:o[f]});e.d3e(0,0,i.getRowCount(),i.getColumnCount())}}else i.H3=new s.$$(i);i.clearPendingChanges(),t=!1,r&&r.Ctt&&(t=r.Stt,delete r.Stt,delete r.Ctt),i.recalcAll&&i.recalcAll(t),i.resumeCalcService&&i.resumeCalcService(t),(n=i.ST())&&n.DS===i&&n.c5(),i.resumePaint()}},bindColumn:function(n,t){var i=this;i.suspendPaint();try{f(i,n,t)}finally{i.resumePaint()}},bindColumns:function(n){var t,i,r,e,u,t=this;t.suspendPaint();try{if(n)for(i=n.length,isNaN(i)||t.setColumnCount(i),r=0;r<i;r++)u=(e=n[r]).size,o.test(u)&&(e.starSize=u),f(t,r,e)}finally{t.resumePaint()}},getDataItem:function(n){var t,i,r,e,u,o,f,a,t=this,i=t.H3;if(!i||0===i.getRowCount())return l;if(r=t.getColumnCount(),e={},u=i.ftt(n))for(o in u)u.hasOwnProperty(o)&&"function"!=typeof o&&(e[o]=u[o]);for(f=0;f<r;f++)(a=t.Ut.q_(!1,3,f))&&a.name&&0<a.name.length&&v(e[a.name])&&(e[a.name]=t.getValue(n,f));return e},getDataColumnName:function(n){var t,t,t=this;return 0<=n&&n<t.getColumnCount()&&t.getDataSource()?(t=t.Ut.q_(!1,3,n))&&(t.displayName||t.name):l},getBindingPath:function(n,t){return this.Ut.getValueForKey(n,t,u)},setBindingPath:function(n,t,i){var r=this,e=r.Ut;return e.do("setValueForKey",n,t,u,i),e.t3e(n,t,!i),r.ki(b.Events.WorksheetDataChanged,{type:"bindingPath"}),r.zw(),r}}),b.CellRange.prototype.bindingPath=b.CellRange.p0(r.getBindingPath,r.setBindingPath),b.Worksheet.ch("binding",{init:function(){var n=this;n.autoGenerateColumns=!0,n.H3=new s.$$(n)},dispose:function(n){var t;!1!==n.clearCache&&(this.H3=l)},onLayoutChanged:function(n){var t,i,r,e,u,o,f,a,s,c,d,t=this,i=n.changeType,r=n.row,e=n.rowCount,u=n.sheetArea;if(v(u)||3===u||2===u)if(o=t.H3,"addingRows"===i)o&&!1===o.dtt()?n.canAdd=!1:o&&!1===o.vtt()&&(n.newRow=t.getRowCount());else if("addRows"===i)o&&o.kE(r,e,t.Ut.G8);else if("deletingRows"===i){if(o)if(!1===o.mtt())n.canDelete=!1;else for(t.aj||(t.aj=[]),f=t.aj,a=t.Ut,s=o.getRowCount(),c=0;c<e&&r+c<a.getRowCount();c++)d=l,r+c<s&&(d=o.ftt(r+c)),f.push({row:r+c,data:d})}else"deleteRows"===i?o&&o.btt(r,e,t.Ut.G8):"settingRowCount"!==i||!o.getSource()||o.allowSetCount()||3!==u&&2!==u||(n.canSet=!1)},toJson:function(n,t){var i,r,e,t,e,u,i=this,r=i.getColumnCount(),e=i.getDataSource();t&&t.includeBindingSource&&e&&(c(i,t=n.data.dataTable||{},i.getRowCount(),r),a(t)||(n.data.dataTable=t),h(i,e=n.colHeaderData.dataTable||{},i.getRowCount(1),r),a(e)||(n.colHeaderData.dataTable=e)),!0!==(u=i.autoGenerateColumns)&&(n.autoGenerateColumns=i.autoGenerateColumns)},fromJson:function(n,t){var i,r,e,u,e,i=this;i.H3=new s.$$(i),t&&(r=i.H3,e=n.dataSource,u=n.dataBinding,e&&r.bind(e),u)&&r.fromJSON(u,t),e=n.autoGenerateColumns,v(e)||(i.autoGenerateColumns=e)},preFromJson:function(){this.H3=new s.$$(this)},wh:function(n,t,i){var r,e,u,o,i,f,r=this,e=r.getColumnCount(),u=r.getDataSource(),o=n.lossless;o=o||(n.lossless={}),i&&i.includeBindingSource&&u&&(c(r,n,r.getRowCount(),e,t,!0),h(r,i=o.colHeaderData.dataTable||{},r.getRowCount(1),e),a(i)||(o.colHeaderData.dataTable=i)),!0!==(f=r.autoGenerateColumns)&&(o.autoGenerateColumns=r.autoGenerateColumns)},yh:function(n){var t,n,t=this;t.H3=new s.$$(t),n=n.lossless&&n.lossless.autoGenerateColumns,v(n)||(t.autoGenerateColumns=n)}}),b.Y8.ch("binding",{priority:6e3,isValid:function(n){var t,n,t,n=-1<["getValue","setValue"].indexOf(n),t=null==(t=this.Mf.H3)?void 0:t._dataSource;return!n||t},getValue:function(n){var t,i,r,e,r,e,t=n.row,i=n.col,r=n.sheetArea,e=this.Mf.H3;3===r&&e&&e._dataSource&&(r=e.getValue(t,i),n.isValueGet=r.hasBinding,e=r.value,1!==n.valueType&&(e=b.mt.wt(e)),n.value=e)},setValue:function(n){var t,i,r,e,u,o,f,f,a,t=n.row,i=n.col,r=n.value,e=n.sheetArea,u=this.Mf,o=u.H3;3===e&&o&&o._dataSource&&(f=o.getValue(t,i)).hasBinding&&(r!==(f=f.value)?(u.isDirtySuspended()||(a=u.getDataItem(t),this.dE(t,i,{gE:a,d6:f},e)),n.isValueSet=o.setValue(t,i,r,u.Ut.G8)):n.isValueSet="dataManagerBindingSource"!==o.K$)},applyChanges:function(n){var t,n,i,r,e,u,t=n.changes,n=n.isUndo,i=t&&t._bindingChanges;if(i)if(n)for(r=i.length-1;0<=r;r--)(e=i[r]).bindingManager&&(u=g(this.Mf.tables,e.bindingManager)).Mtt(e);else for(r=0;r<i.length;r++)e=i[r],(u=g(this.Mf.tables,e.bindingManager)).wtt&&u.wtt(e)},undoValue:function(n){var t,i,r,t=n.bindingChanges;if(t)for(i=t.length-1;0<=i;i--)(r=t[i]).bindingManager.Mtt(r)}})},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/data/data.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Bindings=n}();