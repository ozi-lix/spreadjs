/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var r,e,n;function i(n){var t,t,t=e[n];return void 0!==t||(t=e[n]={exports:{}},r[n].call(t.exports,t,t.exports,i)),t.exports}r={"./dist/plugins/table/customTableThemeManager.js":function(n,t,r){var e,i,o,u,a;function f(){return null!==a&&a.apply(this,arguments)||this}e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTableThemeManager=void 0,i=r("Core"),a=i.CustomThemeManagerBase,e(f,a),f.prototype.Oh=function(){return i.CustomThemeType.table},f.prototype.remove=function(t){var r,e,n,n,r=this,e=this.Vv,n=e.defaultTableTheme();n&&this.M0r(n.name(),t)&&e.defaultTableTheme(void 0),e.suspendPaint(),(n=e.sheets)&&0<n.length&&n.forEach(function(n){var n=n.tables.all();n&&0<n.length&&n.forEach(function(n){var n;r.M0r(n.getStyleName(),t)&&n.style(null!=(n=e.defaultTableTheme()&&e.defaultTableTheme().name())?n:"medium2")})}),e.resumePaint(),a.prototype.remove.call(this,t)},f.prototype.S0r=function(t,r){var e,n,e=this,n=this.Vv;this.M0r(n.Bur,t)&&n.defaultTableTheme(r.name()),n.suspendPaint(),n.sheets.forEach(function(n){var n=n.tables.all();n&&0<n.length&&n.forEach(function(n){e.M0r(n.getStyleName(),t)&&n.style(r.name())})}),n.resumePaint()},t.CustomTableThemeManager=f},"./dist/plugins/table/data-manager-providers/data-manager-provider.entry.js":function(n,t,r){var e,i,e=this&&this.__createBinding||(Object.create?function(n,t,r,e){void 0===e&&(e=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(n,e,i)}:function(n,t,r,e){n[e=void 0===e?r:e]=t[r]}),i=this&&this.__exportStar||function(n,t){for(var r in n)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||e(t,n,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r("./dist/plugins/table/data-manager-providers/data-manager-view-provider.js"),t)},"./dist/plugins/table/data-manager-providers/data-manager-view-provider.js":function(n,t,r){var e,i,o,s,u,v,f,l,a,c;function h(n){return u&&u.isView&&u.isView(n)}function d(n){return n instanceof Function}function b(n){return{field:n.rYt,ascending:n.ascending,compare:n.compareFunction}}function w(){}Object.defineProperty(t,"__esModule",{value:!0}),t.isDMView=void 0,e=r("Bindings"),i=r("Bindings"),o=r("Common"),s=r("Core"),u=r("DataManager"),v=r("DataManager"),f=o.Common.lt.ht,l=null,a=void 0,t.isDMView=h,w.prototype.isDataDrivenMode=function(){return!0},w.prototype.isDataSource=function(n){return h(n)&&n.HTr&&n.HTr()},w.prototype.getDataLength=function(n){return n.length()},w.prototype.getDataItem=function(n,t,r){var e;return t<0?l:(e=a,r&&((e={})[r]=1),n.getRowData(t,a,e))},w.prototype.addItems=function(n,t,r,e,i){for(var o,u,a,o,u=!n.getTable().X7t()?function(){n.saveItem(t,i)}:i,a=0;a<r;a++)n.insertItem(t,{},u)},w.prototype.removeItems=function(n,t,r,e){var i;t<this.getDataLength(n)&&n.removeItem(t,r,e)},w.prototype.undoRemoveItems=function(n,t,r){},w.prototype.POn=function(t,n){var n=n.map(function(n){return n.rYt=t.ife(n.index),b(n)});t.sort(n)},w.prototype.Irn=function(n,t){var r,e;if(t)for(r=0;r<t.length;r++)(e=t[r]).field=n.ife(e.col);n.filter(t)},w.prototype.ETr=function(n,t,r){return n.ETr(t,r)},w.prototype.qFe=function(n,t,r){n.qFe(t,!1,r)},w.prototype.iGe=function(n,t,r){n.TGe(t)},w.prototype.JEe=function(n,t,r){var e=n.kve(t);e&&(e.zTr||(0,v.isNamedFormulaColumn)(r)?n.VTr(t,r):n.xGe(t,r))},w.prototype.vCn=function(n){n.vCn()},w.prototype.FCn=function(n){var t;return!n.lM()||(n.FCn(),n.lM())?a:(t=n.LEe(),n.PEe(),t)},w.prototype.Mtt=function(r,e){for(var i,n,t,i=(0,v.useSerialExecutor)(),n=function(n){var t=e[n];i.appendPromiseLike(function(){return r.Mtt(t)})},t=e.length-1;0<=t;t--)n(t);return i.execute()},w.prototype.kve=function(n,t){return n.kve(t)},w.prototype.getProperties=function(n){var t;return n.getColumn().map(function(n){return"="===n.value[0]?n.name:n.value})},w.prototype.hasValue=function(n,t,r){var r=n.yLt[r];return r?n.YTr(t,r):{value:l,hasBinding:!0}},w.prototype.getValue=function(n,t,r,e,i,o){var t,i,u,n,a,i=n.yLt[i];return i?(u=l,n=n.ZTr(e,i),a=!1,f(n)||(a=!0,t&&d(t)&&(n=t(((t={})[r]=n,t))),u=o?o(i,e,n):n),{value:u,hasBinding:a}):{value:l,hasBinding:!0}},w.prototype.setValue=function(n,t,r,e,i,o,u){var i,a,f,i,l,a,c,f=!1,i=n.kve(i);return i&&!i.zTr&&!(0,v.isFormula)(i)&&null!=(a=n.getTable())&&a.hasExistedColumn(i.value)&&(a=(l=!n.getTable().X7t())?function(){n.saveItem(e,u)}:u,o=s.util.V0(o),t&&d(t)?(c=this.getDataItem(n,e))&&(t(c,o),n.updateItem(e,c,a),f=!0):((i={})[r]=o,c=i,n.updateItem(e,c,a),f=!0)),f},w.prototype.allowSetCount=function(){return!0},w.prototype.canAdd=function(){return!0},w.prototype.canInsert=function(){return!0},w.prototype.canRemove=function(){return!0},w.prototype.canFilter=function(){return!0},w.prototype.canSort=function(){return!0},w.prototype.canAddColumn=function(){return!0},w.prototype.canRemoveColumn=function(){return!0},w.prototype.canUpdateColumn=function(){return!0},w.prototype.canUndo=function(){return!0},w.prototype.fromJSON=function(n){return n},w.prototype.toJSON=function(n){return n},i&&u&&e.X$&&(e.X$.dataManagerViewBindingSource=new w)},"./dist/plugins/table/table-action.js":function(B,n,t){var r,b,n,e,D,w,c,h,z,e,d,i,s,m,v,l,o,u,a,f,g,y,p,C,S,T,_,R,x,E,t,n,U,V,H,G,j,J,P,O,F,Y,$,W,q,K,X,Z,Q,nn,tn,rn,en,on,un,an;function k(n,t){t.message===U().Exp_TableAddRowIntersectTable&&n.jT(b.InvalidOperationType.table,U().Exp_TableAddRowIntersectTable)}function A(n,t,r,e,i){var i=i-e;i<0?c(n,t,l,r+i,Math.abs(i)):0<i&&c(n,t,v,r,i,!0)}function L(n,t){var n=K.call(this,n)||this;return n.l4t=t,n.h4t=t.tableName,n.d4t=t.resizeToRange,n.eke=t.backupTableResizedArgs,n.H5e=t.ignoreEventSuspend,n.PIr=t.PIr,n}function I(n,t){var n=X.call(this,n)||this;return n.NBe=t,n.h4t=t.tableName,n.$xu=t.isAuto,n.d4t=t.resizeToRange,n.BSt=t.columns,n}function M(n,t){var n=Z.call(this,n)||this;return n.kBe=t,n.h4t=t.tableName,n}function N(n,t){var n=Q.call(this,n)||this;return n.v4t=t,n.h4t=t.tableName,n.Ky=t.row,n.DU=t.count,n.m4t=t.isAfter,n}function fn(n,t){var n=nn.call(this,n)||this;return n.v4t=t,n.h4t=t.tableName,n.Ky=t.row,n.DU=t.count,n.m4t=t.isAfter,n}function ln(n,t){var n=tn.call(this,n)||this;return n.g4t=t,n.h4t=t.tableName,n.p4t=t.changeRows,n}function cn(n,t){var n=rn.call(this,n)||this;return n.b4t=t,n.h4t=t.tableName,n.iw=t.col,n.DU=t.count,n.m4t=t.isAfter,n}function sn(n,t){var n=en.call(this,n)||this;return n.y4t=t,n.h4t=t.tableName,n.iw=t.col,n.DU=t.count,n}function vn(n,t){var n=on.call(this,n)||this;return n.w4t=t,n.h4t=t.tableName,n}function hn(n,t){var n,r,n=un.call(this,n)||this,r=n;return r.M4t=t,r.Ky=t.row,r.iw=t.col,r.D5=t.newValue,n}function dn(n,t){var n,r,n=an.call(this,n)||this,r=n;return r.C4t=t,r.h4t=t.tableName,r.oL=t.showFooter,r.vPt=t.isInserted,n}r=this&&this.__extends||(q=function(n,t){return(q=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}q(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Object.defineProperty(n,"__esModule",{value:!0}),b=t("Core"),n=t("Common"),e=t("./dist/plugins/table/table-util.js"),D=e.Util.S4t,w=e.Util.jj,c=e.Util.Ej,h=e.Util._getTable,z=e.Util.T4t,e=b.Commands.ActionBase,d=n.Common.lt.ht,i="tableResize",s="tableInsertRows",m="tableDeleteRows",v="tableInsertColumns",l="tableDeleteColumns",o="tableToRange",u="tableTotalRowFormula",a="DoInsertRows",f="tableShowFooter",g="bindingTableAddColumn",y="tableAutoBind",p="tableSubmitChanges",C="tableInsertRowsAboveForContextMenu",S="tableInsertRowsBelowForContextMenu",T="tableDeleteRowsForContextMenu",_="tableInsertColumnsLeftForContextMenu",R="tableInsertColumnsRightForContextMenu",x="tableDeleteColumnsForContextMenu",E=void 0,t=t("./dist/plugins/table/table.ns.js"),n=new n.Common.ResourceManager(t.SR,"Tables"),U=n.getResource.bind(n),r(L,K=e),L.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,l,c,s,n=this,t=!1;if(n.canExecute()){e=(r=n.Mf).Ut,i=n.h4t,o=n.l4t,e.startTransaction(),n.X5(r,!0);try{!(u=r.tables.findByName(i))||u.NTr()&&!this.PIr||(a=u.range(),f=n.d4t,l=n.eke,r.tables.K5t(u,f),c=u.range(),a.rowCount!==c.rowCount&&u.tUr(),null!=l&&l.push({sheet:r,table:u,oldRange:f,newRange:a}),D(r,u,a,f,n.H5e),t=!0)}finally{n.q5(r,!0),o[s=b.Commands.TI(r.name())]=e.endTransaction()}}return t},L.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,n=this,t=n.Mf,r=n.h4t,e=!1;if(n.canUndo()){n.X5(t,!0),t.suspendCalcService();try{i=n.l4t,o=t.Ut,u=t.tables.findByName(r),(f=i[a=b.Commands.TI(t.name())])&&(o.undo(f),D(t,u,i.resizeToRange,u.range(),n.H5e),e=!0)}finally{t.resumeCalcService(!1),n.q5(t,!0)}}return e},V=L,b.Commands[i]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,V,t,r)}},r(I,X=e),I.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,i,n=this,t=!1;if(n.canExecute()){e=(r=n.Mf).Ut,i=n.h4t,o=n.d4t,e.startTransaction(),n.X5(r,!0);try{(u=r.tables.findByName(i))&&(a=u.Tx,f=u.endColumn(),u.autoGenerateColumns(n.$xu),o.colCount!==a&&(r.tables.K5t(u,o),A(r,u,f,a,u.Tx),u.bind(n.BSt)),t=!0)}finally{n.q5(r,!0),i=b.Commands.TI(r.name()),n.NBe[i]=e.endTransaction()}}return t},I.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,l,c,n=this,t=n.Mf,r=n.h4t,e=!1;if(n.canUndo()){n.X5(t,!0);try{i=n.NBe,o=t.Ut,u=t.tables.findByName(r),(f=i[a=b.Commands.TI(t.name())])&&(l=u.Tx,c=u.endColumn(),o.undo(f),A(t,u,c,l,u.Tx),e=!0)}finally{n.q5(t,!0)}}return e},H=I,b.Commands[g]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,H,t,r)}},r(M,Z=e),M.prototype.execute=function(){var n,t,r,e,i,o,u,a,i,n=this,t=!1;if(n.canExecute()){e=(r=n.Mf).Ut,i=n.h4t,e.startTransaction(),n.X5(r,!0);try{(o=r.tables.findByName(i))&&(u=o.Tx,a=o.endColumn(),o.autoGenerateColumns(!0),o.autoBind(),A(r,o,a,u,o.Tx),t=!0)}finally{n.q5(r,!0),i=b.Commands.TI(r.name()),n.kBe[i]=e.endTransaction()}}return t},M.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,l,c,n=this,t=n.Mf,r=n.h4t,e=!1;if(n.canUndo()){n.X5(t,!0);try{i=n.kBe,o=t.Ut,u=t.tables.findByName(r),(f=i[a=b.Commands.TI(t.name())])&&(l=u.Tx,c=u.endColumn(),o.undo(f),A(t,u,c,l,u.Tx),e=!0)}finally{n.q5(t,!0)}}return e},G=M,b.Commands[y]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,G,t,r)}},r(N,Q=e),N.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,l,n=this,t=!1;if(n.canExecute()){r=n.Mf,e=n.h4t,i=n.Ky,o=n.DU,u=n.m4t,b.Commands.II((0,b.rke)(r)),n.X5(r,!0);try{(a=r.tables.findByName(e))&&(f=a.Sx,a.zpt(i,o,u),a.tUr(),t=!0,(l=a.Sx)-f===o)&&w(r,a,s,i,o,u)}catch(n){k(r,n)}finally{n.q5(r,!0),b.Commands.xI(r.parent.i4(),n.v4t)}}return t},N.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,l,c,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{o=(e=n.v4t)[i=b.Commands.TI(t.name())],u=e.row,a=e.count,f=e.isAfter,o&&(b.Commands.NI(t.parent.i4(),e),(l=t.tables.findByName(n.h4t))&&(c=f?u+1:u,l.A4t(c,a),l.x4t(c,a,z(!0)),w(t,l,m,u,a,E,l.tq())),r=!0)}finally{n.q5(t,!0)}}return r},j=N,b.Commands[s]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,j,t,r)}},r(fn,nn=e),fn.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,i,n=this,t=!1;if(n.canExecute()){e=(r=n.Mf).Ut,i=n.h4t,o=n.Ky,u=n.DU,a=n.m4t,e.startTransaction(),n.X5(r,!0);try{(f=r.tables.findByName(i))&&(f.N4t(o,u,a,!1),f.tUr(),w(r,f,s,o,u,a),n.v4t.row=o,n.v4t.count=u,t=!0)}finally{n.q5(r,!0),i=b.Commands.TI(r.name()),n.v4t[i]=e.endTransaction()}}return t},fn.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,l,c,s,v,h,d,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{e=n.v4t,i=t.Ut,u=e[o=b.Commands.TI(t.name())],a=e.row,f=e.count,l=e.isAfter,u&&(s=(c=t.tables.findByName(n.h4t))&&c.z3(),v=void 0,h=l?a+1:a,s&&(d=c.dataRange(),v=s.slice(h-d.row,h-d.row+f)),i.undo(u),c&&(c.A4t(h,f),c.x4t(h,f,z(!0)),w(t,c,m,a,f,l,v||c.tq())),r=!0)}finally{n.q5(t,!0)}}return r},J=fn,b.Commands[a]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,J,t,r)}},r(ln,tn=e),ln.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,l,c,n=this,t=!1;if(n.canExecute()){r=n.Mf,e=n.h4t,i=n.p4t,b.Commands.II((0,b.rke)(r)),n.X5(r,!0);try{if(o=r.tables.findByName(e))for(u=i.length-1;0<=u;u--)a=i[u].row,f=i[u].count,l=o.Sx,o.yE(a,f),o.tUr(),t=!0,l-(c=o.Sx)===f&&w(r,o,m,a,f,E,o.tq())}catch(n){k(r,n)}finally{n.q5(r,!0),b.Commands.xI(r.parent.i4(),n.g4t)}}return t},ln.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,l,c,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{if(o=(e=n.g4t)[i=b.Commands.TI(t.name())],u=n.p4t,o)for(b.Commands.NI(t.parent.i4(),e),a=t.tables.findByName(n.h4t),r=!0,f=u.length-1;0<=f;f--)l=u[f].row,c=u[f].count,w(t,a,s,l,c,!1)}finally{n.q5(t,!0)}}return r},P=ln,b.Commands[m]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,P,t,r)}},r(cn,rn=e),cn.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,l,n=this,t=!1;if(n.canExecute()){r=n.Mf,e=n.h4t,i=n.iw,o=n.DU,u=n.m4t,b.Commands.II((0,b.rke)(r)),n.X5(r,!0);try{(a=r.tables.findByName(e))&&(f=a.Tx,a.k4t(i,o,u),t=!0,(l=a.Tx)-f===o)&&c(r,a,v,i,o,u)}catch(n){k(r,n)}finally{n.q5(r,!0),b.Commands.xI(r.parent.i4(),n.b4t)}}return t},cn.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{o=(e=n.b4t)[i=b.Commands.TI(t.name())],u=e.col,a=e.count,o&&(b.Commands.NI(t.parent.i4(),e),f=t.tables.findByName(n.h4t),r=!0,c(t,f,l,u,a))}finally{n.q5(t,!0)}}return r},O=cn,b.Commands[v]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,O,t,r)}},r(sn,en=e),sn.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,n=this,t=!1;if(n.canExecute()){r=n.Mf,e=n.h4t,i=n.iw,o=n.DU,b.Commands.II((0,b.rke)(r)),n.X5(r,!0);try{(u=r.tables.findByName(e))&&(a=u.Tx,u.wE(i,o),t=!0,a-(f=u.Tx)===o)&&c(r,u,l,i,o)}catch(n){k(r,n)}finally{n.q5(r,!0),b.Commands.xI(r.parent.i4(),n.y4t)}}return t},sn.prototype.undo=function(){var n,t,r,e,i,o,u,a,f,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{o=(e=n.y4t)[i=b.Commands.TI(t.name())],u=e.col,a=e.count,o&&(b.Commands.NI(t.parent.i4(),e),f=t.tables.findByName(n.h4t),c(t,f,v,u,a,!(r=!0)))}finally{n.q5(t,!0)}}return r},F=sn,b.Commands[l]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,F,t,r)}},r(vn,on=e),vn.prototype.execute=function(){var n,t,r,e,i,o,i,n=this,t=!1;if(n.canExecute()){e=(r=n.Mf).Ut,i=n.h4t,e.startTransaction(),n.X5(r,!0);try{(o=r.tables.findByName(i))&&(r.tables.remove(o,3),t=!0)}finally{n.q5(r,!0),i=b.Commands.TI(r.name()),n.w4t[i]=e.endTransaction()}}return t},vn.prototype.undo=function(){var n,t,r,e,i,o,u,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{e=n.w4t,i=t.Ut,(u=e[o=b.Commands.TI(t.name())])&&(i.undo(u),r=!0)}finally{n.q5(t,!0)}}return r},Y=vn,b.Commands[o]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,Y,t,r)}},r(hn,un=e),hn.prototype.execute=function(){var n,t,r,e,i,o,u,a,f,l,c,u,n=this,t=!1;if(n.canExecute()){(e=(r=n.Mf).Ut).startTransaction(),n.X5(r,!0);try{i=n.Ky,o=n.iw,u=n.D5,r.setFormula(i,o,u),u?u.startsWith("=SUBTOTAL(103")||u.startsWith("=SUBTOTAL(102")||(a=r.getFormatter(i,o))&&"GENERAL"!==a.toUpperCase()||(c=(l=(f=r.tables.find(i,o))&&f.BSt[o-f.startColumn()])&&l.formatter(),(0,b.Ffe)(r,i,o,c)):r.setValue(i,o,null),t=!0}finally{n.q5(r,!0),u=b.Commands.TI(r.name()),n.M4t[u]=e.endTransaction()}}return t},hn.prototype.undo=function(){var n,t,r,e,i,o,u,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{e=n.M4t,i=t.Ut,(u=e[o=b.Commands.TI(t.name())])&&(i.undo(u),r=!0)}finally{n.q5(t,!0)}}return r},$=hn,b.Commands[u]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,$,t,r)}},r(dn,an=e),dn.prototype.execute=function(){var n,t,r,e,i,o,u,o,n=this,t=!1;if(n.canExecute()){i=(e=n.Mf).Ut,o=n.h4t,i.startTransaction(),n.X5(e,!0);try{(u=e.tables.findByName(o))&&(u.showFooter(n.oL,n.vPt),t=!0)}catch(n){r=n.message}finally{r&&e.jT(b.InvalidOperationType.table,r),n.q5(e,!0),o=b.Commands.TI(e.name()),n.C4t[o]=i.endTransaction()}}return t},dn.prototype.undo=function(){var n,t,r,e,i,o,u,n=this,t=n.Mf,r=!1;if(n.canUndo()){n.X5(t,!0);try{e=n.C4t,i=t.Ut,(u=e[o=b.Commands.TI(t.name())])&&(i.undo(u),r=!0)}finally{n.q5(t,!0)}}return r},W=dn,b.Commands[f]={canUndo:!0,execute:function(n,t,r){return b.Commands.zA(n,W,t,r)}},b.Commands[C]={canUndo:!0,execute:function(n,t,r){var e,i,o,u,a,f,i;return t.cmd=C,d(t.row)&&d(t.count)?(e=b.Commands.Tp(n,t),f=a=u=o=void 0,1===(i=t.selections).length&&(o=i[0],(u=h(e,o))&&(a=o.row,f=o.rowCount,i=u.footerIndex()===a,t.row=i?a-1:a,t.count=f,t.tableName=u.name(),t.isAfter=i),b.Commands.zA(n,j,t,r))):b.Commands.zA(n,j,t,r)}},b.Commands[S]={canUndo:!0,execute:function(n,t,r){var e,i,o,u,a,f;return t.cmd=S,d(t.row)&&d(t.count)?(e=b.Commands.Tp(n,t),f=a=u=o=void 0,1===(i=t.selections).length&&(o=i[0],(u=h(e,o))&&(a=o.row,f=o.rowCount,t.row=a,t.count=f,t.tableName=u.name(),t.isAfter=!0),b.Commands.zA(n,j,t,r))):b.Commands.zA(n,j,t,r)}},b.Commands[T]={canUndo:!0,execute:function(n,t,r){var e,i,o,u,a,f,l,c,s,v;if(t.cmd=T,d(t.changeRows)){for(e=b.Commands.Tp(n,t),i=t.selections,a=u=o=void 0,t.changeRows=[],f=0;f<i.length;f++){if(l=i[f],!(c=h(e,l)))return!1;if(o){if(o!==c)return!1}else o=c}for(f=0;f<i.length;f++)for(s=f+1;s<i.length;s++){if(l=i[f],v=i[s],l.row>=v.row&&l.row<=v.row+v.rowCount-1)return!1;if(l.row+l.rowCount-1>=v.row&&l.row+l.rowCount-1<=v.row+v.rowCount-1)return!1;if(l.row<=o.Ky||l.row+l.rowCount>o.Ky+o.Sx)return!1;if(v.row<=o.Ky||v.row+v.rowCount>o.Ky+o.Sx)return!1}for(i.sort(function(n,t){return n.row-t.row}),f=0;f<i.length;f++)u=(l=i[f]).row,a=l.rowCount,t.changeRows.push({row:u,count:a});t.tableName=o.name()}return b.Commands.zA(n,P,t,r)}},b.Commands[_]={canUndo:!0,execute:function(n,t,r){var e,i,o,u,a,f;return t.cmd=_,d(t.col)&&d(t.count)?(e=b.Commands.Tp(n,t),f=a=u=o=void 0,1===(i=t.selections).length&&(o=i[0],(u=h(e,o))&&(a=o.col,f=o.colCount,t.col=a,t.count=f,t.tableName=u.name(),t.isAfter=!1),b.Commands.zA(n,O,t,r))):b.Commands.zA(n,O,t,r)}},b.Commands[R]={canUndo:!0,execute:function(n,t,r){var e,i,o,u,a,f;return t.cmd=R,d(t.col)&&d(t.count)?(e=b.Commands.Tp(n,t),f=a=u=o=void 0,1===(i=t.selections).length&&(o=i[0],(u=h(e,o))&&(a=o.col,f=o.colCount,t.col=a,t.count=f,t.tableName=u.name(),t.isAfter=!0),b.Commands.zA(n,O,t,r))):b.Commands.zA(n,O,t,r)}},b.Commands[x]={canUndo:!0,execute:function(n,t,r){var e,i,o,u,a,f;return t.cmd=x,d(t.col)&&d(t.count)?(e=b.Commands.Tp(n,t),f=a=u=o=void 0,1===(i=t.selections).length&&(o=i[0],(u=h(e,o))&&(a=o.col,f=o.colCount,t.col=a,t.count=f,t.tableName=u.name()),b.Commands.zA(n,F,t,r))):b.Commands.zA(n,F,t,r)}},b.Commands[p]={canUndo:!1,execute:function(n,t){var r,n,e,t,i,t,r=n.getSheetFromName(t.sheetName)||n.getActiveSheet();return r&&!d(r.tables)&&(n=t.tableNames,e=[],d(n)||0===n.length?(t=r.getActiveRowIndex(),i=r.getActiveColumnIndex(),(t=r.tables.find(t,i))&&t.NTr()&&e.push(t)):n.forEach(function(n){var n=r.tables.findByName(n);n&&n.NTr()&&e.push(n)}),0<e.length)&&e.forEach(function(n){var n=n.z3();n&&n.submitChanges().catch(function(){})}),!1}},b.Commands.D4t=function(n){n.register(i,b.Commands[i]),n.register(g,b.Commands[g]),n.register(y,b.Commands[y]),n.register(s,b.Commands[s]),n.register(a,b.Commands[a]),n.register(m,b.Commands[m]),n.register(v,b.Commands[v]),n.register(l,b.Commands[l]),n.register(o,b.Commands[o]),n.register(u,b.Commands[u]),n.register(f,b.Commands[f]),n.register(C,b.Commands[C]),n.register(S,b.Commands[S]),n.register(T,b.Commands[T]),n.register(_,b.Commands[_]),n.register(R,b.Commands[R]),n.register(x,b.Commands[x]),n.register(p,b.Commands[p])}},"./dist/plugins/table/table-calcSource.js":function(n,t,r){var e,i,r,i,o,u,a;function f(){}function l(n,t){var o=a.call(this,n)||this;return o.getEvaluatorContext=function(n,t,r,e,i){return n.row=o.lsr.WTr()+n.row,n.VEr||(n.VEr=!0,n.col=o.lsr.startColumn()+n.col),o.rT.getEvaluatorContext(n,t,r,e,i)},o.lsr=t,o.Mf=t.Mf,o.nT=3,o.rT=o.Mf.Uw(),o}e=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Object.defineProperty(t,"__esModule",{value:!0}),t.QTr=void 0,i=r("CalcEngine"),r=r("CalcEngine"),i=i?r.CalcSource:f,e(l,a=i),l.prototype.getSheet=function(){return this.Mf},t.QTr=l},"./dist/plugins/table/table-data-driven-filter-dialog.js":function(n,t,r){var e,i,o,u,b,r,R,O,w,m,g,a,x,y,f,l,c;function s(n){return n&&n.conType&&"function"==typeof n.conType}function F(n,t){return s(n)&&!n.art&&!t.jut().isShowSelectCheck}function p(n,t,r,e,i,o,u,a,f,l){var c,s,f,l,i,l,v,h,d,d,c=n.Mf,s="string";return t!==w&&t!==m||(t=g,s="blank"),t&&"string"!==a&&("number"!==a&&"boolean"!==a||(isNaN(parseFloat(t))||(t=parseFloat(t)),s="number"),"object"!==a&&"date"!==a||t.match(y)&&!isNaN(Date.parse(t))&&(t=new Date(t),f&&f(),s="date"),"string"===s)&&l&&l(),f=t,i=(l=i?i():{}).row,l=l.isCheckedInCheckList,("string"!=typeof t||u)&&(v=!1,!R(i)&&"string"==typeof u&&n.Mf.parent&&(h=void 0,(d=n.Mf.parent.xO(u))&&(v=!0,h=d.getExpression()),v)&&(f=b.Util.evaluateExpression(n.Mf,i,e,h),R(f)||"object"!=typeof f||(f=R(f._error)?f.toString():f._error)),f=!v&&o?o.format(t,u,r,{sheet:c,row:i,col:e,sheetArea:3,quotePrefix:null}):f)&&"string"==typeof f&&(f=f.replace(/\r\n?/g,"\n")),"boolean"===a&&("TRUE"===(d=String(t).toUpperCase())&&(t=!0,f="TRUE"),"FALSE"===d)&&(t=!1,f="FALSE"),{row:i,filterData:t,filterText:f,type:s,isCheckedInCheckList:l}}function v(n,t){var r,e,i,o,u,o,a,f,l,c,s,v,h,d,b,w,m,g;if(n.NTr()){if(r=n.Mf,i=(e=n.z3())&&e.gLt,o=e.getColumn(t),R(o))return{};if((a=(u=function(n){return e.uFt(n)})(o=o.value||o.name))?i&&i.rBt(o)&&a.K$!==i.rBt(o)&&e.eRt([o],!0):e.eRt([o]),a=u(o),R(a))return{};for(f={},l=a.K$,delete a.K$,s=(c=O(a)).length,a.K$=l,v=n.BSt[t].cellType()||r.$f(),h=n.BSt[t].formatter(),d={},b=0;b<s;b++)g=p(n,m=w=c[b],f,t,null,v,h,l).filterText,d[m]=g;return d}}function h(n,t,r,e,i,o){var n=c.call(this,n,t,r,e,i)||this;return n.cze=!1,n.nM=o,n}e=this&&this.__extends||(l=function(n,t){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}l(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Object.defineProperty(t,"__esModule",{value:!0}),t.TableDataDrivenFilterDialog=t.GTr=void 0,i=r("Filters"),o=r("Filters"),u=r("Common"),b=r("./dist/plugins/table/table-util.js"),r=u.Common.lt,R=r.ht,O=Object.keys,w="null",m="undefined",g=null,a=void 0,x=1e5,y=/((\d{4}|\d{2}|\d{1})[\/\-])(\d{4}|\d{2}|\d{1})[\/\-](\d{4}|\d{2}|\d{1})|((\d{4}|\d{2}|\d{1})[\/\-\s](\d{4}|\d{2}|\d{1}) [0-9]{2}:[0-9]{2}:[0-9]{2})/,t.GTr=v,i&&i.HideRowFilter&&o.iut&&(c=o.iut,e(h,c),h.prototype.Bst=function(n,t,r,e,i,o,u){var a,f,l,c,s,v,h,d,b,w,m,g,y,y,p,C,S,T,_,a=this.nM,f=a.Mf,l=a.z3(),c=l&&l.gLt,s=function(n){return l.uFt(n)},v=this,h;if(v.filterButtonInfo.rowFilter){if(b=0,m=[],g=a.O5t(n),y=(y=l.getColumn(g)).value||y.name){if((w=s(y))?c&&c.rBt(y)&&w.K$!==c.rBt(y)&&l.eRt([y],!0):l.eRt([y]),w=s(y),R(w))return;d=w.K$,delete w.K$,m=O(w),b=m.length,w.K$=d,v.wTi=v.yTi(l.iRt)}if(v.Jut=!1,p=a.BSt[g].cellType()||f.$f(),C=a.BSt[g].formatter(),x<b){for(S=Math.ceil(b/x),v.CTi=[],T=1;T<S;T++)_=void 0,_=T===S-1?{startIndex:x*T,endIndex:b-1}:{startIndex:x*T,endIndex:x*(T+1)-1},v.CTi.push(_);v.Yut(!0),v.zTi(w,m,0,x-1,n,t,r,e,i,o,u,p,C,d),v.Vut(x/b),setTimeout(function(){v.asyncCreateFilterData(w,m,v.CTi,n,t,r,e,i,o,u,p,C,d,b)},0)}else v.zTi(w,m,0,b-1,n,t,r,e,i,o,u,p,C,d)}},h.prototype.zTi=function(a,f,n,t,l,r,e,c,s,v,h,d,b,w){var i,m,g,o,u,y,p,C,S,o,u,T,_,R,x,j,i=this.nM,m=this,g={},o=m.filterButtonInfo.rowFilter,u=o.Mct,C=o.isFiltered(l)&&F(o.rrt[l][0],m),S=0===u.length||o.isFiltered(l)&&1===u.length;for(S||(o=i.z3(),y=o.Jce||{},u=o.getColumn(i.O5t(l)),T=o.ife(u),p=O(y).filter(function(n){return n!==T})),_=function(n){for(var t,r,e,t=a[n],r=0;r<t.length;r++){for(e=0;e<p.length&&y[p[e]][t[r]];e++);if(e===p.length)return!0}return!1},R=function(n,t){return!(!n&&!S)||_(t)},x=function(n){var t,r,n,e,i,o,u,n,t=f[n],r,n=m.LTi(t,g,l,function(){return m.xTi(a[t],m.wTi)},d,b,w),e=n.row,i=n.filterData,o=n.filterText,u=n.type,n=n.isCheckedInCheckList;m.Pst(c,s,v,e,l,h,!0,i,o,u,!C&&n,R(n,t))},j=n;j<=t;j++)x(j)},h.prototype.LTi=function(n,t,r,e,i,o,u){var a=this;return p(this.nM,n,t,r,e,i,o,u,function(){a.Jut=!0},function(){a.cze=!0})},h.prototype.yTi=function(n){for(var t,r,t=[],r=0;r<n.length;r++)t[n[r]]=r;return t},h.prototype.xTi=function(n,t){for(var r,e,i,i=0;i<n.length;i++)if((e=t[r=n[i]])!==a)return{row:e,isCheckedInCheckList:!0};return{row:t[r=n[0]],isCheckedInCheckList:!1,index:r}},h.prototype.asyncCreateFilterData=function(n,t,r,e,i,o,u,a,f,l,c,s,v,h){var d,b,w,m,g,y,p,d=this,b=this,w,m;if(this.nM.Mf.Cut){for(g=new Date,y=new Date;0<r.length&&y-g<=500;)p=r.shift(),b.zTi(n,t,p.startIndex,p.endIndex,e,i,o,u,a,f,l,c,s,v),b.Vut(p.endIndex/h),y=new Date;0<r.length?setTimeout(function(){d.asyncCreateFilterData(n,t,b.CTi,e,i,o,u,a,f,l,c,s,v,h)},0):(b.Lst(i,o,!1,f,l,a,e),b.sut(),b.Yut(!1))}},h.prototype.Pst=function(n,t,r,e,i,o,u,a,f,l,c,s){var v,h,d,f,a,u,h,e,b,i,l,w,m,g,v=this,h=v.sheet,d=v.filterButtonInfo.rowFilter,a=u?a:h.getValue(e,i),u=u?f:h.vL(e,i,a),f=u=u&&u.trim(),h=v.B3().Blanks,b=!(e=!1);d.hst||(d.hst={}),i=d.nM.BSt[d.nM.O5t(i)].formatter(),w="date"===(l=l),v.Dst(l),1===v.Pat.Date&&(v.Wst=v.PTr(i)),w&&(f=d.Qst.format(a)),m=d.isFiltered(),g=!0,""===u?v.hasBlank||(l="blank",v.hasBlank=!0,c?(e=t[h]=!0,v.Dat.push({text:h,value:a,type:l}),o.push({text:h,value:a,type:l})):o.push({text:h,value:a,noCheck:!0,type:l}),!1!==s&&r.push({text:h,value:a,type:l,noCheck:!e})):n[f]||(c?(e=t[u]=!0,v.Dat.push({text:u,value:a,type:l}),o.push({text:u,value:a,type:l})):o.push({text:u,value:a,noCheck:!0,type:l}),!1!==s&&(r.push({text:u,value:a,type:l,noCheck:!e}),n[f]=!0))},t.TableDataDrivenFilterDialog=h)},"./dist/plugins/table/table-event.js":function(n,t,r){var o,w,t,m,e,r,g,h,f,i,u,t,y,p,C,a,o=this&&this.__assign||function(){return(o=Object.assign||function(n){for(var t,r,e,i,r=1,e=arguments.length;r<e;r++)for(i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),w=r("Core"),t=r("Common"),m=r("./dist/plugins/table/table.js"),e=r("./dist/plugins/table/table.ns.js"),r=r("./dist/plugins/table/table-util.js"),g=t.Common.lt.ht,h=null,f=Math.abs,i=10,u="tableResize",t=new t.Common.ResourceManager(e.SR,"Tables"),y=t.getResource.bind(t),p=r.Util._4t,C=r.Util.E4t,a=r.Util.j4t,w.GC$.extend(w.nk.prototype,{mk:function(n,t){var n,r,n=this.Tk(n,t);n&&((r=this).I9=r.x9=t.Ut.getSelections(),t.setSelection(n.row,n.col,n.rowCount,n.colCount))},Tk:function(n,t){var r,e,i,o,u,a,e,t,t,f,l,t,r=t.getSelections(),e=n.tableSelectInfo,i=e.table,o=0,u=0;if(i.oL&&(o=1),i.jO&&(u=1),a=h,e=e.action,t=(t=t.Bde)&&t.Ymt(),!g(t)&&0<t.length&&(r=t),e===m.TableSelectionType.TABLE_ROW_SELECT)a=(0,w.Ec)(n.row,i.iw,1,i.Tx);else if(e===m.TableSelectionType.TABLE_COL_SELECT){for(f=0;f<r.length;f++)if((l=r[f]).col===n.col&&l.row===i.Ky+u&&1===l.colCount&&l.rowCount===i.Sx-u-o){a=(0,w.Ec)(i.Ky,n.col,i.Sx,1);break}t=!a&&-1===n.rowViewportIndex&&r&&r[0]&&r[0].col===n.col&&r[0].rowCount===i.Sx,g(a)&&!t&&(a=(0,w.Ec)(i.Ky+u,n.col,i.Sx-u-o,1))}else if(e===m.TableSelectionType.TABLE_CORNER_SELECT){for(f=0;f<r.length;f++)if((l=r[f]).col===i.iw&&l.row===i.Ky+u&&l.colCount===i.Tx&&l.rowCount===i.Sx-u-o){a=(0,w.Ec)(i.Ky,i.iw,i.Sx,i.Tx);break}g(a)&&(a=(0,w.Ec)(i.Ky+u,i.iw,i.Sx-u-o,i.Tx))}else e===m.TableSelectionType.TABLE_SELECT&&(a=(0,w.Ec)(i.Ky,i.iw,i.Sx,i.Tx));return a},KL:function(n,t){var r,e,i,o,u,a,f,n,l,c,l,c,i,s,v,o,f,n,r=this.Mf,e=h;return e=r&&!r.isActualProtected()&&!r.isEditing()&&t&&t.showResizeHandle()&&(i=n.row,o=n.col,u=n.x,a=n.y,f=n.rowViewportIndex,n=n.colViewportIndex,l=p(r,t),c=C(r,t),i===l)&&o===c&&(c=(l=r.getCellRect(i,o,f,n)).x,i=l.y,o=c+(s=l.width),f=i+(v=l.height),!(n=r.options.rightToLeft)&&o-10<=u&&u<=o||n&&c<=u&&u<=c+10)&&f-10<=a&&a<=f?{x:u,y:a,table:t}:e},Sk:function(n){var t,r,e,e,i,o,t=this;!0!==t.$k&&!0!==t.rb&&(r=t.Mf,e=(e=n.resizeTableHitInfo)&&e.table)&&!e.QL()&&(t.$k=!0,t.rb=!0,t.O4t=e,t.R4t=e.Ky,t.B4t=e.iw,t.L4t=e.Sx,t.F4t=e.Tx,i=t.R4t+t.L4t-1,o=t.B4t+t.F4t-1,t.P4t=r.getCellRect(i,o),t.G4t=e.range(),t.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},t.Ok())},t9:function(){var n,t,r,e,i,n=this,t=n.Mf;n.Rk&&n.$k&&n.rb&&n.O4t&&(n.U4t(),n.H4t()&&(n.z4t=n.V4t(),n.Y4t(),n.Z4t(),!(r=(r=n.W4t)||n.Q4t()).equals(n.K4t))&&(n.W4t=(0,w.Ec)(n.K4t.row,n.K4t.col,n.K4t.rowCount,n.K4t.colCount),e=o(o({},n.K4t),{rowCount:n.K4t.rowCount+n.ykr()}),i=a(t,n.O4t,n.Q4t(),e))?(n.$4t(),t.Dn.q4t()):n.a9())},OD:function(){var n,t,r,n=this,t=n.Mf;n.l9(),n.$k&&n.rb&&n.K4t&&n.O4t?(n.$k=!1,n.rb=!1,n.J4t()?(r=n.Q4t(),n.X4t(),r.equals(n.K4t)?t.Dn.q4t():t.Qy().execute({cmd:u,sheetName:t.name(),tableName:n.O4t.name(),resizeToRange:n.K4t}),n.$4t()):(n.$4t(),t.Dn.q4t())):n.$4t()},Q4t:function(){var n=this.O4t;return(0,w.Ec)(n.Ky,n.iw,n.Sx,n.Tx)},U4t:function(){var n=this,t=n.Q9(),r=n.K9();n.tSt=t,n.nSt=r},H4t:function(){var n,t,r,e,i,o,u,a,f,n=this,t=n.R4t,r=n.B4t,e=n.tSt,i=n.nSt,o,u,a,f;return(n.O4t.jO?t+1:t)<=e&&r<=i},V4t:function(){var n,t,r,n,e,n,i,r,t,o,n=this,r=n.fk,n=n.P4t,e=n.x+n.width,n=n.y+n.height,i=r.x,r=r.y,t=f(n-r),o,t=f(e-i)<=t?r<n?2:3:i<e?0:1;return t},Y4t:function(){var n,t,r,e,i,o,u,a,n=this,t=n.R4t,r=n.B4t,e=n.tSt,i=n.nSt,o=n.z4t,u=n.L4t,a=n.F4t;switch(o){case 0:case 1:a=f(i-r)+1;break;case 2:case 3:u=f(e-t)+1}n.K4t?(n.K4t.rowCount=u,n.K4t.colCount=a):n.K4t=(0,w.Ec)(t,r,u,a)},Z4t:function(){var n=this,t;n.Mf.Dn.q4t(),n.G4t=n.eSt()},eSt:function(){var n,t,r,e,i,t,n,t=this.K4t,r=t.row,e=t.col,i=t.rowCount,t=t.colCount;return(0,w.Ec)(r,e,i,t)},ykr:function(){var n=this,t=n.O4t,r;return 2===n.z4t&&t.oL?1:0},X4t:function(){var n=this;n.K4t.rowCount+=n.ykr()},J4t:function(){var n,t,r,e,i,o,u,a,f,l,u,c,s,v,h,d,b,n=this,t=n.Mf,r=!1,e=t.Ut,i=t.tables,o=n.O4t,u=n.K4t,a=u.row,f=u.col,l=u.rowCount,u=u.colCount,c=n.tSt,s=n.nSt,v=p(t,o),h=C(t,o),d=n.z4t,b=o.IB;return g(v)||g(h)||(0,m.hasRowFilter)(t,new w.Range(a,f,l,u))||(e.eE(a,f,l,u)||e.GT(a,f,l,u)?t.jT(6,y().Exp_TableResizeToSpan):b&&b.isFiltered()?2===d?t.jT(6,y().Exp_TableResizeWithHidden):3===d&&o.oL?t.jT(6,y().Exp_TableResizeWithFilter):r=!0:2===d&&n.iSt(v,c)||0===d&&n.rSt(h,s)?t.jT(6,y().Exp_TableResizeWithHidden):1===d&&(i.Pl(a,h+1,l,s-h)||i.oSt(a,h+1,l,s-h))||3===d&&(i.Pl(v+1,f,c-v,u)||i.oSt(v+1,f,c-v,u))?t.jT(6,y().Exp_TableResizeToTable):r=!0),r},iSt:function(n,t){for(var r,e=this.Mf,i,o=!1,i=n;t<i;i--)if(e.getRowHeight(i)<=0){o=!0;break}return o},rSt:function(n,t){var r,e=this.Mf,i,o=!1;if(!o)for(i=n;t<i;i--)if(e.getColumnWidth(i)<=0){o=!0;break}return o},$4t:function(){var n=this;n.$k=!1,n.rb=!1,n.Rk=h,n.K4t=h,n.W4t=h}})},"./dist/plugins/table/table-render.js":function(n,t,r){var s,e,t;function i(n,t,r,e){var i,i,o,u,a,i,f,l,l,c,f,l,i=n.rt;i.K4t&&(o=(i=i.K4t).row,u=i.col,a=i.rowCount,i=i.colCount,0<(l=(f=n.Tb)-o)&&(a-=l,o=f),0<(l=n.Ab)&&(i-=c=l-u,u=l),f=new s.Range(o,u,a,i),l=n.getRangeRect(r,e,f),t.strokeStyle=n.getSelectionBorderColor(),t.strokeRect(l.x,l.y,l.width,l.height))}Object.defineProperty(t,"__esModule",{value:!0}),t="tableRender",(e=(s=r("Core")).GC$.extend)(s.g7.prototype,{q4t:function(){var n,t,n=this,t;0<n.Mf.My||n.E1()}}),s.Worksheet.ch(t,{paintAdornment:function(n){var t,n,r,t=this,n=n.ctx,r=t.rt;r&&r.Rk&&r.$k&&i(t,n,r.nD(),r.eD())}})},"./dist/plugins/table/table-theme.js":function(B,n,D){var f,w,z,m,E,U,r,V,H,G,J,P,l,c,a,s,v,h,d,b,Y,g,$,W,q,K,X,y,Z,Q,nn,tn,p,D,rn,en,on,un,an,u,C,S,T,_,R,x,fn,ln,j,O,F,k,A,t,cn,e,i,o,o,e;function sn(){for(var n,t,n={},t=1;t<=28;t++)t<=21&&(n["TABLESTYLELIGHT"+t]=!0),t<=11&&(n["TABLESTYLEDARK"+t]=!0),n["TABLESTYLEMEDIUM"+t]=!0;return n}function L(n,t,r,e,i,o,u,a,f,l,c,s,v,h){var d=this,b=arguments;w(x,function(n,t){d[t]=1<n?b[n+1]:b[n]}),m(r)&&(d.font=r)}function vn(e,i){e.name(i.name()),w(p,function(n,t){e[t](i[t]())}),w(y,function(n,t){var r=i[t]();e[t](r?r.Gf():c)}),e.builtInName(i.builtInName(),!1)}function hn(){}function I(n,t){return isNaN(t)?t:new f.LineBorder(n,t)}function M(n,t,r,e,i,o,u,a,f,l){var c=new j;return t&&(c.backColor=t),r&&(c.foreColor=r),e&&(c._fontWeight=en,c._fontSize=on,c._fontFamily=un,c._font=rn),i&&(c.borderLeft=I(n,i)),o&&(c.borderTop=I(n,o)),u&&(c.borderRight=I(n,u)),a&&(c.borderBottom=I(n,a)),f&&(c.borderHorizontal=I(n,f)),l&&(c.borderVertical=I(n,l)),c}function N(n){return 0===n?"Text 1":"Accent "+n}function dn(n){var n,t,r,n=N(n),t=n+" 80",r=new O;return r[a](M(n,0,n,1,0,0,0,1)),r[v](M(n,0,n,0,0,1,0,1)),r[b](M(n,t)),r[d](M(n,0,n,1)),r[h](M(n,0,n,1)),r[g](M(n,t)),r[s](M(n,0,n,1,0,1)),r}function bn(n){var n,t,n=N(n),t=new O;return t[a](M(n,n,F,1)),t[v](M(n,0,0,0,1,1,1,1)),t[b](M(n,0,0,0,0,1)),t[Y](M(n,0,0,0,0,1)),t[g](M(n,0,0,0,1)),t[$](M(n,0,0,0,1)),t[d](M(n,0,0,1)),t[h](M(n,0,0,1)),t[s](M(n,0,0,1,0,6)),t}function wn(n){var n,t,r,n=N(n),t=n+" 80",r=new O;return r[a](M(n,0,0,1,0,0,0,2)),r[v](M(n,0,0,0,1,1,1,1,1,1)),r[b](M(n,t)),r[g](M(n,t)),r[d](M(n,0,0,1)),r[h](M(n,0,0,1)),r[s](M(n,0,0,1,0,6)),r}function mn(n){var n,t,r,n,e,n=N(n),t=n+" 20",r=n,n=n+" 80",e=new O;return e[a](M(t,r,F,1)),e[v](M(t,0,0,0,1,1,1,1,1)),e[b](M(t,n)),e[g](M(t,n)),e[d](M(t,0,0,1)),e[h](M(t,0,0,1)),e[s](M(t,0,k,1,0,6)),e}function gn(n){var n,t,r,e,n,i,n=N(n),t=F,r=n,e=n+" 60",n=n+" 80",i=new O;return i[a](M(t,r,F,1,0,0,0,2,0,1)),i[v](M(t,n,0,0,0,0,0,0,1,1)),i[b](M(t,e)),i[g](M(t,e)),i[d](M(t,r,F,1)),i[h](M(t,r,F,1)),i[s](M(t,r,F,1,0,2,0,0,0,1)),i}function yn(n){var t,r,e,i,r,o,t,r="#D3D3D3",e=N(n),i=r,r=0===n?k:r,o=new O;return o[a](M(k,e,F,1,0,2,0,2)),o[v](M(r,0,0,0,1,new f.LineBorder(k,2),1,new f.LineBorder(k,2),0===n?1:0,1)),o[b](M(r,i)),o[g](M(r,i)),o[d](M(r,e,F)),o[h](M(r,e,F)),o[K](M(r,e,F,1)),o[X](M(r,e,F,1)),o[s](M(k,0,k,0,0,6)),o}function pn(n){var n,t,r,e,i,n,o,n=N(n),t=n,r=n+" 40",e=n+" 80",i=n+" 60",n=n+" 80",o=new O;return o[a](M(r,e,k,1,1,1,1,1,0,1)),o[v](M(r,e,0,0,1,1,1,1,1,1)),o[b](M(r,i)),o[g](M(r,i)),o[d](M(r,0,0,1)),o[h](M(r,0,0,1)),o[s](M(r,n,k,1,1,new f.LineBorder(t,2),1,1,0,1)),o}function Cn(n){var t,r,e,i,n,o,t=N(n),r=k,e=0===n?t+" 25":t+" -25",i=0===n?t+" 50":t,n=0===n?t:t+" -50",o=new O;return o[a](M(F,r,F,1,0,0,0,2)),o[v](M(t,i,F)),o[b](M(t,e)),o[g](M(t,e)),o[d](M(F,e,F,1,0,0,2)),o[h](M(F,e,F,1,2)),o[s](M(F,n,F,1,0,2)),o}function Sn(n){var t,r,e,n,i,o;function u(n,t){var r;return n<0||3<n?"":{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[t][n]}return t=N(n),r=u(n,"headerColor"),e=u(n,"stripColor"),i=n=u(n,"tableBackground"),(o=new O)[a](M(t,r,F)),o[v](M(t,n)),o[b](M(t,e)),o[g](M(t,e)),o[d](M(t,0,0,1)),o[h](M(t,0,0,1)),o[s](M(k,i,0,1,0,6)),o}function Tn(){}for(Object.defineProperty(n,"__esModule",{value:!0}),n.TableThemes=n.TableTheme=n.TableStyle=void 0,f=D("Core"),w=f.GC$.each,z=f.GC$.isEmptyObject,m=f.mt.T1,E=JSON.stringify,U=JSON.parse,r=f.mt.p0,V=f.mt.go,H=f.mt.vo,G=f.mt.n1,J=f.NodeHelper.sr,P=Math.floor,l=void 0,c=null,y=[a="headerRowStyle",s="footerRowStyle",v="wholeTableStyle",h="highlightLastColumnStyle",d="highlightFirstColumnStyle",b="firstRowStripStyle",Y="secondRowStripStyle",g="firstColumnStripStyle",$="secondColumnStripStyle",W="firstHeaderCellStyle",q="lastHeaderCellStyle",K="firstFooterCellStyle",X="lastFooterCellStyle"],p=[Z="firstRowStripSize",Q="secondRowStripSize",nn="firstColumnStripSize",tn="secondColumnStripSize"],D="name",rn="bold 14.667px calibri",en="bold",on="14.667px",un="calibri",an={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},x=["backColor","foreColor",u="borderLeft",C="borderTop",S="borderRight",T="borderBottom",_="borderHorizontal",R="borderVertical","textDecoration","fontStyle","fontWeight","fontSize","fontFamily","_fontVariant","_fontStretch","_lineHeight"],fn=f.W.F2e,ln=sn(),Object.defineProperty(L.prototype,"font",{get:function(){return this._font},set:function(n){f.W.oce(this,n)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontSize",{get:function(){return this._fontSize},set:function(n){f.W.W2e(this,n)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(n){var t=this;t._fontStyle=n,t._font=fn(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(n){var t=this;t._fontWeight=n,t._font=fn(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(n){var t=this;t._fontFamily=n,t._font=fn(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight)},enumerable:!1,configurable:!0}),L.prototype.h5=function(r,n,t,e,i){var o=this;t&&m(o[u])&&!m(r[u])&&(r[u]=o[u],r[u].level=20),n&&m(o[C])&&!m(r[C])&&(r[C]=o[C],r[C].level=20),i&&m(o[S])&&!m(r[S])&&(r[S]=o[S],r[S].level=20),e&&m(o[T])&&!m(r[T])&&(r[T]=o[T],r[T].level=20),n||!m(o[_])||m(r[C])||(r[C]=o[_],r[C].level=20),e||!m(o[_])||m(r[T])||(r[T]=o[_],r[T].level=20),t||!m(o[R])||m(r[u])||(r[u]=o[R],r[u].level=20),i||!m(o[R])||m(r[S])||(r[S]=o[R],r[S].level=20),w(x,function(n,t){0<=t.indexOf("border")||m(o[t])&&!m(r[t])&&(r[t]=o[t])})},L.prototype.Gf=function(){var n,t,n=new L,t=E(this.toJSON());return n.fromJSON(U(t)),n},L.prototype.toJSON=function(){var e,i,e=this,i={};return w(x,function(n,t){var r,r,r=e[t],r=r&&r.toJSON?r.toJSON():r;i[t]=r!==c&&z(r)?l:r}),i.font=e.font,i},L.prototype.fromJSON=function(i,o){var u;i&&(u=this,w(x,function(n,t){var r,e,r=i[t];m(r)&&(0<=t.indexOf("border")?((e=new f.LineBorder).fromJSON(r,o),u[t]=e):u[t]=r)}),i.font)&&(u.font=i.font)},j=L,n.TableStyle=j,f.GC$.extend(f.StyleManager.prototype,{addTableTheme:function(n){var t=this,r,r;(r=(r=t.aSt)||(t.aSt={}))[n.name()]=n},getTableTheme:function(n){var t,r,e,i,t=this,r=t.aSt;return r=r||(t.aSt={}),ln[n.toUpperCase()]?r[e=n.substr(10).toLowerCase()]?r[e]:(vn(i=new O,A[e]),t.addTableTheme(i),i):r[n]}}),hn.prototype.toJSON=function(){var r,e,i,r=this,e={name:r.name()};return w(y,function(n,t){(i=r[t]())&&(e[t]=i.toJSON())}),w(p,function(n,t){1!==(i=r[t]())&&(e[t]=i)}),z(e)?l:e},hn.prototype.fromJSON=function(i,o){var u,n,n,n;i&&(u=this,(n=i.buildInName)?vn(u,A[n.toLowerCase()]):(n=i.name,n=m(n)?n:i.Zc,m(n)&&u.name(n,!1),w(p,function(n,t){var r=i[t]!==l?i[t]:i["_"+t];r?u[t](r,!1):u[t](void 0)}),w(y,function(n,t){var r,e,r=i[t]!==l?i[t]:i["_"+t];r?((e=new j).fromJSON(r,o),u[t](e,!1)):u[t](void 0)})))},hn.prototype.yh=function(n,u){var a,t,r,e,i,o,a=this;for(a.name(G(n.name)),r=function(n){var t,r,e,i,o,t=J(n.dxfId,0),r=n.type,e=J(n.size,1),i=new j,o=an[r||"wholeTable"];"function"==typeof a[o]&&void 0!==n.dxfId&&(u.getDxf(t,i,!0),w(x,function(n,t){0<=t.indexOf("border")&&i[t]===c&&(i[t]=new f.LineBorder)}),a[o](i,!1)),"firstRowStripe"!==r&&"secondRowStripe"!==r&&"firstColumnStripe"!==r&&"secondColumnStripe"!==r||a[r.substr(0,r.length-1)+"Size"](e,!1)},e=0,i=t=V(n,"tableStyleElement");e<i.length;e++)r(o=i[e]);u.addTableTheme(a)},hn.prototype.wh=function(e){var i,o,n,t,u,a,i=this,o=[],n={n_:"tableStyle",c_:o},t=i.builtInName();return t!==c&&t!==l?n.name="TableStyle"+t:(n.name=H(i.name()),u=0,w(y,function(n,t){var r;(a=i[t]())&&(r=e.getDxfIndex(a))!==l&&(u++,o.push({n_:"tableStyleElement",type:f.SJSStylePropsToStyleProps[t],dxfId:r}))}),w(p,function(n,t){(a=i[t]())&&(u++,o.push({n_:"tableStyleElement",type:t.replace("Size","e"),size:a}))}),n.count=u,n.pivot="0"),n},O=hn,(n.TableTheme=O).prototype.name=r(D),O.prototype.builtInName=r("builtInName"),w(y,function(n,t){O.prototype[t]=r(t)}),w(p,function(n,t){O.prototype[t]=r(t,1)}),F="white",k="black",A=Tn,n.TableThemes=A,t=1;t<=28;t++)e=P((cn=t-1)/7),t<=21&&0<=e&&e<3&&(o="Light"+t,(i=[dn,bn,wn][e](cn%7)).name&&i.name(o),i.builtInName&&i.builtInName(o),A["light"+t]=i),t<=11&&0<=e&&e<2&&((i=[Cn,Sn][e](cn%7)).name(o="Dark"+t),i.builtInName(o),A["dark"+t]=i),0<=e&&e<4&&((i=[mn,gn,yn,pn][e](cn%7)).name(e="Medium"+t),i.builtInName(e),A["medium"+t]=i);f.GC$.extend(f.Workbook.prototype,{defaultTableTheme:function(n){var t,n,r,n,t=this;return 0<arguments.length?(n=n&&n.toLowerCase(),t.Bur=n,(r=t.customTableThemes.get(n))||A[n]||void 0):(n=t.Bur)?A[n]||t.customTableThemes.get(n):void 0}})},"./dist/plugins/table/table-util.js":function(B,n,t){var s,o,u,r,e,m,a,g,v,c,h,i,t,d;function b(n){throw new Error(n)}function f(n,t,r,e,i,o){u&&(!e&&i&&(e=F(n,i,t,r)),n.zI(t,r,e,i,v,v,v,v,v,v,o))}function l(n,t,r,e){n.setValue(t,r,e)}function w(n){n.suspendPaint()}function y(n){n.resumePaint()}function p(n){return n.op().Hyt()}function C(n){u&&n.suspendCalcService()}function S(n,t){u&&n.resumeCalcService(t)}function T(n){n&&(w(n),n.suspendEvent(),C(n))}function _(n){n&&(S(n),n.resumeEvent(),y(n))}function R(n){return n.rowCount}function x(n){return n.colCount}function j(n){return n&&!(/\d/.test(n[0])||/[\s\+\-\*\\:%!\[\]]/.test(n)||-1!==["C","c","R","r"].indexOf(n)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(n)||/^[Rr]\d*[Cc]\d*$/.test(n)||255<=n.length)}function O(n,t,r,e,i,o,u){var a,i;return t?((a=n.Uw())._wt=i,a.lsr=u,i=n.Lp.parse(a,t,r,e,!1,o,!1,n.options.keepUnknownFormulas),delete a._wt,delete a.lsr,i):g}function F(n,t,r,e,i){return i=i===v||i,n.Lp.unparse(n.Uw(),t,r,e,!1,i)}function k(n,t,r,e){var i=n.Uw();return n.Lp.evaluateParsedFormula(i,e,{row:t,col:r},!1,!0)}function A(n){var t,r,e,r;return!(!n||(j(n)||b(d().Exp_TableNameInvalid),r=(t=this).name(),e=t.jS,n===r)||e&&(r=e.findByName(n))&&t!==r)}function D(n,t,r,e,i){for(var o,u,a,f,o=r;t<=o;o--)for(a=e;a<=i;a++){if(I(u=n.Z_(o,a)))return o;if(L(n,o,a))return o;if(f=n.Ut.findSpan(o,a))return f.row+f.rowCount-1}return-1}function z(n,t,r,e,i){for(var o,u,a,f,u=i;e<=u;u--)for(o=t;o<=r;o++){if(I(a=n.Z_(o,u)))return u;if(L(n,o,u))return u;if(f=n.Ut.findSpan(o,u))return f.col+f.colCount-1}return-1}function L(n,t,r){var e=n.getValue(t,r),i,o;return e!==g&&a(e)||(i=n.getSparkline&&n.getSparkline(t,r))||I(o=n.Z_(t,r))}function I(n){return!(!n||!(n.backColor||n.backgroundImage||n.borderBottom||n.borderLeft||n.borderRight||n.borderTop||n.cellType||n.diagonalDown||n.diagonalUp))}function E(n,t,r,e,i,o,u,a){return i<=n&&!(t===u&&t+e-1===a)&&(t<u&&u<t+e||u<=t&&t<=a&&a<t+e-1)}function U(n,t,r,e,i,o,u,a){return u<=t&&!(n===i&&n+r-1===o)&&(n<i&&i<n+r||i<=n&&n<=o&&o<n+r-1)}function V(n,t,r){return{col:t,leadingCellRow:r,row:n}}function H(n,t,r){var e,i,o,e=g,i=t.Ky,o=t.endRow();for(r&&(o-=t.oL?1:0);i<=o&&n.getRowHeight(o)<=0;)o--;return e=i<=o?o:e}function G(n,t){for(var r,e,i,r=g,e=t.iw,i=t.endColumn();e<=i&&n.getColumnWidth(i)<=0;)i--;return r=e<=i?i:r}function J(n){for(var t,r,e,t,i,o,u,a,f,l,t=n.Ut,r=t.W_(3).dataTable,e=t.getLastNonNullRow(3,!0),t=n.getRowCount(),i=n.getColumnCount(),o=-1,f=t-1;-1<f;f--)if(u=r[f])for(l=0;l<i;l++)if((a=u[l])&&!h(a.value))return c(f,e);return c(-1,e)}function P(n,t){var r,e,i,o,u,t,a,f,l,f,o,r=t.jS,e,i,o=t.Ky+t.Sx-1,u=t.iw,t=u+t.Tx-1,a=J(n),f=r?r.uSt():-1;return(l=o)<(a=c(a,f))&&(o=new s.Range(f=1+o,u,a-o,t-u+1),l=c(D(n,f,a,u,t),r.uSt(o))),l}function Y(n){for(var t,r,e,i,o,u,a,a,f,l,t=n.Ut,r=t.W_(3).dataTable,e=t.getLastNonNullCol(3,!0),i=n.getRowCount(),o,u=-1,f=n.getColumnCount()-1;-1<f;f--)for(l=0;l<i;l++)if((a=(a=r[l])&&a[f])&&!h(a.value))return c(f,e);return c(-1,e)}function $(n,t){var r,e,i,o,u,t,a,f,l,f,t,r=t.jS,e=t.Ky,i=e+t.Sx-1,o,u,t=t.iw+t.Tx-1,a=Y(n),f=r?r.sSt():-1;return(l=t)<(a=c(a,f))&&(t=new s.Range(e,f=1+t,i-e+1,a-t),l=c(z(n,e,i,f,a),r.sSt(t))),l}function W(n,t,i,o,u,a,r,e,f,l){var c,s,n,t,v,e,c=n.getRowCount()-1,s=n.getColumnCount()-1,n=n.Ut.getSpans(),t=t.jS&&t.jS.U3.QP();return!e&&(!f&&c-o<r||f&&s-a<r)?(l||b(d().Exp_TableAddRowNoEnoughRoom),!0):(v=f?U:E,(e=n.some(function(n){var t=n.row,r=n.col,e=n.rowCount,n=n.colCount;return v(t,r,e,n,i,o,u,a)}))?l||b(d().Exp_TableAddRowIntersectSpan):t&&(e=t.some(function(n){var t=n.Ky,r=n.iw,e=n.Sx,n=n.Tx;return v(t,r,e,n,i,o,u,a)}))&&!l&&b(d().Exp_TableAddRowIntersectTable),e)}function q(n,t,r){for(var e,i,o,u,a,f,l,c,e=t.row,i=t.col,o=e+t.rowCount,u=i+t.colCount,a=e;a<o;a++)for(f=i;f<u;f++)if(c=(l=n.getCell(a,f)).value(),(!h(c)&&""!==c||n.Ut.findSpan(a,f))&&(!r||!r.equals(new s.Range(l.row,l.col,1,1))))return new s.Range(a,f,1,1);return v}function M(n,t,r,e,i,o,u){for(var a,f,l,a=t;a<=r;a++)for(f=e;f<=i;f++)if(l=n.l0(a,f,"locked"),o&&!l||u&&l)return;return 1}function K(n,t,r,e,i,o,u){var a,f,l,c,s,v,h,d,b,w;if(i){if(!o&&!u)return g;if(a=n.Mf,l=f=0,n.oL&&(f=1),n.jO&&(l=1),t===m.TableSelectionType.TABLE_ROW_SELECT){if(!M(a,r,r,n.iw,n.endColumn(),o,u))return g}else if(t===m.TableSelectionType.TABLE_COL_SELECT){for(s=!0,v=0,h=c=a.getSelections();v<h.length;v++)if((d=h[v]).col===e&&d.row===n.Ky+l&&1===d.colCount&&d.rowCount===n.Sx-l-f){if(!M(a,n.Ky,n.endRow(),e,e,o,u))return g;s=!1}if(s&&!M(a,n.Ky+l,n.endRow()-f,e,e,o,u))return g}else if(t===m.TableSelectionType.TABLE_CORNER_SELECT){for(s=!0,b=0,w=c=a.getSelections();b<w.length;b++)if((d=w[b]).col===n.iw&&d.row===n.Ky+l&&d.colCount===n.Tx&&d.rowCount===n.Sx-l-f){if(!M(a,n.Ky,n.endRow(),n.iw,n.endColumn(),o,u))return g;s=!1}if(s&&!M(a,n.Ky+l,n.endRow()-f,n.iw,n.endColumn(),o,u))return g}else if(t===m.TableSelectionType.TABLE_SELECT&&!M(a,n.Ky,n.endRow(),n.iw,n.endColumn(),o,u))return g}return{action:t,table:n}}function N(n,t){var r=n.Ky;return t-(n.jO?r+1:r)}function X(n,t){var r;return t-n.iw}function Z(n){var t=i;return n&&i++,t}function Q(n){return"string"==typeof n}function nn(n,t,r,e){var t={sheet:n,table:t,oldRange:r,newRange:e,cancel:!1};return n.ki(s.Events.TableResizing,t),t.cancel}function tn(n,t,r,e,i){var o;n.ki(s.Events.TableResized,{sheet:n,table:t,oldRange:r,newRange:e},i)}function rn(n,t,r,e,i,o,u){var r={sheet:n,table:t,propertyName:r,row:N(t,e),count:i};h(o)||(r.isAfter=o),u&&(r.deletedItem=u),n.ki(s.Events.TableRowsChanged,r)}function en(n,t,r,e,i,o){var r={sheet:n,table:t,propertyName:r,col:e-t.iw,count:i};h(o)||(r.isAfter=o),n.ki(s.Events.TableColumnsChanged,r)}function on(n,t,r){var e=0;if(n.cSt(t,r))for(e=2;n.cSt(t+e,e);)e++;return 0<e&&(t+=e),t}function un(n){return n&&"="===n[0]}function an(n){var t,r,e,i,t=-1;if(n)for(r=n.arguments,e=void 0,i=0;i<r.length;i++)if((e=r[i])instanceof o.obt){t=i;break}return t}function fn(n,t,r){var n,e,n,i,n=n.dataRange(),e=n.row,n=n.col,i;return(r?e:n)+t}function ln(n){var t=n;return t=n&&"="===n[0]?n.slice(1):t}function cn(n,t){for(var r,e,e=0;e<n.length;e++)if((r=n[e])&&t===r.col)return r;return g}function sn(n,t){var r,e,i;if(t)for(r=t.row;r<t.row+t.rowCount;r++)for(e=t.col;e<t.col+t.colCount;e++)if(n.tables&&(i=n.tables.find(r,e)))return i;return null}function vn(n,t){return t?n.tables.AB(t.row,t.col,t.rowCount,t.colCount):null}function hn(n){return h(n)||("string"!=typeof n&&(n+=""),n=n.replace(/\r\n?/g,"\n")),n}function dn(n){return n===v}Object.defineProperty(n,"__esModule",{value:!0}),n.Util=void 0,s=t("Core"),o=t("SheetsCalc"),u=t("CalcEngine"),r=t("Common"),e=t("./dist/plugins/table/table.ns.js"),m=t("./dist/plugins/table/table.js"),a=s.mt.T1,g=null,v=void 0,c=Math.max,h=r.Common.lt.ht,i=0,t=new r.Common.ResourceManager(e.SR,"Tables"),d=t.getResource.bind(t),n.Util={throwError:b,setFormulaToSheet:f,setValue:l,suspendPaint:w,resumePaint:y,Hyt:p,suspendCalcService:C,resumeCalcService:S,fSt:T,lSt:_,getRowCount:R,getColCount:x,isValidTableName:j,formulaToExpression:O,expressionToFormula:F,evaluateExpression:k,checkTableName:A,hSt:V,_4t:H,E4t:G,dSt:P,vSt:$,mSt:W,gSt:q,pSt:K,bSt:N,ySt:X,T4t:Z,wSt:Q,j4t:nn,S4t:tn,jj:rn,Ej:en,MSt:on,kf:un,CSt:an,SSt:fn,TSt:ln,ASt:cn,_getTable:sn,ISt:vn,xSt:hn,NSt:dn}},"./dist/plugins/table/table.entry.js":function(n,t,r){var e,i,e=this&&this.__createBinding||(Object.create?function(n,t,r,e){void 0===e&&(e=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(n,e,i)}:function(n,t,r,e){n[e=void 0===e?r:e]=t[r]}),i=this&&this.__exportStar||function(n,t){for(var r in n)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||e(t,n,r)};Object.defineProperty(t,"__esModule",{value:!0}),r("./dist/plugins/table/table.interface.js"),r("./dist/plugins/table/table-event.js"),r("./dist/plugins/table/table-render.js"),r("./dist/plugins/table/table-action.js"),r("./dist/plugins/table/table-util.js"),i(r("./dist/plugins/table/table-theme.js"),t),i(r("./dist/plugins/table/table.js"),t),i(r("./dist/plugins/table/table.ns.js"),t),i(r("./dist/plugins/table/customTableThemeManager.js"),t),r("./dist/plugins/table/data-manager-providers/data-manager-provider.entry.js")},"./dist/plugins/table/table.interface.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(l,j,n){var c,h,d,L,b,w,g,m,O,t,p,r,y,x,v,P,Y,e,F,$,C,W,I,q,K,X,Z,M,Q,nn,tn,rn,en,on,un,an,fn,ln,cn,sn,vn,hn,dn,bn,wn,mn,N,S,gn,T,_,yn,pn,Cn,B,D,n,Sn,Tn,z,_n,Rn,xn,jn,On,Fn,kn,k,An,Ln,In,Mn,Nn,Bn,Dn,zn,En,Un,Vn,Hn,Gn,Jn,Pn,Yn,$n,Wn,qn,Kn,A,E,U,Xn,Zn,Qn,nt,tt,rt,et,it,ot,ut,at,ft,r,lt,ct,st,vt,ht,dt,bt,wt,mt,gt,yt,pt,Ct,St,Tt,_t,Rt,xt,jt,Ot,Ft,kt,i,At,Lt,It,Mt,Nt,Bt,Dt,zt,Et,Ut,Vt,Ht,Gt,Jt,Pt,Yt,$t,Wt,qt,Kt,Xt,Zt,Qt,nr,tr,rr,er,V,ir,or,ur,ar,fr,lr,cr,sr,vr,hr,dr,br,wr,mr,gr,yr,pr,Cr,t,H,Sr,Tr,_r,Rr,xr,jr,G,Or,Fr,t,kr,J,Ar,Lr,Ir,t,t,f,n;function R(n){return typeof n===ht}function Mr(n,t){return n&&t&&n.color===t.color&&n.type===t.type||!n&&!t}function Nr(n,t){var r,e,i,r=!1;if(I(n[t]))r=!0;else for(i=n.length-1;t<i;i--)if(I(n[e=i-1])){r=!0;break}return r}function Br(n,t){return fn(cn(n,t))}function Dr(n){return an(sn(n))}function zr(o,r,u){var n=o.parent,a=yn(o);function e(n,i){C(n,function(n,t){var r,e,r=t.getExpression(),e=b.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(r,i,-1,-1,u);e!==r&&(t.SB(e),a.invalidName(o.Uw(),t.getName()))})}n?(e(n.getCustomNames(),r),C(n.sheets,function(n,t){e(t.getCustomNames(),r)})):e(o.getCustomNames(),r),a.onAfterRemoveTable(r,u)}function Er(n,t,r){var r,e,t,i,r={position:r,imageType:L.ButtonImageType.dropdown,visibility:L.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},e,t={items:[{text:H().Table_None,value:null},{text:H().Table_Average,value:"=SUBTOTAL(101,[".concat(t,"])")},{text:H().Table_Count,value:"=SUBTOTAL(103,[".concat(t,"])")},{text:H().Table_Count_Numbers,value:"=SUBTOTAL(102,[".concat(t,"])")},{text:H().Table_Max,value:"=SUBTOTAL(104,[".concat(t,"])")},{text:H().Table_Min,value:"=SUBTOTAL(105,[".concat(t,"])")},{text:H().Table_Sum,value:"=SUBTOTAL(109,[".concat(t,"])")},{text:H().Table_StdDev,value:"=SUBTOTAL(107,[".concat(t,"])")},{text:H().Table_Var,value:"=SUBTOTAL(110,[".concat(t,"])")}]},i=new L.Style;return i.cellButtons=[r],i.dropDowns=[{type:L.DropDownType.list,option:t,submitCommand:"tableTotalRowFormula"}],i}function Ur(n){var t;n.tables.all().forEach(function(n){n.formulaFromJSON()})}function Vr(n,t,r,e,i,o,u,a,f){var n,t;n&&0<n.length&&(n=n[t])&&(t=n[i]())&&("string"==typeof t&&r&&(t=r.u8(t)),r&&(0,L.composeParentStyle)(t,t,r,!1,10,!0),le(t,e,o,u,a,f))}function Hr(n){var n,t,t,r,n,n=n.c_[0],t=n&&n.c_&&n.c_[0];if(t)return t={kSt:{altText:t.altText,altTextSummary:t.altTextSummary}},r=n["xmlns:x14"],(n={kSt:{uri:n.uri}})["x14:table"]=t,n.kSt["xmlns:x14"]=r,{ext:n,attr:{}}}function Gr(n){if(n&&n.c_)return Hr(n)}function Jr(n,t){var r,e;for(r in _r)!_r.hasOwnProperty(r)||I(n[r])||(0===(e=_r[r])?n[r]===t[r]&&(n[r]=E):1===e?Mr(n[r],t[r])&&(n[r]=E):2===e&&L.util.rfe(n[r],t[r])&&(n[r]=E))}function Pr(n,t,r,e,i,o,u){var t,r,a,n;n.Ut&&(r=(t=n.Ut.sheetModels[3].J_(t,r))&&t.style)&&o&&"string"==typeof r&&(i[r]?t.style=i[r]:(a=o.i3(r))&&((a=ce(n,a,!1,10,!0)).parentName=E,Jr(a,e),n=u.Xd+u.$d+r,u.$d++,a.name=n,o.$p(a),t.style=n,i[r]=n))}function Yr(n,t,r){if(n&&t){if("string"==typeof n){if(!r)return n;n=r.u8(n)}n&&((n=ce(r,n,!1,10,!0)).parentName=E,Jr(n,t))}return n}function $r(n,t,r,e){var i=n[t]&&n[t][r];n[t]||(n[t]={}),(i=n[t][r]?i:n[t][r]={}).s=e}function Wr(n,t){if(!t.formatter){if(t._autoFormatter)return void(t.formatter=t._autoFormatter.formatCached);n<1?t.formatter="h:mm:ss":1<n&&(t.formatter="M/d/yyyy")}}function qr(n,t,r,e){var i,o,i=new L.Style,o=!1;return o=n.IL(t,r,3,i,!1),o=n.xL(t,r,3,i,o,e),o=n.kL(t,3,i,o),o=n.DL(r,3,i,o),n._L(3,i,o),i}function Kr(n,t,r,e,i,o,u,a,f){var f,l,c,s,a,f,f=qr(n,r,e,f);if(t[r]&&t[r][e]&&t[r][e].o!==E&&Wr(t[r][e].o,f),(l=u.lv(f))!==a)if(o[l])$r(t,r,e,o[l]);else{for(s in c=f.clone(),L.util.isThemeColor(c.foreColor)&&L.util.isSameThemeColor(c.foreColor,i.foreColor)&&(c.foreColor=n.currentTheme().getColor(c.foreColor)),_r)_r.hasOwnProperty(s)&&c[s]===E&&(c[s]=i[s]);a=u.Xd+u.$d+c._id,u.$d++,c.name=a,$r(t,r,e,f=u.getStyleIndex(c)),o[l]=f}}function Xr(n,t,r,e,i,o){t&&(t.table(n),(r=r||{lossless:{}})&&(r.lossless||(r.lossless={}),!1===n.showHeader()&&(r.lossless.showTableHeader=!1),r.ref||(r.lossless.showFilterButton=!1),r.lossless.range={row:n.Ky+1,col:n.iw,rowCount:n.Sx-1-(n.showFooter()?1:0),colCount:n.Tx},t.yh(r,e,i)),n.IB!==t&&(n.IB=t),o?n.IB.reFilter():(n.DSt=!0,n._St(),n.NTr()||n.IB.Mke()))}function Zr(n,t){var r,e,r="CustomTableStyle_".concat(t);if(n)for(e=2;n.customTableThemes.get(r);)r="".concat(r," ").concat(2);return r}function Qr(n,t){var r=n;return typeof t[n]===lr?(t[n]++,r+="_".concat(t[r])):t[n]=0,r}function ne(n,t,r){var t,e;t[r]&&(R(t=t[r])?n[r](t):((e=new L.Style).fromJSON(t,!1,void 0),n[r](e)))}function te(n,t,r,e,i,o){var u,a,f,l,c,s,v,h,d,b,w,m,g,a,u=r.id(),a=r.name(),f=r.dataField(),l=r.value(),c=r.footerValue(),s=r.dataAreaFormula(),v=r.footerFormula(),h=r.x5t,d=r.cellType(),b=r.formatter(),w=r.dataStyle(),m=r.headerStyle(),g=r.footerStyle(),a=Un(t,a,i);e.UKn(r.jKe()),e.id(u),e.name(a),e.dataField(f),e.footerValue(c),e.dataAreaFormula(s),e.footerFormula(v),e.x5t=h,o&&"string"==typeof s&&t.NTr()&&(e.x5t(s),e.dataAreaFormula(z(n,s,t.WTr(),t.startColumn()+i))),e.value(l),e.headerStyle(m),e.footerStyle(g),(F(d)||F(b))&&(w?R(w)&&n&&(w=n.u8(w)):w=new L.Style,d!==E&&(w.cellType=d),b!==E)&&(w.formatter=b),e.dataStyle(w)}function re(n){return n&&"string"!=typeof n&&n.clone?n.clone():n}function ee(n,t,r,e){var i,i,e;n&&(i=n.getStyle(t,r))&&e&&(i=ce(n,i),(e=ce(n,e)).borderTop=i.borderTop!==E?e.borderTop:E,e.borderBottom=i.borderBottom!==E?e.borderBottom:E,e.borderLeft=i.borderLeft!==E?e.borderLeft:E,e.borderRight=i.borderRight!==E?e.borderRight:E,e.compose(i),n.setStyle(t,r,e))}function ie(n,t,r,e,i,o){for(var u,a,f,l,c,s,v,a=o.layoutStyle(),f=o.headerIndex(),l=o.footerIndex(),c=o.startColumn(),s=r;s<=i;s++)for(u=o.columnLayoutStyle(s-c),v=t;v<=e;v++)v===f?(a.header&&ee(n,v,s,a.header),null!=u&&u.header&&ee(n,v,s,u.header)):v===l?(a.footer&&ee(n,v,s,a.footer),null!=u&&u.footer&&ee(n,v,s,u.footer)):(a.data&&ee(n,v,s,a.data),null!=u&&u.data&&ee(n,v,s,u.data))}function oe(n,t,r){var e;13===t.type&&(null==(e=t.baseTable)?void 0:e.name())===r&&(t.baseTable=n)}function ue(t,n,r){var n;oe(t,n,r),null!=(n=n.arguments)&&n.forEach(function(n){ue(t,n,r)})}function ae(n,t,r,e,i,o,u){n.borderLeft=t,n.borderTop=r,n.borderRight=e,n.borderBottom=i,n.borderHorizontal=o,n.borderVertical=u}function fe(n,t,r){n[t]===E&&r!==E&&(n[t]=r)&&"object"==typeof r&&(n[t].level=20)}function le(n,t,r,e,i,o){var u=n[dr],a=n[wr],f=n[br],l=n[mr],c=n[gr],s=n[yr];ae(n),t.h5(n),e&&fe(t,dr,u),r&&fe(t,br,f),o&&fe(t,wr,a),i&&fe(t,mr,l),fe(t,br,c),fe(t,mr,c),fe(t,dr,s),fe(t,wr,s),ae(n,u,f,a,l,c,s)}function ce(n,t,r,e,i){var o=new L.Style;return(t=t&&t.charAt?n.u8(t):t)&&(o.h5(t),(0,L.composeParentStyle)(t,o,n,r,e,i)),o}function se(n,t,r,e,i,o,u){e&&n?(R(n)&&(n=ce(o,n)),(t=R(t)?ce(o,t):t)?(t=t.clone()).compose(n):t=n,i[r+pr]=u.getDxfIndex(t,!0)):t&&(R(t)?i[r+Cr]=t:(i[r+pr]=u.getDxfIndex(t,!0),t.parentName&&(i[r+Cr]=t.parentName)))}function ve(n){return n&&n.QOt&&n.QOt.tables&&n.QOt.tables[n.name]===n}function he(n){return n===A?A:$(n)}function de(n){return he(n.dataField()||n.name())}function be(n){return(0,v.isFormula)(n)?n:"="+n}function we(n,t,r){return{value:be(t),name:de(n),dataType:"formula",zTr:!0,YEr:r}}function me(n){var n=de(n);return{value:n,name:n}}function ge(n,t){var t;return"string"==typeof n?"".concat(null==t?void 0:t.name(),"__").concat(n):"".concat(null==(t=n.Mf)?void 0:t.name(),"__").concat(n.name())}function ye(n,t){return n+"__"+(null!=t?t:Date.now())}function pe(n,t,r){return n+"."+(t?ye(t.name(),t.jKe()):r)+i}function Ce(r,n){var t,e,t,t=(0,v.isFormula)(r),e=(0,v.isRelation)(r);return r=(t||e)&&(t&&(r="__"+r.slice(1)),e&&(r=r.replace(".","__")),0<(t=n.reduce(function(n,t){return t.dataField()&&-1<t.dataField().indexOf(r)?n++:n},0)))?r+"__"+t:r}function Se(n){for(var t,r,e,i,i,t=0,r=n;t<r.length;t++)(i=(e=r[t]).dataField())!==(i=Ce(i,n))&&e.dataField(i)}function Te(n,t){var r,e,i,r=t||[],e;for(i in n.columns)n.isDataColumn(i)&&r.push(new J(t.length,i,i))}function _e(n,t){var r=n.z3(),e=r.getTable(),r=r.ife(t-n.iw);return!!e.columns[r]&&e.isDataColumn(r)}function Re(n){var t,r,e,r=(null==(t=n.options.schema)?void 0:t.columns)||{},e=n.columns||{};return function(n){return r[n]||e[n]}}function xe(n,t){return(0,v.isFormula)(n)||t&&("formula"===t.dataType||(0,v.isFormula)(t.value))}function je(n,t){var r=Re(n);return t.filter(function(n){var n=de(n);return!xe(n,r(n))})}function Oe(n,t){return I(t)?[]:(0===t.length&&Te(n,t),je(n,t).map(function(n){var t,r,e,t=n.dataAreaFormula();return I(t)?me(n):(e=r=void 0,"string"==typeof t?r=t:(r=n.x5t(),e=t),we(n,r,e))}))}function Fe(n,t,r){var r,n,r=Oe(n,r);return I(n.views[t])||(t=ye(t)),(n=n.addView(t,r)).HTr(!0),n}function ke(n){n.Efe&&n.Efe.length!==n.length()&&n.iM(!0)}function s(n,t,r,e,i,o,u){var a,f,l;for(this.hsr=this.qO,this.dsr=this.xP,(a=this).assignId(),a.jO=!u||u.showHeader===E||u.showHeader,a.oL=!(!u||u.showFooter===E)&&u.showFooter,a.ESt=!(!u||u.useFooterDropDownList===E)&&u.useFooterDropDownList,a.showResizeHandle(!(!u||u.showResizeHandle===E)&&u.showResizeHandle,E,{shouldModelCallback:!1}),a.OSt=[],a.H3=A,a.IB=A,a.jS=A,a.RSt=!1,F(n)&&a.name(n),a.Ky=F(t)?t:-1,a.iw=F(r)?r:-1,a.Sx=F(e)?e:-1,a.Tx=F(i)?i:-1,F(o)&&a.style(o),a.BSt=[],f=0;f<a.Tx;f++)(l=new J(f+1)).onChange=this.pEr.bind(this),a.BSt.push(l);a.LSt=A,a.PSt=[],a.aT=null==g?void 0:g.createMap(),a.aj=[],a.GSt=[],a.USt=[],a.HSt=[],a.zSt=[],a.VSt=!0}function Ae(n,t,r){if(T(n),r&&r(),t.N5t())try{G.et(n,"setBindingPath",{tableName:t.name()});var e=t.rowFilter();e&&e.filterHandler&&e.filterHandler({columns:t.rowFilter().Mct})}finally{_(n)}else _(n)}function Le(n,t){var n,r,n=n&&n.rowFilter&&n.rowFilter();return!I(n)&&(r=n.range).intersect(t.row,t.col,t.rowCount,t.colCount)}function Ie(i){return function(n,t){var r=this,e=r.Mf;e&&n!==t&&(i===tt&&G.et(e,"tableNameChanged",{oldName:t,newName:n}),e.Ut.YSt(r,i,t,n),e.repaint())}}function Me(e){return function(n,t){var r;n!==t&&this.bEr(e,n)}}function Ne(n,t){var r=this;r.dl(),Ie("style").call(r,n,t)}function Be(n,t,r,e,i){n.Qy().execute({cmd:Pt,sheetName:n.name(),tableName:t.name(),row:r,count:e,isAfter:i})}function De(n,t,r,e,i){n.Qy().execute({cmd:Yt,sheetName:n.name(),tableName:t.name(),row:r,count:e,isAfter:i})}function ze(n,t){n.Qy().execute({cmd:$t,sheetName:n.name(),tableName:t.name(),showFooter:!0})}function Ee(n){var t,t;if(!I(n))return t=/\[\S[\S\s]*\S\]/,"SUBTOTAL("!==(n=n.trim()).substr(0,9)||!t.test(n)||n.indexOf("[[")?"custom":(t=n.substring(9,12),Or[t]||sr)}function Ue(n){return-1<n.indexOf("LET(")}function Ve(n,t){var r=Object.keys(n).map(function(n){return+n}),e=Object.keys(t).map(function(n){return+n});return r.length>e.length?r.filter(function(n){return-1===e.indexOf(n)}):e.filter(function(n){return-1===r.indexOf(n)})}function o(n){var t,r,t=f.call(this)||this;return t.JTr=!1,t.irt=!1,t.ort=!1,(r=t).table(n),r.act=!1,t}function He(n){var t=n.dataStyle();return t||(t=new L.Style,n.dataStyle(t)),t}function u(n,t,r,e,i,o,u,a,f){this.onChange=null;var l=this;l.assignId(),l.id(n),l.dataField(t),l.name(r||t||At+l.id()),l.dataStyle(a),F(e)&&l.formatter(e),F(i)&&l.cellType(i),l.value(o),l.headerStyle(u),l.footerStyle(f)}function Ge(n,t){for(var r,e,r=t.row;r<t.row+t.rowCount;r++)for(e=t.col;e<t.col+t.colCount;e++)if(!I(n.getValue(r,e)))return;return 1}function a(n){this.Mf=n,this.U3=new L.CustomList([],this.YBe.bind(this)),this.xl=[],this.Nl=[]}function Je(n,t){var n,r;return"Object"===t.constructor.name&&(n=n.findByName(t.tableName))&&(n.H3?t=n.H3:((r=new O.$$).fromJSON(t),n.H3=t=r)),t}function Pe(n,t,r,e,i){for(var i,o,u,a,f,i=0===i,o=i?n.aj:n.GSt,u=-1,f=0;f<o.length;f++)if((a=o[f])&&a.key===e){u=f;break}-1<u&&o.splice(u,I(r)?1:r),i&&n.ZSt()}function Ye(e,i,o,n){var u,t,r,u=(0,v.useSerialExecutor)();if(i)for(t=function(n){var t,r,t=i[n],r=Je(e,t.bindingManager);o?u.appendPromiseLike(function(){return r.wtt(t)}):u.appendPromiseLike(function(){return r.Mtt(t)})},r=i.length-1;0<=r;r--)t(r);u.execute(n)}function $e(n,t){var r=new G;return r.Sg(n),r.fromJSON(t),r}function We(n,t){var r,e;if(t)for(r=0;r<t.length;r++)(e=t[r])&&"Object"===e.constructor.name&&(t[r]=n.findByName(e.name),t[r]||(t[r]=$e(n,e)))}function qe(n,t){for(var r,e,r=0;r<t.length;r++)(e=t[r]).table&&"Object"===e.table.constructor.name&&(e.table=n.findByName(e.table.name)),We(n,e.tableList),We(n,e.changedTables)}c=this&&this.__extends||(Ir=function(n,t){return(Ir=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}Ir(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),h=this&&this.__assign||function(){return(h=Object.assign||function(n){for(var t,r,e,i,r=1,e=arguments.length;r<e;r++)for(i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},d=this&&this.__spreadArray||function(n,t,r){if(r||2===arguments.length)for(var e=0,i=t.length,o;e<i;e++)!o&&e in t||((o=o||Array.prototype.slice.call(t,0,e))[e]=t[e]);return n.concat(o||Array.prototype.slice.call(t))},Object.defineProperty(j,"__esModule",{value:!0}),j.TableRemoveOptions=j.TableManager=j.TableColumn=j.WSt=j.hasRowFilter=j.Table=j.TableSelectionType=void 0,L=n("Core"),b=n("SheetsCalc"),w=n("Common"),g=n("CalcEngine"),m=n("Filters"),O=n("Bindings"),t=n("./dist/plugins/table/table.ns.js"),p=n("./dist/plugins/table/table-theme.js"),r=n("./dist/plugins/table/table-util.js"),y=n("./dist/plugins/table/customTableThemeManager.js"),x=n("./dist/plugins/table/table-calcSource.js"),v=n("DataManager"),P=n("./dist/plugins/table/data-manager-providers/data-manager-provider.entry.js"),Y=n("./dist/plugins/table/table-data-driven-filter-dialog.js"),e=L.mt.p0,F=L.mt.T1,$=L.mt.j,C=L.GC$.each,W=L.GC$.isEmptyObject,I=w.Common.lt.ht,q=w.Common.ct,K=w.Common.Uf.OS,X=w.Common.Uf.tR,Z=w.Common.kh,M=L.mt.xr,Q=L.mt.go,nn=L.mt.c1,tn=L.mt.St,rn=L.CopyToOptions.all,en=L.StorageType.data|L.StorageType.style|L.StorageType.comment|L.StorageType.tag|L.StorageType.sparkline|L.StorageType.axis|L.StorageType.bindingPath|L.StorageType.hyperlink|L.StorageType.altText,on=L.NodeHelper.sr,un=L.NodeHelper.ur,an=L.mt.n1,fn=L.mt.vo,ln=L.Util.gr,cn=L.Util.pr,sn=L.Util.io,vn=L.Util.mr,hn=L.Util.addXLFNPrefix,dn=L.Util.wr,bn=L.Util.Sr,wn=L.Util.po,mn=L.Util.yo,N=r.Util.throwError,S=r.Util.setFormulaToSheet,gn=r.Util.setValue,T=r.Util.suspendPaint,_=r.Util.resumePaint,yn=r.Util.Hyt,pn=r.Util.suspendCalcService,Cn=r.Util.resumeCalcService,B=r.Util.getRowCount,D=r.Util.getColCount,n=r.Util.checkTableName,Sn=r.Util.isValidTableName,Tn=r.Util.formulaToExpression,z=r.Util.expressionToFormula,_n=r.Util.hSt,Rn=r.Util._4t,xn=r.Util.E4t,jn=r.Util.dSt,On=r.Util.vSt,Fn=r.Util.mSt,kn=r.Util.gSt,k=r.Util.pSt,An=r.Util.bSt,Ln=r.Util.ySt,In=r.Util.T4t,Mn=r.Util.wSt,Nn=r.Util.fSt,Bn=r.Util.lSt,Dn=r.Util.jj,zn=r.Util.Ej,En=r.Util.S4t,Un=r.Util.MSt,Vn=r.Util.kf,Hn=r.Util.CSt,Gn=r.Util.SSt,Jn=r.Util.TSt,Pn=r.Util.ASt,Yn=r.Util.ISt,$n=r.Util.xSt,Wn=r.Util.NSt,qn=L.range_parser.getRangeString,Kn=L.range_parser.Dc,A=null,E=void 0,U=Math.min,Xn=Math.ceil,Zn=Math.max,Qn=JSON.stringify,nt=JSON.parse,ot="highlightFirstColumn",ut="highlightLastColumn",at="bandRows",ft="bandColumns",r="showResizeHandle",lt="autoGenerateColumns",dt="headerRowStyle",bt="footerRowStyle",wt="wholeTableStyle",mt="highlightLastColumnStyle",gt="highlightFirstColumnStyle",yt="firstRowStripStyle",pt="secondRowStripStyle",Ct="firstColumnStripStyle",St="secondColumnStripStyle",Tt="firstHeaderCellStyle",_t="lastHeaderCellStyle",Rt="firstFooterCellStyle",xt="lastFooterCellStyle",jt="firstRowStripSize",Ot="secondRowStripSize",Ft="firstColumnStripSize",kt="secondColumnStripSize",i=".table",At="Column",Nt="dataAreaFormulaStr",zt="footerRowStyles",Et=[Lt="id",tt="name",rt="cellType",et="value",it="formatter",It="dataField",Mt="footerFormula",Bt="dataAreaFormula",Dt="footerValue",st="headerStyle",ct="dataStyle",vt="footerStyle"],Ut=4,Vt=2,Ht="table",Gt="tableResize",Jt="#485DB1",Pt="tableInsertRows",Yt="DoInsertRows",$t="tableShowFooter",Wt="tableDeleteRows",qt="styleName",Kt="tableInsertColumns",Xt="tableDeleteColumns",Zt="collection",Qt="tableColumn",nr="property",tr="dataSource",rr="rowsChange",er="showFooter",V="range",ir="columns",or="columnFormula",ur="footerFormula",ar="tableExpression",fr="sheetExpression",lr="number",cr=ht="string",sr="custom",vr=L.XFileConstants.Ki,hr=L.XFileConstants.Bu,dr="borderLeft",br="borderTop",wr="borderRight",mr="borderBottom",gr="borderHorizontal",yr="borderVertical",pr="DxfId",Cr="CellStyle",t=new w.Common.ResourceManager(t.SR,"Tables"),H=t.getResource.bind(t),Sr=L.UsedRangeUtil.hh,Tr=L.UsedRangeUtil.vh,_r={backColor:2,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},Rr=L.W.F2e,(t=xr=j.TableSelectionType||(j.TableSelectionType={})).TABLE_ROW_SELECT="tableRowSelect",t.TABLE_COL_SELECT="tableColSelect",t.TABLE_CORNER_SELECT="tableCornerSelect",t.TABLE_SELECT="tableSelect",(t=jr=jr||{})[t.deleted=0]="deleted",t[t.dirty=1]="dirty",L.Worksheet.ch(Ht,{priority:2e3,getUsedRange:function(n){var t,r,e;n.type&L.UsedRangeType.table&&(e=(r=(t=this).tables).getUsedRange(),Tr(n.range,e))},init:function(){var m,f,r,l,e,m=this;m.tables=m.Ut.QSt,f=function(n,t,r,e,i,o,u,a,f,l){var c,s,v,h,d,b,w,c=m.tables,s=null==c?void 0:c.AB(t,r,e,i).filter(function(n){return n.NTr()});if(s&&0<s.length)for(v=0;v<f;v++)for(h=u+v,d=0;d<l;d++)if(o.getFormula(h,b=a+d))return void((w=1===e&&e===i&&f===l&&e===f&&!_e(s[0],r))||(n.cancel=!0))},r=function(n,t,r,e){n&&t&&e&&r&&f(n,t.row,t.col,t.rowCount,t.colCount,r,e.row,e.col,e.rowCount,e.colCount)},l=function(n,t,r,e,i){var o=m.tables,o=null==o?void 0:o.AB(t,r,e,i).filter(function(n){return n.NTr()});o&&0<o.length&&o.some(function(n){for(var t=0;t<i;t++)if(n.KTr(r+t))return!0;return!1})&&(n.cancel=!0)},e=function(n,t){n&&t&&l(n,t.row,t.col,t.rowCount,t.colCount)},m.unbind(i),m.bind(L.Events.EditStarting+i,function(n,t){var r=m.tables,e=t.row,i=t.col,r=r.find(e,i);r&&r.Ky<e&&e<r.Sx&&r.NTr()&&r.KTr(i)&&(t.cancel=!0)}),m.bind(L.Events.ClipboardPasting+i,function(n,t){e(t,t.cellRange),t.cancel||r(t,t.cellRange,t.fromSheet,t.fromRange)}),m.D3(L.Events.DragFillBlock+i,function(n,t){e(t,t.fillRange),t.cancel||r(t,t.fillRange,t.sheet,t.fillRange)}),m.D3(L.Events.DragDropBlock+i,function(n,t){var r=t.toCol,e=t.rowCount,i=t.colCount,o=t.toRow,u=t.fromRow,a=t.fromCol;l(t,o,r,e,i),t.cancel||f(t,o,r,e,i,t.sheet,u,a,e,i)}),m.bind(L.Events.BeforeDragDrop+i,function(n,t){var r,e,i,o,u,a,f,r,l,r,c,s,v,c,r=m,e=m.tables,i=H().Exp_DragDropChangePartOfTable,o=t.fromRow,u=t.fromColumn,a=B(t),f=t.columnCount,r=r.rt.q6,l=r.row,r=r.col,c=t.isDragInsert,s=t.isDragCopy,v=A;!c||-1!==o&&-1!==u||(0<=u?(m.isDragCopy&&(r<=u||u+f<=r)||!s&&(r<u||u+f<r))&&(c=!1,e.oSt(-1,r,-1,0)&&(c=!0,v=H().Exp_DragDropShiftTableCell),c||s||!e.oSt(-1,u,-1,f)||(v=i)):0<=o&&u<0&&(s&&(l<=o||o+a<=l)||!s&&(l<o||o+a<l))&&!s&&e.oSt(o,-1,a,-1)&&(v=i)),t.invalidMessage=v}),m.bind(L.Events.RowChanged+i,function(n,t){var r,e,i,r=m.tables,e=r.xl,i=t.propertyName;"isVisible"===i?(!1===t.newValue?e[t.row]=0:e[t.row]=E,r.KSt(t.row)):"height"===i&&(e[t.row]=E,r.KSt(t.row))}),m.bind(L.Events.RowHeightChanged+i,function(n,t){for(var r,e,i,o,u,a,f,r=m.tables,e=r.xl,i=0,o=t.rowList;i<o.length;i++)e[u=o[i]]=E,f=(a=t.sheet).getRowHeight(u),r.KSt(u,0<f)}),m.bind(L.Events.ColumnChanged+i,function(n,t){var r,e,r=m.tables,e=r.Nl;"isVisible"===t.propertyName?(!1===t.newValue?e[t.col]=0:e[t.col]=E,r.JSt(t.col)):"width"===t.propertyName&&(e[t.col]=E,r.JSt(t.col))}),m.bind(L.Events.ColumnWidthChanged+i,function(n,t){for(var r,e,i,o,u,r=m.tables,e=r.Nl,i=0,o=t.colList;i<o.length;i++)e[u=o[i]]=E,r.JSt(u)}),m.bind(L.Events.RangeFiltered+i,function(n,t){for(var r,e,i,o,r=m.tables,e=r.xl,i=t.sheet.IB.range,o=0;o<i.rowCount;o++)e[i.row+o]=E,r.KSt(i.row+o)}),m.bind(L.Events.TableFiltered+i,function(n,t){for(var r,e,i,o,r=m.tables,e=r.xl,i=t.table.range(),o=0;o<i.rowCount;o++)e[i.row+o]=E,r.KSt(i.row+o)}),m.bind(L.Events.TableFilterCleared+i,function(n,t){var r;m.tables.dl()}),m.Q1i&&m.bind(L.Events.RangeChanged+i,function(n,t){var r,e,i,r=t.changedCells;if(r){if(m.pmi(),1500<r.length)m.t6i(r);else for(e=0;e<r.length;e++)i=r[e],m.Q1i(i.row,i.col,1,1,i.sheetArea);m.Smi()}})},resetBinding:function(n){this.tables.XSt()},initBinding:function(n){var t,r,e,i,o,u,t=this,r=t.tables;for(r.XSt(),pn(t),i=0,o=(e=r.all()).length;i<o;i++)(u=e[i])&&u.qSt();Cn(t)},dispose:function(n){!1!==n.clearCache&&(this.unbind(i),this.tables)&&(this.tables.L0(),this.tables=null)},clearPendingChanges:function(){var n=this.tables;n&&n.$St()},onGroupChanged:function(n){var t,r,e,i,t,r=this.tables;if(n.fromSetCollapsed)for(e=n.isRow?r.xl:r.Nl,i=n.start;i<=n.end;i++)e[i]=E,n.isRow?r.KSt(i):r.JSt(i)},onLayoutChanged:function(n){var t,r,e,i,o,u,a,f,t=n.changeType,r=n.row,e=n.rowCount,i=n.col,o=n.colCount,u=n.sheetArea,a,f=this.tables;"setRowCount"===t||"setColumnCount"===t?f.dl():!I(u)&&3!==u||("addRows"===t?(f.msr(r,e),f.dl()):"deleteRows"===t?(f.dsr(r,e),f.dl()):"addColumns"===t?(f.hsr(i,o),f.dl()):"deleteColumns"===t?(f.vsr(i,o),f.dl()):"clear"!==t||n.ignoreTable||f.d5(r,i,e,o,n.type))},toJson:function(n,t){var r,e,i,o,i;function u(n,t){for(var r,e,i,o,u,a,f,l,c,s,v,h,d,b,w,m,g,y,y,r=n.tables.all(),e=0,i=r.length;e<i;e++)if(u=(o=r[e]).z3(),f=(a=o.dataRange()).row,l=a.col,c=f+B(a)-1,s=l+D(a)-1,u){if(v=[],(h=o.BSt)&&0<h.length)for(d=0;d<h.length;d++)w=(b=h[d]).formatter(),I(w)||tn(w)||((m=new L.Style).formatter=w,v[d]=m);for(g=f;g<=c;g++)for(d=l;d<=s;d++)(y=o.Sl(g,d)).e5t&&(y=y.y4,q.W0(y)&&(y=q.Q0(y)),n.s8(t,g,d,y,E,v[d-l]))}}e=(r=this).tables,i=t&&t.ignoreStyle,o=t&&t.newWorkSheetName,i||(e&&(n.tables=e.toJSON(o,t)),t&&t.includeBindingSource&&((i=n.data).dataTable=i.dataTable||{},u(r,i.dataTable)))},wh:function(n,t,r){var e,i,o,u,a,f,l,c,s,v,h,d,b,w,m,g,y,p,C,S,T,_,R,x,x,j,O,F,k,A,e=this,i=e.tables,o=r&&!1===r.includeStyles,u=t.styleManager;if(i&&!o){if(i.wh(n),r)for(a=r.includeBindingSource,f=r.fileType===L.OpenSaveFileType.excel,l=function(n,t,r){var n=n.dataAreaFormula();if(!I(n)&&!Ue(n=z(e,n,t,r)))return fn(hn(n))},s=0,v=(c=i.all()).length;s<v;s++)if(d=(h=c[s]).z3(),w=(b=h.dataRange()).row,m=b.col,g=w+B(b)-1,y=m+D(b)-1,d&&(p=f&&h.NTr(),a||p)){if(C={},(S=h.BSt)&&0<S.length)for(T=0;T<S.length;T++)_=S[T],p&&(C[m+T]=l(_,w,m+T));for(R=w;R<=g;R++)for(T=m;T<=y;T++)p&&(x=C[T])?(h.XTr(R,T)&&e.c8(n,R,T,h.Sl(R,T).y4,t.sharedStrings),e.kTr(n,R,T,x,t.sharedStrings)):(x=h.Sl(R,T)).e5t&&(j=x.y4,q.W0(j)&&(j=q.Q0(j)),e.c8(n,R,T,j,t.sharedStrings))}if(r&&L.OpenSaveFileType.excel===r.fileType&&(F=(O=i.U3).length,k=M(n,"sheetData"),A=t.defaultStyle,k)&&A)for(s=0;s<F;s++)(h=O.get(s)).FGr||h.qle(k,A,u,e)}},fromJson:function(n,t,r){var e,i,o,o,u,e,i=this.tables,o=n.tableManager,o=t?o&&o.tables:n.tables,u=r&&r.ignoreStyle;F(o)&&!u&&i&&i.fromJSON(o,t,n.isApplyRefilter,r&&r.gp,(null==r?void 0:r.cb)===L.OpenSaveFileType.excel)},fromJsonAfterFormula:function(n,t,r){Ur(this)},fromJsonAfterSJSFormula:function(n){Ur(this)},yh:function(n,t,r){var e,i=r&&!1===r.includeStyles,o=this.tables,u=M(n,hr),n=n.rels;F(u)&&F(n)&&!i&&o&&o.yh(u,n,t,r)},lastNonNullRowAndCol:function(){var n,t,r,e,i,o,u,a,a,f,f,n,t,r=0,e=0,i=this.tables.all();if(i)for(o=0,u=i.length;o<u;o++)(a=i[o])&&(r<(f=(a=a.range()).row+B(a)-1)&&(r=f),e<(f=a.col+D(a)-1))&&(e=f);return{lastNonNullRow:r,lastNonNullCol:e}},paintCell:function(n){var t,r,e,n,i,o,r,u,r,i,u,o,r,n,a,n,f,l,c,t=this;n.isPrinting||n.sheetArea!==L.SheetArea.viewport||t.isActualProtected()||(r=t.tables,e=n.ctx,i=(n=n.cell).row,o=n.col,(r=r.find(i,o))&&r.showResizeHandle()&&!r.QL()&&(u=Rn(t,r),r=xn(t,r),i===u)&&o===r&&(i=n.x,u=n.y,o=n.width,r=n.height,n=t.zoom(),a=Xn(4*n),n=Xn(2*n),f=i+o,l=u+r,e)&&0<o&&0<r&&(e.save(),e.rect(i,u,o,r),e.clip(),e.fillStyle=Jt,(c=t.options.rightToLeft)?(e.beginPath(),e.moveTo(i,l),e.lineTo(i+a,l),e.lineTo(i+a,l-n),e.lineTo(i,l-n),e.fill(),e.beginPath(),e.moveTo(i,l-n),e.lineTo(i+n,l-n),e.lineTo(i+n,l-a),e.lineTo(i,l-a)):(e.beginPath(),e.moveTo(f-a,l),e.lineTo(f,l),e.lineTo(f,l-n),e.lineTo(f-a,l-n),e.fill(),e.beginPath(),e.moveTo(f,l-n),e.lineTo(f-n,l-n),e.lineTo(f-n,l-a),e.lineTo(f,l-a)),e.fill(),e.restore()))},composeTableFooterList:function(n){var t=n.table,r=n.row,e=n.col,n=n.style;t.i5t(r,e,n)},refSheetLazyLoaded:function(n,o,u){var t,r,n,e,a,t,r=this.tables.all();0<r.length&&j.WSt&&(n=n.rels.c_.filter(function(n){return n.Type===L.RelationshipConstants.lc}).map(function(n){return L.Util.vr(n.Target)}),e=o.tables,a={},L.GC$.each(n,function(n,t){var t=e[t];t&&(a[t.name]=t)}),L.GC$.each(r,function(n,t){var r,e,r,i,r=a[t.name()];r&&(e=M(r,"autoFilter"),r=M(r,"sortState"),Xr(t,i=t.IB||new j.WSt,e,r,o.styleManager),u.isApplyRefilter)&&t.IB.reFilter()}))},onSheetLoaded:function(){for(var n,t,r,e,i,o,u,n=this,t=n.tables&&n.tables.all()||[],r=0,e=t.length;r<e;r++)u=(o=(i=t[r]).NTr())&&i.z3(),o&&u.qTr()&&Ae(n,i)},copyOrMoveTo:function(t){var r,e,n,r=this,e=new L.Range(t.destRow,t.destColumn,t.rowCount,t.columnCount),n;r.tables.all().filter(function(n){var n=n.range();return!n.intersect(t.srcRow,t.srcColumn,t.rowCount,t.columnCount)&&e.contains(n.row,n.col,n.rowCount,n.colCount)}).forEach(function(n){return r.tables.remove(n)})}}),L.Worksheet.prototype.jj=function(n,t,r,e,i,o){var o=o?E:n.tq();Dn(this,n,t,r,e,i,o)},L.Worksheet.prototype.Ej=function(n,t,r,e,i){zn(this,n,t,r,e,i)},L.Worksheet.prototype.S4t=function(n,t,r){En(this,n,t,r,!0)},L.Workbook.prototype.r5t=function(n){var t,r,r,e,t=this.sheets;if(t)for(e=0;e<t.length;e++)if((r=t[e].tables)&&(r=r.findByName(n)))return r;return A},s.prototype.L0=function(){var n=this;n.BSt=[],n.OSt=[],n.aj=[],n.GSt=[],n.USt=[],n.PSt=[],n.Mf=A,n.jS=A,n.IB&&(n.IB.L0(),n.IB=A),n.dl(),n.rkr(!0)},s.prototype.dl=function(){this.HSt=[],this.zSt=[],this.A0r()},s.prototype.NTr=function(){return this.H3&&this.H3.NTr()},s.prototype.GTr=function(n){return(0,Y.GTr)(this,n)},s.prototype.xkr=function(n,t){var r=this;return r.showHeader()&&n===r.startRow()&&r.NTr()&&t>=r.startColumn()&&(t<=r.endColumn()||r.allowAutoExpand()&&t===r.endColumn()+1)},s.prototype.$Gr=function(n,t){var r,e,r=this,e;return!!(r.showHeader()&&n>r.startRow()&&n<=(r.showFooter()?r.endRow()-1:r.endRow()))&&(!!I(t)||t>=r.startColumn()&&t<=r.endColumn())},s.prototype.cGr=function(n){var t=this;t.NTr()&&(t.CAr(),t.xAr(n))},s.prototype.xAr=function(n){var u=this;(n=n||u.z3())&&u.NTr()&&n.TAr()&&(u.nUr=function(n,t){var r,e,t,i,t,r=!1;if(t.eventName===v.Events.TableFetched&&u.z3().tableName===t.tableName){if(!t.isFirstTimeFetched&&!t.reload||!t.isDataLengthChanged)return;r=!0}e=u.z3().getTable(),(i=(t=u.Mf.tables).all().some(function(n){var n;return!!n.NTr()&&(n=n.z3()).getTable()===e&&!n.PLt()}))||(t.tUr(),r&&(t=u.IB)&&(t.Pct()&&t.sortColumn(t.nrt.index,t.nrt.ascending),t.isFiltered())&&t.filter(E))},u.U2i=function(n,r){var e=function(){clearTimeout(u.SGr),u.SGr=E};u.SGr&&e(),u.SGr=setTimeout(function(){var n,t;e(),(n=u.Mf)&&!n.getCalcService().IsSuspended()&&(t=u.range(),n.recalcRange(t.row,t.col,t.rowCount,t.colCount),u.zGr(r))},50)},u.GIr=function(){var o;u.KTr()&&(o=function(){clearTimeout(u.UIr),u.UIr=E},u.UIr&&o(),u.UIr=setTimeout(function(){var n,t,r,e,i;if(o(),n=u.Mf)if(n.getCalcService().IsSuspended())u.GIr();else{for(t=u.dataRange(),n.suspendPaint(),n.suspendCalcService(),r=u.BSt,e=0;e<r.length;e++)(i=r[e]).dataAreaFormula()&&n.recalcRange(t.row,e+t.col,t.rowCount,1);n.resumeCalcService(),n.resumePaint()}},50))},n.bind(v.Events.TableFetched,u.nUr),n.bind(v.Events.ItemInserted,u.nUr),n.bind(v.Events.ItemRemoved,u.nUr),n.bind(v.Events.ItemUpdated,u.U2i),n.bind(v.Events.ItemReset,u.U2i),n.bind(v.Events.CalcValueCleared,u.GIr))},s.prototype.CAr=function(n){var t=this,r=t.z3();r&&t.NTr()&&r.TAr()&&(t.nUr&&(r.unbind(v.Events.ItemInserted,t.nUr),r.unbind(v.Events.ItemRemoved,t.nUr),t.nUr=E),t.U2i&&(r.unbind(v.Events.ItemUpdated,t.U2i),r.unbind(v.Events.ItemReset,t.U2i),t.U2i=E),t.GIr&&(r.unbind(v.Events.CalcValueCleared,t.GIr),t.GIr=E,t.UIr)&&(clearTimeout(t.UIr),t.UIr=E),n)&&r.wpt()},s.prototype.range=function(){var n=this;return(0,L.Ec)(n.Ky,n.iw,n.Sx,n.Tx)},s.prototype.AAr=function(n){return n-this.startColumn()},s.prototype.dataRange=function(){var n,t,r,n=this,t=n.jO?n.Ky+1:n.Ky,r=n.jO?n.Sx-1:n.Sx;return n.oL&&r--,(0,L.Ec)(t,n.iw,r,n.Tx)},s.prototype.WTr=function(){return this.jO?this.Ky+1:this.Ky},s.prototype.eUr=function(){var n,t,n=this,t=n.jO?n.Sx-1:n.Sx;return n.oL?t-1:t},s.prototype.iUr=function(n){var t=this,r=t.WTr(),t=t.eUr();return r<=n&&n<r+t},s.prototype.headerIndex=function(){return this.jO?this.Ky:-1},s.prototype.footerIndex=function(){return this.oL?this.Ky+this.Sx-1:-1},s.prototype.wEr=function(n){var t,r,t=this,r;t.yEr(n)&&t.Mf.$Dr({type:"updateTableRange",table:t,rangeInfo:n})},s.prototype.yEr=function(n){var t,r,e,i,o,u,a,f,n,l,c,s,v,l,h,t=this,r=n.row,e=n.col,i=n.rowCount,o=n.colCount,u=n.deltaRow,a=n.deltaCol,f=n.deltaRowCount,n=n.deltaColCount,l=t.range(),c=l.row,s=l.col,v=l.rowCount,l=l.colCount,h=!1;return I(r)||r===c||(t.Ky=r,h=!0),I(e)||e===s||(t.iw=e,h=!0),I(i)||i===v||(t.Sx=i,h=!0),I(o)||o===l||(t.Tx=o,h=!0),I(u)||0===u||(t.Ky+=u,h=!0),I(a)||0===a||(t.iw+=a,h=!0),I(f)||0===f||(t.Sx+=f,h=!0),I(n)||0===n||(t.Tx+=n,h=!0),h},s.prototype.pEr=function(n){var t=this,r;t.Mf.$Dr(h({type:"setTableColumnProperty",table:t},n))},s.prototype.bEr=function(n,t){var r,e;n!==qt&&null!=(e=(r=this).Mf)&&e.$Dr({type:"setTableProperty",tableId:r.jKe(),propName:n,value:t})},s.prototype.showHeader=function(n){var t,r,t=this;return 0===arguments.length?t.jO:(t.jO!==n&&((r=t.Mf)&&r.suspendPaint(),t.o5t(n),r)&&r.resumePaint(),t)},s.prototype.layoutStyle=function(n){var t,r,e,i,o,u,a,n,f,l,t=this,r=t.Gye,e=t.Uye,i=t.Hye;return 0===arguments.length?{data:re(r),header:re(e),footer:re(i)}:((o=t.Mf).suspendPaint(),n=n?(a=n.data,u=n.header,n.footer):u=a=A,!o||e===u&&r===a&&i===n||(o.Ut.YSt(t,"layoutStyle",f={data:r,header:e,footer:i},l={data:a,header:u,footer:n}),t.MEr(u,a,n),o.$Dr({type:"setLayoutStyle",tableId:t.jKe(),headerStyle:u,dataStyle:a,footerStyle:n})),o.resumePaint(),t)},s.prototype.MEr=function(n,t,r){var e=this;e.Uye=n,e.Gye=t,e.Hye=r},s.prototype.o5t=function(n){var t,r,e,i,o,e,t=this,r=t.Mf;r&&r.Ut.YSt(t,"showHeader",t.jO,n),t.CEr(e=n),r.$Dr({type:"showHeader",tableId:t.jKe(),value:n}),e?(0<t.Ky&&(i=t.Ky-1,o=t.Sx+1,t.yEr({row:i,rowCount:o}),t.Mf.$Dr({type:"updateTableRange",table:t,rangeInfo:{row:i}})),t.a5t()):(e=t.Ky,i=t.Ky+1,o=t.Sx-1,t.yEr({row:i,rowCount:o}),t.Mf.$Dr({type:"updateTableRange",table:t,rangeInfo:{row:i}}),t.u5t(e),t.s5t()),r&&g&&r.recalcRange(t.Ky+(n?0:-1),t.iw,1,t.Tx)},s.prototype.CEr=function(n){this.jO=n},s.prototype.showFooter=function(n,t){var r,e,r=this;if(0===arguments.length)return r.oL;if(r.oL!==n){(e=r.Mf)&&e.suspendPaint();try{r.c5t(n,t||!1)}finally{e&&e.resumePaint()}}return r},s.prototype.expandBoundRows=function(n){var t=this;return 0===arguments.length?t.RSt:(t.RSt!==n&&(t.RSt=n),t)},s.prototype.c5t=function(n,t){var r,e,i,o,u,a,f,l,c,s,v,h,d,r=this,e=r.Mf;if(e&&e.Ut.YSt(r,er,r.oL,n),i=r.Sx,n){if((!e||r.Ky+i<e.getRowCount())&&(!t||r.f5t(!0,i)))for(r.SEr(n),r.yEr({rowCount:r.Sx+1}),u=(o=r.BSt).length,a=r.footerIndex(),f=r.iw,l=0;l<u;l++)v=f+l,(s=(c=o[l])&&c.footerFormula())&&(h=z(e,s,a,v))&&(s=Tn(e,h,a,v),c.footerFormula(s));r.l5t()}else r.SEr(n),d=r.Ky+i-1,r.yEr({rowCount:r.Sx-1}),r.u5t(d),r.cL(0),t&&r.f5t(!1,i);e&&g&&e.recalcRange(r.Ky+r.Sx+(n?-1:0),r.iw,1,r.Tx)},s.prototype.SEr=function(n){var t=this;t.xEr(n),t.Mf.$Dr({type:"showFooter",tableId:t.jKe(),value:n})},s.prototype.xEr=function(n){this.oL=n},s.prototype.f5t=function(n,t){var r,e,t,i,o,u,a,f,l,r=this,e=r.Mf,t=r.Ky+t,i=r.iw,o=r.Tx,u=i+o-1,a=jn(e,r),f=t<=a;return!(n&&Fn(e,r,t,a,i,u,1)||(f&&e.moveTo(t,i,l=n?t+1:t-1,i,a-t+1,o,rn),0))},s.prototype.h5t=function(n){for(var t,r,e,i,o,u,a,f,l,c,s,t=this,r=t.BSt,e=r.length,i=t.iw,o=[],u=t.name(),a=t.Mf.options.rightToLeft?L.ButtonPosition.left:L.ButtonPosition.right,f=0;f<e;f++)l=i+f,c=t.getColumnName(f),o.push(Er(u,c,a)),n||(0===f?t.d5t(l,H().Table_Total,!0):f!==e-1||(s=r[f].footerFormula())||(t.v5t(l)?t.m5t(f,"=SUBTOTAL(109,".concat(u,"[").concat(c,"])")):t.m5t(f,"=SUBTOTAL(103,".concat(u,"[").concat(c,"])"))));t.OSt=o},s.prototype.ZEr=function(){var n,t,r,e,i,o,u,a,f,n=this,t=n.BSt,r,e=t.length-1,i,o=n.iw+e,u=n.name(),a=n.getColumnName(e),f;t[e].footerFormula()||(n.v5t(o)?n.m5t(e,"=SUBTOTAL(109,".concat(u,"[").concat(a,"])")):n.m5t(e,"=SUBTOTAL(103,".concat(u,"[").concat(a,"])")))},s.prototype.v5t=function(n){for(var t,r,t,e,i,o,u,a,t=this,r=t.Mf,t=t.dataRange(),e=!0,i=t.rowCount,o=t.row,u=0;u<i;u++)if(a=r.getValue(o+u,n),!I(a)&&typeof a!==lr){e=!1;break}return e},s.prototype.g5t=function(){return this.OSt&&0<this.OSt.length},s.prototype.p5t=function(n,t,r){var e=this,i=this.Mf;e.g5t()&&(i&&i.Ut.YSt(e,zt,e.b5t(),r),0<=t)&&(r?e.OSt.splice(n,t,r):e.OSt.splice(n,t))},s.prototype.b5t=function(){var n,t=this.OSt,r=[];return t.forEach(function(n){n&&r.push(n.clone())}),r},s.prototype.y5t=function(n,t,r){var e=this,i=e.Mf.options.rightToLeft?L.ButtonPosition.left:L.ButtonPosition.right,r=F(r)?Er(e.name(),r,i):A;e.g5t()&&e.p5t(n,t,r)},s.prototype.useFooterDropDownList=function(n){var t=this,r=t.Mf;return 0===arguments.length?t.ESt:(r&&(r.suspendPaint(),t.ESt!==n&&(r.Ut.YSt(t,"useFooterDropDownList",t.ESt,n),t.ESt=n,t.bEr("useFooterDropDownList",n),t.ESt)&&!t.g5t()&&(t.h5t(),t.w5t()),r.resumePaint()),t)},s.prototype.getStyleName=function(){return this.styleName},s.prototype.TEr=function(n,t){var r=this;Ie(qt).call(r,n,r.styleName),!1!==t&&Me(qt).call(r,n,r.styleName),r.styleName=n},s.prototype.AEr=function(n){var t=new p.TableTheme;return t.fromJSON(n),t},s.prototype.rowFilter=function(){var n=this;return!n.IB&&j.WSt&&(n.IB=new j.WSt(n),n.IB.Uct(n.dataRange())),n.IB},s.prototype.IEr=function(n,t,r){var e,i,t,e=this,i=e.Mf,t=e.kEr(t);return e.NEr(n,t),i.$Dr({type:"addTableColumn",tableId:e.jKe(),index:n,column:t}),r&&e.LAr(t,n),t},s.prototype.kEr=function(n){var n=new J(this.M5t(),E,n);return n.onChange=this.pEr.bind(this),n},s.prototype.NEr=function(n,t){var r,e=this.BSt;n=null!=n?n:e.length,e.splice(n,0,t)},s.prototype.iGe=function(n,t,r){var e,i,i;(t=void 0===t?1:t)<=0||(i=(e=this).BSt)&&(i=i.splice(n,t),e.y5t(n,t),e.Mf.$Dr({type:"deleteTableColumn",table:e,removedTcs:i}),r)&&e.FAr(n,t)},s.prototype.bindColumns=function(n){var t,r,e,i,o,u,a,f,l,c,t=this,r=t.Mf,e=[];if(n){for(i=(n=0<n.length&&t.NTr()?je(t.z3().getTable(),n):n).length,t.autoGenerateColumns()||(i=U(t.Tx,n.length)),t.jO&&r.KI(t.Ky,t.iw,1,i,3,17,E,!0),o=0;o<i;o++)u=(u=t.BSt[o])||t.IEr(o),te(r,t,n[o],u,o,!0),a=u.dataField(),f={name:u.name(),value:u.value(),dataField:a},a&&e.push(f),t.y5t(o,1,u.name());t.vTt(),0<i&&t.NTr()&&(Se(t.BSt),c=Oe((l=t.z3()).getTable(),t.BSt.slice()),l.setColumnInfos(c,!1,!0),t.H3.zEr())}t.C5t=e,t.IBe(e)},s.prototype.bindingPath=function(n){var t=this;return 0===arguments.length?t.S5t:(t.NTr()||(t.S5t=n,t.qSt()),t)},s.prototype.bind=function(n,t,r){var e,e,e,e,i,i,o,e,u,a,f,i,e,l,n,o=this;if("string"==typeof r&&(e=null==(e=null==(e=null==(e=null==(e=o.Mf)?void 0:e.parent)?void 0:e.dataManager())?void 0:e.tables)?void 0:e[r],I(e)?(u=r,r=A,(a=null==(i=null==(i=o.Mf)?void 0:i.parent)?void 0:i.dataManager())&&(o.cUr=u,f=pe(v.Events.TableAdded,o),a.D3(f,function(n,t){t.name===u&&(a._3(f),delete o.cUr,o.bind(o.BSt.slice(),o.S5t,u))}))):r=e),i=r,e=!(0,P.isDMView)(i),l=ve(i),I(n)||(l&&Se(n=je(i,n)),o.bindColumns(n)),I(r)&&(i=o.z3()),t&&!l&&(o.S5t=t,i=(0,O.q$)(i,t)),O.$$&&i&&e)if(l){if(o.showResizeHandle(!1),n=o.IAr(i,o.autoGenerateColumns()?[]:o.BSt))return n}else o.T5t(i);return o},s.prototype.RIr=function(n,t){var r,e,r=this;if(r.POt||(r.POt=new x.QTr(r.Mf.getCalcService(),r)),n.kAr(r.POt,function(){return r.Mf.options}),t)for(e in t)t.hasOwnProperty(e)&&n.rGr(Number(e),t[e]);n.HTr(!0)},s.prototype.IAr=function(n,t){var r,e,i,r=this,e=Fe(n,ge(r),t);if(r.RIr(e),!e.XLt())return i=function(){return e.fUr(),ke(e),r.T5t(e),r},e.getTable().fetch().then(i).catch(function(){e.NAr=function(){delete e.NAr,i()}});r.T5t(e)},s.prototype.DAr=function(n){var t,n,r,e,i,o,u,a,f,l,t,c,s,t=n.dataManagerTableBinding,n=n.dataManagerViewBinding,r=this,e=r.Mf.parent.dataManager().tables[t];I(e)?t&&I(n)&&(i=r.cUr=t,o=r.Mf.parent.dataManager(),u=pe(v.Events.TableAdded,r),o.D3(u,function(n,t){t.name===i&&(o._3(u),delete r.cUr,r.bind(r.BSt.slice(),r.S5t,i))})):((a=e.views[n]).uIr()?a=r.okr(a):r.RIr(a),l=function(n){r.NTr()&&r.z3()!==n&&r.rkr(!(0,P.isDMView)(n),n)},t=function(){l(f),r.H3.bind(f),r.cGr(f)},c=function(){ke(a),a.tFt(A,A,A,!0)},(f=a).XLt()?(c(),t()):(t(),s=function(){var n;a.fUr(),c(),Ae(r.Mf,r,function(){r.refreshBinding(!0)})},a.getTable().fetch().then(s).catch(function(){a.NAr=function(){delete a.NAr,s()}})))},s.prototype.getColumn=function(t){return this.BSt.find(function(n){return n.name()===t})},s.prototype.jEr=function(t){return this.BSt.find(function(n){return n.jKe()===t})},s.prototype.DEr=function(t){return this.BSt.findIndex(function(n){return n.jKe()===t})},s.prototype.getColumnName=function(n){var t,t,n,t=this.BSt;return t&&0<=n&&n<t.length&&(t=t[n])?(n=t.name())!==A?$(n):n:A},s.prototype.setColumnName=function(n,t){var r,e,e,i,o,r=this;return r.cSt(t)||(e=r.BSt)&&0<=n&&n<e.length&&(i=(e=(e=e[n])||r.IEr(n)).name(),o=r.Mf,i!==t&&o&&(o.Ut.A5t(r,e,"name",i,t),e.name(t)),r.jO&&o&&o.setText(r.headerIndex(),r.iw+n,t),r.I5t(i,e.name(),n)),r},s.prototype.I5t=function(n,t,r){var e,i,o,r,e=this,i,o=e.BSt[r];e.y5t(r,1,o.name()),(r=this.LSt)&&r.onColumnNameChanged(n,t),e._Er(n,t),e.A0r()},s.prototype._Er=function(r,e){var n,t,t=this;null!=(n=this.aT)&&n.forEach(function(n,t){t.ubt===r&&(t.ubt=e),t.sbt===r&&(t.sbt=e)}),t.A0r()},s.prototype.autoBind=function(){var n=this,t=n.z3();n.IBe(A),O.$$&&t&&(n._Be=!0,n.T5t(t),delete n._Be)},s.prototype.refreshBinding=function(n){var t,r,e,e,i,i,t=this;t.QL()&&(r=t.dataRange(),0<(e=t.pTt()))&&e!==B(r)&&(e=e,t.showHeader()&&(e+=1),t.showFooter()&&(e+=1),i=t.range(),i=(0,L.Ec)(i.row,i.col,e,D(r)),t.K5t(i,!0,n))},s.prototype.IBe=function(n,t){var r,t,r,e,r=this,t=t||r.H3;t&&(e=void 0,(r=r.Mf.Ut.G8)&&!(e=r.tableChanges)&&(r.tableChanges=e=[]),t.IBe(n,e))},s.prototype.setColumnDataField=function(n,t){var r,e,e,i,o,o,i,o,r=this,e=r.BSt;if(e&&0<=n&&n<e.length){if(e=(e=e[n])||r.IEr(n),r.NTr()&&(t=Ce(t=xe(t,Re(r.z3().getTable())(t))?"="+t:t,r.BSt)),i=r.Mf,o=e.dataField(),i&&t!==o&&(i.Ut.A5t(r,e,"dataField",o,t),r.NTr())&&(o=e.dataAreaFormula())&&(e.dataAreaFormula(A),e.x5t(A),i.Ut.A5t(r,e,"dataAreaFormula",o,A)),e.dataField(t),r.NTr())return r._Ar(n,e),i=r.IB.range,i=(0,L.Ec)(i.row,i.col,i.rowCount,i.colCount),r.IB.Xct(r.iw+n,1),r.IB.Jct(r.iw+n,1),r.IB.Fct(i),r;o=r.z3(),O.$$&&o&&r.T5t(o)}return r},s.prototype.getColumnDataField=function(n){var t,t,n,t=this.BSt;return t&&0<=n&&n<t.length&&(t=t[n])?(n=t.dataField())!==A?$(n):n:A},s.prototype.getColumnFormula=function(n){var t,r,t,e,n,t,t=this.BSt,r=this.Mf;return t&&r&&0<=n&&n<t.length&&(t=t[n])?(e=this.footerIndex(),n=this.iw+n,(t=t.footerFormula())&&z(r,t,e,n,!1)):A},s.prototype.setColumnFormula=function(n,t){return this.m5t(n,t),this},s.prototype.setColumnDataFormula=function(n,t){var r,e,e,i,o,u,a,f,l,c,s,v,h,d,b,f;if(g){if((e=(r=this).BSt)&&0<=n&&n<e.length&&(e=e[n])){i=r.Mf,T(i),pn(i),o=n+r.iw,u=r.Ky,a=r.Sx;try{for(r.showHeader()&&(u++,a--),r.showFooter()&&a--,f=Tn(i,t,u,o,!0,E,r),l=e.dataAreaFormula(),i&&f!==l&&i.Ut.A5t(r,e,"dataAreaFormula",l,f),e.x5t(t),e.dataAreaFormula(f),c=u,s=t,v=f,r.NTr()&&(c=u+a,v=s=A,t?r._Ar(n,e,t,f):r._Ar(n,e),r.EAr()),h=c;h<u+a;h++)d=i.getFormula(h,o),S(i,h,o,s,v),t||(b=l&&z(i,l,h,o),(d=d&&z(i,Tn(i,d,h,o),h,o))===b&&i.Ut.setValue(h,o,A))}finally{i.Lp.resume(!(f=function(n){return n.w3===i.oMt&&n.row>=u&&n.row<u+a&&n.column===o}),E,f),_(i)}}return r}},s.prototype.EAr=function(){var n,t,r,e,i,i,n=this,t=n.NTr()&&n.N5t()&&n.getSlicerData&&n.getSlicerData();if(t)for(r=n.BSt,e=0;e<r.length;e++)(i=r[e]).dataAreaFormula()&&(i=t.getColumnIndex(i.name()),t.vzt)&&t.vzt[i]&&(t.vzt[i]=A)},s.prototype.zGr=function(n){var t=this,r=t.z3().VGr(n.index),n=n&&n.changingFields||[];t.YGr(r,n)},s.prototype.YGr=function(n,r){var e,t,i,o,u,a,f,l,e=this,t;if(e.N5t()&&e.getSlicerData&&e.getSlicerData()){for(e.EAr(),i=e.dataRange(),o=n+e.startRow(),u=e.BSt,a=[],f=function(n){var t,n,n,t=r[n],n=u.findIndex(function(n){return t===n.dataField()});-1<n&&(n=n+e.startColumn(),a.push(e.ZGr(o,n,i)))},l=0;l<r.length;l++)f(l);e.WGr(a)}},s.prototype.ZGr=function(n,t,r){var e=this,i=e.Mf;return{columnName:e.getColumnName(t-r.col),row:n-r.row,data:{value:i.getValue(n,t),text:i.getText(n,t)}}},s.prototype.WGr=function(n){var t,t,t=this;n&&0<n.length&&t.N5t()&&t.getSlicerData&&null!=(t=t.getSlicerData())&&t.onDataChanged(n)},s.prototype.KTr=function(n,t){var r=this;return I(n)?r.BSt.some(function(n){return n.dataAreaFormula()}):(t=null!=t?t:r.AAr(n),r.BSt[t].dataAreaFormula())},s.prototype.GGr=function(n){var t,r,t,n,r,t=this.z3(),n=t.kve(n);return!n||n.zTr||(0,v.isFormula)(n)||!(null!=(t=t.getTable())&&t.hasExistedColumn(n.value))},s.prototype._Ar=function(n,t,r,e){var r,e,r,e,i,o,i=this,o=i.H3;o&&o.OTr()&&(r?o.JEe(n,we(t,r,e),null==(e=null==(r=i.Mf)?void 0:r.Ut)?void 0:e.G8):o.JEe(n,me(t),null==(e=null==(r=i.Mf)?void 0:r.Ut)?void 0:e.G8))},s.prototype.getColumnValue=function(n){var t,r,r,e,t=this,r=t.BSt;return r&&0<=n&&n<r.length&&(r=r[n])?t.oL&&r.footerFormula()&&(e=t.Mf)?e.getValue(t.footerIndex(),t.iw+n):r.footerValue():A},s.prototype.setColumnValue=function(n,t){var r,e,i,e,o,r=this,e=r.BSt,i=r.Mf;return e&&0<=n&&n<e.length&&((e=e[n])&&(o=e.footerValue(),i&&t!==o&&i.Ut.A5t(r,e,"footerValue",o,t),e.footerValue(t)),r.oL)&&i&&gn(i,r.footerIndex(),r.iw+n,t),r},s.prototype.columnLayoutStyle=function(n,t){var r,e,e,n,i,o,u,a,f,l,r=this,e=r.BSt;return!(I(n)||n<0||n>=e.length)&&(e=e&&e[n])?(n=e.headerStyle(),i=e.dataStyle(),o=e.footerStyle(),t===E?{header:re(n),data:re(i),footer:re(o)}:(l=f=a=void 0,(u=r.Mf).suspendPaint(),l=t?(a=t.header,f=t.data,t.footer):f=a=t,!u||n===a&&i===f&&o===l||(u.Ut.A5t(r,e,st,n,a),u.Ut.A5t(r,e,ct,i,f),u.Ut.A5t(r,e,vt,o,l),e.headerStyle(a),e.dataStyle(f),e.footerStyle(l)),u.resumePaint(),r)):r},s.prototype.filterButtonVisible=function(n,t){var r,e,i,o,u,a,f,l,c,r=this,e=r.Mf,i=r.rowFilter(),o=r.Tx,u=arguments;switch(u.length){case 0:return i&&i.filterButtonVisible();case 1:if("number"==(f=typeof(a=u[0])))return a<0||o<=a?void 0:i&&i.filterButtonVisible(a);if("boolean"==f&&i){for(T(e),l=0;l<r.Tx;l++)i.filterButtonVisible(l,a);_(e)}return r;case 2:return n<0||o<=n?void 0:(i&&i.filterButtonVisible(n,t),r)}},s.prototype.allowAutoExpand=function(n){var t=this,r=t.Mf;return 0===arguments.length?t.VSt:(t.VSt!==n&&(r.Ut.YSt(t,"allowAutoExpand",t.VSt,n),t.VSt=n,t.bEr("allowAutoExpand",n)),t)},s.prototype.N5t=function(){return!!this.LSt},s.prototype.Sg=function(n){var t=this,r=t.jS;t.k5t(n),t.Mf&&t.Mf.Ut&&t.Mf.Ut.D5t(t,r)},s.prototype.k5t=function(n){var t,r,t=this;t.jS=n,t.Mf=n&&n.Mf,r=t.IB,n&&r&&r.Mf!==n.Mf&&r.table(t)},s.prototype._5t=function(n){for(var t,r,e,i,o,u,a,f,l,c,s,v,h,d,t=this,r=t.Mf,e=r.getDefaultStyle(),i=t.Ky,o=t.iw,u=t.Sx,a=t.Tx,f={},l=r.parent,c=t.jO?1:0,s=c+(t.oL?1:0),v=0;v<a;v++)for(h=v+o,t.jO&&Pr(r,i,h,e,f,l,n),t.oL&&Pr(r,t.footerIndex(),h,e,f,l,n),d=0;d<u-s;d++)Pr(r,d+i+c,h,e,f,l,n)},s.prototype.qle=function(n,t,r,e){for(var i,o,u,a,f,l,c,s,v,h,d,b,i=this,o=i.Ky,u=i.iw,a=i.Sx,f=i.Tx,l={},c=i.jO?1:0,s=c+(i.oL?1:0),v=r.lv(t),h=0;h<f;h++)for(d=h+u,i.jO&&Kr(e,n,o,d,t,l,r,v,i),i.oL&&Kr(e,n,i.footerIndex(),d,t,l,r,v,i),b=0;b<a-s;b++)Kr(e,n,b+o+c,d,t,l,r,v,i)},s.prototype.E5t=function(n){var t=this,e=[];C(t.BSt,function(n,t){var r=t.dataField();r&&e.push({name:t.name(),value:t.value(),dataField:r})}),0<e.length&&(t.C5t=e,t.IBe(e,n))},s.prototype.Woe=function(n){var t,r,e,i,o,n,u,t=this,r=t.Mf,e=t.dataRange(),i=e.row,o=B(e),n=n.getRowCount();o<n?t.RSt?(t.cue=!0,r.addRows(i+o,n-o),r.recalcRange(i,e.col,o,e.colCount),delete t.cue):((u=r.H3)&&u.Ctt&&(u.Stt=!0),t.mTt=!0,0===o?t.zpt(i,n,E,!0,!0):t.zpt(i+o-1,n-o,!0,!0,!0),delete t.mTt):n<o&&(t.RSt?(r.deleteRows(i+n,o-n),r.recalcRange(i,e.col,o,e.colCount)):(t.mTt=!0,t.yE(i+n,o-n,!0),delete t.mTt))},s.prototype.D3=function(n){var t,r,e,i,o,u,a,a,f,l,c,s,v,h,r,t=this,r=t.autoGenerateColumns(),e=t.IB&&t.IB.srt;if(t.s5t(),(i=t.Mf).suspendCalcService(),i&&(o=t.dataRange(),u=i.Ut,r?u.f_e(o.row,o.col,B(o),D(o),17,3):C(t.BSt,function(n,t){var r;t.dataField()&&u.f_e(o.row,o.col+n,B(o),1,17,3)})),r&&(a=t.range(),t.d5(a.row,a.col,B(a),D(a)),t.l5t(a.col,D(a),!0)),r||t.E5t(n),n){if(a={row:t.Ky,col:t.iw,rowCount:t.Sx,colCount:t.Tx},t.Woe(n),t.H3=n,t.LSt&&t.NTr()&&t.LSt.c5(t.z3()),r){for(f=t.NTr(),l=void 0,t.wEr({colCount:n.getColumnCount()}),t.BSt=[],c=n.ltt(),s=0;s<t.Tx;s++)v=t.IEr(s),c&&(f&&(l=v.name()),v.name(c[s]),f&&t.I5t(l,v.name(),s),v.dataField(c[s]));t.ESt&&(t.OSt=[],t.j5t(t.iw),f)&&t.useFooterDropDownList()&&t.g5t()&&t.ZEr()}else h=[],t.BSt.forEach(function(n){var n=n.dataField();n&&h.push(n)}),n.htt(h);i&&((r=i.Ut).YSt(t,V,a,{row:t.Ky,col:t.iw,rowCount:t.Sx,colCount:t.Tx}),r.d3e(t.Ky,t.iw,t.Sx,t.Tx))}else t.H3=n;i.resumeCalcService(),t.IB&&(t.IB.Uct(t.dataRange()),t.IB.srt=e)},s.prototype.O5t=function(n){var t,r,e,r,n,i,o,u,t=this,r=t.H3;if(r&&(e=r.ltt())){if(r=n-t.startColumn(),n=t.BSt[r],t.NTr())return n!==E?r:-1;for(i=n&&n.dataField(),o=0,u=e.length;o<u;o++)if(e[o]===i)return o}return-1},s.prototype.XTr=function(n,t){var r=this,e=r.H3,n=n-r.WTr(),r=r.O5t(t);return e.e5t(n,r)},s.prototype.Sl=function(n,t){var r,e,i,o,n,t,t,t,r=!1,e=E,i=this,o=i.H3,n=n-i.WTr();return o&&n<o.getRowCount()&&0<=(t=i.O5t(t))&&(r=!0,e=o.getValue(n,t).value,t=i.BSt[t])&&(t=t.value())&&i.NTr()&&(e=t(o.ftt(n))),{e5t:r,y4:e}},s.prototype.Kbt=function(n,t,r,e){var i,o,u,a,f,l,a,e,c,c,e,i=this,o=i.H3,u=An(i,n),a=i.IB,l=!1;if(o&&0<=(f=i.O5t(t))){if(i.NTr()&&(i.KTr(t,f)||i.GGr(f)))return l;e&&a&&a.isRowFilteredOut(n)||(a=(e=o.getValue(u,f)).value,(c=(c=i.Mf)&&c.Ut)&&e.hasBinding&&a!==r&&(e=In(!0),i.R5t(n,u,e),c.B5t(i,n,A,e,jr.dirty),c.dE(n,t,{d6:a})),o.setValue(u,f,r,c&&c.G8),i.EAr()),l=!0}return i.DSt=!0,l},s.prototype.ML=function(n,t,r){var e=new L.Style;return this.h5(n,t,e,r),e},s.prototype.L5t=function(n){var t,r,e,t=this.jS.xl,r=t[n];return r===E&&(e=this.Mf,r=t[n]=e.getRowHeight(n)),r},s.prototype.F5t=function(n){var t;return this.Mf.getColumnWidth(n)},s.prototype.zye=function(n,t,r,e,i,o,u){var a,f,l,c,a=this,f=a.Mf,l;Vr(a.BSt,n-a.iw,f,t,r,e,!0,o,!0),r===st?c=a.Uye:r===ct?c=a.Gye:r===vt&&(c=a.Hye),(c=c&&("string"==typeof c&&f?f.u8(c):c))&&le(c,t,e,i,o,u)},s.prototype.h5=function(n,t,r,e){var i,o,u,a,f,l,c,s,v,h,d,b,w,m,c,g,y,p,a,a,a,a,f,a,f,a,b,g,w,y,C,S,l,T,_,R,x,j,e,i=this,o=i.getStyleOriginInstance(),u=i.Mf,a=i.headerIndex(),f=i.footerIndex(),l=i.jO,c=i.oL,s=l?n===i.Ky+1:n===i.Ky,v=c?n===i.Ky+i.Sx-2:n===i.Ky+i.Sx-1,h=t===i.iw,d=t===i.iw+i.Tx-1;if(a!==n&&f!==n?i.zye(t,r,ct,s,h,v,d):n===a?i.zye(t,r,st,!0,h,!0,d):n===f&&i.zye(t,r,vt,!0,h,!0,d),o){if(b=i.highlightLastColumn(),w=i.highlightFirstColumn(),m=l?n===a:n===i.Ky,c=c?n===f:n===i.Ky+i.Sx-1,g=o[mt](),y=o[gt](),p=new L.Style,a===n)a=o[_t](),d&&b&&a&&a.h5(p,!0,!0,!0,!0),a=o[Tt](),h&&w&&a&&a.h5(p,!0,!0,!0,!0),(a=o[dt]())&&a.h5(p,!0,h,!0,d),d&&b&&g&&g.h5(p,!0,!0,!1,!0),h&&w&&y&&y.h5(p,!0,!0,!1,!0);else if(f===n)a=o[xt](),d&&b&&a&&a.h5(p,!0,!0,!0,!0),f=o[Rt](),h&&w&&f&&f.h5(p,!0,!0,!0,!0),(a=o[bt]())&&a.h5(p,!0,h,!0,d),d&&b&&g&&g.h5(p,!1,!0,!0,!0),h&&w&&y&&y.h5(p,!1,!0,!0,!0);else{if(d&&b&&g&&g.h5(p,m,!0,c,!0),h&&w&&y&&y.h5(p,m,!0,c,!0),f=l?n-i.Ky-1:n-i.Ky,S=C=y=w=g=b=a=void 0,l=!e||"cellType"!==e&&"formatter"!==e,i.bandRows()&&l&&0<(b=(a=o[jt]())+o[Ot]())){if(void 0===(g=i.HSt[n])){if(L.Be.Fl&&L.Be.Gl){for(T=L.Be.Gl,_=i.dataRange().row;-1===T[_];)_++;if(n<_)return;f=T[n]-T[_]}else if(u){for(R=0,_=i.dataRange().row;_<n;_++)0<i.L5t(_)&&R++;f=R}g=i.HSt[n]=f%b}w=o[yt](),y=o[pt](),g<a&&w?w.h5(p,C=0===g,h,S=v||g===a-1,d):a<=g&&y&&y.h5(p,C=g===a,h,S=v||g===b-1,d)}if(i.bandColumns()&&l&&0<(b=(a=o[Ft]())+o[kt]())){if(void 0===(g=i.zSt[t])){if(x=0,u)for(j=i.iw;j<t;j++)0<i.F5t(j)&&x++;g=i.zSt[t]=x%b}w=o[Ct](),y=o[St](),g<a&&w?w.h5(p,s,C=0===g,v,S=d||g===a-1):a<=g&&y&&y.h5(p,s,C=g===a,v,S=d||g===b-1)}}(e=o[wt]())&&e.h5(p,m,h,c,d),i.P5t(r,p)}},s.prototype.i5t=function(n,t,r){var e,i,o,u,a,n,i,t,e=this,i=e.oL,o=e.ESt,u,a;e.footerIndex()===n&&i&&e.g5t()&&(n=e.OSt[t-e.iw])&&o&&(i=r.cellButtons,t=r.dropDowns,I(i)&&(i=[]),r.cellButtons=i.concat(n.cellButtons),I(t)&&(t=[]),r.dropDowns=t.concat(n.dropDowns))},s.prototype.P5t=function(n,t){var n=n,r=20,e,e,e,e;I(n.backColor)&&(n.backColor=t.backColor),Wn(n.foreColor)&&(n.foreColor=t.foreColor),I(n.themeFont)&&I(n._fontFamily)&&(n.themeFont=t.themeFont),I(n._fontFamily)&&(n._fontFamily=t._fontFamily),Wn(n._fontSize)&&(n._fontSize=t._fontSize,n._fontSizeDigit=t._fontSizeDigit,n._fontSizeUnit=t._fontSizeUnit),Wn(n._fontStyle)&&(n._fontStyle=t._fontStyle),Wn(n._fontWeight)&&(n._fontWeight=t._fontWeight),n._fontVariant===E&&(n._fontVariant=t._fontVariant),n._fontStretch===E&&(n._fontStretch=t._fontStretch),n._lineHeight===E&&(n._lineHeight=t._lineHeight),n._font=Rr(n._fontStyle,n._fontWeight,n._fontSize,n._fontFamily,n._fontVariant,n._fontStretch,n._lineHeight),I(n.borderLeft)&&(e=t.borderLeft,n.borderLeft=e&&e.Gf()||e,n.borderLeft)&&(n.borderLeft.level=20),I(n.borderTop)&&(e=t.borderTop,n.borderTop=e&&e.Gf()||e,n.borderTop)&&(n.borderTop.level=20),I(n.borderRight)&&(e=t.borderRight,n.borderRight=e&&e.Gf()||e,n.borderRight)&&(n.borderRight.level=20),I(n.borderBottom)&&(e=t.borderBottom,n.borderBottom=e&&e.Gf()||e,n.borderBottom)&&(n.borderBottom.level=20),I(n.textDecoration)&&(n.textDecoration=t.textDecoration),I(n.cellType)&&(n.cellType=t.cellType),I(n.formatter)&&(n.formatter=t.formatter)},s.prototype.G5t=function(n,t){var r,e,i,o,u,a,r=this;if((n!==r.Ky||t!==r.iw)&&(e=r.Mf)){if((n<0||e.getRowCount()<n+r.Sx||t<0||e.getColumnCount()<t+r.Tx)&&N(H().Exp_TableMoveOutOfRange),u=o=void 0,i=r.jS)for(u=0,a=(o=i.U3).length;u<a&&o.get(u)!==r;u++);e.moveTo(r.Ky,r.iw,n,t,r.Sx,r.Tx,3),o&&u<=a&&r.H5t(n,t),this.cL(1)}},s.prototype.H5t=function(n,t){var r,e,r=this,e=r.Mf;e&&e.Ut.YSt(r,V,{row:r.Ky,col:r.iw,rowCount:r.Sx,colCount:r.Tx},{row:n,col:t,rowCount:r.Sx,colCount:r.Tx}),r.wEr({row:n,col:t}),r.V5t(),r.dl()},s.prototype.U5t=function(n,t){var r,e,i,o,u,a,f,l,c,s,v,h,d,b,w,m,r=this,e=r.Mf;if(e&&g)for(i=r.BSt,o=r.footerIndex(),u=r.range(),f=(a=r.dataRange()).row,l=B(a),I(n)&&(n=0,t=i.length);n<t;n++)if(c=i[n],s=u.col+n,c){for(c.footerFormula()&&0<=o&&(S(e,o,s,A),gn(e,o,s,A)),v=c.x5t(),h=Jn(v),b=d=void 0,w=0;w<l;w++)d=e.getFormula(b=f+w,s),I(d)||(I(r.Y5t)&&(r.Y5t=[]),r.Y5t.push({row:b,col:s,formula:d})),I(d)||!I(h)&&z(e,Tn(e,h,r.Ky,s,E,E,r),b,s)===d||(I(r.Z5t)&&(r.Z5t=[]),m=Pn(r.Z5t,s),I(m)?((m={}).col=s,m.rowIndexes=[],m.rowIndexes.push(b),r.Z5t.push(m)):m.rowIndexes.push(b));if(c.x5t(E),c.dataAreaFormula())for(w=0;w<l;w++)S(e,b=f+w,s,A),gn(e,b,s,A)}},s.prototype.z5t=function(){},s.prototype.tUr=function(){var n=this,t=n.Mf;n.NTr()&&t&&t.tables&&t.tables.tUr()},s.prototype.K5t=function(n,t,r){var e,i,o,u,a,f,l,c,s,v,h,d,b,w,m,h,g,y,p,C,S,T,e,_,R,R,x,j,c,e,_,R,v,S,h,e,c,O,O,c,h,i=this,o=i.dataRange();if(!n.equals(i.range())){if(u=n.row,a=n.col,f=B(n),l=D(n),c=i.jO,s=i.oL,v=i.ESt,h=0,d=1,c&&(h+=1),s&&(h+=1),(m=i.Mf)&&((f<h||l<1||u+f>m.getRowCount()||a+l>m.getColumnCount())&&N(H().Exp_TableResizeOutOfRange),u===i.Ky&&n.intersect(i.Ky,i.iw,i.Sx,i.Tx)||N(H().Exp_TableResizeInvalidRange),w={row:i.Ky,col:i.iw,rowCount:i.Sx,colCount:i.Tx},b=i.BSt.slice()),h=i.BSt,y=(g=a)+l-1,p=i.iw,C=i.iw+i.Tx-1,S=i.Tx,T={col:a,rowCount:A,colCount:l},i.wEr({col:a,colCount:l}),e=i.layoutStyle(),_=w.row===i.headerIndex()?w.row+1:w.row,R=(R=w.row+w.rowCount-1)===i.footerIndex()?R-1:R,g<p){for(x=0,j=g;j<p;j++)i.IEr(x,E,!t),x++;c&&i.a5t(0,p-g,E,E,!0),s&&i.l5t(0,p-g,E,!0),w&&e.data&&ie(m,_,g,R,p-1,i)}else g<=C&&(i.U5t(p,g),i.iGe(0,g-p,!t));if(C<y){for(j=1+C;j<=y;j++)i.IEr(E,E,!t);c&&i.a5t(S,y-C,E,E,!0),s&&i.l5t(S,y-C,E,!0),w&&e.data&&ie(m,_,1+C,R,y,i),v&&i.j5t(S)}else p<=y&&(i.U5t(y,C),i.iGe(h.length-(C-y),C-y,!t));f!==i.Sx&&(c=i.H3,_=(e=i.dataRange()).row,R=B(e),c?f>i.Sx?(v=_+R-1,S=f-i.Sx,m&&(h=i.NTr(),e=!1,(O=kn(m,new L.Range(c=v+S+1,g,m.getRowCount()-c,y)))&&O.row<c||(i.N4t(v,S,!0,!1,A,A,t,r),h&&(e=!0)),h&&e&&v++,ie(m,v,g,v+S-1,y,i))):m&&(O=i.Sx-f,i.yE(_+R-O,O,E,t,r)):(c=void 0,s&&(i.l5t(),c=i.footerIndex(),i.eTt=!0,i.u5t(c),delete i.eTt),h=i.Sx,i.wEr({rowCount:T.rowCount=f}),w&&(w.row>n.row&&ie(m,n.row,g,w.row-1,y,i),w.row+w.rowCount-1<n.row+n.rowCount-1)&&ie(m,w.row+w.rowCount,g,n.row+n.rowCount-1,y,i),i.J5t(w.row+h-(s?1:0),f-h,h<f),s&&i.w5t())),m&&(m.Ut.YSt(i,V,w,{row:i.Ky,col:i.iw,rowCount:i.Sx,colCount:i.Tx}),m.Ut.YSt(i,ir,b,i.BSt.slice())),i.dl(),i.V5t(!1),i.X5t(o,i.dataRange(),r),(g!==p||y<C)&&this.ccr(m),i.jS.ssr(),null!=(e=null==m?void 0:m.oMt)&&e.gF(u,a,f,l),i.cL(0)}},s.prototype.ccr=function(n,t){var r,i,n,i=this,n=yn(n);null!=(r=this.aT)&&r.forEach(function(n,t){var r,e;t.ubt&&(r=i.x0r(t.ubt)),t.sbt&&(e=i.x0r(t.sbt)),-1===r||-1===e?n.forEach(function(n){n.r_t(),n.vyt()}):n.forEach(function(n){n.vyt()})}),i.jS.ssr(),t||n.onAfterChangeTableColumn()},s.prototype.X5t=function(n,t,r){var e,i,r,o,u,a,f,l,n,c,t,s,e,i=this.LSt;i&&!r&&(r=n.col,o=B(n),u=D(n),a=t.col,f=B(t),l=D(t),n=n.row+o,c=r+u,s=a+l,(t=t.row+f)<n&&i.onRowsRemoved(f,n-t),n<t&&i.onRowsAdded(o,t-n),r<a&&i.onColumnsRemoved(0,a-r),s<c&&i.onColumnsRemoved(l,c-s),a<r&&i.onColumnsAdded(0,r-a),c<s)&&i.onColumnsAdded(r+u-a,s-c)},s.prototype.V5t=function(n){var t=this,r=t.IB;r&&(r.Uct(t.dataRange()),!1!==n)&&r.reFilter()},s.prototype.s5t=function(){var n=this.IB;n&&(n.unfilter(),n.reset())},s.prototype.cSt=function(n,t){var r,e;for(n!==A&&(n=$(n)),r=0;r<this.Tx;r++)if(r!==t&&n===(e=this.getColumnName(r)))return!0;return!1},s.prototype.vUr=function(n,t){for(var r,e,r=t+1;r<this.Tx;r++)if(n===(e=this.getColumnName(r)))return r;return-1},s.prototype.q5t=function(n){var t,r,n,t,r,t=this,r=t.BSt;return t.jO&&r&&0<=(n=n-t.iw)&&n<r.length&&(t=r[n])?(r=t.name(),I(r)?r:$(r)):A},s.prototype.$5t=function(n,t){var r,e,i,n,i,e,o,r=this,e=r.BSt;r.jO&&e&&(i=e.length,0<=(n=n-r.iw))&&n<i&&(i=e[n])&&(e=i.name(),(o=r.Mf)&&t!==e&&o.Ut.A5t(r,i,"name",e,t),i.name(t),r.NTr()&&!I(o.Ut.P8)&&0<o.Ut.P8&&r.setColumnDataField(n,t),r.I5t(e,i.name(),n))},s.prototype.m5t=function(n,t,r){var e,i,o,u,a,i,n,e=this,i=e.BSt,o=e.footerIndex(),u=e.iw+n,a=e.Mf;g&&0<=n&&n<i.length&&(i=i[n],t&&!r&&a&&(r=Tn(a,t,o,u),e.oL)&&S(a,o,u,t,r),i)&&(n=i.footerFormula(),a&&r!==n&&a.Ut.A5t(e,i,"footerFormula",n,t),i.footerFormula(r))},s.prototype.d5t=function(n,t,r){var e,i,r,i,r,o,e=this,i=e.BSt;(r||e.oL)&&i&&0<=(r=n-e.iw)&&r<i.length&&(i=i[r])&&(r=i.footerValue(),(o=e.Mf)&&o.EB||(t!==r&&o&&(o.Ut.A5t(e,i,"footerValue",r,t),o.Ut.dE(e.Ky+e.Sx-1,n,{d6:i.footerValue()})),i.footerValue(t)))},s.prototype.M5t=function(){for(var n,t,r,e,i,n=this.BSt,t=n&&n.length,r=[],i=0;i<t;i++)(e=n[i])&&e.tTt()&&r.push(e.id());if(r.sort(function(n,t){return n-t}),0<(t=r.length)){for(i=0;i<t;i++)if(r[i]!==i+1)return i+1;return t+1}return 1},s.prototype.gUr=function(n,t){var r,e,i,o,u,a,r=this;I(t)?r.$5t(n,t):(i=n-(e=r.iw),o=$(t),a=void 0,-1===(u=r.vUr(o,i))?(a=r.nTt(o,i),r.$5t(n,a)):(r.$5t(n,t),a=r.nTt(o,u),r.$5t(u+e,a)))},s.prototype.nTt=function(n,t){var r,e,i,t;if(!I(n)&&!this.cSt(n,t))return n;if(e=At,i=0,n)e=n,i=1;else if(0<t&&(n=this.BSt[t-1].name(),t=/[0-9]+$/.exec(n))){if(e=n.substr(0,t.index),i=parseInt(n.substr(t.index),10),!this.cSt(r=e+(i+1)))return r;e=n,i=1}for(;;)if(!this.cSt(r=e+ ++i))return r},s.prototype.a5t=function(n,t,r,e,i){var o,u,a,f,o,l,c,s,v,h,d,b,w,m,w,u=this,a=u.BSt,f=u.Mf;if(u.jO&&a&&f)for(o=a.length,l=u.headerIndex(),c=u.iw,I(n)&&(n=0),I(t)&&(t=o),v=U(o,n+t),d=null==(o=u.layoutStyle())?void 0:o.header,b=n;b<v;b++)(s=a[b])&&(-1<(m=(w=u.jS.U3).indexOf(u))&&w.splice(m,1),h=$n(f.getValue(l,c+b)),-1<m&&w.splice(m,0,u),S(f,l,c+b,A),h&&(r?(u.eTt=r,f.setText(l,c+b,s.name()),delete u.eTt):((w=e?h:u.nTt(h,b))===h?(f.Ut.A5t(u,s,"name",s.name(),h),s.name(h)):f.setText(l,c+b,w),g&&f.gL(l,c+b))),i)&&ee(f,l,c+b,d)},s.prototype.j5t=function(n){for(var t,r,e,i,t=this.BSt,r=this.Mf.options.rightToLeft?L.ButtonPosition.left:L.ButtonPosition.right,e=n;e<t.length;e++)i=Er(this.name(),t[e].name(),r),this.OSt.push(i)},s.prototype.l5t=function(n,t,r,e){var i,o,u,a,i,f,l,c,s,v,h,d,b,v,h,w,o=this,u=o.BSt,a=o.Mf;if(o.oL&&u&&a)for(o.useFooterDropDownList()&&!o.g5t()&&o.h5t(),i=u.length,f=o.footerIndex(),l=o.iw,I(n)&&(n=0),I(t)&&(t=i),I(r)&&(r=o.iTt),s=U(i,n+t),d=null==(i=o.layoutStyle())?void 0:i.footer,b=n;b<s;b++)(c=u[b])&&(h=a.getValue(f,l+b),I(h)||r?(o.eTt=r,gn(a,f,l+b,c.footerValue()),delete o.eTt):(h!==(v=c.footerValue())&&a.Ut.A5t(o,c,"footerValue",v,h),c.footerValue(h)),(v=a.bMt&&a.bMt(f,l+b))&&!r?(v!==(h=c.dataAreaFormula())&&(w=z(a,v,f,l+b),a.Ut.A5t(o,c,"dataAreaFormula",h,w)),c.footerFormula(v)):o.rTt||(o.eTt=r,S(a,f,l+b,A,c.footerFormula()),delete o.eTt),e)&&ee(a,f,l+b,d)},s.prototype.oTt=function(n,t){var r,e,i,o,u,a,f,l,r=this,e=r.BSt;if(r.jO&&e)for(i=e.length,I(n)&&(n=0),I(t)&&(t=i),u=U(i,n+t),a=n;a<u;a++)(o=e[a])&&(f=o.name(),(l=r.Mf)&&f!==A&&l.Ut.A5t(r,o,"name",f,E,r._Be?a:E),o.name(A),r.I5t(f,o.name(),a))},s.prototype.aTt=function(n){var t,r,e,i,o,u,a,f,l,n,t=this,r=t.dataRange();if(r.containsRange(n)){for(e=n.row,i=n.col,o=B(n),u=D(n),a=[],f=0;f<o;f++)for(l=0;l<u;l++)t.Kbt(e+f,i+l,A,!0),a.push({columnName:t.getColumnName(i+l-r.col),row:e+f-r.row,data:""});(n=t.LSt)&&n.onDataChanged(a)}},s.prototype.uTt=function(n,t){var r,e,i,o,u,a,f,f,r=this,e=r.BSt;if(r.oL&&e)for(I(n)&&(n=0),I(t)&&(t=e.length),o=U(e.length,n+t),u=n;u<o;u++)(i=e[u])&&(a=r.Mf,f=i.footerFormula(),a&&A!==f&&a.Ut.A5t(r,i,"footerFormula",f),i.footerFormula(A),f=i.footerValue(),a&&A!==f&&a.Ut.A5t(r,i,"footerValue",f),i.footerValue(A))},s.prototype.w5t=function(){var n,t,r,e,i,o,u,a,f,n=this,t=n.BSt;if(n.oL&&t&&(r=n.Mf))for(e=t.length,o=n.iw,a=n.footerIndex(),f=0;f<e;f++)(i=t[f])&&(gn(r,a,u=o+f,i.footerValue()),S(r,a,u,A,i.footerFormula()))},s.prototype.u5t=function(n){var t,r,e,i,o,u,t=this,r=t.Mf;if(r&&!(n<0||r.getRowCount()<=n))for(e=t.iw,i=t.Tx,u=0;u<i;u++)S(r,n,o=e+u,A),gn(r,n,o,A),r.removeSparkline(n,o)},s.prototype.msr=function(n,t,r){var e,i,o,u,a,f,l,c,o,c,s,o,r,a,e=this,i=!1,o=e.cue?1:0,u;return!((!e.jO||1!==e.Sx)&&n>=e.Ky+e.Sx+o)&&((a=e.Mf)&&(f=a.Ut,l={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),e.sTt(n,t,!1),c=e.Ky,o=e.Ky+e.Sx-1+o,n<=c&&!e.cue?e.wEr({deltaRow:t}):n<=o&&(r||(i=e.cTt(n,t)),e.wEr({deltaRowCount:t})),a&&f.YSt(e,V,l,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),e.NTr()&&f.B5t(e,n,t,In(!0),jr.dirty),c=e.LSt,o=(s=e.dataRange()).row,r=e.endRow(),o<=n&&n<=r&&c&&c.onRowsAdded(n-o,t),(a=e.IB)&&(e.DSt=!0,a.Qct(n,t),e.lTt)&&e.Mf.filterRowsVisibleInfo.rE(n,t),i)},s.prototype.JO=function(n,t,r,e,i,o){var u,a,r,f,l,c,s,o,r,u=this,a=!1,r=r?1:0,f=u.jO&&1===u.Sx;return!f&&n>=u.Ky+u.Sx+r||((l=u.Mf)&&(c=l.Ut,s={row:u.Ky,col:u.iw,rowCount:u.Sx,colCount:u.Tx}),o||u.sTt(n,t,!1),o=u.Ky,r=u.Ky+u.Sx-1+r,n<=o&&!i?u.wEr({row:u.Ky+t}):(n<=r||f)&&(e||(a=u.cTt(n,t)),u.wEr({rowCount:u.Sx+t})),l&&c.YSt(u,V,s,{row:u.Ky,col:u.iw,rowCount:u.Sx,colCount:u.Tx}),u.NTr()&&c.B5t(u,n,t,In(!0),jr.dirty)),a},s.prototype.t5t=function(n,t,r,e){var e,i,r,o,i,u,u;e||(i=(e=this).Ky+e.Sx-1,!r&&n>=e.Ky&&n<=i&&e.J5t(n,t,!0),r=e.LSt,i=(o=e.dataRange()).row,u=e.endRow(),i<=n&&n<=u&&r&&r.onRowsAdded(n-i,t),(u=e.IB)&&(e.DSt=!0,u.Qct(n,t),e.lTt)&&e.Mf.filterRowsVisibleInfo.rE(n,t))},s.prototype.cTt=function(n,t){var r,e,i,i,o,r=this,e=r.H3;return!!e&&(o=void 0,(i=(i=this.Mf)&&i.Ut.G8)&&!(o=i.tableChanges)&&(i.tableChanges=o=[]),e.kE(An(r,n),t,o),!0)},s.prototype.gsr=function(o,u){var a,f,l,c;g&&(f=(a=this).Mf,l=a.NTr(),c=!1,C(a.BSt,function(n,t){var r,e,i,r=t.dataAreaFormula();if(r)if(l)c=!0,a.nGr(n,t);else for(e=n+a.iw,i=o;i<o+u;i++)o<=i&&i<o+u&&S(f,i,e,A,r)}),l)&&c&&a.EAr()},s.prototype.nGr=function(n,t,r,e){var i,o;this.z3().EGr(n,{formula:be(e||t.x5t()),expr:r||t.dataAreaFormula()})},s.prototype.tGr=function(n,t){var r=this,e;return!(!n.dataAreaFormula()||!r.NTr()||(r.nGr(r.AAr(t),n),r.EAr(),0))},s.prototype.csr=function(n,t,r,e,i){var o,u,a,f,o=this,u=o.Ky+o.Sx-1,a=e.dataAreaFormula();if(t>=o.Ky&&t<=u&&!o.tGr(e,i))for(f=t;f<t+r;f++)t<=f&&f<t+r&&S(n,f,i,A,a,!0)},s.prototype.J5t=function(o,u,a,n){var f,l,n;!g||n||(l=(f=this).Mf,n=f.dataRange(),f.NTr())||(I(o)&&(o=n.row),I(u)&&(u=n.rowCount),pn(l),C(f.BSt,function(n,t){var r,e,i,r=t.dataAreaFormula();if(r)for(e=n+f.iw,i=o;i<o+u;i++)(a&&o<=i&&i<o+u||!I(l.getValue(i,e))&&l.getFormula(i,e)===z(l,r,i,e))&&S(l,i,e,A,r)}),Cn(l,!1))},s.prototype.LAr=function(n,t){var r,n,e,r,e=this,r=e.H3;r&&r.DTr()&&(I(n.dataField())&&n.dataField(n.name()),r.qFe(me(n),t,null==(n=null==(r=e.Mf)?void 0:r.Ut)?void 0:n.G8))},s.prototype.qO=function(n,t,r,e,i){var o,r,u,a,f,l,c,s,v,h,d,b,b,i,o=this,r=r?1:0;if(!(n>=o.iw+o.Tx+r)){if(a=o.iw,(c=o.Mf)&&(l={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},f=o.BSt.slice()),n<=o.iw&&!i)o.wEr({col:o.iw+t});else if(n<o.iw+o.Tx+r&&(u=!0,o.wEr({colCount:o.Tx+t}),s=o.BSt)){for(v=n-o.iw,h=0;h<t;h++)b=o.nTt(A,d=v+h),o.IEr(d,b,!0),b=o.getColumnName(d),o.y5t(d,0,b);e&&o.a5t(v,E,!0,!1)}o.IB&&o.IB.Jct(n,t,u),a<=n&&(i=o.LSt)&&i.onColumnsAdded(n-a,t),c&&(c.Ut.YSt(o,V,l,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx}),c.Ut.YSt(o,ir,f,o.BSt.slice())),this.ccr(c,!0)}},s.prototype.xP=function(n,t,r){var e,i,o,u,a,f,r,l,c,l,s,v,h,d,h,b,w,m,g,y,p,h,C,S,T,e=this,i=!1;if(!(n>=e.Ky+e.Sx)){if(o=(r=r||{}).ignoreUpdateDataSource,u=r.key,a=r.isInitBinding,f=r.fromSheetRemoved,r=r.ignoreSlicerWhenFilter,c=(l=e.dataRange()).row,l=B(l),s=e.Ky,v=e.Ky+e.Sx-1,h=e.Mf,d=e.H3,m=[],y="_backupRowsChange",h&&(b=h.Ut)&&(g={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},m.push(V),h=b.G8)&&!(w=h.tableChanges)&&(h.tableChanges=w=[]),a||e.sTt(n,t,!0),n<s?n+t<=s&&e.wEr(f?{deltaRow:-t}:{row:e.Ky-t}):n===s?e.jO||(p=U(v-n+1,t),e.wEr(f?{deltaRowCount:-p}:{rowCount:e.Sx-p}),!o&&d&&(m.push(y),d.btt(An(e,n),U(v-n+1,t),w),i=!0)):n<=v&&(p=U(v-n+1,t),e.wEr(f?{deltaRowCount:-p}:{rowCount:e.Sx-p}),!o&&d&&(m.push(y),d.btt(An(e,n),U(v-n+1,t),w),i=!0),n===v)&&e.oL&&(m.push(er),e.SEr(!1)),e.IB&&(e.DSt=!0,e.IB.Kct(n,t)),!r&&c<=n&&n<c+l&&(h=e.LSt)&&h.onRowsRemoved(n-c,t),b&&m&&0<m.length)for(C=0,S=m;C<S.length;C++)switch(T=S[C]){case V:b.YSt(e,V,g,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx});break;case er:b.YSt(e,er,e.oL);break;case y:b.B5t(e,n,t,u,jr.deleted)}e.jS.ssr()}return i},s.prototype.FAr=function(n,t){for(var r=n+t-1;n<=r;r--)this.BAr(r)},s.prototype.BAr=function(n){var t,n,r,t,r=this,t=r.H3;t&&t._Tr()&&t.iGe(n,null==(n=null==(t=r.Mf)?void 0:t.Ut)?void 0:n.G8)},s.prototype.NP=function(n,t){var r,e,i,o,u,a,f,l,c,a,r=this;n>=r.iw+r.Tx||((e=r.Mf)&&(i={row:r.Ky,col:r.iw,rowCount:r.Sx,colCount:r.Tx},o=r.BSt.slice()),u=r.iw,a=r.iw,f=r.iw+r.Tx-1,n<a?n+t<=a?l=r.iw-t:(c=r.Tx-((l=n)+t-a),r.iGe(0,n+t-a,!0)):(c=r.Tx-U(f-n+1,t),r.iGe(n-a,U(f-n+1,t),!0)),r.wEr({col:l,colCount:c}),r.IB&&r.IB.Xct(n,t),u<=n&&(a=r.LSt)&&a.onColumnsRemoved(n-u,t),e&&(e.Ut.YSt(r,V,i,{row:r.Ky,col:r.iw,rowCount:r.Sx,colCount:r.Tx}),e.Ut.YSt(r,ir,o,r.BSt.slice())),this.ccr(e))},s.prototype.vsr=function(n,t){var r,e,i,o,u,a,f,l,c,s,v,f,r=this;n>=r.iw+r.Tx||((e=r.Mf)&&(i={row:r.Ky,col:r.iw,rowCount:r.Sx,colCount:r.Tx},o=r.BSt.slice()),u=r.iw,a=r.iw,f=r.iw+r.Tx-1,s={},n<a?n+t<=a?(l=u-t,s.deltaCol=-t):(c=r.Tx-(v=n+t-a),s.deltaCol=(l=n)-u,s.deltaColCount=-v,r.iGe(0,v,!0)):(v=U(f-n+1,t),c=r.Tx-v,s.deltaColCount=-v,r.iGe(n-a,v,!0)),r.wEr(s),r.IB&&r.IB.Xct(n,t),u<=n&&(f=r.LSt)&&f.onColumnsRemoved(n-u,t),e&&(e.Ut.YSt(r,V,i,{row:r.Ky,col:r.iw,rowCount:r.Sx,colCount:r.Tx}),e.Ut.YSt(r,ir,o,r.BSt.slice())),this.ccr(e,!0))},s.prototype.d5=function(n,t,r,e){var i,o,u,a,a,f,l,c,s,v,v,h,v,v,v,a,i=this,o=r,u=e,a=i.Mf;a&&(o=a.getRowCount(),u=a.getColumnCount()),s=(0,L.Ec)(a=n<0?0:n,f=t<0?0:t,l=n<0?o:r,c=t<0?u:e),v=i.headerIndex(),i.jO&&a<=v&&v<a+l&&(v=(0,L.Ec)(v,i.iw,1,i.Tx),h=s.getIntersect(v,o,u))&&i.oTt(h.col-i.iw,D(h)),v=i.dataRange(),(v=s.getIntersect(v,o,u))&&i.aTt(v),v=i.footerIndex(),i.oL&&a<=v&&v<a+l&&(a=(0,L.Ec)(v,i.iw,1,i.Tx),h=s.getIntersect(a,o,u))&&i.uTt(h.col-i.iw,D(h)),i.IB&&i.IB.d5(n,t,r,e)},s.prototype.toJSON=function(n,t,r){var n,e,i,o,i,u,a,f,e,l,c,s,v,h,d,b,w,o=this,i=o.style(),u=o.rowFilter(),a="columns",f="__ID__";for(I(n)?e=o.name():o.Gwt=e=n,l={name:[e,A],row:[o.Ky,-1],col:[o.iw,-1],rowCount:[o.Sx,-1],colCount:[o.Tx,-1],showHeader:[o.jO,!0],showFooter:[o.oL,!1],useFooterDropDownList:[o.ESt,!1],showResizeHandle:[o.showResizeHandle(),!1],highlightFirstColumn:[o.highlightFirstColumn(),!1],highlightLastColumn:[o.highlightLastColumn(),!1],bandRows:[o.bandRows(),!0],expandBoundRows:[o.expandBoundRows(),!1],bandColumns:[o.bandColumns(),!1],style:[null!=(n=o.getStyleName()||(null==i?void 0:i.toJSON()))?n:A,A],autoGenerateColumns:[o.autoGenerateColumns(),!0],bindingPath:[o.bindingPath(),E],dataManagerTableBinding:[o.NTr()?null==(e=o.z3())?void 0:e.tableName:"string"==typeof o.cUr?o.cUr:E,E],dataManagerViewBinding:[o.NTr()?null==(i=o.z3())?void 0:i.name:E,E],rowFilter:[u?u.toJSON():A,A],reservedElement:[Gr(o.dTt),A],allowAutoExpand:[o.VSt,!0],headerStyle:[o.Uye&&o.Uye.toJSON?o.Uye.toJSON():o.Uye,E],dataStyle:[o.Gye&&o.Gye.toJSON?o.Gye.toJSON():o.Gye,E],footerStyle:[o.Hye&&o.Hye.toJSON?o.Hye.toJSON():o.Hye,E],columns:[[]]},c=0;c<o.BSt.length;c++)v=(s=o.BSt[c].toJSON(t))[Mt],h=s[Bt],v&&(t&&t.ignoreFormula?(delete s[Mt],s[Dt]=o.Mf.getValue(o.Ky+o.Sx-1,o.iw+c)):s[Mt]=z(o.Mf,v,o.footerIndex(),c+o.iw)),h&&(s[Bt]=z(o.Mf,h,o.dataRange().row,c+o.iw,!r&&E)),l[a][0][c]=s;for(b in l[a][1]=A,d={},l)(w=l[b])[0]!==w[1]&&(d[b]=w[0]);return null!=t&&t.isServer&&(d[f]=o.jKe()),(null==t?void 0:t.cb)===L.OpenSaveFileType.excel&&(d.tempTableWhenExport=o.FGr),W(d)?E:d},s.prototype.wh=function(n,t,r,e,i){var o,i,u,a,f,l,o,c,s,v,h,r,d,b,w,m,g,y,p,C,S,S,C,i,T,_,R,o,i,l,r,x,j,u=this,a=u.Mf,f=a.name(),l=u.style(),o=u.rowFilter(),c=u.BSt,s=r.styleManager,v=r.sharedStrings,h=!L.Util.ko(e);if(n.xmlns=L.XFileConstants.Qu,n.id=u._id,n.c_=[],n.n_=L.XFileConstants.du,(r=u.name()||A)&&(r=r.split(" ").join("_"),n.name=r,n.displayName=Qr(r.split("-").join("_"),i)),n.ref=qn([u.range()]),!0!==u.jO&&(n.headerRowCount=0),!1!==u.oL&&(n.totalsRowCount=1),o&&!a.NMi&&o.wh(n,s,e),c&&0<c.length){for(d=[],b=u.footerIndex(),w=u.dataRange().row,m=u.iw,y=g=void 0,p=0;p<c.length&&!(h&&p>=u.Tx);p++)S=(C=c[p]).name(),y=p+u.iw,u.jO&&!I(S)&&(I(g)&&(g=wn(t,f)),mn(g,u.Ky,y,""+S,v)),d.push(C.wh(a,u,w,b,p+m,e,S={},s,u.jO)),C=S.v,u.oL&&!I(C)&&(I(g)&&(g=wn(t,f)),mn(g,u.Ky+u.Sx-1,y,""+C,v));e&&e.fileType===L.OpenSaveFileType.excel&&g&&g.colCount<y+1&&(g.colCount=y+1),i={n_:"tableColumns",count:c.length,c_:d},n.c_.push(i)}l&&(T=(_=u.getStyleName())?l.builtInName()?"TableStyle"+l.builtInName():l.name():Zr(R=a.getParent(),r)),o=u.Gye,I(o)||("string"==typeof o?n.dataCellStyle=o:(n.dataDxfId=s.getDxfIndex(o),o.parentName&&(n.dataCellStyle=o.parentName))),i=u.Uye,I(i)||("string"==typeof i?n.headerRowCellStyle=i:(n.headerRowDxfId=s.getDxfIndex(i),i.parentName&&(n.headerRowCellStyle=i.parentName))),l=u.Hye,I(l)||("string"==typeof l?n.totalsRowCellStyle=l:(n.totalsRowDxfId=s.getDxfIndex(l),l.parentName&&(n.totalsRowCellStyle=l.parentName))),(r={n_:"tableStyleInfo",name:fn(T)}).showFirstColumn=!1!==u.highlightFirstColumn()?"1":"0",r.showLastColumn=!1!==u.highlightLastColumn()?"1":"0",r.showRowStripes=!0!==u.bandRows()?"0":"1",r.showColumnStripes=!1!==u.bandColumns()?"1":"0",n.c_.push(r),x={useFooterDropDownList:[u.ESt,!1],showResizeHandle:[u.showResizeHandle(),!1],expandBoundRows:[u.expandBoundRows(),!1],autoGenerateColumns:[u.autoGenerateColumns(),!0],bindingPath:[u.bindingPath(),E],dataManagerTableBinding:[u.NTr()?null==(o=u.z3())?void 0:o.tableName:"string"==typeof u.cUr?u.cUr:E,E],dataManagerViewBinding:[u.NTr()?null==(i=u.z3())?void 0:i.name:E,E],extLst:[u.dTt,A],allowAutoExpand:[u.VSt,!0]},j=n.lossless={},Object.keys(x).forEach(function(n){var t=x[n];t[0]!==t[1]&&(j[n]=t[0])})},s.prototype.fromJSON=function(r,n,t,e,i){var o,u,a,o,f,l,u,o,u,c,a,o,u,c,a,o,u,s,c,a,o,u,c,a,s,o,u,c,a,v,h,d,b,w,m,g,y,o,s,u,e;if(r){if(null!=(u=null==(o=(l=(f=this).Mf).parent)?void 0:o.suspendOp)&&u.call(o),C([tt,ot,ut,at,ft,lt],function(n,t){F(r[t])&&f[t](r[t],!1)}),(u=r.__ID__)&&f.UKn(u),o=r.row,F(o)&&(f.Ky=o),u=r.col,F(u)&&(f.iw=u),c=r.rowCount,F(c)&&(f.Sx=c),a=r.colCount,F(a)&&(f.Tx=a),Le(l,new L.Range(o,u,c,a))&&(l.rowFilter().reset(),l.rowFilter(void 0)),o=r.showHeader,F(o)&&(f.jO=o),u=r.showFooter,F(u)&&(f.oL=u),c=r.expandBoundRows,F(c)&&(f.RSt=c),a=r.useFooterDropDownList,F(a)&&(f.ESt=a),o=r.showResizeHandle,F(o)&&f.showResizeHandle(o),u=r.headerStyle,F(u)&&(R(u)?f.Uye=u:((s=new L.Style).fromJSON(u,E,E),f.Uye=s)),c=r.dataStyle,F(c)&&(R(c)?f.Gye=c:((s=new L.Style).fromJSON(c,E,E),f.Gye=s)),a=r.footerStyle,F(a)&&(R(a)?f.Hye=a:((s=new L.Style).fromJSON(a,E,E),f.Hye=s)),(o=r.style)&&(u=void 0,"string"==typeof o?u=o:o.buildInName?u=o.buildInName:(u=new p.TableTheme).fromJSON(o,n),f.style(u)),c=r.dataSource,a=r.dataBinding,s=r.bindingPath,n?(c&&O.$$&&(f.H3=new O.$$,f.H3.bind(c)),a&&O.$$&&(f.H3=new O.$$,f.H3.fromJSON(a))):s&&(f.S5t=s,o=l&&l.getDataSource&&l.getDataSource(),O.CellBindingSource)&&o instanceof O.CellBindingSource&&(u=(0,O.q$)(o.getSource(),s))&&(f.H3=new O.$$,f.H3.bind(u)),c=!1,e&&r.dataManagerTableBinding&&(c=!0),!e&&r.dataManagerTableBinding&&l&&O.$$&&(f.H3||(f.H3=new O.$$),f.DAr(r),f.showResizeHandle(!1)),a=r.columns){for(h=(v=a).length,w=b=d=void 0,m=0;m<h;m++)w=v[m],d=new J,b=f.IEr(),d.fromJSON(w),te(l,f,d,b,m),g=b.name(),(y=f.nTt(g,m))!==g&&f.setColumnName(m,y);f.vTt()}f.ESt&&f.h5t(!0),(o=r.rowFilter)&&(s=j.WSt&&new j.WSt)&&(s.table(f),s.fromJSON(o,n),f.IB=s,t?f.IB.reFilter():(f.DSt=!0,f._St(),f.NTr()||c||f.IB.Mke())),(u=r.reservedElement)&&(f.dTt=u),e=r.allowAutoExpand,F(e)&&(f.VSt=e),i&&(f.FGr=r.tempTableWhenExport),null!=(o=null==(a=l.parent)?void 0:a.resumeOp)&&o.call(a)}},s.prototype.yh=function(n,t,r,e){var i,o,u,r,a,o,o,f,l,c,s,v,v,v,c,c,c,v,c,n,h,d,b,w,m,m,g,y,p,C,S,T,_,_,R,x;if(n){if(o=n.ref,u=r&&r.onlyTableData,r=r&&r.isApplyRefilter,a=(i=this).Mf,i.name(n.name),I(o)||(o=Kn(o,!0)[0])&&(i.Ky=o.row,i.iw=o.col,i.Sx=o.rowCount,i.Tx=o.colCount),i.jO=1<=on(n.headerRowCount,1),i.oL=1<=on(n.totalsRowCount,-1),o=M(n,"tableColumns"),f=M(n,"autoFilter"),l=M(n,"sortState"),c=M(n,"tableStyleInfo"),s=M(n,"extLst"),u||(c&&(v=an(c.name),I(v)||(v=t.getTableTheme(v),i.style(v&&v.name())),I(c.showFirstColumn)||i.highlightFirstColumn(un(c.showFirstColumn,!1)),I(c.showLastColumn)||i.highlightLastColumn(un(c.showLastColumn,!1)),I(c.showRowStripes)||i.bandRows(un(c.showRowStripes,!1)),I(c.showColumnStripes)||i.bandColumns(un(c.showColumnStripes,!1))),v=a.getDefaultStyle(),c=void 0,!I(n.dataDxfId)&&t&&(c=t.getDxf(+n.dataDxfId,E,!0,!0)),I(n.dataCellStyle)||(c?c.parentName=n.dataCellStyle:c=n.dataCellStyle),c=c&&Yr(c,v,a),i.Gye=c,c=void 0,!I(n.headerRowDxfId)&&t&&(c=t.getDxf(+n.headerRowDxfId,E,!0,!0)),I(n.headerRowCellStyle)||(c?c.parentName=n.headerRowCellStyle:c=n.headerRowCellStyle),c=c&&Yr(c,v,a),i.Uye=c,c=void 0,!I(n.totalsRowDxfId)&&t&&(c=t.getDxf(+n.totalsRowDxfId,E,!0,!0)),I(n.totalsRowCellStyle)||(c?c.parentName=n.totalsRowCellStyle:c=n.totalsRowCellStyle),c=c&&Yr(c,v,a),i.Hye=c),v=n.lossless,u||I(v)||(c=v.bindingPath,n=v.autoGenerateColumns,h=v.expandBoundRows,d=v.useFooterDropDownList,b=v.showResizeHandle,w=v.allowAutoExpand,c&&(i.S5t=c,m=a&&a.getDataSource&&a.getDataSource(),O.CellBindingSource)&&m instanceof O.CellBindingSource&&(m=(0,O.q$)(m.getSource(),c))&&(i.H3=new O.$$,i.H3.bind(m)),F(n)&&i.autoGenerateColumns(n),F(h)&&(i.RSt=h),F(d)&&(i.ESt=d),F(b)&&i.showResizeHandle(b),F(w)&&(i.VSt=w)),g=e,v&&v.dataManagerTableBinding&&a&&O.$$&&(i.H3||(i.H3=new O.$$),i.DAr(v),i.showResizeHandle(!1),g=!0),o&&(y=Q(o,"tableColumn"),!I(y))){for(C=p=void 0,S=0,T=y.length;S<T;S++)_=y[S],C=i.BSt[S]||i.IEr(),(p=new J).yh(_,u,t,a),te(a,i,p,C,S),_=C.name(),(R=i.nTt(_,S))!==_&&C.name(R),g&&!C.dataField()&&C.dataField(Ce(C.name(),i.BSt));i.vTt()}u||(i.ESt&&i.h5t(!0),Xr(i,x=j.WSt&&new j.WSt,f,l,t,r),s&&(i.dTt=s))}},s.prototype._St=function(){var n,t,r,e,i,o,u,a,n=this,t=n.IB,r=n.Mf.filterRowsVisibleInfo.rowsVisibleInfo,e=t.range;if(!I(e))for(i=0;i<e.rowCount;i++)if(!1!==r[o=e.row+i])for(u=0;u<e.colCount;u++)a=e.col+u,t.isFiltered(a)&&t.jct(o,a)},s.prototype.formulaFromJSON=function(){for(var n,t,r,e,i,o,u,a,f,l,l,n=this,t=n.Mf,r=n.BSt,i=n.footerIndex(),o=n.dataRange().row,u=n.iw,f=0;f<r.length;f++)a=f+u,(l=(e=r[f]).footerFormula())&&typeof l==cr&&e.footerFormula(Tn(t,l,i,a,E,!0)),(l=e.dataAreaFormula())&&typeof l==cr&&(e.dataAreaFormula(Tn(t,l,o,a,E,!0)),n.NTr())&&(e.x5t(l),n._Ar(f,e,l,e.dataAreaFormula()));n.NTr()&&n.EAr()},s.prototype.vTt=function(){for(var n,t,r,e,i,o,n=this,t=n.BSt,r=t.length,o=0;o<r;o++)(i=(e=t[o]).id())<1&&e.id(n.M5t())},s.prototype.startRow=function(){return this.Ky},s.prototype.startColumn=function(){return this.iw},s.prototype.endRow=function(){return this.Ky+this.Sx-1},s.prototype.endColumn=function(){return this.iw+this.Tx-1},s.prototype.hasHeadersRow=function(){return this.jO},s.prototype.hasTotalsRow=function(){return this.oL},s.prototype.tableName=function(){return this.name()},s.prototype.getColumnIndexInTable=function(r){var e,i,e=-1;return I(r)||(r=r.toLowerCase().replace(/\u00A0/g," "),i=w.Common.zf.Vi(r,"\r\n","\n"),C(this.BSt,function(n,t){var t=t.name().toString().toLowerCase().replace(/\u00A0/g," ");if(t===r||t===i)return e=n,!1})),e},s.prototype.A0r=function(){delete this.I0r},s.prototype.x0r=function(n){var n,r,r=this;return r.I0r||(r.I0r={},C(r.BSt,function(n,t){r.I0r[t.name()]=n})),null!=(n=r.I0r[n])?n:-1},s.prototype.source=function(){var n=this.Mf;return n&&n.Uw&&n.Uw()},s.prototype.qSt=function(){var n,t,r,t,t,n=this,t=n.Mf;t&&(r=n.bindingPath())&&(t=t.getDataSource&&t.getDataSource(),O.CellBindingSource)&&t instanceof O.CellBindingSource&&(t=(0,O.q$)(t.getSource(),r),n.T5t(t))},s.prototype.T5t=function(n,t){var r,e,i,o,u,a,f,l,r,c,l,f,i=this,o=i.Mf;if(n&&!(i.autoGenerateColumns()&&(u=Object.keys(n[0]||[]).length)!==(a=i.BSt.length)&&(f=i.Sx,l=(0,L.Ec)(i.Ky,i.iw,f,u),1<(null==(r=null==(r=i.jS)?void 0:r.AB(l.row,l.col,f,u))?void 0:r.length))))if(c=!1,l=function(){c=!0,i.BSt.forEach(function(n){n.dataAreaFormula()&&(n.UGr=n.x5t(),n.HGr=n.dataAreaFormula(),n.x5t(A),n.dataAreaFormula(A))})},i.NTr()&&i.z3()!==n?(i.rkr(!(0,P.isDMView)(n),n),l()):t||i.NTr()||!(0,P.isDMView)(n)||l(),(f=i.H3||new O.$$).bind(n,o.Ut.G8),t&&!i.H3)i.H3=f,i.cGr(n);else try{T(o),i.H3=A,i.D3(f),i.cGr(n),c&&null!=(e=i.BSt)&&e.forEach(function(n){n.HGr&&(n.x5t(n.UGr),n.dataAreaFormula(n.HGr),delete n.UGr,delete n.HGr)}),s.et(o,"setBindingPath",{tableName:i.name()})}finally{_(o)}},s.prototype.clone=function(){var n,t,r,n=this,t=new s,r=Qn(n.toJSON());return t.Sg(n.jS),t.fromJSON(nt(r)),t},s.prototype.okr=function(n){var t,r,e,i,t=this,r=n.toJSON(),e=n.getTable(),i=ge(t);return I(e.views[i])||(i=ye(i)),(n=n.getTable().addView(i,r.columns,!1,r.options)).fromJSON(r),t.RIr(n),n},s.prototype.rkr=function(n,t){var n,r,e,r=this,e=r.z3();e&&r.NTr()&&e.TAr()&&(n&&(r.POt=A),r.LSt&&(n?r.LSt.L0():r.LSt.c5(A)),r.CAr(!0),null!=(n=e.getTable())&&n.removeView(e.name),e.kAr(),r.H3._dataSource=A,r.H3=A)},s.prototype.V3=function(n){var t,t,t=this;t.NTr()&&(n=t.okr(n),t.rkr(!1,n)),(t=new O.$$).bind(n),this.H3=t},s.prototype.gTt=function(n){var n;n&&!n.bindingPath()&&(n=n.H3)&&this.V3(n.getSource())},s.prototype.isBinding=function(){var n,t,n,r,n=this;return!(!n.QL()||1===arguments.length&&!I(arguments[0])&&(t=arguments[0],n=n.z3(),r=void 0,t!==(this.NTr()?"string"==typeof t?null==n?void 0:n.tableName:null==n?void 0:n.getTable():n)))},s.prototype.z3=function(){var n=this.H3;return n?n.getSource():A},s.prototype.pTt=function(){var n=this.H3;return n?n.getRowCount():0},s.prototype.bTt=function(n,t){var r,e,t,r=this.PSt;t?r.push(n):(e=n.name(),-1!==(t=r.findIndex(function(n){return n.name()===e}))&&r.splice(t,1))},s.prototype.cL=function(t){var r=this;r.PSt.forEach(function(n){n.Pen(r,t)}),2===t&&(r.PSt=[])},s.prototype.OEr=function(){var n=this;n.PSt.forEach(function(n){n.Oen=E,n.Fnn()}),n.PSt=[]},s.prototype.EEr=function(){var n;this.PSt.forEach(function(n){n.Fnn()})},s.prototype.osr=function(t){var n;null!=(n=this.aT)&&n.forEach(function(n){n.forEach(t)})},s.prototype.psr=function(){this.jS.ssr()},s.prototype.cyt=function(n,t,r){var e=this.aT.get(t);r?(e||(e=null==g?void 0:g.createSet(),this.aT.set(t,e)),e.add(n)):e&&(e.delete(n),0===e.size)&&this.aT.delete(t),this.jS.ssr()},s.prototype.$ur=function(u){var n,n,a,f,l,c,s,v,n=this,a=n.startColumn(),f=n.endColumn(),l=n.startRow(),c=n.endRow(),s=n.hasTotalsRow(),v=n.hasHeadersRow();null!=(n=n.aT)&&n.forEach(function(n,t){var r,e,i,o,r=t.columnReferenceStart(),e=t.columnReferenceEnd();switch(1===t.lbt&&(r=a,e=f),i=l,o=c,t.hbt){case 1:case 3:case 16:i=v?l+1:l,o=s?c-1:c;break;case 2:if(!v)return A;o=l;break;case 8:i=o=s?c:c+1;break;case 6:o=s?c-1:c;break;case 12:i=v?l+1:l}u.insert({minX:i,minY:r,maxX:o,maxY:e,nodes:n,expr:t,currentRow:1===t.hbt})})},s.prototype.wTt=function(n,t){var r,e,i,n,e,r=this,e=r.footerIndex(),i=!1;return-1<e&&n===e&&(e=(n=r.iw)+r.Tx,i=n<=t&&t<e),i},s.prototype.sort=function(n,t){var r=this,e=r.Mf,i=r.dataRange(),r=r.rowFilter();e&&0<=n&&n<i.colCount&&(e.suspendPaint(),e.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:n+i.col,ascending:t}]),r&&(r.nrt={index:n+i.col,ascending:t}),e.resumePaint())},s.prototype.QL=function(){return!!this.H3},s.prototype.N4t=function(n,t,r,e,i,o,u,a){var f,l,c,s,v,h,d,b,w,m,g,y,p,C,S,T,_,R,x,j,O,F,k,f=this,l=f.Mf,c=f.jS,s=f.Ky,v=f.iw,h=f.Sx,d=f.Tx,b=s+h-1,w=f.dataRange(),m=r&&0<w.rowCount?n+1:n,g=m+t;Nn(l);try{y=f.QL(),f.lTt=!0,f.sL(!1),c.zB=f,c.zB.VB=new L.Range(s,v,h+t,d),f.w0r=n===(f.jO?f.Ky+1:f.Ky),p=L.CopyToOptions.value|L.CopyToOptions.formula|L.CopyToOptions.comment|L.CopyToOptions.outline|L.CopyToOptions.sparkline|L.CopyToOptions.span|L.CopyToOptions.style|L.CopyToOptions.tag|L.CopyToOptions.bindingPath|L.CopyToOptions.hyperlink|L.CopyToOptions.altText|L.CopyToOptions.shape,S=(C=1+b)+t,T=i-C+1,_=r&&n===b,e&&!f.TTt?l.moveTo(C,v,S,v,T,d,p,E,E,_&&this):_&&L.staticMembers.XGr(l,C,v,S,v,1,d,this),R=b-m+1,(!r||n!==b)&&0<R&&(l.EB=f,l.E0r=!0,l.Nyt=w,y&&f.NTr()?(f.oL&&(l.moveTo(b,v,b+t,v,1,d,p),R--),0<R&&(p=L.CopyToOptions.comment|L.CopyToOptions.outline|L.CopyToOptions.sparkline|L.CopyToOptions.span|L.CopyToOptions.style|L.CopyToOptions.tag|L.CopyToOptions.bindingPath|L.CopyToOptions.hyperlink|L.CopyToOptions.altText|L.CopyToOptions.shape,l.moveTo(m,v,g,v,R,d,p))):y?(f.oL&&(l.moveTo(b,v,b+t,v,1,d,p),R--),0<R&&f.BSt.forEach(function(n,t){var t=v+t;n.dataField()?l.moveTo(m,t,g,t,R,1,L.CopyToOptions.style):l.moveTo(m,t,g,t,R,1,p)})):l.moveTo(m,v,g,v,R,d,p),delete l.Nyt,delete l.EB,delete l.E0r),f.JO(m,t,r,!!u,!0,o),x=r?1:0,j=f.jO&&1===h,(m<=(O=s+h-1+x)||j)&&ie(l,m,f.iw,m+t-1,f.iw+f.Tx-1,f),F=l.Ut,k=f.dataRange(),F.bJ&&F.bJ(m,t,{affectRanges:[k],isFromTable:!0}),F.ATt&&F.ATt(m,t,[k],!0),delete c.zB.VB,c.zB=E,delete f.w0r,f.t5t(m,t,!0,a),f.J5t(m,t,!0,a),f.jS.dl()}finally{f.jS.ssr(),f.lTt=E,f.sL(!0),Bn(l),f.cL(0)}},s.prototype.sL=function(n){this.Mf.sL(n)},s.prototype.insertRows=function(n,t,r){var e;I(n)||I(t)||t<=0||(n=Gn(e=this,n,!0),e.zpt(n,t,r),e.tUr())},s.prototype.zpt=function(n,t,r,e,i){var o,u,a,f,a,l,f,a,c,s,f,v,c,h;I(n)||I(t)||t<=0||(u=(o=this).Mf,f=(a=o.dataRange()).row,0===(a=a.rowCount)&&n===f||!(n<f||(l=f+a)<=n)||N(H().Exp_RowParamOutOfRange),f=o.Ky,a=o.iw,c=o.Sx,v=a+(s=o.Tx)-1,h=(f=f+c-1)<(c=jn(u,o)),Fn(u,o,1+f,c,a,v,t))||o.N4t(n,t,r,h,c,e,i)},s.prototype.deleteRows=function(n,t){var r;I(n)||I(t)||t<=0||(n=Gn(r=this,n,!0),r.yE(n,t),r.tUr())},s.prototype.yE=function(r,e,n,t,i){var o,u,a,f,a,l,c,s,v,h,d,f,a,b,w,m,g,y,p,C,S,T,_,R;if(!(I(r)||I(e)||e<=0||(u=(o=this).Mf,f=(a=o.dataRange()).row,a=a.rowCount,(r<f||f+a<=r)&&N(H().Exp_RowParamOutOfRange),l=o.Ky,c=o.iw,s=o.Sx,v=o.Tx,h=l+s-1,d=c+v-1,(s<=1||r===f&&!o.jO&&!o.oL&&a<=e)&&N(H().Exp_TableDeleteCountInvalid),a=h<(f=jn(u,o)),Fn(u,o,1+h,f,c,d,e,!0)))){Nn(u);try{o.sL(!1),b=o.QL(),w=void 0,b&&(w=In(!0),o.x4t(r,e,w)),(m=o.jS).zB=o,m.zB.VB=new L.Range(l,c,s,v),u.E0r=!0,o.xP(r,e,{key:w,isInitBinding:n,ignoreUpdateDataSource:t,ignoreSlicerWhenFilter:i}),g=U(e,h-r+1),b||u.clear(r,c,g,v,3,en),o.w0r=r===(o.jO?o.Ky+1:o.Ky),y=L.CopyToOptions.value|L.CopyToOptions.formula|L.CopyToOptions.comment|L.CopyToOptions.outline|L.CopyToOptions.sparkline|L.CopyToOptions.span|L.CopyToOptions.style|L.CopyToOptions.tag|L.CopyToOptions.bindingPath|L.CopyToOptions.hyperlink|L.CopyToOptions.altText|L.CopyToOptions.shape,r+e<=h&&(p=h-e-r+1,b?(o.oL&&p--,0<p&&o.BSt.forEach(function(n,t){var t=c+t;n.dataField()?u.moveTo(r+e,t,r,t,p,1,L.CopyToOptions.style):u.moveTo(r+e,t,r,t,p,1,y)}),o.oL&&u.moveTo(h,c,h-e,c,1,v,y)):u.moveTo(r+e,c,r,c,p,v,y)),a?(S=(C=1+h)-g,T=f-C+1,u.moveTo(C,c,S,c,T,v,y)):(u.clear(h-g+1,c,g,v,3,en),u.moveTo(u.getRowCount()+1,c,h-g+1,c,g,v,L.CopyToOptions.formula,E,!0)),_=u.Ut,R=o.dataRange(),_.yJ&&_.yJ(r,e,[R],!0),delete o.w0r,delete m.zB.VB,delete u.E0r,m.zB=E,o.J5t(),o.jS.dl()}finally{o.jS.ssr(),o.sL(!0),Bn(u),o.cL(0)}}},s.prototype.insertColumns=function(n,t,r){var e;I(n)||I(t)||t<=0||(n=Gn(e=this,n,!1),e.k4t(n,t,r))},s.prototype.k4t=function(n,t,r){var e,i,o,u,o,u,a,o,f,l,c,s,v,h,l,d,b,w,m,g,y,p,C,S,T,_,R,x,j,O,F,k;if(!(I(n)||I(t)||t<=0||(i=(e=this).Mf,u=(o=e.dataRange()).col,o=o.colCount,(n<u||u+o<=n)&&N(H().Exp_ColParamOutOfRange),u=e.Ky,a=e.iw,l=u+(o=e.Sx)-1,v=(c=a+(f=e.Tx)-1)<(s=On(i,e)),Fn(i,e,u,l,1+c,s,t,!1,!0)))){l=(h=r?n+1:n)+t,Nn(i);try{if(e.sL(!1),(d=e.jS).zB=e,d.zB.VB=new L.Range(u,a,o,f+t),w=!(b=e.QL()),g=(m=1+c)+t,y=s-m+1,p=L.CopyToOptions.value|L.CopyToOptions.formula|L.CopyToOptions.comment|L.CopyToOptions.outline|L.CopyToOptions.sparkline|L.CopyToOptions.span|L.CopyToOptions.style|L.CopyToOptions.tag|L.CopyToOptions.bindingPath|L.CopyToOptions.hyperlink|L.CopyToOptions.altText|L.CopyToOptions.shape,C=L.CopyToOptions.formula|L.CopyToOptions.comment|L.CopyToOptions.outline|L.CopyToOptions.sparkline|L.CopyToOptions.span|L.CopyToOptions.style|L.CopyToOptions.tag|L.CopyToOptions.bindingPath|L.CopyToOptions.hyperlink|L.CopyToOptions.altText|L.CopyToOptions.shape,v&&i.moveTo(u,m,u,g,o,y,p),!r||n!==c){if(S=u,T=o,i.EB=e,i.E0r=!0,e.jO&&(S++,T--),e.jO&&i.moveTo(u,h,u,l,1,c-h+1,C),b&&e.NTr())for(i.moveTo(S,h,S,l,T,c-h+1,C),_=e.BSt,R=f-1;h-a<=R;R--)x=_[R],j=a+R,x.dataField()&&e.showFooter()&&e.NTr()&&i.Ut.f_e(S+T-1,j,1,1,1,3);else if(b){for(O=(_=e.BSt).slice(),R=f-1;h-a<=R;R--)x=_[R],j=a+R,x.dataField()?i.moveTo(S,j,S,j+t,T,1,C):i.moveTo(S,j,S,j+t,T,1,p),_[R+t]=x,e.IEr(R);e.BSt=O}else i.moveTo(S,h,S,l,T,c-h+1,p);delete i.EB,delete i.E0r}e.qO(h,t,r,w,!0),F=i.Ut,k=e.dataRange(),F.wJ&&F.wJ(h,t,{affectRanges:[k],isFromTable:!0}),F.NTt&&F.NTt(h,t,[k],!e.NTr()||1),delete d.zB.VB,d.zB=E,e.jS.dl()}finally{e.sL(!0),e.psr(),Bn(i),e.cL(0)}}},s.prototype.deleteColumns=function(n,t){var r;I(n)||I(t)||t<=0||(n=Gn(r=this,n,!1),r.wE(n,t))},s.prototype.wE=function(n,t){var r,e,i,o,i,o,u,i,a,f,l,c,s,v,h,d,b,w,m,g,y,p,C,S,T,_,R,x,j,O,F,k,A;if(!(I(n)||I(t)||t<=0||(e=(r=this).Mf,o=(i=r.dataRange()).col,i=i.colCount,(n<o||o+i<=n)&&N(H().Exp_ColParamOutOfRange),o=r.Ky,u=r.iw,f=o+(i=r.Sx)-1,l=u+(a=r.Tx)-1,(a<=1||n===u&&a<=t)&&N(H().Exp_TableDeleteCountInvalid),s=l<(c=On(e,r)),Fn(e,r,o,f,1+l,c,t,!0,!0)))){Nn(e);try{if(r.sL(!1),v=r.jS,h=r.QL(),v.zB=r,v.zB.VB=new L.Range(o,u,i,a),d=U(t,l-n+1),b=L.CopyToOptions.value|L.CopyToOptions.formula|L.CopyToOptions.comment|L.CopyToOptions.outline|L.CopyToOptions.sparkline|L.CopyToOptions.span|L.CopyToOptions.style|L.CopyToOptions.tag|L.CopyToOptions.bindingPath|L.CopyToOptions.hyperlink|L.CopyToOptions.altText|L.CopyToOptions.shape,w=L.CopyToOptions.formula|L.CopyToOptions.comment|L.CopyToOptions.outline|L.CopyToOptions.sparkline|L.CopyToOptions.span|L.CopyToOptions.style|L.CopyToOptions.tag|L.CopyToOptions.bindingPath|L.CopyToOptions.hyperlink|L.CopyToOptions.altText|L.CopyToOptions.shape,n+t<=l){if(m=o,g=i,r.jO&&(m++,g--),e.E0r=!0,r.jO&&e.moveTo(o,n+t,o,n,1,l-t-n+1,w),h){for(p=(y=r.BSt).slice(),C=n-u+t;C<r.Tx;C++)S=y[C],T=u+C,S.dataField()?((_=r.showFooter()&&r.NTr())&&e.Ut.f_e(m+g-1,T-t,1,1,1,3),e.moveTo(m,T,m,T-t,g,1,w),_&&e.Ut.f_e(m+g-1,T,1,1,1,3)):e.moveTo(m,T,m,T-t,g,1,b),y[C-t]=S,r.IEr(C);r.BSt=p}else e.moveTo(m,n+t,m,n,g,l-t-n+1,b);delete e.E0r}r.NP(n,t),s?(x=(R=1+l)-d,j=c-R+1,e.moveTo(o,R,o,x,i,j,b)):n+t===1+l&&(R=e.getColumnCount()+1,x=1+l-d,j=d,e.moveTo(o,R,o,x,i,j,L.CopyToOptions.formula,E,!0)),F=(O=Math.max(l,c))+1-(O-d+1),O-d+1<n+d?e.clear(o,O-d+1,i,F,3,en):r.jO&&e.clear(o,O-d+1,1,F,3,en),k=e.Ut,A=r.dataRange(),k.MJ&&k.MJ(n,t,[A],!0),delete v.zB.VB,v.zB=E,r.jS.dl()}finally{r.sL(!0),r.ccr(e),Bn(e),r.cL(0)}}},s.prototype.STt=function(){try{var n=this,t=n.Mf,r,e=n.jS.U3;t&&t.Ut.DTt([n],[],2),e.splice(e.indexOf(n),1),n.U5t()}catch(n){}},s.prototype.ITt=function(n,t){var r=this;r.mTt=!0,r.iTt=n,r.jS.WB(r,E,t),delete r.iTt,delete r.mTt},s.prototype.ZAe=function(t){var r=this,n;r.BSt.forEach(function(n){var n=n.footerFormula();n&&ue(r,n,t)})},s.prototype.ftt=function(n){var t,r,e,i,o,u,a,f,l,c,s,v,h,t=this,r=t.H3,e=t.Mf,i=t.jO?1:0,o=t.Ky+i+n,u=t.iw;if(!r||0===r.getRowCount())return A;if(a=t.Tx,f={},l=r.ftt(n))for(c in l)Z(l,c)&&"function"!=typeof c&&(f[c]=l[c]);for(s=0;s<a;s++)h=(v=t.BSt[s])&&v.dataField(),v&&h&&0<h.length&&I(f[h])&&(f[h]=e.getValue(o,u+s));return f},s.prototype.x4t=function(n,t,r){var e,i,o,u,a,f,l,c,e=this,i=[],o=e.H3;if(o)for(f=o.getRowCount(),l=0;l<t;l++)c=A,(a=An(e,u=n+l))<f&&(c=e.ftt(a)),i.push({key:r,data:c});e.aj=i},s.prototype.tq=function(){var r=[],n=this.aj;return n&&C(n,function(n,t){t&&!L.GC$.isFunction(t)&&r.push(t.data)}),r},s.prototype.R5t=function(n,t,r){var e,i,o,u,a,f,e=this;0<e.Mf.lE||(i=e.GSt,(o=e.H3)&&(u=A,t<(a=o.getRowCount())&&(u=e.ftt(t)),i[n]=f={key:r,data:u}))},s.prototype.sTt=function(n,t,r){var e,i,r,o,e=this;if(!(0<e.Mf.lE))if(i=e.GSt,r)r=i.splice(n,t),e.USt.push({rowIndex:n,count:t,deletedDirtyItems:r});else for(o=0;o<t;o++)i.splice(n,0,A)},s.prototype.A4t=function(n,t){this.GSt.splice(n,t)},s.prototype.ZSt=function(){var n,t,t,r,e,i,o,u,n=this,t=n.USt;if(t&&0<t.length)for(r=(t=t.pop()).rowIndex,e=t.count,i=t.deletedDirtyItems,o=0;o<e;o++)u=i[o],n.GSt[r+o]=h({},u)},s.prototype.getDirtyRows=function(){for(var n,t,r,e,i,o,n=this,t=n.GSt,r=[],o=0;o<t.length;o++)e=t[o],I(e)||(i=An(n,o),r.push({row:i,originalItem:e.data,item:n.ftt(i)}));return r},s.prototype.clearPendingChanges=function(){this.GSt=[]},s.prototype.footerRowDropDowns=function(n,t){var r,n,n,e,i,t,r=this,n=r.OSt[n];if(n)return 1===arguments.length?n.dropDowns&&n.dropDowns.slice():(n=n.dropDowns[0],t?(e=t.listOption,i=t.submitCommand,t=t.type,e&&(n.option=e),i&&(n.submitCommand=i),F(t)&&(n.type=t),r):void 0)},s.prototype.checkTableLastRow=function(n){var t=this,r=t.dataRange();return t.headerIndex()===n||r.row+r.rowCount-1!==n},s.prototype.checkTableLastCol=function(n){var t,r=this.dataRange();return r.col+r.colCount-1!==n},s.prototype.jj=function(n,t,r,e,i){var o,u,e,i,u,o=this,u=o.Mf;Dn(u,o,r?Wt:Pt,n,t,e,i),e=u.Ut,i=r?Pt:Wt,u=!r&&E,e&&e.ZI(["tableRowsChanged",o,i,n,t,u,r])},s.prototype.Ej=function(n,t,r,e){var i,o,e,u,o,i=this,o=i.Mf;zn(o,i,r?Xt:Kt,n,t,e),e=o.Ut,o=!r&&E,e&&e.ZI(["tableColumnsChanged",i,u=r?Kt:Xt,n,t,o])},G=s,j.Table=G,(0,L.qDr)(G),j.hasRowFilter=Le,(0,L.$e)(G),Or={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"},G.prototype.name=e(tt,"",Ie(tt),n,Me(tt)),G.prototype.showResizeHandle=e(r,!1,Ie(r),function(){return!this.NTr()},Me(r)),G.prototype.bandRows=e(at,!0,Ie(at),E,Me(at)),G.prototype.bandColumns=e(ft,!1,Ie(ft),E,Me(ft)),G.prototype.highlightFirstColumn=e(ot,!1,Ie(ot),E,Me(ot)),G.prototype.highlightLastColumn=e(ut,!1,Ie(ut),E,Me(ut)),Fr=function(n){var t,r;if(n)return t=n.builtInName(),(r=new p.TableTheme).fromJSON(n.toJSON()),t&&r.builtInName(t),r},G.prototype.style=function(n){var t,r,e,i;return 0<arguments.length?(t=void 0,r=!1,"string"==typeof n?(e=n.toLowerCase(),(t=(i=this.Mf&&this.Mf.getParent()&&this.Mf.getParent().customTableThemes.get(e))||p.TableThemes[e])&&e!==this.getStyleName()&&this.TEr(e),t||(r=!0)):r=(n&&n instanceof p.TableTheme&&(t=new p.TableTheme).fromJSON(n.toJSON()),!0),r&&this.getStyleName()&&this.TEr(E),this.RN(t)):Fr(this.RN())},G.prototype.getStyleOriginInstance=function(){return e("style",E,Ne,E,Me("style")).call(this)},G.prototype.RN=e("style",E,Ne,E,Me("style")),G.prototype.autoGenerateColumns=e(lt,!0,Ie(lt),E,Me(lt)),m&&m.HideRowFilter&&(t=m.HideRowFilter,c(o,f=t),o.prototype.V_r=function(){return"table"},o.prototype.pct=function(){return 0},o.prototype.bct=function(){return this.range.colCount},o.prototype.table=function(n){var t=this;if(0===arguments.length)return t.nM;(t.nM=n)&&(t.Mf=n.Mf)},o.prototype.wtt=function(n,t,r,e){var i=this,o;if(!t&&i.nM.NTr())switch(n){case 5:i.GAr(i.nM),i.Sct(i.Mf,1,Ve(e.filterItemMap,r.filterItemMap));break;case 6:i.GAr(i.nM),i.Sct(i.Mf,0,Ve(r.filterItemMap,e.filterItemMap))}},o.prototype.setFilterItemMap=function(n,t){var r=this;t?(r.Mf.Ut.cct(r,5),r.rrt[n]=t,r.Mf.Ut.cct(r,5,E,!0)):(r.Mf.Ut.cct(r,6),r.rrt[n]=E,r.Mf.Ut.cct(r,6,E,!0))},o.prototype.filter=function(n,t){var r,e,i,o,u,a,r=this,e=r.nM;if(e&&e.H3&&e.H3.nln()){if(i=r.Mf){if(i.Ut.cct(r,7),u=r.rrt,a=void 0,!(o=[])===r.sct&&(delete r.sct,r.Mct=[]),I(n)){for(a=0;a<X(u);a++)u[a]&&(o.push(a),r.Nct(n,!I(r.rrt[n])));r.GAr(e)}else{if(!u[n])return;o.push(n),r.GAr(e),r.Nct(n,!I(r.rrt[n]))}t||r.Sct(i,0,o),i.Ut.cct(r,7,E,!0)}}else f.prototype.filter.call(this,n,t)},o.prototype.ETr=function(n,t){var r,e=this.nM;return e.H3.ETr(n-e.iw,t)},o.prototype.GAr=function(n){var r,t,e,r=this;n.H3.Irn(),t=r.rrt,e=Object.keys(t).filter(function(n){return!I(t[n])}).reduce(function(n,t){return n.concat(r.aze(Number(t)))},[]),n.H3.Irn(e),r._ct=n.z3().UAr(n.WTr(),n.iw)},o.prototype.aze=function(i){var o=this;return f.prototype.aze.call(this,i,function(n,t){var r,e;if(o.ikr(t[0])){if(!t[0].art||2!==t[0].conType())return!1;for(r=0;r<t.length;r++)e=t[r].urt,n.push({col:i,value:I(e)?e:e.toISOString()})}else for(r=0;r<t.length;r++)n.push({col:i,value:t[r].value});return!0}).map(function(n){return n.col=o.nM.O5t(n.col),n})},o.prototype.unfilter=function(n,t){var r,e,i,o,u,a,r=this,e=r.Mf;if(e&&e.suspendPaint(),(i=r.nM)&&i.H3&&i.H3.nln()){if(e.Ut.cct(r,2),o=[],I(n)){for(u=r.Mct,a=void 0,a=X(u)-1;0<=a;a--)r.rrt[n]=E,r.Nct(n,!1);r.GAr(i),t||r.Sct(e,1,o)}else r.isFiltered(n)&&(o.push(n),r.rrt[n]=E,r.GAr(i),r.Nct(n,!1),t||r.Sct(e,1,o));e.Ut.cct(r,2,E,!0)}else f.prototype.unfilter.call(this,n,t);i&&i.jS&&i.jS.dl(),e&&e.resumePaint()},o.prototype.JO=function(n,t,r){var e=this,i=e.nM;f.prototype.JO.call(this,n,t,r),i&&e.Fct(i.dataRange())},o.prototype.xP=function(n,t){var r=this,e=r.nM;f.prototype.xP.call(this,n,t),e&&r.Fct(e.dataRange())},o.prototype.Uct=function(n){var t=this,r,e=t.Pct()&&n&&n.contains(t.range.row,t.Gct());e&&(r=t.nrt),f.prototype.Uct.call(this,n),e&&(t.nrt=r)},o.prototype.Qct=function(n,t,r){var e=this,i=e.Mf.Ut;i.cct(e,9),e.JO(n,t,r),i.cct(e,9,E,!0)},o.prototype.Kct=function(n,t){var r=this,e=r.Mf.Ut;e.cct(r,10),r.xP(n,t),e.cct(r,10,E,!0)},o.prototype.Jct=function(n,t,r){var e=this,i=e.Mf.Ut;i.cct(e,11),e.qO(n,t,r),i.cct(e,11,E,!0)},o.prototype.Xct=function(n,t){var r=this,e=r.Mf.Ut;e.cct(r,12),r.NP(n,t),e.cct(r,12,E,!0)},o.prototype.ert=function(n,t,r,e,i){var o,u,a,o=this,u=o.nM;o.JTr=!0,f.prototype.ert.call(this,n,t,r,e,i),o.JTr=!1,u&&u.N5t()&&(a=u.getSlicerData()).refresh()},o.prototype.ekr=function(n){var t,r,t;n&&(r=(t=this).nM,t=t.Mf,r.H3.POn(n.map(function(n){return h(h({},n),{index:r.AAr(n.index)})}),t.Ut.G8))},o.prototype.reFilter=function(n){this.nM.NTr()||f.prototype.reFilter.call(this,n)},o.prototype.openFilterDialog=function(n){var t,r,e,i,i,o,o,o,i;this.nM.NTr()?(t=this.nM,e=(r=this).Mf,i=n.col,i=t.z3().getColumn(t.O5t(i)),r.irt=!1,r.ort=!1,o=0<((o=t.z3())&&o.length()||0),r.Hct(e)&&o&&(o={sortByValue:!1!==i.allowSort,filterByValue:!1!==i.allowFilterByValue,listFilterArea:!1!==i.allowFilterByList,sortByColor:!1,filterByColor:!1},r.filterDialogVisibleInfo(o),i=new Y.TableDataDrivenFilterDialog(e.parent.j2(),e,n,o,r.dialogOptions,t),(e.Cut=i).rQ(),i.cze)&&i.yut()):f.prototype.openFilterDialog.call(this,n)},o.prototype.toJSON=function(){var n,t,n,n=this,t=f.prototype.toJSON.call(n),n=n.nM;return n&&(t.tableName=n.name()),t},o.prototype.L0=function(){this.nM=A,this.Mf=A},j.WSt=o),u.prototype.propChanged=function(n,t){var r=this;r.onChange&&r.onChange({columnId:r.jKe(),propName:n,value:t})},u.prototype.tTt=function(){return 0<this.id()},u.prototype.vyt=function(){},u.prototype.r_t=function(){},u.prototype.toJSON=function(n){var e,i,o,t,e=this,i={};return F(e.cellType())&&R(o=He(e))&&(o.cellType=e.cellType()),F(e.formatter())&&!R(o=He(e))&&(o.formatter=e.formatter()),C(Et,function(n,t){var r=e[t]();I(r)||(!o||R(o)||t!==rt&&t!==it)&&(r.toJSON&&"function"==typeof r.toJSON?i[t]=r.toJSON():i[t]=r)}),t=E,W(i)||(null!=n&&n.isServer&&(i.__ID__=e.jKe()),t=i),t},u.prototype.wh=function(n,t,r,e,i,o,u,a,f){var l,c,c,s,v,h,d,e,s,d,u,v,b,r,i,s,l=this,c=l.name();return c=ln(c,"\r",""),c={n_:"tableColumn",id:l.id(),name:Br(c)},s=l.footerFormula(),v=l.footerValue(),s&&(o&&!1===o.includeFormulas?(s=E,v=n.getValue(e,i)):d=Ee(h=z(n,s,e,i))),(e=d===sr)?c.totalsRowFunction=sr:s?c.totalsRowFunction=d:I(v)||(c.totalsRowLabel=Br(v.toString()),u.v=v),s=l.dataAreaFormula(),I(s)||Ue(s=z(n,s,r,i))||(I(c.c_)&&(c.c_=[]),d={n_:"calculatedColumnFormula",c_:[fn(hn(s))]},c.c_.push(d)),e&&!I(h)&&(u={n_:"totalsRowFormula",c_:[fn(h)]},I(c.c_)&&(c.c_=[]),c.c_.push(u)),v=c.lossless,I(l.value())||((v=I(v)?c.lossless={}:v)[et]=l.value()),I(l.dataField())||((v=I(v)?c.lossless={}:v)[It]=l.dataField()),r=l.cellType(),i=l.formatter(),F(r)&&(b=He(l),(v=I(v)?c.lossless={}:v)[rt]=null!=r&&r.toJSON?r.toJSON():r,R(b)||(b.cellType=r)),F(i)&&(R(b=He(l))?(v=I(v)?c.lossless={}:v)[it]=i:b.formatter=i),s=!L.Util.ko(o),se(t.Gye,l.dataStyle(),"data",s,c,n,a),s&&!1!==f||se(t.Uye,l.headerStyle(),"headerRow",s,c,n,a),se(t.Hye,l.footerStyle(),"totalsRow",s,c,n,a),c},u.prototype.fromJSON=function(o){var u;o&&(u=this,C(Et,function(n,t){var r,e,i,i,e,r=o[t]!==E?o[t]:o["_"+t];I(r)||(t===rt?(e=r.typeName,(i=(i=L.CellTypes&&L.CellTypes.ti)&&i[e]||i[r.type]||(0,L.getTypeFromString)(e))&&((e=new i).fromJSON(r,!1),r=e),F(r)&&u.cellType(r)):t===it&&F(r)&&u.formatter(r),u[t](r,!1))}),u.UKn(o.__ID__),ne(u,o,ct),ne(u,o,st),ne(u,o,vt))},u.prototype.yh=function(n,t,r,e){var i,o,o,o,o,t,o,o,r,t,e,o,r,t,e,o,n,n,o,n,o,e;n&&((i=this).id(on(n.id,0)),o=n[tt],I(o)||(o=ln(o,"_x000d__x000a_","\n"),i.name(Dr(o))),o=n.totalsRowLabel,I(o)||(o=ln(o,"_x000d__x000a_","\n"),i.footerValue(Dr(o))),t||(o=void 0,t=e&&e.getDefaultStyle(),!I(n.dataDxfId)&&r&&(o=r.getDxf(+n.dataDxfId,E,!0,!0)),I(n.dataCellStyle)||(o?o.parentName=n.dataCellStyle:o=n.dataCellStyle),o=o&&Yr(o,t,e),i.dataStyle(o),o=void 0,!I(n.headerRowDxfId)&&r&&(o=r.getDxf(+n.headerRowDxfId,E,!0,!0)),I(n.headerRowCellStyle)||(o?o.parentName=n.headerRowCellStyle:o=n.headerRowCellStyle),o=o&&Yr(o,t,e),i.headerStyle(o),o=void 0,!I(n.totalsRowDxfId)&&r&&(o=r.getDxf(+n.totalsRowDxfId,E,!0,!0)),I(n.totalsRowCellStyle)||(o?o.parentName=n.totalsRowCellStyle:o=n.totalsRowCellStyle),o=o&&Yr(o,t,e),i.footerStyle(o),r=n.totalsRowFunction,I(r)||((t=r)===sr&&(t=an(nn(M(n,"totalsRowFormula")))),i.footerFormula(t)),e=M(n,"calculatedColumnFormula"),I(e)||(o=""+nn(e),i.dataAreaFormula(an(vn(o)))),r=n.lossless,t=void 0,I(r))||(e=r[rt],I(e)||(o=e.typeName,(n=(n=L.CellTypes&&L.CellTypes.ti)&&n[o]||n[e.type]||(0,L.getTypeFromString)(o))&&((o=new n).fromJSON(e),e=o),I(e))||(R(t=He(i))?i.cellType(e):t.cellType=e),n=r[et],I(n)||i.value(n),o=r[it],I(o)||(R(t=He(i))?i.formatter(o):t.formatter=o),e=r[It],I(e))||i.dataField(e))},u.prototype.cellType=function(n){var t=this,r=t.dataStyle();if(0===arguments.length)return r&&r.cellType;r||(r=new L.Style,t.dataStyle(r)),r.cellType=n,t.propChanged("cellType",n)},u.prototype.formatter=function(n){var t=this,r=t.dataStyle();if(0===arguments.length)return r&&r.formatter;r||(r=new L.Style,t.dataStyle(r)),r.formatter=n,t.propChanged("formatter",n)},J=u,j.TableColumn=J,(0,L.qDr)(J),J.prototype.id=function(n){var t=e(Lt,E,function(n){var t=this;t.name()||t.name(At+n)},E,function(n,t){this.propChanged(Lt,n)});return 0===arguments.length?t.call(this):I(n)?this:t.call(this,n)},J.prototype.name=e(tt,E,function(n,t){var r,e,r=this;n?(e=L.util.V0(n="string"!=typeof n?""+n:n))!==n&&e.toLocaleDateString&&r.name(e.toLocaleDateString()):r.name(At+r.id())},E,function(n,t){var r=this;t!==r.name()&&this.propChanged(tt,r.name())}),J.prototype.dataStyle=e(ct,E,E,E,function(n){this.propChanged(ct,n)}),J.prototype.headerStyle=e(st,E,E,E,function(n){this.propChanged(st,n)}),J.prototype.footerStyle=e(vt,E,E,E,function(n){this.propChanged(vt,n)}),J.prototype.value=e(et,E,E,E,function(n){this.propChanged(et,n)}),J.prototype.dataField=e(It,E,E,E,function(n){this.propChanged(It,n)}),J.prototype.footerValue=e(Dt,E,E,E,function(n){this.propChanged(Dt,n)}),J.prototype.dataAreaFormula=e(Bt,E,E,E,function(n,t){var r=this;t&&t.forEachNodes&&t.forEachNodes(function(n){13===n.type&&n.abt.cyt(r,n,!1)}),n&&n.forEachNodes&&n.forEachNodes(function(n){13===n.type&&n.abt.cyt(r,n,!0)}),this.propChanged(Bt,n)}),J.prototype.footerFormula=e(Mt,E,E,E,function(n){this.propChanged(Mt,n)}),J.prototype.x5t=e(Nt),a.prototype.YBe=function(n,t){(0===n&&0<t||0<n&&0===t)&&this.Mf.Ut.L5e()},a.prototype.getUsedRange=function(){var n,t,r,e,i,o,n,t=this.all(),r={};if(t)for(e=0,i=t;e<i.length;e++)o=i[e],Tr(r,Sr(o.range()));return r},a.prototype.L0=function(){for(var n,t,r,e,i,n=this,t=n.U3,r=t.length,i=0;i<r;i++)(e=t.get(i))&&e.L0();n.U3.L0(),n.zB=E,n.dl(),n.Mf=A},a.prototype.dl=function(){var n,t,r,e,i,n=this;for(n.xl=[],n.Nl=[],r=(t=n.U3).length,i=0;i<r;i++)(e=t.get(i)).dl()},a.prototype.KSt=function(n,t){for(var r,e,i,o,u,r,e=this.U3,i=e.length,u=0;u<i;u++)o=e.get(u),!t&&Nr(o.HSt,n)?o.HSt=[]:I(o.HSt[n])||(o.HSt[n]=E)},a.prototype.JSt=function(n){for(var t,r,e,i,o,t,r=this.U3,e=r.length,o=0;o<e;o++)Nr((i=r.get(o)).zSt,n)?i.zSt=[]:I(i.zSt[n])||(i.zSt[n]=E)},a.prototype.addFromDataSource=function(e,i,o,u,a,f){var n,n,n,l,c,n,s,t,n,r;if(u||N(H().Exp_TableDataSourceNullError),O.$$)return c=(l=this).Mf,"string"==typeof u&&(n=null==(n=null==(n=null==(n=null==c?void 0:c.parent)?void 0:n.dataManager())?void 0:n.tables)?void 0:n[u],I(n)?N(H().Exp_TableDataSourceNullError):u=n),s=u&&!(0,P.isDMView)(u)&&ve(u),t=function(){var n,t,r,t;return c.suspendPaint(),pn(c),(n=new O.$$).bind(u),t=n.getRowCount()+1,r=n.getColumnCount(),t=l.add(e,i,o,t,r,a,f),s&&t.RIr(u),t.D3(n),s&&t.cGr(u),c.clearPendingChanges(),Cn(c),c.resumePaint(),t},n=[],s&&(u=Fe(u,ge(e,c),n),f&&f.showResizeHandle&&(f=h(h({},f),{showResizeHandle:!1})),!u.XLt())?(r=function(){return u.fUr(),ke(u),t()},u.getTable().fetch().then(r).catch(function(){u.NAr=function(){delete u.NAr,r()}})):t()},a.prototype.find=function(n,t){return this.Hq(n,t)},a.prototype.Hq=function(n,t,r){for(var e,i,o,u,a,f,e=this,i=e.U3.QP(),o=(i=!0===r&&e.zB?i.concat([e.zB]):i).length,a=0;a<o;a++)if((f=(u=i[a]).range()).row<=n&&n<f.row+B(f)&&f.col<=t&&t<f.col+D(f))return u;return A},a.prototype.findByName=function(n){return this._bt(n)},a.prototype._bt=function(n,t){for(var r,e,i,o,u,r=this,e=r.U3.QP(),i=(e=!0===t&&r.zB?e.concat([r.zB]):e).length,u=0;u<i;u++)if((o=e[u]).name().toLowerCase()===n.toLowerCase())return o;return A},a.prototype.lEr=function(t){return this.U3.QP().find(function(n){return n.jKe()===t})},a.prototype.pP=function(n,t,r,e){for(var i,o,u,a,f,l,i=this.U3,o=i.length,u=(0,L.Ec)(n,r,t,e),a=[],l=0;l<o;l++)f=i.get(l),u.containsRange(f.range())&&a.push(f);return a},a.prototype.AB=function(n,t,r,e){for(var i,o,u,a,f,i=this.U3,o=i.length,u=[],f=0;f<o;f++)(a=i.get(f)).range().intersect(n,t,r,e)&&u.push(a);return u},a.prototype.Uue=function(n){for(var t,r,e,i,o,u,a,f,t=this.U3,r=t.length,e=n.row,i=n.col,o=n.rowCount,u=n.colCount,f=0;f<r;f++)if((a=t.get(f)).range().intersect(e,i,o,u))return a},a.prototype.Dy=function(){var n,t,n,n=this,t=n.Mf,n=n.find(t.ui,t.ci);if(n)return t.j1(new L.Range(-1,n.iw,-1,n.Tx))},a.prototype.add=function(n,t,r,e,i,o,u){return this._Qt(n,t,r,e,i,o,u)},a.prototype._Qt=function(n,t,r,e,i,o,u,a){var f,l,c,s,l,f=this,l=f.Mf,c=l.parent;return f.jTt(l,n,t,r,e,i,!0),F(o)?s=o:c&&(s=c.defaultTableTheme()&&c.defaultTableTheme().name()),l=f.GM(n,t,r,e,i,u),f.WB(l,E,E,a,s)},a.prototype.WB=function(n,t,r,e,i){var o,u;if(n)return(o=this).findByName(n.name())&&N(H().Exp_TableHasSameNameError),(u=o.Mf).suspendPaint(),o.REr(n,i,u),t||u.$Dr({type:"addTable",table:n}),n.mTt||n.qSt(),!t&&n.showHeader()&&n.a5t(E,E,r,e),!t&&n.showFooter()&&n.l5t(),o.OTt(n),u.resumePaint(),n},a.prototype.REr=function(n,t,r){var e,e,i,i,e,t,o,o=this;null!=(i=null==(e=null==(e=o.Mf)?void 0:e.parent)?void 0:e.suspendOp)&&i.call(e),n.Sg(o),t&&n.style(t),r&&r.Ut.DTt([],[n],1),o.U3.push(n),null!=(t=null==(e=null==(i=o.Mf)?void 0:i.parent)?void 0:e.resumeOp)&&t.call(e)},a.prototype.GM=function(n,t,r,e,i,o){return new G(n,t,r,e,i,"medium2",o)},a.prototype.DK=function(n){var t,r,e,t=this,r=t.U3.indexOf(n);return-1<r?((e=t.Mf)&&e.Ut.DTt([n],[],2),t.U3.splice(r,1),t.Mf.$Dr({type:"removeTable",tables:[n]}),t.RTt([n],!1),n):A},a.prototype.remove=function(n,t){var r,e,i,o,u,a,f,l,c,s,v,h,d,r,e,b,w,m,g,y,i=this;if((n=Mn(n)?i.findByName(n):n)&&(t=t||0,n.s5t(),n=i.DK(n))){o=n.range(),u=i.Mf;try{if(T(u),a=o.row,f=o.row+B(o),l=o.col,c=o.col+D(o),v=s=void 0,h=n.showHeader(),d=n.headerIndex(),1!=(1&t))for(s=a;s<f;s++)for(v=l;v<c;v++)S(u,s,v,A),gn(u,s,v,A);else if(n.QL()){if(h)for(s=d,v=l;v<c;v++)u.setValue(s,v,n.getColumnName(v-o.col));for(b=(e=(r=n.dataRange()).row)+B(r),g=m=w=void 0,s=e;s<b;s++)for(v=l;v<c;v++)(m=n.BSt[Ln(n,v)])&&(g=(w=n.ftt(An(n,s)))[m.dataField()],I(g)||u.setValue(s,v,g))}else if(h)for(s=d,v=l;v<c;v++)u.setValue(s,v,n.getColumnName(v-o.col));if(2==(2&t))for(s=a;s<f;s++)for(v=l;v<c;v++)y=u.Z_(s,v)||new L.Style,n.h5(s,v,y),u.setStyle(s,v,y)}finally{_(u)}n.cL(2),n.NTr()&&I(null==(e=null==(r=i.Mf)?void 0:r.Ut)?void 0:e.G8)&&n.rkr(!0)}return n},a.prototype.move=function(n,t,r){var e,i,o,e,o,e=this,i=e.Mf;if((n=Mn(n)?e.findByName(n):n)&&0<=t&&0<=r&&(o=n.range(),0===(o=(e=e.AB(t,r,B(o),D(o))).length)||1===o&&e[0]===n)){T(i);try{n.G5t(t,r)}finally{_(i)}}},a.prototype.resize=function(n,t){var r,e,r=this;(n=r.HIr(n))&&n.NTr()||(3===(e=arguments).length?r.K5t(n,e[1],e[2]):r.K5t(n,t))},a.prototype.allowResize=function(n){return!!n&&!n.NTr()},a.prototype.HIr=function(n){var t=this;return n=Mn(n)?t.findByName(n):n},a.prototype.K5t=function(n,t,r){var e,i,o,u,a,t,a,r,f,l,c,s,e=this,i=e.Mf;if((n=e.HIr(n))&&(o=n.range(),u=n.dataRange(),t=t,t=3===(a=arguments).length?(0,L.Ec)(o.row,o.col,a[1],r):t)&&(a=B(t),r=D(t),0<=a)&&0<=r&&(f=e.AB(t.row,t.col,a,r)).length<=1){Nn(i);try{n.K5t(t),n.QL()||(l=i.conditionalFormats,c=i.b8,s=t.rowCount-o.rowCount,l&&l.qJ(o,u,s),c&&c.qJ(o,u,s))}finally{Bn(i)}}},a.prototype.all=function(){return this.U3.QP()},a.prototype.$St=function(n){for(var t,r,e,t=n||this.U3.QP(),r=t.length,e=0;e<r;e++)t[e].clearPendingChanges()},a.prototype.Yj=function(n,t,r,e){for(var i,o,u,a,f,i=[],o=this.U3,u=o.length,a=0;a<u;a++)(f=o.get(a)).Ky>=n&&f.iw>=t&&f.Ky+f.Sx<=n+r&&f.iw+f.Tx<=t+e&&i.push(f);return i},a.prototype.Zj=function(n,t,r,e){var i,o,u,a,i=this,o=i.AB(n,t,r,e),u=i.Yj(n,t,r,e),a=[];return 0<u.length?o.forEach(function(n){-1===u.indexOf(n)&&a.push(n)}):a=o,a},a.prototype.Wj=function(n,t,r){for(var e,i,o,u,e=n.length,o=0;o<e;o++)if((u=(i=n[o]).range()).row<=t&&t<u.row+B(u)&&(r<0||u.col<=r&&r<u.col+D(u)))return!0;return!1},a.prototype.jTt=function(n,t,r,e,i,o,u){var a,a,t,f;return t?Sn(t)?r<0||i<1||r+i>n.getRowCount()?(u&&N(H().Exp_TableInvalidRow),!1):e<0||o<1||e+o>n.getColumnCount()?(u&&N(H().Exp_TableInvalidColumn),!1):(a=n.tables).Pl(r,e,i,o)?(u&&N(H().Exp_TableIntersectError),!1):a.findByName(t)?(u&&N(H().Exp_TableHasSameNameError),!1):Le(n,new L.Range(r,e,i,o))?(u&&N(H().Exp_TableRangeHasFilterError),!1):(t=(a=g&&n.iT(r,e,i,o))&&a.ranges,f=!0,t&&C(a,function(n,t){if(1<B(t)||1<D(t))return u&&N(H().Exp_ArrayFormulaTable),f=!1}),f):(u&&N(H().Exp_TableNameInvalid),!1):(u&&N(H().Exp_TableEmptyNameError),!1)},a.prototype.WI=function(n,t,r,e){for(var i,o,u,a,i=[],o=this.U3,u=0;u<o.length;u++)(a=o.get(u)).Ky>=n&&a.iw>=t&&a.Ky+a.Sx<=n+r&&a.iw+a.Tx<=t+e&&i.push(a.name());return i},a.prototype.oSt=function(n,t,r,e){var i,o,u,a,f,i=this.all();if(i)for(o=(0,L.Ec)(n,t,r,e),u=i.length,a=void 0,f=0;f<u;f++)if(a=i[f].range(),o.intersect(a.row,a.col,B(a),D(a))&&!o.containsRange(a))return!0;return!1},a.prototype.Pl=function(n,t,r,e){for(var i,o,u,a,i=this.U3,o=i.length,a=0;a<o;a++)if((u=i.get(a)).range().intersect(n,t,r,e))return!0;return!1},a.prototype._getTable=function(n,t,r,e,i){for(var o,u,a,f,l,c,o=n.tables.all(),u=o.length,f=[],l=0;l<u;l++)(c=(a=o[l]).range()).row>=t&&c.col>=r&&c.row+c.rowCount<=t+e&&c.colCount+c.col<=r+i&&f.push({table:a,index:l});return f},a.prototype.mx=function(n,t,r,e,i){var o,u,a,f,l,c,s,v,h,h,o=r.tables.all(),u=o.length;if(!I(t)&&(f=e.row-t.row,l=e.col-t.col,0!==(c=this._getTable(n,t.row,t.col,t.rowCount,t.colCount)).length))for(s=0;s<u;s++)for(a=o[s],v=0;v<c.length;v++)if(h=c[v],(!i||s!==h.index)&&(h=h.table.range(),a.range().intersect(h.row+f,h.col+l,h.rowCount,h.colCount)))return r.jT(6,H().Exp_TableIntersectError),!0;return!1},a.prototype.t5t=function(n,t){for(var r,e,i,o,r=this,e=r.U3,i=0,o=e.length;i<o;i++)e.get(i).t5t(n,t);r.Mf.filterRowsVisibleInfo.rE(n,t)},a.prototype.JO=function(n,t){for(var r,e,i,o,u,a,f,l,c,s,r,v,h,d,b,w,r=this,e=r.U3,i=[],o=0,u=e.length;o<u;o++)f=(a=e.get(o)).z3(),c=(l=a.cue&&!(a.jO&&1===a.Sx))?n-1:n,K(i,f)?a.JO(c,t,!0,!0):(s=a.JO(c,t,l,E,a.cue))&&i.push(f);r=r.Mf;try{for(T(r),h=v=void 0,o=0,u=e.length;o<u;o++)v=(a=e.get(o)).pTt(),h=a.dataRange(),0<v&&v!==B(h)&&(d=v,a.showHeader()&&(d+=1),a.showFooter()&&(d+=1),b=a.range(),w=(0,L.Ec)(b.row,b.col,d,D(h)),a.K5t(w,!0))}finally{_(r)}},a.prototype.ssr=function(){var n,n;null!=(n=null==(n=this.Mf)?void 0:n.qgt)&&n.ssr()},a.prototype.bsr=function(n,t,r,e){var i,i,i,i=null==(i=null==(i=this.Mf)?void 0:i.qgt)?void 0:i.asr();i&&i.o_t(n,t,r,e)},a.prototype.tUr=function(n){var t,r,e,i,o,u,a,f,l,c,s,t=this,r=t.Mf,e=t.U3;try{for(T(r),o=i=void 0,u=0,a=e.length;u<a;u++)i=(f=e.get(u)).pTt(),o=f.dataRange(),(!n||n===f)&&0<i&&i!==B(o)&&(l=i,f.showHeader()&&(l+=1),f.showFooter()&&(l+=1),c=f.range(),s=(0,L.Ec)(c.row,c.col,l,D(o)),f.K5t(s,!0))}finally{_(r)}},a.prototype.msr=function(n,t){for(var r,e,i,o,u,a,f,l,c,s,v,h,d,b,r=this,e=r.U3,i=[],o=0,u=e.length;o<u;o++)f=(a=e.get(o)).z3(),K(i,f)?a.msr(n,t,!0):(l=a.msr(n,t,!1))&&i.push(f);r.Mf.filterRowsVisibleInfo.rE(n,t),c=r.Mf,r.ssr(),r.bsr(n,0,c.getRowCount()-n,c.getColumnCount());try{for(T(c),v=s=void 0,o=0,u=e.length;o<u;o++)s=(a=e.get(o)).pTt(),v=a.dataRange(),0<s&&s!==B(v)&&(h=s,a.showHeader()&&(h+=1),a.showFooter()&&(h+=1),d=a.range(),b=(0,L.Ec)(d.row,d.col,h,D(v)),a.K5t(b,!0))}finally{_(c)}},a.prototype.hsr=function(n,t){for(var r,e,i,o,r=this.U3,e=r.length,o=0;o<e;o++)(i=r.get(o)).hsr(n,t);this.ssr()},a.prototype.F5e=function(n,t){var r=this;r.U3.update(n),t&&t.length&&r.Mf.$Dr({type:"removeTable",tables:t})},a.prototype.xP=function(n,t){for(var r,e,i,o,u,a,f,l,c,s,v,h,d,b,w,m,g,y,r=this,e=r.U3,i=[],o=[],u=[],a=0,f=e.length;a<f;a++)c=(l=e.get(a)).z3(),((v=n<=(s=l.range()).row&&s.row+B(s)<=n+t)?u:(K(i,c)?l.xP(n,t,{ignoreUpdateDataSource:!0}):(l.QL()&&l.x4t(n,t,In(!0)),(h=l.xP(n,t))&&i.push(c)),o)).push(l);r.Mf.filterRowsVisibleInfo.aE(n,t),r.Mf.Ut.DTt(u,[],2),r.F5e(o,u),r.RTt(u,!0),d=r.Mf;try{for(T(d),e=r.U3,w=b=void 0,a=0,f=e.length;a<f;a++)b=(l=e.get(a)).pTt(),w=l.dataRange(),0<b&&b!==B(w)&&(m=b,l.showHeader()&&(m+=1),l.showFooter()&&(m+=1),g=l.range(),y=(0,L.Ec)(g.row,g.col,m,D(w)),l.K5t(y,!0))}finally{_(d)}},a.prototype.dsr=function(n,t){for(var r,e,i,o,u,a,f,l,c,s,v,h,d,b,w,m,g,y,r=this,e=r.U3,i=[],o=[],u=[],a=0,f=e.length;a<f;a++)c=(l=e.get(a)).z3(),((v=n<=(s=l.range()).row&&s.row+B(s)<=n+t)?u:(K(i,c)?l.dsr(n,t,{ignoreUpdateDataSource:!0,fromSheetRemoved:!0}):(l.QL()&&l.x4t(n,t,In(!0)),(h=l.dsr(n,t,{fromSheetRemoved:!0}))&&i.push(c)),o)).push(l);r.Mf.filterRowsVisibleInfo.aE(n,t),r.Mf.Ut.DTt(u,[],2),r.F5e(o,u),r.RTt(u,!0),d=r.Mf,r.ssr(),r.bsr(n,0,d.getRowCount()+t-n,d.getColumnCount());try{for(T(d),e=r.U3,w=b=void 0,a=0,f=e.length;a<f;a++)b=(l=e.get(a)).pTt(),w=l.dataRange(),0<b&&b!==B(w)&&(m=b,l.showHeader()&&(m+=1),l.showFooter()&&(m+=1),g=l.range(),y=(0,L.Ec)(g.row,g.col,m,D(w)),l.K5t(y,!0))}finally{_(d)}},a.prototype.vsr=function(n,t){for(var r,e,i,o,u,a,f,l,c,r=this,e=r.U3,i=[],o=[],u=e.length,f=0;f<u;f++)((c=n<=(l=(a=e.get(f)).range()).col&&l.col+D(l)<=n+t)?o:(a.vsr(n,t),i)).push(a);r.Mf.Ut.DTt(o,[],2),r.F5e(i,o),r.RTt(o,!0)},a.prototype.NP=function(n,t){for(var r,e,i,o,u,a,f,l,c,r=this,e=r.U3,i=[],o=[],u=e.length,f=0;f<u;f++)((c=n<=(l=(a=e.get(f)).range()).col&&l.col+D(l)<=n+t)?o:(a.NP(n,t),i)).push(a);r.Mf.Ut.DTt(o,[],2),r.F5e(i,o),r.RTt(o,!0)},a.prototype.d5=function(n,t,r,e,i){var o,u,a,f,l,c,s,v,h,d,o,u=this,a=(0,L.Ec)(n,t,r,e),s=[],v=u.Mf;if(1==(1&i)){for(h=[],l=(f=u.U3).length,d=0;d<l;d++)c=f.get(d),(a.containsRange(c.range())?s:h).push(c);for(l=h.length,d=0;d<l;d++)(c=h[d]).d5(n,t,r,e);v&&v.Ut.DTt(s,[],2),u.F5e(h,s)}if(2==(2&i))for(l=(f=u.U3).length,d=0;d<l;d++)c=f.get(d),a.containsRange(c.range())&&(v&&(o=null!=(o=c.style().name())?o:c.style(),v.Ut.YSt(c,"style",o)),c.style(A));return u.RTt(s,!0),s},a.prototype.RTt=function(n,t){var r;n&&0!==n.length&&(r=this.Mf,L.GC$.each(n,function(n,t){t.N5t()&&t.getSlicerData().onTableRemoved(t),t.g5t()&&(r&&r.Ut.YSt(t,zt,t.b5t()),t.OSt=[])}),g)&&zr(this.Mf,n,t)},a.prototype.OTt=function(n){n&&n.N5t()&&n.getSlicerData().onTableAdded(n)},a.prototype.BTt=function(n){for(var t,r,e,i,t=1,r,e=n,i=this.LTt();!this.FTt(e,i);)e=n+(3<n.length?"":"_")+t,t++;return e},a.prototype.LTt=function(){for(var n,t,r,e,i,o,u,a,f,l,n=[],t,r,i=0,o=this.Mf.parent.sheets;i<o.length;i++)for(a=0,f=e=(u=o[i]).tables.all();a<f.length;a++)l=f[a],n.push(l);return n},a.prototype.FTt=function(n,t){for(var r,e,i,r=0,e=t;r<e.length;r++)if((i=e[r]).name().toLowerCase()===n.toLowerCase())return!1;return!0},a.prototype.Sl=function(n,t,r){var e,i,o,e,i=!1,o=A;return(r=r||this.find(n,t))&&(r.showHeader()&&n===r.headerIndex()?(o=r.q5t(t),I(o)||(o=$(o)),i=!0):(i=(o=r.Sl(n,t)).e5t,o=o.y4)),{e5t:i,y4:o}},a.prototype.Kbt=function(n,t,r,e){var i,o=!1,u=!0;return(e=e||this.find(n,t))&&!0!==e.eTt&&(e.showHeader()&&n===e.headerIndex()?e.gUr(t,r):e.showFooter()&&n===e.footerIndex()?e.d5t(t,r):o=e.Kbt(n,t,r)),o||!1},a.prototype.pMt=function(n,t,r,e,i,o){var u,a,f,l,u=this.find(n,t);if(g&&u){if(1<r||1<e)return this.Mf.jT(0,H().Exp_ArrayFormulaTable),!1;if(a=function(){return _e(u,t)},f=function(){return 1===r&&1===e&&!I(i)&&u.NTr()},u.showHeader()&&n===u.headerIndex()&&i)return f()&&(l=u.nTt($(i),t-u.iw),u.$5t(t,l),u.setColumnDataFormula(t-u.iw,i)),!1;if(!u.eTt&&u.showFooter()&&n===u.footerIndex())I(i)||u.d5t(t,A),u.m5t(t-u.iw,i,o);else if(f()&&u.iUr(n))return a()||u.setColumnDataFormula(t-u.iw,i),!1}return!0},a.prototype.XSt=function(){for(var n,t,r,e,n=this.all(),t=0,r=n.length;t<r;t++)(e=n[t]).bindingPath()&&(e.H3=A)},a.prototype.KB=function(n,t){var r,e,i,o,u,a,e=[],i=this;if(i&&(o=i.all()))for(a=o.length-1;0<=a;a--)u=o[a],n.containsRange(u.range())&&(null==(r=this.Mf)?void 0:r.EB)!==u&&(t&&(this.Mf&&this.Mf.Ut.DTt([u],[],2),i.U3.splice(a,1)),e.push(u));return e},a.prototype.JB=function(n,t,r,e,i,o){for(var u,a,f,l,c,s,v,c,c,h,u=this,a=[],f=0,l=(n=u.all().some(function(n){return n.NTr()})||n.some(function(n){return n.NTr()})?n.slice().reverse():n).length;f<l;f++)c=n[f],v=s=void 0,o?v=c:(s=c.bindingPath()?E:c.z3(),(v=new G).Sg(u),v.fromJSON(nt(Qn(c.toJSON(E,E,!0)))),v.name(u.BTt(v.name())),a.push(v)),c=v.range(),v.rTt=!0,v.H5t(e+c.row-t,i+c.col-r),u.WB(v,o),o?((c=v.LSt)&&(c.Mf=u.Mf,c.SFe(),c.refresh(),c.onDataChanged()),this.bsr(v.Ky,v.iw,v.Sx,v.Tx)):s&&!v.NTr()&&v.V3(s),v.rTt=!1;for(f=0;f<a.length;f++)(h=a[f]).formulaFromJSON(),o||h.ZAe(n[f].name())},a.prototype.toJSON=function(n,t){var r,e,i,o,r=this.U3,e=[];if(r)for(i=0;i<r.length;i++)o=n?this.BTt(r.get(i).name()):E,e.push(r.get(i).toJSON(o,t));return 0===e.length?E:e},a.prototype.wh=function(n){var t,r,e,i,o,u,a,a,u;if(n&&(t=n.rels,e=(r=this.U3).length,t)&&0<e){for(i=[],o=0;o<e;o++)u=r.get(o),a=dn(t),a=L.XFileConstants.Rr+a,u=u._id,t.c_.push({n_:L.XFileConstants.Lr,Id:a,Type:L.RelationshipConstants.lc,Target:"../tables/"+L.XFileConstants.du+u+"."+L.XFileConstants.Cr}),i.push({n_:"tablePart","r:id":a});n.c_||(n.c_=[]),n.c_.push({n_:hr,count:e,c_:i})}},a.prototype.fromJSON=function(n,t,r,e,i){var o,u,a,f;if(n)for(this.U3.update([]),this.dl(),o=0,u=n.length;o<u;o++)a=n[o],(f=new G).Sg(this),this.U3.push(f),f.fromJSON(a,t,r,e,i)},a.prototype.yh=function(n,t,r,e){var i,o,u,a,f,l,c,s,v,h,d,d,d,b,w,m,i=n&&n.c_,o=!L.Util.ko(e);if(i&&t){for((a=L.Util.wo(e,(u=this).Mf.parent&&u.Mf.parent.v2))||u.U3.update([]),u.dl(),f=r.ITr,l=r.tables,c=r.styleManager,s=[],v=0,h=i.length;v<h;v++)d=i[v][vr],(d=(d=bn(t.c_,d))&&d.Target)&&(w=(b=l[d=d.split("/").pop().slice(0,-4)]).name,m=void 0,(m=a?u.findByName(w):m)||((m=new G(w)).Sg(u),u.U3.push(m)),m.yh(b,c,e,f&&f[d]),u.VAr(f,m,d),s.push(m.range()),o)&&m._5t(c);L.Util.Co(e)&&L.Util.Ao(u.Mf,s,E,r)}},a.prototype.VAr=function(n,t,r){var e,i,o,u,a,f,l,c,s,v,h,v,d,d,v,n,r,e,r,n,e=this;if(n&&!t.NTr()&&(i=n[r])&&(o=t.BSt)){for(u=t.dataRange().rowCount,a=[],f={},l={},c=0;c<o.length;c++)s=o[c],v=c+i.dataRange.col,h=i.data[v],delete i.data[v],(v=s.dataAreaFormula())?((d=f[a.length]=h.slice(i.dataRange.row)).length<u&&(d.length=u),a.push(we(s,v,A))):(d=de(s),(v=i.data[d]=h.slice(i.dataRange.row)).length<u&&(v.length=u),l[d]=me(s),a.push(me(s)));n=i.data,e.Mf&&e.Mf.parent&&(r=e.Mf.parent.dataManager())&&(e=ge(t),(r=r.addTable(e,{data:n,schema:{type:"columnJson",columns:l}})).fetchSync(),n=r.addView(e,a),t.RIr(n,f),O.$$)&&t.T5t(n,!0)}},a.prototype.containTableHeaderTotalRowForSheet=function(){var n,t,n,r,e,i,o,u,a,f,l,c,s,n=this.Mf;if(n&&(t=n.getSelections(),i=e=r=void 0,n=n.tables)&&t)for(o=n.U3,l=f=a=u=void 0,c=0;c<t.length;c++)for(i=(e=(r=t[c]).row)+r.rowCount-1,s=0;s<o.length;s++)if(a=(u=o.get(s)).range(),f=u.headerIndex(),l=u.footerIndex(),!r.containsRange(a)&&(e<=f&&f<=i||e<=l&&l<=i))return!0;return!1},a.prototype.containTableHeaderTotalRow=function(){var n,t,r,e,i,o,r,n,u,a,f,n=this.Mf,t=!1;if(n&&(r=n.getSelections(),o=i=void 0,e=n.tables)&&r){if(1<r.length)return t;r=r[0],f=a=u=void 0,(n=Yn(n,r))&&1===n.length&&(o=(i=r.row)+r.rowCount-1,a=(u=n[0]).headerIndex(),f=u.footerIndex(),i<=a&&a<=o||i<=f&&f<=o)&&(t=!0)}return t},a.prototype.noRoomToInsertColumn=function(){var n,t,r,t,e,i,t,r,e,n=this.Mf;return!!(n&&(t=n.getSelections(),r=n.tables)&&t&&1===t.length&&(e=(t=t[0]).row,i=t.col,t=t.colCount,r=r.find(e,i),e=n.getColumnCount(3),r)&&r.endColumn()+t>=e)},a.prototype.noRoomToInsertRow=function(){var n,t,r,t,e,i,t,r,e,n=this.Mf;return!!(n&&(t=n.getSelections(),r=n.tables)&&t&&1===t.length&&(e=(t=t[0]).row,i=t.col,t=t.rowCount,r=r.find(e,i),e=n.getRowCount(3),r)&&r.endRow()+t>=e)},a.prototype.checkTableRow=function(){var n,t,n,t,r,t,n,r,n=this.Mf;return!(!(n&&(t=n.getSelections(),n=n.tables)&&t&&1===t.length&&(r=(t=t[0]).row,t=t.col,r=(n=n.find(r,t))&&n.range(),n)&&r)||n.jO||n.oL||1!==r.rowCount)},a.prototype.checkTableCol=function(){var n,t,n,t,r,t,n,r,n=this.Mf;return!!(n&&(t=n.getSelections(),n=n.tables)&&t&&1===t.length&&(r=(t=t[0]).row,t=t.col,r=(n=n.find(r,t))&&n.range())&&1===r.colCount)},a.prototype.isAcrossTables=function(){var n,t,r,e,r,n,n=this.Mf,t=!1;if(n&&(r=n.getSelections(),e=n.tables)&&r){if(1<r.length)return t;r=r[0],(n=Yn(n,r))&&(t=1<n.length)}return t},a.prototype.isWholeTableCol=function(){var n,t,r,e,r,n,n,i,n,o,r,n=this.Mf,t=!1;return n&&(r=n.getSelections(),e=n.tables)&&r&&(1<r.length?t=!0:(r=r[0],1===(n=Yn(n,r)).length&&(i=(n=n[0]).iw,n=n.Tx,o=r.col,r=r.colCount,t=i===o&&n===r))),t},a.prototype.containTableHeader=function(){var n,t,r,e,i,o,r,n,u,n,n=this.Mf,t=!1;if(n&&(r=n.getSelections(),o=i=void 0,e=n.tables)&&r){if(1<r.length)return t;r=r[0],(n=Yn(n,r))&&1===n.length&&(n=(u=n[0]).headerIndex(),o=(i=r.row)+r.rowCount-1,i<=n)&&n<=o&&(t=!0)}return t},a.prototype.eq=function(){var n,t,r,e,i,n,o,u,a,f,n=this.Mf,t=!1;if(n&&(r=n.getSelections(),e=n.tables)&&r){if(i=n.getActiveRowIndex(),n=n.getActiveColumnIndex(),1<r.length||!e.find(i,n))return t;for(o=e.U3,u=r[0],a=void 0,f=0;f<o.length;f++)a=o.get(f),u&&u.intersect(a.Ky,a.iw,a.Sx,a.Tx)&&(t=!0)}return t},a.prototype.uSt=function(n){var t,r,e,i,o,u,a,f,l,t=-1,r,e=this.U3;if(e)for(i=e.length,f=a=u=o=void 0,l=0;l<i;l++)o=e.get(l).range(),n&&!o.intersect(n.row,n.col,n.rowCount,n.colCount)||t<(f=(u=o.row)+(a=o.rowCount)-1)&&(t=f);return t},a.prototype.sSt=function(n){var t,r,e,i,o,u,a,f,l,t=-1,r,e=this.U3;if(e)for(i=e.length,f=a=u=o=void 0,l=0;l<i;l++)o=e.get(l).range(),n&&!o.intersect(n.row,n.col,n.rowCount,n.colCount)||t<(f=(u=o.col)+(a=o.colCount)-1)&&(t=f);return t},a.prototype.yx=function(n,t,r,e,i,o,u){var a,f,l,c,s,v,h,d,b,w,u,m,g,t,y,p,C,S,T,_,R,a=this;if(!(a.Mf.isActualProtected()||n&&r&&Ge(n,r)||0===(f=a.all()).length||(l=r&&f.some(function(n){return r.equals(n.range())}))))for(u&&(d=u.shiftInfo,b=u.applyDragFillAfterTableExpand,w=u.backupTableResizedArgs,d)&&(c=d.shiftCells,s=d.isCopy,v=d.isFirst,h=d.isHeaderPaste),u=t.row,m=t.col,g=t.rowCount,t=t.colCount,h&&(-1===u&&(u=0),-1===m&&(m=0),-1===g&&(g=n.getRowCount()),-1===t)&&(t=n.getColumnCount()),y=new L.Range(u,m,g,t),S=0,T=f;S<T.length;S++)(p=T[S]).VSt&&(C=p.range(),_=r&&r.equals(C),R=r&&0!==a.Mf.Ut.getSpans(r,3).length,c?s&&v&&y.col===C.col&&y.colCount===C.colCount&&y.row>C.row&&r.col===C.col&&r.colCount===C.colCount&&r.row>C.row&&y&&C.contains(y.row,y.col,1,y.colCount)&&r&&C.containsRange(r)&&(a.PTt(p,C,y),d.ignoreFooterShiftIndex=p.footerIndex()):r&&(_||R)||(p.TTt=i,a.GTt(p,C,y,e,o,w,b),delete p.TTt))},a.prototype.GTt=function(n,t,r,e,i,o,u){var a,f,l,c,s,v,h,d,b,w,m,m,i,m,g,y,p,C,S,T,_,b,R,w,x,h,j,O,C,a=this,f=a.Mf,l=null,c=!1,s=t.row,v=t.col,h=t.rowCount,d=t.colCount,b=s+h-1,w=new L.Range(s,v,h,d);if(n.showFooter()){if(m=new L.Range(s+h-1,v,1,d),r.row===m.row&&r.col>=v&&r.col+r.colCount<=v+d)return;c=!0,w.rowCount--}if(i&&(m=n.showHeader()?h-1:h,i.push(new L.Range(s,v,m,d))),i=r.row,m=r.col,g=r.row+r.rowCount-1-(c?1:0),y=r.col+r.colCount-1,p=s+h-1-(c?1:0),C=v+d-1,S=E,T=f.getRowCount(),_=w.contains(i-1,m)&&!w.contains(i,m),c||(_=_&&y<=C&&v<=m),b=w.contains(i,m-1)&&!w.contains(i,m)&&g<=b&&i>=t.row,R=w.contains(i,m)&&!w.contains(g,y)){if(w=Zn(p,g)-s+1,x=Zn(C,y)-v+1,C<y&&(h=kn(f,new L.Range(s,1+C,h,y-C)))&&y>h.col&&(x=d),l=new L.Range(s,v,w,x),c&&(l.rowCount++,g++,p++),(S=p<g?kn(f,new L.Range(p+1,v,l.row+l.rowCount-1,d)):S)&&0<(j=g-S.row+1)){if(kn(f,new L.Range(T-Math.abs(j),v,Math.abs(j),d)))return void f.jT(6,H().Exp_TableAddRowNoEnoughRoom);!0!==u&&f.moveTo(S.row,v,l.row+l.rowCount,v,T-l.row-l.rowCount,d,rn)}}else if(_&&!c){if(l=new L.Range(i,v,r.rowCount,d),(O=kn(f,l,r))&&!r.containsRange(O))return}else if(b&&(l=new L.Range(s,m,t.rowCount,r.colCount),O=kn(f,l,r))&&!r.containsRange(O))return;_&&!c&&Vn(e)&&(n.useFooterDropDownList(!0),ze(f,n),t=n.range()),l&&!t.containsRange(l)&&(C=t.union(l),a.UTt(n,C,o,!0,!0))},a.prototype.PTt=function(n,t,r){var e,i,o,u,t,a,i,e=this,i=t.row,o=t.col,u=t.rowCount,t=t.colCount,a;new L.Range(i+(n.showHeader()?1:0),o,u-(n.showHeader()?1:0),t).contains(r.row,r.col,1,r.colCount)&&(i=new L.Range(i,o,u+r.rowCount,t),e.UTt(n,i,E,E,!0))},a.prototype.UTt=function(n,t,r,e,i){var o=this.Mf,u=o.getParent();u&&u.commandManager().execute({cmd:Gt,sheetName:o.name(),tableName:n.name(),PIr:!(!i||!n.NTr())||E,resizeToRange:t,backupTableResizedArgs:r,ignoreEventSuspend:e})},a.prototype.HL=function(n,t,r){var e,i,o,u,o,a,f,l,c,s,v,h,d,b,w,o,m,g,y,p,C,S,T,_,R,x,j,_,S,e,p,C,O,O,e,m,p,e=this,i=this.Mf,o=i.options,u=i.isActualProtected(),o=o.protectionOptions,a=!1!==o.allowSelectLockedCells,f=!1!==o.allowSelectUnlockedCells;if(!u||a||f){if(l=r.col,c=r.row,s=2,h=v=18,d=5,b=10,w=6,o=xr.TABLE_SELECT,m=xr.TABLE_CORNER_SELECT,g=xr.TABLE_COL_SELECT,y=xr.TABLE_ROW_SELECT,p=i.getActiveRowIndex(),C=i.getActiveColumnIndex(),-1===r.rowViewportIndex&&-1!==r.colViewportIndex&&(S=i.getCellRect(c,l,r.rowViewportIndex,r.colViewportIndex),(T=e.find(p,C))instanceof G)&&(_=i.Tb-i.frozenRowCount(),T.showHeader())&&p>=T.Ky&&p<T.Ky+T.Sx&&C>=T.iw&&C<T.iw+T.Tx&&T.Ky<_&&T.Ky+T.Sx>_&&r.col<T.iw+T.Tx&&r.col>=T.iw)if(n>S.x+5&&n<S.x+S.width-18&&t<S.height-5){for(R=i.getSelections(),x=0;x<R.length;x++)if(!((j=R[x]).col===r.col&&1===j.colCount&&j.row===T.Ky&&j.rowCount===T.Sx||j.col===r.col&&1===j.colCount&&-1===j.row&&j.rowCount===i.getRowCount()))return k(T,g,c,l,u,a,f)}else if(n>S.x+18)return k(T,"default",c,l,u,a,f);if(_=i.getCellRect(c,l),e.find(c,l)instanceof G&&-1!==r.colViewportIndex&&-1!==r.rowViewportIndex){if(S=!1,T=e.find(c,l),e=e.find(p,C),R=i.getSelections(),p=i.options.rightToLeft,C=!0,1===R.length&&(O=R[0]).row<=c&&O.row+O.rowCount>c&&O.col<=l&&O.col+O.colCount>l&&(C=!1),T===e&&(S=!0),l===T.iw&&c===T.Ky){if(C&&S&&(n<=_.x+2||t<=_.y+2))return k(T,o,c,l,u,a,f);if((!p&&n>_.x+2&&n<_.x+18||p&&n<_.x+_.width-2&&n>_.x+_.width-18)&&t>_.y+2&&t<_.y+6)return k(T,m,c,l,u,a,f);if(n>_.x+18&&t>_.y+2&&t<_.y+6)return k(T,g,c,l,u,a,f);if((!p&&n>_.x+2&&n<_.x+18||p&&n<_.x+_.width-2&&n>_.x+_.width-18)&&t>_.y+6)return k(T,y,c,l,u,a,f)}if(l===T.iw+T.Tx-1&&c===T.Ky){if(C&&S&&(n>=_.x+i.getColumnWidth(l)-2||t<=_.y+2))return k(T,o,c,l,u,a,f);if(n<_.x+i.getColumnWidth(l)-2&&t>_.y+2&&t<_.y+6)return k(T,g,c,l,u,a,f)}if(l===T.iw&&c===T.Ky+T.Sx-1){if(C&&S&&(n<=_.x+2||t>=_.y+i.getRowHeight(c)-2))return k(T,o,c,l,u,a,f);if((!p&&n>_.x+2&&n<_.x+18||p&&n<_.x+_.width-2&&n>_.x+_.width-18)&&t<_.y+i.getRowHeight(c)-2)return k(T,y,c,l,u,a,f)}if(C&&S&&l>T.iw&&l<T.iw+T.Tx&&c===T.Ky&&t<=_.y+2)return k(T,o,c,l,u,a,f);if(l>T.iw&&l<T.iw+T.Tx&&c===T.Ky&&t>_.y+2&&t<_.y+6)return k(T,g,c,l,u,a,f);if(C&&S&&c>T.Ky&&c<T.Ky+T.Sx&&l===T.iw&&n<=_.x+2)return k(T,o,c,l,u,a,f);if(c>T.Ky&&c<T.Ky+T.Sx&&l===T.iw&&(!p&&n>_.x+2&&n<_.x+18||p&&n<_.x+_.width-2&&n>_.x+_.width-18))return k(T,y,c,l,u,a,f);if(O=i.getColumnWidth(T.iw+T.Tx-1),e=i.getRowHeight(T.Ky+T.Sx-1),m=_.x+O,p=_.y+e,S&&(c>T.Ky&&c<T.Ky+T.Sx&&l===T.iw+T.Tx-1&&m-2<=n&&n<=m||l>T.iw&&l<T.iw+T.Tx&&c===T.Ky+T.Sx-1&&p-2<=t&&t<=p)){if(l===T.iw+T.Tx-1&&c===T.Ky+T.Sx-1&&p-10<=t&&m-10<=n)return A;if(C)return k(T,o,c,l,u,a,f)}}}return A},a.prototype.wR=function(n,t){var r,e,r,i,o,u,r=this,e=r.Mf;if(r.find(n,t)instanceof G){for(i=0,(r=r.find(n,t)).oL&&(i=1),o=0,r.jO&&(o=1);0<n&&0===e.getRowHeight(n-1);)n--;if(1===o&&t===r.iw&&n===r.Ky)return u=Rn(e,r,!0),_n(u,r.iw+r.Tx-1,u);if(t===r.iw&&n===r.Ky)return u=Rn(e,r,!0),_n(u,r.iw+r.Tx-1,u);if(n>r.Ky&&n<r.Ky+r.Sx-i&&t===r.iw)return n===r.Ky+o?(n=Rn(e,r,!0),_n(n,r.iw+r.Tx-1,n)):_n(n-1,r.iw+r.Tx-1,n-1)}return null},a.prototype.xR=function(n,t){var r,e,r,i,o,u,u,a,f,l,c,s,s,v,a,h,r=this,e=r.Mf;if(r.find(n,t)instanceof G){for(i=0,(r=r.find(n,t)).oL&&(i=1),o=0,r.jO&&(o=1),u=e.getRowCount()-1;n+1<e.getRowCount()&&0===e.getRowHeight(n+1);)n++;if(u!==n&&t===r.iw+r.Tx-1&&n<r.Ky+r.Sx-i)return u=r.Ky+r.Sx,l=(a=r.iw)+(f=r.Tx)-1,c=_n(n+1,r.iw,n+1),n===u-i-1&&(r.VSt?(s=jn(e,r),1===i&&Fn(e,r,u,s,a,l,1,!0,!1,!0)||(a=(v=(s=kn(e,new L.Range(u,a,s-u+1,l-a+1)))&&s.row)===u,u!==e.getRowCount()&&(a?Be:De)(e,r,n,1,!0))):c=_n(n,1+l,n)),c;if(e.getRowCount()-1===n&&t===r.iw+r.Tx-1&&0===i){for(h=r.Ky+o;h+1<e.getRowCount()&&0===e.getRowHeight(h);)h++;return h+1===e.getRowCount()&&0===e.getRowHeight(h)?_n(r.Ky,r.iw,r.Ky):_n(h,r.iw,h)}}return null},a.prototype.fR=function(n,t){var r,e,r,i,o,u,r=this,e=r.Mf;if(r.find(n,t)instanceof G){for(i=0,(r=r.find(n,t)).oL&&(i=1),o=0,r.jO&&(o=1);0<t&&0===e.getColumnWidth(t-1);)t--;if(t===r.iw&&(n===r.Ky||n===r.Ky+o))return{col:u=xn(e,r),leadingCellCol:u,row:r.Ky+r.Sx-1-i};if(t===r.iw&&(n===r.Ky||n===r.Ky+o))return{col:u=xn(e,r),leadingCellCol:u,row:r.Ky+r.Sx-1-i};if(t>r.iw&&t<r.iw+r.Tx&&(n===r.Ky||n===r.Ky+o))return t===r.iw?{col:t=xn(e,r),leadingCellCol:t+1,row:r.Ky+r.Sx-1-i}:{col:t-1,leadingCellCol:t-1,row:r.Ky+r.Sx-1-i}}return null},a.prototype.SB=function(){for(var n,t,r,e,i,n,t=this.U3,r=t.length,i=0;i<r;i++)(e=t.get(i)).w5t()},a.prototype.cL=function(n,t){for(var r,e,i,o,u,a,f,a,f,r,e=this.U3,i=e.length,o=0;o<i;o++)u=e.get(o),n?(a=u.Ky,f=u.Ky+u.Sx-1,a<=t&&t<=f&&u.cL(0)):(a=u.iw,f=u.iw+u.Tx-1,a<=t&&t<=f&&u.cL(0))},a.prototype.AJ=function(n,t,r,e,i){for(var o,u,a,f,l,o=this.AB(n,t,r,e),u=[],a=0,f=o.length;a<f;a++)l=o[a].dataRange(),i?l.rowCount+=r:l.colCount+=e,u.push(l);return u},Ar=a,j.TableManager=Ar,(n=Lr=j.TableRemoveOptions||(j.TableRemoveOptions={}))[n.none=0]="none",n[n.keepData=1]="keepData",n[n.keepStyle=2]="keepStyle",L.GC$.extend(L.Y8.prototype,{D5t:function(n,t){var r,e,e,r,e=this.G8;e&&(e.tableChanges||(e.tableChanges=[]),delete(e=e.tableChanges).isRestored,e.push({type:"changeTableManager",table:n,oldTableManager:t}))},YSt:function(n,t,r,e){var i,o,o,i,o=this.G8;o&&(o.tableChanges||(o.tableChanges=[]),delete(o=o.tableChanges).isRestored,o.push({type:nr,table:n,name:t,value:r,newValue:e}))},DTt:function(n,t,r){var e,i,i,e,e=this,i=e.G8;i&&(i.tableChanges||(i.tableChanges=[]),i=i.tableChanges,e=e.QSt,delete i.isRestored,i.push({type:Zt,tableList:e.U3.slice(),changedTables:n,addedTables:t,changeType:r}))},A5t:function(n,t,r,e,i,o){var u,a,a,u,a=this.G8;a&&(a.tableChanges||(a.tableChanges=[]),delete(a=a.tableChanges).isRestored,a.push({tableName:n.name(),type:Qt,tableColumn:t,index:o,name:r,value:e,newValue:i}))},HTt:function(n,t,r){var e,i,o,e,e,e=this,i,o=n.getValue(t,r).value,e=e.G8;e&&(e.tableChanges||(e.tableChanges=[]),delete(e=e.tableChanges).isRestored,e.push({type:tr,bindingManager:n,row:t,col:r,oldValue:o}))},B5t:function(n,t,r,e,i){var o,u,u,o,u=this.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(u=u.tableChanges).isRestored,u.push({type:rr,table:n,key:e,row:t,count:r,stateType:i}))},_Tt:function(n,t,r){var e,i,o,e,i=this.G8;i&&(i.tableExpressionChanges||(i.tableExpressionChanges=[]),(o=i.tableExpressionChanges).push({type:ar,table:n,expression:t,col:r}))},ETt:function(n,t,r,e){var i,o,u,i,o=this.G8;o&&(o.sheetExpressionChanges||(o.sheetExpressionChanges=[]),(u=o.sheetExpressionChanges).push({type:fr,table:n,expression:t,row:r,col:e}))},zTt:function(n,t){var r,e;n&&Ye(e=(r=this).QSt,n._bindingChanges,!0,function(){r.YAr(n),t&&t()})},YAr:function(w){var m,g,n,t,r,e,i;if(w){for(m=null,g=this.QSt,n=function(n){var r,e,t,i,o,u,a,f,l,f,c,s,v,h,d,b,r=w[n];switch(r.type){case Zt:if(2===r.changeType)for(t=function(n){var t,n,t=r.changedTables[n],n=g.U3.findIndex(function(n){return n.name===t.name});0<=n&&g.U3.splice(n,1)},i=0;i<r.changedTables.length;i++)t(i);else if(1===r.changeType&&r.addedTables)for(o=r.addedTables,i=0;i<o.length;i++)(u=o[i])&&"Object"===u.constructor.name&&(u=$e(g,u),g.U3.push(u));break;case Qt:e=g.findByName(r.tableName),a=r.tableColumn,"name"===r.name&&(a=r.value),0<=(f=e.BSt.findIndex(function(n){return n.name()===a}))&&((l=e.BSt[f])[r.name](r.newValue),"name"===r.name)&&e.I5t(a,r.newValue,f);break;case nr:(e=r.table)?(f=r.name,c=r.newValue,f===V?(s=c.row,v=c.col,h=c.rowCount,d=c.colCount,e.wEr({row:s,col:v,rowCount:h,colCount:d})):f===ir?(c=c&&c.map(function(n){var t;return n&&"Object"===n.constructor.name?((t=new J).fromJSON(n),t.onChange=e.pEr.bind(e),t):n}),e.BSt=c):f===zt?(c=c&&c.map(function(n){var t;return n&&"Object"===n.constructor.name?((t=new L.Style).fromJSON(n,!1,null),t):n}),e.OSt=c):("style"===f&&c&&c.buildInName&&(c=p.TableThemes[c.buildInName.toLowerCase()]),e[f](c))):"name"===r.name&&(e=g.findByName(r.value))&&e.name(r.newValue);break;case"changeTableManager":break;case tr:(b=Je(g,r.bindingManager)).setValue(r.row,r.col,r.oldValue);break;case rr:m=e=r.table,Pe(e="Object"===e.constructor.name?g.findByName(e.name):e,r.row,r.count,r.key,r.stateType)}},t=0;t<w.length;t++)n(t);if(m)for(m.LSt&&m.LSt.refresh(),r=this.Mf.slicers&&this.Mf.slicers.all(),t=0;t<r.length;t++)if((e=r[t]).LSt===m.LSt&&e.gmi)for(i=0;i<e.gmi.length;i++)e.gmi[i].onDataChanged()}},VTt:function(n,t){var r,e;n&&Ye(e=(r=this).QSt,n.bindingChanges,E,function(){r.ZAr(n),t&&t()})},ZAr:function(n){var t,r,e,t,i,o,u,a,f,l,c,s,v,h,d,b,f,w,b,m,g,m,g,t,r,e,y,y,r;if(n)for(i=this.QSt,o=n.length-1;0<=o;o--)switch(a=void 0,(u=n[o]).type){case Zt:for(f=u.tableList,l=[],s=(c=i.U3).length,v=f.map(function(n){return n.name()}),h=0;h<s;h++)d=c.get(h),v.indexOf(d.name())<0&&l.push(d);b=u.changedTables,i.F5e(f,l),b&&0<b.length&&b.forEach(function(n){n&&(n.w5t(),n.qSt())});break;case Qt:a=i.findByName(u.tableName),(0<=(f=u.index)?w=a.BSt[f]:u.tableColumn)[u.name](u.value),"name"===u.name&&(b=u.newValue,m=u.value,g=null!=f?f:a.getColumnIndexInTable(m),I(b)||-1===g||a.I5t(b,m,g));break;case nr:a=u.table,m=u.name,g=u.value,m===V?(t=g.row,r=g.col,e=g.rowCount,y=g.colCount,a.wEr({row:t,col:r,rowCount:e,colCount:y}),null!=(r=null==(t=this.Mf)?void 0:t.oMt)&&r.gF(g.row,g.col,g.rowCount,g.colCount),a.LSt&&a.LSt.refresh(),a.jS.ssr()):m===ir?a.BSt=g:m===or?(null!=(e=a.getColumn(g.column))&&e.dataAreaFormula(g.expr),a.NTr()&&-1<(y=a.getColumnIndexInTable(g.column))&&a.tGr(a.BSt[y],a.startColumn()+y)):m===ur?null!=(t=a.getColumn(g.column))&&t.footerFormula(g.expr):m===zt?a.OSt=g:m===qt?a.TEr(g):a[m](g),a.cL(0);break;case"changeTableManager":a=u.table,r=u.oldTableManager,a.k5t(r);break;case tr:u.bindingManager.setValue(u.row,u.col,u.oldValue);break;case rr:Pe(u.table,u.row,u.count,u.key,u.stateType)}},YTt:function(n){var t,r,e,i,e,o,e;if(n){for(t=void 0,r=n.length-1;0<=r;r--)(e=n[r]).type===ar&&(t=e.table,i=e.expression,e=e.col,o=void 0,o=t.BSt[e].footerFormula())&&-1<(e=Hn(o))&&(o.arguments[e]=i);t&&t.w5t()}}}),L.Y8.ch(Ht,{priority:7e3,isValid:function(n){var t,t,n,t,n=-1<["getValue","setValue"].indexOf(n),t=0<(null==(t=null==(t=this.Mf.tables)?void 0:t.U3)?void 0:t.length);return!n||t},init:function(){this.QSt=new Ar(this.Mf)},clearPendingChanges:function(n){var t=this.tables;t&&t.$St(n.tableList)},undoAddRows:function(n){var t,r,t,e,i,o,t=n.sheetArea;!I(t)&&t!==L.SheetArea.viewport||(t=(r=this).Mf,e=n.row,i=n.rowCount,(o=t.tables.AB(e,-1,i,-1)).forEach(function(n){n.x4t(e,i,In(!0))}))},getValue:function(n){var t,t,t,r,e,i,o,u;0<(null==(t=null==(t=this.Mf.tables)?void 0:t.U3)?void 0:t.length)&&(t=n.row,r=n.col,e=n.sheetArea,i=this.Mf.tables,u=o=void 0,3===e)&&i&&(o=i.find(t,r))&&(u=i.Sl(t,r,o),n.isValueGet=u.e5t,n.value=u.y4)},setValue:function(n){var t,r,e,i,o,i,u,a,t=n.row,r=n.col,e=n.value,i=n.sheetArea,o=this.Mf.tables;3===i&&o&&(i=o.find(t,r))&&(a=void 0,(u=n.changes)&&!(a=u.tableChanges)&&(u.tableChanges=[]),n.isValueSet=o.Kbt(t,r,e,i))},applyChanges:function(n){var t,r,n,e,r,t=this,r=n.changes,n=n.isUndo;r&&(e=r.tableChanges,r=r.tableExpressionChanges,e&&(qe(t.QSt,e),n?t.VTt(e):t.zTt(e)),n)&&r&&t.YTt(r),t.QSt.dl()},undo:function(n){var t,r,n,e,t=this,r=n.tableChanges,n=n.tableExpressionChanges;r&&!r.isRestored&&(e=!0,this.VTt(r,function(){var n;e||(n=t.QSt)&&n.all().some(function(n){return n.NTr()})&&t.Mf.zw()}),e=!1),n&&this.YTt(n),this.QSt.dl()}}),L.Workbook.ch(Ht,{init:function(){L.Commands.D4t(this.commandManager()),this.customTableThemes=new y.CustomTableThemeManager(this,{create:function(){return new p.TableTheme},buildIn:p.TableThemes,prefixName:"TableStyle"})},dispose:function(){this.customTableThemes&&(this.customTableThemes.L0(),this.customTableThemes=null)},onCultureChanged:function(){H()},preFromSJSFormat:function(n,t,c){var r,e,s,e,i,o,u,a,f,l,v,h,n,t,r=this,e=c&&!1===c.includeStyles;if(!e&&(e=(s=n.styles)&&s.tableStyles,i=function(n){var t,t,t,t,r,r,r,r,e,i,o,t,i,u,a,f,l,i=s.extLst;if(i)for(t=null!=(t=(o=!L.Util.ko(c))?Array.isArray(null==(t=i.slicerStylesNode)?void 0:t.slicerStyle)?null==(t=i.slicerStylesNode)?void 0:t.slicerStyle:[null==(t=i.slicerStylesNode)?void 0:t.slicerStyle]:i.slicerStyleNodes)?t:[],i=null!=(r=o?Array.isArray(null==(r=i.timelineStylesNode)?void 0:r.timelineStyle)?null==(r=i.timelineStylesNode)?void 0:r.timelineStyle:[null==(r=i.timelineStylesNode)?void 0:r.timelineStyle]:i.timelineStyleNodes)?r:[],u=d(d([],t,!0),i,!0),a=0;a<u.length;a++)if(f=u[a],(l=o?null==(e=null==f?void 0:f.kSt)?void 0:e.name:null==f?void 0:f.name)===n)return!0;return!1},o=t.styleManager,e)){if(o.addDefaultStyleName("defaultTableStyle",e.defaultTableStyle||"TableStyleMedium2"),0<(u=on(e.count,0))&&(a=Q(e,"tableStyle")))for(r.customTableThemes.xur=[],f=0,l=a;f<l.length;f++)(v=l[f])&&0<v.count&&0==+v.pivot&&((h=new p.TableTheme).yh(v,o),i(v.name)||r.customTableThemes.xur.push(h));r.defaultTableTheme&&r.customTableThemes&&(n=o.getDefaultStyleName("defaultTableStyle"),t=r.customTableThemes.get(n)?n:n.replace(/^TableStyle/,""),r.defaultTableTheme(t))}},preToSJSFormat:function(n,t,r){var e,r,i,o,u,a,f,l,c,s,e=r&&r.fileType===L.OpenSaveFileType.excel,r=r&&!1===r.includeStyles;if(e&&!r)for(o=0,u=i=this.mp;o<u.length;o++)l=(f=(a=u[o]).Mf).getRowCount(),c=f.getColumnCount(),(a._gi===L.SheetType.tableSheet||a._gi===L.SheetType.ganttSheet)&&0<l&&0<c&&(s=f.name().replace(/ /g,"").replace(/\-/g,"_")+"Table",f.tables.WB(new G(s,0,0,l,c,a.hl,{showHeader:!1})))},wh:function(n,t,r){var e,i,o,u,a,f,l,c,s,v,h,d,b,w,m,m,g,g,e=this,i=n.tables,o=t&&t.styleManager,u=r&&r.fileType===L.OpenSaveFileType.excel,a=r&&!1===r.includeStyles;if(!a){for(f={},c=(l=0,L.Ap)(e);l<c;l++)if((s=(0,L.Tp)(e,l))&&(h=(v=s.tables)&&v.all())&&0<h.length)for(d=0,b=h;d<b.length;d++)w=b[d],m=(i=i||(n.tables={}))[L.XFileConstants.du+w._id]={},w.wh(m,n,t,r,f),w.style()&&!w.getStyleName()&&((m=new p.TableTheme).fromJSON(w.style().toJSON()),m.name(Zr(e,w.name())),o.addTableStyle(m.wh(o))),u&&!a&&s.NMi&&v.DK(w);e.customTableThemes.all().forEach(function(n){n&&o.addTableStyle(n.wh(o))}),g=(g=e.defaultTableTheme()||p.TableThemes.medium2).builtInName()?"TableStyle".concat(g.name()):g.name(),o.addDefaultStyleName("defaultTableStyle",g)}},fromJson:function(n){var t,r,e,e,t=this,r=[],e=n.tableStyles;e&&(e.forEach(function(n){var t=new p.TableTheme;t.fromJSON(n),r.push(t)}),t.customTableThemes.xur=r),(e=n.defaultTableStyle)&&t.defaultTableTheme(e)},toJson:function(n){var t,r,t,t=this,r=t.customTableThemes.all(),t=t.Bur;r&&0<r.length&&(n.tableStyles=r.map(function(n){return n.toJSON()})),t&&(n.defaultTableStyle=t)}})},"./dist/plugins/table/table.ns.js":function(n,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var r=r("./dist/plugins/table/table.res.en.js");t.SR={en:r}},"./dist/plugins/table/table.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Table_Var=t.Table_StdDev=t.Table_Sum=t.Table_Min=t.Table_Max=t.Table_Count_Numbers=t.Table_Count=t.Table_Average=t.Table_None=t.Table_Total=t.Exp_TableAddRowNoEnoughRoom=t.Exp_TableAddRowIntersectTable=t.Exp_TableAddRowIntersectSpan=t.Exp_TableDeleteCountInvalid=t.Exp_ColParamOutOfRange=t.Exp_RowParamOutOfRange=t.Exp_TableResizeToTable=t.Exp_TableResizeWithHidden=t.Exp_TableResizeWithFilter=t.Exp_TableResizeToSpan=t.Exp_TableResizeInvalidRange=t.Exp_ArrayFormulaTable=t.Exp_TableResizeOutOfRange=t.Exp_TableMoveOutOfRange=t.Exp_TableDataSourceNullError=t.Exp_TableRangeHasFilterError=t.Exp_TableHasSameNameError=t.Exp_TableIntersectError=t.Exp_TableInvalidColumn=t.Exp_TableInvalidRow=t.Exp_TableNameInvalid=t.Exp_TableEmptyNameError=t.Exp_DragDropChangePartOfTable=t.Exp_DragDropShiftTableCell=void 0,t.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",t.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",t.Exp_TableEmptyNameError="The table name cannot be empty.",t.Exp_TableNameInvalid="The table name is not valid.",t.Exp_TableInvalidRow="Invalid row index or row count.",t.Exp_TableInvalidColumn="Invalid column index or column count.",t.Exp_TableIntersectError="The tables cannot be intersected.",t.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",t.Exp_TableRangeHasFilterError="The current table range contains a filter range.",t.Exp_TableDataSourceNullError="Table datasource cannot be null.",t.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",t.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",t.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",t.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",t.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",t.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",t.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",t.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",t.Exp_RowParamOutOfRange="The param row out of data range of table.",t.Exp_ColParamOutOfRange="The param col out of data range of table.",t.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",t.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",t.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",t.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",t.Table_Total="Total",t.Table_None="None",t.Table_Average="Average",t.Table_Count="Count",t.Table_Count_Numbers="Count Numbers",t.Table_Max="Max",t.Table_Min="Min",t.Table_Sum="Sum",t.Table_StdDev="StdDev",t.Table_Var="Var"},DataManager:function(n){n.exports=GC.Data},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets},Bindings:function(n){n.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine},Filters:function(n){n.exports=GC.Spread.Sheets.Filter}},e={},n=i("./dist/plugins/table/table.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Tables=n}();