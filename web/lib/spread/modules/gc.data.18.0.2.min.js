/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t](n,n.exports,e)),n.exports}i={"./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js":function(t,n,i){var r,e,u,o;function s(t){var n,n,n=u[t];return void 0!==n||(n=u[t]={exports:{}},e[t].call(n.exports,n,n.exports,s)),n.exports}e={"./dist/src/calculation/calc-array-ex.js":function(t,n,i){"use strict";var r,m,e,u,o;function s(){return null!==o&&o.apply(this,arguments)||this}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CalcArrayEx=void 0,m=i("CalcEngine"),o=m.CalcArray,r(s,o),s.prototype.toArray=function(t,n,i,r,e,u,o){var s,c,f,a,h,l,v,d,p,w,b;if(void 0===n&&(n=!0),a=f=0,h=[],d=m.Convert.CalcConvertedError,f=(c=this).getRowCount())for(p=0;p<f;p++)for(n||h.push(v=[]),w=(null==(s=c.array[p])?void 0:s.length)||0,a=Math.max(a,w),b=0;b<w;b++){if(l=c.getValue(p,b),c.referenceInTwoDimension&&(0,m.LE)(l)&&(l=l.getValueByIndex(0)),i&&(0,m.BJ)(l))return(h=[l]).isError=!0,h;if(l=(0,m.Nbt)(l,t,!1,u),r&&l===d)return(h=[l]).isConvertError=!0,h;(n?h:v).push(l)}return h.rowCount=f,h.colCount=a,h.rangeCount=1,h},s.prototype.getValue=function(t,n){var i,r,e,i=this.array,r=t;return"number"!=typeof n&&(r=t.row,n=t.column),r<0||n<0||r>=i.length||!i[r]||n>=i[r].length?m.errors.Value:this.array[r][n]},n.CalcArrayEx=s},"./dist/src/calculation/calcSource.js":function(t,n,i){"use strict";var r,e,f,a,u,o,s,c;function h(){this.row=[],this.field=[]}function l(t,n){var t=c.call(this,t)||this;return t.nM=n,t.MEt={},t}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerCalcSource=n.DataManagerReference=void 0,e=i("CalcEngine"),f=i("./dist/src/dataSource/utils.js"),a=i("./dist/src/calculation/calc-array-ex.js"),h.prototype.parseRowIndex=function(t,n,i){var r=n.num;return n.relative||(-1===n.num?r=t-1:r--),i*n.relative+r},h.prototype.getValueImp=function(t){var n,i,r,e,u,o,s,c,n=this.table.length();if(this.field.vEt&&this.field.vEt[this.rowString])return this.field.vEt[this.rowString];if(i=[],0===this.row.length)for(r=0;r<n;r++)i.push(this.field.getValue(r));for(e=0;e<this.row.length;e++)if(2===(u=this.row[e]).length)for(o=this.parseRowIndex(n,u[0],t),s=this.parseRowIndex(n,u[1],t),c=o;c<=s;c++)i.push(this.field.getValue(c));else if(u.type)if("key"===u.type)r=this.table.mEt(u.value),i=i.concat(this.field.getValues(r));else for(c="odd"===u.type?1:0;c<n;c+=2)i.push(this.field.getValue(c));else r=this.parseRowIndex(n,u,t),i.push(this.field.getValue(r));if(1===i.length)i=i[0];else if(0===i.length)return null;return(0,f.isArray)(i)&&(i=(0,f.isArray)(i[0])?new a.CalcArrayEx(i):new a.CalcArrayEx([i])),this.gEt||(this.field.vEt=this.field.vEt||{},this.field.vEt[this.rowString]=i),i},h.prototype.getValuesImp=function(t,n,i,r,e,u){var t=this.field.getValues(t,n,i,r,e,u);return(0,f.isArray)(t[0])?new a.CalcArrayEx(t):new a.CalcArrayEx([t])},h.prototype.getValue=function(t,n,i,r,e,u){return this.pEt(),(0,f.isArray)(t)?this.getValuesImp(t,n,i,r,e,u):this.getValueImp(t)},h.prototype.pEt=function(){this.field=this.table.rRt(this.Pq)},n.DataManagerReference=h,c=e.CalcSource,r(l,c),l.prototype.yEt=function(){return this._allFieldNames},l.prototype.wEt=function(t,n){2===arguments.length?this.MEt[t]=n:1===arguments.length&&delete this.MEt[t]},l.prototype.pe=function(t,n,i,r,e,u,o){this.DJ=t,this.ak=n,this.pwn=i,this.GOt=r,this.uye=e,this.sye=u,this.R6t=o},l.prototype.getField=function(t){var n=this.DJ,i=this.ak,r=this.pwn,e=this.uye,u=this.sye,o=this.R6t;return t.getValue(n,i,r,e,u,o)},l.prototype.getValue=function(){var t=this.GOt;return t&&"number"==typeof this.DJ?this.nM._getValueByField(t,this.DJ):null},n.DataManagerCalcSource=l},"./dist/src/calculation/functions/aggregationFunctions/dataModel.js":function(t,n,i){"use strict";var m,r,j,y,o,g,s;function e(){}function u(t,n,i,r,e,u,o,s){var t,n,i,c,f,a,h,l,v,d,r,p,w,b,r,p,t=O(t,r);if(e>t.length)return m.Errors.Value;if(u>(n=O(n,r)).length)return m.Errors.Value;for(i=O(i,r),r===y.FieldHeaders.NoButGenerate&&(t.forEach(function(t,n){return t.itn="Row Field ".concat(n+1)}),n.forEach(function(t,n){return t.itn="Column Field ".concat(n+1)}),i.forEach(function(t,n){return t.itn="Value ".concat(n+1)})),_(c=t.map(function(t){return t}),n),_(c,i),f=new Map(c.map(function(t,n){return[t._getName(),"c".concat(n+1)]})),a=c.map(function(t,n){return"c".concat(n+1)}),h=c[0].jit,l=[],v=function(i){var r={};a.forEach(function(t,n){return r[t]=c[n].Sl(i)}),l.push(r)},d=0;d<h;d++)v(d);return r=t.map(function(t){return f.get(t._getName())}),p=n.map(function(t){return f.get(t._getName())}),w=i.map(function(t){return f.get(t._getName())}),(b=new j.DataManager).addTable("t1",{data:l}).fetchSync(),r={tableName:"t1",rowColumns:r,colColumns:p,valueColumns:w,rowTotalDepth:e,colTotalDepth:u,rowSortOrder:o,colSortOrder:s},p=(new g).generate(r),m.Convert.BJ(p)?p:(b.generateTreeData(p),{dataSource:b,tableName:"t1",rowFields:t,colFields:n,valueFields:i,fieldNameToColumnNames:f,treeData:p})}function _(t,n){n.forEach(function(n){t.findIndex(function(t){return t._getName()===n._getName()})<0&&t.push(n)})}function O(i,t){var r,e,n,u;if(o(i))return[];for(r=[],e=y.FieldHeaders.YesAndDoNotShow===t||y.FieldHeaders.YesAndShow===t,n=function(t){var n={lp:s++,zkr:e?1:0,Bwt:t,rT:i,_getName:c,jit:e?i.rowCount-1:i.rowCount,Sl:function(t){return this.rT[this.zkr+t][this.Bwt]},Vkr:function(){for(var t,n,t=[],n=0;n<this.jit;n++)t.push(this.Sl(n));return t}};e&&(n.itn=n.Sl(-1)),r.findIndex(function(t){return t._getName()===n._getName()})<0&&r.push(n)},u=0;u<i.colCount;u++)n(u);return r}function c(){return"c"+this.lp.toString(36)}Object.defineProperty(n,"__esModule",{value:!0}),n.Ykr=n.TreeDataContextGenerator=void 0,m=i("CalcEngine"),r=i("Common"),j=i("./dist/src/dataManager.js"),y=i("./dist/src/calculation/functions/aggregationFunctions/interface.js"),o=r.Common.lt.ht,e.prototype.generate=function(t){var n,t,t,n=this;return this.Zkr=t,this.s_i={},this.Mur={},this.Wkr={},this.Qkr=1,this.Jkr()?m.Errors.Value:(t=function(t){return n.Mur[t]},t={verticalExpansionTrees:this.Kkr(),horizontalExpansionTrees:this.Xkr(),crossCells:[],cellNodeGetter:t},this.qkr(t.crossCells),this.$kr(),t)},e.prototype.Jkr=function(){var t,n,i,r,t;return!!o(this.Zkr)||(n=(t=this.Zkr).rowColumns,i=t.colColumns,r=t.colTotalDepth,!!((t=t.rowTotalDepth)&&n&&t>n.length))||!!(r&&i&&r>i.length)},e.prototype.Kkr=function(){var t=this.Zkr,n=t.tableName,t=t.rowColumns;return this.tDr(n,t,"V")},e.prototype.Xkr=function(){var t=this.Zkr,n=t.tableName,t=t.colColumns;return this.tDr(n,t,"H")},e.prototype.tDr=function(i,t,r){var e,u,o,e=this,u=[];return t&&(o=null,t.forEach(function(t,n){var t={templateCell:{dataColumn:{tableName:i,columnName:t},dataSetting:{type:"Group"},expansionDirection:r,sorts:[{asc:t}]},children:[],leftParent:"V"===r?o:null,upParent:"H"===r?o:null,data:{groups:[]},indexOfLeftParentChildren:o?0:-1,indexOfUpParentChildren:-1};e.s_i["".concat(r,"-").concat(n)]=t,o?o.children.push(t):u.push({root:t}),o=t})),u},e.prototype.qkr=function(t){var n,i,r,n;0!==(this.Zkr.valueColumns||[]).length&&(i=this.Zkr.rowColumns||[],r=this.Zkr.colColumns||[],0<i.length&&0<r.length?(this.nDr(t),this.eDr(),this.iDr()):0<i.length?this.eDr():0<r.length&&this.iDr())},e.prototype.nDr=function(e){for(var u,t,o,s,n,c,i,f,r,u=this,t=this.Zkr,o=t.tableName,s=t.valueColumns,n=t.rowColumns,c=t.colColumns,i=function(t){for(var i,n,r,i=f.s_i["V-".concat(t)],n=function(t){var n=f.s_i["H-".concat(t)];s.forEach(function(t){u.rDr(o,t,i,n,e)})},r=c.length-1;0<=r;r--)n(r)},f=this,r=n.length-1;0<=r;r--)i(r)},e.prototype.eDr=function(){for(var i,t,r,e,n,u,o,i=this,t=this.Zkr,r=t.tableName,e=t.valueColumns,n,u=function(n){e.forEach(function(t){i.rDr(r,t,i.s_i["V-".concat(n)],null)})},o=t.rowColumns.length-1;0<=o;o--)u(o)},e.prototype.iDr=function(){for(var i,t,r,e,n,u,o,i=this,t=this.Zkr,r=t.tableName,e=t.valueColumns,n,u=function(n){e.forEach(function(t){i.rDr(r,t,null,i.s_i["H-".concat(n)])})},o=t.colColumns.length-1;0<=o;o--)u(o)},e.prototype.rDr=function(t,n,i,r,e){var u,o,t,u=this,o={templateCell:{dataColumn:{tableName:t,columnName:n},dataSetting:{type:"List"},expansionDirection:"No"},children:[],leftParent:i,upParent:r,data:{groups:[]},indexOfLeftParentChildren:-1,indexOfUpParentChildren:-1},t=function(t){var n=u.oDr();u.s_i[t]=o,u.Mur[n]=o,u.Wkr[t]=n};i&&(i.children.push(o),o.indexOfLeftParentChildren=i.children.length-1,r||t("V-".concat(i.templateCell.dataColumn.columnName,"-VALUE-").concat(n))),r&&(r.children.push(o),o.indexOfUpParentChildren=r.children.length-1,i||t("H-".concat(r.templateCell.dataColumn.columnName,"-VALUE-").concat(n))),i&&r&&e&&e.push(o)},e.prototype.oDr=function(){return"A".concat(this.Qkr++)},e.prototype.$kr=function(){var t=this.Zkr,n=t.rowSortOrder,i=t.rowColumns,r=t.colSortOrder,t=t.colColumns;this.aDr(n,i,"V"),this.aDr(r,t,"H")},e.prototype.aDr=function(t,n,i){var r,e,u,u,u,r=this;if(t&&n&&0!==n.length){if(e=function(t){},"number"==typeof t)return(u=Math.abs(t))>n.length?void 0:void(u<=n.length&&t<0&&((u=this.s_i["".concat(i,"-").concat(u-1)]).templateCell.sorts=[{desc:u.templateCell.dataColumn.columnName}]));Array.isArray(t)&&(-1!==(u=t.findIndex(function(t){return Math.abs(t)>n.length}))?t[u]:t.forEach(function(t){var t;t<0&&((t=r.s_i["".concat(i,"-").concat(Math.abs(t)-1)]).templateCell.sorts=[{desc:t.templateCell.dataColumn.columnName}])}))}},g=e,n.TreeDataContextGenerator=g,n.Ykr=u,s=0},"./dist/src/calculation/functions/aggregationFunctions/index.js":function(t,n,i){"use strict";var g,r,_,O,C,S,e,M;function f(t,n,i,r,e,u,o,s,c,f,a,h,l){var v,d,p,w,b,m,v,m,b,a,j,y;if(S(n)&&S(i)&&S(r))return g.Errors.Value;if(d=n&&g.Convert.iV(n,0,!1),p=i&&g.Convert.iV(i,0,!1),w=r&&g.Convert.iV(r,0,!1),a=a&&g.Convert.iV(a,0,!0),b=(d||p||w).rowCount,m=(p||w||d).rowCount,v=(w||d||p).rowCount,b!==m||b!==v)return g.Errors.Value;if(h&&(l&&1!==h&&0!==h||!l&&(h<0||4<h)))return g.Errors.Value;if(S(m=u)&&(m=N(w)),a){if(b!==a.length+1||m!==_.FieldHeaders.YesAndShow&&m!==_.FieldHeaders.YesAndDoNotShow||a.unshift(1),b!==a.length)return g.Errors.Value;v=F(d,p,w,m,a),d=v.rows,p=v.cols,w=v.valueArray}if(S(o)&&!S(n)&&(o=2<=d.colCount&&s&&Math.abs(s)>d.colCount&&!h?d.colCount:1),S(c)&&!S(i)&&(c=2<=p.colCount&&s&&Math.abs(s)>d.colCount&&!h?p.colCount:1),s&&1<(s=g.Convert.iV(s,0,!0)).length&&s.some(function(t){return 0===t||Math.abs(t)>d.colCount}))return g.Errors.Value;if(f&&1<(f=g.Convert.iV(f,0,!0)).length&&f.some(function(t){return 0===t||Math.abs(t)>p.colCount}))return g.Errors.Value;if(b=(0,O.Ykr)(d,p,w,m,Math.abs(o),Math.abs(c),s,f),M(b))return b;if(a=r?T(e,b.valueFields,t):[],M(a))return a;if(a.headers&&!a.uDr&&S(u)&&m===_.FieldHeaders.YesAndDoNotShow&&(m=_.FieldHeaders.YesAndShow),s&&1===s.length){if(j=Math.abs(s[0]),y=w.colCount,a.uDr?y=1:1===y&&a.valueFieldRepeat&&(y=a.valueFieldRepeat),j>d.colCount&&j<=d.colCount+y)b.sDr=j-d.colCount,s[0]<0&&(b.sDr=-b.sDr);else{if(!(0<j&&j<=d.colCount))return g.Errors.Value;s=s[0]}b.wwn=s}if(f&&1===f.length){if(j=Math.abs(f[0]),y=w.colCount,a.uDr?1===y&&a.valueFieldRepeat&&(y=a.valueFieldRepeat):y=1,j>p.colCount&&j<=p.colCount+y)b.cDr=j-p.colCount,f[0]<0&&(b.cDr=-b.cDr);else{if(!(0<j&&j<=p.colCount))return g.Errors.Value;f=f[0]}b.fDr=f}return(l?new C.lDr(b,a,m,o,h):new C.hDr(b,a,m,o,c,h)).GY()}function F(n,i,r,t,e){var u,o,s,c;function f(t){u&&u.push(n[t]),o&&o.push(i[t]),s&&s.push(r[t])}for(o=i&&[],s=r&&[],(u=n&&[])&&(u.colCount=n.colCount),o&&(o.colCount=i.colCount),s&&(s.colCount=r.colCount),t!==_.FieldHeaders.YesAndDoNotShow&&t!==_.FieldHeaders.YesAndShow&&!e[0]||f(0),c=1;c<e.length;c++)e[c]&&f(c);return u&&(u.rowCount=u.length),o&&(o.rowCount=o.length),s&&(s.rowCount=s.length),{rows:u,cols:o,valueArray:s}}function u(t,n,i,r,e,u,o,s,c){return f(t,n,null,i,r,e,u,o,null,null,s,c,!0)}function N(t){var n,i,t;return!S(t)&&!((n=t.rowCount)<2)&&(i=t[0][0],t=t[1][0],"string"==typeof i)&&e(t)?_.FieldHeaders.YesAndDoNotShow:_.FieldHeaders.No}function T(t,n,i){var r,e,u,o,s,c,f,a,h,l,v,d;if((i.N_t=!1,g.isLambdaFunction)(t))return 1===(r=t).parameters.length?n.map(function(t){return function(t){return(0,g.Hkr)(i,r,[new g.CalcArray([t])],!0,!0)}}):n.map(function(t){return function(t,n){return(0,g.Hkr)(i,r,[new g.CalcArray([t]),new g.CalcArray([n])],!0,!0)}});if((0,g.isFunction)(t))return(e=i.source&&i.source.Lbt&&i.source.Lbt.MX)?((u=(0,g.YJ)(t,null,0,0)).ywr=!0,"PERCENTOF"===t.name?n.map(function(t){return function(t,n){return u.arguments=[new g.CalcArray([t]),new g.CalcArray([n])],e.evaluate(u,i,!1,!1)}}):n.map(function(t){return function(t){return u.arguments=[new g.CalcArray([t])],e.evaluate(u,i,!1,!1)}})):g.Errors.Calc;if(t.array){if(o=t.getRowCount(),s=t.getColumnCount(),1===o&&1===s)return T(t.getValue(0,0),n,i);if((0,g.isFunction)(t.getValue(0,1))){if(2<o)return g.Errors.Value;if(c={func:[]},1!==n.length&&n.length!==s)return g.Errors.Value;for(f=0;f<s;f++)c[f]=T(t.getValue(0,f),n,i)[0];for(1===n.length&&(c.valueFieldRepeat=s),a=1<o,c.headers=[],l=void(h=0),f=0;f<s;f++)a?c.headers[f]=t.getValue(1,f):(v=t.getValue(0,f),(0,g.isLambdaFunction)(v)?1===++h?(c.headers[f]="CUSTOM",l=f):0<h&&(c.headers[f]="CUSTOM"+h,2===h)&&(c.headers[l]="CUSTOM1"):c.headers[f]=v.name);return c}if((0,g.isFunction)(t.getValue(1,0))){if(2<s)return g.Errors.Value;if(c={func:[]},1!==n.length&&n.length!==o)return g.Errors.Value;for(d=0;d<o;d++)c[d]=T(t.getValue(d,0),n,i)[0];for(1===n.length&&(c.valueFieldRepeat=o),c.uDr=1<o,a=1<s,c.headers=[],l=void(h=0),d=0;d<o;d++)a?c.headers[d]=t.getValue(d,1):(v=t.getValue(d,0),c.headers[d]=(0,g.isLambdaFunction)(v)?"CUSTOM":v.name,(0,g.isLambdaFunction)(v)?1===++h?(c.headers[d]="CUSTOM",l=d):0<h&&(c.headers[d]="CUSTOM"+h,2===h)&&(c.headers[l]="CUSTOM1"):c.headers[d]=v.name);return c}}return g.Errors.Name}function o(){g.Functions.F6t("GROUPBY",u,3,8,void 0,[0,1,2,6],[0,1,2,5,6],{r9t:!0},!0),g.Functions.F6t("PIVOTBY",f,4,11,void 0,[0,1,2,3,9],[0,1,2,3,6,8,9],{r9t:!0},!0)}Object.defineProperty(n,"__esModule",{value:!0}),n.HEr=void 0,g=i("CalcEngine"),r=i("Common"),_=i("./dist/src/calculation/functions/aggregationFunctions/interface.js"),O=i("./dist/src/calculation/functions/aggregationFunctions/dataModel.js"),C=i("./dist/src/calculation/functions/aggregationFunctions/pivotLayout.js"),S=r.Common.lt.ht,e=g.Convert.q8,M=g.Convert.BJ,n.HEr=o},"./dist/src/calculation/functions/aggregationFunctions/interface.js":function(t,n){"use strict";var i,r,e,e;Object.defineProperty(n,"__esModule",{value:!0}),n.TotalDepth=n.FieldHeaders=void 0,(e=i=n.FieldHeaders||(n.FieldHeaders={}))[e.No=0]="No",e[e.YesAndDoNotShow=1]="YesAndDoNotShow",e[e.NoButGenerate=2]="NoButGenerate",e[e.YesAndShow=3]="YesAndShow",(e=r=n.TotalDepth||(n.TotalDepth={}))[e.NoTotal=0]="NoTotal",e[e.GrandTotals=1]="GrandTotals",e[e.GrandAndSubtotals=2]="GrandAndSubtotals",e[e.GrandTotalsAtTopOrLeft=-1]="GrandTotalsAtTopOrLeft",e[e.GrandAndSubtotalsAtTopOrLeft=-2]="GrandAndSubtotalsAtTopOrLeft"},"./dist/src/calculation/functions/aggregationFunctions/pivotLayout.js":function(t,n,i){"use strict";var r,_,e,O,u,C,f,a,i,o,s,c,h,l;function v(t,n,i){return C(t)&&(t=0),C(n)&&(n=0),t&&(0,u.isCalcError)(t)?i?-1:1:n&&(0,u.isCalcError)(n)||(0,u.isString)(t)&&"number"==typeof n?i?1:-1:(0,u.isString)(n)&&"number"==typeof t?i?-1:1:i?(0,_.$kt)(n,t):(0,_.$kt)(t,n)}function d(t){this.dDr=new Map,this.vDr=t}function p(){}function w(t,n,i,r,e){var u=h.call(this)||this;return u.gDr=t,u.mDr=n,u.pDr=i,u.bDr=r,u.CRt=e,u.wDr=new a(!1),u.yDr=u.MDr(),u}function b(t,n,i,r,e,u){var o=l.call(this)||this;return o.gDr=t,o.mDr=n,o.pDr=i,o.bDr=r,o.CDr=e,o.CRt=u,o.SDr=new a(!1),o.xDr=new a(!0),o.yDr=o.MDr(),o}r=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.hDr=n.lDr=void 0,_=i("CalcEngine"),e=i("Common"),O=i("./dist/src/calculation/functions/aggregationFunctions/interface.js"),u=i("./dist/src/dataManager.entry.js"),C=e.Common.lt.ht,f=e.Common.lt.Nh,d.prototype.TDr=function(t,n,i){var r,e,r=this.d7e(t,n,i),e=this.dDr.get(r);return C(e)&&(e=this.vDr?C(i)?t.cellNode.children.findIndex(function(t){return t.templateCell.dataColumn.columnName===n&&C(t.leftParent)}):t.cellNode.children.findIndex(function(t){return t.templateCell.dataColumn.columnName===n&&!C(t.leftParent)&&t.leftParent.templateCell.dataColumn.columnName===i.cellNode.templateCell.dataColumn.columnName}):C(i)?t.cellNode.children.findIndex(function(t){return t.templateCell.dataColumn.columnName===n&&C(t.upParent)}):t.cellNode.children.findIndex(function(t){return t.templateCell.dataColumn.columnName===n&&!C(t.upParent)&&t.upParent.templateCell.dataColumn.columnName===i.cellNode.templateCell.dataColumn.columnName}),this.dDr[r]=e),e},d.prototype.d7e=function(t,n,i){return this.vDr?C(i)?"H-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-V-null"):"H-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-V-").concat(i.cellNode.templateCell.dataColumn.columnName):C(i)?"V-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-H-null"):"V-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-H-").concat(i.cellNode.templateCell.dataColumn.columnName)},a=d,p.prototype.MDr=function(){var n,t,n=this,t=this.gDr.valueFields.map(function(t){return n.gDr.fieldNameToColumnNames.get(t._getName())});return this.mDr.valueFieldRepeat?Array.from({length:this.mDr.valueFieldRepeat},function(){return t[0]}):t},p.prototype.ADr=function(i,r,t,e,u){var n,o,s,c,f,a,h,l,n=r.length<Math.abs(t),o=t<0,s=function(){for(var t,n,t=r.slice(),n=t.length;n<e;n++)t.push("");u.push({headerRecords:t,leafHeader:i})};if(r.length===e)u.push({headerRecords:r,leafHeader:i});else{for(c=i.childrenArray[0],n&&o&&s(),f=0,a=c;f<a.length;f++)h=a[f],(l=r.slice()).push(h.value),this.ADr(h,l,t,e,u);n&&!o&&s()}},p.prototype.IDr=function(t){return 1<Math.abs(t)?(0,_.sR)().Aggregate_GrandTotal:(0,_.sR)().Aggregate_Total},p.prototype.jDr=function(t,n){var i,r,e,u,o,s,i=this.gDr.rowFields.length;if(this.mDr.uDr&&i++,0<i)for(r=0,e=n;r<e.length;r++)u=e[r],t.push(Array(i).fill("").concat(u));else for(o=0,s=n;o<s.length;o++)u=s[o],t.push(u)},p.prototype._Dr=function(t,n,i){var t,t,t,t,t,r,e,u,o,s,t=t.verticalExpansionTrees;if(C(t)||1!==t.length)return[];if(t=null==(t=null==(t=null==(t=t[0])?void 0:t.root)?void 0:t.data)?void 0:t.groups,C(t)||t.length<1)return[];for(r=[],e=0,u=t;e<u.length;e++)s=[(o=u[e]).value],this.ADr(o,s,n,i,r);return r},p.prototype.kDr=function(t,n,i,r){var t,t,t,e,t,t,u,o,s,c,f,t,a,e={headerRecords:[],leafHeaders:[]},t=t.horizontalExpansionTrees;if(!(C(t)||1!==t.length||(t=null==(t=null==(t=null==(t=t[0])?void 0:t.root)?void 0:t.data)?void 0:t.groups,C(t))||t.length<1)){for(u=0;u<i;u++)e.headerRecords[u]=[];for(o=0,s=t;o<s.length;o++)c=s[o],this.NDr(c,e,n,0,i,r);if(t=n<0,(f=0<Math.abs(n))&&0<r)if(a=this.IDr(n),t)for(e.headerRecords[0]=Array(r).fill(a).concat(e.headerRecords[0]),u=1;u<e.headerRecords.length;u++)e.headerRecords[u]=Array(r).fill("").concat(e.headerRecords[u]);else for(e.headerRecords[0]=e.headerRecords[0].concat(Array(r).fill(a)),u=1;u<e.headerRecords.length;u++)e.headerRecords[u]=e.headerRecords[u].concat(Array(r).fill(""))}return e},p.prototype.NDr=function(n,i,t,r,e,u){var o,s,c,f,a,h,l,v,d,p,w,b,o=i.headerRecords,s=o[r];if(r+1===e)for(i.leafHeaders.push(n),c=0;c<u;c++)s.push(n.value);else{for(f=Array(u).fill(""),a=function(){var t;for(i.leafHeaders.push(n),t=0;t<u;t++)s.push(n.value);for(t=r+1;t<o.length;t++)o[t]=o[t].concat(f)},l=t<0,(h=r+1<Math.abs(t))&&l&&a(),p=v=n.childrenArray[d=0];d<p.length;d++)w=p[d],this.NDr(w,i,t,r+1,e,u);for(h&&!l&&a(),b=o[r+1].length-s.length,c=0;c<b;c++)s.push(n.value)}},r(w,h=i=p),w.prototype.GY=function(){var i,r,t,n,e,u,o,n,s,c,f,a,h,l,v,l,d,p,w,n,e;if(C(this.gDr)||C(this.gDr.treeData))return _.Errors.Value;if(i=this.gDr.rowFields.length,r=this.gDr.valueFields.length,n=(t=this.kDr(this.gDr.treeData,0,0,r<1?1:r)).headerRecords,e=t.leafHeaders,this.jDr(u=[],n),o=this.yDr,n=Math.abs(this.gDr.sDr)-1,this.gDr.sDr&&!this.CRt&&this.DDr(this.gDr.treeData,o[n],n,this.gDr.sDr<0),s=this._Dr(this.gDr.treeData,this.bDr,this.gDr.rowFields.length),this.CRt){if(1<Math.abs(this.bDr))return _.Errors.Value;this.ODr(s,o[n],n)}for(c=e.length*(0<r?r:1),f=function(t,n){return t<0?i+c+n:i+t*r+n},a=0,h=s;a<h.length;a++)v=(l=h[a]).headerRecords,l=l.leafHeader,0<o.length?this.EDr(o,f,l,v,u):u.push(v);if(d=0<Math.abs(this.bDr)||0===i){for(p=0===i?[]:[this.IDr(this.bDr)],w=1;w<i;w++)p.push("");n=this.RDr(t),p=p.concat(n),e=void 0,e=this.LDr(p,o,f),u=this.bDr<0?e.concat(u):u.concat(e)}return O.FieldHeaders.NoButGenerate!==this.pDr&&O.FieldHeaders.YesAndShow!==this.pDr||this.FDr(u,this.gDr.rowFields,this.gDr.valueFields),this.mDr.headers&&!this.mDr.uDr&&this.BDr(this.gDr.rowFields,u),new _.CalcArray(u)},w.prototype.PDr=function(t,n){var i,i,t,i=this.wDr;return t?(i=t.childrenArray[i.TDr(t,n,null)][0].value,f(i)?i:[i]):(t=this.yDr.indexOf(n),this.gDr.valueFields[t].Vkr())},w.prototype.GDr=function(t,n,i){var r,t,t,r=this.PDr(t,n);return 0<r.length?(t=null==t?void 0:t.leftParent,t=this.PDr(t,n),this.mDr[i](r,t)):""},w.prototype.EDr=function(t,n,i,r,e){var u,o,s,c,f;if(this.mDr.uDr)for(o=0;o<t.length;o++)s=r.slice(),null!=(u=this.mDr.headers)&&u[o]&&s.push(this.mDr.headers[o]),c=t[o],s.push(this.GDr(i,c,o)),e.push(s);else{for(o=0;o<t.length;o++)f=n(-1,o),c=t[o],r[f]=this.GDr(i,c,o);e.push(r)}},w.prototype.LDr=function(t,n,i){var r,e,u,o,s,c,e=[];if(this.mDr.uDr)for(u=0;u<n.length;u++)o=t.slice(),null!=(r=this.mDr.headers)&&r[u]&&o.push(this.mDr.headers[u]),s=n[u],o.push(this.GDr(null,s,u)),e.push(o);else{for(u=0;u<n.length;u++)c=i(-1,u),s=n[u],t[c]=this.GDr(null,s,u);e.push(t)}return e},w.prototype.BDr=function(t,n){var t=Array(t.length).fill("").concat(this.mDr.headers);return n.splice(0,0,t)},w.prototype.RDr=function(t){for(var u,t,o,n,s,i,r,e,c,u=this,t=t.leafHeaders,o=[],n=this.yDr,s=new a(!0),i=function(e){n.forEach(function(t,n){var t,i,t,r,t=s.TDr(e,t,null),i,t=e.childrenArray[t][0].value,r=f(t)?t:[t];!C(t)&&0<r.length?o.push(u.mDr[n](r)):o.push("")})},r=0,e=t;r<e.length;r++)i(c=e[r]);return o},w.prototype.FDr=function(t,n,i){var r,e,u,o,s,c,e,f;if(!(t.length<1)){if(r=t[0].length,e=0<n.length,u=0<i.length,o=e?n.map(function(t){return t.itn}):[],u)if(s=i.map(function(t){return t.itn}),this.mDr.uDr)o.push("",s[0]);else for(c=o.length;c<r;c+=i.length)o.push.apply(o,s);else e=o.length,o.length=r,o.fill("",e,r);t.splice(f=0,0,o)}},w.prototype.ODr=function(t,n,i){var r,e,u,o,r=this,e=this.gDr.wwn,u=e<0;e=Math.abs(e)-1,o=this.gDr.sDr?function(t){return r.GDr(t.leafHeader,n,i)}:function(t){return t.headerRecords[e]},t.sort(function(t,n){var i,r,i,r;return v(o(t),o(n),u)})},w.prototype.DDr=function(t,e,u,o){var s,t,t,t,t,t,n,i,r,s=this,t=t.verticalExpansionTrees;if(!(C(t)||1!==t.length||(t=null==(t=null==(t=null==(t=t[0])?void 0:t.root)?void 0:t.data)?void 0:t.groups,C(t))||t.length<1))for(t.sort(function(t,n){var i,r,i,r;return v(s.GDr(t,e,u),s.GDr(n,e,u),o)}),n=0,i=t;n<i.length;n++)r=i[n],this.UDr(r,e,u,o)},w.prototype.UDr=function(t,e,u,o){var s,t,n,i,r,s=this,t=t.childrenArray[0];if(t)for(t.sort(function(t,n){var i,r,i,r;return v(s.GDr(t,e,u),s.GDr(n,e,u),o)}),n=0,i=t;n<i.length;n++)r=i[n],this.UDr(r,e,u,o)},n.lDr=w,r(b,l=i),b.prototype.GY=function(){var t,i,r,e,n,u,o,t,s,c,f,a,h,t,l,v,d,p,w,b,m,j,y,u,g;if(C(this.gDr)||C(this.gDr.treeData))return _.Errors.Value;for(i=this.gDr.rowFields.length,r=this.gDr.colFields.length,e=this.mDr.valueFieldRepeat||this.gDr.valueFields.length,n=this.yDr,this.gDr.cDr&&(u=Math.abs(this.gDr.cDr)-1,this.HDr(this.gDr.treeData,n[u],u,this.gDr.cDr<0)),t=(o=this.kDr(this.gDr.treeData,this.CDr,r,e<1||this.mDr.uDr?1:e)).headerRecords,s=o.leafHeaders,c=[],this.jDr(f=[],t),a=0<Math.abs(this.CDr),h=this.CDr<0,this.gDr.sDr&&(u=Math.abs(this.gDr.sDr)-1,this.zDr(this.gDr.treeData,n[u],u,this.gDr.sDr<0)),t=this._Dr(this.gDr.treeData,this.bDr,this.gDr.rowFields.length),l=a&&h?0<e?e:1:0,v=s.length*(0<e?e:1),d=function(t,n){return t<0?a&&h||0===r?i+n:i+v+n:i+l+t*e+n},p=0,w=t;p<w.length;p++)b=w[p],this.VDr(s,n,d,b,c,a,r);if(m=0<Math.abs(this.bDr)||0===i){for(j=0===i?[]:[this.IDr(this.bDr)],y=1;y<i;y++)j.push("");u=this.YDr(o,j),c=this.bDr<0?u.concat(c):c.concat(u)}if(this.mDr.headers&&!this.mDr.uDr){for(g=Array(this.gDr.rowFields.length).fill("").concat(this.mDr.headers);g.length<c[0].length;)g=g.concat(this.mDr.headers);f.push(g)}return O.FieldHeaders.NoButGenerate!==this.pDr&&O.FieldHeaders.YesAndShow!==this.pDr||this.ZDr(f,this.gDr.rowFields,this.gDr.colFields,this.gDr.valueFields,null==(t=c[0])?void 0:t.length),c=f.concat(c),new _.CalcArray(c)},b.prototype.WDr=function(t,n,i){var r=[],r;return r=1===this.CRt?this.PDr(t,n,null):2===this.CRt?this.PDr(null,n,null):3===this.CRt?this.PDr(t,n,i&&i.upParent):4===this.CRt?this.PDr(t&&t.leftParent,n,i):this.PDr(null,n,i)},b.prototype.PDr=function(t,n,i){var r,e,u,o,s,e;if(t)if(i){for(e=this.SDr.TDr(t,n,i),u=t.crossChildren[e],o=0;o<u.length;o++)if((s=u[o][0]).upParent===i){r=s.value;break}}else r=t.childrenArray[this.SDr.TDr(t,n,null)][0].value;else{if(!i)return e=this.yDr.indexOf(n),r=this.gDr.valueFields[e].Vkr();r=i.childrenArray[this.xDr.TDr(i,n,null)][0].value}return f(r)?r:[r]},b.prototype.QDr=function(t,n,i,r){var e,t,e=this.PDr(t,n,r);return!C(e)&&0<e.length?(t=this.WDr(t,n,r),this.mDr[i](e,t)):""},b.prototype.VDr=function(t,n,i,r,e,u,o){var s,c,f,a,h,l,v,d,p;if(this.mDr.uDr)for(c=r.headerRecords,f=r.leafHeader,a=0;a<n.length;a++){for(h=c.slice(),null!=(s=this.mDr.headers)&&s[a]&&h.push(this.mDr.headers[a]),l=0;l<t.length;l++)v=t[l],d=n[a],h.push(this.QDr(f,d,a,v));(u||0===o&&0<n.length)&&(d=n[a],h.push(this.QDr(f,d,a))),e.push(h)}else{for(c=r.headerRecords,f=r.leafHeader,l=0;l<t.length;l++)for(v=t[l],a=0;a<n.length;a++)p=i(l,a),d=n[a],c[p]=this.QDr(f,d,a,v);if(u||0===o&&0<n.length)for(a=0;a<n.length;a++)p=i(-1,a),d=n[a],c[p]=this.QDr(f,d,a);e.push(c)}},b.prototype.YDr=function(t,n){var i,r,e,u,o,s,c,f,a,h,t,l,v,d,p,w,b,m,j,y,g,_,O,r=t.leafHeaders,e=0<Math.abs(this.CDr),u=this.CDr<0,o=[],s=this,c=n,f=this.yDr,a=this.gDr.rowFields.length,h=this.gDr.colFields.length,t=this.mDr.valueFieldRepeat||this.gDr.valueFields.length,l=r.length*(0<t?t:1);if(this.mDr.uDr)for(v=0;v<f.length;v++){for(d=n.slice(),null!=(i=this.mDr.headers)&&i[v]&&d.push(this.mDr.headers[v]),p=f[v],e&&u&&d.push(this.QDr(null,p,v)),w=0,b=r;w<b.length;w++)m=b[w],j=s.QDr(null,p,v,m),d.push(j);0===h&&0<f.length&&(j=s.QDr(null,p,v),d.push(j)),e&&!u&&d.push(this.QDr(null,p,v)),o.push(d)}else{if((e&&u||0===h)&&(l=0),e&&u)for(v=0;v<f.length;v++)p=f[v],c[y=a+l+v]=this.QDr(null,p,v);for(g=function(i){f.forEach(function(t,n){var t=s.QDr(null,t,n,i);c.push(t)})},_=0,O=r;_<O.length;_++)g(m=O[_]);if(0===h&&0<f.length&&f.forEach(function(t,n){var t=s.QDr(null,t,n,null);c.push(t)}),e&&!u)for(v=0;v<f.length;v++)p=f[v],c[y=a+l+v]=this.QDr(null,p,v);o.push(c)}return o},b.prototype.ZDr=function(t,n,i,r,e){var u,o,s,c,o,i,f,a,h,o;if(!(e<1)&&e&&(u=0<n.length,o=0<i.length,s=0<r.length,c=this.mDr.uDr?n.length+1:n.length,o&&(o=i.map(function(t){return t.itn}).join(", "),i=Array(c).fill("").concat([o]).concat(Array(e-c-1).fill("")),t.unshift(i)),u||s)){if(f=u?n.map(function(t){return t.itn}):[],this.mDr.uDr&&f.push(""),s){for(a=r.map(function(t){return t.itn}),h=f.length;h<e;h+=r.length)f.push.apply(f,a);f=f.slice(0,e)}else o=f.length,f.length=e,f.fill("",o,e);t.push(f)}},b.prototype.zDr=function(t,e,u,o){var s,t,t,t,t,t,n,i,r,s=this,t=t.verticalExpansionTrees;if(!(C(t)||1!==t.length||(t=null==(t=null==(t=null==(t=t[0])?void 0:t.root)?void 0:t.data)?void 0:t.groups,C(t))||t.length<1))for(t.sort(function(t,n){var i,r,i,r;return v(s.QDr(t,e,u,null),s.QDr(n,e,u,null),o)}),n=0,i=t;n<i.length;n++)r=i[n],this.JDr(r,e,u,o)},b.prototype.JDr=function(t,e,u,o){var s,t,n,i,r,s=this,t=t.childrenArray[0];if(t)for(t.sort(function(t,n){var i,r,i,r;return v(s.QDr(t,e,u),s.QDr(n,e,u),o)}),n=0,i=t;n<i.length;n++)r=i[n],this.JDr(r,e,u,o)},b.prototype.HDr=function(t,e,u,o){var s,t,t,t,t,t,n,i,r,s=this,t=t.horizontalExpansionTrees;if(!(C(t)||1!==t.length||(t=null==(t=null==(t=null==(t=t[0])?void 0:t.root)?void 0:t.data)?void 0:t.groups,C(t))||t.length<1))for(t.sort(function(t,n){var i,r,i,r;return v(s.QDr(null,e,u,t),s.QDr(null,e,u,n),o)}),n=0,i=t;n<i.length;n++)r=i[n],this.KDr(r,e,u,o)},b.prototype.KDr=function(t,e,u,o){var s,t,n,i,r,s=this,t=t.childrenArray[0];if(t)for(t.sort(function(t,n){var i,r,i,r;return v(s.QDr(null,e,u,t),s.QDr(null,e,u,n),o)}),n=0,i=t;n<i.length;n++)r=i[n],this.KDr(r,e,u,o)},n.hDr=b},"./dist/src/calculation/functions/functions.entry.js":function(t,n,i){"use strict";var r,e,u,o,s,c,f,a,h,l,i;function v(){(0,r.addScopeCustomFunctions)(),(0,e.addParentCustomFunctions)(),(0,u.addChildrenCustomFunctions)(),(0,o.addOnlyChildrenCustomFunctions)(),(0,s.addLevelCustomFunctions)(),(0,c.addLevelRowNumberCustomFunctions)(),(0,f.addQueryFunction)(),(0,a.addWindowOverFunctions)(),(0,h.addWindowFunctions)(),(0,l.addTriggerFieldValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addCustomFunctions=void 0,r=i("./dist/src/calculation/functions/scope.js"),e=i("./dist/src/calculation/functions/hierarchyParent.js"),u=i("./dist/src/calculation/functions/hierarchyChildren.js"),o=i("./dist/src/calculation/functions/hierarchyOnlyChildren.js"),s=i("./dist/src/calculation/functions/hierarchyLevel.js"),c=i("./dist/src/calculation/functions/hierarchyLevelRowNumber.js"),f=i("./dist/src/calculation/functions/query.js"),a=i("./dist/src/calculation/functions/windowOvers/windowOvers.entry.js"),h=i("./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js"),l=i("./dist/src/calculation/functions/triggerFieldValue.js"),i=i("./dist/src/calculation/functions/aggregationFunctions/index.js"),n.addCustomFunctions=v,(0,i.HEr)()},"./dist/src/calculation/functions/hierarchyChildren.js":function(t,n,i){"use strict";var s,c,r,e;function u(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new r.CalcFunction(e,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,i,r){var e,u,n,o,e=[],u=t.source.nM,n=t.source.DJ;return u.CEt()&&(o=u.SEt(n),!(0,c.isNullOrUndefined)(o))&&0<i&&!(0,c.isNullOrEmpty)(r)&&((0,c.traversalTree)(o,{invoking:function(t){var n,n,n;return 0===--i?(n=t.lp,n=u._dataSource.TEt(n),n=u._getValueByField(r,n),e.push(n),{cancelDeepRecursion:!0}):0===t.children.length?{cancelDeepRecursion:!0}:void 0},invoked:function(){i++}}),t.source.DJ=n),new s.CalcArray([e])},s.Functions.defineGlobalCustomFunction(e,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addChildrenCustomFunctions=void 0,s=i("CalcEngine"),c=i("./dist/src/dataSource/utils.js"),r=i("./dist/src/calculation/functions/utils.js"),e="CHILDREN",n.addChildrenCustomFunctions=u},"./dist/src/calculation/functions/hierarchyLevel.js":function(t,n,i){"use strict";var r,e,u,o;function s(){function t(){}(t.prototype=new u.CalcFunction(o)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,e.isNullOrUndefined)(n)))return n.level},r.Functions.defineGlobalCustomFunction(o,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/calculation/functions/utils.js"),o="LEVEL",n.addLevelCustomFunctions=s},"./dist/src/calculation/functions/hierarchyLevelRowNumber.js":function(t,n,i){"use strict";var r,e,u,o;function s(){function t(){}(t.prototype=new u.CalcFunction(o)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,e.isNullOrUndefined)(n)))return n.getCurrentIndex()+1},r.Functions.defineGlobalCustomFunction(o,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/calculation/functions/utils.js"),o="LEVELROWNUMBER",n.addLevelRowNumberCustomFunctions=s},"./dist/src/calculation/functions/hierarchyOnlyChildren.js":function(t,n,i){"use strict";var o,s,r,e;function u(){function t(){this.R9t=[{J6t:5}]}(t.prototype=new r.CalcFunction(e,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n){var i,r,e,u,i=[],r=t.source.nM,e=t.source.DJ;return r.CEt()&&(u=r.SEt(e),(0,s.isNullOrUndefined)(u)||(0,s.isNullOrEmpty)(n)||((0,s.traversalTree)(u,function(t){var t,t,t;0===t.children.length&&(t=t.lp,t=r._dataSource.TEt(t),t=r._getValueByField(n,t),i.push(t))}),t.source.DJ=e)),new o.CalcArray([i])},o.Functions.defineGlobalCustomFunction(e,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addOnlyChildrenCustomFunctions=void 0,o=i("CalcEngine"),s=i("./dist/src/dataSource/utils.js"),r=i("./dist/src/calculation/functions/utils.js"),e="ONLYCHILDREN",n.addOnlyChildrenCustomFunctions=u},"./dist/src/calculation/functions/hierarchyParent.js":function(t,n,i){"use strict";var r,o,e,u;function s(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new e.CalcFunction(u,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var r,e,u,u,n,u,n,r=t.source.nM,e=t.source.DJ;if(r.CEt()&&(u=r.SEt(e),!(0,o.isNullOrUndefined)(u))&&0<n&&!(0,o.isNullOrEmpty)(i)&&!(u=c(u,n)).isRoot)return n=u.lp,u=r._dataSource.TEt(n),n=r._getValueByField(i,u),t.source.DJ=e,n},r.Functions.defineGlobalCustomFunction(u,new t)}function c(t,n){return 0===n||t.isRoot?t:c(t.parent,n-1)}Object.defineProperty(n,"__esModule",{value:!0}),n.addParentCustomFunctions=void 0,r=i("CalcEngine"),o=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/utils.js"),u="PARENT",n.addParentCustomFunctions=s},"./dist/src/calculation/functions/query.js":function(t,n,i){"use strict";var a,h,r;function e(){var t;a.Functions.findGlobalFunction(r)||((t=new a.Functions.AsyncFunction(r,1,3)).isContextSensitive=function(){return!0},t.evaluateAsync=function(e,u,o,s){var t,n,c,i,n;function f(){var t,t,t,t,t,t=c.xEt(u,o,s);t&&(t.Mgr=void 0),null!=(t=null==(t=null==(t=e.ctx)?void 0:t.Xkt)?void 0:t.node)&&t.WK?(t=c.IEt(u,o,s))&&(s?e.setAsyncResult(t[0]):e.setAsyncResult(new a.CalcArray(t))):c.IEt(u,o,s,f,!0)}function r(t){var n,n,n,n,i,r,n=c.IEt(u,o,s,f,!1,!(null!=(n=null==(n=null==(n=e.ctx)?void 0:n.Xkt)?void 0:n.node)&&n.WK));if(n)if(s){if(i=n[0],t)return e.node.yL||setTimeout(function(){e.setAsyncResult(i)},0),i;e.setAsyncResult(i)}else{if(r=new a.CalcArray(n),t)return e.node.yL||setTimeout(function(){e.setAsyncResult(r)},0),r;e.setAsyncResult(r)}}if(n=e.ctx.source,n=(i=(c=n instanceof h.DataManagerCalcSource?n.nM.QOt:e.ctx.source.Mf.parent.dataManager()).xEt(u,o,s)).table){if(n.qGr||null!=(t=null==e?void 0:e.node)&&t.yL)return r(!0);n.NEt().then(function(){r()})}},t.acceptsReference=function(t){return!0},t.acceptsArray=function(t){return!0},a.Functions.defineGlobalCustomFunction(r,t))}Object.defineProperty(n,"__esModule",{value:!0}),n.addQueryFunction=void 0,a=i("CalcEngine"),h=i("./dist/src/calculation/calcSource.js"),r="QUERY",n.addQueryFunction=e},"./dist/src/calculation/functions/scope.js":function(t,n,i){"use strict";var r,e,u,o,s;function c(){function t(){}function n(){}(t.prototype=new u.CalcFunction(o,2,2)).isContextSensitive=function(){return!0},t.prototype.isReverseArgs=function(){return!0},t.prototype.evaluate=function(t,n,i){return t.source.ak=n.start,t.source.DJ=n.context,i},r.Functions.defineGlobalCustomFunction(o,new t),(n.prototype=new u.CalcFunction(s,0,255)).isContextSensitive=function(){return!0},n.prototype.evaluate=function(t){for(var n,i,r,e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return r={start:t.source.ak,context:t.source.DJ},e=t.source.MEt,t.source.ak=0,t.source.DJ=f(e.groupContext,n),r},r.Functions.defineGlobalCustomFunction(s,new n)}function f(t,n){var n=a(t.groupOptions.slice(0,t.path.length),n);return h(t.path,n)?t.entireScope:l(t.path,n)}function a(t,n){var i,r;if(n&&0<n.length){for(i=-1,t.reverse(),r=0;r<t.length;r++)if(t[r].field!==n[r]){(0,e.isNullOrUndefined)(n[r])&&n.length<=r&&(i=t.length-r-1);break}return i}return-1}function h(t,n){return-1===n||t.length-1<=n}function l(t,n){var i,r=[];return v(t[n],r),r}function v(t,n){var i,r,e,u,o,s,c,f,i=n.length,r=t.recordRowNumbers;if(r)for(e=0,u=r.length;e<u;e++)n[i+e]=r[e];else for(s=0,c=o=t.children;s<c.length;s++)v(f=c[s],n)}Object.defineProperty(n,"__esModule",{value:!0}),n.addScopeCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/calculation/functions/utils.js"),o="CALCULATE",s="REMOVEFILTERS",n.addScopeCustomFunctions=c},"./dist/src/calculation/functions/triggerFieldValue.js":function(t,n,i){"use strict";var r,e,u;function o(){function t(){}(t.prototype=new u.CalcFunction(n.TRIGGERFIELDVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var t=t.source.nM._dataSource,r=t.getFieldValue(n,0);return(0,e.isUndefined)(r)&&i?t.getFieldOriginalValue(n,0):r},r.Functions.defineGlobalCustomFunction(n.TRIGGERFIELDVALUE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addTriggerFieldValueCustomFunctions=n.TRIGGERFIELDVALUE=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/calculation/functions/utils.js"),n.TRIGGERFIELDVALUE="TRIGGERFIELDVALUE",n.addTriggerFieldValueCustomFunctions=o},"./dist/src/calculation/functions/utils.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CalcFunction=void 0;var i=i("./dist/src/dataManager.common.js");n.CalcFunction=i.CalcFunction},"./dist/src/calculation/functions/windowFunctions/cumeDist.js":function(t,n,i){"use strict";var r,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.CUMEDIST)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){for(var n,i,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,j,y,g,_,O,C,n=t.indexes,i=t.begin,r=t.length,e=t.result,u=t.orders,o=t.isOrderValid,s=t.reader,c=r-i,f=o&&1===u.length,a=o&&u[0].field,h=function(t){return s(a,n[t])},l=function(t,n){return s(u[n].field,t)},v=function(t){return n[t]},d=i;d<r;d++)if(o){if(p=n[d],w=void 0,m=n[b=d+1],f)(w=s(a,p))===s(a,m)&&(b=(-1!==(j=S(h,w,b,r-1))?j:b)+1);else{for(w=[],g=!(y=void 0),_=0;_<u.length;_++){if(a=u[_].field,(y=s(a,p))!==s(a,m)){g=!1;break}w.push(y)}g&&(b=(-1!==(j=M(v,l,w,b,r-1))?j:b)+1)}for(O=(b-i)/c,C=b-d;0<C;)C--,e.push(O);d=b-1}else e.push(1)})},r.Functions.defineGlobalCustomFunction(e.CUMEDIST,new t)}function S(t,n,i,r){for(var e,u,o,s,c,e=i,u=r,o=-1;e<=u;)n===(c=t(s=Math.floor((e+u)/2)))?(e=s+1,o=s):u=s-1;return o}function M(t,n,i,r,e){for(var u,o,s,c,f,a,h,l,u=r,o=e,s=-1,c=i.length-1;u<=o;){for(a=t(f=Math.floor((u+o)/2)),h=!0,l=c;0<=l;l--)if(n(a,l)!==i[l]){h=!1;break}h?(u=f+1,s=f):o=f-1}return s}Object.defineProperty(n,"__esModule",{value:!0}),n.addCumeDistCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addCumeDistCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/denseRank.js":function(t,n,i){"use strict";var r,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.DENSERANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){var n,i,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,n=t.indexes,i=t.begin,r=t.length,e=t.result,u=t.orders,o=t.reader,s=t.isOrderValid,c=0,h=!1;for(s&&((l=1===u.length)?v=u[0].field:f=[]),d=i;d<r;d++){if(s)if(p=n[d],l)(a=o(v,p))===f&&d!==i||(c+=1,f=a);else{for(a=[],w=u.length-1;0<=w;w--)b=o(u[w].field,p),a.unshift(b),b!==f[w]&&(h=!0);!h&&d!==i||(h=!1,c+=1,f=a)}else c=1;e.push(c)}})},r.Functions.defineGlobalCustomFunction(e.DENSERANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addDenseRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addDenseRankCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js":function(t,n,i){"use strict";var r,w,e,b,i;function u(){function t(){}(t.prototype=new e.CalcFunction(e.FIRSTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return c(t,n,b.first,1)},r.Functions.defineGlobalCustomFunction(e.FIRSTVALUE,new t)}function o(){function t(){}(t.prototype=new e.CalcFunction(e.LASTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return c(t,n,b.last,1)},r.Functions.defineGlobalCustomFunction(e.LASTVALUE,new t)}function s(){function t(){}(t.prototype=new e.CalcFunction(e.NTHVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i){return c(t,n,b.nth,i)},r.Functions.defineGlobalCustomFunction(e.NTHVALUE,new t)}function c(t,n,v,d){var i,p=t.source.nM.wve(n);return(0,e.expandContext)(t,function(t){var n,i,r,e,u,o,t,s,c,f,a,h,l,n=t.indexes,i=t.begin,r=t.length,e=t.result,u=t.frame,o=t.evaluateWindowIndexes,t=t.buildFrameGroups;if((0,w.isNumber)(d)&&0<d)for(d=Math.floor(d),s={startIndex:i,endIndex:i,lastStartIndex:i,lastEndIndex:i},c=t(n,i),f=i;f<r;f++)o(u,i,f,n,s,c),-1===s.startIndex&&-1===s.endIndex?e.push(null):v===b.first?e.push(p(n[s.startIndex])):v===b.last?e.push(p(n[s.endIndex])):!((a=s.startIndex+d-1)<=s.endIndex)||void 0!==s.gapStartIndex&&void 0!==s.gapEndIndex&&(h=s.gapStartIndex-s.startIndex)<d&&(a=void 0!==s.currentIndex?1==(l=d-h)?s.currentIndex:l-1+s.gapEndIndex:d-h+s.gapEndIndex,s.endIndex<a)?e.push(null):e.push(p(n[a]))})}Object.defineProperty(n,"__esModule",{value:!0}),n.addNthValueCustomFunctions=n.addLastValueCustomFunctions=n.addFirstValueCustomFunctions=void 0,r=i("CalcEngine"),w=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),(i=b=b||{})[i.first=0]="first",i[i.last=1]="last",i[i.nth=2]="nth",n.addFirstValueCustomFunctions=u,n.addLastValueCustomFunctions=o,n.addNthValueCustomFunctions=s},"./dist/src/calculation/functions/windowFunctions/leadLag.js":function(t,n,i){"use strict";var r,l,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.LEAD,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return s(t,n,i,r)},r.Functions.defineGlobalCustomFunction(e.LEAD,new t)}function o(){function t(){}(t.prototype=new e.CalcFunction(e.LAG,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return s(t,n,i,r,!0)},r.Functions.defineGlobalCustomFunction(e.LAG,new t)}function s(t,n,c,f,a){var i,h=t.source.nM.wve(n);return(0,e.expandContext)(t,function(t){var n,i,r,e,u,o,s,n=t.indexes,i=t.begin,r=t.length,e=t.result;if(c=(0,l.isNullOrUndefined)(c)?1:c,(0,l.isNumber)(c)&&0<=c)for(c=Math.floor(c),f=(0,l.isNullOrUndefined)(f)?null:f,u=i;u<r;u++)s=o=void 0,(s=a?i<=(o=u-c):(o=u+c)<r)?e.push(h(n[o])):e.push(f)})}Object.defineProperty(n,"__esModule",{value:!0}),n.addLagCustomFunctions=n.addLeadCustomFunctions=void 0,r=i("CalcEngine"),l=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addLeadCustomFunctions=u,n.addLagCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/nTile.js":function(t,n,i){"use strict";var r,a,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.NTILE,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,f){return(0,e.expandContext)(t,function(t){var n,i,r,t,e,u,o,s,c,n=t.begin,i=t.length,r=t.result;if((0,a.isNumber)(f)&&0<f&&f<i)for(t=i-n,o=(e=Math.floor(t/f))+(0<(u=t%f)?1:0),u--,s=n,c=1;s<i;s++)r.push(c),0===--o&&(o=e+(0<u?1:0),u--,c++);else for(s=n;s<i;s++)r.push(s-n+1)})},r.Functions.defineGlobalCustomFunction(e.NTILE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addNTileCustomFunctions=void 0,r=i("CalcEngine"),a=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addNTileCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/percentRank.js":function(t,n,i){"use strict";var r,e,u;function o(){function t(){}(t.prototype=new u.CalcFunction(u.WPERCENTRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.evaluateRank)(t,function(t,n){return 1===n?0:(t-1)/(n-1)})},r.Functions.defineGlobalCustomFunction(u.WPERCENTRANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWPercentRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),u=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWPercentRankCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/rank.js":function(t,n,i){"use strict";var r,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.WRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return o(t)},r.Functions.defineGlobalCustomFunction(e.WRANK,new t)}function o(t,j){return(0,e.expandContext)(t,function(t){var n,i,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,n=t.indexes,i=t.begin,r=t.length,e=t.result,u=t.orders,o=t.isOrderValid,s=t.reader,c=1,h=!1,l=r-i,v=!1;for(o&&((v=1===u.length)?d=u[0].field:f=[]),p=i;p<r;p++){if(o)if(w=n[p],v)(a=s(d,w))===f&&p!==i||(c=p-i+1,j&&(c=j(c,l)),f=a);else{for(a=[],b=u.length-1;0<=b;b--)m=s(u[b].field,w),a.unshift(m),m!==f[b]&&(h=!0);!h&&p!==i||(h=!1,c=p-i+1,j&&(c=j(c,l)),f=a)}e.push(c)}})}Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateRank=n.addWRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWRankCustomFunctions=u,n.evaluateRank=o},"./dist/src/calculation/functions/windowFunctions/rowNumber.js":function(t,n,i){"use strict";var r,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.ROWNUMBER)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){for(var n,i,r,e,n=t.begin,i=t.length,r=t.result,e=n;e<i;e++)r.push(e-n+1)})},r.Functions.defineGlobalCustomFunction(e.ROWNUMBER,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addRowNumberCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/util.js":function(t,n,i){"use strict";var d,i;function e(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function r(t,n,i){return t.map(function(t){return n(t.field,i)})}function u(t,n){if(t!==n){if((0,d.isNullOrUndefined)(t)||(0,d.isNullOrUndefined)(n)||t.length!==n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==n[i])return!1}return!0}function o(t,n,i){var r,i,r=t.DJ;return t.DJ=i,i=e(t,n),t.DJ=r,i}function s(t,n){var i,t,r,e,u,o,s,c,f,a,h,l,v;if(!(0,d.isNullOrUndefined)(t.source.MEt)&&!(0,d.isNullOrUndefined)(t.source.MEt.extendContext))return i=t.source.DJ,r=(t=t.source.MEt.extendContext).begin,e=t.evaluator,u=i.length,o=!1,c=e.options.windowFrame,f=e.options.orders,a=!(s=void 0,d.isNullOrUndefined)(f)&&0<f.length,h=function(t,n){return e.zhe(t).getValue(n)},l=e.Vhe.bind(e),v=e.cye.bind(e),s=(0,d.isNullOrUndefined)(t.valueCache)?t.valueCache=[]:(o=!0,t.valueCache),o||n({indexes:i,begin:r,length:u,result:s,frame:c,orders:f,isOrderValid:a,reader:h,evaluateWindowIndexes:l,buildFrameGroups:v}),s[0]}Object.defineProperty(n,"__esModule",{value:!0}),n.expandContext=n.evaluateExpressionValue=n.isEqualValues=n.getOrderByValues=n.evaluateExpression=n.CUMEDIST=n.DENSERANK=n.NTHVALUE=n.LASTVALUE=n.FIRSTVALUE=n.LAG=n.LEAD=n.NTILE=n.WPERCENTRANK=n.WRANK=n.ROWNUMBER=n.CalcFunction=void 0,d=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=i.CalcFunction,n.ROWNUMBER="ROWNUMBER",n.WRANK="W_RANK",n.WPERCENTRANK="W_PERCENTRANK",n.NTILE="NTILE",n.LEAD="LEAD",n.LAG="LAG",n.FIRSTVALUE="FIRSTVALUE",n.LASTVALUE="LASTVALUE",n.NTHVALUE="NTHVALUE",n.DENSERANK="DENSERANK",n.CUMEDIST="CUMEDIST",n.evaluateExpression=e,n.getOrderByValues=r,n.isEqualValues=u,n.evaluateExpressionValue=o,n.expandContext=s},"./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js":function(t,n,i){"use strict";var r,e,u,o,s,c,f,a;function h(){(0,r.addRowNumberCustomFunctions)(),(0,e.addWRankCustomFunctions)(),(0,u.addDenseRankCustomFunctions)(),(0,o.addWPercentRankCustomFunctions)(),(0,s.addCumeDistCustomFunctions)(),(0,f.addNTileCustomFunctions)(),(0,c.addLeadCustomFunctions)(),(0,c.addLagCustomFunctions)(),(0,a.addFirstValueCustomFunctions)(),(0,a.addLastValueCustomFunctions)(),(0,a.addNthValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowFunctions=void 0,r=i("./dist/src/calculation/functions/windowFunctions/rowNumber.js"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),u=i("./dist/src/calculation/functions/windowFunctions/denseRank.js"),o=i("./dist/src/calculation/functions/windowFunctions/percentRank.js"),s=i("./dist/src/calculation/functions/windowFunctions/cumeDist.js"),c=i("./dist/src/calculation/functions/windowFunctions/leadLag.js"),f=i("./dist/src/calculation/functions/windowFunctions/nTile.js"),a=i("./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js"),n.addWindowFunctions=h},"./dist/src/calculation/functions/windowOvers/ascDesc.js":function(t,n,i){"use strict";var r,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.ORDERASC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!0)},r.Functions.defineGlobalCustomFunction(e.ORDERASC,new t)}function o(){function t(){}(t.prototype=new e.CalcFunction(e.ORDERDESC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!1)},r.Functions.defineGlobalCustomFunction(e.ORDERDESC,new t)}function s(t,n,i){return{field:(0,e.getFieldOption)(t,n),ascending:i}}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderDescCustomFunctions=n.addOrderAscCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderAscCustomFunctions=u,n.addOrderDescCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/orderBy.js":function(t,n,i){"use strict";var r,s;function e(){function t(){}(t.prototype=new s.CalcFunction(s.ORDERBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,i,r,e,u,o,t,n=arguments[0].source,i=[],r=1,e=arguments.length;r<e;r++)o=void 0,o=c(u=arguments[r])?(0,s.evaluateExpression)(n,u):{field:(0,s.getFieldOption)(n,u),ascending:!0},i.push(o);return i},r.Functions.defineGlobalCustomFunction(s.ORDERBY,new t)}function c(t){var t=(0,s.getExprFunctionName)(t);return t===s.ORDERASC||t===s.ORDERDESC}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderByCustomFunctions=void 0,r=i("CalcEngine"),s=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderByCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/partitionBy.js":function(t,n,i){"use strict";var r,o;function e(){function t(){}(t.prototype=new o.CalcFunction(o.PARTITIONBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,i,r,e,u,t,n=arguments[0].source,i=[],r=1,e=arguments.length;r<e;r++)i.push({field:(0,o.getFieldOption)(n,u=arguments[r]),ascending:!0});return i},r.Functions.defineGlobalCustomFunction(o.PARTITIONBY,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addPartitionByCustomFunctions=void 0,r=i("CalcEngine"),o=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addPartitionByCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js":function(t,n,i){"use strict";var r,s,c,f,o,i;function e(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMERANGE,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,u;return h({type:s.WindowOverFrameType.RANGE},t,n,i,e,s.WindowOverFrameType.RANGE,r)},r.Functions.defineGlobalCustomFunction(f.FRAMERANGE,new t)}function u(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMEROWS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,u;return h({type:s.WindowOverFrameType.ROWS},t,n,i,e,s.WindowOverFrameType.ROWS,r)},r.Functions.defineGlobalCustomFunction(f.FRAMEROWS,new t)}function a(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMEGROUPS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,u;return h({type:s.WindowOverFrameType.GROUPS},t,n,i,e,s.WindowOverFrameType.GROUPS,r)},r.Functions.defineGlobalCustomFunction(f.FRAMEGROUPS,new t)}function h(t,n,i,r,e,u,o){var i,i,i=(0,f.unparseExpression)(n,i);return t.begin=l(i,s.WindowOverFramePreceding.CurrentRow,s.WindowOverFramePreceding.UnBounded,u,e),d(r)?t.exclude=p(r):((0,c.isNullOrUndefined)(r)||(i=(0,f.unparseExpression)(n,r),t.end=l(i,s.WindowOverFrameFollowing.CurrentRow,s.WindowOverFrameFollowing.UnBounded,u,e)),d(o)&&(t.exclude=p(o))),v(t,e,u),t}function l(t,n,i,r,e){var i,t,i,u;return"[@]"===t?{type:o.current,option:{type:n}}:"-1"===t?{type:o.unbounded,option:{type:i}}:(i=/^\[@([-\+])(\d+(\.\d+)?)\]$/.exec(t))&&(t=i[1],i=Number(i[2]),u=void 0,"-"===t?u=s.WindowOverFramePreceding.NPreceding:"+"===t&&(u=s.WindowOverFrameFollowing.NFollowing),r===s.WindowOverFrameType.ROWS||r===s.WindowOverFrameType.GROUPS?i=Math.floor(i):e&&("-"===t?u=s.WindowOverFrameFollowing.NFollowing:"+"===t&&(u=s.WindowOverFramePreceding.NPreceding)),0!==i)?{type:o.range,value:Number(t+i),option:{type:u,offset:i}}:{type:o.current,option:{type:n}}}function v(t,n,i){var r=t.begin,e=t.end,u=!1;e?(n&&i===s.WindowOverFrameType.RANGE?(r.type===o.unbounded||r.type===o.current&&(e.type===o.unbounded||e.type===o.current||e.type===o.range&&e.value<=0)||r.type===o.range&&(e.type===o.unbounded||0<=r.value&&e.type===o.current||e.type===o.range&&r.value>=e.value))&&(u=!0):(r.type===o.unbounded||r.type===o.current&&(e.type===o.unbounded||e.type===o.current||e.type===o.range&&0<=e.value)||r.type===o.range&&(e.type===o.unbounded||r.value<=0&&e.type===o.current||e.type===o.range&&r.value<=e.value))&&(u=!0),t.begin=t.begin.option,t.end=t.end.option,u||(t.begin.offset=-1,t.end.offset=-1)):t.begin=t.begin.option}function d(t){return("number"==typeof t||t&&2===t.type&&"number"==typeof t.value)&&((t=t.value?t.value:t)===s.WindowOverFrameExcludeMode.current||t===s.WindowOverFrameExcludeMode.group||t===s.WindowOverFrameExcludeMode.none||t===s.WindowOverFrameExcludeMode.ties)}function p(t){return"number"==typeof t?t:t.value}Object.defineProperty(n,"__esModule",{value:!0}),n.addFrameGroupsCustomFunctions=n.addFrameRowsCustomFunctions=n.addFrameRangeCustomFunctions=void 0,r=i("CalcEngine"),s=i("./dist/src/dataSource/dataSource.interface.js"),c=i("./dist/src/dataSource/utils.js"),f=i("./dist/src/calculation/functions/windowOvers/util.js"),(i=o=o||{})[i.unbounded=-1]="unbounded",i[i.current=0]="current",i[i.range=1]="range",n.addFrameRangeCustomFunctions=e,n.addFrameRowsCustomFunctions=u,n.addFrameGroupsCustomFunctions=a},"./dist/src/calculation/functions/windowOvers/util.js":function(t,n,i){"use strict";var r,i;function e(t,n){return t.getCalcService().unparse(t,n,0,0)}function u(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function o(t,n){try{return t.getCalcService().parse(t,n,0,0)}catch(t){return null}}function s(t,n,i){t.wEt("windowFrameOrder",!1===(i&&0<i.length&&i[0].ascending));var i=t.getCalcService().evaluateExpression(t,n,{row:0,col:0});return t.wEt("windowFrameOrder"),i}function c(t,n){var i,n,i=e(t,n);return 14===n.type?(i=i.replace(/[\[\]]/g,""),(n=t.nM.UAe(i))&&(i=n)):i="=".concat(i),i}function f(t){return(0,r.isNullOrUndefined)(t)?null:t.functionName||t.function&&t.function.name}function a(t){return f(t)===n.PARTITIONBY}function h(t){return f(t)===n.ORDERBY}function l(t){var t=f(t);return t===n.FRAMERANGE||t===n.FRAMEROWS||t===n.FRAMEGROUPS}function v(t){return f(t)===n.WINDOWDEF}function d(t,n,i,r){var e,u,o;return a(n)?(e=p(t,n),h(i)?(u=p(t,i),l(r)&&(o=w(t,r,u))):l(i)?o=w(t,i):b(i)&&l(r)&&(o=w(t,r,u))):h(n)?(u=p(t,n),l(i)&&(o=w(t,i,u))):l(n)?o=w(t,n):b(n)&&(h(i)?(u=p(t,i),l(r)&&(o=w(t,r,u))):l(i)&&(o=w(t,i))),{partitions:e,orders:u,windowFrame:o}}function p(t,n){var i=u(t,n);return i.formula=e(t,n),i}function w(t,n,i){var i=s(t,n,i);return i.formula=e(t,n),i}function b(t){return t&&3===t.type}Object.defineProperty(n,"__esModule",{value:!0}),n.isStringExpression=n.getOverOptions=n.isWindowDef=n.isWindowFrame=n.isOrderBy=n.isPartitionBy=n.getExprFunctionName=n.getFieldOption=n.evaluateFrameExpression=n.parseFormula=n.evaluateExpression=n.unparseExpression=n.WINDOWDEF=n.WINDOWOVERDECONSTRUCT=n.FRAMEGROUPS=n.FRAMEROWS=n.FRAMERANGE=n.ORDERDESC=n.ORDERASC=n.ORDERBY=n.PARTITIONBY=n.WINDOWOVER=n.CalcFunction=void 0,r=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=i.CalcFunction,n.WINDOWOVER="WINDOW",n.PARTITIONBY="PARTITIONBY",n.ORDERBY="ORDERBY",n.ORDERASC="ORDERASC",n.ORDERDESC="ORDERDESC",n.FRAMERANGE="FRAMERANGE",n.FRAMEROWS="FRAMEROWS",n.FRAMEGROUPS="FRAMEGROUPS",n.WINDOWOVERDECONSTRUCT="WINDOWOVERDECONSTRUCT",n.WINDOWDEF="WINDOWDEF",n.unparseExpression=e,n.evaluateExpression=u,n.parseFormula=o,n.evaluateFrameExpression=s,n.getFieldOption=c,n.getExprFunctionName=f,n.isPartitionBy=a,n.isOrderBy=h,n.isWindowFrame=l,n.isWindowDef=v,n.getOverOptions=d,n.isStringExpression=b},"./dist/src/calculation/functions/windowOvers/windowOver.js":function(t,n,i){"use strict";var r,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.WINDOWOVER,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,e){var u=t.Hhe.D5;return u||(t.Hhe.D5=u=o(t.source,t.Hhe)),t.source.nM._getValueByField(u,t.source.DJ)},r.Functions.defineGlobalCustomFunction(e.WINDOWOVER,new t)}function o(t,n){var t=(0,e.unparseExpression)(t,n);return"="===t[0]?t:"="+t}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverCustomFunctions=u},"./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js":function(t,n,i){"use strict";var r,a;function e(){function t(){}(t.prototype=new r.Functions.Function(a.WINDOWOVERDECONSTRUCT,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,e){var t,u,o,s,c,o,i,r,f,e,t=t.source,u=(0,a.unparseExpression)(t,n),o=(0,a.getOverOptions)(t,i,r,e),s=o.partitions,c=o.orders,o=o.windowFrame,i=h(i,t)||h(r,t)||h(e,t)||{},r={windowExpression:n,windowFormula:u,partitions:s||i.partitions,orders:c||i.orders,windowFrame:o||i.windowFrame,formulaFromWindowChaining:void 0,windowDefineName:i.windowDefineName},f;return 0<Object.keys(i).length&&(e="=".concat(a.WINDOWOVER,"(").concat(u),r.partitions&&(e+=",".concat(r.partitions.formula)),r.orders&&(e+=",".concat(r.orders.formula)),r.windowFrame&&(e+=",".concat(r.windowFrame.formula)),r.formulaFromWindowChaining=e+=")"),r},r.Functions.defineGlobalCustomFunction(a.WINDOWOVERDECONSTRUCT,new t)}function h(t,n){var i,i,i,t,i,i,i,r,e,i,n;if((0,a.isStringExpression)(t))return t=t.value,(i=null==(i=null==(i=null==(i=n.nM._dataSource)?void 0:i.options)?void 0:i.schema)?void 0:i.window)&&i[t]&&(i=i[t])&&(i=(0,a.parseFormula)(n,i),(0,a.isWindowDef)(i))?(r=i.arguments[0],e=i.arguments[1],i=i.arguments[2],(n=(0,a.getOverOptions)(n,r,e,i)).windowDefineName=t,n):{windowDefineName:t}}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDeconstructCustomFunctions=void 0,r=i("CalcEngine"),a=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDeconstructCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/windowOverDefine.js":function(t,n,i){"use strict";var r,e;function u(){function t(){}(t.prototype=new e.CalcFunction(e.WINDOWDEF,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r){return(0,e.getOverOptions)(t.source,n,i,r)},r.Functions.defineGlobalCustomFunction(e.WINDOWDEF,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDefineCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDefineCustomFunctions=u},"./dist/src/calculation/functions/windowOvers/windowOvers.entry.js":function(t,n,i){"use strict";var r,e,u,o,s,c,f;function a(){(0,r.addWindowOverCustomFunctions)(),(0,f.addWindowOverDefineCustomFunctions)(),(0,c.addWindowOverDeconstructCustomFunctions)(),(0,e.addPartitionByCustomFunctions)(),(0,u.addOrderByCustomFunctions)(),(0,o.addFrameRangeCustomFunctions)(),(0,o.addFrameRowsCustomFunctions)(),(0,o.addFrameGroupsCustomFunctions)(),(0,s.addOrderAscCustomFunctions)(),(0,s.addOrderDescCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverFunctions=void 0,r=i("./dist/src/calculation/functions/windowOvers/windowOver.js"),e=i("./dist/src/calculation/functions/windowOvers/partitionBy.js"),u=i("./dist/src/calculation/functions/windowOvers/orderBy.js"),o=i("./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js"),s=i("./dist/src/calculation/functions/windowOvers/ascDesc.js"),c=i("./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js"),f=i("./dist/src/calculation/functions/windowOvers/windowOverDefine.js"),n.addWindowOverFunctions=a},"./dist/src/calculation/queryFunctionResolver.js":function(t,n,i){"use strict";var i,h,l,r;function v(i,r,e){return function(t){var n=[];return n.push(t.kEt(t.mEt(i),r||t._dataSource.DEt,e)),n}}function e(){}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryFunctionSolver=void 0,i=i("Common"),h=null,l=i.Common.zf.fJ,e.parseParam=function(u,o,s,c){for(var f,a,t,n,f=Object.keys(c.tables),a=new e,t=function(t){var t,n,i,r,e,t=f[t];u===t?(a.getValue=function(t){var t;return a.Mgr||(t=t.ASt(h,h,o,s),a.Mgr=t)},a.table=c.tables[t]):l(u,t)&&(a.table=c.tables[t],n=u[t.length],i=u.substr(t.length+1),"#"===n?(r=parseInt(i,10),a.getValue=function(t){var n;return a.Mgr||((n=[]).push(t.kEt(r,o||t._dataSource.DEt,s)),a.Mgr=n)}):"/"===n?a.getValue=function(t){var t;return a.Mgr||(t=v(i,o,s)(t),a.Mgr=t)}:"?"===n?1===(e=i.split("=",2)).length?a.getValue=function(t){var t;return a.Mgr||(t=v(i,o,s)(t),a.Mgr=t)}:a.getValue=function(t){var t;return a.Mgr||(t=t.ASt(e[1],e[0],o,s),a.Mgr=t)}:delete a.table)},n=0;n<f.length;n++)t(n);return a},n.QueryFunctionSolver=e},"./dist/src/calculation/tokenResolver.js":function(t,n,i){"use strict";var r,e,c,h,f,u,o,s,a;function l(t){var n=s.call(this,14)||this;return n.value=t,n}function v(t){return a.call(this,t)||this}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerTokenResolver=void 0,e=i("CalcEngine"),c=i("./dist/src/calculation/calcSource.js"),h=i("./dist/src/dataSource/utils.js"),s=e.Expression,r(l,s),l.prototype.Iwt=function(t,n){var i;this.value instanceof c.DataManagerReference&&this.value.table._Et(t,this.value.Pq[0],n)},f=l,a=e.TokenResolver,r(v,a),v.prototype.resolveToken=function(t,n,i,r,e){var i,u,t,t,i,o,s,i=i[r],u=i.Awt,t=t.source,t=t&&t.nM;if(t&&0===i._type&&"["===u[0]&&"]"===u[u.length-1]&&(i=new c.DataManagerReference,-1!==(o=this.EEt(i,u,1)))&&(i.rowString=u.substring(1,o),-1!==(o=this.jEt(i,u,o))))return i.table=t,i.Pq=i.field,i.field=t.bEt(i.field),{expr:s=new f(i),index:r+1}},v.prototype.EEt=function(t,e,n){var u,i,r,o,s;function c(t,n){for(var i=n?t+1:t;"0"<=e[i]&&e[i]<="9";)i++;for(;" "===e[i];)i++;return{value:parseInt(e.substring(t,i),10),end:i}}function f(t){for(var n=t;n<e.length&&"["!==e[n]&&"]"!==e[n]&&","!==e[n];)n++;return{type:"key",value:e.substring(t,n).trim(),end:n}}function a(t){var n,i,r,i,n=e[t],i=e[t+1];return"@"===n?(u=!0,"+"===i||"-"===i?(r=c(t+1,!0)).end<=t+1?-1:{num:r.value,end:r.end,relative:!0}:{num:0,end:t+1,relative:!0}):"#"===n?(r=c(t+1)).end>t+1?{num:r.value,end:r.end,relative:!1}:"last"===e.substr(t+1,4)?{num:-1,end:t+5,relative:!1}:"odd"===e.substr(t+1,3)?{type:"odd",end:t+4}:"even"===e.substr(t+1,4)?{type:"even",end:t+5}:-1:"$"!==n||(i=f(t+1)).end>=e.length?-1:i}for(u=!1,i=null;n<e.length&&"["!==(r=e[n])&&"]"!==r;)if(i||"@"!==r&&"#"!==r&&"$"!==r){if(","===r&&i)i=!1;else if(" "!==r)break;n++}else{if(-1===(o=a(n)))return-1;if(":"!==e[o.end]||(0,h.isNullOrUndefined)(o.num))t.row.push(o),n=o.end;else{for(n=o.end+1;" "===e[n];)n++;if(-1===(s=a(n))||(0,h.isNullOrUndefined)(s.num))return-1;t.row.push([o,s]),n=s.end}i=!0}return t.gEt=u,!1===i?-1:n},v.prototype.jEt=function(t,i,n){var r,e,u;function o(t){for(var n=t;"]"!==i[n];)n++;return{str:i.substring(t,n),end:n}}function s(t){for(var n=t;"."!==i[n]&&"]"!==i[n];)n++;return{str:i.substring(t,n),end:n}}for(r=null;n<i.length;)if("["!==(e=i[n])||r){if("]"===e)break;if(" "===e)n++;else if("."===e&&r)n++,r=!1;else{if("."===e||r)return-1;u=s(n),t.field.push(u.str),n=u.end,r=!0}}else{if((u=o(n+1)).end<=n+1)return-1;t.field.push(u.str),n=u.end+1,r=!0}return n===i.length-1?n:-1},v.prototype.unparse=function(t,n,i,r){var e,u,o,s,c,f;if(14!==i.type)return!1;if(r.push("["),0<(e=i.value.rowString).length&&r.push(e),0<(u=i.value.Pq).length)for(o="@"===e||""===e,s=0,c=u.length;s<c;s++)f=u[s],!o||-1<f.indexOf(" ")?r.push("[".concat(f,"]")):r.push(f),s<c-1&&r.push(".");return r.push("]"),!0},n.DataManagerTokenResolver=v},"./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js":function(t,n,i){"use strict";var r,e,u,o,s;function c(t){this.QSt={},this.N3=t}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerProxy=void 0,r=i("CalcEngine"),e=i("./dist/src/dataManager.entry.js"),u=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),o=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),c.prototype.getTable=function(t){var n,i;if(!(0,e.isNullOrUndefined)(t)){if(this.QSt[t])return this.QSt[t];if((n=this.N3.tables)[t])return this.QSt[t]=new o.ReportTable({dataManagerTable:n[t]}),this.QSt[t];for(i in t=t.toUpperCase(),n)if(n.hasOwnProperty(i)&&i.toUpperCase()===t)return this.QSt[t]=new o.ReportTable({dataManagerTable:n[i]}),this.QSt[t];return(0,u.isFormulaInWhitelist)(t)?(this.QSt[t]=this.generateFormulaTableByFormula(t),this.QSt[t]):void 0}},c.prototype.getCalcService=function(){var t=this.N3.Lp;return t.allowDynamicArray=!0,t},c.prototype.getTables=function(){return this.QSt},c.prototype.getRelationshipsByTable=function(t){var n,i,n=this.N3.relationships;return t&&(i=t.table(),n=n.filter(function(t){return t.sourceTable===i||t.targetTable===i})),n},c.prototype.generateFormulaTableByFormula=function(t){var n,i,n,n=this.getCalcService(),i=new r.CalcSource(n),n=(0,u.getFormulaResult)(n,i,t.replace(/__\d+__\d+/g,""));return new o.ReportTable({formulaTable:{name:t,formulaResult:n}})},c.prototype.clearTableDataCache=function(){var t,n,t=this.QSt;for(n in t)t.hasOwnProperty(n)&&t[n].clearTableDataCache()},n.DataManagerProxy=c},"./dist/src/data-manager-report/data-manager-proxy/report-table.js":function(t,n,i){"use strict";var s,r;function e(t){var i,n,t,i=this,n=t.dataManagerTable,t=t.formulaTable;n?(this.c1e=n,this.Sye={}):this.f1e=t,this.f1e&&(this.l1e=this.f1e.formulaResult.map(function(t){var n={};return n[i.f1e.name]=t,n}))}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTable=void 0,s=i("./dist/src/dataManager.entry.js"),Object.defineProperty(e.prototype,"name",{get:function(){return(this.c1e||this.f1e).name},enumerable:!1,configurable:!0}),e.prototype.table=function(){return this.c1e},e.prototype.getFields=function(){return this.c1e.ltt()},e.prototype.getData=function(t){var n,i,r,e;if(this.f1e)if(t)for(n=[],i=0,r=t;i<r.length;i++)e=r[i],n.push(this.l1e[e]);else n=this.l1e;else n=this.c1e.getDataSync(t);return n},e.prototype.length=function(){return this.f1e?this.l1e.length:this.c1e.length()},e.prototype.getValueByField=function(t,n,i){var r,e,u,o;return this.f1e?(0,s.formatCalcError)(this.f1e.formulaResult[n]):(r=void 0,(e=this.Sye[t])&&e.hasOwnProperty(n)?r=e[n]:((u=this.c1e.columns)[o=t]&&"string"==typeof u[t].value&&(o=u[t].value),r=this.c1e._getValueByField(o,n),(e=e||(this.Sye[t]={}))[n]=r),t.startsWith("=")&&!i?(0,s.formatCalcError)(r):r)},e.prototype.hasField=function(n){return this.f1e?n===this.f1e.name:(n=n.toUpperCase(),0<Object.keys(this.c1e.columns).filter(function(t){return t.toUpperCase()===n}).length)},e.prototype.getFieldByNameIgnoreCase=function(t){return this.f1e?{fieldName:this.name}:this.c1e.h1e(t)},e.prototype.reset=function(){this.f1e||(this.c1e.XOt={})},e.prototype.clearTableDataCache=function(){this.Sye={}},n.ReportTable=e},"./dist/src/data-manager-report/data-manager-report.js":function(t,n,i){"use strict";var n,r,e,u;Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/dataManager.js"),e=i("./dist/src/data-manager-report/tree-data-generator/index.js"),(u=n.Common.lt.Dh)(r.DataManager.prototype,{generateTreeData:function(t){var n;new e.TreeDataGenerator(this,t).generateTreeData()}})},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js":function(t,n,i){"use strict";var E,x,A,r;function e(t,n,i,r,e){this.N3=t,this.DJ=n,this.d1e=i,this.v1e=r,this.m1e=e}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportCrossHelper=void 0,E=i("./dist/src/dataManager.entry.js"),x=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),A=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),e.prototype.processCrossCells=function(t){var o=this;try{t.forEach(function(t){var n,u,i,n=t.leftParent.data.groups,u=t.upParent.data.groups,i=o.g1e(t);i?i.data.groups.forEach(function(i){var r,e,r=[],e=[];n.forEach(function(t){t===i&&r.push(t);for(var n=t.leftParent||t.upParent;n;){if(n===i)return void r.push(t);if(n.cellNode===i.cellNode)return;n=n.leftParent||n.upParent}}),u.forEach(function(t){t===i&&e.push(t);for(var n=t.upParent||t.leftParent;n;){if(n===i)return void e.push(t);if(n.cellNode===i.cellNode)return;n=n.upParent||n.leftParent}}),o.p1e(t,r,e)}):o.p1e(t,n,u)})}catch(t){}},e.prototype.g1e=function(t){for(var n,i,n=t.leftParent;n;){for(i=t.upParent;i;){if(i===n)return n;i=i.upParent||i.leftParent}n=n.leftParent||n.upParent}return null},e.prototype.p1e=function(i,t,n){var u,o,s,c,f,r,e,a,h,l,v,d,p,w,l,l,u=this,o=i.indexOfLeftParentChildren,s=i.indexOfUpParentChildren,c={},f=[],r,e=this.d1e.getRelationshipsMap()[i.relationshipMapKey];for(t.forEach(function(i,r){var t,e;i.crossChildren[o]||(i.crossChildren[o]=[]),t=i.valuePath,c[t]||(c[t]={}),e=c[t],n.forEach(function(t,n){t.crossChildren[s]||(t.crossChildren[s]=[]);var n={vg:i,hg:t,vIndex:r,hIndex:n,crossChildren:[],crossRecordRowNumbers:[]};e[t.valuePath]=n,f.push(n)})}),e&&e.forEach(function(t,r){var n,e,n=u.v1e.generateParentPaths(i.leftParent,t),e=u.v1e.generateParentPaths(i.upParent,t);n.forEach(function(i){e.forEach(function(t){var n=c[i],n=null==n?void 0:n[t];n&&n.crossRecordRowNumbers.push(r)})})}),a=0,h=f;a<h.length;a++)v=(l=h[a]).vg,d=l.hg,p=l.vIndex,w=l.hIndex,l=l.crossRecordRowNumbers,l=this.y1e(v,d,l,i),v.crossChildren[o][w]=l,d.crossChildren[s][p]=l},e.prototype.y1e=function(t,n,i,r,e){var u,o,s,s,c,f,u,u=this.N3;return t&&n||(s=(s=(o=t||n)&&o.cellNode)&&s.relationshipMapKey,c=r.relationshipMapKey,void 0!==s&&c!==s&&i&&i.length&&(f=(0,x.getTableNameByCellNode)(r),u=u.getTable(f))&&e&&(i=this.v1e.M1e(r,i,u,e,c,s,o))),"No"===r.templateCell.expansionDirection?this.C1e(t,n,i,r):this.S1e(t,n,i,r)},e.prototype.C1e=function(t,n,i,r){var e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,b;if(r.templateCell.dataColumn?(o=r.templateCell.dataColumn.tableName,s=r.templateCell.dataColumn.columnName):r.templateCell.formula&&"No"!==r.templateCell.expansionDirection&&(0,x.isFormulaInWhitelist)(r.templateCell.formula)&&(o=(0,x.getTableNameByCellNode)(r),s=r.templateCell.formula),c=[],f={},(0,E.isNullOrUndefined)(o))e=r.templateCell.value;else{if(!(u=this.N3.getTable(o)))return[];A.DataManagerReportSortHelper.parseSortOptionsToSorts(r.templateCell),a=(this.d1e.getTableNameCacheFromParent(r)||o).toUpperCase(),h=this.d1e.getRelationshipsMap()[r.relationshipMapKey],i.forEach(function(t){var t=h[t]&&h[t][a];void 0===t||f[t]||(c.push(t),f[t]=!0)}),l=c.map(function(t){return u.getValueByField(s,t)}),e=this.T1e(l,r)}for(v={value:e,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:i,cellNode:r,state:"normal",I1e:f},0!==c.length||(0,E.isNullOrUndefined)(o)||(v.defaultFormula=(0,x.generateDefaultFormulaByTemplateCell)(r.templateCell),v.state="new"),d=0,p=r.children;d<p.length;d++)m=b=void 0,(w=p[d]).leftParent===r?b=v:w.upParent===r&&(m=v),b=this.y1e(b,m,i,w,u),v.childrenArray.push(b);return r.data.groups.push(v),[v]},e.prototype.S1e=function(h,l,v,d){var o,t,n,t,p,w,s,n,b,t,m,i,r,e,u,c,f,a,j,y,g,_,t,n,t,O,C,S,M,F,N,T,R,I,R,o=this,p=[],w=d.templateCell,s=w.dataSetting,n=s.type;if(w.dataColumn?(t=w.dataColumn.tableName,m=w.dataColumn.columnName):w.formula&&"No"!==w.expansionDirection&&(0,x.isFormulaInWhitelist)(w.formula)&&(t=(0,x.getTableNameByCellNode)(d),m=w.formula),(0,E.isNullOrUndefined)(t))p.push({value:w.value,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:d,state:"normal",sortValues:[d.templateCell.value],I1e:{}});else{if(!(b=this.N3.getTable(t)))return[];if(A.DataManagerReportSortHelper.parseSortOptionsToSorts(w),i=(this.d1e.getTableNameCacheFromParent(d)||t).toUpperCase(),r=this.d1e.getRelationshipsMap()[d.relationshipMapKey],e=[],u=[],c={},f=[],!v){for(a=r.length,j=[],y=0;y<a;)j.push(y++);v=j}v.forEach(function(t){var n,n,n=null==(n=r[t])?void 0:n[i];void 0!==n&&(e.push(n),c[n]||(u.push(n),c[n]=!0),f[n]||(f[n]=[]),f[n].push(t))}),0===v.length?p.push({value:void 0,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:d,state:"new",sortValues:null,I1e:{},defaultFormula:(0,x.generateDefaultFormulaByTemplateCell)(w)}):"Group"===n?(e.forEach(function(c,f){for(var t,a,n,n,i,r,e,u,n=b.getValueByField(m,c),n=[{value:n,advancedGroupSortName:n}],i=function(n){var t,i,t,r,e,u,o,s,i=n.advancedGroupSortName+"",t=p.find(function(t){return t.value===n.value});if(t)t.recordRowNumbers.push(v[f]),t.I1e[c]||(t.I1e[c]=!0);else{if(r=[],null!=(a=w.x1e)&&a.length)for(e=0,u=w.x1e;e<u.length;e++)o=u[e],(s=void 0,E.isNullOrUndefined)(o.column)||(s=b.getValueByField(o.column,c)),r.push(s);p.push({value:n.value,N1e:i,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[v[f]],cellNode:d,state:"normal",sortValues:r,I1e:((t={})[c]=!0,t)})}},r=0,e=n=null!=(t=s.bins)&&t.length?o.v1e.getAdvancedGroupValue(b,c,s):n;r<e.length;r++)i(u=e[r])}),null!=(t=s.bins)&&t.length&&(g={},_={},p.forEach(function(t){_[t.N1e]=!0}),s.bins.forEach(function(t,n){var n,i;g[t.caption]=n,n=t.caption,_[t.caption]||!0!==t.alwaysVisible||p.push(i={value:n,N1e:n,recordRowNumbers:[],childrenArray:[],leftParent:h,upParent:l,crossChildren:[],state:"new",cellNode:d,sortValues:null,I1e:{}})}),p.sort(function(t,n){var i,r;return g[t.N1e+""]-g[n.N1e+""]}))):"List"===n?u.forEach(function(t,n){var i,i,r,e,u,o,s,c,r=b.getValueByField(m,t),e=[];if(null!=(i=w.x1e)&&i.length)for(u=0,o=w.x1e;u<o.length;u++)s=o[u],(c=void 0,E.isNullOrUndefined)(s.column)||(c=b.getValueByField(s.column,t)),e.push(c);p.push({value:r,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:f[t],cellNode:d,state:"normal",sortValues:e,I1e:((i={})[t]=!0,i)})}):(t=u.map(function(t){return b.getValueByField(m,t)}),n=w.dataSetting,t=(0,x.calc)(t,n.aggregation),p.push({value:t,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:v,cellNode:d,state:"normal",sortValues:[t],I1e:c}))}for(O=0,C=p;O<C.length;O++)for(M=(S=C[O]).recordRowNumbers,F=0,N=d.children;F<N.length;F++)I=R=void 0,(T=N[F]).leftParent===d?R=S:T.upParent===d&&(I=S),R=this.y1e(R,I,M,T,b),S.childrenArray.push(R);return null!=(n=this.m1e)&&n.sortGroupsBySortCondition(p,d,null==(t=this.DJ)?void 0:t.cellNodeGetter),p.forEach(function(t){d.data.groups.push(t)}),p},e.prototype.T1e=function(t,n){var n,i,n=n.templateCell.dataSetting;return n&&"Group"===n.type?(i=[],t.forEach(function(t){-1===i.indexOf(t)&&i.push(t)}),1<i.length?i:i[0]):"List"===n.type?t.map(function(t){return t}):(0,x.calc)(t,n&&n.aggregation||"Sum")},n.DataManagerReportCrossHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js":function(t,n,i){"use strict";var l,R,D,g,r;function e(t,n,i,r){this.N3=t,this.DJ=n,this.k1e=new l.CalcSource(t.getCalcService()),this.D1e={},this.cdr={},this.m1e=r,this.d1e=i}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportGroupHelper=void 0,l=i("CalcEngine"),R=i("./dist/src/dataManager.entry.js"),D=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),g=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),e.prototype.generateCellNodeTreeData=function(n,t,i,r,e,u,o){var s,c,f,a,h,f,c,l,v,d,p,w,b,m,j,y,s,y,f=this.N3,h=(0,D.getTableByCellNode)(f,n),f=[],c={};for(n.templateCell.dataColumn?a=n.templateCell.dataColumn.columnName:n.templateCell.formula&&(0,D.isFormulaInWhitelist)(n.templateCell.formula)?a=n.templateCell.formula:f.push({value:n.templateCell.value,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:t,upParent:i,crossChildren:[],state:"normal",cellNode:n,sortValues:null,valuePath:this.j1e(t,i)+"/"+n.templateCell.value}),h||0!==f.length||f.push({value:void 0,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:t,upParent:i,crossChildren:[],state:"new",cellNode:n,sortValues:null,valuePath:this.j1e(t,i)+"/",defaultFormula:(0,D.generateDefaultFormulaByTemplateCell)(n.templateCell)}),g.DataManagerReportSortHelper.parseSortOptionsToSorts(n.templateCell),l=this.d1e&&this.d1e.generateRelationshipMapKeyByCellNode(n),d=f=(v=0)===f.length?this.Qqn(c,n,h,a,l,t,i,r,e,u,o):f;v<d.length;v++)for(w=(p=d[v]).recordRowNumbers,b=0,m=n.children;b<m.length;b++)(j=m[b]).leftParent&&j.upParent?p.childrenArray.push([]):(s=y=void 0,j.leftParent?y=p:j.upParent&&(s=p),y=this.generateCellNodeTreeData(j,y,s,w,h,l,o),p.childrenArray.push(y),null!=(s=j.slices)&&s.forEach(function(t){delete t.groupMapCache,delete t.groupsCache}));return null!=(c=this.m1e)&&c.sortGroupsBySortCondition(f,n,this.DJ&&this.DJ.cellNodeGetter),f.forEach(function(t){return n.data.groups.push(t)}),f},e.prototype.clearCache=function(t){t&&(this.k1e=null,this.D1e=void 0,this.cdr=void 0)},e.prototype.Qqn=function(t,r,n,i,e,u,o,s,c,f,a){var h,l,v,d,h,p,w,l,b,m,j,l,y,g,b,_,O,C,v=[],d={},h=null==(h=this.d1e)?void 0:h.getRelationshipsMap(),p=r.templateCell,w=p.dataSetting;if(e&&h&&h[e]||s)if(l=0===(null==(l=null==h?void 0:h[e])?void 0:l.length),b=!c&&s&&0===s.length,l||b?s=void 0:void 0!==f&&e!==f&&s&&s.length&&(s=this.M1e(r,s,n,c,e,f,u||o)),m=s?s.length:e?h[e].length:0,j=this.j1e(u,o),w&&"Summary"===w.type)v=this.E1e(r,n,i,s,e,u,o,j);else{if(0===m)l={value:void 0,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:u,upParent:o,crossChildren:[],state:"new",cellNode:r,sortValues:null,valuePath:j+"/",defaultFormula:(0,D.generateDefaultFormulaByTemplateCell)(p)},v.push(l);else{for(y=0;y<m;y++)g=s?s[y]:y,this.O1e(v,t,d,r,n,i,g,e,u,o,j,a);"No"===p.expansionDirection&&(_=(b=v[0])&&Array.isArray(b.value))&&(b.N1e=b.N1e.toString(),b.valuePath+=b.value.toString())}w&&"Group"===w.type&&w.bins&&w.bins.length&&(O={},C={},v.forEach(function(t){C[t.N1e]=!0}),w.bins.forEach(function(t,n){var n,i;O[t.caption]=n,n=t.caption,C[t.caption]||!0!==t.alwaysVisible||v.push(i={value:n,N1e:n,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:u,upParent:o,crossChildren:[],state:"new",cellNode:r,sortValues:null,valuePath:j+"/"+n})}),v.sort(function(t,n){var i,r;return O[t.N1e+""]-O[n.N1e+""]}))}return v},e.prototype.O1e=function(c,f,a,h,t,n,l,i,v,d,p,w){var b,r,e,r,n,m,u,r,e,r,j,e,y,i,g,o,s,_,O,C,S,e,M,F,N,T,b=this,u,r=(null==(r=this.d1e)?void 0:r.getTableNameCacheFromParent(h))||(null==t?void 0:t.name),e=null==(e=this.d1e)?void 0:e.getRelationshipsMap(),r=r.toUpperCase(),j=e?e[i][l][r]:l;if(void 0!==j||e&&e[i][l].hasOwnProperty(r)){if(e=t.getValueByField(n,j),y=[{value:e,advancedGroupSortName:e}],i=h.templateCell.dataSetting,g=[],null!=(r=h.templateCell.x1e)&&r.length)for(o=0,s=h.templateCell.x1e;o<s.length;o++)C=(_=s[o]).column,S=_.formula,(O=void 0,R.isNullOrUndefined)(C)?(0,R.isNullOrUndefined)(S)||(O=t.getValueByField(S,j)):O=t.getValueByField(_.column,j),g.push(O);for(i&&"Group"===i.type&&(null!=(n=i.bins)&&n.length||i.formula)&&(y=this.getAdvancedGroupValue(t,j,i),e=(e=h.templateCell.w1e)||(h.templateCell.w1e=[]),M=(M=e[j])||(e[j]=[]),y.forEach(function(t){var t=t.value+"";-1===M.indexOf(t)&&M.push(t)})),F=i&&"List"===i.type,N=function(t){var t,n,i,o,r,e,u,s,t=y[t],n=t.value,i=t.advancedGroupSortName,o=f[n];o&&!F||(r=!0,F&&(o=a[j])&&(r=!1),"No"===h.templateCell.expansionDirection&&(o=c[0])&&(r=!1,e=o.value,u=o.N1e,Array.isArray(e)||(e=[o.value]),Array.isArray(u)||(u=[o.N1e]),o.I1e[j]||(e.push(t.value),u.push(t.advancedGroupSortName)),o.value=e,o.N1e=u,o.valuePath=p+"/",f[n]=o),r&&(o={value:t.value,N1e:i,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:v,upParent:d,crossChildren:[],state:"normal",cellNode:h,valuePath:p+"/"+t.value+(F?"/"+j:""),sortValues:g,slices:null},c.push(o),f[n]=o,F)&&(a[j]=o)),null!=(m=h.slices)&&m.length&&(s=o.value,h.slices.forEach(function(t,n){var i,r,e,i,r,u,i=t.groupsCache,r=t.groupMapCache,e=(e=(i=i||(t.groupsCache={}))[s+""])||(i[s+""]=[]),i=(i=(r=r||(t.groupMapCache={}))[s+""])||(r[s+""]={}),r=t.templateCell.dataColumn.tableName,u=t.templateCell.dataColumn.columnName;b.O1e(e,i,a,t,b.N3.getTable(r),u,j,void 0,void 0,void 0,""),o.slices||(o.slices=[]),void 0===o.slices[n]&&(o.slices[n]={childrenArray:[e]})})),o.recordRowNumbers.push(l),null!=w&&w.ignoreMultipleTableJoinCache||o.I1e[j]||(o.I1e[j]=!0)},T=0;T<y.length;T++)N(T)}},e.prototype.j1e=function(t,n){var i,r,t,i="";return t?(r=(0,R.isNullOrUndefined)(t.value)?"":t.value,i=void 0!==t.valuePath?t.valuePath:r.toString()):n&&(t=(0,R.isNullOrUndefined)(n.value)?"":n.value,i=void 0!==n.valuePath?n.valuePath:t.toString()),i},e.prototype.E1e=function(t,n,i,r,e,u,o,s){for(var c,c,f,a,h,l,v,d,p,w,b,m,j,c,c,y,f=t.templateCell.dataSetting,a=null==(c=this.d1e)?void 0:c.getRelationshipsMap(),h=(r||a[e]).length,l=[],v=[],d={},p,w=((null==(c=this.d1e)?void 0:c.getTableNameCacheFromParent(t))||(null==n?void 0:n.name)).toUpperCase(),b=0;b<h;b++)m=r?r[b]:b,j=a?a[e][m][w]:m,l.push(m),d[j]||(v.push(j),d[j]=!0);return c=v.map(function(t){return n.getValueByField(i,t)}),c=(0,D.calc)(c,(null==f?void 0:f.aggregation)||"Sum"),[y={value:c=(0,R.isNullOrUndefined)(c)?0:c,N1e:"",recordRowNumbers:l,I1e:d,childrenArray:[],leftParent:u,upParent:o,crossChildren:[],state:"normal",cellNode:t,valuePath:s+"/"+c,sortValues:null,slices:null}]},e.prototype.M1e=function(t,i,n,r,e,u,o){var s,s,c,f,a,u,h,s,l,t,v,t,d,p,d,w,b,m,j,y,g,_,O,C,S,M,F,N,N,T,R,I,E,x,A,s=this.d1e.getRelationshipsMap(),c=s[e],f=s[u],a=r.name,u=null==(s=t.templateCell.R1e)?void 0:s.condition,h=[],s=o.cellNode,l=o.valuePath,t="".concat(e,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col),v=this.D1e[t];if(v=v||(this.D1e[t]=[]),t=null==c?void 0:c[0],d=n.name.toUpperCase(),p=a.toUpperCase(),d=(null==t?void 0:t.hasOwnProperty(d))&&t.hasOwnProperty(p),u){if(d){if((w=this.B1e(e,a=p))&&f){for(b=[],m=[],j=[],y=0,g=i;y<g.length;y++)if(!j[O=f[_=g[y]][a]]&&(C=w[O]))for(j[O]=!0,S=0,M=C;S<M.length;S++)m[F=M[S]]||(null!=(N=v[F])&&N[l]?b.push(F):(void 0===(N=h[F])&&(N=this.F1e(c[F],o),h[F]=N),N&&(b.push(F),m[F]=!0,v[F]||(v[F]={}),v[F][l]=!0)));return b}}else if(n===r){if(T=[],c)return R=this.d1e.getTableNameCacheFromParent(s),I=(0,D.toUpperCase)(R||r.name),c.forEach(function(t,n){-1!==i.indexOf(t[I])&&T.push(n)}),T}else if(n!==r)return null}else if(n===r){if(b=[],f){for(R=this.d1e.getTableNameCacheFromParent(s),E=(0,D.toUpperCase)(R||r.name),x=0,A=i;x<A.length;x++)_=A[x],b.push(f[_][E]);return b}}else if(n!==r)return null;return i},e.prototype.B1e=function(t,n){var i,r,e,u,o,s,c,f,a,i=n+"__TO__"+t;if(this.cdr[i])return this.cdr[i];if(e=(r=this.d1e.getRelationshipsMap())[t]){for(u=[],c=s=o=void 0,n=n.toUpperCase(),f=0,a=e.length;f<a;f++)(c=u[s=(o=e[f])[n]])||(u[s]=c=[]),c.push(f);return this.cdr[i]=u}},e.prototype.getAdvancedGroupValue=function(t,n,i){var r,e,u,i,u,o,s,c,f,a,h,h,h,r=this.N3,e=[],u=i.formula,i=i.bins;if(u)(u=u.trim()).startsWith("=")||(u="="+u),u=t.getValueByField(u,n),e.push({value:u,advancedGroupSortName:u});else if(i)for(o=0,s=i;o<s.length;o++)if(f=(c=s[o]).caption,a=c.groupBy){if("string"==typeof a)if((h=r.getCalcService().parse(this.k1e,a,0,0)).type===l.ExpressionType.name){if(h=(0,D.fieldExpressionToField)(h.value),e.push({value:t.getValueByField(h,n),advancedGroupSortName:f}),!1!==c.stopIfTrue)break}else if((h=t.getValueByField(a,n,!0))&&!(h instanceof l.CalcError)&&(e.push({value:f,advancedGroupSortName:f}),!1!==c.stopIfTrue))break}else if(0===e.length&&(e.push({value:c.caption,advancedGroupSortName:c.caption}),!1!==c.stopIfTrue))break;return e},e.prototype.F1e=function(t,n,i){var r,e,u,o,s,c,r,r,i,f,r,e=n.cellNode,u=this.d1e.getTableNameCacheFromParent(e)||(0,D.getTableNameByCellNode)(e,!0)||e.templateCell.value+"";return u=u.toUpperCase(),o=this.N3.getTable(u),s=t[u],c=!1,r=null==(r=this.d1e)?void 0:r.getRelationshipsMap(),null!=i&&i.relationshipMapKey&&r[i.relationshipMapKey]&&(r=r[i.relationshipMapKey][0])&&(i=(this.d1e.getTableNameCacheFromParent(i)||(0,D.getTableNameByCellNode)(i,!0)||i.templateCell.value+"").toUpperCase(),c=!(r.hasOwnProperty(u)&&r.hasOwnProperty(i))),void 0===s&&!t.hasOwnProperty(u)&&o?c:!(!(f=n.I1e)[s]&&o)&&(!(r=n.leftParent||n.upParent)||this.F1e(t,r,e))},e.prototype.generateParentPaths=function(i,t){var r,n,e,u,n,o,e,s,c,f,a,h,s,s,l,v,d,r=[],n=i.templateCell,e=n.dataColumn,u=n.dataSetting,n=n.expansionDirection,o=this.d1e.getTableNameCacheFromParent(i)||(null==e?void 0:e.tableName),e=null==e?void 0:e.columnName,s=null==o;return s&&(e=i.templateCell.formula||i.templateCell.value+"",o=(0,D.getTableNameByCellNode)(i,!0)||i.templateCell.value+""),o=null==o?void 0:o.toUpperCase(),c=t[o],(0,R.isNullOrUndefined)(c)?r=s?["/"+i.templateCell.value]:(s=i.data.groups.map(function(t){return"/"+t.value}),s=u&&"List"===u.type?s.map(function(t,n){return"".concat(t,"/").concat(i.data.groups[n].recordRowNumbers[0])}):s):(f=void 0,(f=i.templateCell.w1e?i.templateCell.w1e[c]||[]:(a=void 0,[a="No"===n?null==(s=(h=i.data.groups).filter(function(t){return t.I1e[c]})[0])?void 0:s.value.toString():this.N3.getTable(o).getValueByField(e,c)])).forEach(function(t){r.push("/"+t)}),u&&"List"===u.type&&r.forEach(function(t,n){r[n]+="/".concat(c)})),i.leftParent?(l=this.generateParentPaths(i.leftParent,t),v=[],l.forEach(function(n){r.forEach(function(t){v.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),v):i.upParent?(l=this.generateParentPaths(i.upParent,t),d=[],l.forEach(function(n){r.forEach(function(t){d.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),d):r},n.DataManagerReportGroupHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js":function(t,n,i){"use strict";var C,S,F,u,o,s,r;function e(t,n){var i,r,e;if(this.V1e={},this.H_e=[],this.N3=t,this.DJ=n,this.k1e=new u.CalcSource(t.getCalcService()),this.Z1e={},this.W1e=[],this.o1e={},null!=n&&n.parameter){for(e in i={},r=n.parameter)r.hasOwnProperty(e)&&(i[e.toUpperCase()]=r[e]);this.o1e=i}}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportJoinHelper=void 0,C=i("./dist/src/dataManager.entry.js"),S=i("./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js"),F=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),u=i("CalcEngine"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),s=/\[@([^\]]+\.[^\]]+)\]/i,e.prototype.generateJoinRelationIndexMap=function(t){var t,t,t,t=this.Q1e(t),t=this.K1e(t),t=this.J1e(t);this.X1e(t)},e.prototype.clearCache=function(t){this.Z1e={},t&&(this.k1e=null,this.V1e={},this.H_e=[])},e.prototype.setNodeTableCache=function(t,n,i){void 0===this.W1e[t]&&(this.W1e[t]=[]),this.W1e[t][n]=i},e.prototype.q1e=function(t,n){return this.W1e[t]&&this.W1e[t][n]},e.prototype.getTableNameCacheFromParent=function(t){var n,i,r,e,n=t.relationshipMapKey,i=this.q1e(t.templateCell.row,t.templateCell.col);if(i)return i;for(r=t.leftParent&&t.upParent,e=t.leftParent||t.upParent;!r&&e&&e.relationshipMapKey===n;){if(i=this.q1e(e.templateCell.row,e.templateCell.col))return i;r=t.leftParent&&t.upParent,e=e.leftParent||e.upParent}},e.prototype.getRelationshipsMap=function(){return this.V1e},e.prototype.relationshipGraphs=function(t){if(!t)return this.H_e;this.H_e=t},e.prototype.getRelationshipGraphTableIndex=function(t){var n,i,r,n=this.relationshipGraphs(),i=t&&t.name;if(n&&void 0!==i)for(i=i.toUpperCase(),r=0;r<n.length;r++)if(n[r].tables.find(function(t){return t.name.toUpperCase()===i}))return r;return-1},e.prototype.generateRelationshipMapKeyByCellNode=function(t){var n,i,r,e,u,o,u,n,s,c,i,f,a,h,a,h,l,i,f,f,h;if(t)return t.relationshipMapKey||(e=t.leftParent||t.upParent,u=t.leftParent&&t.upParent,o=(0,F.getTableNameByCellNode)(t,!(r=""))||t.templateCell.value+"",r=u?(u=o,this.$1e(t),s=void 0,(n=(null==(n=t.templateCell.filter)?void 0:n.condition)||t.templateCell.R1e)&&(c=t.templateCell.R1e.condition,s=this.tle(c),u=this.nle(s,u,t)),i=this.ele(t.leftParent),f=this.ele(t.upParent),i||f?i&&f?(a=this.generateRelationshipMapKeyByCellNode(t.leftParent),h=this.generateRelationshipMapKeyByCellNode(t.upParent),"".concat(a,"__CROSS__").concat(u,"__CROSS__").concat(h)):(a=void 0,h=this.generateRelationshipMapKeyByCellNode(t.leftParent),l=this.generateRelationshipMapKeyByCellNode(t.upParent),f=f?l:h,a=-1<(i=i?h:l).indexOf(o)?i:-1<f.indexOf(o)?f:h||l||o,n?this.nle(s,a,t):a):u):(this.$1e(t),(null!=(i=t.templateCell.filter)&&i.condition||t.templateCell.R1e)&&(e&&!(r=e.relationshipMapKey)&&(e.relationshipMapKey=r=this.generateRelationshipMapKeyByCellNode(e)),c=t.templateCell.R1e.condition,f=this.tle(c),r=this.nle(f,r=r||o,t)),r||(this.ele(e)?-1<(h=this.generateRelationshipMapKeyByCellNode(e)).indexOf(o)?h:"".concat(h,"__AND__").concat(o):o)),t.relationshipMapKey=r)},e.prototype.nle=function(t,i,r){var n,e,u,t,n=this,e=t.rules,u=t.relation,t=t.conditions;return e.forEach(function(t){var n,n,n;i=(0,C.isNullOrUndefined)(t.formula)?"Cell"===t.value.type||"DataColumn"===t.value.type?"object"==typeof t.value.data&&t.value.data.tableName?(0,F.toUpperCase)(i+"__"+u+"__"+(0,C.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.tableName,t.value.data.columnName)):"object"==typeof t.value.data&&t.value.data.formulaTableName?(0,F.toUpperCase)(i+"__"+u+"__"+(0,C.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.formulaTableName)):(0,F.toUpperCase)(i+"__"+u+"__"+(0,C.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,F.toUpperCase)(i+"__"+u+"__"+(0,C.combineName)(r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,F.toUpperCase)(i+"__"+u+"__"+t.formula)}),t&&t.forEach(function(t){i=n.nle(t,i,r)}),i},e.prototype.Q1e=function(t){var n=[];return(0,F.traverse)(t,n),n},e.prototype.K1e=function(t){var u,n,u=this,n=[];return t.forEach(function(t){var e=[];t.forEach(function(t){var n,i,r,i=t.templateCell;u.$1e(t),null!=(n=i.R1e)&&n.condition&&(r=u.tle(i.R1e.condition)),e.push({reportDataTableRelation:r,currentNode:t})}),n.push(e)}),n},e.prototype.parseFilterOptionToFilterConditionTree=function(t){var n,i,r,e,u,o,s,c,f,a,h,n="And",i=[],r=[];if((0,F.hasOrCondition)(t))for(n="Or",u=0,o=e=t.or;u<o.length;u++)s=o[u],(0,F.isSimpleFilterCondition)(s)?i.push(this.ile(s)):r.push(this.parseFilterOptionToFilterConditionTree(s));else if((0,F.hasAndCondition)(t))for(f=0,a=c=t.and;f<a.length;f++)h=a[f],(0,F.isSimpleFilterCondition)(h)?i.push(this.ile(h)):r.push(this.parseFilterOptionToFilterConditionTree(h));else i.push(this.ile(t));return{rules:i,conditions:r,relation:n}},e.prototype.ile=function(t){var n,i,i;return t.operator||void 0===t.formula?((0,C.isNullOrUndefined)(t.value)||(i=t.value,n={type:(0,F.getValueType)(i),data:i}),(0,C.isNullOrUndefined)(t.cell)||(n={type:"Cell",data:i="string"==typeof(i=t.cell)&&i.startsWith("=")?i.substring(1):i}),(0,C.isNullOrUndefined)(t.dataColumn)||(n={type:"DataColumn",data:i=t.dataColumn}),(0,C.isNullOrUndefined)(t.parameter)||(n={type:"Parameter",data:i=t.parameter}),(0,C.isNullOrUndefined)(t.formula)||(n={type:"Formula",data:i=void 0===(i=t.formula)||(i=i.trim()).startsWith("=")?i:"="+i}),{tableName:t.tableName,column:t.column,operator:t.operator,value:n}):{formula:i=void 0===(i=t.formula)||(i=i.trim()).startsWith("=")?i:"="+i}},e.prototype.tle=function(t){var n,i,r,e,u,n=this.rle(t.rules),i=[];if(t.conditions)for(r=0,e=t.conditions;r<e.length;r++)u=e[r],i.push(this.tle(u));return{rules:n,conditions:i,relation:t.relation}},e.prototype.rle=function(t){var u,o,s,u=this,o=[],s=this.N3;return t.forEach(function(t){var n,i,n,r,e,e;(0,C.isNullOrUndefined)(t.formula)?("Cell"===(i={tableName:t.tableName,column:t.column,operator:t.operator,value:{type:t.value.type,data:t.value.data}}).value.type&&"string"==typeof i.value.data&&F.cellNameReg.test(i.value.data)&&u.DJ.cellNodeGetter&&((r=(n=u.DJ.cellNodeGetter(i.value.data))&&n.templateCell)?r.formula&&"No"!==r.expansionDirection&&(0,F.isFormulaInWhitelist)(r.formula)?(e=(0,F.getFormulaResult)(s.getCalcService(),u.k1e,r.formula),i.value.data={formulaResult:e,formulaString:r.formula,formulaTableName:(0,F.getTableNameByCellNode)(n)}):r.dataColumn?i.value.data=r.dataColumn:i.value.data=r.value:i.value.data=""),"Parameter"===i.value.type&&"string"==typeof i.value.data&&u.o1e&&(e=u.o1e[i.value.data.toUpperCase()],i.value.type=(0,F.getValueType)(e),i.value.data=e),"Formula"===i.value.type&&"string"==typeof i.value.data&&(i.value.data=(0,F.L3e)(u.N3.getCalcService(),u.k1e,i.value.data,u.o1e)),o.push(i)):((n=t.formula.trim()).startsWith("=")||(n="="+n),o.push({formula:n}))}),o},e.prototype.J1e=function(t){var e,n,e=this,n=[];return t.forEach(function(t){var r=[];t.forEach(function(t){var n,i,n,n=t.reportDataTableRelation;n&&(i=e.ole(n,t.currentNode)),n={currentNode:t.currentNode,relations:i},r.push(n),e.R3e(t.currentNode)}),n.push(r)}),n},e.prototype.R3e=function(t){var n,i,t,r,e,n=this,t=t.templateCell;"Group"===(null==(i=null==t?void 0:t.dataSetting)?void 0:i.type)&&void 0!==(r=t.dataSetting.formula)&&(t.dataSetting.formula=(0,F.L3e)(this.N3.getCalcService(),this.k1e,t.dataSetting.formula,this.o1e)),o.DataManagerReportSortHelper.parseSortOptionsToSorts(t),null!=t&&t.x1e&&(e=t.x1e).forEach(function(t){void 0!==t.formula&&(t.formula=(0,F.L3e)(n.N3.getCalcService(),n.k1e,t.formula,n.o1e))})},e.prototype.ole=function(t,n){var i,r,e,u,i=[];if(t.conditions)for(r=0,e=t.conditions;r<e.length;r++)u=e[r],i.push(this.ole(u,n));return{rules:this.ale(t.rules,n),relation:t.relation,conditions:i}},e.prototype.ale=function(t,n){var r,e,u,r=this,e=[],u=(0,F.getTableNameByCellNode)(n);return t.forEach(function(t){var n,i,n,t,n,t,i=t.formula;t.column&&-1!==t.column.indexOf("[@")&&!t.column.startsWith("=")&&(t.column="="+t.column),(0,C.isNullOrUndefined)(i)?"Cell"!==t.value.type&&"DataColumn"!==t.value.type||"object"!=typeof t.value.data||(0,C.isNullOrUndefined)(t.value.data)?e.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):t.value.data.tableName?e.push({type:"Join",relationHostTable:null!=(n=t.tableName)?n:u,relationHostColumn:t.column,relationTargetTable:t.value.data.tableName,relationTargetColumn:t.value.data.columnName,relationCondition:t.operator}):t.value.data.formulaString&&e.push({type:"Join",relationHostTable:u,relationHostColumn:t.column,relationTargetTable:t.value.data.formulaTableName,relationTargetColumn:t.value.data.formulaString,relationCondition:t.operator}):(i.startsWith("=")||(i="="+i),(n=(i=(0,F.L3e)(r.N3.getCalcService(),r.k1e,i,r.o1e)).match(s))?(n=(t=n[1].split("."))[0],t=t[1],e.push({type:"Join",formula:i,relationHostTable:u,relationTargetTable:n,relationTargetColumn:t})):e.push({type:"Static",formula:i}))}),e},e.prototype.X1e=function(t){var s,c,s=this,c=this.N3;t.forEach(function(t){t.forEach(function(t){var n,i,r,e,u,o,n=t.currentNode,i=(0,F.getTableByCellNode)(c,n),r=t.relations&&(t.relations.rules.length||t.relations.conditions.length),e=n.leftParent&&n.upParent&&"V"===s.currentTreeDirection,u=(0,F.isCellInCrossCell)(n)&&"V"===s.currentTreeDirection;r?(o=s.generateRelationshipMapKeyByCellNode(n),s.V1e[o]&&0!==s.V1e[o].length&&!u||(s.V1e[o]=s.ule(t.relations,n))):e?(o=s.generateRelationshipMapKeyByCellNode(n),s.V1e[o]&&0!==s.V1e[o].length||(s.V1e[o]=s.jde(n))):i&&s.sle(i,n)})})},e.prototype.ule=function(t,n){var i,r,t,e,u,o,s,c,f,a,h,l,v,d,p,a,l,h,w,b,m,j,j,y,g,_,O,C,S,M,j,i=t.rules,r=t.relation,t=t.conditions;if((0,F.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection)return[];for(e=this.N3,u=[],o=[],s=0,c=i;s<c.length;s++)"Join"===(f=c[s]).type?(a=f.relationHostTable,h=f.relationHostColumn,l=f.relationTargetTable,v=f.relationTargetColumn,d=f.relationCondition,p=f.formula,a=e.getTable(a),l=e.getTable(l),a&&l&&(h=this.buildTableRelationshipMap(a,h,p||d,l,v),u.push({sourceTable:a,targetTable:l,sourceFieldIndexMap:h.sourceFieldIndexMap,targetFieldIndexMap:h.targetFieldIndexMap}))):o.push(f);if(b=!1,n.leftParent&&n.upParent&&"V"===this.currentTreeDirection?u.length?b=!0:w=this.jde(n):(m=(0,F.getTableByCellNode)(e,n))&&(j="H"===this.currentTreeDirection?n.upParent:n.leftParent,w=(j=this.V1e[j&&j.relationshipMapKey])&&j[0]&&j[0].hasOwnProperty(m.name.toUpperCase())?j:this.sle(m,n,!0)),u.length?("And"!==r&&void 0!==r||(u=this.fle(u)),y=this.lle(u,n,r,i.filter(function(t){return"Join"===t.type})),b&&(w=[].concat(y))):y=w,o.length&&(y=this.hle(y,o,n,r,!!u.length,w)),_=i.length?[y]:[],null!=t&&t.length)for(O=void 0,C=0,S=t;C<S.length;C++)M=S[C],O=this.ule(M,n),_.push(O);return"And"===r||void 0===r?(j=(0,F.getTableNameByCellNode)(n),g=this.dle(_,j)):"Or"===r&&(g=this.vle(_,n)),g},e.prototype.jde=function(t){var n,i,r,i,n,r;return(!t.leftParent||!t.upParent||"H"!==this.currentTreeDirection)&&(t.templateCell.dataColumn||!(0,C.isNullOrUndefined)(t.templateCell.formula)&&(0,F.isFormulaInWhitelist)(t.templateCell.formula))&&(n=this.getRelationshipsMap(),i=t.leftParent.relationshipMapKey,r=t.upParent.relationshipMapKey,i=n&&n[i]||[],n=n&&n[r]||[],i[0])&&n[0]?(r=(0,F.getTableNameByCellNode)(t),this.pve(i,n,r)):[]},e.prototype.pve=function(t,n,i){var r,e,u,u,o,s,e,c,r=Object.keys(t[0]),e=Object.keys(n[0]);return-1===r.indexOf(i)&&-1===e.indexOf(i)?(u=this.N3.getTable(i))?this.Uve(u):[]:(o=(u=r.length>e.length?t:n)===t?n:t,(c=1===(e=(s=r.length>e.length?r:e)===r?e:r).length&&-1<s.indexOf(e[0]))?this.dle([t,n],i):this.Ode(u,o,i))},e.prototype.Ode=function(r,o,t){var s,n,i,c,e,u,f,a,h,n,s=[],n=Object.keys(r[0]),i=Object.keys(o[0]),c=(0,F.getArraySameItems)(n,i);if(c.length)for(h in e=c[0],u={},f={},r.forEach(function(t,n){var t=t[e];u[t]||(u[t]=[]),u[t].push(n)}),o.forEach(function(t,n){var t=t[e];f[t]||(f[t]=[]),f[t].push(n)}),a=function(t){var n,i;u.hasOwnProperty(t)&&f[t]&&(n=u[t],i=f[t],n.forEach(function(t){var u=r[t];i.forEach(function(t){for(var n,i,r,e,t,t,n=o[t],i=!0,r=1;r<c.length;r++)if(e=c[r],u[e]!==n[e]){i=!1;break}i&&(t=Object.assign({},u),t=Object.assign(t,n),s.push(t))})}))},u)a(h);else(n=this.N3.getTable(t))&&(s=this.Uve(n));return s},e.prototype.hle=function(i,t,n,r,p,w){var e,u,b,m,j,y,o,s,c,f,a,h,l,v,d,g,_,O,e=n.templateCell.dataColumn.tableName.toUpperCase(),u=this.N3;if(i=[].concat(i),b=u.getTable(e),m=this.getTableNameCacheFromParent(n)||e,j=[],y=[],t.forEach(function(e){var u,t,o,n,s,c,f,a,h,l,n,v,d,u=e.field,t=e.operator,o=e.value,n=e.formula,s=e.valueType,f=!1,l=!1;(0,C.isNullOrUndefined)(t)?(0,C.isNullOrUndefined)(n)||(u=n,l=!0):"object"!=typeof o||Array.isArray(o)?c=S.ValueComparatorFactory.createComparator(t):(o instanceof Date||"Date"===s)&&(c=S.ValueComparatorFactory.createDateComparator(t),o=new Date(o),a=o.setHours(0,0,0,0),h=o.setHours(23,59,59,59),o=o.getTime(),f=!0),void 0!==u&&!b.hasField(u)&&-1<u.indexOf("@")&&!u.startsWith("=")&&(u="="+u),(c||l)&&(n=void 0,"And"===r||void 0===r?n=j[j.length-1]||i:"Or"===r&&(n=(n=y[y.length-1])||(p?w:i)),v=[],d=[],n.forEach(function(t){var n,i,r,n=!1,i=null==t?void 0:t[m];null!=i&&(r=null!=(r=b.getValueByField(u,i))?r:"",n=l?r:f?(r=new Date(r).getTime(),c(r,o,a,h)):("Formula"===s&&(o=b.getValueByField(e.value,i)),c(r,o))),(n?v:d).push(t)}),j.push(v),y.push(d))}),"And"===r||void 0===r)return j[j.length-1];if("Or"===r){for(o=[],s=0,c=j;s<c.length;s++)f=c[s],o=o.concat(f);if(p){for(a={},h=0,l=i;h<l.length;h++)d=(v=l[h])[e],(0,C.isNullOrUndefined)(d)||(a[d]=!0);for(g=0,_=o;g<_.length;g++)d=(O=_[g])[e],(0,C.isNullOrUndefined)(d)||a[d]||i.push(O);return i}return o}},e.prototype.fle=function(t){for(var n,i,r,e,u,o,s,n=[],i=[],r=[];t.length;){for(u=[e=t[0]],r=[0],o=1,s=t.length;o<s;o++)e.targetTable===t[o].targetTable&&(u.push(t[o]),r.push(o));for(n.push(e),1<u.length&&i.push(u),o=r.length-1;-1<o;o--)t.splice(r[o],1)}return this.mle(i),n},e.prototype.mle=function(t){for(var n,i,r,e,u,o,s,c,f,n=0,i=t;n<i.length;n++){for(u=(e=(r=i[n])[0]).sourceFieldIndexMap,o=e.targetFieldIndexMap,s=1,c=r.length;s<c;s++){for(f in u)u.hasOwnProperty(f)&&(u[f]=(0,F.getArraySameItems)(u[f],r[s].sourceFieldIndexMap[f]));for(f in o)o.hasOwnProperty(f)&&(o[f]=(0,F.getArraySameItems)(o[f],r[s].targetFieldIndexMap[f]))}e.sourceFieldIndexMap=u,e.targetFieldIndexMap=o}},e.prototype.buildTableRelationshipMap=function(i,t,r,e,u){var n,o,n,s,c,f,a,h,o,o,l,v,d,p,w,b,m,j,y,o,g,_,o,n=(0,C.isNullOrUndefined)(t)?t:i.getFieldByNameIgnoreCase(t),o=(0,C.isNullOrUndefined)(u)?u:e.getFieldByNameIgnoreCase(u);if(n&&(t=n.fieldName),o&&(u=o.fieldName),n=(0,F.toUpperCase)("".concat(i.name,"__").concat(t,"__").concat(r,"__").concat(e.name,"__").concat(u)),this.Z1e[n])return this.Z1e[n];function O(t,n,i){t[n]?t[n].push(i):t[n]=[i]}if(s=[],c=[],f=[],a=i.length(),h=e.length(),r.startsWith("=")){for(o="".concat(e.name,".").concat(u),o="\\[@".concat(o,"\\]"),l=new RegExp(o,"i"),v=function(t,n){var t=r.replace(l,'"'.concat(t,'"'));return i.getValueByField(t,n)},(d=e.hasField(u))||u.startsWith("=")||(u="="+u),p=0;p<h;p++)w=e.getValueByField(u,p),(0,C.isNullOrUndefined)(w)||O(f,w,p);for(b=Object.keys(f),m=function(n){var i=[];b.forEach(function(t){v(t,n)&&f[t].forEach(function(t){return i.push(t)})}),(s[n]=i).forEach(function(t){O(c,t,n)})},j=0;j<a;j++)m(j)}else{for(y=S.ValueComparatorFactory.createComparator(r),o=i.hasField(t),d=e.hasField(u),o||t.startsWith("=")||(t="="+t),d||u.startsWith("=")||(u="="+u),j=0;j<a;j++)w=i.getValueByField(t,j),(0,C.isNullOrUndefined)(w)||O(f,w,j);for(g=Object.keys(f),m=void 0,m="Equal"===r?function(n){var t,i,t,t=e.getValueByField(u,n);(0,C.isNullOrUndefined)(t)||(i=[],(t=f[t])&&t.forEach(function(t){return i.push(t)}),(c[n]=i).forEach(function(t){O(s,t,n)}))}:function(n){var i,r,i=e.getValueByField(u,n);(0,C.isNullOrUndefined)(i)||(r=[],g.forEach(function(t){y(t,i)&&f[t].forEach(function(t){return r.push(t)})}),(c[n]=r).forEach(function(t){O(s,t,n)}))},_=0;_<h;_++)m(_)}return o={sourceTable:i,targetTable:e,sourceFieldIndexMap:s,targetFieldIndexMap:c},this.Z1e[n]=o},e.prototype.lle=function(t,n,x,i){var A,D,P,r,k,e,u,o,o,u,s,c,f,a,h,e,l,f,a,h,L,V,v,d,p,w,b,m,j,a,o,y,g,_,A=this,D=[],P=n.upParent&&n.leftParent,r=n.upParent||n.leftParent,k="";if(r&&(k=this.generateRelationshipMapKeyByCellNode(r),P))if(u=n.upParent,o=n.leftParent,o=this.generateRelationshipMapKeyByCellNode(o),u=this.generateRelationshipMapKeyByCellNode(u),s=this.V1e[o],c=this.V1e[u],s&&c&&s[0]&&c[0])f=Object.keys(s[0]),a=Object.keys(c[0]),h=f.length,e=a.length,l=[],t.forEach(function(t){var n=t.sourceTable.name.toUpperCase(),t=t.targetTable.name.toUpperCase();-1===l.indexOf(n)&&l.push(n),-1===l.indexOf(t)&&l.push(t)}),f=(0,F.getArraySameItems)(f,l).length,a=(0,F.getArraySameItems)(a,l).length,k=(h=h<e&&f||0===a)?o:u,e=(k=h&&0===f?void 0:k)===u?s:c;else{if(c&&c[0])return[];r=n.leftParent,k=this.generateRelationshipMapKeyByCellNode(r)}for(L=[],V=[],v=function(t,n){var i,r,e,u,o,s,e,c,f,a,h,l,v,d,p,w,b,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,i=t.sourceTable,r=t.sourceFieldIndexMap,e=t.targetTable,u=t.targetFieldIndexMap,o=i.name.toUpperCase(),s=e.name.toUpperCase();if(D=V[V.length-1]||D,r&&u){if(e=A.V1e[k],k&&e||V.length){if(D=(c=D).length&&"And"===x?D:e,f=s,a=u,h=o,D[0]&&!D[0].hasOwnProperty(f)&&(a=r,h=s,!D[0].hasOwnProperty(f=o)))return D=c,n||L.push(t),!1;for(v=[],d=0,p=(l=[].concat(D)).length;d<p;d++)v[w=l[d][f]]||(v[w]=[]),v[w].push(d);if(b=[],h=h.toUpperCase(),m=a.length,j=A.hTe(l,f,h,a)){for(y=0;y<m;y++)if(void 0!==(g=a[y])&&void 0!==(_=v[y]))if(C=O=0,S=g.length)for(M=0;M<S;M++)for(O=g[M],F=0,N=_.length;F<N;F++)C=_[F],(T=Object.assign({},l[C])).hasOwnProperty(h)||(T[h]=O),b.push(T);else for(F=0,N=_.length;F<N;F++)C=_[F],(T=Object.assign({},l[C])).hasOwnProperty(h)||(T[h]=void 0),b.push(T);D=b}}else{if(k&&!e&&P)return!0;for(D=[],R=i.length(),I=function(i){var t,t,t=r[i];t?t.forEach(function(t){var n;D.push(((n={})[o]=i,n[s]=t,n))}):D.push(((t={})[o]=i,t[s]=void 0,t))},E=0;E<R;E++)I(E)}V.push(D)}},d=0,p=t;d<p.length&&!v(w=p[d]);d++);for(b=0,m=L;b<m.length&&!v(j=m[b],!0);b++);return"And"===x||void 0===x?D=this.gle(V[V.length-1],i,n,"And"):"Or"===x&&(D=this.gle(this.vle(V,n),i,n,"Or")),P&&D&&e&&D[0]&&e[0]&&(a=Object.keys(D[0]),o=Object.keys(e[0]),y=(0,F.getArraySameItems)(a,o),g=[],D.forEach(function(n,t){for(var i,r,e,u,o,i=y.map(function(t){return n[t]}),r=g,e=0,u=i;e<u.length;e++)r[o=u[e]]||(r[o]=[]),r=r[o];r.push(t),y.forEach(function(t){delete n[t]})}),_=[],e.forEach(function(e){for(var t,n,i,r,u,t=y.map(function(t){return e[t]}),n=g,i=0,r=t;i<r.length;i++)u=r[i],n=n&&n[u];n&&n.forEach(function(t){var n,i,r,n=D[t],i=Object.assign({},e);for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);_.push(i)})}),D=_,"And"===x||void 0===x?D=this.gle(_,i,n,"And"):"Or"===x&&(D=this.gle(_,i,n,"Or"))),D},e.prototype.hTe=function(t,n,i,r){for(var e,u,o,s,c,f,a,h,l,v,e={},u=0,o=t;u<o.length;u++)c=(s=o[u])[n],f=s[i],void 0!==c&&void 0!==f&&(e[c]||(e[c]={}),e[c][f]=!0);for(c in r)if(r.hasOwnProperty(c))for(a=r[c],h=e[c],l=0,v=a;l<v.length;l++)if(f=v[l],void 0===h||!h[f])return!0;return!1},e.prototype.gle=function(t,n,i,r){var a,h,e,a=this;return t&&(h=this.getTableNameCacheFromParent(i),e=n.map(function(t){var r,e,n,i,u,t,o,s,c,f,r=t.relationHostColumn,e=t.relationTargetColumn,n=t.relationCondition,i=t.relationHostTable,u=t.relationTargetTable,t=t.formula;return(0,C.isNullOrUndefined)(t)?(o=S.ValueComparatorFactory.createComparator(n),i=i.toUpperCase(),u=u.toUpperCase(),s=a.N3.getTable(i),c=a.N3.getTable(u),f=(h||i).toUpperCase(),function(t){var n=t[f],i=t[u];return!!(void 0===n&&t.hasOwnProperty(f)||void 0===i&&t.hasOwnProperty(u))||o(s.getValueByField(r,n),c.getValueByField(e,i))}):null}),"And"===r?t=t.filter(function(t){for(var n,i,r,n=0,i=e;n<i.length;n++)if((r=i[n])&&!r(t))return!1;return!0}):"Or"===r&&(t=t.filter(function(t){for(var n,i,r,n=0,i=e;n<i.length;n++)if(!(r=i[n])||r(t))return!0;return!1}))),t},e.prototype.dle=function(r,e){var t,u,n,i,o,s,c,f,a,h,l,v,d,p;if(r.some(function(t){return t&&0===t.length}))return[];if(r.length<=1)return r[0]||[];if(void 0===e)return[];for(r.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),t=r[0],u=[],e=this.Ede(r,e),n=function(t,n){var i={};r[t].forEach(function(t){var t=t[e];void 0!==t&&(i[t]=!0)}),u.push(i)},i=0,o=r.length;i<o;i++)n(i,o);for(s=u[0],i=1,o=u.length;i<o;i++)for(f in c=u[i],s)s.hasOwnProperty(f)&&s[f]&&(c[f]||(s[f]=!1));for(a=[],h=new RegExp("^".concat(e,"(__\\d+__\\d+)?$")),l=function(n){var t=Object.keys(n),i=!0;t.forEach(function(t){var t;h.test(t)&&(t=n[t],i=i&&!(0,C.isNullOrUndefined)(t)&&s[t])}),i&&a.push(n)},v=0,d=t;v<d.length;v++)l(p=d[v]);return a},e.prototype.vle=function(t,n){var i,r,e,u,o,s,c,f,a,h;if((t=t.filter(function(t){return t.length})).length<=1)return t[0]||[];if(void 0===(i=(0,F.getTableNameByCellNode)(n)))return[];for(t.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),r=t[0],e={},u=0,o=r;u<o.length;u++)c=(s=o[u])[i],(0,C.isNullOrUndefined)(c)||(e[c]=!0);for(f=1,a=t.length;f<a;f++)(h=t[f]).forEach(function(t){var n=t[i];(0,C.isNullOrUndefined)(n)||e[n]||(e[n]=!0,r.push(t))});return r},e.prototype.Ede=function(t,n){var t,t,t=t.map(function(t){return Object.keys(t[0])}),t=t.reduce(function(t,n){return(0,F.getArraySameItems)(t,n)},t[0]);return-1<t.indexOf(n)?n:t[0]},e.prototype.sle=function(t,n,i){var r=this.generateRelationshipMapKeyByCellNode(n);return(0,F.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection?[]:(this.V1e[r]&&!i||(this.V1e[r]=this.Uve(t)),this.V1e[r])},e.prototype.Uve=function(t){for(var n,i,r,e,u,n=[],i=t.name.toUpperCase(),r=0,e=t.length();r<e;r++)(u={})[i]=r,n.push(u);return n},e.prototype.ele=function(t){return!!t&&(this.$1e(t),!!t.templateCell.R1e||this.ele(t.leftParent)||this.ele(t.upParent))},e.prototype.$1e=function(t){var n,i,t,r,i,t,n=t.templateCell,i=n.filter&&n.filter.condition;n.R1e||(t=this.V_e(t),i&&t.push(i),t.length&&(i=(0,F.deepCloneFilterCondition)(r={and:t}),t=this.parseFilterOptionToFilterConditionTree(i),n.R1e={condition:t}))},e.prototype.V_e=function(t){var n,i,r,e,i,u,o,s,c,f,a,n,h,r=[],e=[],i=this.N3,u=(0,F.getTableByCellNode)(i,t),o=null==u?void 0:u.table();return t.leftParent&&(c=null==(s=(0,F.getTableByCellNode)(i,t.leftParent))?void 0:s.table())!==o&&(f=this.getRelationshipGraphTableIndex(u),a=this.getRelationshipGraphTableIndex(s),n=null==(n=this.relationshipGraphs()[a])?void 0:n.tableToTableRelationPath,f===a)&&n&&(h=n[o.name.toUpperCase()][c.name.toUpperCase()])&&h.forEach(function(t){var n;-1===e.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},r.push(n),e.push(t))}),t.upParent&&(c=null==(s=(0,F.getTableByCellNode)(i,t.upParent))?void 0:s.table())!==o&&(f=this.getRelationshipGraphTableIndex(u),a=this.getRelationshipGraphTableIndex(s),n=null==(i=this.relationshipGraphs()[a])?void 0:i.tableToTableRelationPath,f===a)&&n&&(h=n[o.name.toUpperCase()][c.name.toUpperCase()])&&h.forEach(function(t){var n;-1===e.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},r.push(n),e.push(t))}),r},n.DataManagerReportJoinHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js":function(t,n,i){"use strict";var r,l,v,c,d,e;function u(t){this.N3=t,this.k1e=new r.CalcSource(t.getCalcService())}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportSortHelper=void 0,r=i("CalcEngine"),l=i("./dist/src/dataManager.entry.js"),v=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),c=void 0,d="number",u.prototype.sortGroupsBySortCondition=function(f,a,h){var n,s,i,t,r,n=a.templateCell.x1e,s=[];if(n){for(n.forEach(function(t,n){var i,r,e,u,o,s,c,o;if(!(0,l.isNullOrUndefined)(t.cell)&&v.cellNameReg.test(t.cell)&&(i=h(t.cell)))if((r=(0,v.T2e)(i,a))||i===a)for(e=0,u=f;e<u.length;e++)s=(s=(o=u[e]).sortValues)||(o.sortValues=[]),c=void 0,i===a?c=o.value:(o=(0,v.A2e)(o,i))&&(c=o[0].value),s[n]=c;else t.order=void 0}),t=function(o){var r,t,u,r=n[o];r&&r.order&&(r.list&&r.list.length?(t=r.list,u={},t.forEach(function(t,n){return u[t]=n}),i=function(t,n){var e,i,t,e=!1,i,t=function(t,n){var i,r,t,n,i=t.sortValues[o],r=n.sortValues[o];return s[o+1]&&i===r?(e=!0,s[o+1](t,n)):(t=u[i+""],n=u[r+""],t!==c&&n!==c?t-n:t!==c?-1:n!==c?1:i===r?0:r<i?1:-1)}(t,n);return!e&&"desc"===r.order?-t:t},s[o]=i):(0,l.isNullOrUndefined)(r.cell)&&(0,l.isNullOrUndefined)(r.column)&&(0,l.isNullOrUndefined)(r.formula)||(i=function(t,n){var e,u,i,t,e=!1,u="desc"===r.order,i,t=function(t,n){var i,r,t,n,i=t.sortValues[o],r=n.sortValues[o];return s[o+1]&&i===r?(e=!0,s[o+1](t,n)):(t=(0,l.isNullOrUndefined)(i)||""===i||typeof i==d&&isNaN(i),n=(0,l.isNullOrUndefined)(r)||""===r||typeof r==d&&isNaN(r),t||n?t&&n?0:t&&!n?u?-1:1:!t&&n?u?1:-1:void 0:i===r?0:(0,v.isGreaterThan)(r,i)?-1:1)}(t,n);return!e&&u?-t:t},s[o]=i))},r=n.length-1;-1<r;r--)t(r);i&&(f.sort(i),this.Tye(f,a))}},u.parseSortOptionsToSorts=function(t){var n;null!=(n=t.sorts)&&n.length&&!t.x1e&&(t.x1e=t.sorts.map(function(t){var n,i,n,t,n=(0,l.isNullOrUndefined)(t.desc),i=n?t.asc:t.desc,n={order:n?"asc":"desc",list:t.list};return(i=(i=(0,l.isNullOrUndefined)(i)?"":i).trim()).startsWith("=")?(t=i.substring(1),v.cellNameReg.test(t)?n.cell=t:n.formula=i):n.column=i,n}))},u.prototype.Tye=function(r,e){var u=this;e.children.forEach(function(t){var n,n,i,n=null==(n=t.data)?void 0:n.groups;null!=n&&n.length&&(i=t.leftParent===e,n.sort(function(t,n){var t,n,t=i?t.leftParent:t.upParent,n=i?n.leftParent:n.upParent;return r.indexOf(t)-r.indexOf(n)})),u.Tye(n,t)})},n.DataManagerReportSortHelper=u},"./dist/src/data-manager-report/tree-data-generator/index.js":function(t,n,i){"use strict";var r,e,u,o,s,f,c;function a(t,n){var i=this;this.generateTreeDataInternal=function(t){var t,n,t=t.root;try{i.d1e.generateJoinRelationIndexMap(t),n=i.v1e.generateCellNodeTreeData(t)}catch(t){n=[]}finally{t.data.groups=n}},this.ble=new s.DataManagerProxy(t),this.DJ=n,this.d1e=new e.DataManagerReportJoinHelper(this.ble,n),this.m1e=new u.DataManagerReportSortHelper(this.ble),this.v1e=new o.DataManagerReportGroupHelper(this.ble,n,this.d1e,this.m1e),this.yle=new r.DataManagerReportCrossHelper(this.ble,n,this.d1e,this.v1e,this.m1e)}function h(t,n){var i,i;t.templateCell.dataColumn&&void 0!==t.templateCell.dataColumn.tableName&&(n[t.templateCell.dataColumn.tableName.toUpperCase()]=!0),(i=t.templateCell.filter)&&i.condition&&l(i.condition,n),null!=(i=t.children)&&i.forEach(function(t){h(t,n)})}function l(t,n){var i,r,e,u,o,s;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(i=0,r=t.and;i<r.length;i++)l(e=r[i],n);if(t.or)for(u=0,o=t.or;u<o.length;u++)l(s=o[u],n)}}function v(t,n){n=n.toUpperCase();for(var i=0;i<t.length;i++)if(t[i].tables.find(function(t){return t.name.toUpperCase()===n}))return i;return-1}function d(t){var n,r,o,i,e,u,s,c,n=t.tables,r=t.relationships;if(n.length&&r.length){for(i in o={},n.forEach(function(t){var i,e,u,n,i=t.table(),e=i.name.toUpperCase();o[e]||(o[e]={}),u=o[e],(n=r.filter(function(t){return t.targetTable===i||t.sourceTable===i}).map(function(t){var n=t.sourceTable===i?t.targetTable:t.sourceTable;return{table:n,relationship:t,tableName:n.name.toUpperCase()}})).forEach(function(t){var n,i,r;if(t.tableName!==e){for(n in o)o.hasOwnProperty(n)&&n!==e&&n!==t.tableName&&(i=o[n])[e]&&((r=[].concat(i[e])).push(t.relationship),!i[t.tableName]||i[t.tableName].length>r.length)&&(i[t.tableName]=r);u[t.tableName]||(u[t.tableName]=[t.relationship])}})}),o)if(o.hasOwnProperty(i))for(u in e=o[i])if(e.hasOwnProperty(u)&&o[u])for(s in o[u])o[u].hasOwnProperty(s)&&s!==i&&(c=e[u].concat(o[u][s]),!o[i][s]||o[i][s].length>c.length)&&(o[i][s]=c);Object.values(o).forEach(function(t){Object.values(t).forEach(function(t){t.reverse()})}),t.tableToTableRelationPath=o}}Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0,r=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js"),e=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),s=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),f=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),a.prototype.generateTreeData=function(){var t,n,i,t,t,t=this.DJ,n=t.crossCells,i=t.verticalExpansionTrees,t=t.horizontalExpansionTrees;this.wle();try{this.z_e()}catch(t){}this.d1e.currentTreeDirection="H",t.forEach(this.generateTreeDataInternal),this.d1e.currentTreeDirection="V",i.forEach(this.generateTreeDataInternal),(t=n.filter(function(t){return!n.includes(t.leftParent)&&!n.includes(t.upParent)})).length&&this.yle&&this.yle.processCrossCells(t),this.d1e.clearCache(!0),this.v1e.clearCache(!0),this.ble.clearTableDataCache(),this.Y5e()},a.prototype.wle=function(){this.d1e.clearCache(),this.v1e.clearCache()},a.prototype.getUsedTableRelationshipGraphsForUT=function(){return this.z_e(),this.d1e.relationshipGraphs()},a.prototype.z_e=function(){for(var t,s,c,n,i,t,t=this.ble,s=[].concat(t.getRelationshipsByTable()),c=[],n=this.yve(),i=function(){var t,n,i,r,e,n,i,r,e,u,o,n,t=s.shift(),n=t.sourceTable,i=t.targetTable,r=n.name.toUpperCase(),e=i.name.toUpperCase(),n=new f.ReportTable({dataManagerTable:n}),i=new f.ReportTable({dataManagerTable:i}),r=v(c,r),e=v(c,e);-1===r&&-1===e?c.push(u={relationships:[t],tables:[n,i]}):-1===r&&-1!==e?(c[e].relationships.push(t),c[e].tables.push(n)):-1!==r&&-1===e?(c[r].relationships.push(t),c[r].tables.push(i)):(r===e&&-1===c[r].relationships.indexOf(t)?c[r]:(o=c[e],(n=c.splice(r,1))[0].relationships.forEach(function(t){o.relationships.push(t)}),n[0].tables.forEach(function(t){o.tables.push(t)}),o)).relationships.push(t)};s.length;)i();(t=c.filter(function(t){return t.tables.map(function(t){return t.name.toUpperCase()}).some(function(t){return n[t]})})).forEach(function(t){d(t)}),this.d1e.relationshipGraphs(t)},a.prototype.yve=function(){var t,n,n={};return this.DJ&&(this.DJ.horizontalExpansionTrees.forEach(function(t){h(t.root,n)}),this.DJ.verticalExpansionTrees.forEach(function(t){h(t.root,n)}),null!=(t=this.DJ.crossCells))&&t.forEach(function(t){h(t,n)}),n},a.prototype.Y5e=function(){var n,t,i,r,t,n=this,t=this.DJ,i=t.verticalExpansionTrees,r=t.horizontalExpansionTrees,t=t.crossCells;r.forEach(function(t){n.Z5e(t.root)}),i.forEach(function(t){n.Z5e(t.root)}),t&&t.forEach(function(t){n.Z5e(t)})},a.prototype.Z5e=function(t){var n,i,n=this;t&&(t.nM=void 0,(i=t.templateCell)&&(i.R1e=void 0,i.x1e=void 0,i.w1e=void 0),t.children.forEach(function(t){n.Z5e(t)}))},n.TreeDataGenerator=a},"./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/src/data-manager-report/tree-data-generator/utils/utils.js":function(P,t,n){"use strict";var e,u,n,o,s,c,f,a,h,i;function l(t,n,i){var r=e(e([],i=void 0===i?[]:i,!0),[t],!1);0<t.children.length?t.children.forEach(function(t){l(t,n,r)}):n.push(r)}function r(t,n){var i,n,r,i=0;switch(n){case"Avg":i=!t.length||c(t[0])?0:t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)/t.length;break;case"Count":i=t.length;break;case"Max":i=void 0,t.length&&(t.sort(function(t,n){return t<n?1:-1}),i=t[0]);break;case"Min":i=void 0,t.length&&(t.sort(function(t,n){return n<t?1:-1}),i=t[0]);break;case"None":i=0;break;case"Sum":i=c(t[0])?0:t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)}return n=15,"number"==typeof i&&-10<i&&i<10&&(1<(r=i.toString()).indexOf("000000000000")||1<r.indexOf("999999999999"))&&(n=14),o(i,u.Functions.CALC_PRECISION||n)}function v(t,n){return t&&t.length&&n&&n.length?t.filter(function(t){return-1<n.indexOf(t)}):[]}function d(t,n){var i;return t&&0!==t.length?n&&0!==n.length?(i=[].concat(t),n.forEach(function(t){-1===i.indexOf(t)&&i.push(t)}),i):t:n||[]}function p(t){return t.toUpperCase()}function w(t){return!(!(t=t.replace(/__\d+__\d+/g,"").slice(t.indexOf("=")+1,t.length).trim()).startsWith("{")||!t.endsWith("}"))}function b(t,n,i){var n,t,r,i,e,u,o,s,c,f,t=t.parse(n,i,0,0),r=[],i=null==(n=null==t?void 0:t.value)?void 0:n.array;if(i)for(e=0,u=i;e<u.length;e++)for(s=0,c=o=u[e];s<c.length;s++)f=c[s],r.push(f);return r}function m(t,n){var i=n.nM;return i||(n.templateCell.dataColumn?i=t.getTable(n.templateCell.dataColumn.tableName):n.templateCell.formula&&w(n.templateCell.formula)&&(i=t.getTable("".concat(n.templateCell.formula,"__").concat(n.templateCell.row,"__").concat(n.templateCell.col))),n.nM=i),i}function j(t,n){var i="";return t.templateCell.dataColumn?i=t.templateCell.dataColumn.tableName:t.templateCell.formula&&(n||w(t.templateCell.formula))&&(i="".concat(t.templateCell.formula,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col)),i.toUpperCase()}function y(t){var t=t.match(i);return t&&t[1]}function g(t){return t&&t.and}function _(t){return t&&t.or}function O(t){return t&&!t.or&&!t.and}function C(t){var n;switch(typeof t){case"string":return"String";case"boolean":return"Boolean";case"number":return"Number"}if(isNaN(t)&&!isNaN(Date.parse(t)))return"Date"}function S(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return i+(t+1)}function M(t){var n,i,n=Array.isArray(t)?[]:{};for(i in t)t.hasOwnProperty(i)&&(n[i]="and"===i||"or"===i?M(t[i]):t[i]);return n}function F(t){return!!t&&(!(!t.leftParent||!t.upParent)||F(t.leftParent||t.upParent))}function N(t,n){return!(!t||!n)&&(t===n||N(t.leftParent,n)||N(t.upParent,n))}function T(t,n){var i,r,e,u;if(t&&t.childrenArray&&t.childrenArray.length&&n)for(i=void 0,r=0,e=t.childrenArray;r<e.length;r++)if(i=(u=e[r])&&u[0]&&u[0].cellNode===n?u:T(u[0],n))return i}function R(t,n){var i,r,e,u,o;return t instanceof Date&&(t=s(t)),n instanceof Date&&(n=s(n)),e=(i=typeof t)===f,u=(r=typeof n)===f,o=r===a,i==r||i!==a&&!o?i===h&&u||(!e||r!==h)&&(e&&u?t.toLowerCase()>n.toLowerCase():n<t):o}function I(t,n,i,r){var r;return r&&(E(r,r=x(t,n,i)),void 0===(i=A(t,n,r))||i.startsWith("=")||(i="="+i)),i}function E(t,n){var i,r,e,u,o;if(8===n.type)void 0!==(i=t[n.value.toUpperCase()])&&("string"==(r=typeof i)?n.type=3:"boolean"==r?n.type=4:"number"==r?n.type=2:i instanceof Date&&(i=i.toString(),n.type=3),n.value=i);else{if(n.arguments)for(e=0,u=n.arguments;e<u.length;e++)E(t,o=u[e]);n.value&&E(t,n.value),n.value2&&E(t,n.value2)}}function x(t,n,i){return t.parse(n,i,0,0)}function A(t,n,i){return t.unparse(n,i,0,0)}function D(t){var t=t.newRecordDefaultValueGenerator?t.newRecordDefaultValueGenerator():void 0,n;return n=t&&void 0!==t.formula?t.formula:n}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.generateDefaultFormulaByTemplateCell=t.expressionToFormula=t.formulaToExpression=t.ptr=t.L3e=t.isGreaterThan=t.A2e=t.T2e=t.isCellInCrossCell=t.deepCloneFilterCondition=t.rowColToCellName=t.getValueType=t.isSimpleFilterCondition=t.hasOrCondition=t.hasAndCondition=t.fieldExpressionToField=t.getTableNameByCellNode=t.getTableByCellNode=t.getFormulaResult=t.isFormulaInWhitelist=t.toUpperCase=t.getArrayUnionItems=t.getArraySameItems=t.calc=t.traverse=t.cellNameReg=t.formulaWhitelist=void 0,u=n("CalcEngine"),n=n("Common"),o=n.Common.st.E8,s=n.Common.ct.o0,c=n.Common.ct.W0,f="string",a="number",h="boolean",t.formulaWhitelist=[],t.cellNameReg=/^([A-Z]+)(\d+)$/,t.traverse=l,t.calc=r,t.getArraySameItems=v,t.getArrayUnionItems=d,t.toUpperCase=p,t.isFormulaInWhitelist=w,t.getFormulaResult=b,t.getTableByCellNode=m,t.getTableNameByCellNode=j,i=/\[@(.*?)\]/,t.fieldExpressionToField=y,t.hasAndCondition=g,t.hasOrCondition=_,t.isSimpleFilterCondition=O,t.getValueType=C,t.rowColToCellName=S,t.deepCloneFilterCondition=M,t.isCellInCrossCell=F,t.T2e=N,t.A2e=T,t.isGreaterThan=R,t.L3e=I,t.ptr=E,t.formulaToExpression=x,t.expressionToFormula=A,t.generateDefaultFormulaByTemplateCell=D},"./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js":function(t,n){"use strict";var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ValueComparatorFactory=void 0,r.createComparator=function(t){switch(t){case"Equal":return function(t,n){return t+""==n+""};case"NotEqual":return function(t,n){return t+""!=n+""};case"GreaterThanOrEqual":return function(t,n){var t=r.parseValue(t,n);return t.recordValue>=t.ruleValue};case"GreaterThan":return function(t,n){var t=r.parseValue(t,n);return t.recordValue>t.ruleValue};case"LessThanOrEqual":return function(t,n){var t=r.parseValue(t,n);return t.recordValue<=t.ruleValue};case"LessThan":return function(t,n){var t=r.parseValue(t,n);return t.recordValue<t.ruleValue};case"StartWith":return function(t,n){return(t+"").startsWith(n+"")};case"NotStartWith":return function(t,n){return!(t+"").startsWith(n+"")};case"EndWith":return function(t,n){return(t+"").endsWith(n+"")};case"NotEndWith":return function(t,n){return!(t+"").endsWith(n+"")};case"Contains":return function(t,n){return-1<(t+"").indexOf(n+"")};case"NotContains":return function(t,n){return-1===(t+"").indexOf(n+"")};case"In":return function(t,n){return-1<(n+"").indexOf(t+"")};case"NotIn":return function(t,n){return-1===(n+"").indexOf(t+"")};default:return function(){return!0}}},r.parseValue=function(t,n){return"number"==typeof t?isNaN(n)?{recordValue:t+"",ruleValue:n+""}:{recordValue:t,ruleValue:+n}:isNaN(t)?{recordValue:t+"",ruleValue:n+""}:"number"==typeof n?{recordValue:+t,ruleValue:n}:{recordValue:t,ruleValue:n}},r.createDateComparator=function(t){switch(t){case"Equal":case"Contains":case"In":return function(t,n,i,r){return i<=t&&t<=r};case"NotEqual":case"NotContains":case"NotIn":return function(t,n,i,r){return r<t||t<i};case"GreaterThanOrEqual":case"StartWith":case"NotEndWith":return function(t,n,i,r){return i<=t};case"GreaterThan":return function(t,n,i,r){return r<t};case"LessThanOrEqual":case"NotStartWith":case"EndWith":return function(t,n,i,r){return t<=r};case"LessThan":return function(t,n,i,r){return t<i};default:return function(){return!0}}},n.ValueComparatorFactory=r},"./dist/src/dataManager.common.js":function(t,i,n){"use strict";var r,e,u,n,n,o,s,c;function f(){return null!==c&&c.apply(this,arguments)||this}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(i,"__esModule",{value:!0}),i.CalcFunction=i.sR=i.SR=void 0,e=n("CalcEngine"),u=n("Common"),n=n("./dist/src/res.en.js"),i.SR={en:n.resource},n=new u.Common.ResourceManager(i.SR,"DataManager"),i.sR=n.getResource.bind(n),c=e.Functions.Function,r(f,c),f.prototype.description=function(){var t=this,n=(0,i.sR)().Zve;return t.IDt||(n?n[t.name]:c.prototype.description.call(this))},i.CalcFunction=f},"./dist/src/dataManager.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/src/polyfills/from-entries.js"),e(i("./dist/src/dataSource/dataSource.entry.js"),n),e(i("./dist/src/table/table.entry.js"),n),e(i("./dist/src/viewField/viewField.entry.js"),n),e(i("./dist/src/view/view.entry.js"),n),e(i("./dist/src/interfaces/interface.js"),n),e(i("./dist/src/interfaces/styleOptions.js"),n),e(i("./dist/src/interfaces/validatorOptions.js"),n),e(i("./dist/src/interfaces/conditionalFormatOptions.js"),n),e(i("./dist/src/dataManager.js"),n),e(i("./dist/src/dataManager.common.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js"),n),e(i("./dist/src/data-manager-report/data-manager-report.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/index.js"),n),e(i("./dist/src/query.js"),n)},"./dist/src/dataManager.js":function(t,n,i){"use strict";var r,e,u,y,o,s,c,f,a,h,l,v,d,p,w;function g(t){var t=t.split(/\s*=\s*/);return 2===t.length?[t[0].split("."),t[1].split(".")]:[]}function b(t,n){this.rV={},this.tables={},this.relationships=[],this.OEt={},this.lUr=new l.EventManager,n=n||new r.CalcService,this.updateCalcService(n),(0,s.addCustomFunctions)(),t&&this.r3e(t),this.U0r=new h.QueryHelper(this)}function m(t){return t instanceof u.View}Object.defineProperty(n,"__esModule",{value:!0}),n.isView=n.DataManager=void 0,r=i("CalcEngine"),e=i("./dist/src/table/table.js"),u=i("./dist/src/view/view.js"),y=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/dataSource/dataSource.js"),s=i("./dist/src/calculation/functions/functions.entry.js"),c=i("./dist/src/calculation/tokenResolver.js"),f=i("./dist/src/calculation/queryFunctionResolver.js"),a=i("./dist/src/relationship.js"),h=i("./dist/src/query/query-helper.js"),l=i("./dist/src/dataSource/event.js"),v=i("./dist/src/table/tableEvents.js"),d=null,p=r.Convert.LE,b.prototype.r3e=function(t){for(var n,i,r,e,u,o,s,c,f,a,h,h,l,v,d,p,w,b,m,j,n,i=0,r=(0,y.getObjectKeys)(t.tables);i<r.length;i++){if(e=r[i],o={},s=(u=t.tables[e]).fields)for(c in s)s.hasOwnProperty(c)&&(f=s[c],o[c]={name:f.name,dataType:f.dataType,spread:f.spread});if(a={schema:{columns:o}},(h=u.dimensions)&&(a.schema.dimensions=h),u.measures&&0<Object.keys(u.measures).length&&(a.schema.measures=(0,y.clone)(u.measures,!0)),u.source)a.remote={read:{url:u.source}};else{if(!u.localSource)continue;a.data=u.localSource}if(h=this.addTable(e,a),u.primaryKey&&h.primaryKey(u.primaryKey),l=u.relationships)for(v in l)if(l.hasOwnProperty(v)){if(m=b=w=p=void 0,(d=l[v]).on){if(0===(j=g(d.on)).length)continue;p=j[0][0],b=j[0][1],w=j[1][0],m=j[1][1]}else{if(!(d.with&&d.source&&u.primaryKey))continue;p=e,b=u.primaryKey,w=d.source,m=d.with}this.addRelationship(this.tables[p],b,v,this.tables[w],m,w+"_"+m)}}this.queries=t.queries},b.prototype.addTable=function(t,n){this.Kur(t);var n=new e.Table(t,n);return(this.tables[t]=n).REt(this),this.ki(v.Events.TableAdded,{name:t}),n},b.prototype.removeTable=function(t){for(var n,i,r,n=this.tables[t],i=this.relationships,r=i.length-1;0<=r;r--)i[r].sourceTable!==n&&i[r].targetTable!==n||(i[r].VP(),i.splice(r,1));n.REt(d),delete this.tables[t],this.Kur(t)},b.prototype.addRelationship=function(t,n,i,r,e,u){var t=new a.Relationship(t,n,i,r,e,u);return this.relationships.push(t),t},b.prototype.removeRelationship=function(t){for(var n,i,n=this.relationships,i=0;i<n.length;i++)if(n[i].sourceRelationshipName===t){n[i].VP(),n.splice(i,1);break}},b.prototype.updateCalcService=function(t){for(var n,i,r,e,u,n,i=!0,r=0,e=t.getResolvers();r<e.length;r++)if((u=e[r])instanceof c.DataManagerTokenResolver){i=!1;break}i&&t.addResolver(new c.DataManagerTokenResolver(8e3)),this.Lp=t},b.prototype.xEt=function(t,n,i){var r,e,u;return p(t)?t=t.getValueByIndex(0):(0,y.isString)(t)||(t=""+t),(0,y.isString)(n)?n=[n]:p(n)?n=n.toArray(0,!0):n&&n.array&&(n=n.array[0]),r=1<(null==n?void 0:n.length)?n.join(","):null==n?void 0:n[0],u=(u=(e=(e=this.OEt[t])||(this.OEt[t]={}))[r])||(e[r]=f.QueryFunctionSolver.parseParam(t,n,i,this))},b.prototype.IEt=function(t,n,i,r,e,u){var t,n,t=this.xEt(t,n,i);return e?t.table._dataSource.unbind(o.ONCHANGE,r):r&&t.table&&t.table._dataSource.bind(o.ONCHANGE,r),u&&(t.Mgr=void 0),n=0===(n=t.getValue?t.getValue(t.table):[[]]).length?[[]]:n},b.prototype.Kur=function(t){var n=this.OEt;n&&delete n[t]},b.prototype.D3=function(t,n){this.lUr.bind(t,n)},b.prototype._3=function(t,n){this.lUr.unbind(t,n)},b.prototype.ki=function(t,n){return this.lUr.trigger(t,n)},b.prototype.toJSON=function(t){var n,i,r,e,n=this.tables,i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r].toJSON(t));return{tables:i,relationships:e=this.relationships.map(function(t){return{sourceTableName:t.sourceTable.name,sourceFieldName:t.sourceFieldName,sourceRelationshipName:t.sourceRelationshipName,targetTableName:t.targetTable.name,targetFieldName:t.targetFieldName,targetRelationshipName:t.targetRelationshipName}}),queries:this.queries}},b.prototype.fromJSON=function(t){var u,n,i,i,r,e,o,s,c,f,u=this,n=this.tables={},i=t.tables,i=Promise.all(i.map(function(t){var n,i,r,e,n,n=t.dataSourceOption.schema,i=n&&n.columns;if(i)for(r in i)i.hasOwnProperty(r)&&(e=i[r])&&"date"===e.dataType&&Array.isArray(e.lookup)&&(e.lookup=e.lookup.map(function(t){return new Date(t)}));return(n=u.addTable(t.name,t.dataSourceOption)).BEt=!0,n.fromJSON(t)}));for(this.relationships=[],e=0,o=r=t.relationships;e<o.length;e++)c=n[(s=o[e]).sourceTableName],f=n[s.targetTableName],this.addRelationship(c,s.sourceFieldName,s.sourceRelationshipName,f,s.targetFieldName,s.targetRelationshipName);return t.queries&&(this.queries=t.queries),i},n.DataManager=b,n.isView=m},"./dist/src/dataSource/dataReader/basicReader.js":function(t,n,i){"use strict";var e,u,r;function o(t){var n,i,r,t,n=this;n.LEt=t,(0,e.isNullOrUndefined)(t)||(n.Pq=t.Pq,i=t.dataPath,r=t.countPath,t=t.parse,(0,e.isFunction)(i)?n.FEt=i:n.FEt=function(t){return(0,e.isString)(i)&&i?(0,e.q$)(t,i):t},(0,e.isFunction)(r)?n.PEt=r:n.PEt=function(t){return(0,e.isString)(r)&&r?parseInt((0,e.q$)(t,r),10):u},(0,e.isFunction)(t)&&(n.parse=t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BasicReader=void 0,e=i("./dist/src/dataSource/utils.js"),u=void 0,o.prototype.parse=function(t){return this.GEt=t,Promise.resolve(t)},o.prototype.read=function(t){return Promise.resolve(this.FEt(t))},o.prototype.readSync=function(t){return this.FEt(t)},o.prototype.total=function(t){return this.PEt(t)},n.BasicReader=o},"./dist/src/dataSource/dataReader/columnJsonReader.js":function(t,n,i){"use strict";var r,e,h,u,o,s;function c(t){var n,f,a,n=s.call(this,t)||this,f=n,a=t.dataPath;return(0,h.isFunction)(a)?f.FEt=a:f.FEt=function(t){var n,i,r,e,u,o,s,c;for(t=(0,h.isString)(a)?(0,h.q$)(t,a):t,n=f.Pq=f.Pq||(0,h.getObjectKeys)(t),i=f.GEt=[],r=t[n[0]].length,e=0;e<r;e++){for(u={},o=0,s=n;o<s.length;o++)u[c=s[o]]=t[c][e];i.push(u)}return i},n}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnJsonReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),h=i("./dist/src/dataSource/utils.js"),s=e.BasicReader,r(c,s),c.prototype.parse=function(e){var u=this;return new Promise(function(t,n){var i,r;(0,h.isNullOrUndefined)(e)&&n("value cannot be null or empty"),i=u.Pq=u.Pq||(0,h.getObjectKeys)(e),(r=(0,h.reduce)(i,function(t,n){return t&&(0,h.isArray)(e[n])},!0))||n("The value of each property in column JSON should be an array"),t(e)})},n.ColumnJsonReader=c},"./dist/src/dataSource/dataReader/csvReader.js":function(t,n,i){"use strict";var r,e,l,u,o,s;function c(t){var n=s.call(this,t)||this;return n.UEt=t.delimiter||['"'],n.HEt=t.separator||",",n}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CsvReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),l=i("./dist/src/dataSource/utils.js"),s=e.BasicReader,r(c,s),c.prototype.parse=function(t){for(var n,i,r,e,u,o,s,c,f,a,h,n=this,i=n.UEt,r=n.HEt,e=t.split(""),u=0,o=e.length,s=[];u<o;){for(a=[];u<o&&"\r"!==e[u]&&"\n"!==e[u];){if(c=f=u,-1<(0,l.indexOf)(i,e[u])){for(c=f=++u;u<o;){if(-1<(0,l.indexOf)(i,e[u])){if(-1===(0,l.indexOf)(i,e[u+1]))break;e[++u]=""}f=++u}for(-1<(0,l.indexOf)(i,e[u])&&++u;u<o&&"\r"!==e[u]&&"\n"!==e[u]&&r!==e[u];)++u}else for(;u<o&&"\r"!==e[u]&&"\n"!==e[u]&&r!==e[u];)f=++u;a.push(e.slice(c,f).join("")),r===e[u]&&++u}"\r"!==e[u]&&"\n"!==e[u]||++u,0<a.length&&s.push(a)}return h=s.shift(),n.GEt=(0,l.isNullOrUndefined)(n.Pq)?(0,l.map)(s,function(t){return(0,l.zipObject)(h,t)}):(0,l.map)(s,function(t){return(0,l.pick)((0,l.zipObject)(h,t),n.Pq)}),n.Pq=n.Pq||h,Promise.resolve(n.GEt)},n.CsvReader=c},"./dist/src/dataSource/dataReader/jsonReader.js":function(t,n,i){"use strict";var r,i,e,u,o;function s(t){return o.call(this,t)||this}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.JsonReader=void 0,i=i("./dist/src/dataSource/dataReader/basicReader.js"),o=i.BasicReader,r(s,o),n.JsonReader=s},"./dist/src/dataSource/dataReader/xmlReader.js":function(t,n,i){"use strict";var r,e,u,o,s,c;function f(t){var i,r,e,i=c.call(this,t)||this,r=i,e=t.dataPath;return(0,u.isFunction)(e)?r.FEt=e:r.FEt=function(t){var n;return t=(0,u.isString)(e)?(0,u.q$)(t,e):t,(0,u.isNullOrUndefined)(t)||((n=r.Pq)?t=t.map(function(t){return(0,u.pick)(t,n)}):i.Pq=(0,u.getObjectKeys)(t[0])),t},i}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.XmlReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),u=i("./dist/src/dataSource/utils.js"),c=e.BasicReader,r(f,c),f.prototype.parse=function(t){var n,t,t,n,t=(new DOMParser).parseFromString(t.trim(),"text/xml"),t=this.documentToJSObject(t);return Promise.resolve(t)},f.prototype.documentToJSObject=function(t){for(var n,i,r,e,n={},i=t.children,r=0,e=i.length;r<e;r++)this.elementToJSObject(i[r],n);return n},f.prototype.elementToJSObject=function(t,n){var i,r,e,u,o,s,c,f,i=t.children,r=i.length,e=t.nodeName;if(0===r)n[e]=t.textContent;else{for(u={},void 0!==(o=n[e])?Array.isArray(o)?n[e].push(u):n[e]=[o,u]:n[e]=u,s=t.attributes,c=0;c<s.length;c++)u[(f=s[c]).nodeName]=f.nodeValue;for(c=0;c<r;c++)this.elementToJSObject(i[c],u)}},n.XmlReader=f},"./dist/src/dataSource/dataSource.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/dataSource/dataSource.js"),n),e(i("./dist/src/dataSource/dataSource.interface.js"),n),e(i("./dist/src/dataSource/utils.js"),n)},"./dist/src/dataSource/dataSource.interface.js":function(t,n){"use strict";var i,r,e,u,o,s,s,s,s,s;Object.defineProperty(n,"__esModule",{value:!0}),n.TriggerWhenType=n.FrameExcludeTies=n.FrameExcludeGroup=n.FrameExcludeCurrentRow=n.FrameExcludeNoOthers=n.OrderDesc=n.OrderAsc=n.WindowOverFrameExcludeMode=n.WindowOverFrameType=n.WindowOverFrameFollowing=n.WindowOverFramePreceding=void 0,(s=i=n.WindowOverFramePreceding||(n.WindowOverFramePreceding={}))[s.UnBounded=-2]="UnBounded",s[s.NPreceding=-1]="NPreceding",s[s.CurrentRow=0]="CurrentRow",(s=r=n.WindowOverFrameFollowing||(n.WindowOverFrameFollowing={}))[s.UnBounded=2]="UnBounded",s[s.NFollowing=1]="NFollowing",s[s.CurrentRow=0]="CurrentRow",(s=e=n.WindowOverFrameType||(n.WindowOverFrameType={}))[s.ROWS=0]="ROWS",s[s.RANGE=1]="RANGE",s[s.GROUPS=2]="GROUPS",(s=u=n.WindowOverFrameExcludeMode||(n.WindowOverFrameExcludeMode={}))[s.none=0]="none",s[s.current=1]="current",s[s.group=2]="group",s[s.ties=3]="ties",n.OrderAsc="ASC",n.OrderDesc="DESC",n.FrameExcludeNoOthers="none",n.FrameExcludeCurrentRow="current",n.FrameExcludeGroup="group",n.FrameExcludeTies="ties",(s=o=n.TriggerWhenType||(n.TriggerWhenType={})).onNew="onNew",s.onNewAndUpdate="onNewAndUpdate"},"./dist/src/dataSource/dataSource.js":function(P,y,t){"use strict";var n,g,v,i,r,e,f,u,o,s,c,_,a,m,j,l,O,C,b,S,h,d,k,M,L,p,V;function F(t){return"".concat(d).concat(t)}function w(t){return"string"==typeof t&&-1<t.indexOf(d)}function N(t){return w(t)?j:t}function q(t,n){var i=n;return"odata"!==t&&"odata4"!==t||!n.value?"graphql"!==t&&"rest"!==t||!n.data||(i=n.data):i=n.value,i}function T(t,n){var i,r,e,i={};for(r in t)t.hasOwnProperty(r)&&(e=n[r],i[r]=(0,_.isNullOrUndefined)(e)?t[r]:e);return i}function R(t,n,i,r,e){var u,o,s,c,f,a,h;for("string"==typeof i?u=o=i:(u=i.childrenField1||"children",o=i.childrenField2||"children"),s=t[u]||[],c=n[o]||[],f=0;f<s.length;f++)a=s[f],h=c[f],r&&r(a,h,t,n),R(a,h,i,r,e),e&&e(a,h,t,n)}function I(t,n){var i,r,e,u,o;if((0,_.isNullOrUndefined)(t)||(0,_.isNullOrUndefined)(n))return t===n;if(i=(0,_.getObjectKeys)(t),r=(0,_.getObjectKeys)(n),i.length===r.length){for(e=0,u=i;e<u.length;e++)if(t[o=u[e]]!==n[o])return;return 1}}function E(t,n){var t;return g(g({},t),{value:null!=(t=t.value)?t:n})}function G(t,n){for(var i,r,e,u,i=[],r=0;r<n;r++){for(u in e={},t)t.hasOwnProperty(u)&&(e[u]=t[u].data[r]);i[r]=e}return i}function x(t){return"xml"===t?"xml":"csv"===t?"text":"json"}function H(t){var n,n,t,i,i,i,i,i,n=null==(n=t.schema)?void 0:n.type,t=t.remote;n&&t&&((i=t.read)&&"object"==typeof i&&(i.dataType=x(n)),(i=t.update)&&"object"==typeof i&&(i.dataType=x(n)),(i=t.delete)&&"object"==typeof i&&(i.dataType=x(n)),(i=t.create)&&"object"==typeof i&&(i.dataType=x(n)),i=t.batch)&&"object"==typeof i&&(i.dataType=x(n))}function B(){}function A(t){var n,i,n=V.call(this)||this;return n.R1t=[],(i=n)._data=t.data,i.zEt=t.isRoot,i.VEt=t.getData,i.YEt=t.getFieldData,i.ZEt=t.idField,i.WEt=!(0,_.isNullOrUndefined)(t.idField),i.QEt=t.sequenceField,i.KEt=!(0,_.isNullOrUndefined)(t.sequenceField),Object.defineProperty(i,"data",{get:function(){return i.VEt(i.lp)}}),Object.defineProperty(i,"isRoot",{get:function(){return i.zEt}}),Object.defineProperty(i,"id",{get:function(){var t;return i.WEt?(t=i.YEt(i.ZEt,i.lp),(0,_.isNullOrUndefined)(t)?t=i._id:i._id!==t&&(i._id=t),t):i._id},set:function(t){i._id=t,(0,_.isNullOrUndefined)(i.JEt)&&(i.JEt=t)}}),Object.defineProperty(i,"parentId",{get:function(){return(0,_.isNullOrUndefined)(i.parent)?j:i.parent.id}}),Object.defineProperty(i,"parent",{get:function(){return i.sft},set:function(t){i.setParent(t),(0,_.isNullOrUndefined)(i.XEt)&&!(0,_.isNullOrUndefined)(t)&&(i.XEt=t.id)}}),Object.defineProperty(i,"level",{get:function(){return i.YAt},set:function(t){i.YAt=t}}),Object.defineProperty(i,"children",{get:function(){return i.R1t},set:function(t){i.R1t=t}}),Object.defineProperty(i,"sequence",{get:function(){return i.KEt?i.YEt(i.QEt,i.lp):i.qEt},set:function(t){i.qEt=t,(0,_.isNullOrUndefined)(i.$Et)&&(i.$Et=t)}}),n}function D(t){this.HFe=[],this.tjt={},this.njt=[],this.ejt=!0,this.Mue=!1,this.Kyn=0;var n=this;Object.defineProperty(this,"options",{get:function(){return n.LEt},set:function(t){n.setDataSourceOptions(t)}}),n._events={},n.options=g({data:m,batch:!1},t),this.ijt(t.remote,t.data),n.bind([l,C,b,y.ONCHANGE,O],t),this.rjt(t.schema),n.ajt()}n=this&&this.__extends||(p=function(t,n){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}p(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),g=this&&this.__assign||function(){return(g=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},v=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))},Object.defineProperty(y,"__esModule",{value:!0}),y.DataSource=y.HierarchyNode=y.ONCHANGE=y.REMOVE_COLUMN=y.UPDATE_COLUMN=y.ADD_COLUMN=y.GET_COLUMNS=y.RECOVER_DELETE=y.DELETE=y.UPDATE=y.INSERT=y.CREATE=void 0,i=t("./dist/src/dataSource/dataSource.interface.js"),r=t("./dist/src/dataSource/dataTransport/localDataTransport.js"),e=t("./dist/src/dataSource/dataTransport/remoteDataTransport.js"),f=t("./dist/src/dataSource/event.js"),u=t("./dist/src/dataSource/dataReader/jsonReader.js"),o=t("./dist/src/dataSource/dataReader/columnJsonReader.js"),s=t("./dist/src/dataSource/dataReader/csvReader.js"),c=t("./dist/src/dataSource/dataReader/xmlReader.js"),_=t("./dist/src/dataSource/utils.js"),a=t("Common"),m=null,j=void 0,y.CREATE="create",y.INSERT="insert",y.UPDATE="update",y.DELETE="delete",y.RECOVER_DELETE="recover_delete",y.GET_COLUMNS="getColumns",y.ADD_COLUMN="addColumn",y.UPDATE_COLUMN="updateColumn",y.REMOVE_COLUMN="removeColumn",l="onBeforeSend",O="onFailed",C="onBeforeEnd",b="onReady",S="user cancel the request at step ",y.ONCHANGE="onChange",h=Number.NaN,d="__HIERARCHY__",n(A,V=B),A.prototype.sjt=function(){return this.qEt},A.prototype.setParent=function(t,n){var i=!(0,_.isNullOrUndefined)(this.parent);i&&this.parent.cjt(this),this.sft=t,(0,_.isNullOrUndefined)(t)?i&&(this.level=h):(this.level=t.level+1,(0,_.isNullOrUndefined)(n)?t.fjt(this):t.ljt(this,n))},A.prototype.updateChildrenLevel=function(){var n=this.level;this.children.forEach(function(t){t.level=n+1,t.updateChildrenLevel()})},A.prototype.promote=function(t){this.setParent(t,this.parent.getCurrentIndex()+1),this.updateChildrenLevel()},A.prototype.demote=function(n,t){this.parent=n,(t=!1!==t)?this.updateChildrenLevel():this.children.forEach(function(t){t.parent=n})},A.prototype.getCurrentIndex=function(){return this.parent&&this.parent.children.indexOf(this)},A.prototype.getPrevSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()-1]},A.prototype.getNextSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()+1]},A.prototype.ljt=function(t,n){this.children.splice(n,0,t)},A.prototype.fjt=function(t){this.children.push(t)},A.prototype.cjt=function(t){var t=this.children.indexOf(t);this.children.splice(t,1)},A.prototype.getChildrenIndexes=function(t){var n=[];return(0,_.traversalTree)(this,{invoked:function(t){n.push(t.lp)}},t?function(t){return-t.sequence}:j),n},A.prototype.getChildrenCount=function(){var t=0;return(0,_.traversalTree)(this,{invoked:function(){t++}}),t},A.prototype.getFieldValue=function(t){return this.YEt(t,this.lp)},M=A,y.HierarchyNode=M,D.prototype.setDataSourceOptions=function(t,n){var i,r,e,u,o,r,s,r,c,f,i=this;if(H(t),r=i.LEt,i.LEt=t,!(o=(e=r&&r.remote&&r.remote.read&&((0,_.isFunction)(r.remote.read)?r.remote.read:r.remote.read.url))!==(u=t&&t.remote&&t.remote.read&&((0,_.isFunction)(t.remote.read)?t.remote.read:t.remote.read.url)))&&t&&r&&!t.remote&&t.data&&t.data!==r.data&&(o=!0),i.ijt(t.remote,t.data),r=r&&r.schema,s=t&&t.schema,(r=r&&s&&(r.type!==s.type||r.dataPath!==s.dataPath||r.countPath!==s.countPath))&&i.rjt(t.schema),(c=i.ojt)&&(o||r))return i.ajt(f={isDataSourceChanged:o}),i.load().then(function(t){return n&&n(f),Promise.resolve(t)}).catch(function(){n&&n(f)})},D.prototype.ijt=function(t,n){this.hjt=t?new e.RemoteDataTransport(t):new r.LocalDataTransport({data:n||[]})},D.prototype.rjt=function(t){var n,i;"json"===(i=(t=t||{}).type||"json")?n=new u.JsonReader(t):"columnJson"===i?n=new o.ColumnJsonReader(t):"csv"===i?n=new s.CsvReader(t):"xml"===i&&(n=new c.XmlReader(t)),this.djt=n},D.prototype.ajt=function(t){this._data={},this.vjt=0,this.DEt=[],t&&t.isDataSourceChanged&&(this.LEt&&this.LEt.schema&&delete this.LEt.schema.columns,this.HFe=[],delete this.bGe)},D.prototype.mjt=function(t,n,i){var r,e,u,o,s,r=this,e={};for(u in r._data)r._data.hasOwnProperty(u)&&(o=r._data[u],0!==n?(s=o.data.splice(t,n),e[u]={data:s}):t>=o.data.length?o.data[t]=i[u]:o.data.splice(t,0,i[u]));return r.vjt=r.vjt-n,i&&r.vjt++,G(e,n)},D.prototype.gjt=function(t,n){var i,r,e,u,i=this,r={};for(e in i._data)i._data.hasOwnProperty(e)&&(u=i._data[e],r[e]={data:u.data.slice(t,n)});return G(r,n-t)},D.prototype.WAr=function(t){for(var n,i,r,e,u,o,s,n=this,i=[],r=0,e=t;r<e.length;r++){for(s in u=e[r],o={},n._data)n._data.hasOwnProperty(s)&&(o[s]=n._data[s].data[u]);i.push(o)}return i},D.prototype.pjt=function(t,n,i){var r,e;if(!(0,_.isNullOrUndefined)(n))if(r=this,i)for(e in n)Object.prototype.hasOwnProperty.call(r._data,e)&&(r._data[e].data[t]=n[e]);else for(e in r._data)r._data.hasOwnProperty(e)&&(r._data[e].data[t]=n[e])},D.prototype.bjt=function(t){var n,i,r,n=this,i={};for(r in n._data)n._data.hasOwnProperty(r)&&(i[r]=n._data[r].data[t]);return i},D.prototype.jEe=function(t){return this._data[t].data},D.prototype.OEe=function(t,n){this._data[t]&&(this._data[t].data=n)},D.prototype.yjt=function(t){var t,n,i;return!(!t||!t.reload)||(n=(t=this).wjt,0===(i=t.vjt))||((0,_.isNullOrUndefined)(n),!1)},D.prototype.Mjt=function(t,n){var i,r,i=this.tjt;return i[t]||(r=void 0,n?r=a.Common.ct.yU(t,n):(r=a.Common.ct.dJ(t),(0,_.isNullOrUndefined)(r)&&(r=new Date(t)),isNaN(r)&&(r=new Date(t.replace(" ","T")))),i[t]=r),i[t]},D.prototype.Cjt=function(t,n){return n?0===n.split("|").indexOf(t):!!t},D.prototype.Sjt=function(t,n){return+(t=(t=n?t.replace(n,"."):t).replace(/,/g,""))||0},D.prototype.xQi=function(t){return t.toString()},D.prototype.Tjt=function(t,n,i,r){var e=t;return"rowOrder"===n?t:(r&&n&&"boolean"!==n&&(e+=""),"date"===n?"NULL"===e||""===e?null:this.Mjt(e,i):"boolean"===n?this.Cjt(e,i):"number"===n?this.Sjt(e,i):"string"===n?this.xQi(e):t)},D.prototype.Ajt=function(t,n){var i="number"==typeof t;return(0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(t)||"string"!=typeof t&&!i?t:this.Tjt(t,n.dataType,n.dataPattern,i)},D.prototype.Ijt=function(t,n){var i,r,e,u;for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&(u="number"==typeof(e=n[i]),(0,_.isNullOrUndefined)(e)||"string"!=typeof e&&!u||(n[i]=this.Tjt(e,r.dataType,r.dataPattern,u)))},D.prototype.xjt=function(t,n,i){for(var r,e,u,o,r=this._data[t].data,e=0;e<r.length;e++)o="number"==typeof(u=r[e]),(0,_.isNullOrUndefined)(u)||"string"!=typeof u&&!o||(r[e]=this.Tjt(u,n,i,o));this.pGr(t),this.isHierarchy()&&"rowOrder"===n&&(this.ejt=!0)},D.prototype.Njt=function(t,n){var i,r;t===n||(0,_.isNullOrEmpty)(n)||((i=this).VFe(t,n),r=i.kjt(t),i.Djt(t,(0,_.isNullOrEmpty)(r)?t:r,n))},D.prototype.VFe=function(n,t){var i,r,i=this,r=i.DEt.findIndex(function(t){return t===n});-1<r&&i.DEt.splice(r,1,t),i._data[t]=i._data[n],delete i._data[n]},D.prototype.K3e=function(){var t,n,i,r,n=this,i=null==(t=n.LEt.schema)?void 0:t.columns;if(i)for(r in i)if(n.J3e(i[r].trigger))return!0;return!1},D.prototype.J3e=function(t){var n=this;return t&&t.formula&&(0,_.isFormula)(t.formula)&&(t.when===i.TriggerWhenType.onNew||t.when===i.TriggerWhenType.onNewAndUpdate&&!(0,_.isNullOrEmpty)(t.fields)&&(-1<t.fields.indexOf("*")||t.fields.split(",").map(function(t){return t.trim()}).every(function(t){return-1<n.DEt.indexOf(t)})))},D.prototype.X3e=function(t){var n,n,i,t,i=this,t=null==(n=null==(n=i.LEt.schema)?void 0:n.columns[t])?void 0:n.trigger;if(i.J3e(t))return t},D.prototype.q3e=function(t,n){var i,r,e,u,o,s,r=this,u=null==(i=r.LEt.schema)?void 0:i.columns;if(!(0,_.isNullOrUndefined)(u))for(o in u)!u.hasOwnProperty(o)||!(s=r.X3e(o))||t&&t!==s.when||((e=e===j?{}:e)[o]=n?s.formula:s);return e},D.prototype.oke=function(t){var n,n,n,i,i;return"formula"===(null==(n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t])?void 0:n.dataType)},D.prototype.GTe=function(){var t,n,i,r,e,u,t,n=this.LEt.schema,r={};if(!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.columns))for(e in i=n.columns)i.hasOwnProperty(e)&&"formula"===(u=i[e]).dataType&&(r[e]=u.value);return r},D.prototype.BAe=function(t){var n,n,n,n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t];return"formula"===(null==n?void 0:n.dataType)&&(null==n?void 0:n.value)},D.prototype.EEe=function(){var r,e,r={},e={};return this.njt.concat([this.zjt]).forEach(function(t){var n,i,i,n,i="".concat(t.id),n="".concat(t.parentId);r[i]=n,e[i]=null==(i=null!=(n=t.children)?n:[])?void 0:i.map(function(t){return"".concat(t.id)})}),{orderCache:e,relationShipCache:r}},D.prototype.REe=function(t){var r,e,u,o,r=t.orderCache,e=t.relationShipCache,u={},o=this;o.njt.concat([this.zjt]).forEach(function(t){var n="".concat(t.id);u[n]=t}),o.njt.forEach(function(t){var n,i,n,i,n="".concat(t.id),i="".concat(t.parentId),n=e[n];(n&&n!==i||!t.parent)&&((i=u[n])||n!==o.zjt.id||(i=o.zjt),t.setParent(i))}),o.njt.concat([this.zjt]).forEach(function(t){var n,n,i,n="".concat(t.id),i=r[n];(null!=(n=t.children)?n:[]).sort(function(t,n){return i.indexOf("".concat(t.id))-i.indexOf("".concat(n.id))})}),o.zjt.updateChildrenLevel(),"Custom"===o.Fjt()&&o.g7t()},D.prototype.kjt=function(t){var n,i=this.LEt.schema,r,i,e;if(!((0,_.isNullOrUndefined)(i)||(0,_.isNullOrUndefined)(i.columns)||(i=(r=i.columns)[t],(0,_.isNullOrUndefined)(i))||(e=i.dataName,(0,_.isNullOrEmpty)(e))))return e},D.prototype.Djt=function(t,n,i){var r=this,e=r.LEt.schema,r,e;(0,_.isNullOrUndefined)(e)&&(r.LEt.schema=e={}),r=e.columns,(0,_.isNullOrUndefined)(r)&&(e.columns=r={}),e=r[t],(0,_.isNullOrUndefined)(e)&&(r[t]=e={}),(0,_.isNullOrEmpty)(e.dataName)&&(e.dataName=n),(0,_.isNullOrEmpty)(i)||(r[i]=r[t],delete r[t])},D.prototype.h3e=function(t){var n,i,r,e,u,n=this,i,r=n.Bjt()[1];for(e in t)u=t[e],t[e]=n.Ajt(u,r[e])},D.prototype._jt=function(t){var n=this;return t=n.Ejt(t,{isServerToClient:!0}),n.h3e(t),t},D.prototype.jjt=function(t,n){var i=this;return t=(0,_.clone)(t,!0),i.Ojt(t),t=i.Ejt(t,n)},D.prototype.Ejt=function(t,n){var i,r,e,u,o,s,c,f,r=(i=this).LEt.schema,e=(n=n||{}).isServerToClient,u=n.isClone,o=n.isPartial;if(!(0,_.isNullOrUndefined)(t)&&!(0,_.isNullOrUndefined)(r)&&!(0,_.isNullOrUndefined)(r.columns)){for(f in s=r.columns,c=[],s)(0,_.isNullOrUndefined)(s[f].dataName)||s[f].dataName===f||o&&!t.hasOwnProperty(f)||c.push(e?[s[f].dataName,f]:[f,s[f].dataName]);0<c.length&&(t=u?(0,_.clone)(t,!0):t,(0,_.isArray)(t)?t.forEach(function(t){i.Rjt(c,t)}):(0,_.isObject)(t)&&i.Rjt(c,t))}return t},D.prototype.Rjt=function(t,i){t.forEach(function(t){var n=t[0],t=t[1];i[t]=i[n],delete i[n]})},D.prototype.Bjt=function(){var t,n,i,r,e,u,t,n=this.LEt.schema;if((0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(n.columns))return[{},{}];for(u in r={},e={},i=n.columns)i.hasOwnProperty(u)&&((0,_.isNullOrUndefined)(i[u].dataName)||(r[i[u].dataName]=u),i[u].dataType||i[u].dataPattern)&&(e[u]={dataType:i[u].dataType,dataPattern:i[u].dataPattern});return[r,e]},D.prototype.zFe=function(i){var a,h,r,t,n,a=this;if(a.HFe=[],a.YFe(),0<(i=i.slice()).length)for(n in r=a.LEt.schema.columns,h={},t=function(n){var t;r.hasOwnProperty(n)&&(t=r[n],h[n]=t,(0,_.isNullOrUndefined)(t.value)&&(t.value=n),(0,_.isNullOrUndefined)(t.name)&&(t.name=n),(0,_.isNullOrEmpty)(t.dataName)||(h[t.dataName]=t),"formula"===t.dataType?(t.name=n,i.push(n)):i.some(function(t){return(t.field||t)===n})||(t.ZFe=!0))},r)t(n);i.forEach(function(t){var n,i,r,e,u,o,s,c,f,n=t.field||t,i=t.dataType,r=a.QFe(),e="object"==typeof t,u=e?Object.keys(t):[];if(t=e&&0<u.length?t:{},h[n]){for(o=0,s=u;o<s.length;o++)f=t[c=s[o]],h[n][c]===f||(0,_.isNullOrEmpty)(f)||(h[n][c]=f);h[n].Kyn=r}else a.LEt.schema.columns[n]=g(g({},t),{Kyn:r,name:n,value:n,dataType:i});a.HFe.push({key:r})}),a.H3e()},D.prototype.QFe=function(){return this.Kyn++},D.prototype.WFe=function(){var t=this,n=t.LEt;return!t.MOt()&&n.remote.getColumns&&("function"==typeof n.remote.getColumns||!(0,_.isNullOrEmpty)(n.remote.getColumns.url))},D.prototype.KFe=function(){var t;return this.WFe()},D.prototype.YFe=function(){var t=this,n=t.LEt.schema;(0,_.isNullOrUndefined)(n)&&(n=t.LEt.schema={}),(0,_.isNullOrUndefined)(n.columns)&&(n.columns={})},D.prototype.YAe=function(t){var n=this;return n.YFe(),!n.oke(t)},D.prototype.JFe=function(t){var n,i,t,r,e,u,n=this,i=t.source,t=t.name;i&&(r=n.LEt.schema.columns,delete n.LEt.schema.columns[t],delete n._data[t],n.DEt.splice(n.DEt.indexOf(t),1),n.X7t()?(e=i.columnStatus.key,-1<(u=n.HFe.findIndex(function(t){return t.key===e}))&&n.HFe.splice(u,1),n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)})):i.postData&&n.XFe()?n.rOt({body:i.postData},y.REMOVE_COLUMN).then(function(){n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)})}):(n.mGr(m,t),n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)})))},D.prototype.qFe=function(i,r,e,t){var u=this;u.YFe(),i=g(g({},i),{Kyn:u.QFe()}),r=r||[],u.$Fe(i,r,function(t){var n;t.source=t.source||{},u.tGe(i),u.YAe(i.name)&&(u.H3e(),0<r.length)&&(n=u._data[i.name])&&(n.data=r),u.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:i}),e&&e(t)},t)},D.prototype.tGe=function(t){var n,i;this.LEt.schema.columns[t.name]=g({},t)},D.prototype.EQe=function(t,n){var i,r,e,u,o,s,c,f,a,h,l,v,d,p,w;if((0,_.isNullOrUndefined)(n)||0===n.length)return[];for(u={},o=0,s=e=(r=this).Ljt();o<s.length;o++)c=s[o],(f=r._data[c])&&f.data&&0<f.data.length&&(u[c]=f.data);for(a=Object.keys(u),h=[],l=0;l<n.length;l++){for((i={})[t.name]=n[l],v=i,d=0,p=a;d<p.length;d++)v[w=p[d]]=u[w][l];h.push(v)}return h},D.prototype.$Fe=function(t,n,i,r){var e,u,o,e=this,u=!(0,_.isNamedFormulaColumn)(t);e.X7t()?(e.HFe.push({key:t.Kyn,status:1,column:g({},t),originalColumnData:n.slice()}),o={columnStatus:g({},e.HFe[e.HFe.length-1])},i&&i({type:y.ADD_COLUMN,success:!0,source:o})):u&&e.XFe()?(o={postData:{column:g(g({},t),{field:t.dataName||t.value})}},i&&i({type:y.ADD_COLUMN,success:!0,source:o}),e.nGe(t,e.EQe(t,n),m,r)):(e.bGr(t,n),i&&i({type:y.ADD_COLUMN,success:!0}))},D.prototype.bGr=function(t,n){var n,i,r,e,i,u,o,t,s,c,r=this;r.Dkr()&&(e=r._kr(),i=r.isHierarchy(),(0,_.isNullOrUndefined)(e)||(u=t.dataName||t.value,o=n||[],i&&"ChildrenPath"===r.Fjt()?(t=r.Gjt().trim(),t=r.Yjt(t),(s=0,_.traversalTree)(((n={})[t]=e,n),{invoking:function(t){t[u]=o[s],s++}},j,t)):"json"===(c=(null==(i=r.LEt.schema)?void 0:i.type)||"json")?e.forEach(function(t,n){t[u]=o[n]}):e[u]=o.slice()))},D.prototype.nGe=function(t,n,i,r){var e;this.rOt({body:{column:g(g({},t),{field:t.dataName||t.value}),data:n}},y.ADD_COLUMN).then(function(){i&&i({type:y.ADD_COLUMN,success:!0})}).catch(function(t){r&&r({type:y.ADD_COLUMN,success:!1,reason:t})})},D.prototype.eGe=function(t){var n,i,t,r,e,u,n=this,i=t.source,t=t.name;i&&(i.column&&(n.LEt.schema.columns[t]=i.column),i.data&&(n._data[t]=i.data),i.name&&n.DEt.splice(i.nameIndex,0,i.name),r=i.column,n.X7t()?(e=r.Kyn,-1<(u=n.HFe.findIndex(function(t){return t.key===e}))?n.HFe[u]=i.columnStatus:n.HFe.push(i.columnStatus),n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)})):i.postData&&n.XFe()?n.nGe(r,function(){n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)})}):(n.bGr({value:t},i.data.data),n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)})))},D.prototype.iGe=function(r,e,t){var n,n,u,o,u=this;u.YFe(),o=null==(n=null==(n=u.LEt.schema)?void 0:n.columns)?void 0:n[r],u.rGe(r,function(t){var n,i,n=t.source=t.source||{};n.column=g({},u.LEt.schema.columns[r]),u.oGe(r),u.YAe(r)&&(n.data=u._data[r],delete u._data[r],i=u.DEt.findIndex(function(t){return t===r}),n.name=u.DEt[i],n.nameIndex=i,u.DEt.splice(i,1)),u.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},o)}),e&&e(t)},t)},D.prototype.oGe=function(t){var n,i;delete this.LEt.schema.columns[t]},D.prototype.rGe=function(t,n,i){var r,e,u,u,o,s,c,t,r=this,e=r.LEt.schema.columns[t],u=!e.ZFe,u=!r.oke(t)&&u;e.isPrimaryKey&&i&&i({type:y.REMOVE_COLUMN,success:!1}),r.X7t()?(o=e.Kyn,c=void 0,-1<(s=r.HFe.findIndex(function(t){return t.key===o}))&&(c={columnStatus:g({},r.HFe[s])},1===r.HFe[s].status?r.HFe.splice(s,1):(2!==r.HFe[s].status&&(r.HFe[s].originalColumn=g({},e),u)&&(r.HFe[s].originalColumnData=r._data[t].data.slice()),r.HFe[s].status=3)),n&&n({type:y.REMOVE_COLUMN,success:!0,source:c})):u&&r.XFe()?(c={postData:t={column:{field:e.dataName||e.value}}},n&&n({type:y.REMOVE_COLUMN,success:!0,source:c}),r.rOt({body:t},y.REMOVE_COLUMN).catch(function(t){i&&i({type:y.REMOVE_COLUMN,success:!1,reason:t})})):(r.mGr(e),n&&n({type:y.REMOVE_COLUMN,success:!0}))},D.prototype.mGr=function(t,n){var t,i,r,e,i,u,n,o,r=this;r.Dkr()&&(e=r._kr(),i=r.isHierarchy(),(0,_.isNullOrUndefined)(e)||(u=n||t.dataName||t.value,i&&"ChildrenPath"===r.Fjt()?(n=r.Gjt().trim(),n=r.Yjt(n),(0,_.traversalTree)(((t={})[n]=e,t),{invoking:function(t){delete t[u]}},j,n)):"json"===(o=(null==(i=r.LEt.schema)?void 0:i.type)||"json")?e.forEach(function(t){delete t[u]}):delete e[u]))},D.prototype.uGe=function(t){var n,t,i,r,e,u,n=this,t=t.source;t&&(i=t.originalColumn,r=t.column,t.originalColumn&&n.aGe(r.value,i,!0),t.shouldUpdateLocalField&&n.VFe(r.value,i.value),t.shouldUpdateDataType&&(n._data[i.value].data=t.data),n.X7t()?(e=i.Kyn,-1<(u=n.HFe.findIndex(function(t){return t.key===e}))&&(n.HFe[u]=t.columnStatus),n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)})):t.postData&&n.XFe()?n.rOt({body:{column:t.postData.originalColumn,originalColumn:t.postData.column}},y.UPDATE_COLUMN).then(function(){n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)})}):(t.shouldUpdateLocalField&&n.wGr({value:r.value},{value:i.value}),t.shouldUpdateDataType&&n.pGr(i.value),n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)})))},D.prototype.JEe=function(i,r,e,t){var n,n,u,o,u=this;return u.YFe(),o=null==(n=null==(n=u.LEt.schema)?void 0:n.columns)?void 0:n[i],u.sGe(i,r,function(t){var n=t.source=t.source||{};n.originalColumn=E(o,i),n.column=E(r,i),u.YAe(i)&&u.cGe(i,r,n),u.aGe(i,r),u.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:r,originalColumn:o}),e&&e(t)},t)},D.prototype.aGe=function(t,n,i){var r,e,t,r,e=this.LEt.schema,t=e.columns[t];(0,_.isNullOrUndefined)(t)||(t.name!==n.name&&delete e.columns[t.name],e.columns[n.name]=i||n.type!==t.type?g({},n):g(g({},t),n))},D.prototype.sGe=function(t,n,i,r){var e,u,o,s,o,c,f,a,h,l,v,d,p,w,b,m,j,h,a,v,w,e=this,u=E(e.LEt.schema.columns[t],t);if(n=n.type!==u.type?E(g({},n),t):E(g(g({},u),n),t),o=!u.ZFe,o=!(s=e.oke(t))&&o,c=u.dataName,f=n.dataName,a=!(0,_.isNullOrEmpty)(c),h=!(0,_.isNullOrEmpty)(f),v=u.value!==n.value,d=u.dataType!==n.dataType,p=u.isPrimaryKey!==n.isPrimaryKey,w=u.dataPattern!==n.dataPattern,b=!((l=!1)||d||p||(0,_.isEqual)(u,n,!0,!0)),a&&h?c!==f&&(l=!0):h?u.value!==f&&(l=!0,c=u.value):a?c!==n.value&&(l=!0,f=n.value):v&&(l=!0,c=u.value,f=n.value),e.X7t())m=void 0,j=u.Kyn,-1<(h=e.HFe.findIndex(function(t){return t.key===j}))&&(m={columnStatus:g({},e.HFe[h])},1!==e.HFe[h].status&&(e.HFe[h].status=2,(0,_.isNullOrUndefined)(e.HFe[h].originalColumn))&&(o&&(d||w)&&(e.HFe[h].originalColumnData=e._data[t].data.slice()),e.HFe[h].originalColumn=g({},u)),e.HFe[h].column=g(g({},n),{Kyn:j})),i&&i({type:y.UPDATE_COLUMN,success:!0,source:m});else{if(o&&(l||d||p||b)&&e.XFe())return a={column:g(g({},n),{field:t}),originalColumn:g(g({},u),{field:c||t})},l&&(a.column.field=f),m={postData:a},i&&i({type:y.UPDATE_COLUMN,success:!0,source:m}),e.rOt({body:a},y.UPDATE_COLUMN).catch(function(t){r&&r({type:y.UPDATE_COLUMN,success:!1,reason:t})});v=g(g({},n),{value:t}),w=g(g({},u),{value:c||t}),l&&(v.value=f),e.wGr(w,v),i&&i({type:y.UPDATE_COLUMN,success:!0})}},D.prototype.wGr=function(t,n){var n,i,r,e,i,u,o,t,s,r=this;r.Dkr()&&(e=r._kr(),i=r.isHierarchy(),(0,_.isNullOrUndefined)(e)||(u=t.value,o=n.value,u!==o&&(i&&"ChildrenPath"===r.Fjt()?(t=r.Gjt().trim(),t=r.Yjt(t),(0,_.traversalTree)(((n={})[t]=e,n),{invoking:function(t){t[o]=t[u],delete t[u]}},j,t)):"json"===(s=(null==(i=r.LEt.schema)?void 0:i.type)||"json")?e.forEach(function(t){t[o]=t[u],delete t[u]}):(e[o]=e[u],delete e[u]))))},D.prototype.pGr=function(i){var t,t,n,r,e,u,e,o,s,n=this;n.Dkr()&&(r=n._kr(),e=n.isHierarchy(),(0,_.isNullOrUndefined)(r)||(u=n._data[i].data,e&&"ChildrenPath"===n.Fjt()?(e=n.Gjt().trim(),e=n.Yjt(e),(o=0,_.traversalTree)(((t={})[e]=r,t),{invoking:function(t){t[i]=u[o],o++}},j,e)):"json"===(s=(null==(t=n.LEt.schema)?void 0:t.type)||"json")?r.forEach(function(t,n){t[i]=u[n]}):r[i]=u.slice()))},D.prototype.cGe=function(t,n,i){var r,e,u,o,s,r=this,e=E(r.LEt.schema.columns[t],t);n=n.type!==e.type?E(g({},n),t):E(g(g({},e),n),t),u=e.value!==n.value,o=e.dataType!==n.dataType,s=e.dataPattern!==n.dataPattern,u&&(i.shouldUpdateLocalField=!0,r.VFe(e.value,n.value)),(o||s)&&(i.shouldUpdateDataType=!0,i.data=r.fGe(u?n.value:t).slice(),r.xjt(n.value,n.dataType,n.dataPattern))},D.prototype.Ljt=function(){var t,n,i,r,e,u,t,n=this.LEt.schema,i=[];if(!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.columns))for(e in r=n.columns)r.hasOwnProperty(e)&&(u=r[e]).isPrimaryKey&&i.push(e);return i},D.prototype.Ojt=function(t){var n,i,n,r,n=this;!(0,_.isNullOrUndefined)(t)&&n.isHierarchy()&&"Level"===n.Fjt()&&(i=n.Pjt(),(0,_.isNumber)(i))&&(r=t[n=n.Gjt()],t[n]=r-i)},D.prototype.Ujt=function(i){var t,n,r,t=this,n=t.njt,r=t.Dkr();return n.map(function(t,n){t.lp=n,i||(t.sequence=n+1);var n=t._data;return r||(t._data=j),n})},D.prototype.Hjt=function(t){var n=this,i=n.zjt,r=n.njt=[];return(0,_.traversalTree)(i,function(t){t.level=t.parent.level+1,r.push(t)},t?{isOrderChildren:!0,getValue:function(t){return t.qEt}}:j),n.Ujt(t)},D.prototype.Vjt=function(t,n,i,r,e){var u,o,s,c,f,a,h,l,v,d,p,w,u=this,o=!(0,_.isNullOrEmpty)(r),s=n,c=r;for(n=u.Yjt(n),i=u.Yjt(i),r=u.Yjt(r),f={},a=0;a<t.length;a++)h=t[a],l=new M(u.Zjt({data:h,idField:s,sequenceField:c})),v=h[n],f[l.id=v]=l,o&&(l.sequence=h[r]);for((d=new M({isRoot:!0})).level=e-1,a=0;a<t.length;a++)v=t[a][n],p=t[a][i],l=f[v],(0,_.isNullOrUndefined)(w=f[p])?(d.id=p,l.parent=d):l.parent=w;return u.zjt=d,u.Hjt(o)},D.prototype.Wjt=function(t,n,i,r,e){var u,o,s,c,f,a,h,l,v,d,p,w,b,u=this,o=!(0,_.isNullOrEmpty)(r),s=n,c=r;for(n=u.Yjt(n),i=u.Yjt(i),r=u.Yjt(r),f=j,a=0;a<t.length;a++)((h=t[a][i])<f||f===j)&&(f=h);for(f===j&&(f=0),(l=u.zjt=new M({isRoot:!0})).level=f+e-1,v=[l],a=0;a<t.length;a++){for(d=t[a],p=new M(u.Zjt({data:d,idField:s,sequenceField:c})),w=(0,_.isNullOrEmpty)(n)?F(a):d[n],h=d[i]+e,p.id=w,o&&(p.sequence=d[r]),b=v[v.length-1];b.level>=h;)b=v.pop().parent;p.parent=b,v.push(p)}return u.Hjt(o)},D.prototype.Qjt=function(t,i,n,r,e){var e,u,o,s,c,f,a,h,u=this,o=u.njt=[],s=!(0,_.isNullOrEmpty)(r),c=i,f=r;return i=u.Yjt(i),n=u.Yjt(n),r=u.Yjt(r),(a=u.zjt=new M({isRoot:!0})).level=e-1,h=[a],(0,_.traversalTree)(((e={})[n]=t,e),{invoking:function(t){var n=new M(u.Zjt({data:t,idField:c,sequenceField:f}));n.id=(0,_.isNullOrEmpty)(i)?F(o.length):t[i],s&&(n.sequence=t[r]),n.parent=h[h.length-1],o.push(n),h.push(n)},invoked:function(){h.pop()}},s?r:j,n),u.Ujt(s)},D.prototype.Kjt=function(t,n,i,r,e,u){var o,s,c,f,a,h,l,v,d,p,w,b,b,o=this,s=!(0,_.isNullOrEmpty)(e),c=n,f=e;for(n=o.Yjt(n),i=o.Yjt(i),e=o.Yjt(e),a={},h=0;h<t.length;h++)l=t[h],v=new M(o.Zjt({data:l,idField:c,sequenceField:f})),d=l[i],v.id=(0,_.isNullOrEmpty)(n)?F(h):l[n],a[d]=v,s&&(v.sequence=l[e]);for(p=o.Bjt(),(w=new M({isRoot:!0})).level=u-1,h=0;h<t.length;h++)v=a[d=t[h][i]],b=r(o.Jjt(t[h],p,h)),(0,_.isNullOrUndefined)(b=a[b])?v.parent=w:v.parent=b;return o.zjt=w,o.Hjt(s)},D.prototype.Jjt=function(o,i,t){var s=this,t={index:t};return Object.defineProperty(t,"data",{get:function(){var r,e,u,t,n,r=i[0],e=i[1],u={},t=function(t){var n,i;o.hasOwnProperty(t)&&(n=o[t],i=r[t]||t,Object.defineProperty(u,i,{get:function(){return s.Ajt(n,e[i])}}))};for(n in o)t(n);return u}}),t},D.prototype.Zjt=function(t){var n=this;return{data:t.data,idField:t.idField,sequenceField:t.sequenceField,getData:n.bjt.bind(n),getFieldData:n.Xjt.bind(n)}},D.prototype.lGe=function(t,n){var i,r,i,e,i,u,o,s,c,f,a,h,r=this,i=r.LEt.schema;if(r.isHierarchy()){if(e=i.hierarchy.type.trim(),i=null==(i=i.hierarchy.column)?void 0:i.trim(),u=r.$jt(),o=r.Ljt(),"Parent"===e){if(t===(s=o[0])||t===i||t===u)return!0}else if("Level"===e){if(t===(s=o[0])||t===i||t===u)return!0}else if("ChildrenPath"===e){if(t===(s=o[0])||t===i||t===u)return!0}else if("Custom"===e&&(t===(s=o[0])||t===i||t===u))return!0;if(!n&&r.l7t(t))return!0}return!1},D.prototype.qjt=function(t){var n,i,r,e,n,u,o,s,c,f,a,h,l,e,i=this,r=i.LEt.schema;return i.isHierarchy()&&(e=r.hierarchy.type.trim(),n=null==(n=r.hierarchy.column)?void 0:n.trim(),u=r.hierarchy.levelOffset||0,o=i.Ljt(),s=i.$jt(t),"Parent"===e?(c=o[0],t=i.Vjt(t,c,n,s,u)):"Level"===e?(c=o[0],t=i.Wjt(t,c,n,s,u)):"ChildrenPath"===e?(c=o[0],t=i.Qjt(t,c,n,s,u)):"Custom"===e&&(c=o[0],e=r.hierarchy.parse,t=i.Kjt(t,c,n,e,s,u)),i.t7t(),i.ejt=!1),t},D.prototype.t7t=function(){var t,n,i,r,e,t=this,n=t.$jt(),i=t.njt.slice();for((0,_.isNullOrEmpty)(n)||i.sort(function(t,n){return t.sjt()-n.sjt()}),r=0;r<i.length;r++)(e=i[r]).prev=i[r-1],e.next=i[r+1]},D.prototype.$jt=function(t){var n,i,r,e,u,n=this,i=n.LEt.schema;if(!(0,_.isNullOrUndefined)(i)&&!(0,_.isNullOrUndefined)(i.columns))for(e in r=i.columns)if(Object.prototype.hasOwnProperty.call(r,e)&&"rowOrder"===(u=r[e]).dataType&&(u.n7t||n.e7t(e,t)))return u.n7t=!0,e},D.prototype.e7t=function(t,n){var i,r,e;if(!(0,_.isNullOrUndefined)(t)&&(0,_.isArray)(n)){if(0===n.length)return!0;for(t=(i=this).Yjt(t),r=0;r<n.length;r++)if(e=n[r][t],!(0,_.isNullOrUndefined)(e))return(0,_.isNumber)(e)}},D.prototype.qX=function(){var t=this;return!(!t.isHierarchy()||"Parent"===t.Fjt()&&(0,_.isNullOrUndefined)(t.$jt()))},D.prototype.i7t=function(){return this.options.schema.hierarchy.summaryFields},D.prototype.Pjt=function(){return this.options.schema.hierarchy.levelOffset},D.prototype.r7t=function(){return this.options.schema.hierarchy.unparse},D.prototype.Gjt=function(){return this.options.schema.hierarchy.column},D.prototype.Fjt=function(){return this.options.schema.hierarchy.type},D.prototype.o7t=function(){var t,n;return this.Ljt()[0]},D.prototype.isHierarchy=function(){var t,t,n,n=this.options.schema;return!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.hierarchy)&&!(0,_.isNullOrUndefined)(null==(t=n.hierarchy.type)?void 0:t.trim())&&!(0,_.isNullOrUndefined)(null==(t=n.hierarchy.column)?void 0:t.trim())&&("Custom"!==n.hierarchy.type||(0,_.isFunction)(n.hierarchy.parse)&&(0,_.isFunction)(n.hierarchy.unparse))},D.prototype.a7t=function(){return this.ejt},D.prototype.u7t=function(){this.ejt=!0},D.prototype.SEt=function(t){var n=this;return t=n.s7t(t),n.c7t(t)},D.prototype.c7t=function(t){var n,i;return this.njt[t]},D.prototype.f7t=function(){return this.zjt},D.prototype.l7t=function(t){var n,i=this.i7t();if(!(0,_.isNullOrUndefined)(i))return i[t]},D.prototype.h7t=function(t,n){var i,t,i,i=this,t=i.l7t(t);if(!(0,_.isNullOrEmpty)(t)&&(i=i.SEt(n),!(0,_.isNullOrUndefined)(i))&&0<i.children.length)return t},D.prototype.Yjt=function(t){var n,i,r,e,n,i=this.LEt.schema;if(!(0,_.isNullOrUndefined)(i)&&!(0,_.isNullOrUndefined)(i.columns))for(e in r=i.columns)if(e===t)return r[e].dataName||t;return t},D.prototype.d7t=function(t,n,i){var r=this;return r.v7t(i,(0,_.isNumber)(t)?r.s7t(t):t,r.s7t(n))},D.prototype.v7t=function(t,n,i){var r=this,e=r.njt,u=r.$jt(),o,s=function(t){return r.isHierarchy()?r.njt[t].sequence:r._data[u].data[t]};return t?(n=e[i].next&&e[i].next.lp,(0,_.isNullOrUndefined)(n)?(o=s(i),Math.floor(o)===o?o+=.5:o=(o+Math.ceil(o))/2):o=(s(i)+s(n))/2):(n=e[i].prev&&e[i].prev.lp,o=(0,_.isNullOrUndefined)(n)?(o=s(i))<=1?o/2:o-.5:(s(n)+s(i))/2),o},D.prototype.Cue=function(){return this.Mue},D.prototype.Sue=function(t){this.Mue=t},D.prototype.m7t=function(t,n,i,r){var e,u,o,s,c,f,n,a,h,f,l,v,f,e,u,v,l,o=this,s=o.$jt(),c=o.isHierarchy();if((0,_.isNullOrUndefined)(s)&&!c||n===i||(0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(i))return!1;if(i=o.s7t(i),r=(0,_.isNumber)(r)?o.s7t(r):r,n=o.s7t(n),h=(a=o.njt)[n],f=a[i],c){if(f.parent!==h.parent)return!1;e=0,(t=(v=(l=h.parent.children).indexOf(h))<(f=l.indexOf(f)))?(e=null==(u=h.getNextSibling())?void 0:u.lp,l.splice(f+1,0,h),l.splice(v,1)):(e=n,l.splice(v,1),l.splice(f,0,h)),"Custom"===o.Fjt()&&o.g7t(e),!(0,_.isNullOrUndefined)(r)&&(u=a[r],v=h.parent===u,l=h.parent.parent===u.parent,v||l)&&(r=j)}return f=o.v7t(t,r,i),c&&(0,_.isNullOrUndefined)(s)&&(h.sequence=f),o.p7t(t,i,n),(0,_.isNullOrUndefined)(s)||o.b7t(n,((e={})[s]=f,e)),!0},D.prototype.p7t=function(t,n,i){var r,e,i,r,r=this,e;r.isHierarchy()&&(i=r.c7t((0,_.isNumber)(i)?i:r.njt.length-1),r=r.c7t(n),(0,_.isNullOrUndefined)(i.prev)||(i.prev.next=i.next),(0,_.isNullOrUndefined)(i.next)||(i.next.prev=i.prev),t?(i.prev=r,i.next=r.next,(0,_.isNullOrUndefined)(r.next)||(r.next.prev=i),r.next=i):(i.next=r,i.prev=r.prev,(0,_.isNullOrUndefined)(r.prev)||(r.prev.next=i),r.prev=i))},D.prototype.y7t=function(t,n){var i,r,e,i=this,r;if(i.isHierarchy())for(n=n||1,e=0;e<n;e++)i.w7t(e+t)},D.prototype.w7t=function(t){var n,t=this.c7t(t);(0,_.isNullOrUndefined)(t.prev)||(t.prev.next=t.next),(0,_.isNullOrUndefined)(t.next)||(t.next.prev=t.prev)},D.prototype.M7t=function(t){var n,n,o,i,s,c,f,i,n,r,e,u,a,h,l,v,d;if(this.isHierarchy()&&(i=(o=this).njt,s=o.Gjt(),t=o.s7t(t),!(c=i[t]).parent.isRoot)){for(f=o.Fjt(),i=c.parent.children.slice(c.getCurrentIndex()+1),n=c.parent.parent,c.promote(n),"Parent"===f?o.b7t(t,((n={})[s]=N(c.parentId),n)):"Level"===f?o.C7t(t):"ChildrenPath"===f&&o.Dkr()&&(r=o._kr(),(0,_.isNullOrUndefined)(r)||(e=c._data,u=o.Gjt().trim(),u=o.Yjt(u),a=[],(0,_.traversalTree)(((n={})[u]=r,n),{invoking:function(t,n){var i;if(e===t)return i=n[u].indexOf(t),n[u].splice(i,1),a[1]?a[1][u].push(t):r.splice(r.indexOf(n)+1,0,t),{cancel:!0};a.push(t)},invoked:function(){a.pop()}},j,u))),h=function(t){var n,n,n,i,i,r,e,u;t.parent=c,i=t.lp,"Parent"===f?o.b7t(i,((n={})[s]=c.id,n)):"Level"===f?o.b7t(i,((n={})[s]=t.level,n)):"ChildrenPath"===f&&o.Dkr()&&(i=o._kr(),(0,_.isNullOrUndefined)(i)||(r=c._data,e=t._data,u=o.Gjt().trim(),u=o.Yjt(u),(0,_.traversalTree)(((n={})[u]=i,n),{invoking:function(t,n){var i;if(e===t)return i=n[u].indexOf(t),n[u].splice(i,1),r[u]||(r[u]=[]),r[u].push(t),{cancel:!0}}},j,u)))},l=0,v=i;l<v.length;l++)h(d=v[l]);"Custom"===f&&o.g7t(t)}},D.prototype.S7t=function(t,n){this.T7t(t,n)},D.prototype.T7t=function(t,n,i){var n,n,n,n,r,e,u,o,s,i,r,i,c,f,a,h,l;this.isHierarchy()&&(n=!1!==n,u=(e=this).njt,o=e.Gjt(),t=i?t:e.s7t(t),i=(s=u[t]).getPrevSibling(),(0,_.isNullOrUndefined)(i)||(r=s.children.slice(),s.demote(i,n),i=e.Fjt(),n?"Parent"===i?e.b7t(t,((n={})[o]=N(s.parentId),n)):"Level"===i?e.C7t(t):"Custom"===i?e.g7t(t):"ChildrenPath"===i&&e.Dkr()&&(c=e._kr(),(0,_.isNullOrUndefined)(c)||(f=s._data,a=e.Gjt().trim(),a=e.Yjt(a),(0,_.traversalTree)(((n={})[a]=c,n),{invoking:function(t,n){var i,r;if(f===t)return i=n[a].indexOf(t),n[a].splice(i,1),(r=n[a][i-1][a])||(n[a][i-1][a]=r=[]),r.push(t),{cancel:!0}}},j,a))):"Parent"===i?(e.b7t(t,((n={})[o]=N(s.parentId),n)),r.forEach(function(t){var t;e.b7t(t.lp,((t={})[o]=N(s.parentId),t))})):"Level"===i?e.b7t(t,((n={})[o]=u[t].level,n)):"Custom"===i?e.g7t(t):"ChildrenPath"===i&&e.Dkr()&&(c=e._kr(),(0,_.isNullOrUndefined)(c)||(h=s._data,l=e.Gjt().trim(),l=e.Yjt(l),(0,_.traversalTree)(((r={})[l]=c,r),{invoking:function(t,n){var i,r,i;if(h===t)return r=n[l].indexOf(t),(i=n[l]).splice.apply(i,v([r,1],t[l],!1)),(i=n[l][r-1][l])||(n[l][r-1][l]=i=[]),i.push(t),t[l]=j,{cancel:!0}}},j,l)))))},D.prototype.b7t=function(t,n,i,r){this.A7t(t,n,i,r)},D.prototype.A7t=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n,x7t:!0,N7t:!0}),i&&i({type:y.UPDATE,success:!0})},D.prototype.C7t=function(t,n,i){for(var r,e,u,o,s,c,f,e=this,u=e.njt,o=e.Gjt(),s=u[t].getChildrenIndexes().concat(t),c=0;c<s.length;c++)f=s[c],e.b7t(f,((r={})[o]=u[f].level,r),n,i)},D.prototype.g7t=function(r,e,u){var o=this,s=!!(0,_.isNullOrUndefined)(r),c=o.Gjt();(0,_.traversalTree)(o.zjt,function(t){var n,i,n,t;(s=!1===s&&r===t.lp?!0:s)&&(n=t.lp,t=o.k7t(t),(0,_.isNullOrUndefined)(t)||o.b7t(n,((n={})[c]=t,n),e,u))})},D.prototype.k7t=function(t){var n,i,r,e,i,r,n=this,i=n.Gjt(),r=n.r7t(),e,i=t.data[i],r=null==r?void 0:r(n.D7t(t));if(i!==r)return r},D.prototype.D7t=function(t){var n={};return Object.defineProperty(n,"data",{get:function(){return t.data}}),Object.defineProperty(n,"index",{get:function(){return t.getCurrentIndex()}}),Object.defineProperty(n,"parentData",{get:function(){return t.parent.isRoot?m:t.parent.data}}),n},D.prototype._7t=function(t,n,i,r){var e=this,t=e.c7t(t);return e.E7t(t.parent,n?t.getCurrentIndex():t.getCurrentIndex()+1,i,r)},D.prototype.j7t=function(t){var n=this,t=n.c7t(t),i=t.getPrevSibling(),n,n=(0,_.isNullOrUndefined)(i)?n.v7t(!1,j,t.lp):n.v7t(!1,i.lp,t.lp);return{sequence:n,offset:0}},D.prototype.O7t=function(t,n,i){var r,e,n,r=this;return t=r.s7t(t),e=r.j7t(t).sequence,(n=r._7t(t,!0,n,i)).sequence=e,r.p7t(!1,t),n},D.prototype.R7t=function(t){var n=this,t=n.c7t(t),i=t.getNextSibling(),i,i=(0,_.isNullOrUndefined)(i)?n.v7t(!0,j,t.lp):n.v7t(!0,i.lp,t.lp);return{sequence:i,offset:n.B7t(t)}},D.prototype.L7t=function(t,n,i){var r,e,n,r=this;return t=r.s7t(t),e=r.R7t(t).sequence,(n=r._7t(t,!1,n,i)).sequence=e,r.p7t(!0,t),n},D.prototype.F7t=function(t,n){var i,r,n,i=this;return t=i.s7t(t),r=i.j7t(t).sequence,(n=i._7t(t,!0,n)).sequence=r,i.T7t(t,!0,!0),i.p7t(!1,t),n},D.prototype.P7t=function(t){var n,t,i,r,i,i,n=this,t=n.c7t(t),i=t.children,i=0<i.length?(i=i[i.length-1],r=n.v7t(!0,j,i.lp),n.B7t(t)):(r=n.v7t(!0,j,t.lp),1);return{sequence:r,offset:i}},D.prototype.G7t=function(t,n){var i,r,n,i=this;return t=i.s7t(t),r=i.P7t(t).sequence,(n=i._7t(t,!1,n)).sequence=r,i.U7t(i.njt.length-1),i.p7t(!0,t),n},D.prototype.U7t=function(t){var n,t,i,n,t=this.c7t(t),i=t.getPrevSibling();(0,_.isNullOrUndefined)(i)||t.demote(i)},D.prototype.E7t=function(t,n,i,r){var e,u,o,s,s,e,e=this,u=e.njt,o=e.o7t(),s=e.$jt(),s=new M(e.Zjt({idField:o,sequenceField:s})),e=e.vjt+1;return(0,_.isNullOrUndefined)(null==r?void 0:r.id)?(0,_.isNullOrUndefined)(i)||(0,_.isNullOrUndefined)(i[o])?s.id=F(e):s.id=i[o]:s.id=r.id,s.lp=e-1,s.setParent(t,n),u.push(s),s},D.prototype.oge=function(t,n){var i,r,i,i=this,r=this.f7t(),i=i.E7t(r,void 0,t,n);return i.sequence=1,i},D.prototype.H7t=function(t){var n,i,r,e,u,o,r,n,i,e=this,u=e.$jt(),o=e.Gjt(),r=e.Fjt();return"Parent"===r?((n={})[o]=N(t.parentId),n=n):"Level"===r?((i={})[o]=t.level,n=i):"Custom"===r&&(i=e.k7t(t),(0,_.isNullOrUndefined)(i)||((r={})[o]=i,n=r)),(0,_.isNullOrEmpty)(u)||((n=n||{})[u]=t.sjt()),n},D.prototype.z7t=function(t,n,i){var r,t,e,n,r=this,t=r.SEt(t);return n?(n=t.getNextSibling(),(0,_.isNullOrUndefined)(n)||(e=!1===i?n:t)):e=!1===i?t:t.getPrevSibling(),r.B7t(e)},D.prototype.B7t=function(t){var n,i,r,n=1,i=function(t){return t.children.reduce(function(t,n){return t+i(n)},t.children.length)};return(0,_.isNullOrUndefined)(t)?0:(r=i(t))+1},D.prototype.V7t=function(t){var n=this,t=n.SEt(t);return n.B7t(t)},D.prototype.Y7t=function(t){var n,i,i,n=this;n.isHierarchy()&&(i=n.o7t(),!(0,_.isNullOrUndefined)(i)&&w(t[i])&&(t[i]=j),"Parent"===n.Fjt())&&w(t[i=n.Gjt()])&&(t[i]=j)},D.prototype.Z7t=function(t,n){var i,r,i,e,u,o,s,r=this;r.isHierarchy()&&"Parent"===r.Fjt()&&(i=r.o7t(),(0,_.isNullOrUndefined)(i)||(u=(e=r.c7t(t)).children,o=e.id=e.JEt=r.Xjt(i,t),s=r.Gjt(),u.forEach(function(t){var t;t.XEt=o,r.b7t(t.lp,((t={})[s]=o,t))}),n&&(0,_.isNullOrEmpty)(n[s])&&!e.parent.isRoot&&!w(e.parentId)&&r.b7t(t,((i={})[s]=e.parentId,i))))},D.prototype.Tue=function(t){for(var n,i,r,e,u,n=[],i,r=0,e=(0,_.getObjectKeys)(t);r<e.length;r++)t[u=e[r]].spread&&n.push(u);return n},D.prototype.Aue=function(t,n,i){var r,e,u,o,s,c,f,a,h,l,v,r=(0,_.getObjectKeys)(t);if(0===r.length)return t;for(e={},u=0,o=r;u<o.length;u++)if(c=t[s=o[u]],0<=n.indexOf(s))for(f={},i&&(i[s]=f),l=a=(h=0,_.getObjectKeys)(c);h<l.length;h++)v=l[h],0<=r.indexOf(v)?(e[s+"_"+v]=c[v],i&&(f[s+"_"+v]=v)):(e[v]=c[v],i&&(f[v]=v));else e[s]=c,i&&(i[s]=s);return e},D.prototype.Iue=function(t,i){var r,n,n,e,r=this,n=r.LEt,n=n&&n.schema&&n.schema.columns;return t=n&&0<(e=r.Tue(n)).length?t.map(function(t,n){return r.Aue(t,e,0===n?i:j)}):t},D.prototype.xue=function(t){var n,i,i,i,n=this,i=n.LEt,i=i&&i.schema&&i.schema.columns;return t=i&&0<(i=n.Tue(i)).length?n.Aue(t,i):t},D.prototype.Nue=function(t,n){var i,r,e,u,o,s,c,f,a,h,l,i=(0,_.getObjectKeys)(n);if(0===i.length)return t;for(r={},e=0,u=i;e<u.length;e++)if("object"==typeof(s=n[o=u[e]]))for(r[o]=c={},h=f=(a=0,_.getObjectKeys)(s);a<h.length;a++)c[s[l=h[a]]]=t[l];else"string"==typeof s&&(r[o]=t[s]);return r},D.prototype.kue=function(t){var n,i,n=this,i=n.Due;return t=i?t&&n.Nue(t,i):t},D.prototype.hGe=function(t){var n,i,i,i,r,e,u,n=this,i=n.LEt,i=i&&i.schema&&i.schema.columns;if(i&&0<(i=n.Tue(i)).length&&n.Due)for(r=0,e=i;r<e.length;r++)if(u=e[r],n.Due[u][t])return!0},D.prototype.load=function(f){var a,n,t,h,a=this,n=a.options.remote;return n&&n.read&&!(0,_.isFunction)(n.read)&&(0,_.isNullOrEmpty)(n.read.url)?(a.ki(b,{type:"read",success:!(t="InvalidRemoteOption"),reason:t}),Promise.resolve([])):(h=a.W7t(f),a.yjt(h)?(a.ojt=!0,a.Q7t(h).then(function(t){var t={type:"read",data:n&&n.read&&!(0,_.isFunction)(n.read)?q(n.read.adapter,t):t};return a.ki(C,t)?Promise.reject({cancel:!0,type:"read",step:l}):a.djt.parse(t.data)}).then(function(t){return a.wjt=a.djt.total(t),a.djt.read(t)}).then(function(t){var n,i,r,e,u,o,s,c;if(f&&f.convert&&(t=f.convert(t)),a._data=(!f||!f.reload)&&a._data||{},a.vjt=a.vjt||0,a.DEt=(!f||!f.reload)&&a.DEt||[],t){for(t=(0,_.isArray)(t)?t:[t],t=a.qjt(t),a.Due={},t=a.Iue(t,a.Due),n=0,r=(i=a.Bjt())[0],e=i[1],u=0,o=t.length;u<o;u++)for(s in t[u])c=t[u][s],s=r[s]||s,a._data[s]||(a._data[s]={data:[]},a.DEt.push(s)),a._data[s].data[0+u]=a.Ajt(c,e[s]);a.wjt=a.vjt=0+t.length,a.zFe(a.DEt),t=a.K7t(h).data,a.ki(y.ONCHANGE,{action:y.INSERT,index:0,items:t})}return a.wjt=a.vjt,a.ki(b,{type:"read",success:!0,items:t}),t}).then(function(n){return a.KFe()?a.Q7t(h,y.GET_COLUMNS).then(function(t){return(0,_.isArray)(t)&&a.zFe(t),n}):n}).catch(function(t){return Promise.reject(a.rUr(t))})):Promise.resolve(a.K7t(h).data))},D.prototype.rUr=function(t){var n,t,n=this,t=t&&!0===t.cancel?S+t.step:n.J7t(t);return n.ki(b,{type:"read",success:!1,reason:t}),t},D.prototype.H3e=function(t){var t,n,i,r,e,u,o,s,n=this,i=function(t){n._data[t]||(n._data[t]={data:[]},n.DEt.push(t))};if(t)for(r=0,e=t;r<e.length;r++)i(u=e[r]);else if(o=null==(t=n.options.schema)?void 0:t.columns)for(s in o)o[s].spread||"formula"===o[s].dataType||i(s)},D.prototype.$ue=function(t,n){for(var i,r,e,u,o,s,c,f,a,i=[],r=0,e=n.fields;r<e.length;r++)for(s=0,c=o=t[u=e[r]].data;s<c.length;s++)f=c[s],(a={})[n.as]=u,a[n.valueAs]=f,i.push(a);return i},D.prototype.AP=function(t){for(var n,i,r,e,u,o,s,c,n=[],i,r=0,e=Object.keys(t);r<e.length;r++)for(s=(o=t[u=e[r]]).data||o,c=0;c<s.length;c++)n[c]||(n[c]={}),n[c][u]=s[c];return n},D.prototype.loadSync=function(t,n,i){var r,e,n,u,i,o,s,c,f,a,h,r=this;if(r.ojt=!0,e=(0,_.isNullOrUndefined)(t)?n?r.AP(i||r._data):i||(n=r.hjt.getDataSync(),r.wjt=r.djt.total(n),r.djt.readSync(n)):r.$ue(r._data,t),r._data={},r.vjt=0,r.DEt=[],e){for(e=(0,_.isArray)(e)?e:[e],e=r.qjt(e),r.Due={},e=r.Iue(e,r.Due),u=0,o=(i=r.Bjt())[0],s=i[1],c=0,f=e.length;c<f;c++)for(a in e[c])h=e[c][a],a=o[a]||a,r._data[a]||(r._data[a]={data:[]},r.DEt.push(a)),r._data[a].data[0+c]=r.Ajt(h,s[a]);return r.vjt=0+e.length,r.wjt=r.vjt,r.zFe(r.DEt),e=r.K7t().data}return[]},D.prototype.length=function(){return"number"==typeof this.wjt?this.wjt:this.vjt},D.prototype.setLength=function(t){var n=this,i=n._data,n=n.wjt;(0,_.isNullOrUndefined)(n)?i&&(this.vjt=t):this.wjt=t},D.prototype.K7t=function(t){var n,i,r,e,u,o,s,n=this,i=n.X7t(),r=0,e=n.vjt,u=i?n.s7t(0):0,o=n.q7t||[];for(i||(o=[]),s=[];0<e&&u<n.vjt;)o[u]||(s.push(n.bjt(u)),e--),u++;return{data:s}},D.prototype.zIr=function(){var t,n,i,r,e,u,o,s,c,t=this,n=t.X7t(),i={},r=t._data;if(n){for(u in e=t.q7t||[],r)if(r.hasOwnProperty(u)){for(o=r[u].data,s=0,c=[];s<t.vjt;)e[s]||c.push(o[s]),s++;i[u]=c}}else for(u in r)r.hasOwnProperty(u)&&(i[u]=r[u].data.slice());return i},D.prototype.$7t=function(t,n){var i,r,e,u,o,s,c,f,a,h,l,i=this,r=i.X7t(),e=0,u=i.vjt,o=r?i.s7t(0):0,s=i.q7t||[];if(0===(s=r?s:[]).length){for(c=[],f=0;f<t.length;f++)c[a=t[f]]=i.bjt(a);return{data:c}}for(h=[],l=0;0<u&&o<i.vjt;)s[o]||(-1<t.indexOf(l)&&(h[l]=i.bjt(o)),l++,u--),o++;return{data:h}},D.prototype.tOt=function(t){return(t?this.$7t(t):this.K7t()).data},D.prototype.nOt=function(t,n){var i,r,i,r,i,e,u,o,s,c,r=this,i=r.Fjt(),e=[];if(!(0,_.isNullOrUndefined)(n)&&t.length===n.length)if("Level"===i)for(u=0;u<t.length;u++)o=t[u],e.push(T(o,n[u]));else"ChildrenPath"===i&&(s=r.Yjt(r.Gjt()),c=[((i={})[s]=e,i)],R(((r={})[s]=t,r),((i={})[s]=n,i),s,function(t,n){var t,n,t=T(t,n);delete t[s],n=c[c.length-1],(0,_.isArray)(n[s])||(n[s]=[]),n[s].push(t),c.push(t)},function(){c.pop()}));return e},D.prototype.eOt=function(t){var n,i,r,e,r,u,o,n,s,c,f,a,h,i,l,v,i,e=this,r=e.Fjt();if(!(0,_.isNullOrUndefined)(t)){if(u=e.f7t(),s=e.Gjt(),"Level"===r){for(o="children",f=e.Yjt(s),(n={})[o]=[],n.data={},a=[n=n],h=0;h<t.length;h++){for(l=(i=t[h])[f],v=a[a.length-1];v.data.level>=l;)a.pop(),v=a[a.length-1];(i={data:i})[o]=[],i=i,v[o].push(i),a.push(i)}c=function(t){return t.data}}else"ChildrenPath"===r&&((r={})[o=s]=t,n=r,c=function(t){return t});R(u,n,{childrenField2:o},function(t,n){e._jt(c(n)),e.pjt(t.lp,c(n))})}},D.prototype.iOt=function(i,r,e,n){var u=this;return u.rOt({body:i},r).then(function(t){var n,t,t,n="batch"===r,t={type:r,batch:n,data:u.nOt(i,t)};return u.ki(C,t)?Promise.reject({cancel:!0,type:r,batch:n,step:C}):(i=t.data,u.eOt(i),t={type:r,success:!0,batch:n,items:(0,_.isArray)(i)?i:[i]},delete u.oOt,delete u.q7t,delete u.aOt,delete u.uOt,e&&e(t),u.ki(b,t),n?Promise.resolve(u.K7t()):j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?S+t.step:u.J7t(t),t={type:r,success:!1,reason:t};u.ki(O,{type:t}),n&&n(t)})},D.prototype.sOt=function(){var t,t,t=this;if(t.isHierarchy())return"Level"===(t=t.Fjt())||"ChildrenPath"===t},D.prototype.cOt=function(i,r,t,n){var e,u,e,o,s,c,f,a,h,u=this,e=u.Fjt();return r=r||u.q7t||[],"Level"===e?(o=u.f7t(),s=[],(0,_.traversalTree)(o,function(t){var t,n,t=t.lp;r[t]||(n=u.bjt(t),("create"===i||"batch"===i&&u.isInserted(t,!0))&&u.Y7t(n),n=u.jjt(n),s.push(n))}),u.iOt(s,i,t,n)):"ChildrenPath"===e?(o=u.f7t(),c=u.Gjt(),f=u.Yjt(c),h=[((e={})[f]=a=[],e)],(0,_.traversalTree)(o,{invoking:function(t){var t,n,t,t=t.lp;r[t]||(n=u.bjt(t),("create"===i||"batch"===i&&u.isInserted(t,!0))&&u.Y7t(n),delete n[c],n=u.jjt(n),0<h.length&&(t=h[h.length-1],(0,_.isArray)(t[f])||(t[f]=[]),t[f].push(n)),h.push(n))},invoked:function(t){r[t.lp]||h.pop()}}),u.iOt(a,i,t,n)):Promise.resolve(void 0)},D.prototype.fOt=function(){var t,n,i,r,e,u,o,t,s,c,f,a,r,n=this;if(n.isHierarchy()){for(i=n.njt,r=n.f7t(),e=i.reduce(function(t,n){return(t[n.JEt]=n).id=n.JEt,n.sequence=n.$Et,n.parent=m,t},((t={})[r.JEt]=r,t)),u=0;u<i.length;u++)n.isInserted(u,!0)||((o=i[u]).parent=e[o.XEt]);if(t=n.options.schema.hierarchy.levelOffset||0,r.level=t-1,"Level"===n.Fjt()){for(s=n.Gjt(),c=j,u=0;u<i.length&&!n.isInserted(u,!0);u++)a=void 0,((a=(f=n.lOt(u))?f[s]:n.Xjt(s,u))<c||c===j)&&(c=a);r.level=c+t-1}n.njt=[],r=!(0,_.isNullOrEmpty)(n.$jt()),n.Hjt(r)}},D.prototype.dGe=function(t){var n,i,t,n=this,i=t.column;return delete n.LEt.schema.columns[i.name],(0,_.isNamedFormulaColumn)(i)?-1:(delete n._data[i.name],-1<(t=n.DEt.findIndex(function(t){return t===i.name}))&&n.DEt.splice(t,1),t)},D.prototype.vGe=function(t,n){var i=this,r=t.originalColumn||t.column,t=t.originalColumnData;i.LEt.schema.columns[r.name]=(0,_.clone)(r,!0),(0,_.isNamedFormulaColumn)(r)||(i._data[r.name]={data:t.slice()},-1===i.DEt.findIndex(function(t){return t===r.name})&&((0,_.isNumber)(n)?i.DEt.splice(n,0,r.name):i.DEt.push(r.name)))},D.prototype.mGe=function(t){var n,i,n=this,i=n.dGe(t);n.vGe(t,i)},D.prototype.gGe=function(t){var n=this;switch(t.status){case 1:n.dGe(t);break;case 2:n.mGe(t);break;case 3:n.vGe(t)}},D.prototype.cancelChanges=function(){var i,t,n,r,e,u,o,s,c,i=this;if(i.hasColumnChanges())for(t=0,n=i.HFe;t<n.length;t++)r=n[t],i.gGe(r);(e=i.getHeldActions())&&0!==e.length&&(i.fOt(),i.t7t(),u=i.aOt,o=i.q7t||[],s=i.oOt||[],c=[],(0,_.forEach)(e,function(t){var n=t.sourceIndex,t=t.type;t===y.UPDATE?(i.pjt(n,u[n]),s[n]=[!!s[n]&&s[n][0],!1]):t===y.DELETE?(o[n]=j,s[n]&&s[n][0]?c.push(n):s[n]&&s[n][1]&&(i.pjt(n,u[n]),s[n]=[!1,!1]),(0,_.isNullOrUndefined)(i.wjt)||(i.wjt+=1)):t===y.INSERT&&c.push(n)}),(0,_.forEachRight)(c,function(t){i.mjt(t,1),s.splice(t,1),(0,_.isNullOrUndefined)(i.wjt)||--i.wjt}),i.clearBatchCache_())},D.prototype.getChanges=function(){var t=this.getColumnChanges(),n=this.hOt(!1);return t&&0<t.length?t.concat(n):n},D.prototype.isDataLengthChanged=function(){return this.getChanges().some(function(t){return"delete"===t.type||"insert"===t.type})},D.prototype.pGe=function(){for(var t,n,i,r,t=this,n=0;n<t.HFe.length;n++)(r=(i=t.HFe[n]).originalColumn||i.column)&&("formula"===r.dataType||r.ZFe)&&(t.HFe[n]={key:i.key})},D.prototype.submitChanges=function(s,c){var f,n,a,h,l,v,d,p,w,b,t,f=this;return f.hasCachedActions()||f.hasColumnChanges(!0)?f.sOt()?(n=(f.q7t||[]).slice(),f.cOt("batch",j,function(){for(var t=f.vjt-1;0<=t;t--)!0===n[t]&&(f.mjt(t,1),f.njt[t].parent=m,f.njt.splice(t,1));f.njt.forEach(function(t,n){t.lp=n})})):(a=f.aOt,h=f.q7t||[],l=f.oOt||[],v=f.getHeldActions(),d=[],p=y.UPDATE,(0,_.isNullOrUndefined)(v)||v.forEach(function(t){t.dataItem=f.kue(f.jjt(t.dataItem)),t.oldDataItem=f.kue(f.jjt(t.oldDataItem))}),v=v||[],w=f.getColumnChanges(!0),t=(b=w&&0<w.length)?w.concat(v):v,f.rOt({body:t},"batch").then(function(t){var n,n,i,u,r,e,o,n=b&&t,n={type:p,batch:!0,data:n?t.slice(w.length):t,columns:n?t.slice(0,w.length):j};return f.ki(C,n)?Promise.reject({cancel:!0,type:p,batch:!0,step:C}):(((i=n.data)||[]).forEach(function(t){t.succeed&&t.data&&(f._jt(t.data),t.data=f.xue(t.data))}),i.length,v.length,u=[],(0,_.forEach)(v,function(t,n){var n=i[n];n.succeed?t.type===y.UPDATE?(a&&(a[t.sourceIndex]=j),l[t.sourceIndex][1]=j):t.type===y.INSERT?(n.data&&(f.pjt(t.sourceIndex,n.data),f.Z7t(t.sourceIndex,n.data)),l[t.sourceIndex]=[],a[t.sourceIndex]=j):t.type===y.DELETE&&d.push(t.sourceIndex):u.push({localAction:t,response:n})}),(0,_.forEachRight)(d,function(t){var n,i,r,e;for(h.splice(t,1),f.mjt(t,1),a&&a.splice(t,1),l.splice(t,1),f.isHierarchy()&&(f.njt[t].parent=m,f.njt.splice(t,1)),n=0,i=u;n<i.length;n++)t<(e=(r=i[n]).localAction.sourceIndex)&&r.localAction.sourceIndex--}),f.isHierarchy()&&f.njt.forEach(function(t,n){t.lp=n}),0<u.length?(r={type:p,errorData:u},f.ki(O,{type:r})||(f.uOt=[],(0,_.forEach)(u,function(t,n){var i=t.response,t=t.localAction,r=t.sourceIndex;t.type===y.DELETE&&(h[r]=j,(0,_.isNullOrUndefined)(f.wjt)||(f.wjt+=1)),f.dOt(r,{type:t.type,success:!1,reason:i.reason}),s(r,i.reason,t.type)}))):delete f.uOt,f.pGe(),e=[],o=n.columns,(0,_.forEach)(w,function(n,t){var t,i,t=o[t];t.succeed?-1<(i=f.HFe.findIndex(function(t){return t.key===n.column.Kyn}))&&(n.type===y.REMOVE_COLUMN?f.HFe.splice(i,1):f.HFe[i]={key:f.HFe[i].key}):e.push({change:n,response:t})}),0<e.length?(r={type:p,errorColumns:e},f.ki(O,{type:r})||(f.bGe={},(0,_.forEach)(e,function(t){var n,i,t,r,n=t.response,i=t.change,t=i.name;i.type===y.REMOVE_COLUMN&&-1<(r=f.HFe.findIndex(function(t){return t.key===i.column.Kyn}))&&(f.vGe(f.HFe[r]),f.HFe[r]={key:f.HFe[r].key}),f.wGe(t,{type:i.type,success:!1,reason:n.reason}),c(t,n.reason,i.type)}))):delete f.bGe,Promise.resolve(f.K7t()))}).catch(function(t){var t,n,t=t&&!0===t.cancel?S+t.step:f.J7t(t),n;f.ki(O,{type:{type:p,reason:t}})})):(f.pGe(),Promise.resolve(void 0))},D.prototype.getColumnChanges=function(n){var i,r,e,t,i=this;return i.hasColumnChanges(n)?(r=function(t){return n?g(g({},t.column),{Kyn:t.key,field:t.column.dataName||t.column.value}):g({},t.column)},e=function(t){return n?g(g({},t.originalColumn),{Kyn:t.key,field:t.originalColumn.dataName||t.originalColumn.value}):g({},t.originalColumn)},t=i.HFe,(t=n?i.HFe.filter(function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.ZFe}):t).reduce(function(t,n){switch(n.status){case 1:t.push({type:y.ADD_COLUMN,column:r(n),data:i.EQe(n.column,n.originalColumnData)});break;case 2:t.push({type:y.UPDATE_COLUMN,column:r(n),originalColumn:e(n)});break;case 3:t.push({type:y.REMOVE_COLUMN,column:e(n)})}return t},[])):m},D.prototype.getHeldActions=function(){var t=this;return t.hasCachedActions()?t.hOt(!0):m},D.prototype.hOt=function(t){for(var n,i,r,e,u,o,s,c,f,a,h,l,o,o,n=this,i=[],r=n.oOt||[],e=n.q7t||[],u=n.aOt,c=n.isHierarchy(),f=0;f<n.vjt;f++){if(o=r[f],!(s=null)===e[f])s={type:y.DELETE,dataItem:n.bjt(f)};else if(o&&o[0])s={type:y.INSERT,dataItem:n.bjt(f)},t&&c&&n.Y7t(s.dataItem);else if(o&&o[1]){if(a=u[f],h=n.bjt(f),!t)for(l in a=g({},a))a.hasOwnProperty(l)&&a[l]===h[l]&&(delete a[l],delete h[l]);s={type:y.UPDATE,dataItem:h,oldDataItem:a}}s&&(c&&s.type===y.INSERT&&w((o=n.c7t(f).parent).id)&&(o=o.isRoot?j:o.lp,t?s.sourceParentIndex=o:s.parentIndex=(0,_.isNumber)(o)?n.TEt(o):j),t?s.sourceIndex=f:s.index=this.TEt(f),i.push(s))}return i},D.prototype.clearBatchCache_=function(){var i,t,i=this,t=this;delete t.q7t,delete t.aOt,delete t.uOt,t.HFe=t.HFe.reduce(function(t,n){return 1!==n.status&&t.push({key:i.QFe()}),t},[])},D.prototype.hasColumnChanges=function(t){var n=this;return!!n.X7t()&&(t?n.HFe.some(function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.ZFe}):n.HFe.some(function(t){return t.status}))},D.prototype.hasCachedActions=function(){var t,n,t,i,r,e,u,o,s,t=this;if(t.X7t()&&(n=t.oOt,t=t.q7t,n||t)){if(t)for(i=0,r=t;i<r.length;i++)if(e=r[i])return!0;if(n)for(u=0,o=n;u<o.length;u++)if((s=o[u])&&(!0===s[0]||!0===s[1]))return!0}return!1},D.prototype.bind=function(t,n){var i,r,e,u,o,s,c,i=this;if(n)for(u=r=(e=0,_.isArray)(t)?t:[t];e<u.length;e++)o=u[e],(s=(0,_.isFunction)(n)?n:n[o])&&(c=i._events[o]=i._events[o]||new f.Event).addHandler(s,i)},D.prototype.unbind=function(t,n){var i,t,i=this;(0,_.isNullOrUndefined)(t)?((0,_.forEach)(i._events,function(t){t.removeAllHandlers()}),i._events={}):(t=i._events[t])&&(n?t.removeHandler(n,i):t.removeAllHandlers())},D.prototype.ki=function(t,n){var i,r,i=this,r=i._events[t];return!!r&&((n=n||{}).cancel=!1,n.eventName=t,r.raise(i,n),n.cancel)},D.prototype.vOt=function(t){var n=this;return n._events.hasOwnProperty(t)&&n._events[t].hasHandlers},D.prototype.W7t=function(t){return t=g({},t)},D.prototype.mOt=function(t){return t},D.prototype.getDirtyIndexes=function(){var t,n=this.oOt||[];return(0,_.getObjectKeys)(n).map(function(t){return parseInt(t,10)})},D.prototype.gOt=function(t,n){var i=this,r;return(i.oOt||[])[t=n?t:i.s7t(t)]||[]},D.prototype.isInserted=function(t,n){return this.gOt(t,n)[0]},D.prototype.isUpdated=function(t){return this.gOt(t)[1]},D.prototype.getErrorInfo=function(t){var n=this,i=n.uOt;if(!(0,_.isNullOrUndefined)(i))return i[t=n.s7t(t)]},D.prototype.dOt=function(t,n){var i=this,r;(i.uOt=i.uOt||[])[t]=n},D.prototype.wGe=function(t,n){var i=this,r;(i.bGe=i.bGe||{})[t]=n},D.prototype.pOt=function(){this.oOt=j,this.q7t=j,this.aOt=j,this.uOt=j},D.prototype.lOt=function(t){var n=this,i;return(n.aOt=n.aOt||[])[t]},D.prototype.insertItem=function(t,n,i,r,e){var u,t,e,u=this,t=u.s7t(t),e=(0,_.isNumber)(e)?u.s7t(e):e;u.I7t({action:y.INSERT,index:t,item:n,N7t:!0,Ekr:e}),u.isHierarchy()&&"Custom"===u.Fjt()&&u.g7t(t),i&&i({type:y.CREATE,success:!0})},D.prototype.recoverItemAtBatch=function(t,n,i,r){var e=this;e.X7t()&&this.BEe(t)?(e.I7t({action:y.RECOVER_DELETE,index:t,item:n,N7t:!0}),i&&i({type:y.CREATE,success:!0})):this.insertItem(t,n,i,r)},D.prototype.BEe=function(t){var n;return!(null==(n=this.q7t)||!n[t])},D.prototype.updateItem=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n}),i&&i({type:y.UPDATE,success:!0})},D.prototype.updateItemValues=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n,x7t:!0}),i&&i({type:y.UPDATE,success:!0})},D.prototype.resetItem=function(t,n,i){var r,e,u,r=this,e,u=(r.aOt=r.aOt||[])[t=r.s7t(t)];r.isHierarchy()&&(u=r.bOt(t,u)),r.pjt(t,u),r.clearChangedStatus(t),r.dOt(t),n&&n({type:y.UPDATE,success:!0})},D.prototype.bOt=function(t,n){var i,r,t,e,u,i,o,i=this,r;return i.isHierarchy()?(t=i.bjt(t),e=i.Fjt(),u=i.Gjt(),i=i.$jt(),o=g({},n),"Parent"!==e&&"Level"!==e&&"Custom"!==e||(o[u]=t[u]),(0,_.isNullOrEmpty)(i)||(o[i]=t[i]),o):n},D.prototype.saveItem=function(t,n,i){var r,e,u,o,s,c,u,f,r=this;t=r.s7t(t),o=(u=(e=r.oOt||[])[t]||[])[0],s=u[1],0<u.length&&(o||s)&&(r.isHierarchy()&&(f=!(u=(c=r.njt)[t].parent).isRoot&&e[u.lp]&&e[u.lp][0])?i&&i({type:y.CREATE,success:!1}):r.yOt(t,r.bjt(t),o?y.INSERT:y.UPDATE,n,i))},D.prototype.yOt=function(n,i,t,r,e){var u=this,t=t===y.INSERT,o=t?y.CREATE:y.UPDATE,s=u.X7t(),c=u.wOt(o),f=u.MOt();s||!c||f?(f&&(u.oOt[n]=[],u.aOt[n]=j),r&&r({type:o,success:!0})):u.sOt()?u.cOt(t?y.CREATE:y.UPDATE,j,r,e):(t&&u.Y7t(i),i=u.jjt(i),i=u.kue(i),u.rOt({body:i},t?y.CREATE:y.UPDATE).then(function(t){var t,t,t={type:o,data:T(i,t)};return u.ki(C,t)?Promise.reject({cancel:!0,type:o,step:C}):(u._jt(t.data),t.data=u.xue(t.data),u.pjt(n,t.data),u.oOt[n]=[],u.aOt[n]=j,u.dOt(n),t={type:o,success:!0,items:[t.data]},o===y.CREATE&&u.Z7t(n),r&&r(t),u.ki(b,t),j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?S+t.step:u.J7t(t),t={type:o,success:!1,reason:t};u.dOt(n,t),u.ki(O,{type:t}),e(t)}))},D.prototype.I7t=function(t){var n,i,r,e,u,o,s,c,f,a,h,l,i,h,n=this,i=n.X7t(),r=n.aOt=n.aOt||[];i&&(e=n.q7t=n.q7t||[]),u=t.action,o=t.index,s=t.item,c=t.x7t,o=(f=t.N7t)?o:n.s7t(o),a=this.TEt(o),n.oOt=n.oOt||[],h=n.oOt,u===y.INSERT?(0===n.vjt&&0===n.DEt.length&&n.COt(),n.vjt<o&&(n.vjt=o),(0,_.isNullOrUndefined)(l=o)&&(l=n.vjt),n.mjt(l,0,s),r.length>=o?r.splice(o,0,g({},s)):r[o]=g({},s),i&&(e.length>=o?e.splice(o,0,j):e[o]=j),h.length>=o?h.splice(o,0,[!0]):h[o]=[!0],(0,_.isNullOrUndefined)(n.wjt)||(n.wjt+=1),n.Rkr(l,s,t.Ekr),n.ki(y.ONCHANGE,{action:u,index:o,items:[t.item],modelIndex:a})):u===y.UPDATE?(i=n.bjt(o),r[o]||(r[o]=g({},i)),n.pjt(o,s,c),n.oOt[o]?n.oOt[o]=[n.oOt[o][0],!0]:n.oOt[o]=[!1,!0],I(g(g({},i),s),r[o])&&n.clearChangedStatus(o),n.Fkr(o,s),n.ki(y.ONCHANGE,{action:u,index:o,items:[t.item],oldItems:[i],modelIndex:a})):u===y.RECOVER_DELETE&&e&&(h=!!e[o],delete e[o],h)&&this.setLength(this.length()+1)},D.prototype.clearChangedStatus=function(t){var n=this;!(n.oOt[t][1]=!1)!==n.oOt[t][0]&&(n.aOt[t]=j)},D.prototype.Rkr=function(t,n,i){this.Bkr(t,0,n,i)},D.prototype.Fkr=function(t,n){this.Bkr(t,1,n)},D.prototype._kr=function(){var t,t,n,t,i,t=this,n=t.LEt.data,t=null==(t=t.LEt.schema)?void 0:t.dataPath;if((0,_.isString)(t)||(0,_.isNullOrEmpty)(t)){if((0,_.isNullOrEmpty)(t))i=n;else if(i=t.split(".").reduce(function(t,n){return(0,_.isNullOrEmpty)(t)||(0,_.isNullOrEmpty)(t[n])?j:t[n]},n),(0,_.isNullOrUndefined)(i))return;return i}},D.prototype.Bkr=function(e,u,o,t){var t,n,s,i,r,c,f,n,a,h,l,t,v,d,s=this;if(s.Dkr()&&(i=s._kr(),r=s.isHierarchy(),!(0,_.isNullOrUndefined)(i))){if(c=e,f=function(t,n,i){var r,e,u,e=s.jjt(((r={})[n]=t[n],r),{isPartial:!0});for(u in e)e.hasOwnProperty(u)&&i(u,e[u])},r){if(n=s.Fjt(),a=s.c7t(null!=t?t:e)._data,"ChildrenPath"===n)return h=s.Gjt().trim(),h=s.Yjt(h),void(0,_.traversalTree)(((t={})[h]=i,t),{invoking:function(t,i){var r,t,n;if(a===t){if(r=i[h].indexOf(t),o)if(0===u)t=s.jjt(o),s.c7t(e)._data=t,i[h].splice(r,u,t);else for(n in s._data)o.hasOwnProperty(n)&&f(o,n,function(t,n){i[h][r][t]=n});else i[h].splice(r,u);return{cancel:!0}}}},j,h);c=i.findIndex(function(t){return t===a})}if("json"===(l=(null==(n=s.LEt.schema)?void 0:n.type)||"json"))if(o)if(0===u)t=s.jjt(o),r&&(s.c7t(e)._data=t),i.splice(c,u,t);else for(v in s._data)o.hasOwnProperty(v)&&f(o,v,function(t,n){i[c][t]=n});else i.splice(c,u);else for(d in s._data)s._data.hasOwnProperty(d)&&(o?0===u?f(o,d,function(t,n){i[t].splice(c,u,n)}):o.hasOwnProperty(d)&&f(o,d,function(t,n){i[t][c]=n}):i[d].splice(c,u))}},D.prototype.Pkr=function(t,n){var i,r,e,i,i,u,o,s,c,f,a,h,l,v,d,p,w,r=this;if(r.Dkr()&&(e=r._kr(),i=r.isHierarchy(),!((0,_.isNullOrUndefined)(e)||i&&(0,_.isNullOrEmpty)(r.o7t())))){if(i){if(i=r.o7t(),u=r.Yjt(i),o=r.Fjt(),s=r.getFieldValue(i,t),c=r.getFieldValue(i,n),"ChildrenPath"===o)return f=r.Gjt().trim(),f=r.Yjt(f),a=r.bjt(t),void(l=h=!1,_.traversalTree)(((i={})[f]=e,i),{invoking:function(t,n){var i,r,r,i=t[u];if(c===i?(r=n[f].indexOf(t),n.splice(r,0,a),h=!0):s===i&&(r=n[f].indexOf(t),n.splice(r,0),l=!0),h&&l)return{cancel:!0}}},j,f);for(d=v=!1,p=0;p<e.length&&((w=e[p][u])===s&&(t=p,v=!0),w===c&&(n=p,d=!0),!d||!v);p++);}e.splice(n-(n<t?0:1),0,e.splice(t,1)[0])}},D.prototype.get=function(t){var n,i,r,e,u,o,n=this,i=n._data;if(t=n.s7t(t),i&&t<n.vjt){for(r={},e=0,u=n.DEt;e<u.length;e++)r[o=u[e]]=i[o].data[t];return r}return j},D.prototype.Xjt=function(t,n){var i=this,r=i._data;return r&&r[t]&&n<i.vjt?r[t].data[n]:j},D.prototype.fGe=function(t){var n,i=this._data;return i&&i[t]?i[t].data:[]},D.prototype.getFieldValue=function(t,n){var i=this,r=i._data;return n=i.s7t(n),r&&r[t]&&n<i.vjt?r[t].data[n]:j},D.prototype.getFieldOriginalValue=function(t,n){var i,r,i,i=this,r=i._data;return n=i.s7t(n),r&&r[t]&&n<i.vjt?(i=i.lOt(n),(0,_.isNullOrUndefined)(i)?r[t].data[n]:i[t]):j},D.prototype.yGe=function(t){for(var n,i,r,e,u,n=this,i=n.length(),r=n.fGe(t),e=0;e<i;e++)if(u=r[e],!(0,_.isNullOrUndefined)(u))return u},D.prototype.MGe=function(t){var t,n,t=this.yGe(t),n=typeof t;return"object"==n&&t instanceof Date?"date":n},D.prototype.eTe=function(t){var n,i,r,e,u,o,s,n=this,i=n.s7t(t),r=n.lOt(i),e=n._data,o={};for(s in e)e.hasOwnProperty(s)&&(o[s]=u=e[s].data[i],(0,_.isUndefined)(u))&&(o[s]=r[s]);return o},D.prototype.SOt=function(t,n,i,r,e){var u,t,u=this,t=u.QAr(t,n,i);u.JAr(t,r,e)},D.prototype.JAr=function(t,h,n){var r,t,r=this;t.sort(function(t,n){return n-t}),t=t.map(function(i){return function(t,n){r.KAr(i,t,n)}}),(0,_.promiseSerialExecute)(t).then(function(t){for(var n,i,r,e,u,o,s,c,f,a,n=0,i=[],r={},e=0,u=t;e<u.length;e++){for(n+=(o=u[e]).removedCount||0,c=0,f=s=o.removingIndexes||[];c<f.length;c++)a=f[c],i.push(a);r=g(g({},r),o)}r.removedCount=n,r.removingIndexes=i,h&&h(r)}).catch(n)},D.prototype.QAr=function(t,n,i){var r,e,u,o,s,c,f,a,h,r=this,e=[];if(i&&0<i.length){for(u={},o=0;o<i.length;o++)s=r.SEt(i[o]),u[s.id]=!0;for(c=function(t){return!u[t.parentId]&&(!t.parent||c(t.parent))},o=0;o<i.length;o++)f=i[o],s=r.SEt(f),c(s)&&e.push(f)}else for(a=n,o=0;o<n;o++){if(!((h=(s=r.SEt(f=t+o)).getChildrenCount())+1<a)){e.push(f);break}a-=h+1,e.push(f),o+=h}return e},D.prototype.KAr=function(t,n,i){var u,r,e,o,s,c,f,a,h,l,c,u=this,r;u.X7t()||!u.wOt(y.DELETE)||u.MOt()||u.isInserted(t)||!u.sOt()?u.isHierarchy()&&(t=u.s7t(t),e=u.c7t(t),a=e.getChildrenIndexes(!0).concat(t),h=a.map(function(t){return u.TEt(t)}),l=v([],a,!0),c=a.map(function(r,e){return function(t,n){for(var i=e;i<a.length;i++)a[i]>r&&a[i]--;u.TOt(a[e],1,t,n)}}),(0,_.promiseSerialExecute)(c).then(function(t){u.X7t()||(l.sort(function(t,n){return n-t}),l.forEach(function(t){u.tX(t,1,!1)}),u.njt.forEach(function(t,n){t.lp=n})),"Custom"===u.Fjt()&&u.g7t();var t=t[t.length-1];t.removedCount=l.length,t.removingIndexes=h,n&&n(t)}).catch(function(t){i&&i(t)})):(t=u.s7t(t),e=u.c7t(t),o=e.getChildrenIndexes(!0).concat(t),s=o.map(function(t){return u.TEt(t)}),c=o.reduce(function(t,n){return t[n]=!0,t},[]),u.bind(C,f=function(){o.forEach(function(t){u.tX(t,1,!1)}),u.njt.forEach(function(t,n){t.lp=n})}),u.cOt(y.DELETE,c,function(t){u.unbind(C,f),t.removedCount=o.length,t.removingIndexes=s,n&&n(t)},function(t){u.unbind(C,f),i&&i(t)}))},D.prototype.removeItems=function(t,n,i){var r=this;t.sort(function(t,n){return n-t}),r.isHierarchy()?r.SOt(j,j,t,n,i):r.XAr(t,n,i)},D.prototype.remove=function(t,n,i,r){var e=this;e.isHierarchy()?e.SOt(t,n,j,i,r):e.TOt(t,n,i,r)},D.prototype.TOt=function(t,n,i,r){this.qAr(t,n,j,i,r)},D.prototype.XAr=function(t,n,i){this.qAr(j,j,t,n,i)},D.prototype.qAr=function(s,c,f,a,u){var h,l,v,d,t,n,i,r,p,e,o,w,h=this,l=f&&0<f.length,v=h.X7t();if(!l&&(s<0||s>=(v?h.vjt:h.length())))u&&u({type:y.DELETE,success:!1,reason:"Out of Boundary"});else if(d=y.DELETE,v||!h.wOt(y.DELETE)||h.MOt()||h.isInserted(s)){if(v||!h.isHierarchy())if(l)for(t=0,n=f;t<n.length;t++)i=n[t],h.tX(i,1);else h.tX(s,c);r={type:d,success:!0},a&&a(r)}else{if(l){if(!(0<(e=f.filter(function(t){return!h.isInserted(t)})).length)){for(o=0,w=f;o<w.length;o++)i=w[o],h.tX(i,1);return r={type:d,success:!0},void(a&&a(r))}p=h.WAr(e)}else p=h.gjt(s,s+c);h.Ejt(p),p=p.map(function(t){return h.kue(t)}),h.rOt({body:p},y.DELETE).then(function(t){var n,i,r,e,u,o;if(h.ki(C,{type:d,data:p}))return Promise.reject({cancel:!0,type:d,step:C});if(p&&p[0]&&!v&&(s=h.Mle(s,p[0])),!h.isHierarchy())if(l)for(n=0,i=f;n<i.length;n++)r=i[n],h.tX(r,1);else h.tX(s,c);if(h.Ejt(p,{isServerToClient:!0}),p=p.map(function(t){return h.xue(t)}),l)for(e=0,u=f;e<u.length;e++)r=u[e],h.dOt(r);else h.dOt(s);return o={type:d,success:!0,items:[p]},a&&a(o),h.ki(b,o),j}).catch(function(t){var t,n,i,r,e,t=t&&!0===t.cancel?S+t.step:h.J7t(t),n={type:d,success:!1,reason:t};if(l)for(i=0,r=f;i<r.length;i++)e=r[i],h.dOt(e,n);else h.dOt(s,n);h.ki(O,{type:n}),u(n)})}},D.prototype.tX=function(i,r,e){var u,t,n,o,s,c,f,a,h,l,v,d,p,t,u=this,t=u.X7t(),o=u.oOt||[],s=u.aOt||[],c=i,f=i,a={};if(t){for(h=u.q7t=u.q7t||[],l=r,v=[],n=[],u.isHierarchy()?(f=this.TEt(c),d=u.njt,a.id=d[c].id,d[c].parent=m,u.y7t(i,r)):c=u.s7t(i),p=c;p<u.vjt&&(!0!==h[p]&&n.length<r&&(n.push(u.bjt(p)),v.push(p),h[p]=!0,--l),0!==l);p++);(0,_.forEachRight)(v,function(t){var n;o[t]&&o[t][0]&&(n=u.njt,h.splice(t,1),o.splice(t,1),s.splice(t,1),u.mjt(t,1),n.splice(i,r),!1!==e)&&n.forEach(function(t,n){t.lp=n})})}else d=u.njt,u.isHierarchy()&&(a.id=d[i].id),n=u.mjt(i,r),o.splice(i,r),s.splice(i,r),u.Gkr(i,r),u.isHierarchy()&&(d[i].parent=m,u.y7t(i,r),d.splice(i,r),!1!==e)&&d.forEach(function(t,n){t.lp=n});t=n.length,(0,_.isNullOrUndefined)(u.wjt)||(u.wjt-=t,u.wjt=Math.max(u.wjt,0)),u.ki(y.ONCHANGE,{action:y.DELETE,items:n,index:null!=c?c:i,modelIndex:f,hierarchyNodeInfo:a})},D.prototype.Gkr=function(t,n){this.Bkr(t,n)},D.prototype.COt=function(){var t,n,i,r,n=this,i=null==(t=n.options.schema)?void 0:t.columns;if(i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n._data[r]={data:[]},n.DEt.push(r))},D.prototype.MOt=function(){return(0,_.isNullOrUndefined)(this.options.remote)},D.prototype.Dkr=function(){var t,t;return!(!this.LEt.data||!this.MOt()||"json"!==(t=(null==(t=this.LEt.schema)?void 0:t.type)||"json")&&("columnJson"!==t||this.isHierarchy()))},D.prototype.X7t=function(){var t;return!!this.options.batch&&!this.MOt()},D.prototype.XFe=function(){return this.options.autoSync&&!this.MOt()},D.prototype.wOt=function(t){var n,i,n,n=this,i=n.options,n=n.hjt;return!!i.autoSync&&!(0,_.isNullOrUndefined)(n.LEt[t])},D.prototype.rOt=function(t,n){var i,r,i=this,r=n||y.UPDATE;return!(t=i.hjt.setupRequestOptions(t,n||y.UPDATE))||i.ki(l,{type:r,requestParams:t})?Promise.reject({cancel:!0,type:r,step:l}):i.hjt.postData(t)},D.prototype.Q7t=function(t,n){var i=this;return t=i.mOt(t),!(t=i.hjt.setupRequestOptions(t,n=n||"read"))||i.ki(l,{type:n,requestParams:t})?Promise.reject({cancel:!0,type:n,step:l}):i.hjt.getData(t)},D.prototype.J7t=function(t){return(0,_.isString)(t)?t:t instanceof Error?t.message:"some error happened"},D.prototype.TBe=function(){var t=this.q7t;return!((0,_.isNullOrUndefined)(t)||0===t.length)},D.prototype.s7t=function(t){var n,i,r,e,u,n=this.q7t;if(!n||0===n.length)return t;for(e=r=i=0,u=n.length;e<=u;e++)if(n[e])r+=1;else{if(i===t)break;i+=1}return t+r},D.prototype.TEt=function(t){var n,i,r,n=this.q7t;if(!(0,_.isNullOrUndefined)(n)&&0!==n.length)for(i=0,r=Math.min(n.length,t);i<=r;i++)n[i]&&--t;return t},D.prototype.Mle=function(t,n){var i,r,e,u,o,i=this.gjt(t,t+1);if(!i||!I(i[0],n))for(r=this.length(),u=t+1,o=t-1;0<=o||u<r;){if(u<r){if(e=u,(i=this.gjt(e,e+1))&&I(i[0],n))return e;u++,u=Math.min(r,u)}if(0<=o){if(e=o,(i=this.gjt(e,e+1))&&I(i[0],n))return e;o--,o=Math.max(-1,o)}}return t},y.DataSource=D},"./dist/src/dataSource/dataTransport/localDataTransport.js":function(t,n){"use strict";var i,r;function e(t){t&&(this._data=t.data,this.LEt=i({},t))}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.LocalDataTransport=void 0,e.prototype.getData=function(t){var n;return Promise.resolve(this._data)},e.prototype.getDataSync=function(){return this._data},e.prototype.postData=function(t){var n;return Promise.resolve(this._data)},e.prototype.setupRequestOptions=function(t,n){return{}},n.LocalDataTransport=e},"./dist/src/dataSource/dataTransport/remoteDataTransport.js":function(t,n,i){"use strict";var c,o,s,r,f,a,h,l,v,d,p,e;function u(t){var n;this.LEt=c({},t)}c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteDataTransport=void 0,i("./node_modules/whatwg-fetch/fetch.js"),o=i("./node_modules/fetch-jsonp/build/fetch-jsonp.js"),s=i("./dist/src/dataSource/utils.js"),r=null,f=void 0,a="jsonp",h="read",l="create",v="update",d="delete",p="Content-Type",u.prototype.getData=function(t){var n,i,r,e,u,n=this,i,r=this.LEt[t.requestType],e=t.dataType,u=e===a?o:fetch;return t.requestData=f,(t.requestType=f,s.isFunction)(r)?r(t):u(t.url,t).then(function(t){if(t.ok)return n.AOt(e)?t.json():t.text();throw t})},u.prototype.postData=function(t){var n,i,r,e,u,n=this,i,r=this.LEt[t.requestType],e=t.dataType,u=t.requestData;return t.requestData=f,(t.requestType=f,s.isFunction)(r)?r(u,t):fetch(t.url,t).then(function(t){if(t.ok)return n.AOt(e)?t.json():t.text();throw t})},u.prototype.AOt=function(t){return void 0===t||"json"===t||t===a},u.prototype.setupRequestOptions=function(t,n){var i,r,e,u,o,s,i,e;if(t=t||{},r=(i=this).LEt[n])return e=r.body,(u=t.body)?(t.headers=t.headers||{},i.LEt.dataConverter?(t.body=u=i.LEt.dataConverter(u,n||h),t.headers[p]="application/plain;"):(t.body="string"==typeof u?u:JSON.stringify(u),t.headers[p]="application/json; charset=utf-8")):e&&(t.body="string"==typeof e?e:JSON.stringify(e),t.headers={},t.headers[p]="application/json; charset=utf-8"),i=r.method,n===h?(r.dataType===a&&(o={mode:"no-cors"}),s={method:i||"GET"}):n===l||n===v||"batch"===n?s={method:i||"POST"}:n===d&&(s={method:i||"DELETE"}),(e=r.options)&&e.mode&&(o={mode:e.mode}),e&&0<Object.keys(e).length||(e={}),c(c(c(c(c(c({},r),s),o),e),t),{requestType:n,requestData:u})},n.RemoteDataTransport=u},"./dist/src/dataSource/event.js":function(t,n,i){"use strict";var a,e,c,u,r;function o(t,n,i){var r=this;r.handler=t,r.owner=n,r.priority=i}function s(){this.IOt=[]}function f(t,n){var i=t&&t.event;return i||n&&(i=t.event=new u),i}function h(t,n,i,r){n instanceof u&&(i?n.removeHandler(i,r||t):n.removeAllHandlers())}function l(n,t,i,r){var e;(0,a.isBoolean)(i)&&(e=i,i=c),v(t,function(t){h(n,t,i,r)},e,!0)}function v(t,n,i,r){var e,u,o,s,c,f;if(t&&n&&(u=n(e=t.event),r&&delete t.event,!1!==u))for(s in o=t.paths||{})o.hasOwnProperty(s)&&(f=n(c=o[s]),!1!==i)&&(!1!==f&&v(c,n,i,r),r)&&delete o[s]}function d(){this._events={}}Object.defineProperty(n,"__esModule",{value:!0}),n.EventManager=n.Event=n.EventHandler=void 0,a=i("./dist/src/dataSource/utils.js"),e=o,n.EventHandler=e,c=null,Object.defineProperty(s.prototype,"hasHandlers",{get:function(){return 0<this.IOt.length},enumerable:!1,configurable:!0}),s.prototype.addHandler=function(t,n,i){var r=this,t=new e(t,n,i=void 0===i?1:i);r.IOt.push(t),r.sortHandlers()},s.prototype.removeHandler=function(t,n){for(var i,r,e,u,o,i=this,r=i.IOt,e=r.length,u=0;u<e;u++)if((o=r[u]).handler===t&&o.owner===n){i.IOt.splice(u,1);break}},s.prototype.sortHandlers=function(){this.IOt.sort(function(t,n){var t=t.priority,n=n.priority;return t<n?1:n<t?-1:0})},s.prototype.removeHandlersByPriority=function(t){for(var n,i,r,e,u,o,s,n=this,i=n.IOt,r=i.length,e=c,u=c,o=0;o<r;o++)if((s=i[o]).priority===t)e===c&&(e=o),u=o;else if(e!==c)break;e!==c&&u!==c&&n.IOt.splice(e,u-e+1)},s.prototype.removeAllHandlers=function(){this.IOt.length=0},s.prototype.raise=function(t,n){var i,r,r,e,u,o,s,i=!1,r=function(){i=!0};for(n===c?n={stopPropagation:r}:n.stopPropagation=r,e=(r=this).IOt.length,u=r.IOt.slice(0,e),o=0;o<e&&!i;o++)(s=u[o]).handler.call(s.owner,t,n)},u=s,n.Event=u,d.prototype.bind=function(t,n,i){var r,e,u,o,s,c,r=this;if(n)for(o=e=(u=0,a.isArray)(t)?t:[t];u<o.length;u++)(c=n[s=o[u]]||n)&&r.D3(s,c,i)},d.prototype.D3=function(t,n,i,r){var e,t,e=this,t=e.hUr(t,!0);(0,a.isFunction)(n)||(i=n.bindingThis||i,r=n.priority||r),t.addHandler(n,i||e,r)},d.prototype.unbind=function(t,n,i){var r=this;(0,a.isNullOrUndefined)(t)?(l(r,{paths:r._events},!(0,a.isFunction)(n)||n,i),r._events={}):r._3(t,n,i)},d.prototype._3=function(t,n,i){var r=this;l(r,r.dUr(t),n,i)},d.prototype.trigger=function(n,i){var r=this,e=!0;return v(r.dUr(n),function(t){if(t instanceof u&&((i=i||{}).cancel=!1,i.eventName=n,t.raise(r,i),i.cancel))return e=!1}),e},d.prototype.hasBound=function(t){var n,t=this.hUr(t);return t&&t.hasHandlers},d.prototype.dUr=function(t,n){var i,r,e,u,o,s,c,f,i,r=this._events,e=t.split(".");if(e&&0!==e.length)for(u=0,o=e.length;u<o;u++){if(c=e[u],f=(s=0===u)?r[c]:r.paths&&r.paths[c],(0,a.isNullOrUndefined)(f)){if(!n)return;s?r[c]=f={}:((0,a.isNullOrUndefined)(r.paths)&&(r.paths={}),r.paths[c]=f={})}r=f}return r},d.prototype.hUr=function(t,n){var i;return f(this.dUr(t,n),n)},n.EventManager=d},"./dist/src/dataSource/utils.js":function(P,a,t){"use strict";var e,o,s,c,f,h;function i(t){return t&&!(0,a.isArray)(t)&&"object"==typeof t}function n(t){if(i(t))for(var n in t)if(t.hasOwnProperty(n))return!0;return!1}function r(t){return"function"==typeof t}function u(t){return"number"==typeof t}function l(t){return"boolean"==typeof t}function v(t,n){var i,r,e,u,o;if((0,a.isArray)(t))for(i=0;i<t.length;i++)n(t[i],i,t);else if(!M(t))for(e=0,u=r=Object.keys(t);e<u.length;e++)n(t[o=u[e]],o,t)}function d(t,n){var i,r,e,u,o;if((0,a.isArray)(t))for(i=t.length-1;0<=i;i--)n(t[i],i,t);else for((r=Object.keys(t)).reverse(),e=0,u=r;e<u.length;e++)n(t[o=u[e]],o,t)}function p(t){return Object.keys(t)}function w(t,n,i){if((0,a.isArray)(t))return t.reduce(n,i);throw new Error("NOT SUPPORT")}function b(t,n,i){return t.indexOf(n,i=void 0===i?0:i)}function m(t,n){for(var i=0,r=t.length;i<r;i++)if(n(t[i],i,t))return i;return-1}function j(t,n){var i,r,e,u,o,s,c;if(void 0===n&&(n=!1),null!=t&&"object"==typeof t){if(t&&(0,a.isArray)(t))return t.map(function(t){return j(t,n)});if(t&&"object"==typeof t){for(i={},e=0,u=r=Object.keys(t);e<u.length;e++)s=t[o=u[e]],n?(c=T(s),i[o]="object"===c||"array"===c?j(s,n):s):i[o]=s;return i}}return t}function y(t,n){return void 0===n&&(n=!1),(0,a.isArray)(t)&&!n?t.slice():j(t,n)}function g(t,n,i,r){var e,u,o,s,c,f;if(void 0===i&&(i=!1),void 0===r&&(r=!1),!M(t)&&!M(n)){if(t instanceof Blob||n instanceof Blob)return t===n;if(t instanceof Date&&n instanceof Date)return t.valueOf()===n.valueOf();if(i)if((0,a.isArray)(t)&&(0,a.isArray)(n)){if(t.length===n.length){for(e=0;e<t.length;e++)if(!g(t[e],n[e],i,r))return!1;return!0}}else if("object"==typeof t&&"object"==typeof n&&(u=Object.keys(t).filter(function(t){return!r||"_"!==t[0]}),o=Object.keys(n).filter(function(t){return!r||"_"!==t[0]}),u.length===o.length)){for(s=0,c=u;s<c.length;s++)if(f=c[s],!n.hasOwnProperty(f)||!g(t[f],n[f],r))return!1;return!0}}return t===n}function _(t,n){return!g(t,n,!0)}function O(t,n){var i,r,e;for(void 0===t&&(t=[]),void 0===n&&(n=[]),i={},r=Math.min(t.length,n.length),e=0;e<r;e++)i[t[e]]=n[e];return i}function C(t){return"string"==typeof t}function S(t,n){var i,r,e,u;if(C(n))return t[n];for(i={},r=0,e=n;r<e.length;r++)i[u=e[r]]=t[u];return i}function k(t,n){if((0,a.isArray)(t))return t.map(n);throw new Error("NOT SUPPORT")}function L(t){return void 0===t}function V(t){return null===t}function M(t){return null==t}function F(t){return""===t||M(t)}function N(t){return t&&"="===t[0]}function q(t){return!C(t)&&C(t.name)&&!N(t.name)&&"formula"===t.dataType}function G(t){return t&&-1<t.indexOf(".")&&!N(t)}function T(t){var n;return Object.prototype.toString.call(t).match(/\[\w+\s(\w+)\]/)[1].toLowerCase()}function H(t,n,i,r){n<0||n>t.length||i<0||i>t.length||n===i||r<=0||t.splice.apply(t,e([i-(n<i?r-1:0),0],t.splice(n,r),!1))}function R(t,n){var t=t.parent;t&&(n(t),R(t,n))}function I(t,n,i,r){var e,u,o,s,c,f,a,h,l,v,d,e=t[r||"children"]||[];for(F(i)?u=e.slice():(f=c=void 0,"string"==typeof i?o=i:"function"==typeof i?s=i:"object"==typeof i&&(o=i.field,s=i.getValue,c=i.compareFn,f=i.isOrderChildren),u=f?e:e.slice(),o?u.sort(function(t,n){return t[o]-n[o]}):s?u.sort(function(t,n){return s(t)-s(n)}):c&&u.sort(c)),"object"==typeof(a=n)&&(a=n.invoking,h=n.invoked),v=0;v<u.length;v++){if(d=u[v],a&&(l=a(d,t))&&l.cancel)return l;if((l=l&&l.cancelDeepRecursion?l:I(d,n,i,r))&&l.cancel)return l;if(h&&(l=h(d,t))&&l.cancel)return l}}function B(t){return t}function U(i){return void 0===i&&(i=0),new Promise(function(t,n){setTimeout(function(){t("timeout")},i)})}function E(t){var n=t.callback,i=t.timeout,i=void 0===i?5e3:i,t=t.retryCount,r=void 0===t?1:t;return Promise.race([n(),U(i)]).then(function(t){if("timeout"!==t)return Promise.resolve(t);if(0<r)return E({callback:n,retryCount:--r});throw"timeout"})}function W(t,n){return x(t.map(function(t){return function(){return new Promise(t)}}),n)}function x(t,i){var r=[];return t.reduce(function(t,n){return t.then(function(t){return r.push(Promise.resolve(t)),i?E({callback:n,timeout:i.timeout,retryCount:i.retryCount}):n()})},Promise.resolve({})).then(function(t){return r.shift(),r.push(Promise.resolve(t)),Promise.all(r)})}function A(t,n,i){var p={syncDone:!1,asyncCount:0,args:void 0,succeededArgs:void 0,failedArgs:void 0,completedArgs:void 0,isFailedInvoked:!1,chains:[],isChainSyncInvoked:!1,onSucceeded:t,onFailed:n,onCompleted:i,onThens:[],invoke:function t(){var s,s,n,n,c,i,r,e,u,o,f,a,h,l,v,d,d;if(0<p.chains.length&&!p.isChainSyncInvoked){for(p.isChainSyncInvoked=!0,i=function(t,n){var i,r,i,e,u,o,i=c.shift(),r=i[0],i=i[1],e=i.succeed,u=i.fail,o=!1;if(r(null!=(s=null!=(s=p.completedArgs)?s:p.succeededArgs)?s:p.failedArgs,function(t){o=!0,e(t)},function(t){o=!0,u(t)}),!o)return"break"},r=0,e=(c=p.chains).length;r<e&&"break"!==(u=i(r,e));r++);p.isChainSyncInvoked=!1}else if(0===p.asyncCount&&p.syncDone){if(0<(o=p.onThens.length)){for(f=p.onThens,a=0;a<o;a++)if(h=f[a][0])try{p.succeededArgs=h(p.succeededArgs)}catch(n){for(l=!1,v=a+1;v<o;v++)if((d=f[v])&&(d=d[1]))try{p.succeededArgs=d(n),l=!0,a=v;break}catch(t){n=t}if(!l){p.isFailedInvoked=!0,p.failedArgs=n;break}}p.onThens=[]}p.isFailedInvoked?p.onFailed&&p.onFailed(p.failedArgs):p.onSucceeded&&p.onSucceeded(p.succeededArgs),p.onCompleted&&p.onCompleted(null!=(n=null!=(n=p.completedArgs)?n:p.succeededArgs)?n:p.failedArgs),p.onFailed=void 0,p.onSucceeded=void 0,p.onCompleted=void 0}},execute:function t(n){return n&&(p.onCompleted=n),p.syncDone=!0,p.invoke(),p},append:function t(r){p.chains.push([function(t,n,i){r(n,i,t)},p.suspend()])},appendPromiseLike:function t(r){p.chains.push([function(t,n,i){var t=r(t);t&&t.then?t.then(n,i):n(t)},p.suspend()])},suspend:function t(){return p.asyncCount++,{succeed:function t(n){p.succeededArgs=n,p.resume()},fail:function t(n){p.isFailedInvoked=!0,p.failedArgs=n,p.resume()},completed:function t(n){p.completedArgs=n,p.resume()}}},resume:function t(){p.asyncCount--,p.invoke()},then:function(t,n){var i=[];return t&&(i[0]=t),n&&(i[1]=n),0<i.length&&p.onThens.push(i),0===p.asyncCount&&p.syncDone&&p.invoke(),p}};return p}function K(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))}function J(t){return!M(t._error||t._code)}function Y(t){var n;return M(t)||M(n=t._error||t._code)?t:n}function $(n,t){var i,i,r,e,u;if(M(n)||""===n)return"";if(i=K(t),!t||"General"===t||i)return"boolean"==typeof n||n instanceof Boolean?(n=s?n?s.getBoolean().boolean_true:s.getBoolean().boolean_false:n).toString().toUpperCase():n instanceof Date?(r=(i=c.Fe(c.culture()).DateTimeFormat).shortDatePattern,0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()||(r=i.defaultDatePattern),h.Pe(n,r)):(n="number"==typeof n?f.Ge(n.toString()):n).toString();try{return(e=o.Formatter&&o.Formatter.GeneralFormatter)?(u=null,(u="string"==typeof t?new e(t):t).format(n,{})):n.toString()}catch(t){return n.toString()}}function z(t,n){var i,r;if(!M(t)&&!M(n))for(i=n.split(".");0<i.length;)t=t[r=i.shift()];return t}function X(t){var n,i,r,e,u;if(t&&0<t.length){for(n={},i=[],r=0,e=t;r<e.length;r++)n[u=e[r]]||(n[u]=!0,i.push(u));return i}return t}function Q(e,u,t){var n,i,r,o,s;if(e){if(t)for(n=0,i=u.length;n<i;n++)-1<(r=e.indexOf(u[n]))&&e.splice(r,1);for(o=function(t,n){var i,r,i=e[t],r=u.reduce(function(t,n){return n<i?t+1:t},0);0<r&&(e[t]-=r)},n=0,s=e.length;n<s;n++)o(n,s)}}function D(t,n){var i,r,e;if(t)for(i=0,r=t.length;i<r;i++)n<=(e=t[i])&&(t[i]+=1)}function Z(t,n,i){D(t,i),t.splice(n,0,i)}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))},Object.defineProperty(a,"__esModule",{value:!0}),a.insertIntoIndex=a.fixInsertIndexes=a.removeIndexes=a.getUniqueArray=a.q$=a.format=a.formatCalcError=a.isCalcError=a.useSerialExecutor=a.lastCallback=a.promiseAllSerial=a.promiseSerialExecute=a.traversalTree=a.bubbleTree=a.swapArrayItems=a.getActualType=a.isRelation=a.isNamedFormulaColumn=a.isFormula=a.isNullOrEmpty=a.isNullOrUndefined=a.isNull=a.isUndefined=a.map=a.pick=a.isString=a.zipObject=a.isNotDeepEqual=a.isEqual=a.cloneArray=a.clone=a.findIndex=a.indexOf=a.reduce=a.getObjectKeys=a.forEachRight=a.forEach=a.isBoolean=a.isNumber=a.isFunction=a.isObjectWithKey=a.isObject=a.isArray=void 0,o=t("Common"),s=t("CalcEngine"),c=o.Common.CultureManager,f=o.Common.st,h=o.Common.ct,a.isArray=o.Common.lt.Nh,a.isObject=i,a.isObjectWithKey=n,a.isFunction=r,a.isNumber=u,a.isBoolean=l,a.forEach=v,a.forEachRight=d,a.getObjectKeys=p,a.reduce=w,a.indexOf=b,a.findIndex=m,a.clone=j,a.cloneArray=y,a.isEqual=g,a.isNotDeepEqual=_,a.zipObject=O,a.isString=C,a.pick=S,a.map=k,a.isUndefined=L,a.isNull=V,a.isNullOrUndefined=M,a.isNullOrEmpty=F,a.isFormula=N,a.isNamedFormulaColumn=q,a.isRelation=G,a.getActualType=T,a.swapArrayItems=H,a.bubbleTree=R,a.traversalTree=I,a.promiseSerialExecute=W,a.promiseAllSerial=x,a.lastCallback=A,a.useSerialExecutor=A,a.isCalcError=J,a.formatCalcError=Y,a.format=$,a.q$=z,a.getUniqueArray=X,a.removeIndexes=Q,a.fixInsertIndexes=D,a.insertIntoIndex=Z},"./dist/src/interfaces/conditionalFormatOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.c=void 0,n.c=0},"./dist/src/interfaces/interface.js":function(t,n){"use strict";var i,r,e,u,o,o,o,o;Object.defineProperty(n,"__esModule",{value:!0}),n.RelationshipMap=n.RowColumnStates=n.StateRuleDirection=n.ViewArea=n.DEFAULT_VIEW_NAME=void 0,n.DEFAULT_VIEW_NAME="defaultView",(o=i=n.ViewArea||(n.ViewArea={}))[o.colHeader=1]="colHeader",o[o.viewport=3]="viewport",(o=r=n.StateRuleDirection||(n.StateRuleDirection={}))[o.none=0]="none",o[o.row=1]="row",o[o.column=2]="column",o[o.both=3]="both",(o=e=n.RowColumnStates||(n.RowColumnStates={}))[o.hover=1]="hover",o[o.readonly=4]="readonly",o[o.active=16]="active",o[o.selected=32]="selected",o[o.dirty=64]="dirty",o[o.inserted=128]="inserted",o[o.updated=256]="updated",o[o.pin=1024]="pin",o[o.primaryKey=2048]="primaryKey",o[o.required=4096]="required",(o=u=n.RelationshipMap||(n.RelationshipMap={}))[o.OneToOne=0]="OneToOne",o[o.OneToMany=1]="OneToMany"},"./dist/src/interfaces/styleOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.s=void 0,n.s=0},"./dist/src/interfaces/validatorOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.v=void 0,n.v=0},"./dist/src/polyfills/from-entries.js":function(){var n=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))};function t(t){return n([],t,!0).reduce(function(t,n){var i=n[0],n=n[1];return t[i]=n,t},{})}Object.fromEntries||(Object.fromEntries=t)},"./dist/src/query.js":function(t,n,i){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/src/dataManager.js").DataManager.prototype.query=function(t,n){var i,r=this.U0r;return r.ndr(n),r.query(t)}},"./dist/src/query/query-helper.js":function(t,n,i){"use strict";var e,$,z,k,X,Q,Z,tt,nt,it,r,L,u;function o(t){this.Kwr=new r.QueryCache,this.Kwr.xTr(t),this.N3=t,this.H0r=new e.CalcSource(t.Lp),this.z0r={},this.V0r={},this.ddr={},this.aGr=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryHelper=void 0,e=i("CalcEngine"),$=i("./dist/src/view/view.entry.js"),z=i("./dist/src/query/utils/table-utils.js"),k=i("./dist/src/query/utils/query-utils.js"),X=i("./dist/src/query/utils/window-function-utils.js"),Q=i("./dist/src/query/utils/filter-utils.js"),Z=i("./dist/src/query/utils/sort-utils.js"),tt=i("./dist/src/query/utils/group-utils.js"),nt=i("./dist/src/dataSource/utils.js"),it=i("./dist/src/viewField/viewField.entry.js"),r=i("./dist/src/query/utils/query-cache.js"),L=void 0,o.prototype.query=function(t){var n,i,r,n,t,t,n=this.ndr(),i=e.Functions.CALC_PRECISION;return e.Functions.CALC_PRECISION=null==n?void 0:n.calcPrecision,"string"==typeof t?r=(0,nt.clone)(this.N3.queries[t],!0):(r=(0,nt.clone)(t,!0),t.name&&(this.N3.queries||(this.N3.queries={}),this.N3.queries[t.name]=t)),n=JSON.parse(JSON.stringify(r)),(t=this.Kwr.ev(n))||(t=this.Y0r(r),this.Z0r(),e.Functions.CALC_PRECISION=i,this.Kwr.Xwr(n,t),this.dkr(),t)},o.prototype.dkr=function(){var t,n,i,n,r,e,u,o,o,s;for(t in this.z0r={},this.ddr)this.ddr.hasOwnProperty(t)&&(i=(n=this.ddr[t]).table,n=n.column,r=i.columns[t])&&r===n&&delete i.columns[t];for(this.ddr={},e=0,u=this.aGr;e<u.length;e++)i=(o=u[e]).table,o=o.groupKey,(s=null==i?void 0:i._dataSource._data)&&s.hasOwnProperty(o)&&delete s[o];this.aGr=[]},o.prototype.qwr=function(t){this.Kwr.d5(t)},o.prototype.ndr=function(t){return 0<arguments.length&&(this.edr=t),this.edr},o.prototype.Z0r=function(){var t,n,i,r,e,t=this.N3,n=this.V0r,i=t.tables;for(r in n)n.hasOwnProperty(r)&&(e=i[r])&&(delete e.W0r,delete e.Q0r);this.V0r={}},o.prototype.Y0r=function(t,n){var i,r,e,u,o,s,c,f,a,h,l,v,d,o,p,a,w,b,m,j,m,a,o,y,g,_,O,i,C,S,M,F,N,T,N,R,I,P,E,x,A,D,i=this.N3,r=i.tables[t.from];if(r){for(e=!1,t.unpivot&&(e=!0,r._dataSource.rse=r._dataSource._data,r.fetchSync(t.unpivot)),this.V0r[r.name]=!0,u=null==n?void 0:n.recordInIndexMap,s=(o=(0,k.K0r)(t,[],r)).selectFields,c=o.selectFieldValueCaptionMap,f=o.calculateColumns,a=o.windows,h=o.limit,l=o.skip,v=o.groupInfos,d=o.sortInfos,(o=a)&&0<Object.keys(a).length&&(p=(a=r._dataSource.options.schema)&&a.window,(0,X.setWindowDefOption)(r,o)),w=0,b=f.length;w<b;w++)j=(m=f[w]).caption,m=m.value,r.columns[j]={caption:j,value:m},this.ddr[j]={table:r,column:r.columns[j]},r.rRt(j);if(a=(0,$.ose)(r),o=Object.keys(s).filter(function(t){return r.PAe(t)}),d&&0<d.length&&v.length<=0&&(0,X.addWindowFunctionFields)(o,d,r),(0,k.X0r)(i,t,this.z0r,this.H0r),y=this.z0r[t.q0r],g=this.$0r(t,u),_=n||{},O=[],0<o.length&&(g=(0,X.afr)(o,r,a,g,y,this.ndr())),0<(null==d?void 0:d.length)&&v.length<=0&&(0,Z.JFt)(r,a,L,d,g,L,L,y),0<(0,nt.getObjectKeys)(s).length&&(i=this.sfr(r,s,c,h,l,g,y,!(!t.nest||v&&0!==v.length)),O=i=this.cfr(_,i,s,n)),0<(null==v?void 0:v.length))for(O=[],C=[].concat(g),S=0,M=v;S<M.length;S++){for(F=M[S],T=(N=this.ffr(r,t,F,d,g,y)).groupSelectData,N=N.groupTreeLeafNodes,this.lfr(_,T,F.groupByInfos),R=0,I=N;R<I.length;R++)P=I[R],O.push(P);(0,z.getTableFieldManager)(r).reset(),g=[].concat(C)}if(E=t.nest)for(E.hfr=t,E.from===L&&(E.from=t.from),x=0,A=O;x<A.length;x++)D=A[x],this.Y0r(E,D),delete D.recordRowNumbers,delete D.recordInIndexMap;return(0,X.resetWindowDefOption)(r,p),e&&(r._dataSource._data=r._dataSource.rse,r.fetchSync(L,!0)),_}},o.prototype.queryRelationshipMap=function(){return this.z0r},o.prototype.ffr=function(t,n,i,r,e,u){for(var o,s,a,P,c,f,h,l,k,L,i,v,V,q,d,p,w,c,b,G,m,j,y,o,g,_,O,C,S,M,M,H,F,N,o,e,T,R,I,E,x,A,B,D,U,W,i,c,K,e,h,J,Y,i,s=this.ndr(),a=i.groupByInfos,P=t.name.toUpperCase(),c=i.groupSelectFields,f=i.groupCalculateInfos,h=i.groupFilterInfos,l=i.groupSortInfos,k=i.includeDetailRows,L=(0,nt.getObjectKeys)(c),i=(0,tt.CFt)(t,a,e,u,s),v=(0,z.getTableFieldManager)(t),V=[],q=v.groupFieldKeys.map(function(t){return v.getField(t)}),p=[],w=[],c=(0,tt.vfr)(i.rootNode,a.length),b=c.indexMap,G=c.queue,m=0,j=b.length;m<j;m++){for(y=G[m],o=b[m],g=u[o][P],_=new Map,w.push(g),O=0,C=L.length;O<C;O++)S=L[O],(M=(M=V[O])||(V[O]=v.getFieldByName(S)))&&(M=M.getValue(g),null!=s&&s.treatUndefinedAsNull&&void 0===M&&(M=null),_.set(S,M));for(n.nest&&(_.set("recordRowNumbers",y.recordRowNumbers),_.set("recordInIndexMap",y.recordInIndexMap)),k&&null!=(o=null==n?void 0:n.Sfr)&&o.idr&&_.set("$rows",y.recordInIndexMap),H=function(c,t){var n,f,i,r,e,n,f=a[c].summaryFields;if(null!=f&&f.length)for(i=function(n,t){var i,r,i,e,u,o,s,i=f[n];if(null!=i&&i.slice){for(r=(0,$.tse)(c),i=i.caption+"_"+i.slice+r,e={},u=0,o=(d=d||q.filter(function(t){var t=(0,it.getGroupOptionIndexesFrom)(t.name);return 3===t.length&&+t[0]===c&&+t[1]===n})).length;u<o;u++)e[(s=d[u]).extra.caption]=s.getValue(g);_.set(i,e)}},r=0,e=f.length;r<e;r++)i(r,e)},F=0,N=a.length;F<N;F++)H(F,N);o=Object.fromEntries(_.entries()),p.push(o),(0,z.gfr)(t,o,g,this.aGr)}if(e=(0,Z.hasGroupSorts)(l)||r&&0<r.length,0<f.length||0<h.length||e){for(T=[],R=0,I=f;R<I.length;R++)for(x=(E=I[R]).caption,A=E.value,t.columns[x]={caption:x,value:A},this.ddr[x]={table:t,column:t.columns[x]},t.rRt(x),D=0,U=B=t.GAe(E.value);D<U.length;D++)W=U[D],T.push(W);for(0<h.length&&(i=(0,tt.mfr)(h),c=(0,Q.fFt)(t,i,w),K=[],p=c.map(function(t){var t=w.indexOf(t);return K.push(b[t]),p[t]}),b=K,w=c),(0,Z.hasGroupSorts)(l)?(0,X.addWindowFunctionFields)(T,l.reduce(function(t,n){return t.concat(n)},[]),t):r&&0<r.length&&(0,X.addWindowFunctionFields)(T,r,t),e=(0,$.ose)(t),h=(0,X.afr)(T,t,e,b,u,s),J=[],p=h.map(function(t,n){var t=b.indexOf(t);return J[n]=w[t],p[t]}),w=J,m=0,j=p.length;m<j;m++)for(y=p[m],g=w[m],O=0,C=f.length;O<C;O++)x=(Y=f[O]).caption,A=Y.value,y[x]=t._getValueByField(A,g);return i=(0,tt.pfr)(p,a),((0,Z.hasGroupSorts)(l)||r&&0<r.length)&&(0,Z.bfr)(i.groupSelectData,a,l,r),i}return(0,tt.pfr)(p,a)},o.prototype.sfr=function(t,n,i,r,e,u,o,s){var c,f,a,h,l,v,d,p,w,b,m,j;if(void 0===r&&(r=0),void 0===e&&(e=0),a=u,h=t.name.toUpperCase(),l=[],v=(a=o?u.map(function(t){return o[t][h]}):a).length,0<=r)for(d=e,p=0===r?v:Math.min(e+r,v);d<p;d++){for(b in w=new Map,n)n.hasOwnProperty(b)&&(m=null!=(c=i[b])?c:b,w.set(m,t._getValueByField(b,a[d])));s&&w.set("recordRowNumbers",[u[d]]),l.push(Object.fromEntries(w.entries()))}else for(d=v-1-e,j=Math.max(0,v+r-e);j<=d;d--){for(b in w=new Map,n)n.hasOwnProperty(b)&&(m=null!=(f=i[b])?f:b,w.set(m,t._getValueByField(b,a[d])));s&&w.set("recordRowNumbers",[u[d]]),l.push(Object.fromEntries(w.entries()))}return l},o.prototype.cfr=function(t,n,i,r){return t.$r=n},o.prototype.lfr=function(t,n,i){var t,t,r,r;t[(null==(t=i[0])?void 0:t.caption)||(null==(t=i[0])?void 0:t.field)]=n},o.prototype.$0r=function(t,n){var i,r,t,t,e,i,i=this.z0r,r=t.q0r,t=t.hfr,t=null==t?void 0:t.q0r,e=i[r],i=i[t];return n?e&&i?r===t?n:[]:void 0:(0,z.gFt)(e.length)},n.QueryHelper=o},"./dist/src/query/utils/filter-utils.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.wfr=n.fFt=void 0;var r=i("./dist/src/dataManager.entry.js");function e(t,n,i){return(0,r.isNullOrEmpty)(n)?i.slice():"string"==typeof n?u(t,t.Ywt(n,0,0),i):[]}function u(t,n,i,r){for(var e,u,o,s,e=[],u=0,o=r||0;o<i.length;o++)s=i[o],!0===t.nMt(n,s,0)&&(e[u]=s,u++);return e}n.fFt=e,n.wfr=u},"./dist/src/query/utils/group-utils.js":function(t,n,i){"use strict";var v,O,d,p,w;function r(t,n,i){var r,e,u,o,s,r,c,f,a,h;if(n&&0<(r=(0,O.getObjectKeys)(n)).length)for(e=0,u=r;e<u.length;e++)s=n[o=u[e]],(0,O.isFormula)(s)&&t===o&&(t=s);if(i&&0<(r=(0,O.getObjectKeys)(i)).length)for(c=0,f=r;c<f.length;c++)h=i[a=f[c]],(0,O.isFormula)(h)&&t===a&&(t=h);return t}function e(t,n,i,r,e){var u,o,s,c,f,a,h,l,f,u=(0,d.getTableFieldManager)(t),o=(0,d.getTableGroupManager)(t),s=t.name.toUpperCase(),c=[],f=i.map(function(t){var n=r[t][s];return c[n]=t,n}),a=u.buildGroupFields(n,f),h,l={childrenArray:[b(t,n,0,i,r,e)]},f=[];return f=o.eLt(i,function(){return o.iLt(a,l)}).map(function(t){return c[t]}),u.transposeSliceFields(a),{rootNode:l,newIndexMap:f}}function b(e,t,n,i,u,o){var i,s,r,c,r,f,a,h,l,r=new Map,c=t[n],r=m(e,r,t,n,i,u,o);if(++n<t.length||null!=(i=c.summaryFields)&&i.length)for(f=function(r){null!=(s=c.summaryFields)&&s.length&&(r.slices=[],c.summaryFields.forEach(function(t,n){var t,i,i;t.slice&&(t={field:t.slice},i=new Map,i=m(e,i,[t],0,r.recordInIndexMap,u,o),r.slices[n]={childrenArray:[i]})})),n<t.length&&(r.childrenArray=[b(e,t,n,r.recordInIndexMap,u,o)])},a=0,h=r;a<h.length;a++)f(l=h[a]);return r}function m(e,u,t,n,o,i,r){var s,c,r,f,a,t,h,l,s=[],c=null==r?void 0:r.treatUndefinedAsNull,r=t[n],f=e.name.toUpperCase(),a=r.field,t=r.ascending===p?p:r.ascending?"asc":"desc",h;return(i?o.map(function(t){return i[t][f]}):o).forEach(function(t,n){var i,r,i=e._getValueByField(a,t);(r=u.get((i=c&&void 0===i?null:i)+""))||(u.set(i+"",r={value:i,recordRowNumbers:[],recordInIndexMap:[]}),s.push(r)),r.recordRowNumbers.push(t),r.recordInIndexMap.push(o[n])}),t&&(l="desc"===t,s.sort(function(t,n){var t,n,i,r,t=t.value,n=n.value,i=null==t||""===t||typeof t===w&&isNaN(t),r=null==n||""===n||typeof n===w&&isNaN(n);return i||r?i&&r?0:i&&!r?l?-1:1:!i&&r?l?1:-1:void 0:(0,v.isGreaterThan)(n,t)?-1:1})),s}function u(t,n){for(var i,r,e,u,o,s,c,f,a,h,l,v,d,i=[t],r=0;r<n;){for(e=[],u=0,o=i.length;u<o;u++)if((s=i[u]).childrenArray&&s.childrenArray[0])for(f=s.childrenArray[c=0];c<f.length;c++)a=f[c],e.push(a);r++,i=e}for(h=[],l=0,v=i;l<v.length;l++)d=v[l],h.push(d.recordInIndexMap[0]);return{indexMap:h,queue:i}}function o(t){var n,i,r,e,e;if(0===t.length)return"";if(1===t.length)return t[0];for(n=[],i=0,r=t;i<r.length;i++)e="="===(e=r[i])[0]?e.slice(1):e,n.push(e);return"=AND("+n.join(",")+")"}function s(g,_){var t,n,i,r,e,u,o,s,c,f,a,t=[].concat(g);if(2<=_.length){for(n=function(i){for(var t,n,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,j,y,t,n=i===_.length-1?["$rows","recordRowNumbers","recordInIndexMap"]:_[i+1].field,r=[],e=_[i-1].caption||_[i-1].field,u=_[i].caption||_[i].field,o=_[i].summaryFields,s=o.map(function(t){return t.caption}),c=o.reduce(function(t,n){return n.a_e&&t.push({caption:n.caption,summaryField:n.u_e}),t},[]),f=o.map(function(t){var n=(0,O.tse)(i);return t.caption+"_"+t.slice+n}),a=function(t){var n=(0,O.tse)(i);return n?t.substring(0,t.lastIndexOf(n)):t},h=0,l=g;h<l.length;h++)if(d=(v=l[h])[e],0!==r.length&&C(r[r.length-1],v,_,i-1)){for(S(v,s.concat(u,n),f,a),j=0,y=c;j<y.length;j++)v[(m=y[j]).summaryField]=v[m.caption],delete v[m.caption];r[r.length-1][u].push(v)}else{for(p=S(v,s.concat(u,n),f,a),w=0,b=c;w<b.length;w++)v[(m=b[w]).summaryField]=v[m.caption],delete v[m.caption];p[e]=d,p[u]=[v],r.push(p)}g=r},i=_.length-1;0<i;i--)n(i);for(e=(r=_[0].summaryFields).reduce(function(t,n){return n.a_e&&t.push({caption:n.caption,summaryField:n.u_e}),t},[]),u=0,o=g;u<o.length;u++)for(s=o[u],c=0,f=e;c<f.length;c++)s[(a=f[c]).summaryField]=s[a.caption],delete s[a.caption]}return{groupSelectData:g,groupTreeLeafNodes:t}}function C(t,n,i,r){for(var e,u,e=r;0<=e;e--)if(t[u=i[e].caption||i[e].field]!==n[u])return;return 1}function S(t,n,i,r){for(var e,u,o,s,c,f,e,u={},o=0,s=(0,O.getObjectKeys)(t);o<s.length;o++)c=s[o],-1!==i.indexOf(c)?(f=r(c))!==c&&(t[f]=t[c],delete t[c]):-1===n.indexOf(c)&&(u[c]=t[c],delete t[c]);return u}function c(t){var n,i,r,n=[],i=[];for(r in t)t.hasOwnProperty(r)&&("="!==r[0]&&0<=r.indexOf(",")?r.split(",").forEach(function(t){n.push(t),i.push(t)}):(n.push(r),i.push(t[r].caption||r)));return{groupKeys:n,groupCaptions:i}}function f(t,n){var i,r;if(!(n.length<=0)){for(i=t,r=0;r<n.length;r++)i=a(i,n[r]);return i}}function a(t,n){var i,r,e,u,i=[];if(Array.isArray(t))for(r=0,e=t;r<e.length;r++)u=e[r],i.push.apply(i,u[n]);else i.push.apply(i,t[n]);return i}Object.defineProperty(n,"__esModule",{value:!0}),n.yfr=n.Mfr=n.pfr=n.mfr=n.vfr=n.CFt=n.Cfr=void 0,v=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),O=i("./dist/src/dataManager.entry.js"),d=i("./dist/src/query/utils/table-utils.js"),p=void 0,w="number",n.Cfr=r,n.CFt=e,n.vfr=u,n.mfr=o,n.pfr=s,n.Mfr=c,n.yfr=f},"./dist/src/query/utils/query-cache.js":function(t,n){"use strict";var i;function r(){this.cE=new Map,this.VUt=100}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryCache=void 0,r.prototype.Xwr=function(t,n){var i,i,i=this.PEi(t);this.cE.set(i,{result:n,tables:this.$wr(t),lastAccessTime:new Date}),(i=Array.from(this.cE.entries())).length>this.VUt&&(i.sort(function(t,n){return t[1].lastAccessTime.getTime()-n[1].lastAccessTime.getTime()}),this.cE.delete(i[0][0]))},r.prototype.ev=function(t){var t=this.cE.get(this.PEi(t));return t&&(t.lastAccessTime=new Date),null==t?void 0:t.result},r.prototype.d5=function(n){var i=this;Array.from(this.cE.entries()).forEach(function(t){t[1].tables.includes(n)&&i.cE.delete(t[0])})},r.prototype.eG=function(){this.cE.clear()},r.prototype.xTr=function(t){this.N3=t},r.prototype.PEi=function(t){return"string"==typeof t?t:JSON.stringify(t)},r.prototype.$wr=function(n){var i,t,r,e,i=[n.from],t,r=this.N3.relationships;return r&&r.forEach(function(t){t.sourceTable.name===n.from?i.push(t.targetTable.name):t.targetTable.name===n.from&&i.push(t.sourceTable.name)}),n.nest&&(e=this.$wr(n.nest)).forEach(function(t){-1===i.indexOf(t)&&i.push(t)}),i},n.QueryCache=r},"./dist/src/query/utils/query-utils.js":function(t,n,i){"use strict";var q,G,H,e,B,U,r;function u(O,P,C){var t,t,n,i,n,r,e,u,o,s,c,t,i,f,a,h,l,S,k,v,d,p,w,b,M,L,m,j,y,g,_,i,F,N,T,R,I,V,E,n,t,i,x,A,D;if(!O.Sfr){if(n=C.options,r=new Map,e={},u=[],(t=O.select)&&(i=t.fields,o=t.limit,s=t.skip,i))for(f=0,a=i;f<a.length;f++)h=a[f],(0<=P.indexOf(h)||0<=h.indexOf("."))&&u.push({value:h}),r.set(h,!0),c=!0;if(l=[],S=O.calculate)for(d=k=(v=0,q.getObjectKeys)(S);v<d.length;v++)p=d[v],w=S[p],w=C.PAe(w)?(0,G.parseWindowOverByOption)(w):w,l.push({caption:p,value:w}),r.get(b=p+"")&&(r.delete(b),r.set(w+"",!0),e[w]=p);if(M=null==(t=n.schema)?void 0:t.dimensions)for(j=L=(m=0,q.getObjectKeys)(M);m<j.length;m++)y=j[m],g=M[y],l.push({caption:y,value:g}),r.get(_=y+"")&&(r.delete(_),r.set(g+"",!0),e[g]=y);if(i=O.groupBy,F=[],i)for(N=null==(t=n.schema)?void 0:t.measures,T=function(o){for(var v,d,p,w,b,m,j,t,n,i,r,e,u,s,c,f,a,h,l,y,g,_,v=[],d=[],p=[],w=void 0,b=void 0,m=[],j={},t,n=function(t){for(var l,n,i,r,e,u,l=o[t],n=[t],i=function(t){var f,t,n,i,r,e,u,o,s,s,s,s,s,c,a,h,s,f=t,t={field:t=(0,H.Cfr)(t,S,M),summaryFields:[],caption:l.caption||f};if(l.summarize&&(t.summaryFields=l.summarize.map(function(t){for(var n,i,r,e,u,o,s,c,n,o=0,s=(0,q.getObjectKeys)(t);o<s.length;o++)"having"===(c=s[o])?u=W(t[c],S):"pivot"===c?r=t[c]:(i=W(J(N,t[c]),S,M),j[e=c]=!0);return{formula:i,filter:u,slice:r,caption:e,u_e:e,s_e:l.caption||f}})),n=l.calculate)for(e=i=(r=0,q.getObjectKeys)(n);r<e.length;r++)o=n[u=e[r]],o=W(o=C.PAe(o)?(0,G.parseWindowOverByOption)(o):o,S),m.push({caption:u,value:o});if((s=l.where)?(s=W(s,S),d.push(s)):d.push(U),(s=l.orderBy)?(s=(0,B.getOrderOptions)(s,function(t){for(var n,i,r,e,n=t.field,i=0,r=m;i<r.length;i++)if(n===(e=r[i]).caption&&C.PAe(e.value)){n=(0,G.parseWindowOverByOption)(e.value);break}t.field=n}),p.push(s)):p.push([]),w=l.includeDetailRows,b=!!O.nest,s=l.attributes)for(c=0,a=s;c<a.length;c++)h=a[c],j[h]=!0;v.push(t),s=l.caption||f,j[s]=!0},r=0,e=n="="!==t[0]&&0<=t.indexOf(",")?t.split(","):n;r<e.length;r++)i(u=e[r])},i=0,r=(0,q.getObjectKeys)(o);i<r.length;i++)n(e=r[i]);for(u=0;u<v.length;u++)for(c=0,f=(s=v[u]).summaryFields;c<f.length;c++){for(a=f[c],h=u+1;h<v.length;h++){for(y=0,g=(l=v[h]).summaryFields;y<g.length;y++)if(_=g[y],a.caption===_.caption){a.a_e=!0;break}if(a.a_e)break}a.a_e&&(a.caption="".concat(a.u_e,"__").concat(a.s_e),j[a.caption]=!0,d[u]=K(d[u],a.u_e,a.caption))}d=d.filter(function(t){return!(0,q.isNullOrEmpty)(t)}),F.push({groupByInfos:v,groupFilterInfos:d,groupSortInfos:p,includeDetailRows:w,includeDetailRowsForNest:b,groupCalculateInfos:m,groupSelectFields:j})},R=0,I=i;R<I.length;R++)T(V=I[R]);if((n=O.where)&&(E=W(n,S,M)),t=[],(i=O.orderBy)&&(t=(0,B.getOrderOptions)(i,function(t){for(var n,i,r,e,n=t.field,i=0,r=l;i<r.length;i++)if(n===(e=r[i]).caption&&C.PAe(e.value)){n=(0,G.parseWindowOverByOption)(e.value);break}t.field=n})),x={},A=O.window)for(D in A)A.hasOwnProperty(D)&&(x[D]=(0,G.parseWindowOverByOption)(A[D],!0));O.Sfr={selectFields:Object.fromEntries(r.entries()),selectFieldValueCaptionMap:e,relatedColumns:u,calculateColumns:l,windows:x,limit:o,skip:s,filterExpression:E,groupInfos:F,sortInfos:t},O.Sfr.idr=c||(null==(i=null==(n=O.hfr)?void 0:n.Sfr)?void 0:i.idr)}return O.Sfr}function W(t,n,i){var r,e,u,o,s,r,c,f,a,h;if(n&&0<(r=(0,q.getObjectKeys)(n)).length)for(e=0,u=r;e<u.length;e++)s=n[o=u[e]],(0,q.isFormula)(s)&&(t=t.replace(new RegExp("\\[@"+o+"\\]","g"),s.substring(1)));if(i&&0<(r=(0,q.getObjectKeys)(i)).length)for(c=0,f=r;c<f.length;c++)h=i[a=f[c]],(0,q.isFormula)(h)&&(t=t.replace(new RegExp("\\[@"+a+"\\]","g"),h.substring(1)));return t}function K(t,n,i){var r,r;return(0,q.isNullOrEmpty)(t)||-1===t.indexOf(n)?t:(r=(r=(r=t).replace(new RegExp("\\[@\\["+n+"\\]\\]","g"),"[@[".concat(i,"]]"))).replace(new RegExp("\\[@"+n+"\\]","g"),"[@".concat(i,"]"))).replace(new RegExp("\\["+n+"\\]","g"),"[".concat(i,"]"))}function J(t,n){return t&&t[n]||n}function o(t,n,i,r){var e=s(n);i[e]||(i[e]=c(t,n,r))}function s(t){var n,i,n,r,n;return t.q0r||(n=(i=void 0===t.from?null==(n=t.hfr)?void 0:n.from:t.from)+((n=t.where)?"__"+n:""),(r=t.hfr)&&(n=r.q0r+(t.from===r.from?"":"__"+n)),t.q0r=n.toUpperCase()),t.q0r}function c(t,n,i){var r,t,r=[];return void 0!==n.from&&(n.where?r=(0,e.ule)(t,{rules:[{type:"Static",formula:n.where}],relation:"And"},n):(t=t.tables[n.from])&&(r=f(t))),r}function f(t){for(var n,i,r,e,u,i=[],r=t.name.toUpperCase(),e=0,u=t.length();e<u;e++)i.push(((n={})[r]=e,n));return i}Object.defineProperty(n,"__esModule",{value:!0}),n.xfr=n.X0r=n.K0r=void 0,q=i("./dist/src/dataSource/dataSource.entry.js"),G=i("./dist/src/table/windowOverField.js"),H=i("./dist/src/query/utils/group-utils.js"),e=i("./dist/src/query/utils/report-utils.js"),B=i("./dist/src/query/utils/sort-utils.js"),U=void 0,n.K0r=u,n.X0r=o,r=/.*\[@.+\..+\]/g,n.xfr=f},"./dist/src/query/utils/report-utils.js":function(t,n,i){"use strict";var o,C,S,j,M,s,c,r;function e(t,n,i){var r;return f(t.Lp.parse(n,i,0,0))}function f(t){var n,i,r,e,u,n={rules:[],relation:"And",conditions:[]};if(t.type===o.ExpressionType.function){if(s.includes(t.functionName))for(n.relation=a(t.functionName),i=0,r=t.arguments;i<r.length;i++)e=r[i],s.includes(e.functionName)&&n.conditions?n.conditions.push(f(e)):"NOT"===e.functionName?(u=h(e.arguments[0],!0))&&n.rules.push(u):(u=h(e))&&n.rules.push(u);if(c.includes(t.functionName)&&(u=h(t))&&n.rules.push(u),"NOT"===t.functionName)return f(t.arguments[0])}return t.type===o.ExpressionType.parentheses&&(u=h(t.value))&&n.rules.push(u),n}function a(t){switch(t){case"SJS.STARTWITH":return"StartWith";case"SJS.ENDWITH":return"EndWith";case"AND":return"And";case"OR":return"Or";case"SEARCH":case"FIND":return"Contains"}}function h(t,n){var i,r,e,u;return t.type===o.ExpressionType.operator?(i=t.value,r=t.value2,u=(e=i.type===o.ExpressionType.name?i:r)===i?r:i,{column:l(e.value),operator:v(t.operatorType),value:{type:d(u.type),data:p(u)}}):t.type===o.ExpressionType.function&&c.includes(t.functionName)&&t.arguments?(i=t.arguments[0],r=t.arguments[1],u=(e=i.type===o.ExpressionType.name?i:r)===i?r:i,{column:l(e.value),operator:a(t.functionName),value:{type:d(u.type),data:p(u)}}):void 0}function l(t){var t=t.match(r);return t&&t[1]||""}function v(t){switch(t){case 9:return"Equal";case 10:return"NotEqual";case 11:return"LessThan";case 12:return"LessThanOrEqual";case 13:return"GreaterThan";case 14:return"GreaterThanOrEqual";default:return"Equal"}}function d(t){switch(t){case o.ExpressionType.reference:return"Cell";case o.ExpressionType.number:return"Number";case o.ExpressionType.string:return"String";case o.ExpressionType.boolean:return"Boolean";default:return"String"}}function p(t){switch(t.type){case o.ExpressionType.reference:var n,i;return u(t.row,t.column);case o.ExpressionType.number:case o.ExpressionType.string:case o.ExpressionType.boolean:return t.value}}function u(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return i+(t+1)}function w(t,n){var i,r,e,u,i=[];if(t.conditions)for(r=0,e=t.conditions;r<e.length;r++)u=e[r],i.push(w(u,n));return{rules:b(t.rules,n),relation:t.relation,conditions:i}}function b(t,r){var e=[];return t.forEach(function(t){var n,i,i=t.formula;t.column&&-1!==t.column.indexOf("[@")&&!t.column.startsWith("=")&&(t.column="="+t.column),(0,C.isNullOrUndefined)(i)?"Cell"!==t.value.type&&"DataColumn"!==t.value.type||"object"!=typeof t.value.data||(0,C.isNullOrUndefined)(t.value.data)?e.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):t.value.data.tableName?e.push({type:"Join",relationHostTable:null!=(n=t.tableName)?n:r,relationHostColumn:t.column,relationTargetTable:t.value.data.tableName,relationTargetColumn:t.value.data.columnName,relationCondition:t.operator}):t.value.data.formulaString&&e.push({type:"Join",relationHostTable:r,relationHostColumn:t.column,relationTargetTable:t.value.data.formulaTableName,relationTargetColumn:t.value.data.formulaString,relationCondition:t.operator}):(i.startsWith("=")||(i="="+i),e.push({type:"Static",formula:i}))}),e}function m(t,n,i){for(var r,e,u,n,o,s,c,f,a,h,l,v,d,p,w,h,v,l,b,u,e,i,m,r=i.from,e=t.U0r.queryRelationshipMap(),u=n.rules,n=n.relation,o=[],s=[],c=0,f=u;c<f.length;c++)"Join"===(a=f[c]).type?(h=a.relationHostTable,l=a.relationHostColumn,v=a.relationTargetTable,d=a.relationTargetColumn,p=a.relationCondition,w=a.formula,h=t.tables[h],v=t.tables[v],h&&v&&(l=y(h,l,w||p,v,d),o.push({sourceTable:h,targetTable:v,sourceFieldIndexMap:l.sourceFieldIndexMap,targetFieldIndexMap:l.targetFieldIndexMap}))):s.push(a);return(u=t.tables[r])&&(b=(i=e[(e=i.hfr)&&e.q0r])&&i[0]&&i[0].hasOwnProperty(u.name.toUpperCase())?i:(0,j.xfr)(u)),o.length||(m=b),m=s.length?g(t,m,s,r,n,!!o.length,b):m}function y(t,n,i,r,e){var u,o,s,c,f,a,h,l,v;function d(t,n,i){t[n]?t[n].push(i):t[n]=[i]}for(u=[],o=[],s=[],c=t.length(),f=r.length(),a=0;a<c;a++)h=t._getValueByField(n,a),(0,C.isNullOrUndefined)(h)||d(s,h,a);for("Equal"===i&&(l=function(n){var t,i,t,t=r._getValueByField(e,n);(0,C.isNullOrUndefined)(t)||(i=[],(t=s[t])&&t.forEach(function(t){return i.push(t)}),(o[n]=i).forEach(function(t){d(u,t,n)}))}),v=0;v<f;v++)l(v);return{sourceTable:t,targetTable:r,sourceFieldIndexMap:u,targetFieldIndexMap:o}}function g(t,i,n,r,p,w,b){var e,m,j,y,g,u,o,s,c,f,a,h,l,v,d,_,O,e=r;if(i=[].concat(i),m=t.tables[e],j=e.toUpperCase(),y=[],g=[],n.forEach(function(e){var u,t,o,n,s,c,f,a,h,l,n,v,d,u=e.field,t=e.operator,o=e.value,n=e.formula,s=e.valueType,f=!1,l=!1;(0,C.isNullOrUndefined)(t)?(0,C.isNullOrUndefined)(n)||(u=n,l=!0):"object"!=typeof o?c=S.ValueComparatorFactory.createComparator(t):(o instanceof Date||"Date"===s)&&(c=S.ValueComparatorFactory.createDateComparator(t),o=new Date(o),a=o.setHours(0,0,0,0),h=o.setHours(23,59,59,59),o=o.getTime(),f=!0),u!==M&&-1<u.indexOf("@")&&!u.startsWith("=")&&(u="="+u),(c||l)&&(n=void 0,"And"===p||p===M?n=y[y.length-1]||i:"Or"===p&&(n=(n=g[g.length-1])||(w?b:i)),v=[],d=[],n.forEach(function(t){var n,i,r,n=!1,i=null==t?void 0:t[j];i!==M&&null!==i&&(r=null!=(r=m._getValueByField(u,i))?r:"",n=l?r:f?(r=new Date(r).getTime(),c(r,o,a,h)):("Formula"===s&&(o=m._getValueByField(e.value,i)),c(r,o))),(n?v:d).push(t)}),y.push(v),g.push(d))}),"And"===p||p===M)return y[y.length-1];if("Or"===p){for(u=[],o=0,s=y;o<s.length;o++)c=s[o],u=u.concat(c);if(w){for(f=new Array(i.length),a=0,h=i;a<h.length;a++)void 0!==(v=(l=h[a])[e])&&(f[v]=!0);for(d=0,_=u;d<_.length;d++)void 0===(v=(O=_[d])[e])||f[v]||i.push(O);return i}return u}}Object.defineProperty(n,"__esModule",{value:!0}),n.cle=n.ule=n.ole=n.Tfr=void 0,o=i("CalcEngine"),C=i("./dist/src/dataManager.entry.js"),S=i("./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js"),j=i("./dist/src/query/utils/query-utils.js"),M=void 0,n.Tfr=e,s=["AND","OR"],c=["SJS.STARTWITH","SJS.ENDWITH","SEARCH","FIND"],r=/\[@(.*?)\]/,n.ole=w,n.ule=m,n.cle=y},"./dist/src/query/utils/sort-utils.js":function(t,n,i){"use strict";var m,e;function r(t,u){var o,n,i,r,e,o=[],n=function(t){var n,i,r,e,i;for(n in t)t.hasOwnProperty(n)&&(e=r=void 0,s(i=t[n])?r=i:(r=i.order,e=i.list),i={field:n,ascending:"DESC"!==r,list:e,_f:n},null!=u&&u(i),o.push(i))};if((0,m.isArray)(t))for(i=0,r=t;i<r.length;i++)n(e=r[i]);else n(t);return o}function s(t){return"string"==typeof t}function u(i,t,n,r,e,u,o,s){var c,f,a,h,l,c=i.name.toUpperCase(),f=(0,m.ese)(i,t,n,s?e.map(function(t){return s[t][c]}):e,r);if(o=o||e.length,0===(u=u||0)&&o>=e.length)e.sort(function(t,n){return s&&(t=s[t][c],n=s[n][c]),f(i,r,t,n)});else for((a=e.slice(u,o)).sort(function(t,n){return s&&(t=s[t][c],n=s[n][c]),f(i,r,t,n)}),h=0,l=a.length;h<l;h++)e[h+u]=a[h]}function j(t){return t&&0<t.length&&t.some(function(t){return 0<t.length})}function o(t,n,i,r){var a,h,l,v,e,u,d,o,s,c,f,p,w,b,a=[],h=[],l=j(i),v=r&&0<r.length,e=function(t){var n,i,r;return t?(n=t.ascending,i=t._f||t.field,(0,m.isArray)(t.list)&&0<t.list.length?(r=t.list.reduce(function(t,n,i){return t[n]=i,t},{}),n?function(t,n){return g(t[i],n[i],r)}:function(t,n){return g(n[i],t[i],r)}):n?function(t,n){return y(t[i],n[i])}:function(t,n){return y(n[i],t[i])}):function(){return 0}};for(l?a=i.map(function(t){return t.map(e)}):v&&(h=r.filter(function(t){return null!=t}).map(e),v=0<h.length),u=[t],d=0;d<n.length;){for(o=0,s=u.length;o<s;o++)if((c=u.shift()).sort(function(t,n){var i,r,e,u,o,s,c,f,i=0;if(l)for(e=0,u=r=a[d];e<u.length&&0===(i=(o=u[e])(t,n));e++);else if(v)for(s=0,c=h;s<c.length&&0===(i=(f=c[s])(t,n));s++);return i}),d<n.length-1)for(f=n[d+1].field,p=0,w=c;p<w.length;p++)b=w[p],u.push(b[f]);d++}}function y(t,n){return(0,m.isNullOrUndefined)(t)&&(0,m.isNullOrUndefined)(n)?0:(0,m.isNullOrUndefined)(t)?-1:(0,m.isNullOrUndefined)(n)?1:"number"==typeof t||t instanceof Date?t-n:n<t?1:t<n?-1:0}function g(t,n,i){var r=i[t],i=i[n];return r!==e&&i!==e?r-i:r!==e?-1:i!==e?1:y(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.bfr=n.hasGroupSorts=n.JFt=n.getOrderOptions=void 0,m=i("./dist/src/dataManager.entry.js"),e=void 0,n.getOrderOptions=r,n.JFt=u,n.hasGroupSorts=j,n.bfr=o},"./dist/src/query/utils/table-utils.js":function(t,n,i){"use strict";var e,u,o,s;function r(t){for(var n,i,n=[],i=0;i<t;i++)n[i]=i;return n}function c(t,n,i){return!n||!i||n===i||!!t.relationships.filter(function(t){return t.sourceTable===n&&t.targetTable===i||t.sourceTable===i&&t.targetTable===n})[0]}function f(t){var n;return t.W0r||((n=new e.FieldManager(s,t)).prepareFields((0,e.ose)(t)),t.W0r=n),t.W0r}function a(r){var t,t;return r.Q0r||(t=r.POt,t=new e.GroupManager({},t.wEt.bind(t),r.QOt,function(t,n,i){(0,o.JFt)(r,[],s,n,t,i)},function(t,n,i){return(0,u.wfr)(r,t,n,i)}),r.Q0r=t),r.Q0r}function h(t,n,i,r){var e,u,o,e=t._dataSource._data;for(u in n)"recordRowNumbers"!==u&&"recordInIndexMap"!==u&&n.hasOwnProperty(u)&&(e.hasOwnProperty(u)||(e[u]={data:[],Afr:!0},r.push({table:t,groupKey:u}),t.rRt(u)),(o=e[u]).Afr)&&(o.data[i]=n[u])}Object.defineProperty(n,"__esModule",{value:!0}),n.gfr=n.getTableGroupManager=n.getTableFieldManager=n.Ifr=n.gFt=void 0,e=i("./dist/src/dataManager.entry.js"),u=i("./dist/src/query/utils/filter-utils.js"),o=i("./dist/src/query/utils/sort-utils.js"),s=void 0,n.gFt=r,n.Ifr=c,n.getTableFieldManager=f,n.getTableGroupManager=a,n.gfr=h},"./dist/src/query/utils/window-function-utils.js":function(t,n,i){"use strict";var r,a,s,c,f;function e(t,n){var t=t._dataSource.options;n?(t.schema||(t.schema={}),t.schema.window=n):t.schema&&(delete t.schema.window,0===Object.keys(t.schema).length)&&delete t.schema}function u(t,n){var t=t._dataSource.options,i=n;return t.schema?t.schema.window?(i=r(r({},t.schema.window),n),t.schema.window=i):t.schema.window=n:t.schema={window:n},i}function o(u,t,o){t.forEach(function(t){var t,n,i,r,e;if(t)for(t=t.field,i=0,r=n=o.GAe(t);i<r.length;i++)e=r[i],u.push(e)})}function h(t,r,n,e,u,i){l(r,t);var o=r.name.toUpperCase();return v(t,function(t){e=(0,s.CFt)(r,t,e,u,i).newIndexMap},function(t){(0,c.JFt)(r,n,f,t,e,f,f,u)},function(t,n){var i=e.map(function(t){return u[t][o]});n(r.XOt[t],i)},function(){return r.XOt},function(t){return r.GAe(t)}),e}function l(t,n){for(var i,r,i=0;i<n.length;i++)r=n[i],t.bde(r)}function v(t,n,i,r,e,u){for(var o,s,c,f,a,h,o,s=0,c=p(b(t,e,u));s<c.length;s++)d(a=(f=c[s]).partitions,h=f.orderedFunctions,n,i,r);return!0}function d(t,n,i,r,e){var u,o,s,c,f;if((0,a.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,i(t);else for(u=0;u<n.length;u++)for(s=(o=n[u]).orders,(0,a.isArray)(s)&&0<s.length&&r(s),c=o.functions,f=0;f<c.length;f++)e(c[f].windowOverFormula,function(t,n){return t.evaluateWindowFunction(n)})}function p(t){var n,i,n,i;return w(t[0]).windowOverInfos}function w(t){for(var n,i,r,e,u,o,s,s,c,f,f,a,h,l,n={},i=[],u=0;u<t.length;u++)r=(o=t[u]).partitionKey,e=o.orderKey,n[o.partitionKey]||(s={partitions:o.partitions,orderedFunctions:[]},n[o.partitionKey]={index:i.length,orderMap:{},windowOverInfo:s},i.push(s)),(c=(s=n[o.partitionKey]).orderMap)[o.orderKey]||(f={orders:o.orders,functions:[]},c[o.orderKey]={index:s.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:f},s.windowOverInfo.orderedFunctions.push(f)),f=o.frameKey+"__"+o.windowFormula,c[o.orderKey].functionMap[f]||(c[o.orderKey].functionMap[f]=!0,c[o.orderKey].orderFunctions.functions.push({orders:c[o.orderKey].orderFunctions.orders,windowOverFormula:o.windowOverFormula,windowFormula:o.windowFormula,windowFrame:o.windowFrame}));return a=function(t){var n,t,t,i,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[e];1<n.length&&(i=n[t=t.index],n.splice(t,1),n.push(i))},1<i.length?(l=i[u=(h=n[r]).index],i.splice(u,1),i.push(l),a(h)):1===i.length&&a(n[r]),{windowOverInfoMap:n,windowOverInfos:i}}function b(t,n,i){for(var r,e,u,o,s,c,f,a,r=n(),e=[],u=0;u<t.length;u++)if(0<(s=i(o=t[u])).length)for(c=0;c<s.length;c++)!1!==(a=r[f=s[c]]).Khe&&e.push(a.options);return[e,[]]}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.Whe=n.mde=n.afr=n.addWindowFunctionFields=n.setWindowDefOption=n.resetWindowDefOption=void 0,a=i("./dist/src/dataManager.entry.js"),s=i("./dist/src/query/utils/group-utils.js"),c=i("./dist/src/query/utils/sort-utils.js"),f=void 0,n.resetWindowDefOption=e,n.setWindowDefOption=u,n.addWindowFunctionFields=o,n.afr=h,n.mde=l,n.Whe=v},"./dist/src/relationship.js":function(t,n,i){"use strict";var r,a,e,u;function o(t,n,i,r,e,u){this.sourceTable=t,this.sourceFieldName=n,this.sourceRelationshipName=i,this.targetTable=r,this.targetFieldName=e,this.targetRelationshipName=u,i&&(this.sourceField=t.xOt(n,i,r,e,this)),u&&(this.targetField=r.xOt(e,u,t,n,this))}Object.defineProperty(n,"__esModule",{value:!0}),n.Relationship=void 0,r=i("./dist/src/interfaces/interface.js"),a=i("./dist/src/dataSource/utils.js"),e=void 0,o.prototype.Gf=function(t,n,i,r,e,u){return new o(t||this.sourceTable,n||this.sourceFieldName,i||this.sourceRelationshipName,r||this.targetTable,e||this.targetFieldName,u||this.targetRelationshipName)},o.prototype.NOt=function(t){return t===this.targetRelationshipName},o.prototype.VP=function(){this.sourceTable&&this.sourceTable.kOt(this),this.targetTable&&this.targetTable.kOt(this)},o.prototype.DOt=function(t){return this.relationshipMap===r.RelationshipMap.OneToMany&&t===this.sourceRelationshipName?r.RelationshipMap.OneToOne:this.relationshipMap},o.prototype._Ot=function(){var t,n,t=this.sourceTable,n=this.sourceFieldName;if(t.EOt())return t.jOt(n)&&!t.OOt()?r.RelationshipMap.OneToOne:r.RelationshipMap.OneToMany},o.prototype.ROt=function(t){var n=this.relationshipMap;return(0,a.isNullOrUndefined)(n)&&(n=this.relationshipMap=this._Ot()),(0,a.isNullOrUndefined)(n)?t:n===r.RelationshipMap.OneToOne?{_type:"object"}:{_type:"array"}},o.prototype.BOt=function(){var i,r,e,t,u,n,o,s,c;function f(t,n,i){t[n]?(t[n].push(i),t._type="array"):t[n]=[i]}for(i=this.sourceField.LOt={_type:"object"},r=this.targetField.LOt=this.ROt({}),e=this.ROt({_type:"object"}),t=this.sourceTable.getDataSync(),u=this.targetTable.getDataSync(),n=0;n<t.length;n++)o=t[n][this.sourceFieldName],(0,a.isNullOrUndefined)(o)||f(e,o,n);for(s=function(n){var t=u[n][c.targetFieldName];(0,a.isNullOrUndefined)(t)||e[t]&&(r[n]=e[t],e[t].forEach(function(t){f(i,t,n)}))},c=this,n=0;n<u.length;n++)s(n);this.targetField.type=e._type,this.sourceField.type=i._type},o.prototype.dl=function(t){this.sourceField.LOt=e,this.targetField.LOt=e,this.targetTable.FOt(t?this.targetTable===t:e),this.sourceTable.FOt(t?this.sourceTable===t:e)},n.Relationship=o},"./dist/src/res.en.js":function(t,n){"use strict";var i,r,n;function e(t,n){return{description:t,parameters:n}}function u(t,n,i,r){return{name:t,optional:n,repeatable:i,enum:r}}Object.defineProperty(n,"__esModule",{value:!0}),n.resource=void 0,n.resource={Zve:{WINDOW:e("(TableSheet Specific) Determines the rows as the window by partitioning and ordering to apply the window function.",[u("window_function"),u("partition_by",!0),u("order_by",!0),u("frame_rows\\range\\groups",!0)]),WINDOWDEF:e("(TableSheet Specific) Define a shorthand that allow to be reused by the WINDOW function.",[u("partition_by",!0),u("order_by",!0),u("frame_rows\\range\\groups",!0)]),PARTITIONBY:e("(TableSheet Specific) Divides the rows into partitions.",[u("field_function",!(n=[{value:"0",description:"This is the default case, no rows are excluded."},{value:"1",description:"The current row is excluded, the other peers of the current row remain."},{value:"2",description:"The current row and the peers are all excluded."},{value:"3",description:"The current row remain, the other peers are excluded."}]),!0)]),ORDERBY:e("(TableSheet Specific) Defines the logical order in each partition.",[u("field_function",!(r=[{value:"-1",description:"Indicates the lower following of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@+n]",description:"Indicates the n following of the current, if the order is ascending."},{value:"[@-n]",description:"Indicates the n following of the current, if the order is descending."}]),!0)]),ORDERASC:e("(TableSheet Specific) Specifies ascending order for the specified field.",[u("field_function")]),ORDERDESC:e("(TableSheet Specific) Specifies descending order for the specified field.",[u("field_function")]),FRAMEROWS:e("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending rows against the current row.",[u("beginning_function",!(i=[{value:"-1",description:"Indicates the upper boundary of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@-n]",description:"Indicates the n preceding of the current, if the order is ascending."},{value:"[@+n]",description:"Indicates the n preceding of the current, if the order is descending."}]),!1,i),u("ending_function",!0,!1,r),u("exclude_mode",!0,!1,n)]),FRAMERANGE:e("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the value in the current row.",[u("beginning_function",!1,!1,i),u("ending_function",!0,!1,r),u("exclude_mode",!0,!1,n)]),FRAMEGROUPS:e('(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the counting "groups" relative to the current group.',[u("beginning_function",!1,!1,i),u("ending_function",!0,!1,r),u("exclude_mode",!0,!1,n)]),CUMEDIST:e("(TableSheet Specific) The cumulative distribution of a value within a group of values.",[]),W_PERCENTRANK:e("(TableSheet Specific) Calculates the percentage of the relative rank of a row within a partition of rows.",[]),ROWNUMBER:e("(TableSheet Specific) Returns the number of the current row within its partition.",[]),W_RANK:e("(TableSheet Specific) Returns the rank of each row within the partition of a result set.",[]),DENSERANK:e("(TableSheet Specific) Returns the rank of the current row within its partition, without gaps.",[]),LEAD:e("(TableSheet Specific) Provides access to the value from a row at a given physical offset that follows the current row.",[u("value_function"),u("offset",!0),u("default_value",!0)]),LAG:e("(TableSheet Specific) Provides access to the value from a row at a given physical offset that before the current row.",[u("value_function"),u("offset",!0),u("default_value",!0)]),NTILE:e("(TableSheet Specific) Divides a partition into N buckets, assigns each row its bucket number.",[u("n")]),FIRSTVALUE:e("(TableSheet Specific) Access to the value from the first row within the window frame.",[u("value_function")]),LASTVALUE:e("(TableSheet Specific) Access to the value from the last row within the window frame.",[u("value_function")]),NTHVALUE:e("(TableSheet Specific) Access to the value from the n-th row within the window frame.",[u("value_function"),u("n")]),CALCULATE:e("(TableSheet Grouping Specific) Expand the group context for the formula.",[u("formula"),u("remove_filters_function")]),REMOVEFILTERS:e("(TableSheet Grouping Specific) Select the context of the upper group level.",[u("group_field_function",!0,!0)]),CHILDREN:e("(TableSheet Hierarchy Specific) Retrieves the value of the children that be a certain offset from the parent.",[u("level_offset"),u("field_function")]),ONLYCHILDREN:e("(TableSheet Hierarchy Specific) Retrieves the value of the children that be not parent.",[u("field_function")]),PARENT:e("(TableSheet Hierarchy Specific) Retrieves the value of the parent that be a certain offset from the current.",[u("level_offset"),u("field_function")]),LEVEL:e("(TableSheet Hierarchy Specific) Retrieves the level of the current.",[]),LEVELROWNUMBER:e("(TableSheet Hierarchy Specific) Retrieves the row number of the current under its parent.",[])}}},"./dist/src/table/calcField.js":function(t,n,i){"use strict";var r,e,l,v,u,o,s;function c(t,n,i,r){var e,n,u,e=s.call(this)||this;if(e.zAe=0,e.calcSource=n.POt,e.calcService=e.calcSource.getCalcService(),e.GOt=t,(n=e.calcSource).HTe=n.HTe||[],n.HTe.indexOf(t)<0){n.HTe.push(t);try{u=e.expression=i||e.calcService.parse(e.calcSource,t,0,0),e.calcService&&u&&(e.w3=e.calcService.getGlobalSourceModel(),e.w3.cyt(e,0,0,u,u,!0))}catch(t){}n.HTe.pop()}return e.Tl=[],e.dTe=(0,l.isNullOrUndefined)(r)?0:r,e}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CalcField=void 0,e=i("CalcEngine"),l=i("./dist/src/dataSource/utils.js"),v=void 0,s=e.BaseCalc,r(c,s),c.prototype.getKey=function(){var t=this;return"T:"+t.calcSource.nM.name+":"+t.GOt},c.prototype.vyt=function(){this.c_t().I3(this,3)},c.prototype.c_t=function(){return this.calcService},c.prototype.P6t=function(){this.C8()},c.prototype.C8=function(){this.Tl=[],this.Xme=v,this.zAe=0},c.prototype.getValue=function(t){var n,i,r;if(!this.expression)return"Invalid Formula";for((n=this.calcService).VTe=n.VTe||[],n.zTe=n.zTe||[],i=0;i<n.VTe.length;i++)if(n.VTe[i]===this&&n.zTe[i]===t)return n.YTe=!0,this.dTe;if(0!==n.VTe.length||(r=this.Tl[t],(0,l.isUndefined)(r)&&!(0,l.isUndefined)(t))){this.calcSource.pe(t),n.VTe.push(this),n.zTe.push(t);try{r=this.calcService.evaluateExpression(this.calcSource,this.expression,{row:t,col:0},1<n.VTe.length)}catch(t){}n.YTe?r=e.Errors.Calc:1===n.VTe.length&&(this.Tl[t]=r),n.VTe.pop(),n.zTe.pop(),0===n.VTe.length&&delete n.YTe}return r},c.prototype.getValues=function(t,n,i,r,e,u){var o,s,c,f,a,h;if(n=(0,l.isNumber)(n)?n:0,i=(0,l.isNumber)(i)?i:t.length-1,o=[],this.Xme!==t||this.zAe!==t.length)for(s=t.length,this.Xme=t,this.zAe=s,c=0;c<s;c++)o.push(this.getValue(t[c]));if(0===o.length)if(r!==v&&e!==v){for(f=n;f<r;f++)o.push(this.Tl[t[f]]);for(u!==v&&o.push(this.Tl[t[u]]),f=e+1,a=i+1;f<a;f++)o.push(this.Tl[t[f]])}else for(f=n,h=i+1;f<h;f++)o.push(this.Tl[t[f]]);else o=o.slice(n,i+1),r!==v&&e!==v&&(u!==v?o.splice(r-n,e-r+1,o[u-n]):o.splice(r-n,e-r+1));return o},c.prototype.getValueWithContext=function(t){var n,t,n=this.calcSource.DJ,t=this.getValue(t);return this.calcSource.DJ=n,t},c.prototype.insertItem=function(t,n){},c.prototype.getOriginalValue=function(t){},c.prototype.getRelatedTable=function(){},c.prototype.getRelationMaps=function(){},c.prototype.getHostTableIndexes=function(t){},n.CalcField=c},"./dist/src/table/hierarchyField.js":function(t,n,i){"use strict";var r,e,u,o;function s(t,n){this.GOt=t,this.nM=n,this.UOt=new e.CalcField(this.l7t(),n),this.HOt=new u.TableField(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchyField=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/table/calcField.js"),u=i("./dist/src/table/tableField.js"),s.prototype.getKey=function(){return this.UOt.getKey()},s.prototype.vyt=function(){this.UOt.vyt()},s.prototype.c_t=function(){return this.UOt.c_t()},s.prototype.P6t=function(){this.C8()},s.prototype.l7t=function(){return this.nM.isHierarchy()?this.nM._dataSource.l7t(this.GOt):void 0},s.prototype.C8=function(){var t=this.l7t();(0,r.isNullOrEmpty)(t)?this.UOt=null:(0,r.isNullOrUndefined)(this.UOt)||t!==this.UOt.GOt?this.UOt=new e.CalcField(t,this.nM):this.UOt.C8(),this.HOt=new u.TableField(this.GOt,this.nM)},s.prototype.zOt=function(t){var n,n,n=this.nM;if(n.isHierarchy())return n=n.SEt(t),!(0,r.isNullOrUndefined)(n)&&0<n.children.length},s.prototype.getValue=function(t){return(!(0,r.isNullOrUndefined)(this.UOt)&&this.zOt(t)?this.UOt:this.HOt).getValue(t)},s.prototype.getValues=function(t,n){for(var i,r,e,i=[],r=n=n||0,e=t.length;r<e;r++)i.push(this.getValue(t[r]));return i},s.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},s.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},s.prototype.hasItem=function(t){this.HOt.hasItem(t)},s.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},s.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},s.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},s.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},s.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.HierarchyField=s},"./dist/src/table/table.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/table/tableEvents.js"),n),e(i("./dist/src/table/table.js"),n)},"./dist/src/table/table.js":function(t,n,i){"use strict";var r,l,s,e,h,b,o,u,c,v,d,p,f,j,a,w,m,i,y,g,_;function O(t,n){var i,r,e,u;for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i],n)if(n.hasOwnProperty(e)&&r===(u=n[e])&&0<r.rb)return!0}function C(t,n){return O(n.views,t.VOt)}function S(t,n){return-1<t.indexOf("[".concat(n,"]"))||-1<t.indexOf("[@".concat(n))||-1<t.indexOf("[@[".concat(n))}function M(t,n,i,r){var e,u,o,s,i,c,f,a,h;if(0!==n){for(o=i&&i.dataType,s=i&&i.dataMap,c=!!(o=(i="formula"===o&&!(0,b.isNullOrEmpty)(i.value))?m:o),f=t&&"="===t[0]||i?function(t){return(0,b.formatCalcError)(r(t))}:r,a=0;a<n;a++)h=f(a),s&&!(0,b.isNullOrUndefined)(s[h])&&(h=s[h]),c||(0,b.isNullOrUndefined)(h)||(u=h,c=!0),(e=e||{})[h=h instanceof Date?new Date(h.getFullYear(),h.getMonth(),h.getDate()).toISOString():h]||(e[h]=[]),e[h]&&e[h].push(a);return e.K$=o||(c?typeof u:"object"),e}}function F(t,n,i,r,e){var u,o,s,c,c,f,a,h;for(o in e&&(u=n<e-1),t)if(t.hasOwnProperty(o)&&(s=t[o],c=(c=r&&r[o])&&c.dataMap,s)){if(u)for(f in s)s.hasOwnProperty(f)&&(a=s[f],(0,b.fixInsertIndexes)(a,n));h=i[o],s[h=(h=c&&!(0,b.isNullOrUndefined)(c[h])?c[h]:h)instanceof Date?h.toISOString():h]?s[h].push(n):s[h]=[n]}}function N(t,n,i,r,e,u){var t,i,u,t=t[i],i=u&&u.dataMap;t&&e!==r&&(i&&((0,b.isNullOrUndefined)(i[r])||(r=i[r]),(0,b.isNullOrUndefined)(i[e])||(e=i[e])),r instanceof Date&&(r=r.toISOString()),e instanceof Date&&(e=e.toISOString()),u=t[r])&&(1<u.length?u.splice(u.indexOf(n),1):delete t[r],t[e]?t[e].push(n):t[e]=[n])}function T(t,n,i,r){var e,u,o,s,c;for(e in t)if(t.hasOwnProperty(e)&&(u=t[e]))for(o in u)if(u.hasOwnProperty(o)&&(0,b.isArray)(u[o])&&(s=u[o],(0,b.isArray)(s))){if(r&&0<r.length)(0,b.removeIndexes)(s,r,!0);else for(c=0;c<s.length;c++)s[c]>=n+i?s[c]-=i:s[c]>=n&&s[c]<n+i&&(s.splice(c,1),c--);0===s.length&&delete u[o]}}function R(t,n){var t;this.fye=void 0,this.qGr=!1,this.YOt={},this.ZOt={},this.WOt=0,Object.defineProperty(this,"name",{get:function(){return this.Zc},set:function(t){var n,i,r,e,i,n=this.Zc;if(this.Zc=t,i=this.QOt){for(r in this.VOt)this.VOt.hasOwnProperty(r)&&(e=this.VOt[r]).KOt(n,t);delete(i=i.tables)[n],i[t]=this}}}),Object.defineProperty(this,"options",{get:function(){return this._dataSource.options},set:function(t){var n,n,i,n,r,e,i=this;i.JOt=!0,i.qGr=!1,i.zgr=!0,n=i.options,r=i.length(),e=i._dataSource.setDataSourceOptions(t,function(t){var t=t&&t.isDataSourceChanged;i.ase(r,t?m:i.columns,t)}),i.cke((null==(n=n.schema)?void 0:n.window)||{},(null==(n=t.schema)?void 0:n.window)||{}),!i.fye&&e&&e.finally?i.fye=e.finally(function(){i.fye=void 0,i.zgr=!1}):i.zgr=!1}}),this.name=t,t=n instanceof s.DataSource?n:new s.DataSource(n),this._dataSource=t,this.views={},this.VOt={},this.Pq=[],this.XOt={},this.qOt=w,this.JOt=!0,this.qGr=!1,this.aT={}}function I(t){var n,t,i,r,n={data:t.data,remote:t.remote,autoSync:t.autoSync,batch:t.batch,schema:t.schema},t=t.remote;return t&&(i=n.remote={},(r=t.read)&&!(0,b.isFunction)(r)&&(i.read=r),(r=t.create)&&!(0,b.isFunction)(r)&&(i.create=r),(r=t.update)&&!(0,b.isFunction)(r)&&(i.update=r),(r=t.delete)&&!(0,b.isFunction)(r)&&(i.delete=r),(r=t.getColumns)&&!(0,b.isFunction)(r)&&(i.getColumns=r),(r=t.addColumn)&&!(0,b.isFunction)(r)&&(i.addColumn=r),(r=t.updateColumn)&&!(0,b.isFunction)(r)&&(i.updateColumn=r),(r=t.removeColumn)&&!(0,b.isFunction)(r)&&(i.removeColumn=r),r=t.batch)&&!(0,b.isFunction)(r)&&(i.batch=r),n}function E(){return null!==_&&_.apply(this,arguments)||this}r=this&&this.__extends||(g=function(t,n){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.Table=n.updateFilterIndexesCacheOnRemove=n.updateFilterIndexesCacheOnUpdate=n.updateFilterIndexesCacheOnInsert=n.generateFilterIndexCache=n.isInCalcField=void 0,s=i("./dist/src/dataSource/dataSource.js"),e=i("./dist/src/calculation/calcSource.js"),h=i("CalcEngine"),b=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/dataSource/dataSource.interface.js"),u=i("./dist/src/view/view.js"),c=i("./dist/src/interfaces/interface.js"),v=i("./dist/src/table/tableEvents.js"),d=i("./dist/src/table/calcField.js"),p=i("./dist/src/table/tableField.js"),f=i("./dist/src/table/hierarchyField.js"),j=i("./dist/src/table/windowOverField.js"),a=i("./dist/src/table/triggerCalcField.js"),w=null,m=void 0,n.isInCalcField=S,n.generateFilterIndexCache=M,n.updateFilterIndexesCacheOnInsert=F,n.updateFilterIndexesCacheOnUpdate=N,n.updateFilterIndexesCacheOnRemove=T,R.prototype._Et=function(t,n,i){var r,e,n;"="===(n=!(0,b.isNullOrUndefined)(n)&&""!==n?n:"*")[0]?(r=this.bEt(n)).Iwt(0,t,i):(e=(e=this.aT[n])||(this.aT[n]={}),n=t.getKey(),i?e[n]=t:delete e[n])},R.prototype.o_t=function(t,n){var i,r,i=function(t,n){for(var i in t)n&&i.startsWith("T:")||t[i].vyt()};if((0,b.isNullOrUndefined)(t))for(r in this.aT)this.aT[r]&&i(this.aT[r],n);else-1<t.indexOf(".")&&(t=t.split(".")[0]),i(this.aT[t]),i(this.aT["*"])},R.prototype.REt=function(t){var n,i;if(t)this.QOt=t,this.POt=new e.DataManagerCalcSource(t.Lp,this);else{for(n in this.POt=w,this.views)this.views.hasOwnProperty(n)&&this.removeView(n);for(n in this.VOt)this.VOt.hasOwnProperty(n)&&((i=this.VOt[n]).$Ot(this),delete this.VOt[n]);this.QOt=t}},R.prototype.Ywt=function(t,n,i){var r=this.POt;return r.getCalcService().parse(r,t,n||0,i||0)},R.prototype.vde=function(t){var n=this.POt;return n.getCalcService().unparse(n,t,0,0)},R.prototype.nMt=function(t,n,i){var r=this.POt;return(0,b.isNumber)(n)&&r.pe(n),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:i||0})},R.prototype._fe=function(t,n,i){var r=this.POt;return r.pe(n,m,m,i),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:0})},R.prototype.getSourceData=function(){return this._dataSource.zIr()},R.prototype.getDataSync=function(t){return this._dataSource.tOt(t)},R.prototype.NEt=function(t,n){var i,r,e,u,o,s,i=this;if(t){if(0<=t.indexOf(i))return w}else{if(i.tRt)return i.tRt;r=!0,t=[],n=[]}for(t.push(i),n.push(new Promise(function(t){if(i.JOt)return i.fetch().finally(t);t(null)})),e=i.Pq,u=0;u<e.length;u++)(s=(o=e[u]).targetTable)&&s.NEt(t,n);if(r)return i.tRt=Promise.all(n),i.tRt},R.prototype.fetch=function(n){var i,r,e,i=this;return(!0!==n||i.zgr)&&void 0!==i.fye||(i.BEt&&(r=i.columns),e=i.length(),i.fye=i._dataSource.load({reload:n}).then(function(t){return i.isFetched()&&!n||i.ase(e,r,n),Promise.resolve(t)}).finally(function(){i.fye=void 0,i.qGr=!0})),i.fye},R.prototype.isFetched=function(){return!this.JOt},R.prototype.cPt=function(t){var n,i,r,e,u,o,s,c,n=this,i={};if(t&&(r=n.columns))for(o=e=(u=0,b.getObjectKeys)(r);u<o.length;u++)(c=r[s=o[u]]).value&&"="===c.value[0]&&(i[s]=c),"workTime"===c.value&&(i[s]=c),"TaskResources"===c.dataType&&(i[s]=c);return i},R.prototype.V3e=function(i){var r,t,n,e,u,t,o,s,r=this,t=r._dataSource.options.schema,n=r.get(0),e=t&&t.columns;if(e)for(u in(0,b.isNullOrUndefined)(n)&&(n={}),e)n.hasOwnProperty(u)||e[u].spread||(n[u]=e[u]);n&&(t=(0,b.getObjectKeys)(n),o=r.columns=r.cPt(!0),s=r.Pq=r.Pq.filter(function(t){return t.sourceField||t.targetField}),t.forEach(function(t){var n=i&&i[t];o[t]=r.nRt(t,n,e&&e[t]),s.push({name:t})}))},R.prototype.ase=function(t,n,i){var t,r,e,u,o,s,c,f,a,h,r=this,e=r._dataSource.options.schema,u=!0===r.JOt,o=t!==r.length();if((r.JOt||i)&&(r.V3e(n),r.JOt=!1,r.qGr=!0),i&&r.ARt(),e&&e.columns){for(f in c=[],s=e.columns)s[f]&&s[f].indexed&&c.push(f);r.eRt(c)}if(i&&r.clearIndexes(),r.BEt=!1,r.dl(),i)for(h in r._dataSource.pOt(),a=r.views)a.hasOwnProperty(h)&&a[h].iM(o,!0);r.$3e=m,null!=(t=this.QOt)&&t.U0r.qwr(this.name),r.ki(v.Events.TableFetched,{tableName:r.name,reload:i,isFirstTimeFetched:u,isDataLengthChanged:o})},R.prototype.fetchSync=function(t,n,i,r){var e,u,o,n,r,e=this,u=e.length(),o=[];try{o=e._dataSource.loadSync(t,n,r)}catch(t){return e._dataSource.rUr(t),o}return n=m,r=(0,b.isNullOrUndefined)(t),i&&(n=e.columns,r)&&e.V3e(n),e.ase(u,n,!r),o},R.prototype.nRt=function(t,n,i){var u,r,e,o,s,s,u=this,r={jOt:!1};if((0,b.isNullOrUndefined)(n))i&&(i.dataType&&(e=i.dataType),i.isPrimaryKey)&&(r.jOt=i.isPrimaryKey);else{for(o in n)n.hasOwnProperty(o)&&!(0,b.isNullOrUndefined)(n[o])&&(r[o]=n[o]);e=n.W5||n.dataType||i&&i.dataType,(s=n.jOt||n.isPrimaryKey||i&&i.isPrimaryKey)&&(r.jOt=s)}return this.qOt&&0<this.qOt.length&&-1<this.qOt.indexOf(t)&&(r.jOt=!0),r.value=t,r.name=t,i&&!(0,b.isNullOrUndefined)(i.caption)&&(r.caption=i.caption),(i&&"formula"===i.dataType||"formula"===r.dataType)&&(s=(null==i?void 0:i.value)||n.value,r.value="="===s[0]?s:"="+s,r.readonly=!0,r.caption=t),Object.defineProperty(r,"dataType",{get:function(){return e},set:function(t){var t;e!==t&&("rowOrder"!==e&&"rowOrder"!==t||!u.isHierarchy()||u.setHierarchyOptionChanged(),"formula"!==(e=t)&&u._dataSource.xjt(this.name,this.dataType,this.dataPattern),t=this.value,u.dl(t),u.rRt(t))}}),Object.defineProperty(r,"isPrimaryKey",{get:function(){return this.jOt},set:function(t){this.jOt!==t&&(this.jOt=t,u.qOt||(u.qOt=[]),u.qOt.slice().sort().join(",")!==u.Ljt(!0).slice().sort().join(","))&&u.createIndexes(u.qOt)}}),Object.defineProperty(r,"mappedName",{get:function(){return this.value},set:function(n){var i;this.value===n||(0,b.isNullOrEmpty)(n)||(i=this.value,u._dataSource.Njt(i,n),u.dl(i),u.rRt(n),u.oRt(i,n),u.aRt(i,n),u.Pq.forEach(function(t){t.name===i&&(t.name=n)}),u.qOt=(u.qOt||[]).map(function(t){return t===i?n:t}),u.columns[n]=u.columns[i],delete u.columns[i],this.name=this.value=n)}}),Object.defineProperty(r,"relationship",{get:function(){for(var t,n,i,r,t,n=0,i=u.QOt.relationships;n<i.length;n++){if((r=i[n]).sourceTable===u&&r.sourceFieldName===this.value)return{table:r.targetTable,field:r.targetFieldName,sourceName:r.sourceRelationshipName,targetName:r.targetRelationshipName,relationship:r};if(r.targetTable===u&&r.targetFieldName===this.value)return{table:r.sourceTable,field:r.sourceFieldName,sourceName:r.sourceRelationshipName,targetName:r.targetRelationshipName,relationship:r}}},set:function(t){for(var n,i,r,e,n,i=0,r=u.QOt.relationships;i<r.length;i++)if((e=r[i]).sourceRelationshipName===t.sourceName){u.QOt.removeRelationship(e.sourceRelationshipName);break}t.table&&t.field&&u.QOt.addRelationship(u,this.value,t.sourceName,t.table,t.field,t.targetName)}}),r},R.prototype.isDataColumn=function(t){var n=(0,b.isString)(t)?t:t.value;return!((0,b.isFormula)(n)||(0,b.isNamedFormulaColumn)(t)||(0,b.isRelation)(n)||(0,b.isFunction)(n))&&this._dataSource.YAe(n)},R.prototype.canAddedColumn=function(t){return(0,b.isNamedFormulaColumn)(t)&&(0,b.isNullOrUndefined)(this.columns[t.name])||this.isDataColumn(t)},R.prototype.hasExistedColumn=function(t){var t=(0,b.isString)(t)?t:t.name;return!(0,b.isNullOrUndefined)(this.columns[t])},R.prototype.CGe=function(t){(0,b.isNamedFormulaColumn)(t)||(t.name=t.value)},R.prototype.JFe=function(t){this._dataSource.JFe(t);var n=t.name;this.AGe(n),delete this.columns[n],this.Pq.splice(this.Pq.findIndex(function(t){return t.name===n}),1)},R.prototype.addColumn=function(t,n,i){var r,e,r=this;this.CGe(t),this.hasExistedColumn(t)||!this.canAddedColumn(t)?i({type:s.ADD_COLUMN,success:!1}):(this.SGe(t),e=this.RQe(t),this._dataSource.qFe(t,e,function(t){r.dl(),r.Yhe(),n&&n(t)},i))},R.prototype.SGe=function(t,n){var i=t.name,r={name:i};this.columns[i]=this.nRt(i,t),this.rRt(i),(0,b.isNumber)(n)?this.Pq.splice(n,0,r):this.Pq.push(r)},R.prototype.RQe=function(t){var n,i,r,e;if(t&&!(0,b.isUndefined)(t.defaultValue)&&this.isDataColumn(t)){if(n=this.length(),i=[],"object"!=typeof t.defaultValue||t.defaultValue instanceof Date)if((0,b.isFormula)(t.defaultValue))try{for(e=this.Ywt(t.defaultValue),r=0;r<n;r++)i.push(this.nMt(e,r))}catch(t){}else for(r=0;r<n;r++)i.push(t.defaultValue);else if((0,b.isArray)(t.defaultValue))for(r=0;r<n;r++)i.push(t.defaultValue.slice());else for(r=0;r<n;r++)i.push(l({},t.defaultValue));return i}},R.prototype.eGe=function(t){this._dataSource.eGe(t);var n=t.table,t=t.name;n&&(n.column&&(this.columns[t]=n.column),n.field&&this.Pq.splice(n.fieldIndex,0,n.field),this.dl(),this.Yhe())},R.prototype.removeColumn=function(t,n,i){var r,e,r=this;!this.hasExistedColumn(t)||this.lGe(t)||this.hGe(t)?i({type:s.REMOVE_COLUMN,success:!1}):(this.TGe(t,e={}),this._dataSource.iGe(t,function(t){t.table=e,r.dl(),r.Yhe(),n&&n(t)},i))},R.prototype.TGe=function(t,n){var i,r,e,i=!!n;for((n=n||{}).column=this.columns[t],n.name=t,delete this.columns[t],i||(this.dl(),this.Yhe()),this.XOt[t]=m,r=0;r<this.Pq.length;r++)if((e=this.Pq[r]).name===t){this.Pq.splice(r,1),n.field=e,n.fieldIndex=r;break}return r},R.prototype.AGe=function(t){this.dl(t,!0),this.Yhe(),this.ARt(t),this.IGe(t)},R.prototype.uGe=function(t){var n,i,r;if(this._dataSource.uGe(t),n=t.table){if(this.AGe(n.newName),(0,b.isNullOrUndefined)(n.primaryKey)||(this.qOt=""===n.primaryKey?[]:n.primaryKey.split(",")),n.column&&(delete this.columns[n.newName],this.columns[n.name]=n.column),n.field)for(i=0;i<this.Pq.length;i++)(r=this.Pq[i]).name===n.newName&&(r.name=n.name);this.dl(),this.Yhe()}},R.prototype.updateColumn=function(t,n,i,r){var e,u,e=this;!this.hasExistedColumn(t)||this.lGe(t)||this.hGe(t)?r({type:s.UPDATE_COLUMN,success:!1}):((0,b.isNullOrUndefined)(n.value)&&(n.value=t),u={},this.CGe(n),this.xGe(t,n,u),this._dataSource.JEe(t,n,function(t){t.table=u,e.dl(),e.Yhe(),i&&i(t)},r))},R.prototype.xGe=function(n,t,i){var r,e,u,o,s,e,c,f,a,h,r=(0,b.isNamedFormulaColumn)(t),e=this.columns[n].dataType,u=t.dataType,o=!1;for(((o=e===u||(0,b.isNullOrEmpty)(u)||(0,b.isNullOrEmpty)(e)&&(s=this._dataSource.MGe(n))===u?o:!0)||r&&this.columns[n].value!==t.value)&&this.AGe(n),e=this.columns[n],c=t.name,(i=i||{}).column=e,i.name=n,i.newName=c,delete this.columns[n],f=0;f<this.Pq.length;f++)(a=this.Pq[f]).name===n&&(a.name=c);h=t.type!==e.type?l({},t):l(l({},e),t),Object.keys(h).forEach(function(t){"_"===t[0]&&delete h[t]}),this.columns[c]=this.nRt(c,h),e.isPrimaryKey!==t.isPrimaryKey&&(i.primaryKey=this.primaryKey(),t.isPrimaryKey?this.qOt=(this.qOt||[]).concat(c):this.qOt=i.primaryKey.split(",").filter(function(t){return t!==n}))},R.prototype.dGe=function(t){return this.TGe(t.column.name)},R.prototype.vGe=function(t,n){this.SGe(t.originalColumn,n)},R.prototype.mGe=function(t){var n;this.xGe(t.column.name,t.originalColumn)},R.prototype.hGe=function(t){return this._dataSource.hGe(t)},R.prototype.length=function(){return this._dataSource.length()},R.prototype.getDirtyIndexes=function(){return this._dataSource.getDirtyIndexes()},R.prototype.isInserted=function(t){return this._dataSource.isInserted(t)},R.prototype.isUpdated=function(t,n){return this._dataSource.isUpdated(t)||(n?this.uRt(t):m)},R.prototype.getErrorInfo=function(t){return this._dataSource.getErrorInfo(t)},R.prototype.uRt=function(t){var n,i,r,e,u,e,o,s,c,n=this,i=n.Pq;for(n.WOt++,r=0;r<i.length;r++)if(u=(e=i[r]).targetTable,e=e.LOt,u&&C(u,n)&&e&&e[t]&&!u.WOt)for(o=0,s=e[t];o<s.length;o++)if(c=s[o],u.isUpdated(c))return n.WOt--,!0;n.WOt--},R.prototype.iTe=function(){this.Pq.reduce(function(t,n){var n=n.CRt;return n&&t.push(n),t},[]).forEach(function(t){t.VP()})},R.prototype.rTe=function(t){for(var n,i,r,n=t.ltt(),i=0;i<n.length;i++)(r=n[i].CRt)&&(r.sourceTable===t?r.Gf(this):r.Gf(m,m,m,this))},R.prototype.K3e=function(){return this._dataSource.K3e()},R.prototype.m5e=function(){var t,n,i,r,e,u,o,s,c,t=this.$3e;if((0,b.isNullOrUndefined)(t)){for(n=this.name+"__TriggerFormula__"+Math.floor(1e3*Math.random()),(t=this.$3e=new y(n,{data:[]})).REt(this.QOt),t.fetchSync(),t._dataSource.H3e(this._dataSource.DEt),i=this._dataSource.q3e(),e=0,u=r=this._dataSource.DEt;e<u.length;e++)o=u[e],t.p5e(o,i[o]);for(o in this.columns)this.columns.hasOwnProperty(o)&&(s=this.columns[o].value,(0,b.isFormula)(s))&&t.UTe(o,s);for(o in c=this._dataSource.GTe())c.hasOwnProperty(o)&&t.UTe(o,c[o]);t.dl()}return t},R.prototype.y5e=function(t,n,i){var r,e;if(!(0,b.isNullOrUndefined)(t)&&0<Object.keys(t).length){for(e in r=this.m5e(),i?(r._dataSource.insertItem(0,i),r._dataSource.updateItem(0,n)):r._dataSource.insertItem(0,n),r.rTe(this),t)t.hasOwnProperty(e)&&(n[e]=r._getValueByField(e,0));r._dataSource.remove(0,1),r.dl(),r.iTe()}},R.prototype.M5e=function(t){this.y5e(this._dataSource.q3e(),t)},R.prototype.C5e=function(t,n){var n,r,e,i,u,n=this.vRt(n),r=this._dataSource.q3e(o.TriggerWhenType.onNewAndUpdate),e=Object.keys(t),i=function(t){var i;r.hasOwnProperty(t)&&-1===(i=(0,a.getWatchedFields)(r[t])).indexOf("*")&&!e.some(function(n){return i.some(function(t){return t===n})})&&delete r[t]};for(u in r)i(u);this.y5e(r,t,n)},R.prototype.insertItem=function(n,i,r,t,e){var u,o,s,u=this;for(o in this.M5e(i),i)i.hasOwnProperty(o)&&this.o_t(o);this.ki(v.Events.ItemInserting,s={index:n,data:i}),this._dataSource.insertItem(n,i,function(t){u.sRt(n,i),u.cRt(n,i),u.dl(),u.Yhe(),u.ki(v.Events.ItemInserted,s),r&&r(t)},t,e)},R.prototype.recoverItemAtBatch=function(n,i,r,t){var e,u,o,e=this;for(u in this.M5e(i),i)i.hasOwnProperty(u)&&this.o_t(u);this.ki(v.Events.ItemInserting,o={index:n,data:i}),this._dataSource.recoverItemAtBatch(n,i,function(t){e.sRt(n,i),e.cRt(n,i),e.dl(),e.Yhe(),e.ki(v.Events.ItemInserted,o),r&&r(t)},t)},R.prototype.updateItem=function(t,n,i,r){var e,u,o,s,c,f,a,h;for(c in this.C5e(n,t),e=[],u={},o={},s=[],n)n.hasOwnProperty(c)&&(f=n[c],a=this._getValueByField(c,t),(0,b.isNotDeepEqual)(f,a))&&(e=e.concat(this.hge(t,c)),o[c]=a,u[c]=f,s.push(c),this.o_t(c));this.ki(v.Events.ItemUpdating,h={index:t,data:u,originalData:o,changingFields:s}),this._dataSource.updateItemValues(t,u,this.oTe(t,u,o,h,e,i),r)},R.prototype.oTe=function(e,u,o,s,c,f){var a=this;return function(t){var n,i,r;for(n in u)u.hasOwnProperty(n)&&(i=o[n],r=u[n],a.lRt(e,i,r),a.hRt(e,n,i,r));a.dl(),a.Yhe(),a.lge(e,c),a.ki(v.Events.ItemUpdated,s),f&&f(t)}},R.prototype.fRt=function(n,i,r,e,u,o,s){var c=this;return function(t){c.lRt(n,i,r),c.hRt(n,e,i,r),c.dl(),c.Yhe(),c.lge(n,o),c.ki(v.Events.ItemUpdated,u),s&&s(t)}},R.prototype.dRt=function(t,n,i,r,e,u){var o,s,c,o=this.hge(t,i),s=n[i],c={index:t,data:n,field:i,originalValue:r,newValue:s};this.ki(v.Events.ItemUpdating,c),this._dataSource.updateItem(t,n,this.fRt(t,r,s,i,c,o,e),u)},R.prototype.updateItemValue=function(t,n,i,r,e){var u,o,s,c,c,o=this.hge(t,n),s=this._getValueByField(n,t),c=this.vRt(t);c[n]=i,this.ki(v.Events.ItemUpdating,c={index:t,data:c,field:n,originalValue:s,newValue:i}),this._dataSource.updateItemValues(t,((u={})[n]=i,u),this.fRt(t,s,i,n,c,o,r),e)},R.prototype.resetItem=function(n,t,i){var r,t,i,e,i,u,o,s,r=this,t=(0,b.lastCallback)(t,i);this.mRt(n,t.suspend),this._dataSource.isUpdated(n)&&(this.o_t(m,!0),i=t.suspend(),e=i.succeed,i=i.fail,u=this.vRt(n),o=this.gRt(n),s=this.hge(n),this.ki(v.Events.ItemResetting,{index:n}),this._dataSource.resetItem(n,function(t){r.pRt(n,u,o),r.dl(),r.Yhe(),r.lge(n,s),r.ki(v.Events.ItemReset,{index:n,originalData:u,dataBeforeChanged:o}),e(t)},i)),t.execute()},R.prototype.pRt=function(t,n,i){var r,e,u,o,o,r=this,e=r.columns;if(!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(i))for(u in e)e.hasOwnProperty(u)&&(o=(o=e[u]).value instanceof Function?o.value.name:o.value,r.hRt(t,o,n[o],i[o]))},R.prototype.mRt=function(c,f){var a,h,t,n,a=this,h=a.Pq;for(a.WOt++,t=function(t){var t,r,t,n,i,e,u,o,s,o,t=h[t],r=t.targetTable,t=t.LOt;if(r&&C(r,a)&&t&&t[c]&&!r.WOt){for(n=[],i=0,e=t[c];i<e.length;i++)u=e[i],r.isInserted(u)?n.push(u):r.isUpdated(u)&&(s=(o=f()).succeed,o=o.fail,r.resetItem(u,s,o));0<n.length&&(n.sort(function(t,n){return n-t}),n.forEach(function(t){var n=f(),i=n.succeed,n=n.fail;r.qCt(t,1,i,n)}))}},n=0;n<h.length;n++)t(n);a.WOt--},R.prototype.saveItem=function(n,t,i){var r,t,i,e,i,e,u,i,r=this,t=(0,b.lastCallback)(t,i),i=t.suspend(),e=i.succeed,i=i.fail;this.bRt(n,e,i),(this._dataSource.isUpdated(n)||this._dataSource.isInserted(n))&&(e=t.suspend(),u=e.succeed,i=e.fail,this.ki(v.Events.ItemSaving,{index:n}),this._dataSource.saveItem(n,function(t){r.ki(v.Events.ItemSaved,{index:n}),u(t)},i)),t.execute()},R.prototype.bRt=function(t,n,i){var n,r,e,u,o,s,c,s,f,a,h,l,v,l,n=(0,b.lastCallback)(n,i),r=n.suspend,e=this,u=e.Pq;for(e.WOt++,o=0;o<u.length;o++)if(c=(s=u[o]).targetTable,s=s.LOt,c&&C(c,e)&&s&&s[t]&&!c.WOt)for(f=0,a=s[t];f<a.length;f++)h=a[f],(c.isUpdated(h)||c.isInserted(h))&&(v=(l=r()).succeed,l=l.fail,c.saveItem(h,v,l));n.execute(function(){return e.WOt--})},R.prototype.get=function(t){return this._dataSource.get(t)},R.prototype.nv=function(t){return this._dataSource.s7t(t)},R.prototype.TBe=function(){return this._dataSource.TBe()},R.prototype.removeItems=function(t,n,i){var r,e,u,o,u,r=this,e=(0,b.lastCallback)(function(){r.btt(t,n,i)},i),u=e.suspend(),o=u.succeed,u=u.fail;this.yRt(m,m,t,o,u),e.execute()},R.prototype.btt=function(n,i,t){var r,e,u,o,r=this,e=this,u=e.Zc,o={index:n[0],count:n.length,removingIndexes:n,tableName:u};e.o_t(m,!0),this.ki(v.Events.ItemRemoving,o),e._dataSource.removeItems(n,function(t){"number"==typeof t.removedCount&&(o.count=t.removedCount),t.removingIndexes&&(o.removingIndexes=t.removingIndexes),e.dl(),e.Yhe(),e.wRt(),e.MRt(m,m,n),r.ki(v.Events.ItemRemoved,o),i&&i(t)},t)},R.prototype.remove=function(t,n,i,r){var e,u,o,s,o,e=this;void 0===n&&(n=1),s=(o=(u=(0,b.lastCallback)(function(){e.qCt(t,n,i,r)},r)).suspend()).succeed,o=o.fail,this.yRt(t,n,m,s,o),u.execute()},R.prototype.qCt=function(n,i,r,t){var e,u,o,e=this;this.o_t(m,!0),u=this.Zc,o={index:n,count:i,tableName:u,removingIndexes:m},this.ki(v.Events.ItemRemoving,o),this._dataSource.remove(n,i,function(t){"number"==typeof t.removedCount&&(o.count=t.removedCount),t.removingIndexes&&(o.removingIndexes=t.removingIndexes),e.dl(),e.Yhe(),e.wRt(),e.MRt(n,i),e.ki(v.Events.ItemRemoved,o),r&&r(t)},t)},R.prototype.yRt=function(a,h,l,t,n){var t,v,i,d,r,p,e,t=(0,b.lastCallback)(t,n),v=t.suspend,i=this,d=i.Pq;for(i.WOt++,r=function(t){var t,n,i,r,i,t,i,e,u,o,s,c,f,t=d[t],n=t.targetTable,i=t.CRt,r=t.LOt;if(n&&i.NOt(t.name)&&r&&p.JAe(a,h,r,l)&&!n.WOt){if(t=(i=v()).succeed,i=i.fail,e=[],u=function(t){var n=r[t];n&&(e=e.concat(Object.keys(n).map(function(t){return n[t]})))},l&&0<l.length)for(o=0,s=l;o<s.length;o++)u(c=s[o]);else for(f=0;f<h;f++)u(a+f);if(0===e.length)return"continue";n.removeItems(e,t,i)}},p=this,e=0;e<d.length;e++)r(e);t.execute(function(){return i.WOt--})},R.prototype.JAe=function(t,n,i,r){if(r&&0<r.length)return r.some(function(t){return i[t]});for(var e=0;e<n;e++)if(i[t+e])return!0;return!1},R.prototype.getChanges=function(){return this._dataSource.getChanges()},R.prototype.isDataLengthChanged=function(){return this._dataSource.isDataLengthChanged()},R.prototype.submitChanges=function(t,r,e,u){var o=this;return new Promise(function(n,i){o.SRt(t,r,function(t){e&&e(t),n(t)},function(t){u&&u(t),i(t)})})},R.prototype.SRt=function(r,e,n,i){var u,t,o,s,o,u=this,t=(0,b.lastCallback)(function(){u.wRt(),u.ki(v.Events.ChangesSubmitting,m),u._dataSource.submitChanges(function(t,n,i){r?r(t,n,i):u.ki(v.Events.ChangesSubmittedRowFailed,{index:t,reason:n,type:i})},function(t,n,i){e?e(t,n,i):u.ki(v.Events.ChangesSubmittedColumnFailed,{name:t,reason:n,type:i})}).then(function(t){u.ki(v.Events.ChangesSubmitted,t),n(t)}).catch(function(t){i(t)})}),o=t.suspend(),s=o.succeed,o=o.fail;this.TRt(s,o),t.execute()},R.prototype.TRt=function(t,n){var t,i,r,e,u,o,s,o,o,c,o,t=(0,b.lastCallback)(t,n),i=t.suspend,r=this,e=r.Pq;for(r.WOt++,u=0;u<e.length;u++)s=(o=e[u]).targetTable,o=o.LOt,s&&o&&!s.WOt&&(c=(o=i()).succeed,o=o.fail,s.submitChanges(m,m,c,o));t.execute(function(){return r.WOt--})},R.prototype.NGe=function(){return this._dataSource.getColumnChanges()},R.prototype.kGe=function(){var t=this;t._Ge(this.NGe(),t.dGe.bind(t),t.mGe.bind(t),t.vGe.bind(t))},R.prototype._Ge=function(t,n,i,r){var e,u,o;if((0,b.isArray)(t))for(e=0,u=t;e<u.length;e++)switch((o=u[e]).type){case s.ADD_COLUMN:n(o);break;case s.UPDATE_COLUMN:i(o);break;case s.REMOVE_COLUMN:r(o)}},R.prototype.cancelChanges=function(n,t){var i,r,e,i=this,r=(this.NGe()||[]).some(function(t){return"addColumn"===t.type||"removeColumn"===t.type}),e=(0,b.lastCallback)(function(){var t={isDataLengthChanged:i.isDataLengthChanged(),isColumnCountChanged:r};i.ki(v.Events.ChangesCancelling,m),i.kGe(),i._dataSource.cancelChanges(),i.dl(),i.Yhe(),i.wRt(),i.ARt(),i.ki(v.Events.ChangesCancelled,t),n&&n(m)});this.IRt(e.suspend),e.execute()},R.prototype.IRt=function(t){var n,i,r,e,u,e,e,o,e,n=this,i=n.Pq;for(n.WOt++,r=0;r<i.length;r++)u=(e=i[r]).targetTable,e=e.LOt,u&&e&&!u.WOt&&(o=(e=t()).succeed,e=e.fail,u.cancelChanges(o,e));n.WOt--},R.prototype.xRt=function(t,n){var i=t instanceof d.CalcField;return(i=i&&this._dataSource.oke(n)?!1:i)||t instanceof f.HierarchyField||t instanceof a.TriggerCalcField},R.prototype.NRt=function(){var t,i,n,r,e,u,t=this.options.schema.hierarchy.column,i=[new RegExp("(\\[@)(".concat(t,")\\]|(PARENT)|(CHILDREN)|(ONLYCHILDREN)|(LEVEL)|(LEVELROWNUMBER)"))];for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(r=this.XOt[n])instanceof f.HierarchyField&&(r.C8(),i.push(new RegExp("(\\[@)(".concat(r.GOt,")\\]"))));for(n in e=function(t){var n;Object.prototype.hasOwnProperty.call(u.XOt,t)&&(n=u.XOt[t])instanceof d.CalcField&&i.some(function(t){return t.test(n.GOt)})&&n.C8()},(u=this).XOt)e(n)},R.prototype.FOt=function(t){var n,i;for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(i=this.XOt[n],this.xRt(i)?i.C8(t):this.XOt[n]=m)},R.prototype.removeCalcCache=function(t){this.XOt[t]=m},R.prototype.dl=function(t,n){var i,i,r,e;if(null!=(i=this.QOt)&&i.U0r.qwr(this.name),t){for(i=this.XOt[t],this.xRt(i,t)?i.C8():this.XOt[t]=m,r=0;r<this.Pq.length;r++)if(t===(e=this.Pq[r]).name||t===e.sourceField||n&&t===e.targetField)return void(e.LOt&&e.CRt.dl(this))}else for(this.FOt(),r=0;r<this.Pq.length;r++)(e=this.Pq[r]).CRt&&e.CRt.dl(this)},R.prototype.primaryKey=function(t){var t,n,i,r,e,u,o,s,c,f;if(0===arguments.length)return this.qOt||(this.Ljt(),this.createIndexes(this.qOt)),this.qOt.join(",");if(!(0,b.isNullOrUndefined)(t)&&(this.qOt=(this.qOt||[]).concat(t.split(",")),t=this._dataSource.options.schema,!(0,b.isNullOrUndefined)(t))){for(r in i=[],n=t.columns=t.columns||{})Object.prototype.hasOwnProperty.call(n,r)&&(e=n[r]).isPrimaryKey&&i.push(r);if(0===i.length)this.qOt.forEach(function(t){""===t||(0,b.isNullOrUndefined)(t)||(n[t]=n[t]||{},n[t].isPrimaryKey=!0)});else{for(u=0;u<i.length;u++)o=i[u],this.columns&&this.columns[o]&&(this.columns[o].isPrimaryKey=!0);for(s=this.qOt.slice().sort(),i.sort(),c=i,f=0;f<s.length||f<c.length;f++)if(s[f]!==c[f])return void(this.qOt=c)}}},R.prototype.getIndexes=function(){return(0,b.getObjectKeys)(this.YOt)},R.prototype.kRt=function(){return(0,b.getObjectKeys)(this.ZOt)},R.prototype.createIndexes=function(t){for(var n,i,r,e,n=this.YOt,i=0,r=t;i<r.length;i++)n[e=r[i]]||(n[e]=this.DRt(e))},R.prototype.eRt=function(t,n){for(var i,r,e,u,i=this.ZOt,r=0,e=t;r<e.length;r++)i[u=e[r]]&&!n||(i[u]=this._Rt(u))},R.prototype.dropIndexes=function(t){for(var n,i,r,e,n=this.YOt,i=0,r=t;i<r.length;i++)n[e=r[i]]&&delete n[e]},R.prototype.clearIndexes=function(){this.YOt={}},R.prototype.oRt=function(t,n){var i=this.YOt;(0,b.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},R.prototype.IGe=function(t){this.ORt(t)&&this.dropIndexes([t])},R.prototype.ARt=function(t){t?delete this.ZOt[t]:this.ZOt={}},R.prototype.aRt=function(t,n){var i=this.ZOt;(0,b.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},R.prototype.wRt=function(){var t=this.getIndexes();this.clearIndexes(),this.createIndexes(t)},R.prototype.ERt=function(){var t=this.kRt();this.ARt(),this.eRt(t)},R.prototype.DRt=function(t){for(var n,i,r,e,u,i=this.length(),r=0;r<i;r++)(n=n||{})[u="string"!=typeof(u=(e=this.get(r))[t])?String(u):u]||(n[u]=[]),n[u]&&n[u].push(r);return n},R.prototype._Rt=function(n){var i=this;return M(n,this.length(),this.jRt(n),function(t){return i._getValueByField(n,t)})},R.prototype.ORt=function(t){return!!this.YOt[t]},R.prototype.search=function(t,n){if(!(0,b.isNullOrUndefined)(t)&&!(0,b.isNullOrUndefined)(n))return(0,b.isString)(t)||(t=String(t)),this.ORt(n)?this.RRt(t,n):this.BRt(t,n)},R.prototype.mEt=function(t){var i,n,r,e,u,o,i=this.primaryKey().split(",");if(0===i.length||!this.YOt[i[0]])return[];if(1===i.length)return this.YOt[i[0]][t];if((t=t.split("|")).length!==i.length)return[];for(n=0;n<t.length;n++)t[n]=t[n].trim();for(r={},e={},this.YOt[i[0]][t[0]].forEach(function(t){r[t]=1}),u=function(n){o.YOt[i[n]]&&o.YOt[i[n]][t[n]].forEach(function(t){r[t]===n&&(e[t]=n)}),r=e,e={}},o=this,n=1;n<t.length;n++)u(n);return Object.keys(r)},R.prototype.kEt=function(t,n,i){var r,e,u,o,s,c,f,a,h,l,v,d,p,w;if(i){for(r={},e=0;e<n.length;e++)u=n[e],o=this._dataSource._data[u],r[u]=o&&o.data[t];for(c=0,f=s=this.QOt.relationships;c<f.length;c++)if((a=f[c]).sourceTable===this&&a.targetTable!==this){for(h={},l=a.sourceRelationshipName+".",p=v=(d=0,b.getObjectKeys)(a.targetTable.columns);d<p.length;d++)h[w=p[d]]=a.sourceTable._getValueByField(l+w,t);r[a.sourceRelationshipName]=h}}else for(r=[],e=0;e<n.length;e++)r.push(this.rRt(n[e]).getValue(t));return r},R.prototype.ASt=function(t,n,i,r){for(var e,u,o,s,e=[],u=this.length(),o=0;o<u;o++)s=n&&this.rRt(n).getValue(o),n!==w&&s!==t&&String(s)!==t||e.push(this.kEt(o,i||this._dataSource.DEt,r));return e},R.prototype.BRt=function(t,n){for(var i,r,e,u,o,i=[],r=this.length(),e=0;e<r;e++)(o=(u=this.get(e))[n])!==t&&String(o)!==t||i.push(u);return i},R.prototype.RRt=function(t,n){var i,r,n,e,u,o,s,i,r,n=this.YOt[n][t],e=[];if(n)for(u=0,o=n;u<o.length;u++)s=o[u],e.push(this.get(s));return e},R.prototype.sRt=function(t,n){var i,r,e,u,o,s,c,f,i=this.length();for(u in i&&(r=t<i-1),e=this.YOt)if(e.hasOwnProperty(u)&&(o=e[u])){if(r)for(s in o)o.hasOwnProperty(s)&&(c=o[s],(0,b.fixInsertIndexes)(c,t));o[f=n[u]]?o[f].push(t):o[f]=[t]}},R.prototype.cRt=function(t,n){var i=this._dataSource.options.schema;F(this.ZOt,t,n,i&&i.columns,this.length())},R.prototype.lRt=function(t,n,i){var r,e,u,o,r=this.YOt;for(e in r)r.hasOwnProperty(e)&&(u=r[e])&&i!==n&&((o=u[n])&&1<o.length?o.splice(o.indexOf(t),1):delete u[n],u[i]?u[i].push(t):u[i]=[t])},R.prototype.hRt=function(t,n,i,r){N(this.ZOt,t,n,i,r,this.jRt(n))},R.prototype.dge=function(){var t,n,i,t=[];if(this.ZOt)for(i in n=this.ZOt)this.PAe(i)&&t.push(i);return t},R.prototype.ake=function(){var t=this.dge();t&&0<t.length&&this.eRt(t,!0)},R.prototype.uke=function(t){var n,n;return!!(0,b.isFormula)(t)||"formula"===(null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.dataType)||this._dataSource.oke(t)},R.prototype.Nfr=function(t,n){return this.d0r(this.UAe(t),function(t){return t===n})},R.prototype.hge=function(t,n){var i,r,e,i=[];if(this.ZOt)for(e in r=this.ZOt)this.uke(e)&&(n===m||this.Nfr(e,n)&&!this.PAe(e))&&i.push({field:e,originValue:this._getValueByField(e,t)});return i},R.prototype.lge=function(t,n){var i,r,e;if(n&&0<n.length)for(i=0;i<n.length;i++)r=n[i].field,e=n[i].originValue,this.hRt(t,r,e,this._getValueByField(r,t))},R.prototype.MRt=function(t,n,i){T(this.ZOt,t,n,i)},R.prototype.LRt=function(t,n){var i,r,e,u,i=this.ZOt,r=i&&i[t];if(r)for(e in r)if(r.hasOwnProperty(e)&&(u=r[e],(0,b.isArray)(u))&&u.some(function(t){return t===n}))return e},R.prototype.jOt=function(t){return 0<=this.Ljt().indexOf(t)},R.prototype.OOt=function(){return 1<this.Ljt().length},R.prototype.EOt=function(){return 0<this.Ljt().length},R.prototype.Ljt=function(t){var t,n,i,r,e,u,o,s;if(!this.qOt||t)if(t=this._dataSource.options.schema,(0,b.isNullOrUndefined)(t)||(0,b.isNullOrUndefined)(t.columns)||0===Object.keys(t.columns).length)for(n in this.qOt=[],this.columns)this.columns[n].isPrimaryKey&&this.qOt.push(n);else{for(n in r=[],i=t.columns=t.columns||{})i.hasOwnProperty(n)&&(e=i[n]).isPrimaryKey&&r.push(n);for(this.qOt||(this.qOt=[]),u=this.qOt.slice().sort(),r.sort(),o=r,s=0;s<u.length||s<o.length;s++)if(u[s]!==o[s]){this.qOt=o;break}}return this.qOt},R.prototype.defaultView=function(){var r=this;return r.FRt?Promise.resolve(r.FRt):new Promise(function(i,t){r.fetch().then(function(t){var n,n,n,n=r.get(0),n=(0,b.getObjectKeys)(n),n=r.addView(c.DEFAULT_VIEW_NAME,n);r.FRt=n,i(n)})})},R.prototype.addView=function(t,n,i,r){var n=new u.View(t,n,i,r);return(this.views[t]=n).PRt(this),n},R.prototype.GRt=function(t,n){var n=new u.View(t,n);return n.PRt(this),this.QOt.rV[t]=n},R.prototype.removeView=function(t){var n=this.views;n[t].PRt(w),delete n[t],this.URt(t)},R.prototype.URt=function(t){var n,i,r,n=this.QOt.tables;for(i in n)n.hasOwnProperty(i)&&(r=n[i]).VOt[t]&&(r.VOt[t].$Ot(r),delete r.VOt[t])},R.prototype.HRt=function(t){return this.views[t]},R.prototype.zRt=function(t){for(var n,i,r,n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name===t)return r;return null},R.prototype.h1e=function(t){for(var n,i,r,n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name.toUpperCase()===t.toUpperCase())return{field:r,fieldName:r.name};return null},R.prototype.VRt=function(t){var n,i,r,n=this.getDataSync(t),i=[];if(t)for(r=0;r<t.length;r++)i.push(n[t[r]]);else for(r=0;r<n.length;r++)i.push(n[r]);return i},R.prototype.vRt=function(t){return this.VRt([t])[0]},R.prototype.gRt=function(t){return this._dataSource.lOt(t)},R.prototype.YRt=function(t,n){for(var i,r,i=[],r=0;r<n.length;r++)i.push(this._getValueByField(t,n[r]));return i},R.prototype.p5e=function(t,n){var i=this.XOt[t];return i&&i instanceof a.TriggerCalcField||(this.XOt[t]=i=new a.TriggerCalcField(t,n,this)),i},R.prototype.bEt=function(t){var n;return this.XOt[t]||!this.CEt()||(0,b.isNullOrEmpty)(this._dataSource.l7t(t))||(this.XOt[t]=new f.HierarchyField(t,this)),this.XOt[t]||"="!==t[0]||this.bde(t),this.XOt[t]||("="===(null==(n=this.UAe(t))?void 0:n[0])?(this.bde(n),this.XOt[t]=new d.CalcField(n,this)):"="===t[0]?this.XOt[t]=new d.CalcField(t,this):this.XOt[t]=new p.TableField(t,this)),this.XOt[t]},R.prototype.GAe=function(t){return(0,b.isNullOrEmpty)(t)||!(0,b.isString)(t)?[]:(0,j.addWindowOverFormulas)(this.POt,this.UAe(t))},R.prototype.UAe=function(t){var n,n,n,n;return(0,b.isFormula)(t)?t:(n=null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.value,(0,b.isFormula)(n)?n:(n=this._dataSource.BAe(t))&&!(0,b.isFormula)(n)?"="+n:n)},R.prototype.d0r=function(t,n){var i,r,t;return!((0,b.isNullOrEmpty)(t)||!(0,b.isString)(t))&&((i=this.POt.getCalcService()).nke=i.nke||{},i.nke.hasOwnProperty(t)?!(i.YTe=!0):(i.nke[t]=!0,r=this.Ywt(t),delete i.nke[t],t=i.YTe,0===Object.keys(i.nke).length&&(delete i.nke,delete i.YTe),!t&&this.v0r(r,n)))},R.prototype.v0r=function(t,n){var i,r,e,u,o,o,s,c,f,a;if(!(0,b.isNullOrUndefined)(t))if(t.function){for(r=0,e=t.arguments;r<e.length;r++)if(u=e[r],i=this.v0r(u,n))return!0}else if(14===t.type){if(t.value&&!t.value.field.inCircular)return!!(i=n(o=t.value.field.GOt||t.value.Pq.join(".")))||!(!(o=this.UAe(o))||(t.value.field.inCircular=!0,i=this.d0r(o,n),delete t.value.field.inCircular,!i))||void 0}else for(s=0,c=Object.keys(t);s<c.length;s++)if((a=t[f=c[s]])instanceof h.Expression&&(i=this.v0r(t[f],n)))return!0},R.prototype.PAe=function(t){return!(0,b.isNullOrEmpty)(t)&&("object"==typeof t&&"string"==typeof t.aggregate||0<this.GAe(t).length)},R.prototype.UTe=function(t,n){var i=this.XOt[t];return i&&i instanceof d.CalcField||(this.XOt[t]=i=new d.CalcField(n||t,this)),i},R.prototype.wve=function(t){var n,i,r,e,u,o,s,c,f,a,h,l,v,n=this.XOt;if(t.D5?i=t.D5:(i="="!==(i=this.vde(t))[0]?"="+i:i,t.D5=i),u=(e=i).indexOf("=[@"),o=i.lastIndexOf("]"),s=0===u&&o===i.length-1){for(h=a=!1,l=c=u+3,v=f=o-1;l<v&&("["!==i[l]&&c===u+3&&(a=!0,u=l),"]"!==i[v]&&f==o-1&&(h=!0,o=v),!a||!h);l++,v--);e=i.slice(u,o+1)}return r=n[e],(0,b.isNullOrUndefined)(r)&&(r=n[e]=s?new p.TableField(e,this):new d.CalcField(e,this,t)),s?function(t){return r.getValue(t)}:function(t){return r.getValueWithContext(t)}},R.prototype.g0r=function(t,n){var i,r;return(0,j.isWindowOverFormula)(t)&&(t=(i=(0,j.deconstructWindowOverFunction)(this,t)).formulaFromWindowChaining||i.windowOverFormula),r={},(n=n||[]).forEach(function(t){r[t]=!0}),this.d0r(t,function(t){(0,b.isString)(t)&&(0,b.isRelation)(t)&&!r[t]&&(n.push(t),r[t]=!0)}),n},R.prototype.HAe=function(t,n){var i,r,e,u,u,i=this;if(!(0,b.isNullOrEmpty)(t)&&!(0,b.isNullOrUndefined)(n)&&0!==n.length)for(r=1===n.length&&(0,j.isWindowOverFormula)(t),e=0;e<n.length;e++)u=n[e],u=(0,j.deconstructWindowOverFunction)(i,u),r&&(u.originalWindowOverFormula=t),i.Zhe(u.windowOverFormula,u)},R.prototype.bde=function(t){var n,i,n=this;return!this.XOt[t]&&0<(i=n.GAe(t)).length&&(n.HAe(n.UAe(t),i),!0)},R.prototype.Zhe=function(t,n){var i,r,e,u,o,s,c;if(!(this.XOt[t]&&this.XOt[t]instanceof j.WindowOverCalcField)){if(i=n.partitions,r=n.orders,(0,b.isArray)(i))for(e=0;e<i.length;e++)u=i[e],this.columns[u.field]||this.rRt(u.field);if((0,b.isArray)(r))for(e=0;e<r.length;e++)o=r[e],this.columns[o.field]||this.rRt(o.field);s=n.formulaFromWindowChaining||t,c=this.XOt[s],(0,b.isNullOrUndefined)(c)&&(c=new j.WindowOverCalcField(s,this,n)),this.XOt[s]=c,this.XOt[t]=c,(0,b.isNullOrUndefined)(n.originalWindowOverFormula)||(this.XOt[n.originalWindowOverFormula]=c)}return this.XOt[t]},R.prototype.cke=function(t,n){for(var i,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,i=Object.keys(t),r=Object.keys(n),e=[],u=0,o=i.concat(r);u<o.length;u++)if(s=o[u],!n.hasOwnProperty(s)||t[s]!==n[s])for(f=0,a=c=Object.keys(this.XOt);f<a.length;f++)if(h=a[f],(l=this.XOt[h])instanceof j.WindowOverCalcField&&l.options.windowDefineName===s&&-1<h.indexOf('"'.concat(s,'"'))){for(delete this.XOt[h],v=0,d=Object.keys(this.XOt);v<d.length;v++)p=d[v],this.XOt[p]===l&&delete this.XOt[p];e.push(h)}for(w=0,b=e;w<b.length;w++)this.bde(m=b[w])},R.prototype.Yhe=function(){this.Whe(!0)&&this.ake()},R.prototype.Whe=function(t){},R.prototype.fme=function(){return 1===Object.keys(this.views).length},R.prototype.ZRt=function(t){try{this.rRt(t)}catch(t){}var t=this.XOt[t];return t&&t.setValue},R.prototype.WRt=function(t,n,i){this.rRt(t);var r=this.XOt[t];return this.o_t(t),r&&r.setValue&&r.setValue(n,i)},R.prototype.QRt=function(t,n,i,r,e){this.rRt(t);var u=this.XOt[t];return this.o_t(t),u&&u.setItemValue&&u.setItemValue(n,i,r,e)},R.prototype.KRt=function(t,n){this.rRt(t);var t=this.XOt[t];return t&&t.hasItem&&t.hasItem(n)},R.prototype.JRt=function(t,n,i,r,e){this.rRt(t);var u=this.XOt[t];return this.o_t(t),u&&u.insertItem&&u.insertItem(n,i,r,e)},R.prototype._getValueByField=function(t,n,i){return this.rRt(t),this.XOt[t].getValue(n,i)},R.prototype.XRt=function(t,n){return this.rRt(t),this.XOt[t].getOriginalValue(n)},R.prototype.aTe=function(t,n){return this.rRt(t),this.XOt[t].getRelatedModelIndex(n)},R.prototype.qRt=function(t){return this.rRt(t),this.XOt[t].getRelatedTable()},R.prototype.$Rt=function(t){return this.rRt(t),this.XOt[t].getRelationMaps()},R.prototype.tBt=function(t){for(var n,i,r,e,u,o,n=this,i,r,e=0,u=n.QOt.relationships;e<u.length;e++){if((o=u[e]).sourceTable===n&&o.sourceFieldName===t)return o.targetTable;if(o.targetTable===n&&o.targetFieldName===t)return o.sourceTable}},R.prototype.nBt=function(t,n){return this.rRt(t),this.XOt[t].getHostTableIndexes(n)},R.prototype.rRt=function(t){return this.XOt[t]||this.bEt(t),this.XOt[t]},R.prototype.xOt=function(t,n,i,r,e){var n={name:n,sourceField:t,targetTable:i,targetField:r,CRt:e};return this.Pq.push(n),n},R.prototype.kOt=function(t){for(var n=this.Pq.length-1;0<=n;n--)this.Pq[n].CRt===t&&this.Pq.splice(n,1)},R.prototype.eBt=function(t){for(var n,i,r,e,n=[this],i=this.Pq,r=0;r<i.length;r++)(e=i[r].targetTable)&&-1===n.indexOf(e)&&n.push(e);return t?n.slice(1):n},R.prototype.DGe=function(){for(var t,n,i,r,e,t=[],n=[],i=this.Pq,r=0;r<i.length;r++)(e=i[r].targetTable)&&-1===n.indexOf(e)?(n.push(e),(0,b.isNullOrUndefined)(i[r].type)&&this.rRt(i[r].name),t.push({field:i[r].name,tableName:e.name,isMany:"array"===i[r].type,isTable:!0})):t.push({field:i[r].name});return t},R.prototype.jGe=function(t,n){var t,i,i=this;return t?(null==(t=i.qRt(t))?void 0:t.jGe(w,!0))||[]:i.DGe().filter(function(t){return n||t.isTable}).map(function(t){return{table:t.field,tableName:t.tableName,isTable:t.isTable,isMany:t.isMany}})},R.prototype.OGe=function(t){var n,t,n,t,n=this,t=(0,b.isString)(t)?t:t.value;return n.isDataColumn(t)?n.rBt(t):(0,b.isRelation)(t)&&(n=n.qRt(t),t=t.split(".").pop(),n)&&n.columns&&n.columns[t]?n.rBt(t):void 0},R.prototype.iBt=function(n){var i,t,r,i=this,t=i.Pq,r={};return t.forEach(function(t){var t=t.name;r[t]=i._getValueByField(t,n)}),r},R.prototype.ltt=function(){return this.Pq},R.prototype.rBt=function(t){var t=this.jRt(t);return t&&t.dataType},R.prototype.jRt=function(t){var n,i,r,n=this,i=n._dataSource.options.schema;return i&&i.columns&&i.columns[t]?r=i.columns[t]:(0,b.isNullOrUndefined)(n.columns)||(r=n.columns[t]),r},R.prototype.oBt=function(t){var n,i,t;return 0===t.length?[]:((t=(i=(n=this).zRt(t[0]))&&i.targetTable?i.targetTable.oBt(t.slice(1)):[]).unshift(i),t.filter(function(t){return!(0,b.isNullOrUndefined)(t)}))},R.prototype.F_e=function(){var t,n,i,r,t=[],n={},i=this.name;return n[i]||(t.push(i),n[i]=!0),(r=this.QOt)&&this.P_e(r,i,t,n),t},R.prototype.P_e=function(t,n,i,r){for(var e,u,o,s,c,s,e,u=0,o=t.relationships;u<o.length;u++)c=(s=o[u]).sourceTable.name,s=s.targetTable.name,c===n&&s!==n?r[s]||(i.push(s),r[s]=!0,this.P_e(t,s,i,r)):s!==n||c===n||r[c]||(i.push(c),r[c]=!0,this.P_e(t,c,i,r))},R.prototype.BIr=function(){return this._dataSource.MOt()},R.prototype.toJSON=function(t){var n,i,r,n=this.views,i=[];for(r in n)n.hasOwnProperty(r)&&i.push(n[r].toJSON());return{name:this.name,dataSourceOption:I(this._dataSource.options),Ukr:null!=t&&t.n_r?this._dataSource.zIr():m,primaryKey:this.primaryKey(),views:i,columns:this.aBt(this.columns),notFetchAfterLoad:this.B_e}},R.prototype.fromJSON=function(t){for(var i,n,r,e,u,o,s,n,i=this,r,e=0,u=t.views;e<u.length;e++)o=u[e],(s=this.addView(o.name,o.columns,!1,o.options)).fromJSON(o);return this.columns=t.columns,this.columns&&Object.keys(this.columns).forEach(function(t){var n;"="===t[0]&&i.columns[t]&&i.columns[t].value===t&&i.columns[t].caption&&"="!==i.columns[t].caption[0]&&(n=i.columns[t].caption,i.columns[n]=i.columns[t],delete i.columns[t])}),this.primaryKey(t.primaryKey),t.Ukr?n=this.fetchSync(m,!0,m,t.Ukr):this._dataSource&&this._dataSource.Dkr()&&(n=this.fetchSync()),n?Promise.resolve(n):t.notFetchAfterLoad||null!=(n=this.options)&&n.remote&&!this.options.remote.read?Promise.resolve(null):this.fetch()},R.prototype.bind=function(t,n){this._dataSource.bind(t,n)},R.prototype.unbind=function(t,n){this._dataSource.unbind(t,n)},R.prototype.ki=function(t,n){var i;return null!=(i=this.QOt)&&i.U0r.qwr(this.name),this._dataSource.ki(t,n)},R.prototype.vOt=function(t){return this._dataSource.vOt(t)},R.prototype.aBt=function(t){var n,i;for(n in t)t.hasOwnProperty(n)&&!(0,b.isNullOrUndefined)(t[n])&&((i=t[n]).W5=i.dataType);return t},R.prototype.z7t=function(t,n,i){return this._dataSource.z7t(t,n,i)},R.prototype.V7t=function(t){return this._dataSource.V7t(t)},R.prototype.d7t=function(t,n,i){return this._dataSource.d7t(t,n,i)},R.prototype.uBt=function(){return this._dataSource.$jt()},R.prototype.qX=function(){return this._dataSource.qX()},R.prototype.m7t=function(t,n,i,r){return this.CEt()&&this.NRt(),this._dataSource.m7t(t,n,i,r)},R.prototype.lGe=function(t,n){return this._dataSource.lGe(t,n)},R.prototype.CEt=function(){return this._dataSource.isHierarchy()},R.prototype.isHierarchy=function(){return this.CEt()},R.prototype.getHierarchyType=function(){return this._dataSource.Fjt()},R.prototype.isHierarchyOptionChanged=function(){return this._dataSource.a7t()},R.prototype.setHierarchyOptionChanged=function(){this._dataSource.u7t()},R.prototype.rebuildHierarchyStructure=function(){return this._dataSource.load({reload:!0})},R.prototype.SEt=function(t){return this._dataSource.SEt(t)},R.prototype.f7t=function(){return this._dataSource.f7t()},R.prototype.getHierarchyRootNode=function(){return this.f7t()},R.prototype.M7t=function(t){this._dataSource.M7t(t),this.NRt()},R.prototype.S7t=function(t,n){this._dataSource.S7t(t,n),this.NRt()},R.prototype.O7t=function(t,n,i){return this._dataSource.O7t(t,n,i)},R.prototype.L7t=function(t,n,i){return this._dataSource.L7t(t,n,i)},R.prototype.F7t=function(t,n){return this._dataSource.F7t(t,n)},R.prototype.G7t=function(t,n){return this._dataSource.G7t(t,n)},R.prototype.oge=function(t,n){return this._dataSource.oge(t,n)},R.prototype.H7t=function(t){return this._dataSource.H7t(t)},R.prototype.h7t=function(t,n){return this._dataSource.h7t(t,n)},R.prototype.BEe=function(t){return this._dataSource.BEe(t)},R.prototype.REe=function(t){this._dataSource.REe(t)},R.prototype.EEe=function(){return this._dataSource.EEe()},R.prototype.I7t=function(t){this._dataSource.I7t(t)},R.prototype.X7t=function(){return this._dataSource.X7t()},R.prototype.jEe=function(t){return this._dataSource.jEe(t)},R.prototype.OEe=function(t,n){this._dataSource.OEe(t,n)},R.prototype.isColumnSpreadChanged=function(){return this._dataSource.Cue()},R.prototype.setColumnSpreadChanged=function(t){this._dataSource.Sue(t)},n.Table=i=R,r(E,_=i),E.prototype.getDataSync=function(t){var n,i,r,e,n=[];if(t)for(i=0;i<t.length;i++)n.push(this._dataSource.eTe(t[i]));else for(r=0,e=this._dataSource.length();r<e;r++)n.push(this._dataSource.eTe(r));return n},y=E},"./dist/src/table/tableEvents.js":function(t,n){"use strict";var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.Events=void 0,r.TableAdded="TableAdded",r.TableFetched="TableFetched",r.ItemInserting="ItemInserting",r.ItemInserted="ItemInserted",r.ItemUpdating="ItemUpdating",r.ItemUpdated="ItemUpdated",r.ItemResetting="ItemResetting",r.ItemReset="ItemReset",r.ItemSaving="ItemSaving",r.ItemSaved="ItemSaved",r.ItemRemoving="ItemRemoving",r.ItemRemoved="ItemRemoved",r.ChangesSubmitting="ChangesSubmitting",r.ChangesSubmittedRowFailed="ChangesSubmittedRowFailed",r.ChangesSubmittedColumnFailed="ChangesSubmittedColumnFailed",r.ChangesSubmitted="ChangesSubmitted",r.ChangesCancelling="ChangesCancelling",r.ChangesCancelled="ChangesCancelled",r.CalcValueCleared="CalcValueCleared",n.Events=r},"./dist/src/table/tableField.js":function(t,n,i){"use strict";var f,c,a,r;function h(o,s,c){return function(t,n,i,r){var e=o.map[t],u=e;return(0,f.isNullOrUndefined)(u)&&(e=o.map[t]=[]),n[s.targetField]=c._getValueByField(s.sourceField,t),o.relatedTable.JRt(o.subField,void 0,n,function(t){e.push(t.index),t.index=e.length-1,i&&i(t)},r)}}function e(t,o){var e,s,u,t,t,e=this;this.Oit=[],s="string"==typeof t?t.split("."):t,!(u=s[0]&&o.zRt(s[0]))&&s[0]&&(t=o.h1e(s[0]))&&(u=t.field,s[0]=t.fieldName),u&&u.targetTable?(this.relatedTable=u.targetTable,this.map=u.LOt,this.setValue=null,this.map||(u.CRt.BOt(),this.map=u.LOt),this.getRelationMaps=function(){var t=[{name:u.name,relationshipMap:u.CRt.DOt(u.name)}];if(this.relatedTable)return this.subField?t.concat(this.relatedTable.$Rt(this.subField)):t},this.getHostTableIndexes=function(t){var n,i,t,i,r,n=[t];return this.relatedTable?(this.subField&&(n=this.relatedTable.nBt(this.subField,t)),t=void 0,t=(i=u.CRt).targetTable===this.relatedTable?i.targetRelationshipName:i.sourceRelationshipName,i=this.relatedTable.zRt(t),r=i.LOt,n.reduce(function(t,n){return t.concat(r[n])},[])):n},this.getRelatedModelIndex=function(t){var t=this.map[t];if(!(0,f.isNullOrUndefined)(t))return this.relatedTable.aTe(this.subField,t[0])},"object"===u.type?1===s.length?(this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.vRt(t[0])},this.setValue=function(t){var n=t[s[0]];return t[u.sourceField]=n?n[u.targetField]:null,t}):(this.subField=s.slice(1).join("."),this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable._getValueByField(e.subField,t[0],!0)},this.getOriginalValue=function(t){var t=this.map[t];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t[0])},this.setItemValue=function(t,n,i,r){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.QRt(e.subField,t[0],n,i,r)},this.hasItem=function(t){var t=e.map[t];return!(0,f.isNullOrUndefined)(t)&&e.relatedTable.KRt(e.subField,t[0])},this.insertItem=h(this,u,o)):1===s.length?this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?[]:e.relatedTable.VRt(t)}:(t=s[1]-1,isNaN(t)?(this.subField=s.slice(1).join("."),this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.YRt(e.subField,t)},this.getOriginalValue=function(t){var t=this.map[t];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t)},this.hasItem=function(t){var t=e.map[t];return t&&0<t.length},this.insertItem=h(this,u,o)):2===s.length?(this.arrayFieldIndex=s[1]-1,this.getValue=function(t){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.vRt(t)}):(this.arrayFieldIndex=t,this.subField=s.slice(2).join("."),this.getValue=function(t){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable._getValueByField(e.subField,t)},this.getOriginalValue=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t)},this.setItemValue=function(t,n,i,r){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];if(!(0,f.isNullOrUndefined)(t))return e.relatedTable.QRt(e.subField,t,n,i,r)},this.getRelatedModelIndex=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];if(!(0,f.isNullOrUndefined)(t))return this.relatedTable.aTe(this.subField,t)}))):(0===s.length?this.getValue=function(t){return o._dataSource.get(t)}:1===s.length?(this.getValue=function(t){return o._dataSource.getFieldValue(s[0],t)},this.getOriginalValue=function(t){return o._dataSource.getFieldOriginalValue(s[0],t)},this.getRelatedTable=function(){return o},this.setItemValue=function(t,n,i,r){return o.updateItemValue(t,s[0],n,i,r)},this.hasItem=function(t){return o._dataSource.length()>t},this.insertItem=function(t,n,i,r){var e=(0,f.isNullOrUndefined)(t)?o.length():t;return o.insertItem(e,n,function(t){t.index=e,i&&i(t)},r)},this.setFieldValue=function(t,n,i){var t;o._dataSource.updateItemValues(t,((t={})[n]=i,t))}):(this.getValue=function(t){for(var n,i,n=o._dataSource.getFieldValue(s[0],t),i=1;n&&i<s.length;i++)n=(0,f.isArray)(n)?n[s[i]-1]:n[s[i]];return n},this.setItemValue=function(t,n,i,r){var e,u,u,u=o._getValueByField(s[0],t);if(!(0,f.isNullOrUndefined)(u))return u=(0,f.clone)(u,!0),this.setValue(((e={})[s[0]]=u,e),n),o.updateItemValue(t,s[0],u,i,r)}),this.setValue=function(t,n){for(var i,r,e,u,i=t,r=t,e=s.length,u=0;r&&u<e;u++)i=(0,f.isArray)(r)?r[s[u]-1]:r[s[u]],u!==e-1&&(r=i);return r!==i&&(i!==n||(0,f.isNullOrUndefined)(i)&&(0,f.isNullOrUndefined)(n))&&(r[s[e-1]]=n),t})}Object.defineProperty(n,"__esModule",{value:!0}),n.TableField=void 0,f=i("./dist/src/dataSource/utils.js"),c=null,a=void 0,e.prototype.getValue=function(t){return null},e.prototype.getValues=function(t,n,i,r,e,u){var o,s,i;if(n=(0,f.isNumber)(n)?n:0,i=(0,f.isNumber)(i)?i:t.length-1,(o=this.Oit).length!==t.length||this.Xme!==t)for(this.Xme=t,this.Oit=o=[],s=o.length;s<t.length;s++)o.push(this.getValue(t[s]));return i=o.slice(n,i+1),r!==a&&e!==a&&(u!==a?i.splice(r-n,e-r+1,i[u-n]):i.splice(r-n,e-r+1)),i},e.prototype.setValue=function(t,n){return null},e.prototype.setItemValue=function(t,n,i,r){},e.prototype.setFieldValue=function(t,n,i){},e.prototype.hasItem=function(t){},e.prototype.insertItem=function(t,n){},e.prototype.getOriginalValue=function(t){return null},e.prototype.getRelatedTable=function(){if(this.relatedTable)return this.subField?this.relatedTable.qRt(this.subField):this.relatedTable},e.prototype.getRelationMaps=function(){return[]},e.prototype.getHostTableIndexes=function(t){return[t]},e.prototype.getRelatedModelIndex=function(t){return t},n.TableField=e},"./dist/src/table/triggerCalcField.js":function(t,n,i){"use strict";var e,u,o,s,c,f,r;function a(t,n,i){var r,n,t;this.GOt=t,this.nM=i,this.HOt=new f.TableField(t,i),r="=[@".concat(t,"]"),n?(this.MU=n,this.S5e=n.when===o.TriggerWhenType.onNewAndUpdate,this.S5e&&(this.T5e=l(n),this.A5e=-1<n.fields.indexOf("*"),this.I5e=this.A5e||-1<this.T5e.indexOf(t)),r=n.formula,n=["[@".concat(t,"]"),"[@[".concat(t,"]]")],(-1<r.indexOf(n[0])||-1<r.indexOf(n[1]))&&(this.x5e=!0),this.x5e&&(t="".concat(u.TRIGGERFIELDVALUE,'("').concat(t,'", ').concat(this.I5e?0:1,")"),this.N5e=h(h(r,n[0],t),n[1],t),this.vTe=new c.CalcField(this.N5e,this.nM,void 0,e.Errors.Calc))):this.k5e=!0,this.UOt=new c.CalcField(r,i,void 0,e.Errors.Calc)}function h(t,n,i){return t.split(n).join(i)}function l(t){return t.fields.split(",").reduce(function(t,n){return n=n.trim(),(0,s.isNullOrEmpty)(n)||t.push(n),t},[])}Object.defineProperty(n,"__esModule",{value:!0}),n.getWatchedFields=n.TriggerCalcField=void 0,e=i("CalcEngine"),u=i("./dist/src/calculation/functions/triggerFieldValue.js"),o=i("./dist/src/dataSource/dataSource.interface.js"),s=i("./dist/src/dataSource/utils.js"),c=i("./dist/src/table/calcField.js"),f=i("./dist/src/table/tableField.js"),a.prototype.getKey=function(){return this.UOt.getKey()},a.prototype.vyt=function(){this.UOt.vyt()},a.prototype.c_t=function(){return this.UOt.c_t()},a.prototype.P6t=function(){this.C8()},a.prototype.C8=function(){this.UOt.C8(),this.vTe&&this.vTe.C8(),this.HOt=new f.TableField(this.GOt,this.nM),this._5e=!1},a.prototype.getValue=function(t){var n,i,r,n=this,i=this.HOt.getValue(t),r=(0,s.isUndefined)(i);return r?i=!this.k5e&&(r=!this.S5e||this.A5e?r:this.T5e.some(function(t){return!(0,s.isUndefined)(n.nM._dataSource.getFieldValue(t,0))}))?this.x5e?(this.I5e&&!this._5e&&(this._5e=!0),this.evaluateSelfTrigger(t)):this.evaluateTrigger(t):this.nM.XRt(this.GOt,0):!this.I5e||this._5e||e.Convert.BJ(i)||(this._5e=!0,i=this.x5e?this.evaluateSelfTrigger(t):this.evaluateTrigger(t)),i},a.prototype.evaluateTrigger=function(t){var t=this.UOt.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},a.prototype.evaluateSelfTrigger=function(t){var t=this.vTe.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},a.prototype.getValues=function(t,n){for(var i,r,e,i=[],r=n=n||0,e=t.length;r<e;r++)i.push(this.getValue(t[r]));return i},a.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},a.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},a.prototype.hasItem=function(t){this.HOt.hasItem(t)},a.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},a.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},a.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},a.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},a.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.TriggerCalcField=a,n.getWatchedFields=l},"./dist/src/table/windowOverField.js":function(t,n,i){"use strict";var r,o,l,e,v,E,x,a,h,A,u,s,c;function f(t,n,i){var r=c.call(this,i.windowFormula,n)||this;return r.GOt=t,r.options=i,r.zhe=function(t){return n.rRt(t)},r.Qhe={evaluator:r},r.Khe=!0,r.Mve(),r.Cve(),r.m0r(n,t),r}function D(t,n,i,r,e){var u,o,s,c,f;for(void 0===e&&(e=!1),u=i,o=r,s=A;u<=o;)n<=(f=t(c=Math.floor((u+o)/2)))?(e?u=c+1:o=c-1,s=c):e?o=c-1:u=c+1;return s}function P(t,n,i,r,e){var u,o,s,c,f;for(void 0===e&&(e=!1),u=i,o=r,s=A;u<=o;)(f=t(c=Math.floor((u+o)/2)))<=n?(e?o=c-1:u=c+1,s=c):e?u=c+1:o=c-1;return s}function y(t,n,i,r,e){for(var u,o,s,c,f,a,h,l,u=r,o=e,s=A,c=i.length-1;u<=o;){for(a=!0,h=t(f=Math.floor((u+o)/2)),l=c;0<=l;l--)if(i[l]!==n(h,l)){a=!1;break}a?(o=f-1,s=f):u=f+1}return s}function k(t,n,i,r,e){for(var u,o,s,c,f,a,h,l,u=r,o=e,s=A,c=i.length-1;u<=o;){for(a=!0,h=t(f=Math.floor((u+o)/2)),l=c;0<=l;l--)if(i[l]!==n(h,l)){a=!1;break}a?(u=f+1,s=f):o=f-1}return s}function L(t,n,i,r){for(var e,u,o,s,e=i,u=r,o=A;e<=u;)t(s=Math.floor((e+u)/2))===n?(e=s+1,o=s):u=s-1;return o}function V(t,n,i,r){var e,u,o,s,c;for(void 0===r&&(r=!1),e=n,u=i,o=A;e<=u;)c=t(s=Math.floor((e+u)/2)),(0,x.isNullOrUndefined)(c)?(r?u=s-1:e=s+1,o=s):r?e=s+1:u=s-1;return o}function q(t){return(0,x.isNumber)(t)&&-1<t?t:0}function d(t,n,i){var r,e,n;return(0,x.isNullOrEmpty)(n)||!(0,x.isString)(n)?[]:(i=i||[],(r=t.getCalcService()).nke=r.nke||{},r.nke.hasOwnProperty(n)?(r.YTe=!0,[]):(r.nke[n]=!0,e=(0,v.parseFormula)(t,n),delete r.nke[n],n=r.YTe,0===Object.keys(r.nke).length&&(delete r.nke,delete r.YTe),n?[]:(p(t,e,i),i)))}function p(t,n,i){var r,e,u,o,s,c,f;if(!(0,x.isNullOrUndefined)(n))if(n.function)if((0,v.getExprFunctionName)(n)===v.WINDOWOVER)i.push("="+(0,v.unparseExpression)(t,n));else for(r=0,e=n.arguments;r<e.length;r++)p(t,u=e[r],i);else if(14===n.type)n.value&&n.value.field instanceof a.CalcField&&!n.value.field.inCircular&&(n.value.field.inCircular=!0,d(t,n.value.field.GOt,i),delete n.value.field.inCircular);else for(o=0,s=Object.keys(n);o<s.length;o++)(f=n[c=s[o]])instanceof h.Expression&&p(t,n[c],i)}function w(t){var n;return!(0,x.isNullOrEmpty)(t)&&("string"==(n=typeof t)&&-1<t.indexOf(v.WINDOWOVER)||"object"==n&&"string"==typeof t.aggregate)}function b(t){var n=t.indexOf(v.WINDOWOVER);return(0,x.isFormula)(t)?1===n:0===n}function m(t,n){var i,r,e,u,o,s,c,f,a,i=[],r=v.WINDOWOVER.length,e=r+2,u=0,o=0;do{if(-1===(u=t.indexOf(v.WINDOWOVER,u)))break;for(o=u+r,s=0,c="=".concat(v.WINDOWOVER),f=0;o<t.length;o++)if((" "!==(a=t[o])||" "===a&&(!1===n||0<f))&&(c+=a),"("===a)s++;else if(")"===a){if(0===--s)break}else"["===a?f++:"]"===a&&f--}while(o!==t.length&&(i.push(c),u=o,t.length-u>=e));return i}function j(t,n){var t,i,r,e,u,t=t.nMt(t.Ywt(n.replace(v.WINDOWOVER,v.WINDOWOVERDECONSTRUCT))),i=(t.partitions||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field)},"p"),r=(t.orders||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field,"_").concat(n.ascending)},"o"),e="f",u=t.windowFrame;return u&&(e+="__".concat(u.type),u.begin&&(e+="__p__".concat(u.begin.type,"__").concat(u.begin.offset)),u.end)&&(e+="__f__".concat(u.end.type,"__").concat(u.end.offset)),o({partitionKey:i,orderKey:r,frameKey:e,windowOverFormula:n},t)}function g(t){return"["===t[0]&&"]"===t[t.length-1]}function _(t){return(0,x.isFormula)(t)?t.slice(1):g(t)?t:"[".concat(t,"]")}function O(t,n){var i;return(0,x.isNumber)(t)?i=0===t?"[@]":"[@".concat(t,"]"):"current"===t?i="[@]":"unbounded"===t&&(i="-1"),i||(n?"-1":"")}function C(t,n){var i,r,i=[];if(i.push(O(n.from,!0)),r=O(n.to,!1),(0,x.isNullOrEmpty)(r)||i.push(r),!(0,x.isNullOrEmpty)(n.exclude))switch(n.exclude){case l.FrameExcludeNoOthers:i.push(0);break;case l.FrameExcludeCurrentRow:i.push(1);break;case l.FrameExcludeGroup:i.push(2);break;case l.FrameExcludeTies:i.push(3)}return"".concat(t,"(").concat(i.join(),")")}function S(t,n){var n,i,f,i,r,e,u,t,e,o,s,c,a,h,e,u,r;if("string"==typeof t||(0,x.isNullOrUndefined)(t))return t;if(n=!n,i=t.aggregate,!(0,x.isNullOrEmpty)(i)||!n){if(f=[],n&&(0,x.isFormula)(i)&&(i=i.slice(1)),n&&f.push(i),i=t.window,e=t.partitionBy,u=t.orderBy,t=t.frame,(r=!1,x.isArray)(e)?(e=e.filter(function(t){return!(0,x.isNullOrEmpty)(t)}).map(_).join(),f.push("".concat(v.PARTITIONBY,"(").concat(e,")"))):n&&!(0,x.isNullOrEmpty)(i)&&(r=!0,f.push('"'.concat(i,'"'))),!(0,x.isNullOrUndefined)(u)&&((0,x.isArray)(u)?0<u.length:0<Object.keys(u).length))for(s=function(t){var n,i,r,e,u,o,s,c,s,s,n=Object.keys(t);if(0<n.length){for(i=[],r=function(t){return"string"==typeof t||(0,x.isNullOrUndefined)(t)},e=function(t,n){t===l.OrderAsc?i.push("".concat(v.ORDERASC,"(").concat(n,")")):t===l.OrderDesc?i.push("".concat(v.ORDERDESC,"(").concat(n,")")):i.push(n)},u=0,o=n;u<o.length;u++)c=_(s=o[u]),r(s=t[s])?e(s,c):r(s=s.order)&&e(s,c);f.push("".concat(v.ORDERBY,"(").concat(i.join(),")"))}},a=o=(c=0,x.isArray)(u)?u:[u];c<a.length;c++)s(h=a[c]);else!n||r||(0,x.isNullOrEmpty)(i)||(r=!0,f.push('"'.concat(i,'"')));return(0,x.isNullOrUndefined)(t)?!n||r||(0,x.isNullOrEmpty)(i)||f.push('"'.concat(i,'"')):(e=t.rows,u=t.range,r=t.groups,e?f.push(C(v.FRAMEROWS,e)):u?f.push(C(v.FRAMERANGE,u)):r&&f.push(C(v.FRAMEROWS,r))),"=".concat(n?v.WINDOWOVER:v.WINDOWDEF,"(").concat(f.join(),")")}}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.parseWindowOverByOption=n.deconstructWindowOverFunction=n.getWindowOverFormulas=n.isWindowOverFormula=n.hasWindowOverFormulas=n.processWindowOverFormula=n.addWindowOverFormulas=n.WindowOverCalcField=void 0,l=i("./dist/src/dataSource/dataSource.interface.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),v=i("./dist/src/calculation/functions/windowOvers/util.js"),E=i("./dist/src/dataSource/dataSource.interface.js"),x=i("./dist/src/dataSource/utils.js"),a=i("./dist/src/table/calcField.js"),h=i("CalcEngine"),A=-1,c=a.CalcField,r(f,c),f.prototype.P6t=function(){},f.prototype.C8=function(t){!1===t&&!this.p0r||(this.Tl=[],this.Khe=!0,this.Mve())},f.prototype.getValue=function(t){return this.Tl[t]},f.prototype.XBt=function(t,n,i,r){var e,u,o,s,e=this;if(e.Tl||(e.Tl=[]),i=(0,x.isNumber)(i)?i:0,r=(0,x.isNumber)(r)?r:t.length-1,(0,x.isArray)(n))for(o=i,s=0;o<=r;o++,s++)u=t[o],e.Tl[u]=n[s];else for(o=i;o<=r;o++)u=t[o],e.Tl[u]=n;return e.Tl},f.prototype.m0r=function(t,n){var i=this.options.partitions&&this.options.partitions.some(function(t){return(0,x.isRelation)(t.field)}),i;i=(i=i||this.options.orders&&this.options.orders.some(function(t){return(0,x.isRelation)(t.field)}))||t.d0r(n,function(t){return(0,x.isString)(t)&&(0,x.isRelation)(t)}),this.p0r=i},f.prototype.Mve=function(){var t,n,i,r,t=this,n=t.options,i=t.Sve={};if((0,x.isArray)(n.orders))for(r=0;r<n.orders.length;r++)i[n.orders[r].field]={}},f.prototype.Cve=function(){var t=this,n=t.options.windowFormula,i=[e.ROWNUMBER,e.WRANK,e.DENSERANK,e.WPERCENTRANK,e.CUMEDIST,e.LEAD,e.LAG,e.NTILE,e.FIRSTVALUE,e.LASTVALUE,e.NTHVALUE];t.Tve=!i.some(function(t){return-1<n.indexOf(t)})},f.prototype.nMt=function(t,n,i,r,e,u,o){var s,t,n,s=this;return s.calcSource.pe(t,n,i,void 0,r,e,u),(t=7===arguments.length)&&s.calcSource.wEt("extendContext",o),n=s.calcService.evaluateExpression(s.calcSource,s.expression,{row:0,col:0}),t&&s.calcSource.wEt("extendContext"),n},f.prototype.Jhe=function(t,n,i,r,e,u,o,s){var c=this,f=c.Qhe.valueCache,a,u;!(0,x.isNullOrUndefined)(f)||-1===n&&-1===i||(c.Qhe.begin=(0,x.isNumber)(e)?e:n,u=c.nMt(t,n,i,u,o,s,c.Qhe),(0,x.isNumber)(r)&&(n=i=r),f=c.Qhe.valueCache,(0,x.isNullOrUndefined)(f)||(u=f,n=e,i=void 0),c.XBt(t,u,n,i))},f.prototype.Ave=function(t){return this.Sve[t]},f.prototype.Ive=function(t,n,i){var r=n[i];return r=void 0===r?n[i]=this.calcSource.nM._getValueByField(t,i):r},f.prototype.evaluateWindowFunction=function(t,n){var i=this;i.Xhe(t,n||0),i.qhe(),i.Khe=!1},f.prototype.qhe=function(){this.Qhe.begin=void 0,this.Qhe.valueCache=void 0},f.prototype.Xhe=function(t,n){var i=this,r=i.options.windowFrame;r&&r.begin&&-1===r.begin.offset&&r.end&&-1===r.end.offset||(i.Tve?i.$he(i.options.windowFrame,t,n):i.Jhe(t,n,void 0,void 0,n))},f.prototype.$he=function(t,n,i){for(var r,e,u,o,s,r=this,e={startIndex:i,endIndex:i,lastStartIndex:i,lastEndIndex:i},u=r.cye(n,i),o=i,s=n.length;o<s;o++)r.Vhe(t,i,o,n,e,u),r.Jhe(n,e.startIndex,e.endIndex,o,i,e.gapStartIndex,e.gapEndIndex,e.currentIndex)},f.prototype.Vhe=function(t,n,i,r,e,u){var o,s,c,f,a,h,l,v,t,v,t,o=this,l=E.WindowOverFrameExcludeMode.none;(e.gapStartIndex=e.gapEndIndex=e.currentIndex=void 0,x.isNullOrUndefined)(t)?a=(0,x.isNullOrUndefined)(o.options.orders)||0===o.options.orders.length?(s=E.WindowOverFrameType.ROWS,c=E.WindowOverFramePreceding.UnBounded,E.WindowOverFrameFollowing.UnBounded):(s=E.WindowOverFrameType.RANGE,c=E.WindowOverFramePreceding.UnBounded,E.WindowOverFrameFollowing.CurrentRow):(s=t.type,l=t.exclude||l,v=t.begin,t=t.end,v?(c=v.type,f=v.offset):c=E.WindowOverFramePreceding.UnBounded,t?(a=t.type,h=t.offset):a=E.WindowOverFrameFollowing.CurrentRow,s!==E.WindowOverFrameType.RANGE&&s!==E.WindowOverFrameType.GROUPS||!(0,x.isNullOrUndefined)(o.options.orders)&&0!==o.options.orders.length||(s=E.WindowOverFrameType.ROWS,c=E.WindowOverFramePreceding.UnBounded,a=E.WindowOverFrameFollowing.UnBounded)),v=r.length-1,s===E.WindowOverFrameType.RANGE?(e.startIndex=e.lastStartIndex,e.endIndex=e.lastEndIndex,c===E.WindowOverFrameFollowing.NFollowing?e.startIndex=o.nde(c,f,n,v,i,r,-1===e.startIndex?i+1:e.startIndex,!0):e.startIndex=o.tde(c,f,n,i,r,-1===e.startIndex?n:e.startIndex),a===E.WindowOverFramePreceding.NPreceding?e.endIndex=o.tde(a,h,n,i,r,-1===e.endIndex?n:e.endIndex,!0):e.endIndex=o.nde(a,h,n,v,i,r,-1===e.endIndex?i+1:e.endIndex),e.startIndex>e.endIndex?(e.startIndex=-1,e.endIndex=-1):(o.jme(c,a,n,v,e),e.lastStartIndex=e.startIndex,e.lastEndIndex=e.endIndex,o.lye(r,e,i,l))):s===E.WindowOverFrameType.GROUPS?(t=o.hye(u,i),c===E.WindowOverFrameFollowing.NFollowing?e.startIndex=o.dye(c,f,v,i,u,t,!0):e.startIndex=o.vye(c,f,n,i,u,t),a===E.WindowOverFramePreceding.NPreceding?e.endIndex=o.vye(a,h,n,i,u,t,!0):e.endIndex=o.dye(a,h,v,i,u,t),o.jme(c,a,n,v,e),o.mye(e,i,l,u&&u[t])):s===E.WindowOverFrameType.ROWS&&(c===E.WindowOverFrameFollowing.NFollowing?e.startIndex=o.ide(c,f,v,i):e.startIndex=o.ede(c,f,n,i),a===E.WindowOverFramePreceding.NPreceding?e.endIndex=o.ede(a,h,n,i):e.endIndex=o.ide(a,h,v,i),o.jme(c,a,n,v,e),o.gye(r,e,i,l))},f.prototype.pye=function(t,n){t.startIndex<=n&&n<=t.endIndex&&(t.startIndex===n&&t.endIndex===n?(t.startIndex=-1,t.endIndex=-1):t.startIndex===n?t.startIndex=n+1:t.endIndex===n?t.endIndex=n-1:(t.gapStartIndex=n,t.gapEndIndex=n))},f.prototype.lye=function(e,t,n,i){var u,r,o,s,c,f,a,h,l,v,d,p,w,b,m,j,u=this;if(i===E.WindowOverFrameExcludeMode.current)u.pye(t,n);else if(i!==E.WindowOverFrameExcludeMode.none){if(a=f=c=void 0,o=(r=u.options.orders)&&0<r.length){for(s=[],h=[],l=[],d=v=void 0,p=e[n],w=r.length-1,b=0;b<=w;b++)v=r[b].field,d=u.Ave(v),h.push(v),l.push(d),s.push(u.Ive(v,d,p));c=function(t){return e[t]},f=function(t,n){return u.Ive(h[n],l[n],t)},a=function(t){var n,i,r,n=e[t],i=!(0,x.isNumber)(n);if(!i)for(r=w;0<=r;r--)if(s[r]!==u.Ive(h[r],l[r],n)){i=!0;break}return!i}}i===E.WindowOverFrameExcludeMode.group?o&&t.startIndex<=n&&n<=t.endIndex&&(a((m=n)-1)&&(m=y(c,f,s,t.startIndex,n-1))===A&&(m=n),a((j=n)+1)&&(j=k(c,f,s,n+1,t.endIndex))===A&&(j=n),t.gapStartIndex=m,t.gapEndIndex=j,m===t.startIndex&&(t.startIndex=j+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),j===t.endIndex&&(t.endIndex=m-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),t.startIndex>t.endIndex)&&(t.startIndex=-1,t.endIndex=-1):i===E.WindowOverFrameExcludeMode.ties&&o&&t.startIndex<=n&&n<=t.endIndex&&(m=A,a(n-1)&&(m=y(c,f,s,t.startIndex,n-1)),j=A,a(n+1)&&(j=k(c,f,s,n+1,t.endIndex)),t.gapStartIndex=m,t.gapEndIndex=j,m===A&&j===A?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):m===A?t.gapStartIndex=n+1:j===A?t.gapEndIndex=n-1:t.currentIndex=n)}},f.prototype.mye=function(t,n,i,r){var e,u,o,e=this;(0,x.isNullOrUndefined)(r)||(i===E.WindowOverFrameExcludeMode.current?e.pye(t,n):i===E.WindowOverFrameExcludeMode.group?(u=r.begin,o=r.end,t.startIndex<u&&o<t.endIndex?(t.gapStartIndex=u,t.gapEndIndex=o):t.startIndex===u&&t.endIndex===o?(t.startIndex=-1,t.endIndex=-1):t.startIndex<=o&&t.startIndex>=u?t.startIndex=o+1:t.endIndex<=o&&t.endIndex>=u&&(t.endIndex=u-1)):i===E.WindowOverFrameExcludeMode.ties&&(u=r.begin,o=r.end,t.startIndex===u&&t.endIndex===o?(t.startIndex=n,t.endIndex=n):t.startIndex<=u&&o<=t.endIndex?(t.gapStartIndex=u,t.gapEndIndex=o,t.currentIndex=n):t.startIndex<=o&&t.startIndex>=u?n<t.startIndex?t.startIndex=o+1:(t.gapStartIndex=t.startIndex,t.gapEndIndex=o,t.currentIndex=n):t.endIndex<=o&&t.endIndex>=u&&(n>t.startIndex?t.endIndex=u-1:(t.gapStartIndex=u,t.gapEndIndex=t.endIndex,t.currentIndex=n))))},f.prototype.gye=function(e,t,n,i){var u,r,o,s,c,f,a,h,l,v,d,p,w,b,m,j,u=this;if(i===E.WindowOverFrameExcludeMode.current)u.pye(t,n);else if(i!==E.WindowOverFrameExcludeMode.none){if(a=f=c=void 0,o=(r=u.options.orders)&&0<r.length){for(s=[],h=[],l=[],d=v=void 0,p=e[n],w=r.length-1,b=0;b<=w;b++)v=r[b].field,d=u.Ave(v),h.push(v),l.push(d),s.push(u.Ive(v,d,p));c=function(t){return e[t]},f=function(t,n){return u.Ive(h[n],l[n],t)},a=function(t){var n,i,r,n=e[t],i=!(0,x.isNumber)(n);if(!i)for(r=w;0<=r;r--)if(s[r]!==u.Ive(h[r],l[r],n)){i=!0;break}return!i}}i===E.WindowOverFrameExcludeMode.group?(!o||(t.startIndex<n&&n<t.endIndex?(a((m=n)-1)&&(m=y(c,f,s,t.startIndex,n-1))===A&&(m=n),a((j=n)+1)&&(j=k(c,f,s,n+1,t.endIndex))===A&&(j=n),t.gapStartIndex=m,t.gapEndIndex=j,m===t.startIndex&&(t.startIndex=j+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),j===t.endIndex&&(t.endIndex=m-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0)):n<=t.startIndex?a(t.startIndex)&&(j=k(c,f,s,t.startIndex,t.endIndex))!==A&&(t.startIndex=j+1):n>=t.endIndex&&a(t.endIndex)&&(m=y(c,f,s,t.startIndex,t.endIndex))!==A&&(t.endIndex=m-1),t.startIndex>t.endIndex))&&(t.startIndex=-1,t.endIndex=-1):i===E.WindowOverFrameExcludeMode.ties&&(o?(t.startIndex<=n&&n<=t.endIndex?(m=A,a(n-1)&&(m=y(c,f,s,t.startIndex,n-1)),j=A,a(n+1)&&(j=k(c,f,s,n+1,t.endIndex)),t.gapStartIndex=m,t.gapEndIndex=j,m===A&&j===A?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):m===A?t.gapStartIndex=n+1:j===A?t.gapEndIndex=n-1:t.currentIndex=n):n<t.startIndex?a(t.startIndex)&&(j=k(c,f,s,t.startIndex,t.endIndex))!==A&&(t.startIndex=j+1):n>t.endIndex&&a(t.endIndex)&&(m=y(c,f,s,t.startIndex,t.endIndex))!==A&&(t.endIndex=m-1),t.startIndex>t.endIndex&&(t.startIndex=-1,t.endIndex=-1)):(t.startIndex=n,t.endIndex=n))}},f.prototype.jme=function(t,n,i,r,e){t===E.WindowOverFramePreceding.UnBounded?n===E.WindowOverFramePreceding.NPreceding?-1!==e.startIndex&&-1===e.endIndex&&(e.startIndex=-1):n===E.WindowOverFrameFollowing.NFollowing&&-1!==e.startIndex&&-1===e.endIndex&&(e.endIndex=r):t===E.WindowOverFramePreceding.NPreceding?n===E.WindowOverFramePreceding.NPreceding||n===E.WindowOverFramePreceding.CurrentRow?-1===e.startIndex&&-1!==e.endIndex&&(e.startIndex=i):n!==E.WindowOverFrameFollowing.NFollowing&&n!==E.WindowOverFrameFollowing.UnBounded||(-1===e.startIndex&&(e.startIndex=i),-1===e.endIndex&&(e.endIndex=r)):t===E.WindowOverFramePreceding.CurrentRow?n===E.WindowOverFrameFollowing.NFollowing&&-1===e.endIndex&&(e.endIndex=r):t===E.WindowOverFrameFollowing.NFollowing&&(n===E.WindowOverFrameFollowing.NFollowing?-1!==e.startIndex&&-1===e.endIndex?e.endIndex=r:-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1):n===E.WindowOverFrameFollowing.UnBounded&&-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1))},f.prototype.ede=function(t,n,i,r){var e;switch(t){case E.WindowOverFramePreceding.UnBounded:e=i;break;case E.WindowOverFramePreceding.NPreceding:e=i<=(e=r-q(n))?e:-1;break;default:E.WindowOverFramePreceding.CurrentRow;e=r}return e},f.prototype.ide=function(t,n,i,r){var e;switch(t){case E.WindowOverFrameFollowing.UnBounded:e=i;break;case E.WindowOverFrameFollowing.NFollowing:e=(e=r+q(n))<=i?e:-1;break;default:E.WindowOverFrameFollowing.CurrentRow;e=r}return e},f.prototype.vye=function(t,n,i,r,e,u,o){var s,c,c;switch(t){case E.WindowOverFramePreceding.UnBounded:s=i;break;case E.WindowOverFramePreceding.NPreceding:s=i,(0,x.isNullOrUndefined)(e)||(c=e[u-q(n)],s=(0,x.isNullOrUndefined)(c)?-1:o?c.end:c.begin);break;case E.WindowOverFramePreceding.CurrentRow:s=r,(0,x.isNullOrUndefined)(e)||(c=e[u],s=o?c.end:c.begin);break;default:s=r}return s},f.prototype.dye=function(t,n,i,r,e,u,o){var s,c,c;switch(t){case E.WindowOverFrameFollowing.UnBounded:s=i;break;case E.WindowOverFrameFollowing.NFollowing:s=i,(0,x.isNullOrUndefined)(e)||(c=e[u+q(n)],s=(0,x.isNullOrUndefined)(c)?-1:o?c.begin:c.end);break;case E.WindowOverFrameFollowing.CurrentRow:s=r,(0,x.isNullOrUndefined)(e)||(c=e[u],s=o?c.begin:c.end);break;default:s=r}return s},f.prototype.tde=function(t,n,i,r,e,u,o){var s,c,f,a,h,l,v,d,p,v,w,b,m,j,y,g,_,O,C,S,M,F,N,m,T,s=this,f=s.options.orders;switch(t){case E.WindowOverFramePreceding.NPreceding:if(n=q(n),c=i,1===f.length&&i<=(c=r))if(a=f[0].field,h=f[0].ascending,l=s.Ave(a),v=s.Ive(a,l,e[r]),(0,x.isNullOrUndefined)(v)){if(d=e[r-1],v!==(p=s.Ive(a,l,d)))return c;c=u}else(0,x.isNumber)(v)&&(v=!1===h?v+n:v-n,w=function(t){return s.Ive(a,l,e[t])},m=e[b=r-1],c=(y=(j=!(0,x.isNumber)(m)||r===i)||(!1===h?v<s.Ive(a,l,m):v>s.Ive(a,l,m)))?o?j?-1:b:r:o?!1===h?D(w,v,u,b,!0):P(w,v,u,b):!1===h?P(w,v,u,b,!0):D(w,v,u,b));break;case E.WindowOverFramePreceding.UnBounded:c=i;break;default:E.WindowOverFramePreceding.CurrentRow;if(i<(c=r)){if(1===f.length){if(g=f[0].field,_=s.Ave(g),O=s.Ive(g,_,e[r]),d=e[r-1],O!==(C=s.Ive(g,_,d)))return c}else{for(O=[],S=[],M=[],_=g=void 0,F=e[r],N=0;N<f.length;N++)g=f[N].field,_=s.Ave(g),S.push(g),M.push(_),O.push(s.Ive(g,_,F));for(d=void 0,m=O.length-1,d=e[r-1],T=m;0<=T;T--)if(O[T]!==s.Ive(S[T],M[T],d))return c}c=u}}return c},f.prototype.nde=function(t,n,i,r,e,u,o,s){var c,f,a,h,l,v,d,p,w,b,m,j,d,y,g,_,O,g,C,S,M,F,N,T,R,y,I,c=this,a=c.options.orders;switch(t){case E.WindowOverFrameFollowing.NFollowing:n=q(n),f=r,1===a.length&&(h=a[0].field,l=a[0].ascending,v=c.Ave(h),d=c.Ive(h,v,u[e]),p=function(t){return c.Ive(h,v,u[t])},(0,x.isNullOrUndefined)(d)?(w=!0,e!==i&&(b=u[e-1],w=!(0,x.isNumber)(b)||d!==c.Ive(h,v,b)),f=o,w&&(m=u[e+1],f=(j=!(0,x.isNumber)(m)||d!==c.Ive(h,v,m))?e:V(p,o,r,!1===l))):(0,x.isNumber)(d)&&(d=!1===l?d-n:d+n,m=u[y=e+1],f=(j=(g=!(0,x.isNumber)(m)||e===r)||(!1===l?d>c.Ive(h,v,m):d<c.Ive(h,v,m)))?s?g?-1:y:e:s?!1===l?P(p,d,o,r,!0):D(p,d,o,r):!1===l?D(p,d,o,r,!0):P(p,d,o,r)));break;case E.WindowOverFrameFollowing.UnBounded:f=r;break;default:E.WindowOverFrameFollowing.CurrentRow;if(1===a.length)_=a[0].field,O=c.Ave(_),g=c.Ive(_,O,u[e]),p=function(t){return c.Ive(_,O,u[t])},w=!0,e!==i&&(b=u[e-1],w=!(0,x.isNumber)(b)||g!==c.Ive(_,O,b)),f=o,w&&(m=u[e+1],f=(j=!(0,x.isNumber)(m)||g!==c.Ive(_,O,m))?e:L(p,g,o,r));else{for(C=[],S=[],M=[],N=F=void 0,T=u[e],R=0;R<a.length;R++)F=a[R].field,N=c.Ave(F),S.push(F),M.push(N),C.push(c.Ive(F,N,T));y=function(t){var n,i,r,n=u[t],i=!(0,x.isNumber)(n);if(!i)for(r=a.length-1;0<=r;r--)if(C[r]!==c.Ive(S[r],M[r],n)){i=!0;break}return i},f=o,w=!0,(w=e!==i?y(e-1):w)&&((j=y(e+1))||(f=k(I=function(t){return u[t]},p=function(t,n){return c.Ive(S[n],M[n],t)},C,o+1,r))===A)&&(f=e)}}return f},f.prototype.cye=function(t,n){var i,r,e,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,j,i=this,r=i.options.orders,e=i.options.windowFrame&&i.options.windowFrame.type;if(r&&0<r.length&&e===E.WindowOverFrameType.GROUPS){if(e=t[n],u=[{begin:n,end:n}],1<t.length-n){for(o=[],s=[],c=[],a=f=void 0,h=e,l=r.length-1,v=0;v<=l;v++)f=r[v].field,a=i.Ave(f),s.push(f),c.push(a),o.push(i.Ive(f,a,h));for(v=n+1,d=t.length;v<d;v++){for(p=t[v],w=[],b=!0,m=0;m<=l;m++)j=i.Ive(s[m],c[m],p),w.push(j),o[m]!==j&&(b=!1);b?u[u.length-1].end=v:(o=w,u[u.length]={begin:v,end:v})}}return u}},f.prototype.hye=function(t,n){var i,r,e;if(!(0,x.isNullOrUndefined)(t))for(i=0,r=t.length;i<r;i++)if((e=t[i]).begin<=n&&n<=e.end)return i},n.WindowOverCalcField=f,n.addWindowOverFormulas=d,n.processWindowOverFormula=p,n.hasWindowOverFormulas=w,n.isWindowOverFormula=b,n.getWindowOverFormulas=m,n.deconstructWindowOverFunction=j,n.parseWindowOverByOption=S},"./dist/src/undo/changesHelper.js":function(t,n,i){"use strict";var r,e,c,u;function o(t){this.zQt=t,this.P8=0,this.G8=[]}r=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ChangesHelper=void 0,e=i("./dist/src/dataSource/dataSource.entry.js"),c=i("./dist/src/undo/interface.js"),o.prototype.SRe=function(){return{inTransaction:this.P8,changes:r([],this.G8,!0)}},o.prototype.ARe=function(t){var n=t.inTransaction,t=t.changes;this.P8=n,this.G8=t},o.prototype.vCn=function(){this.P8++},o.prototype.FCn=function(){this.P8=Math.max(this.P8-1,0)},o.prototype.lM=function(){return 0<this.P8},o.prototype.FEe=function(t){if(this.lM())return this.G8.push(t),this.G8},o.prototype.LEe=function(){return r([],this.G8,!0)},o.prototype.PEe=function(){this.G8=[]},o.prototype.Mtt=function(t){var n,i,r,e,u,o,u,i=t.type;if(i===c.ViewChangeType.Update||i===c.ViewChangeType.Insert)return this.GEe(t);if(i===c.ViewChangeType.DefineColumnRemoveColumn||i===c.ViewChangeType.DefineColumnModifyColumn||i===c.ViewChangeType.DefineColumnAddColumn||i===c.ViewChangeType.UpdateColumn||i===c.ViewChangeType.UpdateColumnName||i===c.ViewChangeType.DeleteColumn||i===c.ViewChangeType.AddColumn||i===c.ViewChangeType.MoveColumnOptions||i===c.ViewChangeType.MoveColumnInfos||i===c.ViewChangeType.RemoveCrossFields||i===c.ViewChangeType.RemoveColumnInfoOptions||i===c.ViewChangeType.UpdateCrossColumnIndex)this.UEe(t);else if(i===c.ViewChangeType.SortUpdate)this.zQt.HEe(t.oldData.sortInfo,t.oldData.indexMap,t.oldData.baseIndexMap);else if(i===c.ViewChangeType.DetailColumnsVisible)this.zQt.detailColumnsVisible(t.oldData);else if(i===c.ViewChangeType.PinnedRows||i===c.ViewChangeType.PinnedColumns)this.zEe(t);else if(i===c.ViewChangeType.StyleRuleChanges)for(e in this.zQt.clearStyleRules(),r=null!=(n=t.oldData)?n:{})r.hasOwnProperty(e)&&(o=(u=r[e]).style,u=u.rule,this.zQt.addStyleRule(e,o,u));else i===c.ViewChangeType.TableSheetColumnDataTypeChanged||i===c.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged?this.YEe(t):i!==c.ViewChangeType.HierarchyLevelChanged&&i!==c.ViewChangeType.RowDataChanged&&i!==c.ViewChangeType.MovedUpdateOrDown||this.ZEe(t)},o.prototype.ZEe=function(t){var n,n,t,n=t.type;n===c.ViewChangeType.HierarchyLevelChanged?this.zQt.WEe(t.oldData):n===c.ViewChangeType.RowDataChanged?this.zQt.QEe(t.oldData):n===c.ViewChangeType.MovedUpdateOrDown&&(n=t.moveIndex,t=t.destIndex,this.zQt.m7t(n,t))},o.prototype.YEe=function(t){var n=t.type,t=t.oldData;n===c.ViewChangeType.TableSheetColumnDataTypeChanged?(this.zQt.KEe(t.columnValue,t.oldData),this.zQt.updateColumnDataType(t.columnValue,t.oldDataType)):n===c.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged&&this.zQt.updateColumnIsPrimaryKeyType(t.columnValue,t.oldIsPrimaryKey)},o.prototype.GEe=function(i){var r,t,t,r=this,t=i.type;if(t===c.ViewChangeType.Update)this.zQt.updateItem(i.modelIndex,i.oldData,null,null,{isModelIndex:!0});else if(t===c.ViewChangeType.Insert)return(t=(0,e.useSerialExecutor)()).append(function(t,n){r.zQt.MIr(i.index,1,t,n)}),t.execute()},o.prototype.UEe=function(t){var n,i,r,e,u,o,s,i,e,r,o,n=t.type;n===c.ViewChangeType.UpdateColumn?this.zQt.JEe(t.oldData,t.isInfo,t.index):n===c.ViewChangeType.UpdateColumnName?this.zQt.fBe(t.newName,t.oldName):n===c.ViewChangeType.DeleteColumn?this.zQt.DRe(t.index,t.oldData,t.isInfo,t.isField):n===c.ViewChangeType.AddColumn?this.zQt.removeColumn(t.newData.value):n===c.ViewChangeType.DefineColumnRemoveColumn?this.zQt.eGe(t):n===c.ViewChangeType.DefineColumnModifyColumn?this.zQt.uGe(t):n===c.ViewChangeType.DefineColumnAddColumn?this.zQt.JFe(t):n===c.ViewChangeType.MoveColumnOptions?this.zQt.DPt(t.to,t.from):n===c.ViewChangeType.MoveColumnInfos?(i=t.to,r=t.from,e=t.count,s=o=void 0,s=(u=i<r)?(o=i,r+e-1):(o=i-e+1,r),this.zQt.OPt(o,s,t.count)):n===c.ViewChangeType.RemoveCrossFields?this.zQt.XEe(t.oldData):n===c.ViewChangeType.UpdateCrossColumnIndex?(i=t.data.map(function(t){var n=t.oldIndex,i;return{oldIndex:t.newIndex,newIndex:n}}),this.zQt.wLt(i)):n===c.ViewChangeType.RemoveColumnInfoOptions&&(r=(e=t.oldData).columnInfoOptions,o=e.options,this.zQt.qEe(r,o))},o.prototype.zEe=function(t){var n=t.oldData,t=t.type;t===c.ViewChangeType.PinnedRows?(this.zQt.$Ee(),this.zQt.togglePinnedRows(this.EFe(n.pinnedRows))):t===c.ViewChangeType.PinnedColumns&&(this.zQt.eRe(),this.zQt.togglePinnedColumns(n.pinnedColumns))},o.prototype.EFe=function(t){var n,i=this.zQt.iRt;return t.map(function(t){return i.indexOf(t)})},n.ChangesHelper=o},"./dist/src/undo/interface.js":function(t,n){"use strict";var i,n;Object.defineProperty(n,"__esModule",{value:!0}),n.ViewChangeType=void 0,(n=i=n.ViewChangeType||(n.ViewChangeType={})).Update="update",n.Insert="insert",n.UpdateColumn="updateColumn",n.UpdateColumnName="updateColumnName",n.DeleteColumn="deleteColumn",n.AddColumn="addColumn",n.DefineColumnAddColumn="createColumn",n.DefineColumnRemoveColumn="removeColumn",n.DefineColumnModifyColumn="modifyColumn",n.MoveColumnOptions="moveColumnOptions",n.MoveColumnInfos="moveColumnInfos",n.SortUpdate="sortUpdate",n.DetailColumnsVisible="detailColumnsVisible",n.PinnedRows="pinnedRows",n.PinnedColumns="pinnedColumns",n.StyleRuleChanges="styleRuleChanged",n.TableSheetColumnDataTypeChanged="tableSheetColumnDataTypeChanged",n.TableSheetColumnIsPrimaryKeyChanged="tableSheetColumnIsPrimaryKeyChanged",n.RemoveCrossFields="removeCrossFields",n.RemoveColumnInfoOptions="removeColumnInfoOptions",n.UpdateCrossColumnIndex="updateCrossColumnIndex",n.HierarchyLevelChanged="hierarchyLevelChanged",n.RowDataChanged="rowDataChanged",n.MovedUpdateOrDown="movedUpdateOrDown"},"./dist/src/view/view-calc.js":function(t,n,i){"use strict";var r,n,c,e,i,u,o,r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),c=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/table/tableEvents.js"),i=i("./dist/src/view/view.js"),u=void 0,(o=n.Common.lt.Dh)(i.View.prototype,{kAr:function(t,n){this.oIr=t,this.aIr=n,this.lLt||(this.RFt(),this.cPt())},uIr:function(){return this.oIr},qTr:function(){return this.yLt.some(function(t){return t.zTr})},$Tr:function(){var t;this.oIr&&this.lLt&&this.lLt.$Ar()&&this.ki(e.Events.CalcValueCleared,{YIr:!0})},YTr:function(t,n){var i,r,n,i,r,i=this,r=i.lLt;return!!(n.zTr&&r&&(n=n.value,i=i.sIr(t),r=r.getFieldByName(n)))&&r.hasValue(i,t)},cIr:function(t,n){var t;if(t=this.QGe(t),(0,c.isFormula)(t.value))return t=r(r({},t),{value:t.name,dataType:u,eIr:t.value,zTr:!0}),this.qFe(t,!1,n,this.RGr(n)),t},RGr:function(t){var n=this;return{col:null!=t?t:n.yLt.length,getCalcSource:function(){return n.oIr},getCalcOptions:function(){return n.aIr()}}},VTr:function(t,n){var i,r,e,u,o,s,t;t=this.$Ge(t),i=this.ife(t),n=this.QGe(n),(r=(0,c.isFormula)(n.value))&&t&&this.lLt&&(o=this.lLt.getFieldByName(i))&&(e=t.zTr&&(0,c.isNullOrUndefined)(t.YEr)&&!(0,c.isNullOrUndefined)(n.YEr)&&(0,c.isNullOrUndefined)(o.WK))&&(u=o.data),this.TGe(i,function(t,n,i){return i&&(s=t),n.splice(t,1)[0]},!e),r?(t=this.cIr(n,s),e&&t&&u&&0<u.length&&this.rGr(t,u)):this.qFe(n,!1,s)}})},"./dist/src/view/view-cross.js":function(t,n,i){"use strict";var n,r,o,e,w,i,s;Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/view/view.js"),o=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/viewField/fieldManager.js"),w=i("./dist/src/undo/interface.js"),i=n.Common.lt.Dh,s=void 0,i(r.View.prototype,{YBt:function(){var t=this;t.lLt.setCrossFieldValues(t.iRt)},hLt:function(){var t=this;t.lLt&&(t.lLt.clearCrossFieldData(),t.YBt())},dLt:function(t,n,i){var r=this;r.lLt&&r.lLt.removeCrossFieldValues(t,n,i)},vLt:function(t){var n=this;n.lLt&&n.lLt.resetCrossFieldRowValues(t)},mLt:function(t,n){var i,r;return"string"==typeof t&&(i=!0,r=t,i=!(!(0,o.isNullOrUndefined)(this.LEt.cross)&&(t=this.LEt.cross[r],!(0,o.isNullOrUndefined)(t)))&&i)&&(t={over:r,attributes:[""]}),(0,e.isValidCross)(this.gLt,t,n)},pLt:function(){return this.bLt()&&(0,o.isNullOrUndefined)(this.lLt)},bLt:function(){return this.yLt.some(function(t){return t.cross})},wLt:function(t,n){var i,r,e,u,o,s,c,f,a,h,l,v,d,p;for(void 0===n&&(n=!0),i=this,r=[],e=function(n,t){r.push({newIndex:t,columnInfos:i.yLt.filter(function(t){return t.RBt===n}),fields:i.lLt?i.lLt.getFields(function(t){return t.initialOptionIndex===n}):[]})},u=0,o=t;u<o.length;u++)e(c=(s=o[u]).oldIndex,f=s.newIndex);for(a=function(t,n,i){t.forEach(function(t){return t.RBt=i}),n.forEach(function(t){return t.initialOptionIndex=i})},h=0,l=r;h<l.length;h++)a(d=(v=l[h]).columnInfos,p=v.fields,f=v.newIndex);n&&this.oRe.FEe({type:w.ViewChangeType.UpdateCrossColumnIndex,data:t})},MLt:function(){var n=this,t;return n.CLt.map(function(t){return n.SLt(t)})},TLt:function(t,n){var i,r,e,e,u,o,u,o,s,u,i=this,r=i.MLt(),e=i.ALt(r);if(0<e.length&&(t=e[t],n=e[n]),(e=i.ILt[t])&&"string"==typeof e.cross){if(u=i.ILt[t-1]||{},o=i.ILt[t+1]||{},u.cross===e.cross||o.cross===e.cross)return!0;if(u=i.ILt[n],o=i.ILt[t<n?n+1:n-1]||{},u.cross===e.cross||o.cross===e.cross)return!0}return s=function(t,n){return-1<r.indexOf(t)?s(t+n,n):t},(u=function(t,n){var t=i.ILt[s(t,-1)]||{},n=i.ILt[s(n,1)]||{};if("string"==typeof t.cross&&t.cross===n.cross)return!0})(t-1,t+1)||(t<n?u(n,n+1):u(n-1,n))},xLt:function(t){for(var i,r,n,e,u,i=this,r=0,n=function(t){return t&&0===t.length?s:t},e={lastFilterInfo:(0,o.clone)(i.NLt),lastSortInfo:(0,o.clone)(i.kLt),lastSortInfoBeforeGroup:(0,o.clone)(i.DLt),lastSortInfoAfterGroup:(0,o.clone)(i._Lt),columnInfos:(0,o.clone)(i.yLt)},u=function(){var n=i.yLt[r];n.RBt===t?(i.NLt=i.NLt&&i.NLt.filter(function(t){return t.field!==n.value}),i.kLt=i.kLt&&i.kLt.filter(function(t){return t.field!==n.value}),i.DLt=i.DLt&&i.DLt.filter(function(t){return t.field!==n.value}),i._Lt=i._Lt&&i._Lt.filter(function(t){return t.field!==n.value}),i.yLt.splice(r,1),i.lLt&&i.lLt.removeFields(r,1,function(t){var n;e.fields=null!=(n=e.fields)?n:t})):r++};r<i.yLt.length;)u();i.NLt=n(i.NLt),i.kLt=n(i.kLt),i.DLt=n(i.DLt),i._Lt=n(i._Lt),this.oRe.FEe({type:w.ViewChangeType.RemoveCrossFields,oldData:e})},XEe:function(t){var n,i,r,e,u,o,t,n=this,i=t.lastFilterInfo,r=t.lastSortInfo,e=t.lastSortInfoAfterGroup,u=t.lastSortInfoBeforeGroup,o=t.fields,t=t.columnInfos;n.NLt=i,n.kLt=r,n._Lt=e,n.DLt=u,n.yLt=t,o&&n.lLt.rRe(o)},ELt:function(){var i=this;i.ILt.forEach(function(t,n){(0,o.isNullOrUndefined)(t.cross)||((0,o.isNullOrUndefined)(t.LBt)&&(t.LBt=n),i.yLt[n].LBt=t.LBt)})}})},"./dist/src/view/view-event.js":function(t,n,i){"use strict";var n,O,w,i,n,r,b;function a(n){var t,i,r,e,u,o,s,t=[],i=[],r=Object.keys(w.Events);if((0,O.isArray)(n))for(e=function(n){(r.some(function(t){return t===n})?t:i).push(n)},u=0,o=n;u<o.length;u++)e(s=o[u]);else(r.some(function(t){return t===n})?t:i).push(n);return[t,i]}Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),O=i("./dist/src/dataSource/utils.js"),w=i("./dist/src/table/tableEvents.js"),i=i("./dist/src/view/view.js"),n=n.Common.lt.Dh,r=null,b=void 0,n(i.View.prototype,{bind:function(t,n){var i=this,t=a(t),r=t[0],t=t[1];0<t.length&&(i.jLt(t,n),this.gLt.bind(t,n)),0<r.length&&this.D3(r,this.OLt(n),n)},D3:function(t,n,i){var r,n,r=this,n=r.RLt(n);r.jLt(t,n,null,i),r.gLt.bind(t,n)},unbind:function(t,n){var i,r,e,u,o,s,c,f,i=this,r=a(t),e=r[0],u=r[1];if(0<u.length)for(i.ege(u,n),o=0;o<u.length;o++)s=u[o],this.gLt.unbind(s,n);if(0<e.length&&(c=this.ege(e,null,null,n),i.gLt))for(f=0;f<c.length;f++)i.gLt.unbind(t,c[f])},ki:function(t,n){return this.gLt.ki(t,n)},vOt:function(t){return this.gLt.vOt(t)},JTe:function(t){for(var n,i,t,r,e,u,o,s,n=this,i=n.gLt.name,t=(0,O.isArray)(t)?t:[t],r=n.BLt[i]=n.BLt[i]||{},e=[],u=0,o=t;u<o.length;u++)s=o[u],e=e.concat(r[s]||[]);return e},jLt:function(t,n,i,r){var e,u,o,s,c,f,a,h,h,f,e=this;if(n)for(u=(i||e.gLt).name,c=o=(s=0,O.isArray)(t)?t:[t];s<c.length;s++)f=c[s],(a=(0,O.isFunction)(n)?n:n[f])&&(h=(h=e.BLt[u]=e.BLt[u]||{})[f]=h[f]||[],(0,O.isNullOrUndefined)(r)||(f=(0,O.isFunction)(r)?r:r[f],a.ige=f),h.push(a))},ege:function(t,n,i,r){var e,u,i,o,s,c,f,a,h,l,v,d,p,w,b,m,j,y,g,_,e=this,u=(i||e.gLt).name,i=(0,O.isArray)(t)?t:[t],o=[];if((0,O.isNullOrUndefined)(r))if(n)for(s=0,c=i;s<c.length;s++)f=c[s],(a=(0,O.isFunction)(n)?n:n[f])&&-1<(v=(l=(h=e.BLt[u]=e.BLt[u]||{})[f]=h[f]||[]).indexOf(a))&&(o=o.concat(l.splice(v,1)));else for(d=0,p=i;d<p.length;d++)for(f=p[d],l=(h=e.BLt[u]=e.BLt[u]||{})[f]=h[f]||[],h[f]=[],w=0;w<l.length;w++)b=l[w],o.push(b);else for(m=0,j=i;m<j.length;m++){for(f=j[m],l=(h=e.BLt[u]=e.BLt[u]||{})[f]=h[f]||[],y=[],g=(0,O.isFunction)(r)?r:r[f],w=0;w<l.length;w++)(b=l[w]).ige===g&&y.push(w);for(_=y.length-1;0<=_;_--)o=o.concat(l.splice(v=y[_],1))}return o},OLt:function(u){var o=this;return function(t,n){var i,r,e;if(o.LLt(n),(0,O.isArray)(u))for(i=0,r=u;i<r.length;i++)(e=r[i]).call(o,t,n);else u&&u.call(o,t,n)}},LLt:function(t){var n=this;t.hasOwnProperty("row")||Object.defineProperty(t,"row",{get:function(){return(0,O.isNumber)(t.Ky)||(t.Ky=n.FLt(t.index)),t.Ky}})},RLt:function(i){var r=this;return function(t,n){(n&&n.YIr||r.PLt())&&i.call(r,t,n)}},PLt:function(t){return!0===t?this.rb--:!1===t&&this.rb++,this.rb=Math.max(this.rb,0),this.rb<1},GLt:function(n,i){var r=this;return r.PLt(!1),{success:function(t){r.PLt(!0),n&&n(t)},fail:function(t){r.PLt(!1),i&&i(t)}}},v7:function(){var e=this;e.D3(w.Events.ItemInserting,function(t,n){var i=n.index,n=n.data;e.ULt(n),i===e.length()&&e.Dit()&&e.HLt(n,i)}),e.D3(w.Events.ItemInserted,function(t,n){var i=n.index,n=n.data;e.zLt(i,n,b,b,!1,!0)}),e.D3(w.Events.ItemUpdating,function(t,n){var i=n.data,r=n.index,n=n.originalData;e.uTe(i,n,r)}),e.D3(w.Events.ItemUpdated,function(t,n){var i=n.data,r=n.index,n=n.originalData;e.YLt(i,n,r)}),e.D3(w.Events.ItemReset,function(t,n){var i=n.index,r=n.originalData,n=n.dataBeforeChanged;e.ZLt(i,r,n)}),e.D3(w.Events.ItemRemoved,function(t,n){var i=n.index,r=n.count||n.removedCount,n=n.removingIndexes;e.WLt(i,r,n,b)}),e.D3(w.Events.ChangesSubmitted,function(t,n){e.QLt()}),e.D3(w.Events.ChangesCancelled,function(t,n){e.KLt(n.isDataLengthChanged)})},wpt:function(){var t,n,i,r,e,u,o,s,c,f,t=this,n=t.BLt;for(i in n)if(n.hasOwnProperty(i))for(e in r=n[i])if(r.hasOwnProperty(e))for(o=0,s=u=r[e];o<s.length;o++)c=s[o],(f=t.gLt.QOt.tables[i])&&f.unbind(e,c);t.BLt={}},$Ot:function(t){var n,i,r,e,u,o,s,c,f,n,i=this.BLt,r=t.name,e=i[r];for(u in e)if(e.hasOwnProperty(u))for(s=0,c=o=e[u];s<c.length;s++)f=c[s],t&&t.unbind(u,f);i[r]=b},KOt:function(t,n){var i,r,e,i,r=this.BLt,e=r[t];delete r[t],r[n]=e},XTe:function(t,n){for(var i,r,e,u,o,i=this,r,e=0,u=i.JTe(n.eventName);e<u.length;e++)o=u[e],(0,O.isNullOrUndefined)(o.ige)||o.call(i,t,n)},JLt:function(){var t,n,i,r,e,u,o,s,c,f,a,h,l,v,d,p,w;if(this.XLt()){for(i=(n=t=this).name,r=t.yLt,e=t.gLt,u=[],o=0,s=r;o<s.length;o++)if(c=s[o],(0,O.isFunction)(c.value)||(0,O.isFormula)(c.value)||!(0,O.isRelation)(c.value)){if(0<(f=this.gLt.GAe(c.value)).length)for(a=0,h=f;a<h.length;a++)l=h[a],this.gLt.g0r(l,u)}else u.push(c.value);for(v=0,d=u;v<d.length;v++)w=e.qRt(p=d[v]),!(0,O.isNullOrUndefined)(w)&&(0,O.isNullOrUndefined)(w.VOt[i])&&(w.VOt[i]=n,t.qLt(w))}},qLt:function(i){var d,p,t,l,v,t,u,d=this,p=d.gLt,t=p.QOt.relationships.reduce(function(t,n){return n.sourceTable===p&&n.targetTable===i?{relationshipName:n.sourceRelationshipName,relationFieldName:n.sourceFieldName}:n.sourceTable===i&&n.targetTable===p?{relationshipName:n.targetRelationshipName,relationFieldName:n.targetFieldName}:t},{}),l=t.relationshipName,v=t.relationFieldName,t=function(t,h){var n=d.RLt(function(u,o){var i,t,n,s,n,r,e,c,f,a,n,i=function(t,n){var t=t.value.split(".");return t[t.length-1-n]},t=d.ILt.filter(function(t){return(0,O.isRelation)(t.value)&&i(t,1)===l}),n=t;if(o.eventName!==w.Events.ItemUpdating&&o.eventName!==w.Events.ItemUpdated||(n=n.filter(function(n){return o.changingFields.some(function(t){return i(n,0)===t})})),s=[b],n.forEach(function(n){var t,i,r,e,t=!(0,O.isNullOrUndefined)(n.cross);t?(r=("string"==typeof n.cross?d.LEt.cross[n.cross]:n.cross).over,(0,O.isNullOrUndefined)(d.NLt)||-1<(e=(0,O.findIndex)(d.NLt,function(t){return-1<t.field.indexOf(n.value)&&-1<t.field.indexOf(r)}))&&(i=d.NLt[e].field)):d.$Lt(n.value)&&s.push(n.value),h.call(d,n.value,t,i)(u,o)}),o.eventName===w.Events.ItemInserted||o.eventName===w.Events.ItemRemoved||o.eventName===w.Events.ItemUpdated){if(o.eventName===w.Events.ItemUpdated&&(n=o.changingFields.some(function(t){return v===t}),r=t.some(function(t){if(!(0,O.isNullOrUndefined)(t.cross)){var n=("string"==typeof t.cross?d.LEt.cross[t.cross]:t.cross).over.split(".").pop();if(o.changingFields.some(function(t){return n===t}))return!0}return!1}),n||r))for(f=e=p.nBt(t[c=0].value,o.index);c<f.length;c++)a=f[c],d.vLt(a);(0<(n=d.gde(!0))[0].length||0<n[1].length)&&d.gme(),d.tFt(b,!0,s,b)}d.XTe(u,o)});d.jLt(t,n,i),i.bind(t,n)},u=function(t,n,i,r){var e,e,e,u,o,s,c,f,a,h,a,l,v;if(d.Dit())for(o=0,s=u=r.relatedViewIndexes||p.nBt(t,r.index);o<s.length;o++)c=s[o],h=a=f=void 0,h=n?(d.vLt(c),f=p.LRt(i,c),(e={})[i]=f,a=e,d.nFt(c,((e={})[i]=!0,e))[i]):(f=p.LRt(t,c),(e={})[t]=f,a=e,p._getValueByField(t,c)),a=d.sTe(c,a),d.iFt(a,f,t,c),d.hRt(c,t,f,h),p.hRt(c,t,f,h);else if(n)for(l=0,v=u=r.relatedViewIndexes||p.nBt(t,r.index);l<v.length;l++)c=v[l],d.vLt(c)};t(w.Events.ItemRemoving,function(i,r){return function(t,n){r&&(n.relatedViewIndexes=p.nBt(i,n.index))}}),t(w.Events.ItemRemoved,function(i,r,e){return function(t,n){u(i,r,e,n)}}),t(w.Events.ItemInserted,function(i,r,e){return function(t,n){u(i,r,e,n)}}),t(w.Events.ItemUpdating,function(f,a,h){return function(t,n){var i,i,r,e,u,o,s,c,c;if(d.Dit())for(r=n.relatedViewIndexes=p.nBt(f,n.index),n.relatedViewValues=[],e=0,u=r;e<u.length;e++)o=u[e],c=s=void 0,a?s=(c=d.nFt(o,((i={})[h]=!0,i)))[h]:(s=p._getValueByField(f,o),(i={})[f]=s,c=i),c=d.sTe(o,c),n.relatedViewValues[o]=s,d.iFt(c,s,f,o)}}),t(w.Events.ItemUpdated,function(f,a,h){return function(t,n){var i,r,e,u,o,s,c;if(d.Dit())for(e=0,u=r=n.relatedViewIndexes||p.nBt(f,n.index);e<u.length;e++)o=u[e],s=n.relatedViewValues[o],c=void 0,a?(c=d.nFt(o,((i={})[h]=!0,i))[h],f=h):c=p._getValueByField(f,o),d.hRt(o,f,s,c),p.hRt(o,f,s,c)}})}})},"./dist/src/view/view-filter.js":function(t,n,i){"use strict";var m,s,d,n,v,c,r;function p(t){return e(t[0])}function e(t){return t&&void 0!==t.Vce}function o(t,n){for(var i=0,r=t.length;i<r;i++)if(!u(t[i],n[i]))return;return 1}function u(t,n){for(var i,r,e,u,e,i=["field","value","operator","relation"],r=0;r<i.length;r++)if(!((u=t[e=i[r]])===(e=n[e])||(0,m.isNullOrUndefined)(u)&&(0,m.isNullOrUndefined)(e)))return;return t.ort===n.ort&&f(t.Vce,n.Vce)}function f(t,n){if((0,m.isNullOrUndefined)(t)||(0,m.isNullOrUndefined)(n))return t===n;if(t.length!==n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==n[i])return!1;return!0}function w(t,n){for(var i,r,e,u,o,i={},r=0;r<t.length;r++)if(!i[e=t[r].field]){for(u=i[e]=[],o=r;o<t.length;o++)t[o].field===e&&u.push(t[o]);n(e,u)}}Object.defineProperty(n,"__esModule",{value:!0}),m=i("./dist/src/dataSource/utils.js"),s=i("./dist/src/table/table.js"),d=i("./dist/src/view/view-util.js"),n=i("Common"),v=i("./dist/src/view/view.js"),c=i("./dist/src/viewField/fields.js"),(r=n.Common.lt.Dh)(v.View.prototype,{buildInFilter:function(s){var c,f,a,h,t,l,n,i,r,e,i,u,o,c=this.gLt,f={};if(1<s.length){for(a=[],h=[],t=function(r){var t,n,i,e,t,u,o,t=s[r],n=t.field,i=t.operator,e=t.value,t=t.relation,u=f[n];u=u||(f[n]=c.jRt(n)),h.push(t),o=(0,v.rFt)(l.gLt,l.yLt,l.lLt,n,s[r]),o=(0,d.mapGetValueFunc)(u,o),o=(0,d.oFt)(l,i,e,o),a.push(function(t,n,i){return o(t,i,n[r])})},l=this,n=0;n<s.length;n++)t(n);return(0,d.aFt)(a,h)}return r=(i=s[0]).field,e=i.operator,i=i.value,u=c.jRt(r),o=(0,v.rFt)(this.gLt,this.yLt,this.lLt,r,s[0]),o=(0,d.mapGetValueFunc)(u,o),o=(0,d.oFt)(this,e,i,o,r),function(t,n,i){return o(t,i,n[0])}},uFt:function(t){var n,n,i,r,n=this,i=n.ZOt,r=n.gLt;return!(i[t]&&n.HTr()&&null!=(n=n.$Ge(t))&&n.zTr)&&r.ZOt[t]||i[t]},eRt:function(t,n){var i=this,r=i.gLt,e=i.yLt,u,o=[],s=[];t.forEach(function(n){(u=e.filter(function(t){return t.value===n})[0])&&((0,d.isViewColumn)(u)?o:s).push(n)}),r.eRt(s,n),i.sFt(o)},sFt:function(t){for(var n,i,r,e,u,n,i=this.ZOt,r=0,e=t;r<e.length;r++)i[u=e[r]]||(i[u]=this._Rt(u))},cFt:function(t){var n=this;t?(delete n.ZOt[t],n.gLt.ARt(t)):n.ZOt={}},_Rt:function(t){var n,i,r,e,u,o,n=this.lLt.getFieldByName(t),i=function(t){return n.getValue(t)};if(n instanceof c.ExternalFormulaField&&0<this.length()){for(r=this.Efe,e={},u=0,o=r.length;u<o;u++)e[r[u]]=u;i=function(t){return n.getValue(t,e[t])}}return(0,s.generateFilterIndexCache)(t,(0,m.isNullOrUndefined)(n)?0:this.length(),this.jRt(t),i)},cRt:function(t,n){var i=this,r,e=i.gLt._dataSource.options.schema;i.Yce(t),(0,s.updateFilterIndexesCacheOnInsert)(this.ZOt,t,n,e&&e.columns,i.length())},hRt:function(t,n,i,r){var e=this;e.Yce(t,!1,n),e.vge(n),(0,s.updateFilterIndexesCacheOnUpdate)(e.ZOt,t,n,i,r,e.jRt(n))},pRt:function(t,n,i){var r,e,u,o,s,s,r=this,e=r.yLt;if(!(0,m.isNullOrUndefined)(n)&&!(0,m.isNullOrUndefined)(i))for(u=0,o=e;u<o.length;u++)s=(s=o[u]).value instanceof Function?s.value.name:s.value,r.hRt(t,s,n[s],i[s])},MRt:function(t,n,i){var r=this;r.Zce(t,n,i),(0,s.updateFilterIndexesCacheOnRemove)(r.ZOt,t,n,i)},fFt:function(t){var i,r,e,n,u,o,s,c,f,a,h,l,v;if(t){if(r=(i=this).iRt,e=[],u=(n=i.lFt).length,n&&0<u&&(e=r.slice(0,u)),o=u,"string"==typeof t)for(s=i.Ywt(t,0,0),c=u;c<r.length;c++)f=r[c],!0===i.nMt(s,f,0)&&(e[o]=f,o++);else if("function"==typeof t)for(c=u;c<r.length;c++)f=r[c],t(i.getRowData(f,!0))&&(e[o]=f,o++);else{if(r.length!==i.length())return i.Wce(),void i.Qce(t,e,r);for(v in(0,m.isArray)(t)||(t=[t]),(0,m.isNullOrUndefined)(i.Jce)&&(i.Jce={}),a=i.isHierarchy(),i.qce(t,function(t,n){i.Qce(n,e,r.slice()),a&&p(n)&&i.afe(n),i.tfe(t,n)}),h=[],l=function(n){t.some(function(t){return t.field===n})?a&&p(i.Jce[n].options)||h.push(n):delete i.Jce[n]},i.Jce)l(v);e=i.nfe(h)}i.iRt=e}},Qce:function(t,r,n){var e,i,u,o,s,c,f,a,h,l,v,e=this,i=(e.lFt||[]).length,u=i;for((0,m.isArray)(t)||(t=[t]),s=[],c=[],f=0;f<t.length;f++)a=t[f],((0,d.isFieldListFilterInfo)(a)?s:c).push(a);if(h=r,l=n,0<s.length&&(h=r.slice(),w(t=s,function(t,n){var t=t,i=e.uFt(t);i||(e.eRt([t]),i=e.uFt(t)),(0,d.hFt)(h,u,i,n,l),l=h,h=r.slice()}),h=l),0<c.length)for(h=r.slice(),t=c,o=this.buildInFilter(t),f=i;f<l.length;f++){v=l[f];try{o(e.gLt,t,v)&&(h[u]=v,u++)}catch(t){}}e.iRt=h},tfe:function(t,n){var i,r,e,u,i=this;if(!(0,m.isNullOrUndefined)(t))for(r=i.lFt||[],e=i.Jce[t]={options:n,count:i.iRt.length-r.length},u=r.length;u<i.iRt.length;u++)e[i.iRt[u]]=!0},afe:function(i){for(var r,e,t,n,u,o,s,c,f,a,h,l,v,d,p,w,b,r=this,e=[],t=function(t){var n=i[t];e.push(r.yLt.find(function(t){return t.value===n.field}))},n=0;n<i.length;n++)t(n);for(u=r.lFt||[],o=r.iRt.slice(0,u.length),n=u.length;n<r.iRt.length;n++)if(s=r.iRt[n],0===(c=r.getHierarchyNode(s,!0)).children.length)for(f=function(t,n){return(0,m.formatCalcError)(r.ufe(t,n))},a=r.ufe.bind(r),h=0;h<i.length;h++){for(v="="===(l=i[h]).field[0]?f:a,d=c,p=0;p<l.Vce.length&&(w=l.Vce[p],(b=v(e[h],d.modalIndex))===w);p++)d=d.parent;if(p===l.Vce.length&&d.isRoot){o.push(s);break}}r.iRt=o},Wce:function(){this.Jce=null},Yce:function(t,n,i){var r,e,u,o,s,c,f,a,h,r=this,e=r.Jce;if(e&&!(-1<(u=r.lFt||[]).indexOf(t))){for(s in o=r.iRt,e)((0,m.isNullOrUndefined)(i)||s===i||!1===n&&r.Nfr(s,i)&&!r.gLt.PAe(s))&&(f=(c=e[s]).options,a=o.slice(0,u.length),h=o.slice(0,u.length).concat(t),r.Qce(f,a,h),-1<r.iRt.indexOf(t)?c[t]||(c[t]=!0,c.count+=1):c[t]&&(delete c[t],--c.count));r.iRt=o}},vge:function(t){var n,i,r,e,u,o,s,c,f,n=this,i=n.Jce;if(i&&!n.vme()){for(u in r=n.lFt||[],e=n.iRt,i)(0,m.isFormula)(u)&&((0,m.isNullOrUndefined)(t)||n.Nfr(u,t))&&n.gLt.PAe(u)&&(s=(o=i[u]).options,c=e.slice(0,r.length),f=e.slice(),n.Qce(s,c,f),(o=n.iRt).count=n.iRt.length,o.options=s);n.iRt=e}},Zce:function(t,n,i){var r,e,u,o,s,c,f,a,h,r=this,e=r.Jce;if(e&&!(-1<(u=r.lFt||[]).indexOf(t)))for(o in e)if(e.hasOwnProperty(o)){if(c=(s=e[o]).options,delete s.options,delete s.count,f=Object.keys(s),i&&0<i.length)(0,m.removeIndexes)(f,i,!0);else for(a=0;a<f.length;a++)t+n<=(h=+f[a])?f[a]=h-n:t<=h&&h<t+n&&(f.splice(a,1),a--);(s=f.reduce(function(t,n){return t[n]=!0,t},{})).options=c,s.count=f.length,e[o]=s}},nfe:function(t){var n,i,r,e,u,o,s,c,n=this;if(0<t.length){if(i=n.lFt||[],r=n.iRt,e=n.Jce,1===t.length&&r.length-i.length===e[t[0]].count)return r;for(u=r.slice(0,i.length),o=i.length;o<r.length;o++){for(s=r[o],c=0;c<t.length&&e[t[c]][s];c++);c===t.length&&u.push(s)}return u}return n.iRt},dFt:function(){var t,n,i,r,e,u,o,s,t=this.iRt;if(t||(this.gFt(),t=this.iRt),this.Efe&&this.HTr())this.iRt=this.Efe.slice();else{for(r=(i=this.lFt).length,i&&0<r&&(n=t.slice(0,r)),e=[],u=this.length(),s=o=0;s<u;s++)(!n||n.indexOf(s)<0)&&(e[o]=s,o++);n&&0<n.length?this.iRt=n.concat(e):this.iRt=e}this.cFt()},HLt:function(t,n){var i=this,r=i.NLt;i.Dit()&&i.autoFilter&&(0,d.addFilterInfoForFieldValue)(r,t,i,void 0,void 0,n)},iFt:function(t,n,i,r){var e=this,u=e.NLt;e.Dit()&&e.autoFilter&&(0,d.addFilterInfoForFieldValue)(u,t,e,n,i,r)},vFt:function(t){var n=this;n.mFt(t)&&n.filter(n.NLt)},mFt:function(t){return(t||this.autoFilter)&&this.NLt},Dit:function(){var t,n=this.NLt;return(0,m.isArray)(n)&&0<n.length},RGe:function(t){var n,i,r,t,n=this;if(n.Dit())return i=n.NLt,r=n.ife(t),t=!1,n.NLt=i.filter(function(t){return t.field!==r}),0===n.NLt.length&&(t=!(n.NLt=null)),n.cFt(r),t},BGe:function(t,n){var i,r,e,u,o,s,c,f,i=this;if(i.Dit()){if(r=i.NLt,e=i.ife(t),u=i.ife(n),t.type!==n.type||t.dataType!==n.dataType)return i.RGe(n),!0;if(e!==u){for(o=!1,s=0,c=r;s<c.length;s++)(f=c[s]).field===u&&(f.field=e,o=!0);o&&i.cFt(u)}}},filter:function(t){var n=this;return n.iRt||n.gFt(),t&&(!(0,m.isArray)(t)||0<t.length)?(n.isHierarchy()&&n.$ce(),n.fFt(t),n.isHierarchy()&&n.yFt(!0)):n.isHierarchy()?n.gFt():(this.dFt(),n.hde()),this.NLt=(0,m.isArray)(t)&&0<t.length?t:null,this.iRt.length},$ce:function(){var i=this;i.bFt().forEach(function(t){var n;i.getHierarchyNode(t,!0).modalIndex=t})},yFt:function(t){var n,i,r,e,u,o,o,s,c,n=this,i=n.iRt;if(!(0,m.isNullOrUndefined)(i)&&0!==i.length){for(t||n.$ce(),r=[],e=1,u=0;u<i.length;u++)o=i[u],(o=n.getHierarchyNode(o,!0)).visit=e,(0,m.bubbleTree)(o,function(t){t.isRoot||(t.visit=e)}),(0,m.traversalTree)(o,function(t){t.visit=e});for(c in n.Jce)if(p(n.Jce[c].options)){s=n.Jce[c];break}(0,m.isNullOrUndefined)(s)||(e=2,n.fIr(s,function(t){var t=n.getHierarchyNode(t,!0);(0,m.isNumber)(t.visit)&&(t.visit=e,(0,m.bubbleTree)(t,function(t){t.isRoot||(t.visit=e)}))})),(0,m.traversalTree)(n.getHierarchyRootNode(),function(t){t.visit===e&&(r.push(t.modalIndex),delete t.visit,delete t.modalIndex)}),n.iRt=r}},fIr:function(t,n){var i,r,e,u;if(!(0,m.isNullOrUndefined)(t)){for(e in i=t.options,r=t.count,delete t.options,delete t.count,t)if(t.hasOwnProperty(e)&&!1===(u=n(+e)))break;t.options=i,t.count=r}},bFt:function(){var t=this,n=t.iRt,i,r=t.isHierarchy(),i=t.wFt;return r&&!(0,m.isNullOrUndefined)(i)||(t.gFt(),t.sort(t.kLt),i=t.iRt,t.iRt=n,r&&(t.wFt=i)),i},qce:function(t,e){var u=this;(0,m.isNullOrUndefined)(u.Jce)&&(u.Jce={}),w(t,function(t,n){var i=u.Jce[t],r;!(0,m.isNullOrUndefined)(i)&&i.options.length===n.length&&o(i.options,n)||e(t,n)})},UAr:function(r,t){var n,i,e,u,o,s,c,f,a,h,l,v,d,n=this,i;if(n.Dit()&&n.HTr()){for(c in r=r||0,t=t||0,e={},u=n.Efe.reduce(function(t,n,i){return t[n]=i+r,t},{}),o={},s=n.Jce)s.hasOwnProperty(c)&&(o[c]=n.lIr(c)+t);for(a=0,h=(f=n.iRt).length;a<h;a++)for(c in(d=e[v=u[l=f[a]]])||(e[v]=d=[]),s)s[c][l]&&d.push(o[c]);return e}return{}},ETr:function(t,n){var i,r,e,u,e,o,i=this,r;return i.Dit()&&i.HTr()&&i.Jce?(e=i.Efe,u=e.reduce(function(t,n,i){return t[n]=i,t},{}),n=n||0,e=i.ife(t),o=[],i.fIr(i.Jce[e],function(t){return o.push(u[t]+n)}),o):[]}})},"./dist/src/view/view-group.js":function(t,n,i){"use strict";var r,e,b,m,j,y,g,u,i,o,v;function c(c,f,a){for(var h,l,v,d,p,t,n,w,i,r,e,h=[],l=-1,v=-1,d=g.GROUP_COLUMN_WIDTH,p={},t=function(t){for(var n,i,r,e,n=c[t],i=0,r=a.length;i<r;i++)e=a[i],n.value===e.field&&(n.GFt=!0,n.OFt=i,p[(0,y.combineName)(n.value,(0,b.findIndex)(a,function(t){return t.field===n.value}))]={colInfo:n,index:t})},n=0;n<c.length;n++)t(n);for(i=function(t,n){var i,r,e,u,o,s,i=f.getField(w[t]),r=i.name,e,u={caption:i.extra.caption,value:r,name:r,Kyn:i.key,isGroup:!0};-1<(v=(0,b.findIndex)(a,function(t,n){return(0,y.combineName)(t.field,n)===r}))&&(d=(0,g.getGroupColumnWidth)(a[v].field,c),l=v,u.DFt=!0,o=p[r],(0,b.isNullOrUndefined)(o)||(o.colInfo._Ft=t,u._Ft=o.index+n)),u.Q1r=!u.DFt&&(0,m.isGroupSummary)(u.value),u.J1r=!u.Q1r&&(0,m.isGroupSlice)(u.value),u.OFt=l,u.width=d,(s=i.extra)&&(0,j.setFieldExtraProperties)(function(t){(0,b.isNullOrUndefined)(s[t])||(u[t]=s[t])}),h.push(u)},r=0,e=(w=f.groupFieldKeys).length;r<e;r++)i(r,e);return h}function w(t,n,i){for(var i,r,e,u,o,s,c,f,i=i?i.length:0,r={},e=i;e<t.length;e++)r[t[e]]=!0;for(u=0,o=i,s=n.length,c=t.length;u<s&&o<c;u++)r[f=n[u]]&&(t[o]=f,o++)}function _(t,n){var i,r,e,u,o;if(t&&0<t.length){for(i=[],r=n.length,0<(e=t.length)&&(i=t.slice(0)),u=e,o=0;o<r;o++)-1===t.indexOf(n[o])&&(i[u]=n[o],u++);return i}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.ise=void 0,r=i("Common"),e=i("./dist/src/view/view.js"),b=i("./dist/src/dataSource/utils.js"),m=i("./dist/src/viewField/groupManager.js"),j=i("./dist/src/viewField/fields.js"),y=i("./dist/src/viewField/utils.js"),g=i("./dist/src/view/view-util.js"),u=i("./dist/src/undo/interface.js"),i=r.Common.lt.Dh,o=null,v=void 0,n.ise=c,i(e.View.prototype,{groupBy:function(t){var n,i,n=this;return 0===arguments.length||!(0,b.isArray)(t)||n.hasHierarchyColumn()||0===(t=0<(i=n.yLt.filter(function(t){return t.isCross})).length?t.filter(function(n){return!i.some(function(t){return t.value===n.field})}):t).length?n.MFt:(n.iRt||n.gFt(),n.CFt(t),void(this.MFt=t))},windowOver:function(t,n,i){var r,e,u,o,s,c,f,a,h,l,v,d,p,r=this,e=!1,o=function(){return u=!r.iRt||(e=r.iRt.length!==r.length())?r.qFt():r.iRt.slice()},s=r.gLt.fme(),c=!1,f=!1,u=!s||(c=r.sde(),f=r.Dit(),i)||c||f?o():(r.iRt||r.gFt(),r.iRt);if((0,b.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,u=r.cde(t,u).indexMap;else for(a=0;a<n.length;a++)for(l=(h=n[a]).orders,(0,b.isArray)(l)&&0<l.length&&r.fde(u,l),v=h.functions,d=0;d<v.length;d++)(p=r.gLt.XOt[v[d].windowOverFormula]).evaluateWindowFunction(u);!s||c&&!e||(f?i||w(r.iRt,u,r.lFt):r.iRt=_(r.lFt,u))},removeGroupBy:function(){var t=this;t.isHierarchy()||(t.AFt(),t.IFt(),t.SFt(),t.MFt=o,t.xFt(),t.NFt())},AFt:function(){var t;this.kFt()},IFt:function(){var t,n,i,r,e,u,o,s,c,f,t=this,n=t.gLt,i=t.NLt,r=t.ZOt,e=t.getColumnInfos();if(i){for(f=i.length-1;0<=f;f--)u=i[f],(o=e.filter(function(t){return t.name===u.field})[0]).DFt?(s=(0,g.getColumnName)(e[o._Ft]),(c=r[u.field])&&(n.ZOt[s]=r[u.field],delete r[u.field]),u.field=s):o.isGroup&&(i.splice(f,1),delete r[u.field]);t.NLt=0===i.length?v:i}},xFt:function(){var t,n,i,r,e,t=this;if(t.kLt){for(n=[],i=0,r=t.kLt;i<r.length;i++)delete(e=r[i]).EFt,e.jFt?(0,m.isGroupField)(e.field)&&(delete e.jFt,delete e.OFt,e.field=(0,m.getGroupFieldName)(e.field),n.push(e)):n.push(e);t.kLt=0===n.length?v:n}t._Lt=v,t.DLt=t.kLt},uii:function(t){var n,i,r,t,n=this;if(n.FGe())return i=n.MFt,r=n.ife(t),t=!1,n.MFt=i.filter(function(t){return t.field!==r}),0===n.MFt.length?t=!(n.MFt=o):i.forEach(function(t){t.summaryFields&&0<t.summaryFields.length&&t.summaryFields.forEach(function(t){var n,n;t.slice&&(n=(n=void 0,b.isString)(t.slice)?t.slice:t.slice.field)===r&&delete t.slice})}),t},LGe:function(t,n){var i,r,e,t,u,o,s,c,i=this;if(i.FGe())if(r=i.ife(t),e=i.ife(n),t=t.type!==n.type||t.dataType!==n.dataType,r===e||t){if(t)return!0}else for(o=0,s=u=i.MFt;o<s.length;o++)(c=s[o]).field===e&&(c.field=r),c.summaryFields&&c.summaryFields.forEach(function(t){t.slice&&(t.slice===e?t.slice=r:t.slice.field===e&&(t.slice.field=r))})},CFt:function(t){var n,i,r,i,r,i;t&&((n=this).kFt(),r=(i=n.cde(t)).rootNode,i=i.indexMap,n.FFt=r,n.iRt=i,r=n.yLt.slice(),i=n.yLt.filter(function(t){return t.isGroup}),n.Cgr(t),n.Sgr(r,i))},Cgr:function(t){this.SFt(),this.TFt(t)},Sgr:function(t,i){var n,r,e,u,o,s,c,f,a,h,l,n=this,r=!1,e=n.yLt.filter(function(t){return t.isGroup});if(0<e.length)for(u=function(n){e.some(function(t){return t.value===n.value})||(n.K1r=!0,r=!0)},o=0,s=i;o<s.length;o++)u(c=s[o]);if(f=!1,0<i.length)for(a=function(n){i.some(function(t){return t.value===n.value})||(n.ume=!0,f=!0)},h=0,l=e;h<l.length;h++)a(c=l[h]);r||f?(n.$1r=t,n.tdr||(n.tdr=t)):n.$1r=v,(0===i.length&&0<e.length||0<i.length&&0===e.length)&&(n.$1r=v,n.tdr=v)},cde:function(t,n){var i,n,r,e,u,i,t,i=this,n=n||i.iRt,r=i.lLt||i.RFt(),e=i.BFt||i.LFt(t),u=n;return i.length()>n.length?((0,b.isNullOrUndefined)(i.Efe)&&(i.Efe=i.qFt()),u=i.Efe):i.Efe=v,i=r.buildGroupFields(t,u),t=e.groupBy(i,n),r.transposeSliceFields(i),t},kFt:function(){var t,n,n=this;(n.BFt=null)!=(t=n.lLt)&&t.reset(),n.FFt=null},lde:function(t,n){var i=this,n=(n||this.autoGroup)&&this.MFt;return n&&((0,b.isString)(t)?i.$Lt(t):!((0,b.isArray)(t)&&0<t.length)||t.some(function(t){return i.$Lt(t)}))},PFt:function(t,n){var i=this;i.lde(t,n)&&i.CFt(i.MFt)},FGe:function(){var t,n=this.MFt;return(0,b.isArray)(n)&&0<n.length},$Lt:function(n,i){var r,e,r=this,e=function(t){return i?!(0,b.isFormula)(t)&&t===n:r.Nfr(t,n)};return r.MFt&&r.MFt.some(function(t){return e(t.field)||t.summaryFields&&t.summaryFields.some(function(t){return!i&&t.formula&&r.Nfr(t.formula,n)||t.slice&&("string"==typeof t.slice?e(t.slice):t.slice.field&&e(t.slice.field))})})},LFt:function(t){var n=this,i=n.gLt,r=i.POt;return n.BFt=new m.GroupManager(t,r.wEt.bind(r),i.QOt,n.fde.bind(n)),n.BFt},SFt:function(t){for(var n,i,r,e,n=this,i=n.getColumnInfos(),r=i.length-1;0<=r;r--)(e=i[r]).isGroup&&i.splice(r,1),e.GFt&&(!1!==t&&(e.GFt=v),e._Ft=v);n.setColumnInfos(i)},TFt:function(t){var n,i,r,e,u,o,s,n=this;if(n.Agr()){for(i=c(n.yLt,n.lLt,t),r=n.UFt,u=0,o=e=n.getColumnInfos();u<o.length;u++)s=o[u],r||(s.visible=!1),i.push(s);n.setColumnInfos(i)}},HFt:function(t){var i,n,r,e,u,o,s,c,f,a;if(t){for(n=(i=this).FFt,r=[],e=i.yLt,u=Array.isArray(t)?t:[t],o=[],s=[],c=function(t){var n,t,n=u[t],t=e.filter(function(t){return t.value===n.field})[0];(t&&(0,b.isNumber)(t.OFt)?(n.jFt=!0,n.EFt=i.zFt([n]),n.OFt=t.OFt,o):s).push(n)},f=0;f<u.length;f++)c(f);a=i.zFt(s),s.forEach(function(t){return t.EFt=a}),i.VFt(n,r,0,o,s),i.iRt=r}},VFt:function(t,n,i,r,e){var u,t,o,s,c,f,a,h,l,v,d,p,w,u=this,t=t.childrenArray&&t.childrenArray[0];if(t)for(1<t.length&&0<r.length&&0<(c=r.filter(function(t){return t.OFt===i})).length&&(f=c[0].EFt,t.sort(function(t,n){return f(u.gLt,c,t.recordRowNumbers&&t.recordRowNumbers[0],n.recordRowNumbers&&n.recordRowNumbers[0])})),a=0,h=t;a<h.length;a++)if(d=!(v=(l=h[a]).childrenArray)||!v[0]||0===v[0].length)for(1<(s=l.recordRowNumbers).length&&0<e.length&&(f=(c=e)[0].EFt,s.sort(function(t,n){return f(u.gLt,c,t,n)})),o=n.length,p=0,w=s.length;p<w;p++)n[o+p]=s[p];else u.VFt(l,n,i+1,r,e)},setGroupSliceColumnSettings:function(t,n){var i=this,r=t[n];t.isGroup&&i.isGroupSliceColumn(t)&&i.getGroupSliceColumns(t).forEach(function(t){return t[n]=r})},isGroupSliceColumn:function(t){return t.isGroup&&(0,m.isGroupSlice)(t.value)},getGroupSliceColumns:function(t){var n,i,r,e,u,o,n,i=[],r=t.OFt,e=this.yLt;if(t.isGroup)for(u=0;u<e.length;u++)(o=e[u]).OFt===r&&(0,m.isGroupSlice)(o.value)&&i.push(o);return i},updateColumnSettingToGroupOptions:function(t,r){var n,i,e,u,o,n,i=this.MFt;if(i&&t.isGroup)switch(u=function(n,i){(0,j.setFieldExtraProperties)(function(t){!(0,b.isNullOrUndefined)(r)&&r!==t||(n[t]=i[t])})},(e=(0,m.getGroupOptionIndexesFrom)(t.value)).length){case 1:u(i[e[0]],t);break;case 2:u(i[e[0]].summaryFields[e[1]],t);break;case 3:u(o="string"==typeof(o=i[e[0]].summaryFields[e[1]].slice)?i[e[0]].summaryFields[e[1]].slice={field:o}:o,t)}},detailColumnsVisible:function(t){var n,i,r,e,n=this;if(0===arguments.length)return n.UFt;if(n.UFt!==t){if(i=n.UFt,n.UFt=t,n.BFt)for(r=n.getColumnInfos(),e=0;e<r.length;e++)r[e].isGroup||(r[e].visible=t);this.oRe.FEe({type:u.ViewChangeType.DetailColumnsVisible,oldData:i})}}})},"./dist/src/view/view-sort.js":function(t,n,i){"use strict";var u,r,p,w,b,o,i,e;function s(r){return r.iRt.reduce(function(t,n){var i=r.getHierarchyNode(n,!0);return(0,p.isNullOrUndefined)(i)||(t[i.id]=n),t},{})}function c(n,i){return function(t){(0,p.isNullOrUndefined)(n[t.id])||i.push(n[t.id])}}function m(t,n,i,r,e){for(var u,o,s,c,u={},o=(0,w.rFt)(t,n,i,e,u,!1),s=0;s<r.length;s++)if(c=o(u,s,u),!(0,p.isNullOrUndefined)(c)&&!(0,p.isCalcError)(c))return c;return null}function j(t,n,i,r,e,u){var o,s,c,f,a,h,l,v,d;if(1===e.length)return u=u||0,o=e[0],s=(0,w.rFt)(t,n,i,o.field,o),c=void 0,c=o.compare?function(t,n,i,r){var i,t,i=s(t,i,n[u]),t=s(t,r,n[u]);return n[u].compare(i,t,n[u].ascending)}:null===(f=m(t,n,i,r,o.field))?function(){return 0}:(a=o.ascending,h=o.list,(0,p.isArray)(h)&&0<h.length?(l=h.reduce(function(t,n,i){return t[n]=i,t},{}),function(t,n,i,r){var i,t,i=s(t,i,n[u]),t=s(t,r,n[u]);return(0,b.compareListValue)(a,f,i,t,l)}):function(t,n,i,r){var i,t,i=s(t,i,n[u]),t=s(t,r,n[u]);return(0,b.compareValue)(a,f,i,t)});for(v=0;v<e.length;v++)o=e[v],(d=(0,w.ZFt)(t,n,o.field)).isGroup&&(0,p.isNullOrUndefined)(o.ascending)&&(o.compare=function(t,n){return t===n?0:1}),o.WFt=j(t,n,i,r,[o],v);return b.multiSort}function f(t){return!t.gLt.fme()||t.Dit()}u=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ese=void 0,r=i("Common"),p=i("./dist/src/dataSource/utils.js"),w=i("./dist/src/view/view.js"),b=i("./dist/src/view/view-util.js"),o=i("./dist/src/undo/interface.js"),i=r.Common.lt.Dh,e=void 0,n.ese=j,i(w.View.prototype,{zFt:function(t,n){return j(this.gLt,this.yLt,this.lLt,this.iRt,t,n)},QFt:function(t){var n;t&&((n=this).isHierarchy()?(n.wFt=null,n.DLt=(0,b.getSortInfos)(t),n.KFt(t)):n.MFt?(n._Lt=(0,b.getSortInfos)(t),n.HFt(t)):(n.DLt=(0,b.getSortInfos)(t),n.JFt(t)))},JFt:function(t){var n,i,r,i,e,u,o,s,c;if(t){if(r=(i=(n=this).hIr(t)).startRow,i=i.endRow,u={},(e=n.Efe&&n.HTr())&&n.Dit())for(o=0,s=n.iRt.length;o<s;o++)u[o]=n.Efe.indexOf(n.iRt[o]);if(n.fde(n.iRt,t,r,i),e)if(n.Dit())for(o=0,c=n.iRt.length;o<c;o++)n.Efe[u[o]]=n.iRt[o];else n.Efe=n.iRt.slice()}},fde:function(t,n,i,r){var e,u,o,s,c,f;if(n&&(e=this,0!==(u=Array.isArray(n)?n:[n]).length))if(o=e.zFt(u),r=r||t.length,0===(i=i||0)&&r>=t.length)t.sort(function(t,n){return o(e.gLt,u,t,n)});else for((s=t.slice(i,r)).sort(function(t,n){return o(e.gLt,u,t,n)}),c=0,f=s.length;c<f;c++)t[c+i]=s[c]},hIr:function(t){var n,i,r,e,t,u,o,t,s,n=this,i,r=n.lFt.length,e,t=(Array.isArray(t)?t:[t])[0],u=t.startRow,o,t=t.endRow,s;return{startRow:r+(void 0===u?0:u),endRow:void 0===t?n.length():t}},XFt:function(){var t,n,i,t=this,n=t.gLt.uBt();return!(0,p.isNullOrUndefined)(n)&&(0,p.isNullOrUndefined)(t.kLt)?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&(i={field:n,ascending:!0},t.isHierarchy()?t.KFt(i):t.JFt(i)),!0):(0,p.isNullOrUndefined)(n)&&(0,p.isNullOrUndefined)(t.kLt)&&t.isHierarchy()?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&t.$Ft(),!0):void 0},KFt:function(i){var r,t,n,e,u,o;i&&(t=(r=this).getHierarchyRootNode(),n=[],e=Array.isArray(i)?i:[i],u=s(r),o=r.zFt(e),e.forEach(function(t){return t.EFt=o}),(0,p.traversalTree)(t,c(u,n),{isOrderChildren:r.rAe,compareFn:function(t,n){return o=(i=e)[0].EFt,(0,p.isNullOrUndefined)(u[t.id])||(0,p.isNullOrUndefined)(u[n.id])?0:o(r.gLt,i,u[t.id],u[n.id])}}),r.iRt=n)},$Ft:function(){var t,n,i,r,t=this,n=t.getHierarchyRootNode(),i=[],r=s(t);(0,p.traversalTree)(n,c(r,i),{field:"sequence",isOrderChildren:!1}),t.iRt=i},NFt:function(t){var n=this;n.tPt(t)&&n.sort(n.kLt)},tPt:function(t){return(t||this.autoSort)&&this.kLt},Pct:function(){var t,n=this.kLt;return(0,p.isArray)(n)&&0<n.length},PGe:function(t){var n,i,r,t,n=this;if(n.Pct())return i=n.kLt,r=n.ife(t),t=!1,n.kLt=i.filter(function(t){return t.field!==r}),0===n.kLt.length&&(n.kLt=void 0),n.DLt&&(n.DLt=n.DLt.filter(function(t){return t.field!==r}),0===n.DLt.length)&&(n.DLt=void 0),n._Lt&&(n._Lt=n._Lt.filter(function(t){return t.field!==r}),0===n._Lt.length)&&(n._Lt=void 0),t=n.kLt||n.DLt||n._Lt?t:!0},GGe:function(t,n){var i,r,e,t,n,t,i,u,o,s,c,f,a,h,l,v,i=this;if(i.Pct())if(r=i.ife(t),e=i.ife(n),t=t.type!==n.type||t.dataType!==n.dataType,r===e||t){if(t)return!0}else{if(n=i.kLt,t=i.DLt,i=i._Lt,n)for(u=0,o=n;u<o.length;u++)(s=o[u]).field===e&&(s.field=r);if(t)for(c=0,f=t;c<f.length;c++)(a=f[c]).field===e&&(a.field=r);if(i)for(h=0,l=i;h<l.length;h++)(v=l[h]).field===e&&(v.field=r)}},sort:function(t){var n,i,r,e,n=this;n.iRt||n.gFt(),i=this.kLt,r=u([],this.iRt,!0),n.HTr()&&(e=n.Efe.slice()),n.QFt(t),this.kLt=t,this.oRe.FEe({type:o.ViewChangeType.SortUpdate,oldData:{sortInfo:i,indexMap:r,baseIndexMap:e}})},HEe:function(t,n,i){t?this.sort(t):(this.kLt=void 0,this.DLt=void 0,this._Lt=void 0,this.iRt=n,this.HTr()&&(this.Efe=i),this.CFt(this.MFt))},VEe:function(t){this.iRt=t},sde:function(t){var n=this;return n.tPt()||n.lde(t)},hde:function(t,n){var i,r,e,u,o,o,s,o,i=this;if(!i.sde(t)&&(n||f(i))&&i.ame()){for(r=i.getColumnInfos(),e=[],u=r.length-1;0<=u;u--)if(o=r[u],0<(o=i.GAe(o)).length){o=(s=i.gLt.XOt[o[o.length-1]]).options,(0,p.isArray)(o.partitions)&&0<o.partitions.length&&o.partitions.forEach(function(t){return e.push({field:t.field,ascending:t.ascending})}),(0,p.isArray)(o.orders)&&0<o.orders.length&&o.orders.forEach(function(t){return e.push({field:t.field,ascending:t.ascending})});break}0<e.length&&i.JFt(e)}},UGe:function(){var t,t,n,i,t=this.HGe(),t=t.sortBefore||t.sortInfo,n=u([],this.iRt,!0);this.HTr()&&(i=this.Efe.slice()),this.oRe.FEe({type:o.ViewChangeType.SortUpdate,oldData:{sortInfo:t,indexMap:n,baseIndexMap:i}})},VGe:function(t){var n=this,t=t||n.autoSort,i=n.DLt&&0<n.DLt.length;t&&i&&(n.isHierarchy()?n.KFt(n.DLt):n.JFt(n.DLt))},zGe:function(t){var n=this,t=t||n.autoSort,i=n._Lt&&0<n._Lt.length;t&&i&&n.HFt(n._Lt)},nPt:function(t,n){var i=this;i.hde(t),i.YGe(n)},YGe:function(t,n){var i,r,t,n,i=this;i.VGe(n),i.PFt(t,n),i.zGe(n),i.$1r&&(r=i.$1r.filter(function(t){return t.K1r}),t=0,n=!1,this.NLt&&(t=this.NLt.length,this.NLt=this.NLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.NLt.length!==t)&&(n=!0),this.kLt&&(t=this.kLt.length,this.kLt=this.kLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.kLt.length!==t)&&(n=!0),this._Lt&&(t=this._Lt.length,this._Lt=this._Lt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this._Lt.length!==t)&&(n=!0),n=!(!this.DLt||(t=this.DLt.length,this.DLt=this.DLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.DLt.length===t))||n)&&i.tFt(e,!0,e,!0)}})},"./dist/src/view/view-status.js":function(t,n,i){"use strict";var u,n,a,i,n,r,u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),a=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/view/view.js"),n=n.Common.lt.Dh,r=null,n(i.View.prototype,{BQe:function(t,n){var i,t,n,n,i,i=this;return!(0,a.isNullOrUndefined)(i.FQe)&&(t=i.RJ(t),n=(n=i.kve(n))&&n.name,!(0,a.isNullOrUndefined)(n))&&(0,a.isNumber)(t)&&(i=i.FQe[n])?i[t]:r},GQe:function(t,n,i){var r,e,t,e,n,e,r,e=this;(0,a.isNullOrUndefined)(e.FQe)||(t=e.RJ(t),n=(e=e.kve(n))&&e.name,!(0,a.isNullOrUndefined)(n)&&(0,a.isNumber)(t)&&((e=this.FQe[n])?(r=e[t],i?e[t]=u(u({},r),i):r&&delete e[t]):this.FQe[n]=((r={})[t]=u({},i),r)))},UQe:function(t,n){var i,r,t,e,i,i=this,r,t=i.$Ge(t).name;n&&(i=(e=i.$Ge(n)).name,this.FQe[i]=this.FQe[t]),delete this.FQe[t]},HQe:function(t,n,i){var r,e,u,o,s,c,f,r,e=this.FQe;if(e)for(u in e)if(e.hasOwnProperty(u)&&(o=e[u],!(0,a.isNullOrUndefined)(o)))if(s=Object.keys(o),i&&0<i.length)(0,a.removeIndexes)(s,i,!0);else for(c=0;c<s.length;c++)t+n<=(f=+s[c])?(o[f-n]=o[f],delete o[f]):t<=f&&f<t+n&&delete o[f]},VQe:function(t){var n,i,r,e,u,o,s,n,i=this.FQe;if(i)for(r in i)if(i.hasOwnProperty(r)&&(e=i[r],!(0,a.isNullOrUndefined)(e)))for(o=(u=Object.keys(e)).length-1;0<=o;o--)t<=(s=+u[o])&&(e[1+s]=e[s],delete e[s])}})},"./dist/src/view/view-style.js":function(t,n,i){"use strict";var e,n,r,u,o,e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/view/view.js"),u=i("./dist/src/undo/interface.js"),(o=n.Common.lt.Dh)(r.View.prototype,{getStyleRules:function(){return this.LEt.styleRules},getStyleRule:function(t){var t,n,n=this.getStyleRules();return e({},t?null!=(t=n[t])?t:{}:null!=n?n:{})},addStyleRule:function(t,n,i){var n,r,i,n;t&&(r={},n&&(r.style=n),i&&(r.rule=i),i=null!=(n=this.getStyleRules())?n:{},n=e({},i),i[t]=r,this.oRe.FEe({type:u.ViewChangeType.StyleRuleChanges,oldData:n}))},removeStyleRule:function(t){var n,i,n=this.getStyleRules(),i=e({},n);delete n[t],this.oRe.FEe({type:u.ViewChangeType.StyleRuleChanges,oldData:i})},clearStyleRules:function(){var t,t,t=e({},null!=(t=this.LEt.styleRules)?t:{});this.LEt.styleRules={},this.oRe.FEe({type:u.ViewChangeType.StyleRuleChanges,oldData:t})}})},"./dist/src/view/view-util.js":function(P,e,t){"use strict";var j,f,M,s,c,a,y,F;function o(t,n,i,r){var e,t,e=t?i:r,t=t?r:i;return(0,M.isNullOrUndefined)(e)&&(0,M.isNullOrUndefined)(t)?0:(0,M.isNullOrUndefined)(e)?-1:(0,M.isNullOrUndefined)(t)?1:"number"==typeof n||n instanceof Date?e-t:t<e?1:e<t?-1:0}function n(t,n,i,r,e){var u,e,u=t?e[i]:e[r],e=t?e[r]:e[i];return u!==F&&e!==F?u-e:u!==F?-1:e!==F?1:o(t,n,i,r)}function i(t,n,i,r,e){var u,o;if(i instanceof Date)if(-1<s.indexOf(n))i=i.getTime(),u=r,r=function(t,n,i){return u(t,n,i)&&u(t,n,i).getTime()};else{if(-1<c.indexOf(n))return function(){return!1};if(-1<a.indexOf(n))return function(){return!0}}return o=h(t,n,i,e),function(t,n,i){return o(r(t,n,i))}}function h(t,n,i,r){var e,u,o,s,c,c,c,e=i+"",u=e&&e.length;switch((0,M.isString)(i)&&(o=f.Common.$T.jJ(i)),s=t.gLt,n){case"eq":return c=function(t){return t===i},(0,M.isNullOrUndefined)(i)&&(c=function(t){return t===y||t===F}),o?function(t){return new RegExp("^"+o+"$").test(t)}:c;case"neq":return c=function(t){return t!==i},(0,M.isNullOrUndefined)(i)&&(c=function(t){return t!==y&&t!==F}),o?function(t){return!new RegExp("^"+o+"$").test(t)}:c;case"lt":return function(t){return null!==t&&t<i};case"lte":return function(t){return null!==t&&t<=i};case"gt":return function(t){return i<t};case"gte":return function(t){return i<=t};case"startswith":return o?function(t){return new RegExp("^"+o).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,u)===i};case"doesnotstartwith":return o?function(t){return!new RegExp("^"+o).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,u)!==i};case"endswith":return o?function(t){return new RegExp(o+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1!==(t+"").indexOf(i,(t+"").length-u)};case"doesnotendwith":return o?function(t){return!new RegExp(o+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1===(t+"").indexOf(i,(t+"").length-u)};case"contains":return o?function(t){return new RegExp(o).test(t)}:function(t){return"string"==typeof(t+"")&&0<=(t+"").indexOf(i)};case"doesnotcontain":return o?function(t){return!new RegExp(o).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").indexOf(i)<0};case"top":case"bottom":return(c=t.uFt(r))||(t.eRt([r]),c=t.uFt(r)),i=v(Object.keys(c),n,i),function(t){return-1<i.indexOf(t)};case"above":return i=d(l(t,s,r),s.jRt(r)),function(t){return i<t};case"below":return i=d(l(t,s,r),s.jRt(r)),function(t){return t<i};case"quarter":return function(t){return p(i,t)};case"month":return function(t){return(t&&t.getMonth())===i};default:return function(){return!1}}}function l(t,n,i){var n,r,e,u,o;if(!i)return[];if(n=n._dataSource._data[i])return n.data;if(r=t.length(),e=[],u=t.$Ge(i,!0,!0))for(o=0;o<r;o++)e.push(t.Lgr(o,o,u));return e}function v(t,n,i){for(var r,e,u,o,r=[],e=0,u=t;e<u.length;e++)o=u[e],isNaN(o)||r.push(parseFloat(o));return i>=r.length||("top"===n?r=b(r,i):"bottom"===n&&(r=_(r,i))),r}function d(t,n){var i,r,e,u,o,i=0;if(!t||0===t.length)return i;for(r=n&&n.dataMap,e=0,u=t;e<u.length;e++)o=u[e],"number"==typeof(o=r&&"number"==typeof r[o]?r[o]:o)&&(i+=o);return i/t.length}function p(t,n){var i=n&&n.getMonth();switch(t){case 0:return i<=2;case 1:return 3<=i&&i<=5;case 2:return 6<=i&&i<=8;case 3:return 9<=i;default:return!1}}function r(t,n,i,r){for(var e,u,o,s,e=0,u=0,o=n.length;u<o&&0===(e=(s=n[u]).WFt(t,n,i,r));u++);return e}function u(t){return Array.isArray(t)?t:[t]}function w(t,n){var i,r;if(0===t.length)return[];for(i=t.slice(0),r=0;r<n;r++)-1===t.indexOf(r)&&i.push(r);return i}function b(t,n){for(var i,r,e,i=m(t.slice(0,n)),r=n;r<t.length;r++)t[r]>i[0]&&(e=i[0],i[0]=t[r],t[r]=e,m(i));return i}function m(t){for(var n,i,n=t.length,i=Math.floor(n/2);0<=i;i--)g(t,i,n);return t}function g(t,n,i){var r,e,u,r,r=2*n+1,e=2*n+2,u=n;r<i&&t[r]<t[u]&&(u=r),n!==(u=e<i&&t[e]<t[u]?e:u)&&(r=t[n],t[n]=t[u],t[u]=r,g(t,u,i))}function _(t,n){for(var i,r,e,i=O(t.slice(0,n)),r=n;r<t.length;r++)t[r]<i[0]&&(e=i[0],i[0]=t[r],t[r]=e,O(i));return i}function O(t){for(var n,i,n=t.length,i=Math.floor(n/2);0<=i;i--)C(t,i,n);return t}function C(t,n,i){var r,e,u,r,r=2*n+1,e=2*n+2,u=n;r<i&&t[r]>t[u]&&(u=r),n!==(u=e<i&&t[e]>t[u]?e:u)&&(r=t[n],t[n]=t[u],t[u]=r,C(t,u,i))}function S(t,n){for(var i,r,e,u,i=0,r=t;i<r.length;i++)if(u=n(e=r[i]))return u}function N(n){var t,i,r,e,t=n.style,i=(i=(t=t||(n.style={})).cellButtons)||(t.cellButtons=[]),r=(r=t.dropDowns)||(t.dropDowns=[]);(e=S(i,function(t){return"openDateTimePicker"===t.command}))?i.forEach(function(t){t.enabled=!n.readonly}):i.push({imageType:"dropdown",command:"openDateTimePicker",useButtonStyle:!1,buttonBackColor:"transparent",enabled:!n.readonly}),(e=S(r,function(t){return"dateTimePicker"===t.type}))||r.push({type:"dateTimePicker",option:{showTime:!1,calendarPage:"day",startDay:"sunday"}})}function T(n,t){var i,r,i=(0,M.findIndex)(t,function(t){return R(t)===n});return-1<i&&(r=t[i]).width||e.GROUP_COLUMN_WIDTH}function R(t){var t;return(0,M.isString)(t)||"string"==typeof(t=t.value)?t:"function"==typeof t?t.name:void 0}function I(t){return!t.JOt}function E(t){var n,i,r,e,u,n=I(t);if(n){for(t.WOt++,r=0,e=i=t.eBt();r<e.length&&(!(u=e[r])||u.WOt||(n=E(u)));r++);t.WOt--}return n}function x(t){return t.isGroup||t.isCross||t.zTr}function A(t){return D(t[0])}function D(t){return t.operator===F}function k(t){return t[0].operator!==F&&t[0].ort}function L(h,l,v,d,p,w){for(var b,m,t,n,i,r,b=v.isHierarchy(),m={},t=function(n){var t,i,r,e,u,o,s,c,f,a;if(n&&!m[n.field]&&((0,M.isNullOrUndefined)(p)||n.field===p)){if(m[n.field]=!0,(t=v.uFt(n.field))||(v.eRt([n.field]),t=v.uFt(n.field)),i=t&&Object.keys(t),e=void 0,(r=l[n.field])instanceof Date){for((u=new Date(r)).setHours(0,0,0,0),o=u.toISOString().slice(0,10),e=!0,s=0,c=i;s<c.length;s++)if((f=c[s]).startsWith(o)){e=!1;break}}else e=(0,M.isNullOrUndefined)(r)?-1===i.indexOf("null")&&-1===i.indexOf("undefined"):-1===i.indexOf(r+"");if(!h.some(function(t){return t.field===n.field&&t.value===r})&&e&&(A(h)?(h.push(j(j({},n),{value:r,isAdded:!0})),b&&V(v,h[h.length-1],p,r,w)):(k(h)||r===d&&void 0===d)&&h.push(j(j({},n),{value:r,operator:"eq",relation:"or",isAdded:!0}))),-1<i.indexOf(d+"")&&1===t[d].length&&d!==r)for(a=0;a<h.length;a++)if(h[a].value===d&&h[a].isAdded){h.splice(a,1);break}}},n=0,i=h;n<i.length;n++)t(r=i[n])}function V(t,n,i,r,e){var i,u,o,s;if(n.field===i||(0,M.isNullOrUndefined)(i)){if(i=void 0,n.Vce)(i=n.Vce.slice())[0]=r;else{for(o=(u=t.getHierarchyNode(e,!0)).parent,s=[r];!o.isRoot;)s.push(o.getFieldValue(n.field)),o=o.parent;i=s}n.Vce=i}}function q(t){var n,i,r,e,e;if((0,M.isNullOrUndefined)(t))return t;for(n=[],i=0,r=t;i<r.length;i++)e=r[i],(e=j({},e)).getValue&&delete e.getValue,n.push(e);return n}function G(r,e){var t,u,o,t,u=function(n,i,r,t){return t.every(function(t){return t(n,i,r)})},o=function(){for(var t,n,i,t=[],n=[r[0]],i=1;i<r.length;i++)"or"===e[i]?(t.push(n),n=[r[i]]):n.push(r[i]);return 0<n.length&&t.push(n),t}();return function(n,i,r){return o.some(function(t){return u(n,i,r,t)})}}function H(t,r){var e;return t&&t.dataMap?(e=JSON.parse(JSON.stringify(t.dataMap)),function(t,n,i){var t=r(t,n,i);return void 0!==e[t]?e[t]:t}):r}function B(t,n,i,r,e){var u,o,s,r,c,f,a,h,l,v,d,p,w,b,m,j,u=[],o=!1,s=!1,r=r.map(function(t){var n=t.value;return n===y&&(o=!0),n===F&&(s=!0),t.value});for(o&&!s&&r.push(F),s&&!o&&r.push(y),c=0,f=r;c<f.length;c++)for(a=f[c],l=0,v=h=i&&i[a]||[];l<v.length;l++)u[d=v[l]]=!0;for(p=n,w=t.reduce(function(t,n){return t[n]=!0,t},{}),b=0,m=e;b<m.length;b++)!u[j=m[b]]||0<n&&w[j]||(t[p]=j,p++)}function U(t,n,i,r,e,u,o){var s,c,f,a,h,l,v,d,p,w,b,m,j,y,g,_,O,C,S,s=[],c=r.map(function(t,n){return n}),f=[];if(e&&e.length&&(a=!(c=[]),r.forEach(function(t,n){-1<u.indexOf(n)?(s.push(n),c.push(F)):(s.push(F),c.push(n)),t.isCross&&(a=!0)}),t=e[t],n=e[n],a)){for(h=[],l=[],v=0;v<r.length;v++)(r[v].isCross?(h[r[v].RBt]||(h[r[v].RBt]=[],f.push(h[r[v].RBt])),d=h[r[v].RBt]):f).push(v),t===v&&(t=f.length-1),n===v&&(n=f.length-1);for(p=0,w=u;p<w.length;p++)b=w[p],l.push(f.indexOf(b));s=[],c=[],f.forEach(function(t,n){-1<l.indexOf(n)?(s.push(n),c.push(F)):(s.push(F),c.push(n))}),i=1}if((0,M.swapArrayItems)(c,t,n,i),c=c.filter(function(t){return!(0,M.isNullOrUndefined)(t)}),e&&e.length){for(v=0;v<s.length;v++)void 0===s[v]&&(s[v]=c.shift());if(f&&f.length){for(m=[],j=0;j<s.length;j++)if(y=s[j],Array.isArray(f[y]))if("string"==typeof(g=o[j].cross)){for(_=[s[j]];j+1<o.length&&g===o[j+1].cross;)_=_.concat(s[j+1]),j++;for(O=f[_[0]].length,C=[],S=0;S<O;S++)for(v=0;v<_.length;v++)C.push(f[_[v]][S]);m=m.concat(C)}else m=m.concat(f[y]);else m.push(f[y]);s=m}}else s=c;return s}j=this&&this.__assign||function(){return(j=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(e,"__esModule",{value:!0}),e.ePt=e.hFt=e.mapGetValueFunc=e.aFt=e.removeExtraInfos=e.addFilterInfoForFieldValue=e.isFieldListFilterInfo=e.isFieldListFilter=e.isViewColumn=e.isTableDataReady=e.getColumnName=e.getGroupColumnWidth=e.applyDateTimePicker=e.array_find=e.generatePinnedColumnIndexMap=e.getSortInfos=e.multiSort=e.oFt=e.compareListValue=e.compareValue=e.GROUP_COLUMN_WIDTH=void 0,f=t("Common"),M=t("./dist/src/dataSource/utils.js"),s=["eq","neq","lt","lte","gt","gte"],c=["startswith","doesnotstartwith","endswith","contains"],a=["doesnotendwith","doesnotcontain"],y=null,F=void 0,e.GROUP_COLUMN_WIDTH=100,e.compareValue=o,e.compareListValue=n,e.oFt=i,e.multiSort=r,e.getSortInfos=u,e.generatePinnedColumnIndexMap=w,e.array_find=S,e.applyDateTimePicker=N,e.getGroupColumnWidth=T,e.getColumnName=R,e.isTableDataReady=E,e.isViewColumn=x,e.isFieldListFilter=A,e.isFieldListFilterInfo=D,e.addFilterInfoForFieldValue=L,e.removeExtraInfos=q,e.aFt=G,e.mapGetValueFunc=H,e.hFt=B,e.ePt=U},"./dist/src/view/view.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/view/view.js"),n),e(i("./dist/src/view/view-calc.js"),n),e(i("./dist/src/view/view-status.js"),n),e(i("./dist/src/view/view-style.js"),n),e(i("./dist/src/view/view-event.js"),n),e(i("./dist/src/view/view-group.js"),n),e(i("./dist/src/view/view-sort.js"),n),e(i("./dist/src/view/view-filter.js"),n),e(i("./dist/src/view/view-cross.js"),n)},"./dist/src/view/view.js":function(P,t,n){"use strict";var f,y,C,o,p,r,b,i,g,u,_,s,w,O,e,k;function c(t){return{rule:{area:o.ViewArea.colHeader,direction:o.StateRuleDirection.column,state:t},style:{decoration:{icons:[{src:""}]}}}}function a(t){(0,C.isNullOrUndefined)(t.styleRules)&&(t.styleRules=(0,C.clone)(e,!0))}function h(t){return t instanceof Date&&!isNaN(t.valueOf())}function l(t){return i.Common.ct.Q0(t)}function v(t){var n=i.Common.ct.dJ(t);return n&&!h(n)&&(n=i.Common.ct._DT(t)),h(n)?n:null}function d(t){var n,i,r,e,n=[],i=t.columns;if(i)for(r in i)i.hasOwnProperty(r)&&("="===(e=(0,C.clone)(i[r])).value[0]&&e.name&&(e.value=e.name),n.push(e));return n}function m(t){return 0===t?"":"_"+t}function j(t,n,i,r,e){var u,o,e,e;return(0,C.isNullOrUndefined)(r)||(o=r.value,r.isCross||r.isGroup||r.zTr?e&&(e=e.getFieldByName(o))&&(u=e.getValue(i,n)):o&&("string"==(e=typeof o)?u=F(t,r,i):"function"==e&&(u=r.value(t.iBt(i))))),u}function S(e,a,t,h,i,l,u,v,o,n){var d,s,r,c,f,p,w,d={},s=[],r=!!i;if(a.forEach(function(t,n){var i,r,i=t.value;u&&!u[i]||(t.isCross?h&&(d[t.value]=h.getFieldByColumn(t).getValue(l)):t.isGroup?h&&h.xve(d,t,l,v,o):i&&("string"==typeof i?(r=v&&t.caption||i,d[r]=F(e,t,l)):"function"==typeof i&&s.push({name:i.name,caption:t.caption,value:i})))}),0<s.length&&(c=e.iBt(l),s.forEach(function(t){d[t.name]=t.value(c)})),r&&h&&i&&n){for(f in u)u.hasOwnProperty(f)&&u[f]&&(d[f]=M(h,f,l,v));for(p=function(c){for(var f,t,n,f=i[c].summaryFields,t=function(i){var t,n,t,r,e,u,o,s,t=f[i];if(t&&t.slice){for(n=m(c),t=t.caption+"_"+t.slice+n,r={},u=0,o=e=a.filter(function(t){var n=(0,b.getGroupOptionIndexesFrom)(t.value);return t.isGroup&&3===n.length&&+n[0]===c&&+n[1]===i});u<o.length;u++)r[(s=o[u]).caption]=M(h,s.value,l,v);d[t]=r}},n=0;n<f.length;n++)t(n)},w=0;w<i.length;w++)p(w)}return d}function M(t,n,i,r){for(var e,u,o,s,c,e,u=0,o=t.getFields();u<o.length;u++)if(s=o[u],(c=r&&!(0,b.isGroupSlice)(s.name)&&s.extra&&s.extra.caption||s.name)===n)return s.getValue(i)}function F(t,n,i){return N(t._getValueByField(n.value,i),n)}function N(t,n){var n=n&&n.dataMap;return t=n?n[t]||t:t}function T(t,n){var i,r,e,u,i=t.value,r=t.dataMap,e=n[i];if(r)for(u in r)if(e===r[u]){n[i]=e=isNaN(u)?u:+u;break}}function R(t,n){var i,r,i=[];for(r in t)t[r]!==n[r]&&i.push(r);return i}function I(t,n){var i,r,i={};for(r in t)n.hasOwnProperty(r)||(i[r]=t[r]);return i}function L(t,n){var i,r,i={};for(r in n)t.hasOwnProperty(r)&&n.hasOwnProperty(r)&&(i[r]=t[r]);return i}function E(t,n,i){for(var r,e,r=0;r<n.length;r++)if((e=n[r]).value===i||e.caption===i)return!t.columns[e.value]||e.zTr||(0,C.isFormula)(t.columns[e.value].value)||(0,C.isFormula)(e.value)?(0,p.isViewColumn)(e)?{value:e.value,isGroup:e.isGroup,isCross:e.isCross,zTr:e.zTr}:{value:e.value}:e.value;return i===t.uBt()||t.columns[i]?i:t.XOt[i]?{value:i}:w}function x(r,t,n){return!1!==n&&"="===t[0]?function(t,n,i){return(0,C.formatCalcError)(r(t,n,i))}:r}function V(n,t,i,r,e,u){var o,s,c,f,a,h,l,v,o=E(n,t,r);return e?(0,p.isViewColumn)(o)?(e.getValue=i.getFieldByName(o.value),x(function(t,n,i){return i.getValue.getValue(n)},o.value,u)):o.value?(e.getValue=n.XOt[o.value],(0,C.isNullOrUndefined)(e.getValue)&&(e.getValue={getValue:function(t){return n._getValueByField(o.value,t)}}),x(function(t,n,i){return i.getValue.getValue(n)},o.value,u)):(e.getValue=n._dataSource._data[o].data,n.TBe()?(s={},c=n.nv.bind(n),function(t,n,i){var r=s[n];return r===O&&(s[n]=r=c(n)),i.getValue[r]}):function(t,n,i){return i.getValue[n]}):(f=String(o.value),a=String(o),o.value?x(function(t,n){return t._getValueByField(f,n)},f,u):n.TBe()?(h={},l=n.nv.bind(n),v=n._dataSource._data[a].data,function(t,n){var i=h[n];return i===O&&(h[n]=i=l(n)),v[i]}):function(t,n){return t._dataSource._data[a].data[n]})}function A(t){var n=(0,p.getColumnName)(t);return(0,C.isFormula)(n)&&!(0,C.isNamedFormulaColumn)(t)||(0,C.isRelation)(n)||(0,C.isFunction)(n)}function D(t,n,i,r){void 0===i&&(i=!0),void 0===r&&(r={}),this.rPt=10,this.lFt=[],this.CLt=[],this.oPt=[],this.ZOt={},this.FQe={},this.dIr=!1,this.dme=0,this.rb=0,this.BLt={},this.Igr=!0;var e=this;e.name=t,Object.defineProperty(e,"tableName",{get:function(){var t;return null==(t=e.gLt)?void 0:t.name}}),e.ILt=(0,C.clone)(n=n||[]).map(function(t){return"string"==typeof t?{value:t}:t}),e.yLt=n.map(function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),t}),e.aPt=i,e.autoSort=!0,e.autoFilter=!1,e.autoGroup=!0,e.UFt=!0,e.dde=!1,a(r),(e.LEt=r).styleRules||e.clearStyleRules(),this.oRe=new u.ChangesHelper(e)}f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},y=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.View=t.rFt=t.ZFt=t.nse=t.tse=t.ose=void 0,C=n("./dist/src/dataSource/utils.js"),o=n("./dist/src/interfaces/interface.js"),p=n("./dist/src/view/view-util.js"),r=n("./dist/src/viewField/fieldManager.js"),b=n("./dist/src/viewField/groupManager.js"),i=n("Common"),g=n("./dist/src/table/windowOverField.js"),u=n("./dist/src/undo/changesHelper.js"),_=n("./dist/src/undo/interface.js"),s=n("./dist/src/dataSource/dataSource.js"),w=null,O=void 0,e={pin:c(o.RowColumnStates.pin),primaryKey:c(o.RowColumnStates.primaryKey),readonly:c(o.RowColumnStates.readonly),required:c(o.RowColumnStates.required)},t.ose=d,t.tse=m,t.nse=S,t.ZFt=E,t.rFt=V,D.prototype.Agr=function(t){if(0===arguments.length)return this.Igr;this.Igr=t,this.lLt&&this.MFt&&this.Cgr(this.MFt)},D.prototype.XLt=function(){var t,n=this.gLt;return(0,p.isTableDataReady)(n)},D.prototype.Ywt=function(t,n,i){var r=this.gLt;return r&&r.Ywt(t,n,i)},D.prototype.vde=function(t){var n,i=this.gLt.POt;return i.getCalcService().unparse(i,t,0,0)},D.prototype.nMt=function(t,n,i){var n=this.RJ(n),i=this.uPt(i);return this.sPt(t,n,i)},D.prototype.sPt=function(t,n,i){return this.jfe(t,n,(0,C.isNumber)(i)?(0,p.getColumnName)(this.yLt[i]):O)},D.prototype.jfe=function(t,n,i){var r,e,t,r=this.gLt;if(r)return!(e=!1,C.isNullOrEmpty)(i)&&(0,C.isNullOrUndefined)(r.XOt[i])&&(e=!0,r.XOt[i]=this.lLt.getFieldByName(i)),t=r._fe(t,n,i),e&&delete r.XOt[i],t},D.prototype.cPt=function(){var t=this,n=t.gLt;n&&(t.aPt&&t.yLt.length<=0&&(t.yLt=d(n),t.ILt=(0,C.clone)(t.yLt)),t.fPt(),t.lPt())},D.prototype.getTable=function(){return this.gLt},D.prototype.PRt=function(t){var n=this;t?(n.gLt=t,n.JLt(),n.bLt()?n.XLt()&&(n.RFt(),n.cPt()):(n.XLt()&&n.qTr()&&n.RFt(),n.cPt()),t.Whe=n.Whe.bind(n),n.XLt()&&(n.hPt(),n.dPt=!0,n.dde||(n.dde=!0,n.mde(),n.Whe(),n.gLt.fme())||n.tFt()),n.v7()):(n.wpt(),n.gLt=t)},D.prototype.TAr=function(){return!!this.gLt},D.prototype.HTr=function(t){var n=this;if(0===arguments.length)return n.dIr&&!n.autoFilter&&!n.autoSort&&!n.autoGroup;n.autoFilter=!(t=!!t),n.autoSort=!t,n.autoGroup=!t,(n.dIr=t)&&!n.Efe&&n.gFt()},D.prototype.fPt=function(){var t,t,n,t,i,r,e,u,o,s,c,f,a,h,n=null==(t=null==(t=this.gLt._dataSource.options)?void 0:t.schema)?void 0:t.columns;if(n)for(t=this.yLt,r=(i=this.isHierarchy())&&this.gLt._dataSource.options.schema.hierarchy.column,e=["caption","width","style","conditionalFormats","validator","isPrimaryKey","readonly","required","defaultValue","headerStyle","visible","headerFit","indexed","allowSort","allowFilterByValue","allowFilterByList","dataMap","lookup"],u=0,o=t;u<o.length;u++)if("string"==typeof(s=o[u]).value&&(i&&s.value===r&&(s.readonly=!0),c=n[s.value])){for(f=0,a=e;f<a.length;f++)(0,C.isNullOrUndefined)(s[h=a[f]])&&(s[h]=c[h]);s.dataType=c.dataType,"date"===c.dataType&&(0,p.applyDateTimePicker)(s),"formula"===c.dataType&&(s.readonly=!0),i&&"rowOrder"===c.dataType&&(s.readonly=!0),c.n7t&&"rowOrder"!==c.dataType&&(s.readonly=!1,delete c.n7t)}},D.prototype.lPt=function(){for(var t,n,i,r,e,t=this.LEt.defaultColumnWidth||60,n,i=0,r=this.yLt;i<r.length;i++)e=r[i],(0,C.isNullOrUndefined)(e.width)&&(e.width=t)},D.prototype.ame=function(){var n=this,t;return n.yLt.some(function(t){return n.PAe(t)})},D.prototype.lme=function(){var t=this;return!t.vme()&&t.ame()&&t.gLt.fme()},D.prototype.PAe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.PAe(t.value)},D.prototype.GAe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.GAe(t.value)},D.prototype.bde=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.bde(t.value)},D.prototype.gde=function(t){var n,i,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,j,n=this,i=n.gLt,r=i.XOt,e=[];if(t){if(o=[],u=i.fme())for(s=n.getColumnInfos(O,O,O,!0),c=0;c<s.length;c++)f=s[c],a=n.GAe(f),o=o.concat(a);for(h in r)if(r.hasOwnProperty(h)&&(l=r[h])instanceof g.WindowOverCalcField&&!1!==l.Khe&&!l.options.ume&&(e.push(l.options),l.options.ume=!0,u))for(v=l.options.windowOverFormula.slice(1),d=0;d<o.length;d++)if(-1<(p=o[d]).indexOf(v)){l.options._de=!0;break}if(u){for(w=[],b=[],d=0;d<e.length;d++)delete(m=e[d]).ume,(m._de?(delete m._de,w):b).push(m);return[w,b]}for(d=0;d<e.length;d++)delete(m=e[d]).ume}else for(s=n.getColumnInfos(),c=0;c<s.length;c++)if(f=s[c],0<(j=n.GAe(f)).length)for(d=0;d<j.length;d++)!1!==(l=r[v=j[d]]).Khe&&e.push(l.options);return[e,[]]},D.prototype.pde=function(t){for(var n,i,r,t,e,i,u,o,s,c,f,a,n=this,i=t[0],r=t[1],t=n.Dde(i),e=t.windowOverInfoMap,i=t.windowOverInfos,u=[],o=0;o<r.length;o++)s=r[o],(0,C.isNullOrUndefined)(e[s.partitionKey])||(0,C.isNullOrUndefined)(e[s.partitionKey].orderMap[s.orderKey])?u.push(s):(c=e[s.partitionKey].orderMap[s.orderKey],f=s.frameKey+"__"+s.windowFormula,(0,C.isNullOrUndefined)(c.functionMap[f])&&(c.functionMap[f]=!0,c.orderFunctions.functions.push({orders:s.orders,windowOverFormula:s.windowOverFormula,windowFormula:s.windowFormula,windowFrame:s.windowFrame})));return[a=n.Dde(u).windowOverInfos,i]},D.prototype.Dde=function(t){for(var n,i,r,e,u,o,s,c,c,f,a,a,n,h,l,v,d,i={},r=[],o=0;o<t.length;o++)e=(s=t[o]).partitionKey,u=s.orderKey,(0,C.isNullOrUndefined)(i[s.partitionKey])&&(c={partitions:s.partitions,orderedFunctions:[]},i[s.partitionKey]={index:r.length,orderMap:{},windowOverInfo:c},r.push(c)),f=(c=i[s.partitionKey]).orderMap,(0,C.isNullOrUndefined)(f[s.orderKey])&&(a={orders:s.orders,functions:[]},f[s.orderKey]={index:c.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:a},c.windowOverInfo.orderedFunctions.push(a)),a=s.frameKey+"__"+s.windowFormula,n=f[s.orderKey].functionMap[a],h=s.windowFrame&&s.windowFrame.exclude,((0,C.isNullOrUndefined)(n)||(0,C.isNullOrUndefined)(n[h]))&&(f[s.orderKey].functionMap[a]=((n={})[h]=!0,n),f[s.orderKey].orderFunctions.functions.push({orders:f[s.orderKey].orderFunctions.orders,windowOverFormula:s.windowOverFormula,windowFormula:s.windowFormula,windowFrame:s.windowFrame}));return l=function(t){var n,t,t,i,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[u];1<n.length&&(i=n[t=t.index],n.splice(t,1),n.push(i))},1<r.length?(d=r[o=(v=i[e]).index],r.splice(o,1),r.push(d),l(v)):1===r.length&&l(i[e]),{windowOverInfoMap:i,windowOverInfos:r}},D.prototype.mde=function(){for(var t,n,i,r,t=this,n=t.getColumnInfos(),i=0;i<n.length;i++)r=n[i],t.bde(r)},D.prototype.Whe=function(t){var n,i,n,r,n,e,u,o,s,c,f,a,i=this;if(0===i.dme){for(t&&null!=(n=i.BFt)&&n.dl(),r=(n=i.pde(i.gde(t)))[0],n=n[1],e=0,u=r;e<u.length;e++)s=(o=u[e]).partitions,c=o.orderedFunctions,i.windowOver(s,c,!0);for(f=0,a=n;f<a.length;f++)s=(o=a[f]).partitions,c=o.orderedFunctions,i.windowOver(s,c,t);return!0}},D.prototype.mme=function(){this.dme++},D.prototype.gme=function(){0<this.dme&&this.dme--,this.dme<=0&&(this.dme=0,this.Whe(!0),this.vge(),this.gLt.ake())},D.prototype.vme=function(){return 0!==this.dme},D.prototype.gFt=function(t){var n,i,r,e,r,n=this;if(n.HTr())return!n.Efe&&(n.Efe=n.qFt(t),n.iRt)?void(n.Pct()&&(i=n.kLt,e=(r=n.hIr(i)).startRow,r=r.endRow,n.fde(n.Efe,i,e,r))):void(n.iRt=n.Efe.slice());n.XFt()||(n.iRt=n.qFt(t))},D.prototype.qFt=function(t){var n,i,r,t,e,u,n=[],i=t||this.length(),r=this.lFt,t=r.length;for(0<t&&(n=r.slice(0)),e=t,u=0;u<i;u++)-1===r.indexOf(u)&&(n[e]=u,e++);return n},D.prototype.jRt=function(t){return O},D.prototype.RFt=function(t){var n=this,i=n.gLt;return n.iRt||n.gFt(),n.lLt=new r.FieldManager(n.LEt,i),n.ELt(),n.yLt=n.lLt.prepareFields(t||n.yLt,{getCalcSource:function(){return n.oIr},getCalcOptions:function(){return n.aIr()}}),n.YBt(),n.lLt},D.prototype.vIr=function(){var i,t,n,r,i=this;if(i.$Tr(),0<(t=Object.keys(i.ZOt)).length)for(r in n=i.yLt.reduce(function(t,n){return n.zTr&&(t[i.ife(n)]=!0),t},{}),i.ZOt)n[r]&&delete i.ZOt[r]},D.prototype.getLookup=function(t){return(0,r.getLookupBy)(this.gLt,t)},D.prototype.isLookupField=function(t){return(0,r.isLookupField)(this.gLt,t)},D.prototype.isLookupListField=function(t){return(0,r.isLookupListField)(this.gLt,t)},D.prototype.isLookupRelationField=function(t){return(0,r.isLookupRelationField)(this.gLt,t)},D.prototype.RJ=function(t){return this.iRt||this.gFt(),this.iRt[t]},D.prototype.sIr=function(t){if(this.HTr())return this.Efe||this.gFt(),this.Efe[t]},D.prototype.FLt=function(t){return this.iRt||this.gFt(),this.iRt.indexOf(t)},D.prototype.gIr=function(t){var n=this.sIr(t);return n!==O?this.FLt(n):t},D.prototype.VGr=function(t){return this.Efe||this.gFt(),this.Efe.indexOf(t)},D.prototype.length=function(){return this.gLt.length()},D.prototype.visibleLength=function(){return this.iRt||this.gFt(),this.iRt.length},D.prototype.getDirtyIndexes=function(){var n=this;return n.gLt.getDirtyIndexes().map(function(t){return n.FLt(t)})},D.prototype.isInserted=function(t){var n=this,t=n.RJ(t);return n.vPt(t)},D.prototype.vPt=function(t){return this.gLt.isInserted(t)},D.prototype.isUpdated=function(t){var n,t,t,n=this,t=n.RJ(t);return n.PLt(!1),t=n.gLt.isUpdated(t,n.bLt()),n.PLt(!0),t},D.prototype.getErrorInfo=function(t){var n,t=this.RJ(t);return this.gLt.getErrorInfo(t)},D.prototype.K3e=function(){return this.gLt.K3e()},D.prototype.insertItem=function(t,n,i,r,e,u,o,s){var c=this;return c.HTr()&&(t=c.gIr(t)),c.mIr(t,n,i,r,e,u,o,s)},D.prototype.mIr=function(t,n,i,r,e,u,o,s){var c,f,c=this;return c.isHierarchy()?0===(f=c.visibleLength())?void this.addHierarchyFirstItem(n,i,r,e,u):void(t<f?c.addHierarchyItemBefore(t,n,i,r,e,u):c.addHierarchyItemAfter(f-1,n,i,r,e,u)):c.mPt(t,n,i,r,u,o,s)},D.prototype.insertItems=function(t,n,i){var s,c,n,r,e,f,a,i,s=this,c=this,n=c.GLt(n,i),r=n.success,e=n.fail,f=0,a=0,i=t.map(function(o){return function(t,n){var i,r,e,u,i=o.row,r=o.isAfter,e=o.data;f<i&&(f=i),a++,0===(u=c.visibleLength())?s.addHierarchyFirstItem(e,t,n):r?c.addHierarchyItemAfter(i,e,t,n):c.addHierarchyItemBefore(i,e,t,n)}});return(0,C.promiseSerialExecute)(i).then(function(t){t.row=f,t.addedCount=a,r&&r(t)}).catch(function(t){e&&e(t)})},D.prototype.mPt=function(n,t,i,r,e,u,o){var s,i,c,r,i,f,e,t,a,h,l,v,d,p;return void 0===e&&(e=!0),i=(s=this).GLt(i,r),c=i.success,r=i.fail,i=s.visibleLength(),n=i<n?i:n,u=null!=u?u:s.RJ(n),f=e?s.gPt(t):t,s.ULt(f),this.oRe.FEe({type:_.ViewChangeType.Insert,index:n}),(0,C.isNullOrUndefined)(u)&&(s.Dit()?(u=s.length(),s.HLt(f,u)):u=n),e=s.gLt.uBt(),t=!(0,C.isNullOrUndefined)(e),a=s.isHierarchy(),h=u,l=n<i,t&&!a&&(d=v=void 0,p=!1,l?(v=s.RJ(n-1),d=h):(d=s.RJ(n-1),p=!0),f[e]=s.gLt.d7t(v,d,p)),!o&&s.HTr()?h=s.length():(t||a)&&(h=s.Dit()?s.length():i),s.gLt.insertItem(h,f,function(t){s.zLt(h,f,l,n,o),c&&c(t)},r,h!==u?u:w)},D.prototype.aRe=function(n,t,i,r){var e,i,u,r,o,s,e=this,i=e.GLt(i,r),u=i.success,r=i.fail,o=n,s=e.gPt(t);return e.gLt.recoverItemAtBatch(o,s,function(t){e.zLt(o,s,!0,n,!0),u&&u(t)},r)},D.prototype.zLt=function(t,n,i,r,e,u){var o,s,c,f,a,h,f,h,o=this;o.vIr(),s=o.HTr(),c=!(o.lme()&&!o.Dit())||s,i?(f=o.length()-1,o.cRt(f,n),o.VQe(f),a=o.autoFilter,(h=!(0,C.isNullOrUndefined)(o.NLt)&&!s)&&(o.autoFilter=!0),c&&((0,C.isNumber)(r)&&!o.tPt()&&(o.isHierarchy()||s)?e||(o.pIr(r,f,s),o.iRt.splice(r,0,f)):(o.pIr(-1,f,s),o.iRt.push(f))),o.tFt(O,!(h||!s&&e)),h&&(o.autoFilter=a)):(o.cRt(t,n),f=o.length(),h=!o.autoFilter&&!!o.iRt,!(h=(0,C.isNullOrUndefined)(i)&&(0,C.isNullOrUndefined)(r)&&o.isHierarchy()?!1:h)||!c||s&&e||(o.pIr(-1,f-1,s),o.iRt.push(f-1),s&&u&&o.Dit()&&o.iRt.pop()),o.tFt(f,h))},D.prototype.pIr=function(t,n,i,r){var e,i,e=this;(i=i===O?e.HTr():i)&&(i=void 0,i=t>=e.Efe.length||t<0?e.Efe.length:r?t:e.Efe.indexOf(e.iRt[t]),r?(0,C.insertIntoIndex)(e.Efe,i,n):e.Efe.splice(i,0,n))},D.prototype.gPt=function(t){var n,i,r,e,u,o,s,o,n={};if(this.isHierarchy())for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);for(e=0,u=r=this.yLt;e<u.length;e++)s=t[i=(o=u[e]).value instanceof Function?o.value.name:o.value],(0,C.isUndefined)(s)||("string"==typeof(o=o.value)?n[o]=s:o(n,s));return n},D.prototype.cTe=function(t,n,i,r){var e=this;e.ULt(t),e.iFt(t,n,i,r)},D.prototype.fTe=function(o,s,t,r){var n,c,e,u,f,a,h,l,v,i,d,p,w,b,m,j,y,g,_,O,n=this,c=n.gLt,e=n.lLt,u=Object.keys(o),f=this.yLt;if(n.vPt(s)&&u.some(function(n){return f.some(function(t){return t.isCross&&t.value===n})}))return!1;for(a={},h=[],l=function(t,n,i,r){var e,u,e,e=c.qRt(n);e.name!==c.name?(u=a[e.name],(0,C.isNullOrUndefined)(u)&&(a[e.name]=u={}),e=c.aTe(r?r.getRelationField(s):n,s),(0,C.isNullOrUndefined)(u[e])&&(u[e]={}),u[e][i]=t):o[n]=t},v=function(t,n,i){var r;h.push({data:((r={})[t.valueField]=o[n],r[t.dimRelationKey]=t.getDimValue(),r),valueRelation:t.valueRelation,onSucceeded:i})},i=function(t){var t,n,i,t,t=f[t],n=t.value;t.isCross&&-1<u.indexOf(n)&&(i=e.getFieldByColumn(t),t=c.KRt(i.valueRelation,s),i.isOneToMany?(t=t&&(0,C.isNumber)(i.getValueIndex(s)))?l(o[n],i.valueRelation,i.valueField,i):v(i,n,function(t){e.setCrossFieldInsertedIndex(i,s,t.index)}):t?(l(o[n],i.valueRelation,i.valueField),l(i.getDimValue(),i.dimRelationPath,i.dimRelationKey)):v(i,n),r[n]=o[n])},d=0;d<f.length;d++)i(d);if(0<(p=Object.keys(a)).length)for(w=0;w<p.length;w++)for(y in b=p[w],m=this.gLt.QOt.tables[b],j=a[b])j.hasOwnProperty(y)&&m.updateItem(Number(y),j[y]);if(0<h.length)for(g=0,_=h;g<_.length;g++)O=_[g],c.JRt(O.valueRelation,s,O.data,O.onSucceeded);return Object.keys(o).length===Object.keys(r).length?(n.VLt(o,t,s),n.YLt(o,t,s),!0):void 0},D.prototype.VLt=function(t,n,i){var r=this;r.lTe(i,t,n),r.uTe(t,n,i)},D.prototype.uTe=function(t,n,i){var r,e,u,r=this;for(e in t)(0,C.isNotDeepEqual)(t[e],n[e])&&(u=n[e],r.cTe(t,u,e,i))},D.prototype.YLt=function(t,n,i){var r,e,u,o,r=this,e=[];for(u in r.vIr(),t)(0,C.isNotDeepEqual)(t[u],n[u])&&(o=n[u],e.push(u),r.hRt(i,u,o,t[u]));r.tFt(O,!0,e,O)},D.prototype.updateItem=function(t,n,i,r,e){var e,u,o,e,e,s,i,c,r,f,a,i,u,o,e=null!=e?e:{},u=e.hasAddNewRowData,o=e.currentModelIndex,e=e.isModelIndex,e=void 0!==e&&e,s=this,i=s.GLt(i,r),c=i.success,r=i.fail,f=u?o:e?t:s.HTr()?s.sIr(t):s.RJ(t),a=this.getRowData(f,!0),i={},u=s.fTe(n,f,a,i),o={type:_.ViewChangeType.Update,modelIndex:f,oldData:L(a,n)};if(this.oRe.FEe(o),!(0,C.isBoolean)(u))return s.VLt(n,a,f),s.gLt.updateItem(f,I(n,i),function(t){s.YLt(n,a,f),c(t)},r);u?c({index:f,data:n,originalData:a,changingFields:R(n,a)}):r()},D.prototype.lTe=function(t,n,i){var r,e,u,o,s,c,f,a,h;for(i=i||this.getRowData(t,!0),r=(0,C.clone)(i,!0),e=Object.keys(n),o=0,s=u=this.yLt;o<s.length;o++)(f=(c=s[o]).value)instanceof Function&&!(0,C.isUndefined)(n[f.name])&&-1<e.indexOf(f.name)&&f(r,n[f.name]);for(a in r)r.hasOwnProperty(a)&&(h=r[a],(0,C.isNotDeepEqual)(h,i[a]))&&(n[a]=h)},D.prototype.sTe=function(t,r){var n,e,i,u,n=this,e=this.yLt,i=function(n){var t,i;r.hasOwnProperty(n)&&(t=r[n],(0,C.isUndefined)(t)||T(i=e.find(function(t){return t.value===n}),r))};for(u in r)i(u);return n.lTe(t,r),r},D.prototype.resetItem=function(t,n,i){var r=this,n=r.GLt(n,i),e=n.success,i=n.fail,u=r.RJ(t),o=this.getRowData(u,!0),s=r.bPt(u);if(!(0,C.isNullOrUndefined)(t)&&!(0,C.isNullOrUndefined)(u))return this.oRe.FEe({type:_.ViewChangeType.Update,modelIndex:u,oldData:o}),r.uTe(s,o,u),r.gLt.resetItem(u,function(t){r.ZLt(u,o,s),e(t)},i);i()},D.prototype.ZLt=function(t,n,i){var r=this;r.vLt(t),r.pRt(t,n,i),r.tFt(O,!0,O,O)},D.prototype.saveItem=function(t,n,i){var r=this,n=r.GLt(n,i),e=n.success,i=n.fail,n=r.RJ(t);return r.gLt.saveItem(n,function(t){e(t)},i)},D.prototype.getRowData=function(t,n,i,r,e,u){var o,n,o=this,n=n?t:o.HTr()?o.sIr(t):o.RJ(t);return o.nFt(n,i,r,e,u)},D.prototype.bIr=function(){for(var t,n,i,r,e,u,o,s,t=this,n=[],i=t.yLt,r=t.Efe.length,e=i.length,u=0;u<r;u++){for(o=[],s=0;s<e;s++)o.push(t.Lgr(u,t.Efe[u],i[s]));n.push(o)}return n},D.prototype.wIr=function(t){for(var n,i,r,e,u,o,n=this,i=[],r,e=n.yLt[t],u=n.Efe.length,o=0;o<u;o++)i.push(n.Lgr(o,n.Efe[o],e));return i},D.prototype.rGr=function(t,n){var i,t,t,r,i,i=this,t=i.$Ge(t);t&&(t=t.value,i=(r=i.lLt).getFieldByName(t))&&i.setValues(n)},D.prototype.Nve=function(t,n){var i=this;return j(i.gLt,t,i.RJ(t),n,i.lLt)},D.prototype.ZTr=function(t,n){var i=this;return j(i.gLt,t,i.sIr(t),i.$Ge(n),i.lLt)},D.prototype.Lgr=function(t,n,i){var r=this;return j(r.gLt,t,n,i,r.lLt)},D.prototype.yPt=function(t){return this.isHierarchy()&&this.wPt(t)},D.prototype.wPt=function(t,n){var i=this,r=i.gLt.uBt(),e,r=i.isHierarchy()||!(0,C.isNullOrUndefined)(r),u=(0,C.isNullOrUndefined)(i.MFt),t=!(0<i.lFt.length)||i.lFt.length<t&&(!(0,C.isNumber)(n)||i.lFt.length<n);return r&&u&&t},D.prototype.MPt=function(){var t=this;return!!(0,C.isNullOrUndefined)(t.kLt)||!!t.kLt[0].ascending},D.prototype.CPt=function(t,n){var i,r,e,u,i=this,e=i.getHierarchyNode(t).parent;if(n){for(u=t+1;u<i.visibleLength();u++)if(i.getHierarchyNode(u).parent===e){r=u;break}}else for(u=t-1;0<=u;u--)if(i.getHierarchyNode(u).parent===e){r=u;break}return r},D.prototype.m7t=function(t,n){var i,r,e,u,u,o,s,c,f,a,h,r,r,i=this;if(t!==n&&i.wPt(t,n)){if(u=(e=t<n)?n+1:n-1,(r=i.isHierarchy())&&1===Math.abs(t-n)&&(n=i.CPt(t,e)),u=i.gLt.m7t(e,i.RJ(t),i.RJ(n),i.RJ(u))){if(o=i.iRt,c=1,f=[s=i.RJ(t)],r)for(f=[],h=(a=t)+(c=i.gLt.V7t(s));a<h;a++)f.push(i.RJ(a));e?(r=i.gLt.V7t(i.RJ(n)),o.splice.apply(o,y([n+r,0],f,!1)),o.splice(t,c)):(o.splice(t,c),o.splice.apply(o,y([n,0],f,!1))),i.wFt=O,r=o.indexOf(s),this.oRe.FEe({type:_.ViewChangeType.MovedUpdateOrDown,moveIndex:r,destIndex:r+(e?-1:1)})}return u}},D.prototype.moveUp=function(t){var n,i=1;0<t&&this.m7t(t,t-1)},D.prototype.moveDown=function(t){var n=this,i=1;t<n.visibleLength()-1&&n.m7t(t,t+1)},D.prototype.SPt=function(t){for(var n,i,r,e,u,o,s,c,f,f,n,n=this,i=n.gLt._dataSource.options.schema.hierarchy.outlineColumn,r=n.gLt._dataSource.options.schema.columns||{},e=n.yLt,u=-1,o=-1,s=0;s<e.length;s++){if(c=e[s],!(0,C.isNullOrEmpty)(c.outlineColumn)){u=s;break}-1!==o||(f=r[c.value])&&(!0===(f=f.outlineColumn)||(0,C.isObjectWithKey)(f))&&(i=f,o=s),-1!==o||c.value!==i&&((0,C.isNullOrUndefined)(i)||c.value!==i.value)||(o=s)}return n=-1!==u?{index:u,options:e[u].outlineColumn}:{index:o,options:i},t&&(n.index=this.BPt(n.index)),n},D.prototype.getHierarchyColumnOptions=function(){return this.SPt().options},D.prototype.getHierarchyColumnIndex=function(t){return this.SPt(t).index},D.prototype.hasHierarchyColumn=function(t){var n=this,i=n.isHierarchy(),r=i&&n.getHierarchyColumnIndex();return(0,C.isNumber)(t)?i&&r===n.uPt(t):!(!i||-1===r)},D.prototype.lGe=function(t,n){return this.gLt.lGe(this.ife(t),n)},D.prototype.isHierarchy=function(){return this.gLt.CEt()},D.prototype.getHierarchyNode=function(t,n){var i,n,i=this;if(i.isHierarchy())return n=n?t:i.RJ(t),i.gLt.SEt(n)},D.prototype.getHierarchyRootNode=function(){var t=this;if(t.isHierarchy())return t.gLt.f7t()},D.prototype.promoteHierarchyLevel=function(t){var n,i,r,t,n;this.isHierarchy()&&(i=this.EEe(),r=this.uRe(),this.gLt.M7t(this.RJ(t)),t=r(),this.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:i}),this.oRe.FEe({type:_.ViewChangeType.RowDataChanged,oldData:t}))},D.prototype.EEe=function(){return this.gLt.EEe()},D.prototype.uRe=function(){var h,l,r,v,d,p,e,u,t,n,h=this,l=[],r={},v=y([],this.iRt,!0),d=this.HTr(),p=d?this.Efe.slice():[],e=function(t,n,i){var r,e,u,o,s,n,c,f,a,r=n.action,e=n.index,u=n.oldItems,o=n.items,s=n.modelIndex,n=n.hierarchyNodeInfo,c,f=h.gLt.name===i?v.indexOf(s):s,a=d?p.indexOf(s):-1;l.push({rowIndex:f,baseRowIndex:a,oldItems:u,items:o,action:r,livingIndex:e,hierarchyNodeInfo:n,tableName:i,modelIndex:s})},u=this.gLt.QOt.tables,t=function(t){var i;u.hasOwnProperty(t)&&(i=u[t],r[i.name]=function(t,n){e(t,n,i.name)},i.bind(s.ONCHANGE,r[i.name]))};for(n in u)t(n);return function(){var t,n;for(t in u)u.hasOwnProperty(t)&&(n=u[t])&&r[n.name]&&n.unbind(s.ONCHANGE,r[n.name]);return l}},D.prototype.WEe=function(t){this.gLt.REe(t),this.tFt(void 0,!1)},D.prototype.QEe=function(t){var h,l,v,d,p,w,t,h=this,l=this,v=this.isHierarchy(),d=l.HTr(),p=[],w={};y([],t,!0).reverse().forEach(function(i){var r,n,t,e,u,o,s,c,f,a,r=i.rowIndex,n=i.action,t=i.oldItems,e=i.items,u=i.livingIndex,o=i.hierarchyNodeInfo,s=i.tableName,c=h.gLt.QOt.tables[s];"update"===n?(f=h.iRt[r],t.forEach(function(t){c.I7t({action:n,index:f,item:t,x7t:!0,N7t:!1})})):"delete"===n&&(a=c===h.gLt,e.forEach(function(t,n){a?h.sRe(t,r+n,u+n,o,i.modelIndex):h.xRe(t,r+n,u+n,o,c)}),w[s]||(p.push(c),w[s]=!0),a)&&!v&&d&&((0,C.fixInsertIndexes)(l.iRt,i.modelIndex),(0,C.fixInsertIndexes)(l.Efe,i.modelIndex))}),!v&&d&&((t=t.slice()).sort(function(t,n){return t.rowIndex-n.rowIndex}),t.forEach(function(t){return l.iRt.splice(t.rowIndex,0,t.modelIndex)}),l.Efe)&&(t.sort(function(t,n){return t.baseRowIndex-n.baseRowIndex}),t.forEach(function(t){return l.Efe.splice(t.baseRowIndex,0,t.modelIndex)})),this.NRe(p)},D.prototype.NRe=function(t){0<t.length&&(t.forEach(function(t){t.dl()}),this.hLt())},D.prototype.xRe=function(t,n,i,r,e){var u,o,u,o;e.X7t()&&e.BEe(i)?e.recoverItemAtBatch(i,t):e.insertItem(n,t,null,null)},D.prototype.sRe=function(t,n,i,r,e){var u,o,u,o;this.gLt.X7t()&&this.gLt.BEe(i)?this.aRe(i,t,null,null):this.mIr(n,t,null,null,r,!1,e,!0)},D.prototype.demoteHierarchyLevel=function(t,n){var i,r,e,i,i=this;i.isHierarchy()&&(r=this.EEe(),e=this.uRe(),i.gLt.S7t(i.RJ(t),n),i=e(),this.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:r}),this.oRe.FEe({type:_.ViewChangeType.RowDataChanged,oldData:i}))},D.prototype.hasRowOrder=function(){var t;return!(0,C.isNullOrUndefined)(this.gLt.uBt())},D.prototype.hasHierarchyRowOrder=function(){return this.gLt.qX()},D.prototype.addHierarchyItemBefore=function(t,n,i,r,e,u){var o,s,e,o=this;o.yPt(t)&&(s=this.EEe(),e=o.gLt.O7t(o.RJ(t),n,e),o.APt(n,e),o.mPt(t,n,i,r,u),this.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:s}))},D.prototype.addHierarchyItemAfter=function(t,n,i,r,e,u){var o,s,c,e,o=this;if(o.yPt(t))return s=this.EEe(),c=o.gLt.V7t(o.RJ(t)),e=o.gLt.L7t(o.RJ(t),n,e),o.APt(n,e),o.mPt(t+c,n,i,r,u),this.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:s}),c},D.prototype.addHierarchyItemAbove=function(t,n,i,r){var e,u,o,e=this;e.yPt(t)&&(u=this.EEe(),o=e.gLt.F7t(e.RJ(t),n),e.APt(n,o),e.mPt(t,n,i,r),this.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:u}))},D.prototype.addHierarchyItemBelow=function(t,n,i,r){var e,u,o,s,e=this;if(e.yPt(t))return u=this.EEe(),o=e.gLt.V7t(e.RJ(t)),s=e.gLt.G7t(e.RJ(t),n),e.APt(n,s),e.mPt(t+o,n,i,r),this.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:u}),o},D.prototype.addHierarchyFirstItem=function(t,n,i,r,e){var u,r,u=this,r=u.gLt.oge(t,r);u.APt(t,r),u.mPt(0,t,n,i,e)},D.prototype.APt=function(t,n){var i,r,e,i,r=this.gLt.H7t(n);if(!(0,C.isNullOrUndefined)(r))for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e])},D.prototype.h7t=function(t,n){if(this.isHierarchy())return this.gLt.h7t(t,n)},D.prototype.fetch=function(n){var i,r,t,t,i=this,r=i.gLt.QOt.tables,t=i.gLt.F_e();if(0<t.length)return t=t.map(function(t){var t=r[t];return t&&t.fetch(n)}),Promise.all(t).then(function(t){return i.fUr(n),t})},D.prototype.fUr=function(t){var n,t,n=this;n.vIr(),n.dde||n.JLt(),n.pLt()&&(n.RFt(),n.cPt()),!t&&n.dde||(n.cPt(),n.dde||n.mde(),n.Whe(),n.gLt.fme())||n.tFt(),n.dPt||n.hPt(),((t=n).dp||t.vp)&&(t.dp&&t.dp(),t.vp)&&t.vp(),n.dde=!0},D.prototype.iM=function(t,n){var i=this;i.Wce(),i.cFt(),i.vIr(),t&&(i.HTr()&&(i.Efe=O,!i.iRt||0!==i.iRt.length&&i.iRt.length===i.length()||i.Dit()||(i.iRt=O)),i.gFt()),i.hLt(),i.lLt&&n&&i.RFt(i.ILt.map(function(t){return f({},t)})),n&&i.cPt(),i.tFt(O,!0,O,n),n&&i.NAr&&i.NAr()},D.prototype.hPt=function(){for(var t,n,i,r,e,u,t,n=0,i=this.yLt;n<i.length;n++)(r=i[n]).cross||(e=r.lookup,(0,C.isArray)(e)?"string"==typeof r.value&&-1===r.value.indexOf(".")&&0<(e=(0,C.getUniqueArray)(e)).length&&((u=(u=r.style)||(r.style={})).cellType||(u.cellType={type:"combobox",items:e})):(0,C.isString)(e)&&e?this.IPt(r,e):(0,C.isObject)(e)&&this.IPt(r,e.name,e.columns))},D.prototype.IPt=function(t,n,i){var r,t,e,r,u,r,u,n,r,r=t.style,t=(t=(r=r||(t.style={})).cellButtons)||(r.cellButtons=[]),e=(e=r.dropDowns)||(r.dropDowns=[]),r=(0,p.array_find)(t,function(t){return"openMultiColumn"===t.command}),u=(0,p.array_find)(e,function(t){return"multiColumn"===t.type});r||u||(u=(r=this.xPt(n)).table,n=r.field,u&&n&&u!==this.gLt&&(r=u.columns)&&(t.push({imageType:"ellipsis",command:"openMultiColumn",useButtonStyle:!0}),e.push({type:"multiColumn",option:{dataSource:u.views[o.DEFAULT_VIEW_NAME]||u.addView(o.DEFAULT_VIEW_NAME),bindingInfos:this.NPt(r,i),valuePath:n}})))},D.prototype.xPt=function(t){for(var n,i,r,e,u,o,r,e=0,u=this.gLt.QOt.relationships;e<u.length;e++)if((o=u[e]).sourceRelationshipName===t){n=o.targetTable,i=o.targetFieldName;break}return{table:n,field:i}},D.prototype.NPt=function(n,t){return t?t.map(function(t){return(0,C.isString)(t)?{name:t,width:"*"}:{name:t.value,width:(0,C.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}}):Object.keys(n).map(function(t){var t=n[t];return{name:t.value,width:(0,C.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}})},D.prototype.oV=function(){for(var t,n,i,r,t=this,n=t.gLt.length(),i=[],r=0;r<n;r++)i.push(t.nFt(r));return i},D.prototype.ULt=function(t){for(var n,i,r,e,u,e,n,i=0,r=this.yLt;i<r.length;i++)"string"==typeof(u=(e=r[i]).value)&&(T(e,t),t.hasOwnProperty(u))&&(e=this.gLt.bEt(u))&&e.relatedTable&&e.setValue&&e.setValue(t)},D.prototype.kPt=function(t,n,i){var r,e,u,o,s,r=this.lFt;if(r&&0<r.length)if(i&&0<i.length)for(e=0,u=i;e<u.length;e++)o=u[e],this.kPt(o,1);else{for(s=0;s<n;s++)-1<(o=r.indexOf(t+s))&&r.splice(o,1);for(s=0;s<r.length;s++)r[s]>t&&(r[s]-=n)}},D.prototype.removeItem=function(t,n,i,r){this.yIr(t,n,i,r)},D.prototype.removeRowData=function(t,n,i,r){this.yIr(t,n,i,r)},D.prototype.yIr=function(t,n,i,r){var e=this;e.HTr()&&(t=e.gIr(t)),this.MIr(t,n,i,r)},D.prototype.MIr=function(e,u,t,n){var o,t,s,n,t,c,f,a,h,l,v,d,p,o=this,t=o.GLt(t,n),s=t.success,n=t.fail,t=o.gLt,c=o.RJ(e),f=o.isHierarchy();u=null!=u?u:1,l=[],(0,C.isNullOrUndefined)(e)||(0,C.isNullOrUndefined)(c)||(0,C.isNullOrUndefined)(u)?n():(f&&(a=this.EEe()),v=!1,h=this.uRe(),d=y([],this.lFt,!0),p=o.iRt.slice(e,e+u),t.removeItems(p,function(t){var n,i,r,n=t.removedCount,i=t.removingIndexes;o.WLt(c,n||u,i||p,e),h&&(r=h()).forEach(function(t,n){l[n]=t}),v||(v=!0,f&&o.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:a}),f||o.oRe.FEe({type:_.ViewChangeType.PinnedRows,oldData:{pinnedRows:d}}),o.oRe.FEe({type:_.ViewChangeType.RowDataChanged,oldData:l})),s(t)},n),v||(v=!0,f&&this.oRe.FEe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:a}),f||this.oRe.FEe({type:_.ViewChangeType.PinnedRows,oldData:{pinnedRows:d}}),this.oRe.FEe({type:_.ViewChangeType.RowDataChanged,oldData:l})))},D.prototype.removeItems=function(t,n,i){var r,e,r=this,e;return r.HTr()&&(t=t.map(function(t){return r.gIr(t)})),r.XAr(t,n,i)},D.prototype.XAr=function(t,n,i){var o,s,n,r,e,c,f,a,i,o=this,s=this,n=s.GLt(n,i),r=n.success,e=n.fail,c=s.gLt,f=[],a=0,i=t.map(function(u){return function(i,t){var n,r,e,n=1;o.isHierarchy()&&(n+=(r=o.getHierarchyNode(u)).getChildrenCount()),e=s.RJ(u),c.remove(e,n,function(t){var n=t.removedCount||1;s.WLt(e,t.removedCount||1,O,u),f.push({index:e,count:n}),a+=n,s.rebuildFieldGetter(),i()},t)}});return(0,C.promiseSerialExecute)(i).then(function(t){t.removedItems=f,t.totalRemovedCount=a,r&&r(t)}).catch(function(t){e&&e(t)})},D.prototype.WLt=function(t,n,i,r){var e,u,o,s,e=this;e.kPt(t,n,i),u=(0,C.isNumber)(r),(s=e.HTr())&&(o=i||e.iRt.slice(r,r+n),e.CIr(r,n,o,s)),e.mFt()||e.lme()&&!e.Dit()||(u?(o=o||e.iRt.slice(r,r+n),(0,C.removeIndexes)(e.iRt,o),e.iRt.splice(r,n)):(0,C.removeIndexes)(e.iRt,o||i||[t],!0)),e.vIr(),e.dLt(t,n,i),e.MRt(t,n,i),e.HQe(t,n,i),e.tFt(void 0,!0)},D.prototype.CIr=function(t,n,i,r){var e=this;(r===O?e.HTr():r)&&(i=i||e.iRt.slice(t,t+n),(0,C.removeIndexes)(e.Efe,i,!0))},D.prototype.getChanges=function(){for(var t,n,i,r,e,t,n=this.gLt.getChanges(),i=0,r=n;i<r.length;i++)e=r[i],(0,C.isNullOrUndefined)(e.index)||(e.index=this.FLt(e.index));return n},D.prototype.isDataLengthChanged=function(){return this.gLt.isDataLengthChanged()},D.prototype.submitChanges=function(r,e){var u=this,t=u.GLt(),n=t.success,t=t.fail,i;return u.gLt.submitChanges(function(t,n,i){var t;i===s.DELETE&&(u.Wce(),u.cFt(),u.gFt(),u.hLt(),u.tFt(O,!0)),r&&(t=u.FLt(t),r(t,n,i))},function(t,n,i){e&&e(t,n,i)}).then(function(t){return u.QLt(),n(),t}).catch(t)},D.prototype.QLt=function(){},D.prototype.cancelChanges=function(){var t,n,i,n,r,e,t=this,n=t.GLt(),i=n.success,n=n.fail,r=t.isDataLengthChanged(),e=t.gLt.NGe();t.gLt.cancelChanges(function(){t.kGe(e),t.KLt(r),i()},n)},D.prototype.KLt=function(t){this.iM(t)},D.prototype.NGe=function(){return this.gLt.NGe()},D.prototype.kGe=function(t){var n=this;this.gLt._Ge(t,function(t){n.removeColumn(t.column.name||t.column.value)},function(t){n.xGe(t.column.name||t.column.value,t.originalColumn)},function(t){n.addColumn(t.originalColumn)})},D.prototype.DPt=function(t,n){var i,r,e,t,u,i=this,r=i.TLt(t,n);if(this.oRe.FEe({type:_.ViewChangeType.MoveColumnOptions,from:t,to:n}),e=i.ILt.map(function(t,n){return{index:n,option:t}}),t=i._Pt(t,n),e=t.map(function(t){return e[t]}),i.ILt=e.map(function(t){return t.option}),r)return!0;u=[],e.forEach(function(t,n){(0,C.isNullOrUndefined)(t.option.cross)||t.index===n||u.push({oldIndex:t.index,newIndex:n})}),i.wLt(u,!1)},D.prototype.EPt=function(){var i,t,r,i=this,t=i.CLt;return t&&0<t.length?(r=[],t.forEach(function(t,n){r.push(i.yLt[t].value)}),r):[]},D.prototype.jPt=function(t){var n,i=this.yLt;return(0,C.isNullOrUndefined)(t)?[]:t.map(function(n){return(0,C.findIndex)(i,function(t){return t.value===n})})},D.prototype.OPt=function(t,n,i){var r,e,t,n,u,o,s,c,f,a,a,h,l,r=this;if(r.yLt.forEach(function(t,n){t.RPt=n}),e=r.oPt,this.oRe.FEe({type:_.ViewChangeType.MoveColumnInfos,from:t,to:n,count:i}),t=(0,p.ePt)(t,n,i,r.yLt,r.oPt,r.CLt,r.ILt),n=r.CLt.map(function(t){return r.yLt[t]}),r.yLt=t.map(function(t){return r.yLt[t]}),n&&n.length){for(u=[],o=r.yLt.length,s=-1,c=0,f=n;c<f.length;c++)a=f[c],a=r.yLt.indexOf(a),s=Math.max(a,s),u.push(a);for(h=0;h<o;h++)-1===u.indexOf(h)&&u.push(h);r.oPt=u,r.CLt=u.slice(0,n.length)}return l=r.yLt.reduce(function(t,n,i){return n.RPt!==i&&t.push({oldIndex:n.RPt,newIndex:i}),delete n.RPt,t},[]),r.yLt.forEach(function(t){for(var n,i,r,e,r,n=0,i=l;n<i.length;n++)if(e=(r=i[n]).oldIndex,r=r.newIndex,t._Ft===e){t._Ft=r;break}}),r.lLt&&r.lLt.moveFieldsByIndexes(l),l.map(function(t){return t.oldIndex=r.BPt(t.oldIndex,e),t.newIndex=r.BPt(t.newIndex),t})},D.prototype.SLt=function(t){var n,i,n,r,n=this,i=n.yLt,n=n.ILt,r=i[t];return r.isCross?r.RBt:(0,C.findIndex)(n,function(t){return t.value===r.value})},D.prototype.ALt=function(t){var n=this,i=n.CLt,r=n.ILt;return t=t||i.map(function(t){return n.SLt(t)}),(0,p.generatePinnedColumnIndexMap)(t,r.length)},D.prototype._Pt=function(t,n){var i,r,e,u,r,r,o;if(t!==n)return r=(i=this).CLt,e=i.ILt.map(function(t,n){return{index:n}}),u=r.map(function(t){return i.SLt(t)}),0<(r=(0,p.generatePinnedColumnIndexMap)(u,e.length)).length&&(t=r[t],n=r[n]),r=u.map(function(t){var t=e[t];return t.LPt=!0,t}),(0,C.swapArrayItems)(e,t,n,1),o=e.filter(function(t){return!t.LPt}),r.forEach(function(t,n){o.splice(u[n],0,t)}),o.map(function(t){return t.index})},D.prototype.getColumnInfos=function(i,r,e,u){for(var o,s,c,f,t,a,n,o=[],s=this.yLt,c=this.oPt,f=this.gLt,t=function(t){var t,n,t,t=!(0<c.length)||e||(0,C.isNullOrUndefined)(c[t])?t:c[t],n=s[t];if(!u&&f.jOt(n.value)&&(n.isPrimaryKey=!0),!i||!n.isGroup){if(r&&n.isCross&&(t=n.RBt,(n=a.ILt[t]).RBt=t,o.some(function(t){return t===n})))return"continue";o.push(n)}},a=this,n=0;n<s.length;n++)t(n);return o},D.prototype.ucr=function(t,n){var t=(0,C.isFormula)(t)?this.Ywt(t):t;return t?(0,r.getFieldNamesFrom)(t,n):[]},D.prototype.Nfr=function(t,n){var i,r,i=(0,C.isFormula)(t)?t:this.gLt.uke(t)?this.gLt.UAe(t):w;return(0,C.isString)(n)?r=function(t){return t===n}:(0,C.isFunction)(n)&&(r=n),i?this.gLt.d0r(i,r):r(t)},D.prototype.ife=function(t){var n=this;return(0,p.getColumnName)((0,C.isNumber)(t)?n.kve(t):t)},D.prototype.FPt=function(t,n){var i=this.gLt.qRt(t);return!((0,C.isNullOrUndefined)(i)||(!n||!(0,C.isRelation)(t))&&i===this.gLt)},D.prototype.setColumnInfos=function(t,n,i){for(var r,e,u,o,s,r={},e=0;e<this.yLt.length;e++)"string"==typeof(u=this.yLt[e]).value&&u.value===u.name&&(r[u.value]=!0);for(o=0;o<t.length;o++)"string"!=typeof(s=t[o]).value||r[s.value]||this.bde(s);this.dde&&(this.yLt=t,this.Whe()),i&&(this.ILt=(0,C.clone)(t).map(function(t){return"string"==typeof t?{value:t}:t})),this.yLt=t,this.HTr()&&this.uIr()&&this.RFt(),this.PPt(),this.Gfe(),n&&this.cPt()},D.prototype.Gfe=function(){for(var t,n,i,r,e,u,o,t=this.ILt,n=0;n<t.length;n++)if(!(i=t[n]).cross)for(r=this.yLt,e=0;e<r.length;e++)if(u=r[e],i.value===u.value){for(o in u)u.hasOwnProperty(o)&&"_"!==o.charAt(0)&&(i[o]=u[o]);break}},D.prototype.PPt=function(){for(var t,n,i,r,e,u,o,s,t=this.ILt,n=t.length-1;0<=n;n--)"string"==typeof(i=t[n].value)&&"="===i[0]&&t.splice(n,1);for(r=this.yLt,e=n=0;n<r.length;)u=r[n],o=t[e],u.isGroup||u.isCross?n++:o&&o.cross?e++:(s=u.value)===(i=o&&o.value)?(n++,e++):"string"!=typeof s||"="!==s[0]&&"formula"!==u.dataType?n++:(s!==u.name&&this.fBe(u.name,s),t.splice(e,0,u),n++,e++)},D.prototype.GPt=function(t){var n;return!!this.gLt.ZRt(t)},D.prototype.Vfe=function(t,n){var i,r,e,u,o,s,c,f,a,h,l,v,i=this,r=i.NLt;if(i.mFt())i.Wce(),i.filter();else{for(o in e=i.iRt,u=i.Jce)if(u.hasOwnProperty(o)){for(c=(s=u[o]).options,f=s.count,delete s.options,delete s.count,a=0;a<t.length;a++)h=t[a],(0,C.isNullOrUndefined)(s[h])||(delete s[h],f--);if(0<n.length)for(i.iRt=n,i.filter(c),l=0;l<i.iRt.length;l++)s[v=i.iRt[l]]=!0,f++;s.options=c,s.count=f}i.Jce=u,i.iRt=e}i.NLt=r},D.prototype.togglePinnedRows=function(t){var n,i,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,j;if((0,C.isNullOrUndefined)(t)||this.hasHierarchyColumn())return this.lFt&&this.lFt.length;for(n=y([],this.lFt,!0),i=this.lFt,r=this.iRt,e=t.length,u=[],o=[],s=[],c=i.length,f=0;f<e;f++)-1<(a=r[t[f]])&&(-1<(h=i.indexOf(a))?(o.push(h),s):u).push(a);if(i.length-(v=o.length)+(l=u.length)>this.rPt)return-1;if(0<v)for(o.sort(),f=v-1;0<=f;f--)i.splice(o[f],1);for(f=0;f<l;f++)i.push(u[f]);if(0<v||0<l){for(d=[],p=r.length,0<(w=i.length)&&(d=i.slice(0)),a=w,f=0;f<p;f++)-1===i.indexOf(r[f])&&(d[a]=r[f],a++);if(!this.mFt()&&!this.tPt())for(f=0;f<v;f++)b=r[o[f]],m=d.indexOf(b),j=this.UPt(b,c,d),d.splice(m,1),d.splice(j=m<j?j-1:j,0,b),w<c&&c--;this.iRt=d,this.Vfe(u,s),this.vFt(),this.hde(O,0<v),this.NFt()}return this.oRe.FEe({type:_.ViewChangeType.PinnedRows,oldData:{pinnedRows:n}}),i.length},D.prototype.$Ee=function(){for(var t,n,i,t=this.lFt.length,n=[],i=0;i<t;i++)n.push(i);this.togglePinnedRows(n)},D.prototype.togglePinnedColumns=function(t,n){var i,t,i=y([],this.CLt,!0),t=this.ZGe(t,n);return this.oRe.FEe({type:_.ViewChangeType.PinnedColumns,oldData:{pinnedColumns:i}}),t},D.prototype.ZGe=function(t,n){var i,r,e,u,o,s,c,f,a,h,l,v,d,i=this;if((0,C.isNullOrUndefined)(t))return this.CLt&&this.CLt.length;for(r=this.oPt,e=0<r.length,t=t.filter(function(t){var t=e?r[t]:t;return!i.yLt[t].isCross}),u=this.CLt,o=t.length,s=[],c=[],f=0;f<o;f++)-1<(a=e?r[t[f]]:t[f])&&(-1<(h=u.indexOf(a))?c.push(h):s.push(a));if(u.length-(v=c.length)+(l=s.length)>this.rPt)return-1;if(d=[],0<v)for(c.sort(),f=v-1;0<=f;f--)d.push(u.splice(c[f],1));for(f=0;f<l;f++)u.push(s[f]);return n&&(u=u.map(function(t){for(var n,i,r,n=0,i=d;n<i.length;n++)(r=i[n])<t&&--t;return t})),(0<l||0<v)&&(this.oPt=(0,p.generatePinnedColumnIndexMap)(u,this.yLt.length-(n?v:0))),u.length},D.prototype.eRe=function(){for(var t,n,i,t=this.CLt.length,n=[],i=0;i<t;i++)n.push(i);this.togglePinnedColumns(n)},D.prototype.uPt=function(t){var n,i=this.oPt;return i&&0<i.length?i[t]:t},D.prototype.BPt=function(t,n){var i;return(n=n||this.oPt)&&0<n.length?n.indexOf(+t):+t},D.prototype.getRowDataAsync=function(i){var r=this;return r.fetch().then(function(t){var n=r.RJ(i);return r.nFt(n)})},D.prototype.UPt=function(t,n,i){for(var r=n;r<i.length;r++)if(i[r]>t)return r;return i.length},D.prototype.nFt=function(t,n,i,r,e){var u=this;return S(u.gLt,u.yLt,u.BFt,u.lLt,u.MFt,t,n,i,r,e)},D.prototype.rebuildFieldGetter=function(){var i,t,i=this.gLt;i&&(t=this.yLt).forEach(function(t,n){var t=t.value;"string"==typeof t&&i.rRt(t)})},D.prototype.ufe=function(t,n){return F(this.gLt,t,n)},D.prototype.cRe=function(t){var n,n;return null==(n=null==(n=this.gLt)?void 0:n.columns)?void 0:n[t]},D.prototype.updateColumnDataType=function(t,n){var i,i,i,r,i,i,e,r=this.cRe(t);r&&((i=null==(i=null==(i=null==(i=this.gLt)?void 0:i.options)?void 0:i.schema)?void 0:i.columns)&&(i[t]?i[t].dataType=n:i[t]={dataType:n}),i=r.dataType,e=(0,C.clone)(this.gLt.jEe(r.name)),this.oRe.FEe({type:_.ViewChangeType.TableSheetColumnDataTypeChanged,oldData:{columnValue:t,oldDataType:i,oldData:e}}),r.dataType=n)},D.prototype.KEe=function(t,n){var t=this.cRe(t);t&&this.gLt.OEe(t.name,n)},D.prototype.updateColumnIsPrimaryKeyType=function(t,n){var i,i,i,r,i,r=this.cRe(t);r&&((i=null==(i=null==(i=null==(i=this.gLt)?void 0:i.options)?void 0:i.schema)?void 0:i.columns)&&(i[t]?i[t].isPrimaryKey=n:i[t]={isPrimaryKey:n}),this.oRe.FEe({type:_.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged,oldData:{columnValue:t,oldIsPrimaryKey:r.isPrimaryKey}}),r.isPrimaryKey=n)},D.prototype.bPt=function(s){var c,t,f,a,h,l,n,i,r,c=this,t=c.yLt,f={},a=[],h=!!c.MFt,l=c.gLt;if(t.forEach(function(t,n){var i,r,e,u,o,i=t.value;t.isCross?f[t.value]=c.lLt.getFieldByColumn(t).getOriginalValue(s):i&&!t.isGroup&&("string"==typeof i?(r=0<=i.indexOf("."),e="="===i[0],u=l.XOt&&(0,C.isNullOrUndefined)(l.XOt[i]),(!h||r||e||u)&&(f[i]=N(e?l._getValueByField(i,s):l.XRt(i,s),t))):"function"==typeof i&&a.push({name:i.name,caption:t.caption,value:i}))}),0<a.length&&(n=l.iBt(s),a.forEach(function(t){f[t.name]=t.value(n)})),h)for(r in i=this.lLt.CBt(s))i.hasOwnProperty(r)&&(f[r]=i[r]);return f},D.prototype.DGe=function(){return this.gLt.DGe()},D.prototype.jGe=function(t){return this.gLt.jGe(t)},D.prototype.OGe=function(t){return this.gLt.OGe(t)},D.prototype.addColumn=function(t){this.qFe(t,!0)},D.prototype.qFe=function(t,n,i,r){var e,u,n,u,o,u=!(e=(t=this.QGe(t)).zTr)&&(0,C.isNamedFormulaColumn)(t);(n||u)&&(t=f({},t)),e||(u?(t.value=t.name,delete t.dataType):t.name=(0,p.getColumnName)(t)),n=this.WGe(t),(u=this.lur(i))?u.isCross?(o=this.hur(i,u),this.yLt.splice(o,0,t),this.ILt.splice(u.RBt,0,t)):(i=this.uPt(i),this.yLt.splice(i,0,t),this.ILt.splice(i,0,t)):(this.yLt.push(t),this.ILt.push(t)),this.dur(t),this.oRe.FEe({type:_.ViewChangeType.AddColumn,newData:f({},t)}),n||(this.lLt&&this.lLt.addBaseField(t,r),e||(this.bde(t)&&this.dde&&this.Whe(),this.PPt()),this.Gfe())},D.prototype.lur=function(t){var n,t,n=(0,C.isNumber)(t)&&0<=t&&t<this.yLt.length,t=(n=n&&(!(0<this.CLt.length)||t>=this.CLt.length))&&this.kve(t);if(n&&!t.isGroup)return t},D.prototype.hur=function(t,n){var i,r;if(n=n||this.lur(t)){if(n.isCross)for(i=t-1;0<=i;i--)if(!(r=this.kve(i)).isCross||r.RBt!==n.RBt)return i+1;return t}return this.yLt.length},D.prototype.KGe=function(t,n,i){this.JGe(w,t,w,n,i)},D.prototype.JGe=function(n,i,r,t,e){var u,t,o,e,t,t,u=this,t=u.GLt(t,e),o=t.success,e=t.fail;if(i=f({},u.QGe(i)),t=u.gLt.hasExistedColumn(i),A(i)||t)return t?(t=u.$Ge(u.ife(i),!0,!0,!0),u.qFe(t,!1,n),void u.aUe(t,i,r,o,e)):(r&&r(w),u.qFe(i,!1,n),void o({success:!0,column:f({},i)}));u.gLt.addColumn(i,function(t){r&&r(t),u.qFe(i,!1,n),t.column=f({},i),(t.table||t.source)&&u.oRe.FEe({type:_.ViewChangeType.DefineColumnAddColumn,name:(0,p.getColumnName)(i),table:t.table,source:t.source}),o(t)},e)},D.prototype.WGe=function(n){var t=this,i=t.ILt.some(function(t){return t.value===n.value&&(0,C.isNullOrUndefined)(n.cross)}),t=!i&&t.yLt.some(function(t){return t.value===n.value});return i||t},D.prototype.QGe=function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),"date"===t.dataType&&(0,p.applyDateTimePicker)(t),t},D.prototype.DRe=function(t,n,i,r){i?(this.yLt.splice(t,0,n),r&&this.lLt&&this.lLt.addBaseField(n,this.HTr()&&n.zTr?this.RGr(t):O),this.dur(n),this.bde(n)&&this.dde&&this.Whe(),this.PPt(),this.Gfe(),this.vIr()):this.ILt.splice(t,0,n)},D.prototype.eGe=function(t){this.gLt.eGe(t)},D.prototype.uGe=function(t){this.gLt.uGe(t)},D.prototype.JFe=function(t){this.gLt.JFe(t)},D.prototype.getColumn=function(t){var n=this;return(0,C.isNullOrUndefined)(t)?n.getColumnInfos():n.kve(t,!1)},D.prototype.kve=function(t,n,i){var r=this;if(!(t<0||t>=r.yLt.length))return r.qGe(r.uPt(t),n,i)},D.prototype.qGe=function(t,n,i){var t,i;if(t!==O)return t=this.yLt[t],i&&(i=this.e0r(t))?f(f({},t),i):(this.gLt.jOt(t.value)&&(t.isPrimaryKey=!0),!1===n?f({},t):t)},D.prototype.e0r=function(t){var t,n,t=(0,p.getColumnName)(t),n=this.gLt.jRt(t);if(n)return(0,C.isNullOrUndefined)(n.value)&&(n.value=n.name=t),n},D.prototype.i0r=function(t){var n=t.value;return!(0,C.isNullOrUndefined)(this.$Ge((0,C.isNullOrUndefined)(n)?t:n,!0))},D.prototype.updateColumn=function(t){this.JEe(t)},D.prototype.JEe=function(t,n,i){var r,e,r=this,e;!!t.cross||!1===n?r.fRe(t,i):(r.lRe(t,i),r.PPt(),r.Gfe())},D.prototype.fBe=function(n,t){var i,r,e,i,r,e=this,i=null==(i=this.yLt.filter(function(t){return t.name===n}))?void 0:i[0],r=null==(r=this.ILt.filter(function(t){return t.name===n}))?void 0:r[0];(i||r)&&(i&&(i.name=t),r&&(r.name=t),e.lLt&&e.lLt.renameBaseField(n,t),e.oRe.FEe({type:_.ViewChangeType.UpdateColumnName,oldName:n,newName:t}))},D.prototype.fRe=function(n,t){var i,r,i=this;(t=null!=t?t:i.ILt.findIndex(function(t){return t.name===n.name}))<0||(r=i.ILt[t]?f({},i.ILt[t]):null,i.ILt[t]=n,i.oRe.FEe({type:_.ViewChangeType.UpdateColumn,oldData:r}))},D.prototype.lRe=function(n,t){var i,r,i=this;(t=null!=t?t:this.yLt.findIndex(function(t){return t.name===n.name}))<0||(r=i.yLt[t]?f({},i.yLt[t]):null,i.yLt[t]=n,this.oRe.FEe({type:_.ViewChangeType.UpdateColumn,oldData:r}))},D.prototype.EGr=function(t,n){var i,r,e,r,i=this,r=i.$Ge(t);r&&(e=(0,p.getColumnName)(r),n.formula&&(0,C.isFormula)(r.value)&&(r.value=n.formula),i.lLt)&&i.HTr()&&i.uIr()&&r.zTr&&(r=i.lLt.getFieldByName(e))&&r.mir&&((0,C.isNullOrUndefined)(n.col)&&(n.col=t),r.mir(n))},D.prototype.hRe=function(t){var n,i,r,e,i=this;i.dRe(t),null!=(n=i.xLt)&&n.call(i,t),r=[],(e=i.ILt.map(function(t,n){return{index:n,option:t}})).forEach(function(t,n){(0,C.isNullOrUndefined)(t.option.cross)||r.push({oldIndex:t.index,newIndex:n})}),i.wLt(r)},D.prototype.dRe=function(t){var n,i,r,e,t,r,u,o,s,c,n=this,i={columnInfoOptions:(0,C.clone)(n.ILt),options:(0,C.clone)(n.LEt),columnInfos:(0,C.clone)(n.yLt)},r=n.ILt.map(function(t,n){return{index:n,option:t}}),e=(r.splice(t,1)[0]||{}).option,t=r.map(function(t){return t.option}),r=n.LEt;if(e&&"string"==typeof e.cross){for(u=!1,o=0,s=t;o<s.length;o++)if((c=s[o])&&c.cross===e.cross){u=!0;break}!u&&r.cross&&delete r.cross[e.cross]}this.oRe.FEe({type:_.ViewChangeType.RemoveColumnInfoOptions,oldData:i}),n.ILt=t,n.LEt=r},D.prototype.qEe=function(t,n){var i=this;i.ILt=t,i.LEt=n},D.prototype.$Ge=function(n,t,i,r){var e,u;if((0,C.isNumber)(n))return this.kve(n,t);if((0,C.isString)(n)){if(e=void 0,-1<(u=this.yLt.findIndex(function(t){return(0,p.getColumnName)(t)===n})))e=this.qGe(u,t);else if(i&&(e=this.e0r(n)))return!1===t||r?f({},e):e;return e}return n},D.prototype.lIr=function(n){var t=this.yLt.findIndex(function(t){return(0,p.getColumnName)(t)===n});return this.BPt(t)},D.prototype.UFe=function(t){var n,i,r,e,n=this;return(0,C.isNumber)(t)&&(i=n.uPt(t)),e=function(){var t=n.getHierarchyColumnIndex();return t===i||n.yLt[t]&&n.yLt[t].value===r.value},!(!(r=n.$Ge(t))||!(r.isGroup||r.isCross||n.isHierarchy()&&e()||n.lGe(r,!0)||n.hGe(r)))},D.prototype.Zcr=function(t,n){var i,t,r,i=this,t=i.$Ge(t),r=function(t,n){var t,n,t=(0,C.isFormula)(t.value)||(0,C.isRelation)(t.value)||i.FPt(t.value,!0)||(0,C.isNamedFormulaColumn)(t),n=i.gLt.isDataColumn(n);return t&&n};return!(r(t,n)||r(n,t))},D.prototype.hGe=function(t){return this.gLt.hGe(this.ife(t))},D.prototype.removeColumn=function(t){this.TGe(t)},D.prototype.TGe=function(t,e,n){var u,i,r,o,u=this,i=this.$Ge(t);this.UFe(i)||(r=this.ife(i),this.tUe(i),this.UQe(i),o=this.lLt&&1===this.yLt.filter(function(t){return(0,p.getColumnName)(t)===r}).length&&this.lLt.removeField(r),this.nUe(t,function(t,n,i,r){var i=e?e(n,i,r):i.splice(n,1)[0];u.oRe.FEe({type:_.ViewChangeType.DeleteColumn,index:n,oldData:i,isInfo:r,isField:!!r&&o})}),!1!==n&&this.vIr())},D.prototype.eUe=function(t,n,i){this.iUe(t,w,n,i)},D.prototype.iUe=function(t,n,i,r){var e,i,u,r,o,e=this,i=e.GLt(i,r),u=i.success,r=i.fail,o=e.ife(t);A(o)?(n&&n(w),e.removeColumn(o),u({success:!0})):e.gLt.removeColumn(o,function(t){n&&n(t),e.removeColumn(o),e.oRe.FEe({type:_.ViewChangeType.DefineColumnRemoveColumn,name:o,table:t.table,source:t.source}),u(t)},r)},D.prototype.tUe=function(i){var r,e,u,o,t,n,s,r=this,e=r.CLt;if(e&&0<e.length)for(u=r.yLt,o=u.length,t=function(n){var t=u[n];if(i===t)return r.CLt=e=e.map(function(t){return n<t&&--t,t}),r.oPt=(0,p.generatePinnedColumnIndexMap)(e,o-1),"break"},n=0;n<o&&"break"!==(s=t(n));n++);},D.prototype.dur=function(i){var r,e,u,o,t,n,s,r=this,e=r.CLt;if(e&&0<e.length)for(u=r.yLt,o=u.length,t=function(n){var t=u[n];if(i===t)return r.CLt=e=e.map(function(t){return n<=t&&(t+=1),t}),r.oPt=(0,p.generatePinnedColumnIndexMap)(e,o),"break"},n=0;n<o&&"break"!==(s=t(n));n++);},D.prototype.HGe=function(){var t=this;return{sortBefore:(0,p.removeExtraInfos)(t.DLt),sortAfter:(0,p.removeExtraInfos)(t._Lt),sortInfo:(0,p.removeExtraInfos)(t.kLt)}},D.prototype.xGe=function(t,n,i,r){var e,u,n,o,e=this,u=this.QGe(n),n=e.ife(t);return i&&(u=f({},u)),(0,C.isNamedFormulaColumn)(u)?(u.value=u.name,delete u.name,delete u.dataType):u.name=(0,p.getColumnName)(u),e.rUe(t,u,r),o=u,e.nUe(t,function(t,n,i,r){o=e.oUe(u,t),i.splice(n,1,o),e.oRe.FEe({type:_.ViewChangeType.UpdateColumn,index:n,oldData:f({},t),isInfo:r})}),r&&r.isNameUpdated&&e.fBe(n,(0,p.getColumnName)(o)),e.vIr(),o},D.prototype.uUe=function(t,n,i,r){this.aUe(t,n,w,i,r)},D.prototype.aUe=function(t,n,i,r,e){var u,r,o,e,s,c,r,u=this,r=u.GLt(r,e),o=r.success,e=r.fail;n=u.QGe(n),t=u.$Ge(t),s=n.type!==t.type?f({},n):f(f({},t),n),u.Zcr(t,s)?(c=(0,C.isNamedFormulaColumn)(t)?t.name:u.ife(t),(0,C.isFormula)(c)&&(0,C.isFormula)(s.value)&&!(0,C.isNamedFormulaColumn)(s)||(0,C.isRelation)(c)&&(0,C.isRelation)(s.value)||(0,C.isFormula)(c)&&(0,C.isRelation)(s.value)||(0,C.isRelation)(c)&&(0,C.isFormula)(s.value)?(r=i?{onSucceededBefore:i}:w,n=u.xGe(c,s,!1,r),o(f({success:!0,column:f({},n)},r))):(0,C.isFormula)(c)&&(0,C.isNamedFormulaColumn)(s)?u.KGe(s,function(t){u.TGe(c,function(t,n){return n.splice(t,1,n.pop())[0]}),o(t)},e):u.gLt.updateColumn(c,n,function(t){t.onSucceededBefore=function(t){t.isNameUpdated&&u.lLt&&u.lLt.renameBaseField(c,(0,p.getColumnName)(n)),i&&i(t)},n=u.xGe(c,s,!1,t),t.column=f({},n),u.oRe.FEe({type:_.ViewChangeType.DefineColumnModifyColumn,table:t.table,source:t.source}),o(t)},e)):e()},D.prototype.rUe=function(t,n,i){var r,t,e,u,o,s,r=this,t=r.$Ge(t),e=r.BGe(n,t),u=r.GGe(n,t),o=r.LGe(n,t),s=r.ife(t)!==r.ife(n);s&&r.UQe(t,n),i?(i.isNameUpdated=s,i.isFilterUpdated=e,i.isSortUpdated=u,i.isGroupUpdated=o,i.onSucceededBefore(i)):e?r.tFt(w,w,w,!0):o?r.nPt(w,!0):u&&r.NFt(!0)},D.prototype.nUe=function(t,n){var i,r,e,u,o,i=this.ILt,r=this.yLt;if("number"==typeof t)n(i[t],t,i,!1),n(r[t],t,r,!0);else{for((0,C.isString)(t)||(t=(0,p.getColumnName)(t)),e=0;e<i.length;e++)if(u=i[e],this.sUe(u,t)){n(u,e,i,!1);break}for(e=0;e<r.length;e++)if(o=r[e],this.sUe(o,t)){n(o,e,r,!0);break}}this.PPt(),this.Gfe()},D.prototype.sUe=function(t,n){return t.value===n||t.name===n},D.prototype.oUe=function(t,n){return t.type!==n.type?f({},t):f(f({},n),t)},D.prototype.tFt=function(t,n,i,r){n||this.gFt(t);var n=this.mFt(r);n&&this.dFt(),this.vFt(r),this.nPt(n?O:i,r),this.wFt=O,this.HTr()||(this.Efe=O)},D.prototype.vCn=function(){this.oRe.vCn()},D.prototype.FCn=function(){this.oRe.FCn()},D.prototype.lM=function(){return this.oRe.lM()},D.prototype.LEe=function(){return this.oRe.LEe()},D.prototype.SRe=function(){return this.oRe.SRe()},D.prototype.ARe=function(t){this.oRe.ARe(t)},D.prototype.PEe=function(){this.oRe.PEe()},D.prototype.Mtt=function(t){return this.oRe.Mtt(t)},D.prototype.excludeInsertedPinnedRows=function(){for(var t,n,i,r,t=this,n=t.lFt,i=[],r=0;r<n.length;r++)t.isInserted(r)||i.push(n[r]);return i},D.prototype.toJSON=function(){var i,t,r,n,e,u,i=this,t={};if(i._Lt&&(t={sortBefore:(0,p.removeExtraInfos)(i.DLt),sortAfter:(0,p.removeExtraInfos)(i._Lt)}),0===(r=i.ILt).length)0===i.yLt.length&&i.cPt(),r=i.ILt=i.yLt;else for(n=function(n){var t,t,t,t=r[n].cross;(0,C.isNullOrUndefined)(t)&&(t=i.yLt.filter(function(t){return t.value===r[n].value})[0])&&(r[n]=t),(t=r[n].validator)&&"date"===t.type&&(h(t.value1)&&(t.value1=l(t.value1)),h(t.value2))&&(t.value2=l(t.value2))},e=0;e<r.length;e++)n(e);if(i.HTr()&&i.uIr())for(u=0;u<i.ILt.length;u++)delete i.ILt[u].YEr;return f(f({},t),{name:i.name,options:(0,C.clone)(i.LEt),columns:(0,C.clone)(i.ILt),indexMap:(0,C.cloneArray)(i.iRt),disableAuto:i.dIr,baseIndexMap:i.HTr()?(0,C.cloneArray)(i.Efe):O,columnIndexMap:(0,C.cloneArray)(i.oPt),autoSort:i.autoSort,sortInfo:(0,p.removeExtraInfos)(i.kLt),autoFilter:i.autoFilter,filterInfo:(0,p.removeExtraInfos)(i.NLt),autoGroup:i.autoGroup,groupInfo:(0,C.clone)(i.MFt),detailColumnsVisible:i.UFt,pinnedRows:i.excludeInsertedPinnedRows(),pinnedColumns:(0,C.cloneArray)(i.CLt)})},D.prototype.fromJSON=function(t){var n,i,r,e,u,o,n=this;if(n.iRt=t.indexMap,i=t.columnIndexMap,r=n.yLt,i&&r&&0<i.length&&i.length<r.length)for(e=i.length;e<r.length;e++)i[e]=e;for(e=0;e<r.length;e++)(u=r[e].validator)&&"date"===u.type&&("string"==typeof u.value1&&(o=v(u.value1))&&(u.value1=o),"string"==typeof u.value2)&&(o=v(u.value2))&&(u.value2=o);n.oPt=i,n.Efe=t.baseIndexMap,n.dIr=t.disableAuto,n.autoSort=t.autoSort,n.kLt=t.sortInfo,n.DLt=t.sortInfo,t.sortAfter&&(n.DLt=t.sortBefore,n._Lt=t.sortAfter),n.autoFilter=t.autoFilter,n.NLt=t.filterInfo,n.autoGroup=t.autoGroup,n.MFt=t.groupInfo,n.UFt=t.detailColumnsVisible,n.lFt=t.pinnedRows,n.CLt=t.pinnedColumns},t.View=D},"./dist/src/viewField/fieldManager.js":function(M,t,n){"use strict";var o,a,I,s,E,y,c,F;function f(r,e,u,o){return function(t,n){var n,i,n=r.getField(n),i=u&&!(0,c.isGroupSlice)(n.name)&&n.extra&&n.extra.caption||n.name;return o&&n instanceof y.ColumnDataReaderField||(t[i]=n.getValue(e)),t}}function i(t,n){this._id=0,this.Pq=[],this.Z={},this.groupFieldKeys=[],this.sBt=t,this.cBt={},this.nM=n}function h(t,n){var i,r,e,u,u,o,s,c,f,f,i=[];if(t.function)for(r=0,e=t.arguments;r<e.length;r++)if(14===(u=e[r]).type){if(!n){i.push(u.value.Pq[0]);break}i.push(u.value.Pq[0])}else(u=h(u))&&(i=i.concat(u));else for(o=0,s=Object.getOwnPropertyNames(t);o<s.length;o++)if((f=t[c=s[o]])instanceof a.Expression)if(14===f.type){if(!n){i.push(f.value.Pq[0]);break}i.push(f.value.Pq[0])}else(f=h(f))&&(i=i.concat(f));return i}function r(t,n){for(var n,i,r,e,u,o,s,c,n=n.valueRelation,i=n.split("."),r=t(n),e="",u=!1,o=!1,s=0;s<i.length;s++)c=r[s],(0,I.isNullOrEmpty)(i[s])||(e+=".".concat(i[s])),!o&&c&&"array"===c.type&&c.name===i[s]&&(u=o=!0,e+=".".concat(E.RelationTemplateToken));return{isOneToMany:u,relationTemplate:e.slice(1)}}function l(t,n,i,r){var e,u,e=D(t),u;return{valueRelation:t,valueCaption:n||e,valueIndex:i,valueCrossKey:r}}function x(t){for(var n,i,r,e,u,n=t.columns,i=t.crossKeys,r=t.initialOptionIndex,e=[],u=0;u<n.length;u++)e.push(l(n[u].value,n[u].caption,r+u,i[u]));return e}function A(t,n){return e(t,n,"")}function e(t,n,i){return!(0,I.isNullOrEmpty)(n)&&0<=t.indexOf(n)?e(t=t.replace(n,i),n,i):t}function g(t){var t=t.value;return"string"==typeof t?t:"function"==typeof t?t.name:void 0}function v(t){var t,t="string"==typeof t||(0,I.isNullOrUndefined)(t)?t:"function"==typeof t?t.name:t.value;return(t||"").split(".")}function D(t){var t=v(t);return t[t.length-1]}function P(t){if(!(0,I.isNullOrEmpty)(t.formatter))return t.formatter}function k(t){var t=v(t);return t[t.length-2]}function L(t,n){var t=v(t);return n&&t.splice(t.length-1,0,""),t.slice(0,t.length-1).join(".")}function V(t){return"string"==typeof t?[t]:t||[]}function _(t){for(var n,i,r,e,u,n=0,i={},r=0;r<t.length;r++)e=t[r].caption,(0,I.isArray)(e)?(t[r].caption=e.map(function(t){return null==t?void 0:t.toString()}),i[r]=e.length,n<i[r]&&(n=i[r])):t[r].caption=null==e?void 0:e.toString();for(r in i)if(i[r]<n)for(u=n-i[r],e=t[r].caption;0<u;)e.unshift(),u--;for(r=0;r<t.length;r++)e=t[r].caption,(0,I.isArray)(e)&&1===e.length&&(t[r].caption=e[0])}function d(t,n){var t,t,t,i,t=t.qRt(n);if(!((0,I.isNullOrUndefined)(t)||(t=t._dataSource.options.schema,(0,I.isNullOrUndefined)(t))||(t=t.columns,(0,I.isNullOrUndefined)(t))||(i=t[D(n)],(0,I.isNullOrUndefined)(i))))return i.lookup}function u(t,n){return p(t,n)||w(t,n)}function p(t,n){return(0,I.isArray)(d(t,n))}function w(t,n){var i,r,e,u,n,i=d(t,n);if((0,I.isObject)(i)&&(i=i.name),(0,I.isString)(i))return r=t.qRt(n),e=D(n),u=D(i),n=t.QOt.relationships.find(function(t){return t.sourceTable===r&&t.sourceFieldName===e&&t.sourceRelationshipName===u}),!(0,I.isNullOrUndefined)(n)}function b(t,n,i){var r=D(i),i=C(t,function(t){return t.sourceFieldName===r&&t.sourceTable===n});return i?{relationTable:i.targetTable,relationPrimaryKey:i.targetFieldName,relationTableName:i.sourceRelationshipName}:{}}function m(t,n,i){var r,n,e,u,n,u,n,e,u,r,r=n.over,n=n.attributes;return!((0,I.isNullOrEmpty)(r)||(0,I.isNullOrEmpty)(i)||i===r||j(t,i)||(e=v(i),n=!(u=p(t,r))&&w(t,r)&&n&&0<n.length,!u&&!n)||(u=b(t,O(t,r),r),-1<e.indexOf(u.relationTableName)))&&(n=t.$Rt(r),e=t.$Rt(i),!(!n.every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne})||!e.every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne}))||(u=(0,I.findIndex)(n,function(t){return t.relationshipMap===s.RelationshipMap.OneToMany}),r=(0,I.findIndex)(e,function(t){return t.relationshipMap===s.RelationshipMap.OneToMany}),-1<u&&u===r&&n[u].name===e[r].name?n.slice(u+1).every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne})&&e.slice(u+1).every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne}):void 0))}function j(t,n){var i=O(t,n),r=D(n);return i.jOt(r)||C(t,function(t){return t.sourceTable===i&&t.sourceFieldName===r||t.targetTable===i&&t.targetFieldName===r})}function O(t,n){return t.qRt(n)}function C(t,n){return t.QOt.relationships.find(n)}function S(t){var r=t.ascending,i=t.compare;return i?function(t,n){return i(t.extra.caption,n.extra.caption,r)}:function(t,n){var t=t.extra.caption,n=n.extra.caption,i=r?t:n,n=r?n:t;return n<i?1:i<n?-1:0}}o=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,u;r<e;r++)!u&&r in n||((u=u||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(u||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.isValidCross=t.isLookupRelationField=t.isLookupListField=t.isLookupField=t.getLookupBy=t.getFieldNamesFrom=t.FieldManager=void 0,a=n("CalcEngine"),I=n("./dist/src/dataSource/utils.js"),s=n("./dist/src/interfaces/interface.js"),E=n("./dist/src/viewField/utils.js"),y=n("./dist/src/viewField/fields.js"),c=n("./dist/src/viewField/groupManager.js"),i.prototype.ade=function(){return this.nM.length()},i.prototype.fBt=function(t,n){return this.nM._getValueByField(t,n)},i.prototype.lBt=function(t,n){return this.nM.XRt(t,n)},i.prototype.hBt=function(t){return this.nM.iBt(t)},i.prototype.dBt=function(t){return C(this.nM,t)},i.prototype.vBt=function(t){return O(this.nM,t)},i.prototype.mBt=function(t){return this.nM._dataSource._data[t].data},i.prototype.gBt=function(t){return!(0,I.isNullOrUndefined)(this.nM._dataSource._data[t])&&!this.nM._dataSource.X7t()},i.prototype.oBt=function(t){return this.nM.oBt(t.split("."))},i.prototype.pBt=function(){return this.nM.POt},i.prototype.bBt=function(t){return d(this.nM,t)},i.prototype.yBt=function(t){return u(this.nM,t)},i.prototype.wBt=function(t){return p(this.nM,t)},i.prototype.MBt=function(t){return w(this.nM,t)},i.prototype.getTable=function(){return this.nM},i.prototype.getField=function(n){return this.Z[n]||this.Pq.find(function(t){return t.key===n})},i.prototype.getFieldByColumn=function(t){return this.getField(t.Kyn)},i.prototype.getFieldByName=function(t){var n,n,i,r,e,u,i=this.Z[t];if(!i)for(e in r=this.Z)if(r.hasOwnProperty(e)&&(u=r[e])&&((null==(n=u.column)?void 0:n.caption)===t||(null==(n=u.extra)?void 0:n.caption)===t)){i=u;break}return i},i.prototype.getFields=function(t){return t?this.Pq.filter(t):this.Pq},i.prototype.xve=function(t,n,i,r,e){var u=this;f(u,i,r,e)(t,u.getFieldByColumn(n).key)},i.prototype.getFieldValues=function(t,n,i){for(var r,e,u,o,s,c,r=this,e=f(r,t,n,i),u={},o=0,s=r.Pq;o<s.length;o++)e(u,(c=s[o]).key);return u},i.prototype.CBt=function(t){for(var n,i,r,e,u,o,n=this,i=f(n,t),r={},e=0,u=n.Pq;e<u.length;e++)(o=u[e]).isGroup&&i(r,o.key);return r},i.prototype.moveFields=function(t,n,i){(0,I.swapArrayItems)(this.Pq,t,n,i)},i.prototype.moveFieldsByIndexes=function(t){var n=this;t.forEach(function(t){t.field=n.Pq[t.oldIndex]}),t.forEach(function(t){n.Pq[t.newIndex]=t.field})},i.prototype.removeFields=function(t,n,i){var r;i&&i({fields:o([],this.Pq,!0)})},i.prototype.rRe=function(t){var t=t.fields;this.Pq=t},i.prototype.reset=function(){var n=this;n.Pq=n.Pq.filter(function(t){return t.isBasic}),n.Z={},n.groupFieldKeys=[],n.Pq.forEach(function(t){n.Z[t.name]=t,n.Z[t.key]=t})},i.prototype.bMt=function(t){return this.cBt[t]||this.u3e(t)},i.prototype.u3e=function(t,n){var i=this,r=i.cBt,e=r[t],n=n||i.pBt(),u=n.getCalcService(),e;return e=e||(r[t]=i.fixExpression(u.parse(n,t,0,0)))},i.prototype.SBt=function(t){var n=this,e=n.u3e(t),u=n.pBt(),o=u.getCalcService();return function(t,n,i,r){var t,n;return u.pe(t,n,i),(t=4===arguments.length)&&u.wEt("extendContext",r),n=o.evaluateExpression(u,e,{row:0,col:0}),t&&u.wEt("extendContext"),n}},i.prototype.TBt=function(t,n){var i=this,e=i.u3e(t,n),u=n||i.pBt(),o=u.getCalcService();return function(t,n,i,r){var t,n;return u.pe(t,n,i),(t=4===arguments.length)&&u.wEt("extendContext",r),n=o.MX.evaluateExpression(e,u.getEvaluatorContext({row:0,col:0},!1),!1,!0),t&&u.wEt("extendContext"),(0,I.isNullOrUndefined)(n.toArray)?[]:n.toArray()}},i.prototype.fixExpression=function(t){var n,i,r,e,u,o,s,n=this;if(t.function)for(t.function.isReverseArgs&&t.function.isReverseArgs()&&t.arguments.reverse(),i=0,r=t.arguments;i<r.length;i++)e=r[i],n.fixExpression(e);else for(u=0,o=Object.getOwnPropertyNames(t);u<o.length;u++)t[s=o[u]]instanceof a.Expression&&n.fixExpression(t[s]);return t},i.prototype.ABt=function(t){var n=this;return t.key=n._id++,n.Pq.push(t),n.Z[t.name]=t,n.Z[t.key]=t},i.prototype.removeField=function(t){var n=this,i;return((i=(0,I.isString)(t)?n.getFieldByName(t):i)instanceof y.ColumnDataField||i instanceof y.ColumnDataReaderField||i instanceof y.ExternalFormulaField)&&(n.Pq.splice(n.Pq.indexOf(i),1),delete n.Z[i.name],delete n.Z[i.key],!0)},i.prototype.addBaseField=function(t,n){var i=this,r=g(t),e=t.value;t.zTr?i.addExternalBaseField(r,t,n):i.gBt(r)?i.addDataBaseField(r,i.mBt(r),t):i.addReaderBaseField(r,e,t)},i.prototype.renameBaseField=function(t,n){var i=this,r;return((r=(0,I.isString)(t)?i.getFieldByName(t):r)instanceof y.ColumnDataField||r instanceof y.ColumnDataReaderField||r instanceof y.ExternalFormulaField)&&(i.Z[n]=i.Z[r.name],delete i.Z[r.name],r.name=n,!0)},i.prototype.$Ar=function(){for(var t,n,i,r,e,t,n=this.Pq,i=!1,r=0;r<n.length;r++)(e=n[r])instanceof y.ExternalFormulaField&&(e.nIr(),i=!0);return i},i.prototype.addDataBaseField=function(t,n,i){var r=this,t=r.addColumnDataField(t,n,i);return i.Kyn=t.key,r.EGe(t)},i.prototype.addReaderBaseField=function(t,n,i){var r,t,r=this,t=r.addColumnDataReaderField(t,"function"==typeof n?n:function(t){return r.fBt(n,t)},i,r.ade.bind(r));return i.Kyn=t.key,r.EGe(t)},i.prototype.addExternalBaseField=function(t,n,i){var r,t,r=this,t=r.addExternalFormulaField(t,n,i);return n.Kyn=t.key,r.EGe(t)},i.prototype.EGe=function(t){return t.isBasic=!0,t},i.prototype.addColumnDataField=function(t,n,i){return this.ABt(new y.ColumnDataField(t,n,i))},i.prototype.addColumnDataReaderField=function(t,n,i,r){return this.ABt(new y.ColumnDataReaderField(t,n,i,r))},i.prototype.addDataField=function(t,n){return this.ABt(new y.DataField(t,n))},i.prototype.addFormulaField=function(t,n){return this.ABt(this.xBt(t,n))},i.prototype.addExternalFormulaField=function(t,n,i){return this.ABt(new y.ExternalFormulaField(t,n,i))},i.prototype.xBt=function(t,n){return new y.FormulaField(t,n,this.SBt(n))},i.prototype.addCategoryFormulaField=function(t,n,i){return this.ABt(this.NBt(t,n,i))},i.prototype.NBt=function(t,n,i){return new y.CategoryFormulaField(t,n,this.SBt(n),i,i?this.u3e(i):null)},i.prototype.addCategoryField=function(t,n){return this.ABt(this.kBt(t,n))},i.prototype.kBt=function(t,n){return new y.CategoryField(t,n)},i.prototype.addSliceCategoryField=function(t){return this.ABt(new y.SliceCategoryField(t))},i.prototype.DBt=function(t,n,i,r,e){for(var u,o,s,c,f,a,h,a,l,v,d,c,u=this,o=t.fieldExtra,s=t.field,l=0,v=i.length;l<v;l++)f=(a=i[l]).result,h=a.key,(0,I.isUndefined)(h)&&(d=a.value,t.field.addKey(d,a.recordRowNumbers[0]),c=t.field.getMap(),h=a.key=c[d]),a=t.sliceFields[h],(0,I.isUndefined)(a)&&(c=s.getValueByKey(h),(a=u.addSliceCategoryField((0,E.combineName)((0,I.isNullOrEmpty)(c)?" ":c,"s",n.name))).isGroup=!0,a.setFieldExtra(o),a.setFieldManager(u),t.sliceFields[h]=a,t.sliceKeys.push(a.key)),a.setData(f,r,e)},i.prototype._Bt=function(n,t,i,r){var e=this;return(0,E.isField)(n)?e.getFieldByName(n):(0,I.isFormula)(n)?e.EBt((0,E.combineName)(n,"".concat(r,"_formula_source")),t,n,i):(0,I.isRelation)(n)?new y.ColumnDataReaderField((0,E.combineName)(n,"".concat(r,"_related_source")),function(t){return e.fBt(n,t)},{value:n},e.ade.bind(e)):e.getFieldByName(n)},i.prototype.EBt=function(t,n,i,r){var e,t=this.xBt((0,E.combineName)(t,n),i);return t.evaluateFormulaBy(r),t},i.prototype.ocr=function(t){var n,i,t,n,i,t=h(this.bMt(t),!0);return t&&0<t.length?t[0]:null},i.prototype.buildGroupFields=function(t,c){var f=this,i,a,h=[];return t.forEach(function(t,n){var s,n,n;(0,I.isNullOrEmpty)(t.field)||(a=(0,I.isNullOrUndefined)(a)?i={}:a.group={},s=(0,E.combineName)(t.field,n),n=f._Bt(t.field,s,c,"group_field"),(n=f.addCategoryField(s,n)).setFieldExtra(t),n.setFieldManager(f),n.isGroup=!0,h.push(n.key),a.field=n,"boolean"==typeof t.ascending&&(a.sort=t.ascending?"asc":"desc"),(0,I.isNullOrUndefined)(t.summaryFields)||t.summaryFields.forEach(function(t,n){var n,i,r,r,i,e,u,o,u;(0,I.isNullOrEmpty)(t.formula)||(n=(0,E.combineName)(t.formula,n,s),(i=f.addCategoryFormulaField(n,t.formula,t.filter)).setFieldExtra(t),i.setFieldManager(f),(0,I.isNullOrEmpty)(t.position)||(i.extra.position=t.position),(0,I.isNullOrEmpty)(t.relateTo)?(r=f.ocr(t.formula),(0,I.isNullOrUndefined)(r)||(i.extra.relateTo=r)):i.extra.relateTo=t.relateTo,(0,I.isNullOrUndefined)(a.formulas)&&(a.formulas=[]),r=a.formulas.push(i)-1,i.isGroup=!0,h.push(i.key),(0,I.isNullOrUndefined)(t.slice))||(i=t.slice,u=(e=(0,I.isString)(i))?i:i.field,o=f._Bt(u,n,c,"slice"),(o=f.kBt((0,E.combineName)(u,"slice_category",n),o)).setFieldManager(f),(0,I.isNullOrUndefined)(a.slices)&&(a.slices=[]),u=f.NBt((0,E.combineName)(u,"slice_formula_result",n),t.formula),a.slices.push({field:o,formula:u,formulaIndex:r,sliceKeys:[],fieldExtra:e?{}:i,sliceFields:{},addSliceField:f.DBt.bind(f)}))}),(0,I.isNullOrUndefined)(t.windowOrderedFunctions))||(a.windowFunctionOptions=t.windowOrderedFunctions.map(function(t){return{orders:t.orders,fields:t.functions.map(function(t){return f.nM.XOt[t.windowOverFormula]})}}))}),f.groupFieldKeys=h,i},i.prototype.transposeSliceFields=function(i){var r=this,e,u;i.slices&&i.slices.forEach(function(t){var n,n,n=i.formulas[t.formulaIndex];e=r.groupFieldKeys.indexOf(n.key),u=t.sliceKeys,(0,I.isNullOrUndefined)(t.fieldExtra.sort)||(u=u.map(function(t){return r.getField(t)}).sort(S(t.fieldExtra.sort)).map(function(t){return t.key})),(n=r.groupFieldKeys).splice.apply(n,o([e+1,0],u,!1))}),i.group&&r.transposeSliceFields(i.group)},i.prototype.prepareFields=function(o,t){for(var s,c,f,n,i,r,e,u,a,h,a,l,v,d,p,w,b,m,j,s=this,c=[],f=0,n=0;f<o.length;f++,n++)if(r=g(i=o[f]),e=i.value,u=i.cross){if(h=(a=s.jBt(o,f)).crossColumnOptions,a=a.endColIndex,l=h.columns.length,0!==(v=s.OBt(h))){for(d=s.Pq.length-v,p=function(t,n){var i,r,i,e,u,i=d+t,r=f+n,i=s.Pq[i];i.setFieldExtra(o[r]),i.setFieldManager(s),e={value:i.name,name:i.name,Kyn:i.key,isCross:!0,RBt:r},i.isReadonly()&&(e.readonly=!0),(u=i.extra)&&(0,y.setFieldExtraProperties)(function(t){(0,I.isNullOrUndefined)(u[t])||(e[t]=u[t])}),c.push(e),w=++t,b=n=l<=++n?0:n},j=m=0;m<v;)p(m,j),m=w,j=b;f=a,n+=v-1}}else i.zTr?s.addExternalBaseField(r,i,t):s.gBt(r)?s.addDataBaseField(r,s.mBt(r),i):s.addReaderBaseField(r,e,i),c.push(o[f]);return _(c),c},i.prototype.jBt=function(t,n){var i,r,e,u,e,o,s,i=this,r=n,e=t[n],u=e.cross,e=i.BBt(u,[e],r);if("string"==typeof u){for(s=o=n;n<t.length&&!(++s<t.length&&u!==t[s].cross);)n++;e=i.BBt(u,t.slice(o,s),r)}return{crossColumnOptions:e,endColIndex:n}},i.prototype.BBt=function(t,n,i){var t="string"==typeof t?this.sBt.cross[t]:t;return{initialOptionIndex:i,crossKeys:n.map(function(t){return t.LBt}),cross:t,columns:n,lookup:this.FBt(t,n)}},i.prototype.FBt=function(n,t){var i=this;return t.every(function(t){return i.isValidCross(n,t.value)})&&this.bBt(n.over)},i.prototype.isValidCross=function(t,n){return m(this.nM,t,n)},i.prototype.OBt=function(t){var n=this,i=t.lookup,r=0;return(0,I.isArray)(i)?r=n.PBt(t):((0,I.isString)(i)||(0,I.isObject)(i))&&(r=n.GBt(t)),r},i.prototype.GBt=function(t){var n,i,r,e,u,o,s,c,f,a,h,t,l,v,d,p,w,l,b,i,m,j,y,g,_,O,C,S,M,F,N,T,R,F,T,n=this,i=t.cross,r=n.sBt.showCrossValueHeader,e=V(i.caption),u=0,o=x(t),s=i.over,c=D(s),f=s,a=i.attributes||[],h=a.length,t=L(a[0],!0),l=n.UBt(n.vBt(f),f),v=l.relationTableName||k(a[0]),d=l.relationTable||n.HBt(v),p=d.length(),w=l.relationPrimaryKey||n.zBt(v,c),l=i.filter?n.TBt(A(i.filter,t),d.POt):null;for((0,I.isNullOrUndefined)(l)||0<(i=l(null)).length&&(b=i.reduce(function(t,n){var i;return t["object"==typeof n?n[w]:n]=!0,t},{})),m=[],j=0;j<h;j++)y=D(a[j]),g=P(a[j]),m.push({fieldName:y,formatter:g});for(_=0;_<p;_++)if(O=d._getValueByField(w,_),(0,I.isNullOrUndefined)(b)||b[O]){for(C=e.slice(),j=0;j<h;j++)y=m[j].fieldName,S=d._getValueByField(y,_),g=m[j].formatter,(0,I.isNullOrUndefined)(g)||(S=(0,I.format)(S,g)),C.push(S);for(M=0;M<o.length;M++)N=(F=o[M]).valueRelation,T=F.valueCaption,R=F.valueIndex,F=F.valueCrossKey,T=r?C.concat(T):C,n.VBt({path:T,value:(0,E.combineName)(N,O,s,F),valueRelation:N,dimRelationPath:f,dimRelationKey:c,dimTableName:v,dimTableKeyFieldValue:O,initialOptionIndex:R}),u++}return u},i.prototype.PBt=function(t){for(var n,i,r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,j,w,m,n=this,i=t.cross,r=t.lookup,e=n.sBt.showCrossValueHeader,u=V(i.caption),o=0,s=x(t),c=i.over,f=D(c),a=c,h=r.length,l=0;l<h;l++)for(v=u.slice(),d=r[l],v.push(d),p=0;p<s.length;p++)b=(w=s[p]).valueRelation,m=w.valueCaption,j=w.valueIndex,w=w.valueCrossKey,m=e?v.concat(m):v,n.VBt({path:m,value:(0,E.combineName)(b,d,c,w),valueRelation:b,dimRelationPath:a,dimRelationKey:f,dimTableKeyFieldValue:d,initialOptionIndex:j}),o++;return o},i.prototype.setCrossFieldValues=function(t){var n,i,r,e,u,o,s,c,f,n=this,i=n.Pq,r=t.length,e=i.filter(function(t){return t instanceof y.CrossField});if(0<e.length)for(u=0;u<r;u++)for(o=t[u],s={},c=0;c<e.length;c++)f=e[c],n.YBt(f,o,s)},i.prototype.YBt=function(t,n,i){var r,e,u,o,r=this,e=t.dimRelationPath,u=i[e];if((0,I.isNullOrUndefined)(u)&&t.isOneToMany&&(u=i[e]=r.fBt(e,n)),(0,I.isArray)(u))for(o=0;o<u.length;o++)if(t.ZBt(u[o],t.dimTableKeyFieldValue)&&(0,I.isNullOrUndefined)(t.getValueIndex(n))){t.setValueIndex(n,o);break}},i.prototype.zBt=function(n,i){var t=this,r=t.dBt(function(t){return t.sourceFieldName===i&&t.sourceRelationshipName===n});return r?r.targetFieldName:(r=t.dBt(function(t){return t.targetFieldName===i&&t.targetRelationshipName===n}))?r.sourceFieldName:void 0},i.prototype.HBt=function(n){var t,i=this.dBt(function(t){return t.sourceRelationshipName===n||t.targetRelationshipName===n})||{},i=i.sourceRelationshipName===n?i.sourceField:i.targetField;return i?i.targetTable:{length:function(){return 0}}},i.prototype.UBt=function(t,n){return b(this.nM,t,n)},i.prototype.WBt=function(t){var n=this,t=new y.CrossField(t,n.fBt.bind(n),n.lBt.bind(n),n.hBt.bind(n));return n.ABt(t),n.EGe(t),t},i.prototype.VBt=function(t){var n,t,n,i,n,n=this,t=n.WBt(t);t.isReadonly()||(i=(n=r(n.oBt.bind(n),t)).isOneToMany,n=n.relationTemplate,i&&(t.isOneToMany=i,t.valueArrayRelation=n))},i.prototype.isCrossField=function(t){return t instanceof y.CrossField},i.prototype.clearCrossFieldData=function(){for(var t,n,i,r,t,n=this.Pq,i=0;i<n.length;i++)(r=n[i])instanceof y.CrossField&&r.clearData()},i.prototype.resetCrossFieldRowValues=function(t){for(var n,i,r,e,u,n=this,i=n.Pq,r={},e=0;e<i.length;e++)(u=i[e])instanceof y.CrossField&&(u.clearValue(t),n.YBt(u,t,r))},i.prototype.removeCrossFieldValues=function(t,n,i){for(var r,e,u,o,r,e=this.Pq,u=0;u<e.length;u++)(o=e[u])instanceof y.CrossField&&o.removeData(t,n,i)},i.prototype.setCrossFieldInsertedIndex=function(t,n,i){for(var r,e,u,o,s,r,e=this.Pq,u=L(t.valueRelation,!0),o=0;o<e.length;o++)(s=e[o])instanceof y.CrossField&&s.isOneToMany&&t.dimTableKeyFieldValue===s.dimTableKeyFieldValue&&(0,I.isNullOrUndefined)(s.getValueIndex(n))&&u===L(s.valueRelation,!0)&&s.setValueIndex(n,i)},t.FieldManager=i,t.getFieldNamesFrom=h,t.getLookupBy=d,t.isLookupField=u,t.isLookupListField=p,t.isLookupRelationField=w,t.isValidCross=m},"./dist/src/viewField/fields.js":function(t,n,i){"use strict";var r,c,s,f,a,i,e,u,o,e,h,e,D,P,k,l,v,d,p,w,b,m,j,y,g;function _(t){["caption","width","style","headerStyle","conditionalFormats","validator","headerFit","allowSort","allowFilterByValue","allowFilterByList"].forEach(t)}function O(t){var n=(this.name=t).indexOf(s.FieldNameDelimiter);-1<n&&(t=t.slice(0,n)),this.fieldValue=t}function C(t,n){var t=v.call(this,t)||this;return t.data=n||[],t}function S(t,n,i){var t=d.call(this,t,n)||this;return t.column=i,t}function M(t,n,i,r){var t=p.call(this,t)||this;return t.column=i,t.setFieldExtra(i),t.getValue=n,t.getLength=r,t}function F(t,n,i){var t=w.call(this,t)||this;return t.setFieldExtra({value:n}),t.formula=n,t.P6t=i,t}function N(t,n,i){var r,t,r=this;return(r=b.call(this,t,n.eIr||n.value)||this).column=n,r.LEt=i,r.setFieldExtra(n),r.iIr={row:0,col:null!=(t=i.col)?t:0},r}function T(t,n){return t._error||t._code?"Calc Error ".concat(n,":").concat(t._error,",").concat(t._code):t}function R(t,n){var t=m.call(this,t)||this;return t.QBt=n,t.KBt={},t.Oit=[],t}function I(t,n,i,r,e){var t=j.call(this,t)||this;return t.P6t=i,t.formula=n,t.filter=r,t.filterExpression=e,t}function E(t){return y.call(this,t)||this}function x(t,n,i,r){var e=g.call(this,t.value)||this;return e.path=t.path,e.valueRelation=t.valueRelation,e.valueField=-1<t.valueRelation.indexOf(".")?t.valueRelation.split(".").pop():t.valueRelation,e.dimRelationPath=t.dimRelationPath,e.dimRelationKey=t.dimRelationKey,e.dimTableName=t.dimTableName,e.isDateDimValue=t.dimTableKeyFieldValue instanceof Date,e.dimTableKeyFieldValue=e.isDateDimValue?t.dimTableKeyFieldValue.getTime():t.dimTableKeyFieldValue,e.initialOptionIndex=t.initialOptionIndex,e.getValueByField=A(t,r,n),e.getOriginalValueByField=A(t,r,i),e.data=[],e}function A(t,i,r){return(0,c.isFunction)(t.valueRelation)?function(t,n){return(0,c.isFunction)(t)?t(i(n)):r(t,n)}:r}r=this&&this.__extends||(l=function(t,n){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CrossField=n.SliceCategoryField=n.CategoryFormulaField=n.CategoryField=n.ExternalFormulaField=n.FormulaField=n.ColumnDataReaderField=n.ColumnDataField=n.DataField=n.Field=n.setFieldExtraProperties=void 0,c=i("./dist/src/dataSource/utils.js"),s=i("./dist/src/viewField/utils.js"),f=null,a=void 0,n.setFieldExtraProperties=_,O.prototype.setFieldExtra=function(n){var i,t,i=this;(0,c.isUndefined)(i.extra)&&(i.extra={}),(0,c.isNullOrUndefined)(n)||(n.field&&(i.fieldValue=n.field),_(function(t){i.JBt(t,n)}),(0,c.isNullOrUndefined)(n.caption)&&0<=(t=i.name.indexOf(s.FieldNameDelimiter))&&(i.extra.caption=i.name.substring(0,t)),(0,c.isNullOrUndefined)(n.spacing))||(i.extra.spacing=n.spacing)},O.prototype.JBt=function(t,n){var i=this,n=n[t];(0,c.isNullOrUndefined)(n)||(i.extra[t]=n)},O.prototype.setFieldManager=function(t){this.fieldManager=t},O.prototype.getFieldManager=function(){return this.fieldManager},O.prototype.getValue=function(t,n){return this.data[t]},O.prototype.getOriginalValue=function(t){return this.getValue(t)},O.prototype.getLength=function(){return this.data.length},O.prototype.setValues=function(t){this.data=t},O.prototype.XBt=function(t,n,i,r){var e,u,o,s,e=this;if(e.data||(e.data=[]),i=(0,c.isNumber)(i)?i:0,r=(0,c.isNumber)(r)?r:t.length-1,(0,c.isArray)(n))for(o=0,s=n.length;i<=r&&o<s;o++)u=t[i=o+i],e.data[u]=n[o];else for(o=i;o<=r;o++)u=t[o],e.data[u]=n;return e.data},O.prototype.qBt=function(t,n){var i,r,e,u,i=this;for(i.data||(i.data=[]),e=0,u=t.length;e<u;e++)r=t[e],i.data[r]=n(r);return i.data},n.Field=i=O,r(C,v=i),n.DataField=e=C,r(S,d=e),n.ColumnDataField=S,r(M,p=i),n.ColumnDataReaderField=M,r(F,w=e),F.prototype.evaluateFormulaBy=function(t){var n=this,i=n.formula,r=n.P6t;return n.qBt(t,function(t){return T(r(t),i)})[t[0]]},n.FormulaField=e=F,r(N,b=e),N.prototype.mir=function(t){var n=t.formula,i=t.expr,t=t.col;n&&(this.formula=n,this.setFieldExtra({value:n}),this.column.eIr=n),i&&(this.column.YEr=i,this.WK)&&(this.WK=i),(0,c.isNumber)(t)&&t!==this.iIr.col&&(this.LEt.col=t,this.iIr.col=t,this.iIr.VEr=!1),this.nIr()},N.prototype.rIr=function(){var t,n,i,r;try{return t=this.POt=this.LEt.getCalcSource(),n=this.Lp=this.POt.getCalcService(),i=this.formula,r=this.LEt.getCalcOptions().keepUnknownFormulas,this.WK=this.column.YEr||n.parse(t,i,-1,-1,!1,!0,!1,r),this.WK}catch(t){return this.WK=f,this.WK}},N.prototype.nIr=function(){this.data=[]},N.prototype.getValue=function(t,n){var i,r,e,u,o,i=this.WK;if((i=i===a?this.rIr():i)===f)return f;if(r=this.data[t],(0,c.isUndefined)(r)){try{e=this.Lp,u=this.POt,(o=this.iIr).row=n,r=e.evaluateParsedFormula(u,i,o,!1,!0)}catch(t){}this.data[t]=r}return r},N.prototype.hasValue=function(t){return this.data[t]!==a},n.ExternalFormulaField=N,r(R,m=i),R.prototype.getKey=function(t){return this.KBt[t]},R.prototype.getMap=function(){return this.KBt},R.prototype.getValueByKey=function(t){return this.Oit[t]},R.prototype.$Bt=function(t,n){this.KBt[n]=t,this.Oit[t]=n},R.prototype.getValue=function(t){var n=this;return n.data&&0<n.data.length?n.Sl(t):n.QBt?n.QBt.getValue(t):void 0},R.prototype.Sl=function(t){var n=this;return n.Oit[n.data[t]]},R.prototype.addKey=function(t,n){var i=this,r=i.getKey(t);return(0,c.isUndefined)(r)&&i.$Bt(r=n,t),r},R.prototype.getSourceField=function(){return this.QBt},n.CategoryField=e=R,r(I,j=e),I.prototype.evaluateFormulaBy=function(t,n,i){var r,e,i,r=this,e=0;return(0,c.isNullOrUndefined)(i)&&(i=t,e=n||0),i=r.P6t(i,e),r.XBt(t,r.addKey(i,t[n]),n),i},n.CategoryFormulaField=I,r(E,y=e),E.prototype.setData=function(t,n,i){var r=this,t=r.addKey(t,n[i]);r.XBt(n,t,i)},n.SliceCategoryField=E,r(x,g=i),x.prototype.setFieldExtra=function(t){g.prototype.setFieldExtra.call(this,t),this.extra.caption=this.path},x.prototype.ZBt=function(t,n){var i,r;return this.isDateDimValue&&t instanceof Date?t.getTime()===n:t===n},x.prototype.tLt=function(t,n){var i=this,r=i.isOneToMany,e=i.dimRelationPath,u=i.dimTableKeyFieldValue;return!r&&i.ZBt(n(e,t),u)?t:this.data[t]},x.prototype.getDimValue=function(){var t=this,n=t.isDateDimValue,t=t.dimTableKeyFieldValue;return n?new Date(t):t},x.prototype.getValueIndex=function(t){return this.tLt(t,this.getValueByField)},x.prototype.setValueIndex=function(t,n){this.data[t]=n},x.prototype.clearData=function(){this.data=[]},x.prototype.clearValue=function(t){this.data[t]=void 0},x.prototype.removeData=function(t,n,i){var r,e,u;if(i&&0<i.length)for(r=0,e=i;r<e.length;r++)u=e[r],this.data.splice(u,1);else this.data.splice(t,n)},x.prototype.isReadonly=function(){return(0,c.isFormula)(this.valueRelation)||(0,c.isFunction)(this.valueRelation)},x.prototype.Sl=function(t,n){var i,r,e,u,i,o,i=this,r=i.isOneToMany,e=i.valueArrayRelation,u=i.valueRelation,i=i.tLt(t,n);if((0,c.isNumber)(i))return o=void 0,n(o=r?e.replace(s.RelationTemplateToken,i+1):u,t)},x.prototype.getValue=function(t){return this.Sl(t,this.getValueByField)},x.prototype.getOriginalValue=function(t){return this.Sl(t,this.getOriginalValueByField)},x.prototype.getRelationField=function(t){var n=this,i=n.isOneToMany,r=n.valueArrayRelation,e=n.valueRelation,n=n.getValueIndex(t);return i?(0,c.isNumber)(n)?r.replace(s.RelationTemplateToken,n+1):void 0:e},n.CrossField=x},"./dist/src/viewField/groupManager.js":function(t,n,i){"use strict";var e,l,u,o,s,c,r;function f(t,n){var i,r,e,u,o;if((0,l.isNullOrUndefined)(t)||(0,l.isNullOrUndefined)(n))return t===n;if(i=Object.keys(t),r=Object.keys(n),i.length!==r.length)return!1;for(e=0,u=i;e<u.length;e++)if(t[o=u[e]]!==n[o])return!1;return!0}function a(t){for(var n,i,r,n=[],i=t.split(u.FieldNameDelimiter).reverse(),r=0;r<i.length;r+=2)n.push(i[r]);return n}function h(t){return 1===a(t).length}function v(t){return 2===a(t).length}function d(t){return 3===a(t).length}function p(t){return 2===t.split(u.FieldNameDelimiter).length}function w(t){var t=t.split(u.FieldNameDelimiter);return t[t.length-2]}function b(t,n,i,r,e){this.LEt=t,this.wEt=n,this.wwn=r||function(){},this.s3e=e||function(){return[]};var t=this.QAe=new s.DataManagerProxy(i);this.Cle=new o.DataManagerReportGroupHelper(t,void 0,void 0,new c.DataManagerReportSortHelper(t))}e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.GroupManager=n.getGroupFieldName=n.isGroupField=n.isGroupSlice=n.isGroupSummary=n.isGroupCategory=n.getGroupOptionIndexesFrom=void 0,l=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/viewField/utils.js"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),s=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),c=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),n.getGroupOptionIndexesFrom=a,n.isGroupCategory=h,n.isGroupSummary=v,n.isGroupSlice=d,n.isGroupField=p,n.getGroupFieldName=w,b.prototype.dl=function(){this.QAe.clearTableDataCache()},b.prototype.isGrouped=function(t){return f(t,this.LEt)},b.prototype.groupBy=function(t,n){var i,r,e,u,i=this,r=i.Sle(t),e,u={childrenArray:[this.Cle.generateCellNodeTreeData(r,void 0,void 0,n,void 0,void 0,{ignoreMultipleTableJoinCache:!0})]};return{rootNode:u,indexMap:i.eLt(n,function(){return i.iLt(t,u)})}},b.prototype.Sle=function(t){var n,i,r,e,i=this,r,e=(t.field.getSourceField()||t.field).fieldValue;return{templateCell:{sorts:t.sort?[((n={})[t.sort]=e,n)]:void 0,dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:e}},data:{groups:[]},field:t.field,group:t.group,children:t.group?[this.Sle(t.group)]:[],slices:t.slices&&t.slices.length?t.slices.map(function(t){return i.Tle(t)}):null,formulas:t.formulas}},b.prototype.Tle=function(t){var n,i,r,n=e({},t),i,r=(n.field.getSourceField()||n.field).fieldValue;return n.templateCell={dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:r}},n.children=[],n.data={groups:[]},n},b.prototype.eLt=function(t,n){var i,r,r,i=this,r=i.LEt;return i.DJ={path:[],groupOptions:r,entireScope:t},i.wEt("groupContext",i.DJ),r=n(),i.DJ=null,i.wEt("groupContext"),r},b.prototype.iLt=function(t,n){for(var i,r,e,u,o,s,i=this,r,e=[],u=0,o=n.childrenArray&&n.childrenArray[0];u<o.length;u++)s=o[u],i.aLt(s,t,e);return e},b.prototype.aLt=function(t,n,i){var r,e,u,o,s,c,f,a,h,l,v,d,p,w,b,m,r=this,e=i.length,u=t.recordRowNumbers;if(r.uLt(t),t.childrenArray&&t.childrenArray[0]&&0!==t.childrenArray[0].length)for(a=c=t.childrenArray[f=0];f<a.length;f++)h=a[f],r.aLt(h,n.group,i);else{for(o=0,s=u.length;o<s;o++)i[e+o]=u[o];t.key=n.field.addKey(t.value,i[e])}if(r.acr(t,r.sLt(n.formulas,i,e)),r.ude(n.windowFunctionOptions,i,e),t.slices)for(o=0,v=(l=t.slices).length;o<v;o++){for(d=l[o],w=(p=n.slices[o]).formula,b=0,m=c=d.childrenArray&&d.childrenArray[0];b<m.length;b++)(h=m[b]).result=r.cLt(w,h.recordRowNumbers);p.addSliceField(p,n.formulas[p.formulaIndex],c,i,e)}r.fLt()},b.prototype.acr=function(t,n){n&&(t.summaryResults=n)},b.prototype.c3e=function(t,n,i){var r=t.filter;if(!(0,l.isNullOrEmpty)(r))return this.s3e(t.filterExpression,n,i)},b.prototype.f3e=function(t,n,i){for(var r,e,u,o,s,c,f,r=[],o=0,s=t.length;o<s;o++)f=(c=t[o]).filter,(0,l.isNullOrEmpty)(f)||(e!==f?(e=f,u=r[o]=this.s3e(c.filterExpression,n,i)):r[o]=u);return r},b.prototype.sLt=function(t,n,i){var r,e,u,o,s,c,f,e,r,a,h,h;if(t)for(u={},o=this.f3e(t,n,i),s=0,c=t.length;s<c;s++)e=(f=t[s]).extra&&f.extra.position,r=f.formula,a=f.extra&&f.extra.relateTo,u[r]?(h=u[r][e],(0,l.isNullOrUndefined)(h)&&(u[r][e]=h={}),(0,l.isNullOrUndefined)(h[a])&&(h[a]=f.extra),f.XBt(n,f.addKey(u[r].value,n[i]),i)):(h=f.evaluateFormulaBy(n,i,o[s]),u[r]=((r={value:h})[e]=((e={})[a]=f.extra,e),r));return u},b.prototype.cLt=function(t,n){var i;if(t)return i=this.c3e(t,n),t.evaluateFormulaBy(n,void 0,i)},b.prototype.ude=function(t,n,i){var r,e,u,o,s,c,f,a,h;if(t)for(r=this,e=0,u=t.length;e<u;e++)for(s=(o=t[e]).orders,c=o.fields,(0,l.isArray)(s)&&0<s.length&&r.wwn(n,s,i),f=0,a=c.length;f<a;f++)(h=c[f]).evaluateWindowFunction(n,i)},b.prototype.uLt=function(t){this.DJ.path.push(t)},b.prototype.fLt=function(){this.DJ.path.pop()},n.GroupManager=b},"./dist/src/viewField/utils.js":function(t,i){"use strict";function n(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.join(i.FieldNameDelimiter)}function r(t){return-1<t.indexOf(i.FieldNameDelimiter)}Object.defineProperty(i,"__esModule",{value:!0}),i.isField=i.combineName=i.RelationTemplateToken=i.CaptionDelimiter=i.FieldNameDelimiter=void 0,i.FieldNameDelimiter="__",i.CaptionDelimiter="\\",i.RelationTemplateToken="{{}}",i.combineName=n,i.isField=r},"./dist/src/viewField/viewField.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/viewField/groupManager.js"),n),e(i("./dist/src/viewField/fieldManager.js"),n),e(i("./dist/src/viewField/fields.js"),n),e(i("./dist/src/viewField/utils.js"),n)},"./node_modules/fetch-jsonp/build/fetch-jsonp.js":function(t,n){var i,r,n,e,u,o;e=this,void 0!==(n="function"==typeof(i=u=function(t,n){"use strict";var i,r=5e3,e="callback",u=null;function h(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function l(n){try{delete window[n]}catch(t){window[n]=void 0}}function v(t){var t=document.getElementById(t);t&&document.getElementsByTagName("head")[0].removeChild(t)}function o(u){var o,s,c,f,a,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=u,c=o.timeout||r,f=o.jsonpCallback||e,a=void 0;return new Promise(function(t,n){var i,r,e,i=o.jsonpCallbackFunction||h(),r=f+"_"+i;window[i]=function(n){t({ok:!0,json:function t(){return Promise.resolve(n)}}),a&&clearTimeout(a),v(r),l(i)},s+=-1===s.indexOf("?")?"?":"&",(e=document.createElement("script")).setAttribute("src",""+s+f+"="+i),o.charset&&e.setAttribute("charset",o.charset),e.id=r,document.getElementsByTagName("head")[0].appendChild(e),a=setTimeout(function(){n(new Error("JSONP request to "+u+" timed out")),l(i),v(r),window[i]=function(){l(i)}},c),e.onerror=function(){n(new Error("JSONP request to "+u+" failed")),l(i),v(r),a&&clearTimeout(a)}})}n.exports=o})?i.apply(n,r=[n,t]):i)&&(t.exports=n)},"./node_modules/whatwg-fetch/fetch.js":function(t,n,i){"use strict";var s,r,e,u,o,c;function f(t){return t&&DataView.prototype.isPrototypeOf(t)}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return t="string"!=typeof t?String(t):t}function l(n){var t={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return s.iterable&&(t[Symbol.iterator]=function(){return t}),t}function v(n){this.map={},n instanceof v?n.forEach(function(t,n){this.append(n,t)},this):Array.isArray(n)?n.forEach(function(t){this.append(t[0],t[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(i){return new Promise(function(t,n){i.onload=function(){t(i.result)},i.onerror=function(){n(i.error)}})}function w(t){var n,i,n=new FileReader,i=p(n);return n.readAsArrayBuffer(t),i}function b(t){var n,i,n=new FileReader,i=p(n);return n.readAsText(t),i}function m(t){for(var n,i,r,n=new Uint8Array(t),i=new Array(n.length),r=0;r<n.length;r++)i[r]=String.fromCharCode(n[r]);return i.join("")}function j(t){var n;return t.slice?t.slice(0):((n=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),n.buffer)}function y(){return this.bodyUsed=!1,this.HPt=function(t){(this.zPt=t)?"string"==typeof t?this.VPt=t:s.blob&&Blob.prototype.isPrototypeOf(t)?this.YPt=t:s.formData&&FormData.prototype.isPrototypeOf(t)?this.ZPt=t:s.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this.VPt=t.toString():s.arrayBuffer&&s.blob&&f(t)?(this.WPt=j(t.buffer),this.zPt=new Blob([this.WPt])):s.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||e(t))?this.WPt=j(t):this.VPt=t=Object.prototype.toString.call(t):this.VPt="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this.YPt&&this.YPt.type?this.headers.set("content-type",this.YPt.type):s.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s.blob&&(this.blob=function(){var t=d(this);if(t)return t;if(this.YPt)return Promise.resolve(this.YPt);if(this.WPt)return Promise.resolve(new Blob([this.WPt]));if(this.ZPt)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.VPt]))},this.arrayBuffer=function(){return this.WPt?d(this)||Promise.resolve(this.WPt):this.blob().then(w)}),this.text=function(){var t=d(this);if(t)return t;if(this.YPt)return b(this.YPt);if(this.WPt)return Promise.resolve(m(this.WPt));if(this.ZPt)throw new Error("could not read FormData body as text");return Promise.resolve(this.VPt)},s.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(t){var n=t.toUpperCase();return-1<u.indexOf(n)?n:t}function _(t,n){var i=(n=n||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new v(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t.zPt||(i=t.zPt,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new v(n.headers)),this.method=g(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this.HPt(i)}function O(t){var i=new FormData;return t.trim().split("&").forEach(function(t){var t,n,t;t&&(n=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),i.append(decodeURIComponent(n),decodeURIComponent(t)))}),i}function C(t){var i,n,i=new v,n;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var t,n,t,t=t.split(":"),n=t.shift().trim();n&&(t=t.join(":").trim(),i.append(n,t))}),i}function S(t,n){n=n||{},this.type="default",this.status=void 0===n.status?200:n.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new v(n.headers),this.url=n.url||"",this.HPt(t)}i.r(n),i.d(n,{DOMException:function(){return c},Headers:function(){return v},Request:function(){return _},Response:function(){return S},fetch:function(){return M}}),(s={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self}).arrayBuffer&&(r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],e=ArrayBuffer.isView||function(t){return t&&-1<r.indexOf(Object.prototype.toString.call(t))}),v.prototype.append=function(t,n){t=a(t),n=h(n);var i=this.map[t];this.map[t]=i?i+", "+n:n},v.prototype.delete=function(t){delete this.map[a(t)]},v.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},v.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},v.prototype.set=function(t,n){this.map[a(t)]=h(n)},v.prototype.forEach=function(t,n){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(n,this.map[i],i,this)},v.prototype.keys=function(){var i=[];return this.forEach(function(t,n){i.push(n)}),l(i)},v.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),l(n)},v.prototype.entries=function(){var i=[];return this.forEach(function(t,n){i.push([n,t])}),l(i)},s.iterable&&(v.prototype[Symbol.iterator]=v.prototype.entries),u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],_.prototype.clone=function(){return new _(this,{body:this.zPt})},y.call(_.prototype),y.call(S.prototype),S.prototype.clone=function(){return new S(this.zPt,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},S.error=function(){var t=new S(null,{status:0,statusText:""});return t.type="error",t},o=[301,302,303,307,308],S.redirect=function(t,n){if(-1===o.indexOf(n))throw new RangeError("Invalid status code");return new S(null,{status:n,headers:{location:t}})},c=self.DOMException;try{new c}catch(t){(c=function(t,n){this.message=t,this.name=n;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),c.prototype.constructor=c}function M(u,o){return new Promise(function(i,t){var n,r,n=new _(u,o);if(n.signal&&n.signal.aborted)return t(new c("Aborted","AbortError"));function e(){r.abort()}(r=new XMLHttpRequest).onload=function(){var t,n,t={status:r.status,statusText:r.statusText,headers:C(r.getAllResponseHeaders()||"")};t.url="responseURL"in r?r.responseURL:t.headers.get("X-Request-URL"),n="response"in r?r.response:r.responseText,i(new S(n,t))},r.onerror=function(){t(new TypeError("Network request failed"))},r.ontimeout=function(){t(new TypeError("Network request failed"))},r.onabort=function(){t(new c("Aborted","AbortError"))},r.open(n.method,n.url,!0),"include"===n.credentials?r.withCredentials=!0:"omit"===n.credentials&&(r.withCredentials=!1),"responseType"in r&&s.blob&&(r.responseType="blob"),n.headers.forEach(function(t,n){r.setRequestHeader(n,t)}),n.signal&&(n.signal.addEventListener("abort",e),r.onreadystatechange=function(){4===r.readyState&&n.signal.removeEventListener("abort",e)}),r.send(void 0===n.zPt?null:n.zPt)})}M.polyfill=!0,self.fetch||(self.fetch=M,self.Headers=v,self.Request=_,self.Response=S)},CalcEngine:function(t){"use strict";t.exports=i("@spreadjs/js-calc")},Common:function(t){"use strict";t.exports=i("@spreadjs/js-sheets-common")}},u={},s.d=function(t,n){for(var i in n)s.o(n,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},s.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o=s("./dist/src/dataManager.entry.js"),(r={}).Data=o,t.exports=r.Data},"./node_modules_local/@spreadjs/js-data-manager/index.js":function(t,n,i){t.exports=i("./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js")},"@spreadjs/js-sheets-common":function(t){"use strict";t.exports=GC.Spread},"@spreadjs/js-calc":function(t){"use strict";t.exports=GC.Spread.CalcEngine}},r={},t=e("./node_modules_local/@spreadjs/js-data-manager/index.js"),(GC=void 0===GC?{}:GC).Data=t}();