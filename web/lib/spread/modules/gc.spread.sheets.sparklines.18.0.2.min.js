/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var e,r,n,t,i,o;function a(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},e[n].call(t.exports,t,t.exports,a)),t.exports}e={"./dist/plugins/sparkline/functions-sparkline.js":function(M,n,h){var t,p,x,b,l,w,G,v,T,k,S,i,o,A,D,H,e,K,g,O,B,V,c,C,a,r,N,y,W,X,Y,z,J,U,Z,q,Q,$,nn,tn,en,rn,on,an,un,cn,sn,fn,ln,hn,pn,vn,m,dn,u,gn,mn,wn,kn,bn,Sn,Cn,yn,xn,An,On,Nn,_n,En,d,Ln,Rn,Fn,jn,In,Pn,t,s,Mn,u,Gn,Tn,Dn,Hn,Kn,Bn,Vn,Wn,Xn,Yn,zn,Jn,Un,Zn,qn,Qn,$n,nt,tt,et,rt,it;function f(n){return 0===n}function _(n){return 0===n||2===n}function ot(n){return _(n)||8===n}function at(n){return 0===n||1===n}function ut(n){return 0<=n&&n<=2}function ct(n){return 2===n||3===n}function st(n){return 1===n||2===n}function E(n,t){var e,r,i,o,a,u,c,s,f,l,h,e=[];if(k(n))for(r=0,i=n.getRangeCount();r<i;r++)for(o=n.getRowCount(r),a=n.getColumnCount(r),u=0;u<o;u++)for(c=0;c<a;c++)e.push(n.getValue(r,u,c));else if(t&&S(n))for(s=n.getRowCount(),f=n.getColumnCount(),l=0;l<s;l++)for(h=0;h<f;h++)e.push(n.getValue(l,h));return e=n instanceof x.TwoDimensionalCalcArray&&1===e.length&&Array.isArray(e[0])?e[0]:e}function L(n,t,e){var r,i,o,a,u,c,s,f,l,h,r=[];if(k(n)){if(t<(i=n.getRangeCount()))for(o=n.getRowCount(t),a=n.getColumnCount(t),u=0;u<o;u++)for(r[u]=[],c=0;c<a;c++)r[u].push(n.getValue(t,u,c))}else if(e&&S(n))for(s=n.getRowCount(),f=n.getColumnCount(),l=0;l<s;l++)for(r[l]=[],h=0;h<f;h++)r[l][h]=n.getValue(l,h);return r=n instanceof x.TwoDimensionalCalcArray&&1===r.length&&Array.isArray(r[0])?r[0]:r}function R(n){var t;return k(n)?t=n.getValue(0,0,0):A(n)||(t=n),t}function ft(n,t){this.name=n,this.value=t,this.typeName="SparklineExValue"}function F(){var n,t,e,n=this.createFunction();n&&(t=n.name,e=n.evaluate,n.evaluate=function(){var n=e.call(this,arguments);return n instanceof x.CalcError?n:n?new dn(t,n):r},this.Zc=t)&&!x.Functions.findGlobalFunction(t)&&(x.Functions.Tmt[t]=n),this.typeName=""}function lt(){return Gn.call(this)||this}function ht(){return Tn.call(this)||this}function pt(){return Dn.call(this)||this}function vt(){return Hn.call(this)||this}function dt(){return Kn.call(this)||this}function gt(){return Bn.call(this)||this}function mt(){return Vn.call(this)||this}function wt(){return Wn.call(this)||this}function kt(){return Xn.call(this)||this}function bt(){return Yn.call(this)||this}function St(n){var t=n.plannedValue,e=n.actualValue,r=n.index,i=n.reference,o=n.mini,a=n.maxi,n=n.tickUnit;return!N(r)&&!(0===t.length||0===e.length||r<0||r>=t.length||r>=e.length||a<=o||A(t)||A(e)||N(e[r])||N(t[r])||i&&N(i)||o&&N(o)||a&&N(a)||n&&N(n))}function Ct(){return zn.call(this)||this}function yt(){return Jn.call(this)||this}function xt(){return Un.call(this)||this}function At(){return Zn.call(this)||this}function j(){return qn.call(this)||this}function Ot(){return Qn.call(this)||this}function Nt(){return $n.call(this)||this}function _t(n,v){function d(n){var t,e,r,i,o,a,u,c,s,f,t={},e=!1,r=!0,i="",o="";if(n){for(a=0,u=(n=n.substr(1,n.length-2)).length;a<u;a++)":"===(c=n.charAt(a))?r=!1:","!==c||e?"'"!==c&&'"'!==c&&("("===c?e=!0:")"===c&&(e=!1),r?i+=c:o+=c):(t[i]=o,r=!(o=i=""));for(s in i&&(t[i]=o),t)!t.hasOwnProperty(s)||A(f=t[s])||("TRUE"===f.toUpperCase()?t[s]=!0:"FALSE"===f.toUpperCase()?t[s]=!1:!N(f)&&isFinite(f)&&(t[s]=y(f)))}return t}function g(n){return new b.Range(n.getRow(0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))}function m(n){return new b.Range(0,0,n.getRowCount(),n.getColumnCount())}var n=new i(n,2,5);return n.evaluate=function(n){var t,e,r,i,e,o,a,u,c,s,f,l,h,p,f,n,t=n[0],e=S(t);if((k(t)||e)&&0<(r=e?1:t.getRangeCount())){for(p in i=(e?m:g)(t),e=e?"":t.getSource().getSheet().name(),o=n[1],a=n[2],s=c=u=void 0,f=S(a),(k(a)||f)&&(s=f?"":a.getSource().getSheet().name(),0<(r=f?1:a.getRangeCount()))&&(u=(f?m:g)(a),c=n[3]),l=d(n[4]||"{}"),h={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})h.hasOwnProperty(p)&&l.hasOwnProperty(p)&&(l[h[p]]=l[p]);return 1===(n=(f=new w.SparklineSetting(l)).options).maxAxisType&&(n.maxAxisType=0),1===n.minAxisType&&(n.minAxisType=0),{data:i,dataSheetName:e,dataOrientation:o,dateAxisData:u,dateAxisDataSheetName:s,dateAxisOrientation:c,sparklineType:v,displayDateAxis:u&&!A(c),setting:f,values:L(t,0,!0),dateValues:L(a,0,!0)}}},n.u9t=1,n.acceptsReference=_,n.acceptsArray=_,n}function Et(n,t,e,r,i,o,a){var u,c,s,f,l,h,a,u=w.Sparkline.EMt,c=a.sheet,s=c.parent.getSheetFromName(t.dataSheetName),f=c.parent.getSheetFromName(t.dateAxisDataSheetName),l=t.setting,h=(l=l&&l.options?l:new w.SparklineSetting(l)).options.displayHidden,a={sparklineType:t.sparklineType,displayDateAxis:t.displayDateAxis,zoomFactor:a.zoomFactor,values:u(t.values,s||c,h,t.data,t.dataOrientation),dateValues:u(t.dateValues,f||c,h,t.dateAxisData,t.dateAxisOrientation,!0),settings:l,getColor:function(n){if(c&&n){var t=b.Pf.vl(c,n);if(t)return t}return n}};(new K).paint(n,a,e,r,i,o)}function Lt(){return nt.call(this)||this}function Rt(){return tt.call(this)||this}function Ft(){return et.call(this)||this}function jt(){return rt.call(this)||this}function It(){return it.call(this)||this}function Pt(n,t,e,r,i,o,a,u){if(!(A(n)||A(t)||A(e)||A(r))&&!(N(n)||N(t)||N(e)||N(r))&&!(r<=e||t<e||r<t||n<e||r<n)&&(A(a)||0===a||1===a||2===a)){if(0===a||A(a)){if(!A(i)&&!A(o)&&(N(o)||N(i)||o<=i||i<-180||180<o))return;if(!A(u)&&(N(u)||1<u||u<0))return}return 1}}function I(n,t,e){return{value:n,font:t,label:e,normalFontHeight:B(t),normalFontWidth:V(e,t),fontAfterZoom:null}}function P(n){n&&(s[n.name()]=n)}t=this&&this.__extends||(Mn=function(n,t){return(Mn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}Mn(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),p=this&&this.__assign||function(){return(p=Object.assign||function(n){for(var t,e,r,i,e=1,r=arguments.length;e<r;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.jMt=n.GaugeKPISparkline=n.RangeBlockSparkline=n.WinlossSparkline=n.ColumnSparkline=n.LineSparkline=n.ImageSparkline=n.HistogramSparkline=n.YearSparkline=n.MonthSparkline=n.ParetoSparkline=n.CascadeSparkline=n.BoxPlotSparkline=n.LollipopVariSparkline=n.VariSparkline=n.VBarSparkline=n.HBarSparkline=n.StackedSparkline=n.SpreadSparkline=n.BulletSparkline=n.ScatterSparkline=n.AreaSparkline=n.PieSparkline=n.SparklineEx=n.SparklineExValue=void 0,x=h("CalcEngine"),b=h("Core"),l=h("Common"),w=h("./dist/plugins/sparkline/sparkline-wrapper.js"),k=x.Convert.LE,S=x.Convert.Nh,i=x.Functions&&x.Functions.Function,o=x.Functions&&x.Functions.Mmt,A=l.Common.lt.ht,D=l.Common.lt.OMt,e=(H=b.GC$).extend,K=l.Sparklines.SparklineRender,g=l.Sparklines.SparklineExRenders,O=x.Errors.Value,B=b.util.vt,V=b.q.Wt,c=b.W.V,C=Math.floor,a=Math.min,r=null,N=isNaN,y=parseFloat,W=NaN,X="12px Calibri",Y="PIESPARKLINE",z="AREASPARKLINE",J="SCATTERSPARKLINE",U="BULLETSPARKLINE",Z="SPREADSPARKLINE",q="STACKEDSPARKLINE",Q="HBARSPARKLINE",$="VBARSPARKLINE",nn="VARISPARKLINE",tn="LOLLIPOPVARISPARKLINE",en="BOXPLOTSPARKLINE",rn="CASCADESPARKLINE",on="PARETOSPARKLINE",an="MONTHSPARKLINE",un="YEARSPARKLINE",cn="LINESPARKLINE",sn="COLUMNSPARKLINE",fn="WINLOSSSPARKLINE",ln="RANGEBLOCKSPARKLINE",hn="GAUGEKPISPARKLINE",pn="HISTOGRAMSPARKLINE",vn="IMAGE",(u=m=m||{})[u.fit=0]="fit",u[u.entireFit=1]="entireFit",u[u.originFit=2]="originFit",u[u.custom=3]="custom",ft.prototype.toString=function(){return this.name===vn?this.value.altText+"":""},dn=ft,n.SparklineExValue=dn,F.prototype.name=function(){return this.Zc},F.prototype.createFunction=function(){return r},F.prototype.paint=function(n,t,e,r,i,o,a){},F.prototype.toJSON=function(){var n,t,n={};for(t in this)this.hasOwnProperty(t)&&(n[t]=this[t]);return n},F.prototype.fromJSON=function(n){if(n)for(var t in n)A(n[t])||(this[t]=n[t])},n.SparklineEx=u=F,t(lt,Gn=u),e((n.PieSparkline=gn=lt).prototype,{createFunction:function(){var n=new i(Y,1,255);return n.evaluate=function(n){var t,e,t=n[0],e=E(t,!0);return e.length<=0&&!A(t)&&e.push(t),{values:e,colors:Array.prototype.slice.call(n,1)}},n.acceptsReference=f,n.acceptsArray=f,n.u9t=1,n},paint:g[Y]}),t(ht,Tn=u),e((n.AreaSparkline=mn=ht).prototype,{createFunction:function(){var n=new i(z,1,7);return n.evaluate=function(n){return{points:E(n[0],!0),mini:n[1],maxi:n[2],line1:n[3],line2:n[4],colorPositive:n[5],colorNegative:n[6]}},n.acceptsReference=f,n.acceptsArray=f,n.u9t=1,n},paint:g[z]}),t(pt,Dn=u),e((n.ScatterSparkline=wn=pt).prototype,{createFunction:function(){var n=new i(J,1,18);return n.evaluate=function(n){var t,e;return{points1:L(n[0],0,!0),points2:L(n[1],0,!0),minX:n[2],maxX:n[3],minY:n[4],maxY:n[5],hLine:n[6],vLine:n[7],xMinZone:n[8],xMaxZone:n[9],yMinZone:n[10],yMaxZone:n[11],tags:n[12],drawSymbol:n[13],drawLines:n[14],color1:n[15],color2:n[16],dash:n[17]}},n.acceptsReference=at,n.acceptsArray=at,n.u9t=1,n},paint:g[J]}),t(vt,Hn=u),e((n.BulletSparkline=kn=vt).prototype,{createFunction:function(){var n=new i(U,3,17);return n.evaluate=function(n){return{measure:R(n[0]),target:R(n[1]),maxi:R(n[2]),good:R(n[3]),bad:R(n[4]),forecast:R(n[5]),tickUnit:R(n[6]),colorScheme:n[7],vertical:n[8],measureColor:n[9],targetColor:n[10],maxiColor:n[11],goodColor:n[12],badColor:n[13],forecastColor:n[14],allowMeasureOverMaxi:n[15],barSize:n[16]}},n.acceptsReference=function(n){return 0<=n&&n<=6},n.u9t=1,n},paint:g[U]}),t(dt,Kn=u),e((n.SpreadSparkline=bn=dt).prototype,{createFunction:function(){function l(n){for(var t,e,r,i,o,t=[],r=0,i=0,o=n.length;r<o;r++)e=y(n[r]),!N(e)&&isFinite(e)&&(t[i]=e,i++);return t}function h(n){for(var t,e,r,i,o,a,t={},e=0,r=void 0,i=n.length;e<i;e++)t[r=n[e]]?t[r]++:t[r]=1;for(a in o=[],t)t.hasOwnProperty(a)&&o.push({key:y(a),value:t[a]});return o.sort(function(n,t){return n.key-t.key})}var n=new i(Z,1,7);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,f,t=E(n[0],!0),r=[];if(!A(t)&&(r=h(t=l(t)),3===(e=n[4])))for(i=0,o=r.length;i<o;i++){for(u=(a=r[i]).value,c=[],s=Math.max(100,10*u),f=0;f<s+u-1;f++)c.push(Math.random());a.randomNumbers=c}return{spreadData:r,showAverage:n[1],scaleStart:n[2],scaleEnd:n[3],style:e,colorScheme:n[5],vertical:n[6]}},n.acceptsReference=f,n.acceptsArray=f,n.u9t=1,n},paint:g[Z]}),t(gt,Bn=u),e((n.StackedSparkline=Sn=gt).prototype,{createFunction:function(){var n=new i(q,1,13);return n.evaluate=function(n){return{points:E(n[0],!0),colorRange:E(n[1],!0),labelRange:E(n[2],!0),maximum:n[3],targetRed:n[4],targetGreen:n[5],targetBlue:n[6],targetYellow:n[7],color:n[8],highlightPosition:n[9],vertical:n[10],textOrientation:n[11],textSize:n[12]}},n.acceptsReference=ut,n.acceptsArray=ut,n.u9t=1,n},paint:g[q]}),t(mt,Vn=u),e((n.HBarSparkline=Cn=mt).prototype,{createFunction:function(){var n=new i(Q,1,4);return n.evaluate=function(n){return{value:R(n[0]),colorScheme:n[1],axisVisible:n[2],barHeight:n[3]}},n.acceptsReference=f,n.u9t=1,n},paint:g[Q]}),t(wt,Wn=u),e((n.VBarSparkline=yn=wt).prototype,{createFunction:function(){var n=new i($,1,4);return n.evaluate=function(n){return{value:R(n[0]),colorScheme:n[1],axisVisible:n[2],barWidth:n[3]}},n.acceptsReference=f,n.u9t=1,n},paint:g[$]}),t(kt,Xn=u),e((n.VariSparkline=xn=kt).prototype,{createFunction:function(){var n=new i(nn,1,10);return n.evaluate=function(n){return{variance:R(n[0]),reference:R(n[1]),mini:R(n[2]),maxi:R(n[3]),mark:R(n[4]),tickUnit:R(n[5]),legend:n[6],colorPositive:n[7],colorNegative:n[8],vertical:n[9]}},n.acceptsReference=function(n){return 0<=n&&n<=5},n.u9t=1,n},paint:g[nn]}),t(bt,Yn=u),e((n.LollipopVariSparkline=An=bt).prototype,{createFunction:function(){var n=new i(tn,3,13);return n.evaluate=function(n){var n={plannedValue:E(n[0],!0),actualValue:E(n[1],!0),index:R(n[2]),absolute:R(n[3]),reference:R(n[4]),mini:R(n[5]),maxi:R(n[6]),tickUnit:R(n[7]),legend:n[8],colorPositive:n[9],colorNegative:n[10],lollipopHeaderColor:n[11],vertical:n[12]};return St(n)?n:O},n.acceptsReference=function(n){return 2!==n&&0<=n&&n<=7},n.acceptsArray=at,n.u9t=1,n},paint:g[tn]}),t(Ct,zn=u),e((n.BoxPlotSparkline=On=Ct).prototype,{createFunction:function(){function e(n,t){return k(n)&&!N(t)&&0<=t&&t<=100?o.PERCENTILE.evaluate(n,t/100):W}function r(n){return k(n)?o.STDEVP.evaluate(n):W}var n=new i(en,1,10);return n.evaluate=function(n){var t=n[0];return{points:E(t,!0),boxPlotClass:n[1],showAverage:n[2],scaleStart:R(n[3]),scaleEnd:R(n[4]),acceptableStart:R(n[5]),acceptableEnd:R(n[6]),colorScheme:n[7],style:n[8],vertical:n[9],perc02:e(t,2),perc09:e(t,9),perc10:e(t,10),perc90:e(t,90),perc91:e(t,91),perc98:e(t,98),q1:e(t,25),q3:e(t,75),median:e(t,50),stDev:r(t)}},n.acceptsReference=f,n.acceptsArray=f,n.u9t=1,n},paint:g[en]}),t(yt,Jn=u),e((n.CascadeSparkline=Nn=yt).prototype,{createFunction:function(){var n=new i(rn,1,10);return n.evaluate=function(n){return{points:E(n[0],!0),pointIndex:R(n[1]),labels:E(n[2],!0),minimum:R(n[3]),maximum:R(n[4]),colorPositive:n[5],colorNegative:n[6],vertical:n[7],itemTypeRange:E(n[8],!0),colorTotal:n[9]}},n.acceptsReference=ot,n.acceptsArray=ot,n.u9t=1,n},paint:g[rn]}),t(xt,Un=u),e((n.ParetoSparkline=_n=xt).prototype,{createFunction:function(){var n=new i(on,2,12);return n.evaluate=function(n){return{points:E(n[0],!0),pointIndex:R(n[1]),colorRange:E(n[2],!0),target:R(n[3]),target2:R(n[4]),highlightPosition:R(n[5]),label:n[6],vertical:n[7],targetColor:n[8],target2Color:n[9],labelColor:n[10],barSize:n[11]}},n.acceptsReference=_,n.acceptsArray=_,n.u9t=1,n},paint:g[on]}),t(At,Zn=u),e((n.MonthSparkline=En=At).prototype,{createFunction:function(){var n=new i(an,3,7);return n.evaluate=function(n){var t,e,r,i,r,o,a,u,c,s,f,l,l,t=n[0],e=n[1],r=n[2],i=r;for((k(r)||S(r))&&(i=L(r,0,!0)),r=n[3],o=[],(k(r)||S(r))&&(o=L(r,0,!0)),a=[],u=[],c=0,s=i.length;c<s;c++)(f=i[c])&&(l="string"==typeof(l=f[0])?new Date(l):l)&&l.getFullYear()===t&&l.getMonth()+1===e&&(a[l=l.getDate()-1]=f[1],0<o.length)&&(u[l]=o[c][0]);return 0<o.length?{year:t,month:e,values:a,colors:u}:{year:t,month:e,values:a,emptyColor:r,startColor:n[4],middleColor:n[5],endColor:n[6]}},n.acceptsReference=ct,n.acceptsArray=ct,n.u9t=1,n},paint:g[an]}),t(j,qn=u),j.daysOfMonth=function(n,t){switch(t){case 2:var e;return n%4==0&&n%100!=0||n%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},j.dayInYear=function(n){for(var t,e,r,i,t=n.getFullYear(),e=n.getMonth(),r=n.getDate(),i=1;i<e+1;i++)r+=j.daysOfMonth(t,i);return r},d=j,e((n.YearSparkline=d).prototype,{createFunction:function(){var n=new i(un,2,6);return n.evaluate=function(n){var t,e,r,e,i,o,a,u,c,s,f,f,t=n[0],e=n[1],r=e;for((k(e)||S(e))&&(r=L(e,0,!0)),e=n[2],i=[],(k(e)||S(e))&&(i=L(e,0,!0)),o=[],a=[],u=0,c=r.length;u<c;u++)(s=r[u])&&(f="string"==typeof(f=s[0])?new Date(f):f)&&f.getFullYear()===t&&(o[f=d.dayInYear(f)-1]=s[1],0<i.length)&&(a[f]=i[u][0]);return 0<i.length?{year:t,values:o,colors:a}:{year:t,values:o,emptyColor:e,startColor:n[3],middleColor:n[4],endColor:n[5]}},n.acceptsReference=st,n.acceptsArray=st,n.u9t=1,n},paint:g[un]}),t(Ot,Qn=u),e((n.HistogramSparkline=Ln=Ot).prototype,{createFunction:function(){var f,n,f=this,n=new i(pn,1,9);return n.acceptsArray=function(){return!0},n.evaluate=function(n){var t,e,t,r,i,o,a,u,c,n,s,t=n[0],e=[];if(!(t instanceof x.CalcArray||t instanceof x.CalcReference))throw x.CalcError;if(e=f.RMt(t),t=n[1],A(t)&&(t=!0),r=!0===n[2],i=n[3],(i=A(i)?1:i)<=0)throw x.CalcError;if(o=n[4],1<(o=A(o)?1:o)||o<=0)throw x.CalcError;return a=n[5]||"#5B9BD5",u=n[6],c=n[7]||"#000000",n=n[8]||"#C0C0C0",{values:s=t?f.BMt(e,i):f.LMt(e),continuous:t,paintLabel:r,barWidth:o,barColor:a,labelFontStyle:u,labelColor:c,edgeColor:n}},n.acceptsReference=function(n){return 0===n},n.u9t=1,n},RMt:function(n){var t,e,r,t=[];if(n instanceof x.CalcArray)for(e=n.toArray(1),r=0;r<e.length;r++)t.push(e[r]);else(e=L(n,0)).forEach(function(n){n.forEach(function(n){A(n)||"number"!=typeof n||isNaN(n)||t.push(n)})});return t},BMt:function(n,t){var e,r,i,o,a,u,c,n,s,f,e=[],r=0,i=this;for(n.forEach(function(n){e[r]=n,r++}),o=[],a=c=e[0],e.forEach(function(n){a=Math.min(n,a),c=Math.max(n,c)}),u=C(a/t)*t,n=Math.ceil(c/t)*t,s=1!==e.length?Math.round((n-u)/t):1,r=0;r<s;r++)o[r]=l.Common.st.E8(r*t+u,15);for(o[r-1]<=c&&(o[r]=o[r-1]+t),f=[],r=0,s=o.length-1;r<s;r++)f[r]={value:0};for(0<f.length&&(f[0].axis="["+o[0]+","+o[1]+"]"),r=1;r<o.length-1;r++)A(o[r+1])?f[r].axis="("+o[r]+","+(o[r]+t)+"]":f[r].axis="("+o[r]+","+o[r+1]+"]";return e.forEach(function(n){var n=i.FMt(o,n);f[n].value++}),0<f.length&&0===f[0].value&&f.splice(0,1),f},LMt:function(n){for(var t,e,r,i,o,t,t=this,e={},r=0,i=n.length;r<i;++r)o=n[r],void 0===e[o]?e[o]=1:e[o]++;return(t=t.PMt(e)).sort(function(n,t){return n-t}),t.map(function(n){return{axis:n,value:e[n]}})},PMt:function(n){var t,e,t=[];for(e in n)n.hasOwnProperty(e)&&void 0!==n[e]&&null!==n[e]&&t.push(e);return t},FMt:function(n,t){var e,r,i,o,a,e=n.length;if(n[0]===t)return 0;if(0===e)return 0;r=0,o=C((i=e-1)/2);do{if(t>n[a=o]&&t<=n[o+1])return o}while(t<=n[o]?o=C(((i=o)+r)/2):t>n[o+1]&&(o=C(((r=o)+i)/2)),a!==o)},paint:function(n,t,e,r,i,o,a){var u,c,u,c,u=t.labelFontStyle,c=a.zoomFactor;A(u)&&(u=n.font),u=b.W.V(u,c),c=b.W.Ne(u.font),t.afterZoomFontStyle={fontStyle:c.fontStyle,fontFamily:c.fontFamily,fontSize:c.fontSize,fontWeight:c.fontWeight,fontPixelSize:u.fontSize},g[pn](n,t,e,r,i,o,a)}}),t(Nt,$n=u),e((n.ImageSparkline=Rn=Nt).prototype,{createFunction:function(){var n=new i(vn,1,11);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,f,n,t=n[0],e=n[1],r=n[2],i=n[3],o=n[4],a=n[5]||0,u=n[6]||0,c=n[7],s=n[8],f=n[9],n=n[10];if("string"!=typeof(e=A(e)?"":e)&&(e=""+e),-1===[0,1,2].indexOf(f)&&(f=void 0),-1===[0,1,2].indexOf(n)&&(n=void 0),r===m.custom){if(A(i)&&A(o))throw x.CalcError}else if(!A(i)||!A(o))throw x.CalcError;if(i<0||o<0)throw x.CalcError;return u=u<0?0:u,a=a<0?0:a,c=c<0?0:c,s=s<0?0:s,{url:t,altText:e,drawType:r=-1===[0,1,2,3].indexOf(r)?0:r,height:i,width:o,clipY:a,clipX:u,clipWidth:s,clipHeight:c,vAlign:f,hAlign:n}},n},GMt:function(n,t,e,r,i){var o,a,u,c,n,s,f,l,n,t,h,p,e,v,d,o=n.width,a=n.height,u=n.x,c=n.y,n=t.width,s,f={clipX:0,clipY:0,clipHeight:t.height,clipWidth:n,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if((l=o/a)<(n=(f=this.UMt(f,t,e)).clipWidth/f.clipHeight))switch(t=r.vAlign,f.paintWidth=o,f.paintHeight=h=o/n,f.paintX=u,t){case b.VerticalAlign.top:f.paintY=c;break;case b.VerticalAlign.center:f.paintY=c+(p=a-h)/2;break;case b.VerticalAlign.bottom:f.paintY=c+a-h}else switch(e=r.hAlign,f.paintHeight=a,f.paintWidth=v=a*n,f.paintY=c,e){case b.HorizontalAlign.left:f.paintX=u;break;case b.HorizontalAlign.center:f.paintX=u+(d=o-v)/2;break;case b.HorizontalAlign.right:f.paintX=u+o-v}return f},HMt:function(n,t,e,r,i){var n={cutX:0,cutY:0,cutHeight:t.width,cutWidth:t.height,paintX:n.x,paintY:n.y,paintHeight:n.height,paintWidth:n.width};return this.UMt(n,t,e)},UMt:function(n,t,e){var r,t,i,o,r=t.width,t=t.height,i=e.clipX||0,o=e.clipY||0;return A(e.clipX)||(n.clipX=a(e.clipX,r)),A(e.clipY)||(n.clipY=a(e.clipY,t)),A(e.clipWidth)?n.clipWidth=r-n.clipX:n.clipWidth=e.clipWidth+i>r?r-i:e.clipWidth,A(e.clipHeight)?n.clipHeight=t-n.clipY:n.clipHeight=e.clipHeight+o>t?t-o:e.clipHeight,n},zMt:function(n,t,e,r,i){var o,a,u,c,s,n,t,e,f,i,l,h,p,r,v,d,g,m,o=n.width,a=n.height,u=n.x,c=n.y,s={imgWidth:t.width,imgHeight:t.height,offsetX:0,offsetY:0},n=(s=this.VMt(s,t,e)).imgWidth,t=s.imgHeight,e=s.offsetX,f=s.offsetY,l=t*i,h={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},p=r.hAlign,r=r.vAlign;if(o<(i=n*i)){switch(h.paintWidth=o,h.paintX=u,v=(i-o)/i*n,p){case b.HorizontalAlign.left:h.clipX=s.offsetX;break;case b.HorizontalAlign.center:h.clipX=s.offsetX+v/2;break;case b.HorizontalAlign.right:h.clipX=s.offsetX+v}h.clipWidth=o}else{switch(h.clipWidth=n,h.clipX=0,d=o-(h.paintWidth=i),p){case b.HorizontalAlign.general:case b.HorizontalAlign.left:h.paintX=u;break;case b.HorizontalAlign.center:h.paintX=u+d/2;break;case b.HorizontalAlign.right:h.paintX=u+d}h.clipX+=e}if(a<l){switch(h.paintY=c,g=(l-(h.paintHeight=a))/l*t,r){case b.VerticalAlign.top:h.clipY=s.offsetY;break;case b.VerticalAlign.center:h.clipY=s.offsetY+g/2;break;case b.VerticalAlign.bottom:h.clipY=s.offsetY+g}h.clipHeight=a}else{switch(h.clipHeight=t,h.clipY=0,m=a-(h.paintHeight=l),r){case b.VerticalAlign.top:h.paintY=c;break;case b.VerticalAlign.center:h.paintY=c+m/2;break;case b.VerticalAlign.bottom:h.paintY=c+m}h.clipY+=f}return h},YMt:function(n,t,e,r,i){var o,a,a,i,u,c,s,f,l,n,t,h,p,v,r,d,g,m,d,w,k,o={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},a=t.width/t.height;if(A(t.customWidth)?t.customWidth=C(t.customHeight*a):A(t.customHeight)&&(t.customHeight=C(t.customWidth/a)),a=t.customWidth*i,i=t.customHeight*i,!(null===a||a<0||null===i||a<0)){if(u=n.width,c=n.height,s=n.x,f=n.y,l={imgWidth:t.width,imgHeight:t.height,offsetX:0,offsetY:0},n=(l=this.VMt(l,t,e)).imgWidth,t=l.imgHeight,h=l.offsetX,p=l.offsetY,v=r.hAlign,r=r.vAlign,u<a){switch(o.paintWidth=u,o.paintX=s,g=(d=(a-u)/a)*n,v){case b.HorizontalAlign.left:o.clipX=l.offsetX;break;case b.HorizontalAlign.center:o.clipX=l.offsetX+g/2;break;case b.HorizontalAlign.right:o.clipX=l.offsetX+g}o.clipWidth=l.imgWidth*(1-d)}else{switch(o.clipWidth=n,o.clipX=0,m=u-(o.paintWidth=a),v){case b.HorizontalAlign.general:case b.HorizontalAlign.left:o.paintX=s;break;case b.HorizontalAlign.center:o.paintX=s+m/2;break;case b.HorizontalAlign.right:o.paintX=s+m}o.clipX+=h}if(c<i){switch(o.paintY=f,w=(d=(i-(o.paintHeight=c))/i)*t,r){case b.VerticalAlign.top:o.clipY=l.offsetY;break;case b.VerticalAlign.center:o.clipY=l.offsetY+w/2;break;case b.VerticalAlign.bottom:o.clipY=l.offsetY+w}o.clipHeight=l.imgHeight*(1-d)}else{switch(o.clipHeight=A(e.clipHeight)?t:l.imgHeight,o.clipY=0,k=c-(o.paintHeight=i),r){case b.VerticalAlign.top:o.paintY=f;break;case b.VerticalAlign.center:o.paintY=f+k/2;break;case b.VerticalAlign.bottom:o.paintY=f+k}o.clipY+=p}}return o},VMt:function(n,t,e){var r=t.width,t=t.height;return A(e.clipX)||(n.offsetX=a(r,e.clipX)),A(e.clipY)||(n.offsetY=a(t,e.clipY)),A(e.clipWidth)?n.imgWidth=r-n.offsetX:n.imgWidth=e.clipWidth+n.offsetX>r?r-n.offsetX:e.clipWidth,A(e.clipHeight)?n.imgHeight=t-n.offsetY:n.imgHeight=e.clipHeight+n.offsetY>t?t-n.offsetY:e.clipHeight,n},paint:function(n,t,e,r,i,o,a){var u,c,e,r,s;if(!A(t)&&!A(t.url)&&D(t.url)&&""!==t.url.trim()){u=this,e={x:e,y:r,width:i,height:o},r=(c=a.sheet).BO();try{s=t.imageBase64Data||t.url,r.getState(s)?u.ZMt(n,t,e,a):r.addImage(s,n.nn0?"anonymous":void 0)}catch(n){}}},ZMt:function(n,t,e,r){var i,i,o,i,a,o,u,c,s,s,f,l,o,u,o,h,p,v,d,a=this,o=t.imageBase64Data||t.url,u=r.sheet,c=t.drawType,s=u.MC;if(o&&"string"==typeof o&&s.qh(o)){switch(f={width:(s=s.getImage(o)).width,height:s.height},l={clipY:t.clipY,clipX:t.clipX,clipWidth:t.clipWidth,clipHeight:t.clipHeight},u=(o=u.getActualStyle(r.rowIndex,r.columnIndex)).hAlign,o=o.vAlign,u===b.HorizontalAlign.general&&(u=b.HorizontalAlign.left),h={vAlign:null!=(i=null!=(i=t.vAlign)?i:o)?i:b.VerticalAlign.bottom,hAlign:null!=(i=null!=(o=t.hAlign)?o:u)?i:b.HorizontalAlign.left},v=r.zoomFactor,c){case m.fit:p=a.GMt(e,f,l,h,v);break;case m.entireFit:p=a.HMt(e,f,l,h,v);break;case m.originFit:p=a.zMt(e,f,l,h,v);break;case m.custom:f.customWidth=t.width,f.customHeight=t.height,p=a.YMt(e,f,l,h,v)}p.img=s,g[d="IMAGESPARKLINE"](n,p,e.x,e.y,e.width,e.height,r)}}}),t(Lt,nt=u),e((n.LineSparkline=Fn=Lt).prototype,{createFunction:function(){return _t(cn,0)},paint:Et}),t(Rt,tt=u),e((n.ColumnSparkline=jn=Rt).prototype,{createFunction:function(){return _t(sn,1)},paint:Et}),t(Ft,et=u),e((n.WinlossSparkline=In=Ft).prototype,{createFunction:function(){return _t(fn,2)},paint:Et}),t(jt,rt=u),e((n.RangeBlockSparkline=Pn=jt).prototype,{createFunction:function(){var n=new i(ln,2,2);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,i,e,e,t,t=n[0],e=t.source,r=e&&e.getSheet(),i=n[1],o=0,a=i.getSource().getSheet(),u=i.getRow(0),c=i.getColumn(0),s=i.getRowCount(0),i=i.getColumnCount(0),e=e&&e.getBaseRowCol?(e=e.getBaseRowCol(),new b.Range(e.row,e.col,1,1)):new b.Range(t.row,t.column,1,1),t=new b.Range(u,c,s,i);if(r&&r.name()===a.name()&&t.containsRange(e))throw x.CalcError;return{templateSheetName:a.name(),templateRange:{row:u,col:c,rowCount:s,colCount:i},bindingObject:n[2]}},n.isContextSensitive=function(){return!0},n.acceptsReference=f,n.u9t=1,n},paint:function(n,t,e,r,i,o,a){var u,c,s,f,l,f,u,f,u,l,u=t.templateSheetName,c=t.templateRange;if(u&&(l=!(l=(f=(s=a.sheet).parent)&&f.getSheetFromName(u))&&f?(f=f.getSheetTab(u))&&f.getSheet&&f.getSheet():l)){if(!v){if(!(u=h("CellTypes")))return;v=u.qY,G=u.$Y,T=u.paintRangeTemplate}f=(new v).yN(l,c),u=(new G).yN(l,c),l=p({},a),a.isPrinting&&(l.printZoomFactor=a.zoomFactor),T(n,{x:e,y:r,width:i,height:o},t.bindingObject,l,f,u.tZ)}}}),t(It,it=u),e((n.GaugeKPISparkline=t=It).prototype,{createFunction:function(){var n=new i(hn,4,255);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,f,l,h,p,v,d,g,m,w,k,b,S,C,u,w,y,r,t=[],e=n.length,f=R(n[0]),l=R(n[1]),h=R(n[2]),p=R(n[3]),v=R(n[5]),d=R(n[6]),g=R(n[7]),m=R(n[8]),w=R(n[10]),k=R(n[11]),b=R(n[12]),S=n[4],C=n[13];if(!Pt(f,l,h,p,w,k,C,b))return O;for(n[9]instanceof x.CalcArray&&(i=(u=n[9].toArray(2))[0],o=u[1],a=u[2],u=u[3]),i=i||"16px Calibri",o=o||"bold 22px Calibri",a=a||X,u=u||X,v=A(v)?f:v,d=A(d)?l:d,g=A(g)?h:g,m=A(m)?p:m,w={minAngle:A(w)?-90:w,maxAngle:A(k)?90:k,radiusRatio:A(b)?0:b,targetValueOption:I(f,i,v),currentValueOption:I(l,o,d),minValueOption:I(h,a,g),maxValueOption:I(p,u,m),gaugeType:A(C)?0:C,ranges:void 0,showLabel:!!A(S)||Boolean(S)},y=14;y<e;y++)if((r=n[y])instanceof x.CalcArray){if(c=(r=r.toArray(0))[0],s=r[1],A(c)||A(s)||N(c)||N(s)||s<c||c<h||p<c||p<s||s<h)return O;t.push({start:c,end:s,color:r[2]})}return w.ranges=t,w},n.acceptsArray=function(n){return 9===n||14<=n},n.acceptsReference=function(n){return n<=3&&0<=n||5<=n&&n<=8||10<=n&&n<=12},n.u9t=1,n},paint:function(n,t,e,r,i,o,a){var u=a.zoomFactor;t.currentValueOption.fontAfterZoom=c(t.currentValueOption.font,u).font,t.targetValueOption.fontAfterZoom=c(t.targetValueOption.font,u).font,t.minValueOption.fontAfterZoom=c(t.minValueOption.font,u).font,t.maxValueOption.fontAfterZoom=c(t.maxValueOption.font,u).font,g[hn](n,t,e,r,i,o,a)}}),s={},n.jMt=s,i&&(P(new gn),P(new mn),P(new wn),P(new kn),P(new bn),P(new Sn),P(new Cn),P(new yn),P(new xn),P(new An),P(new On),P(new Nn),P(new _n),P(new En),P(new d),P(new Fn),P(new jn),P(new In),P(new Pn),P(new t),P(new Ln),P(new Rn)),e(b.Workbook.prototype,{addSparklineEx:function(n){this.WMt||(this.WMt={});var t=this.WMt;n&&(t[n.name()]=n,this.$Dr({type:"addSparklineEx",sparklineEx:n}))},getSparklineEx:function(n){var t,t,t=s[n];return t||(t=this.WMt)&&t[n]},removeSparklineEx:function(n){var t=this.WMt;null!=t&&t[n]&&(delete t[n],this.$Dr({type:"removeSparklineEx",name:n}))}}),b.Workbook.ch("sparklineEx",{toJson:function(n){var t,e,r,i,o,t=this.WMt,e=[];if(t){for(r in t)t.hasOwnProperty(r)&&(o=(i=t[r]).toJSON())&&o.typeName&&e.push(o);0<e.length&&(n.sparklineExs=e)}},fromJson:function(n){var t,e,r,i,i,t=n.sparklineExs;if(t)for(e=0;e<t.length;e++)r=t[e],(i=(0,b.getTypeFromString)(r.typeName))&&((i=new i).fromJSON(r),this.addSparklineEx(i))},wh:function(n,t,e){var r,i,o,a,u,r=this.WMt,i=[];if(r){for(o in r)r.hasOwnProperty(o)&&(u=(a=r[o]).toJSON())&&u.typeName&&i.push(u);0<i.length&&(n.workbook.lossless.sparklineExs=i)}},yh:function(n,t,e){var n,r,i,o,a,a,n=n.workbook.lossless,r=n&&n.sparklineExs;if(r)for(i=0;i<r.length;i++)o=r[i],(a=(0,b.getTypeFromString)(o.typeName))&&((a=new a).fromJSON(o),this.addSparklineEx(a))}})},"./dist/plugins/sparkline/sparkline-wrapper.js":function(M,n,t){var e,A,c,G,w,t,a,T,u,r,i,o,s,f,D,N,O,l,g,y,H,K,B,x,C,_,h,V,W,X,Y,z,J,p,v,d,U,Z,q,Q,$,t,l,m,k,nn,tn,b,S,l,t,l,t,l,t,l;function en(n,t,e,r){var i,n,t,i,n=w.formulaToRanges(n,t,e,r)[0],t=n&&n.ranges&&n.ranges[0];return t?{range:t,sheetName:n.sheetName}:x}function rn(n){var t,e,n,t=n.lastIndexOf("!");return-1===t?[n]:(e=n.substring(0,t),n=n.substring(t+1),[e=on(e)?e.substring(1,e.length-1):e,n])}function on(n){return 2<=n.length&&"'"===n[0]&&"'"===n[n.length-1]}function an(n,t,e,r){var i,o,i=this,o=i.RB;o._K(n,t,r),r&&(o.add(r.group()),i.$Dr({type:"addSparklineForGroup",row:n,col:t,sparkline:r})),i.Rj("sparkline",n,t,3,e,r)}function E(n){this.QMt=[],this.Mf=n,this.cE={},this.KMt=[],this.JMt=[]}function un(n,t){return n+"_"+t}function cn(n,t,e){return e?n>e.row+e.rowCount-1?e:n>e.row?N(e.row,e.col,e.rowCount+t,e.colCount):N(e.row+t,e.col,e.rowCount,e.colCount):x}function sn(n,t,e){return e?n>e.col+e.colCount-1?e:n>e.col?N(e.row,e.col,e.rowCount,e.colCount+t):N(e.row,e.col+t,e.rowCount,e.colCount):x}function fn(n,t,e,r,i){var o,a,a,u,o,c,s,f,l,h,p,v,d,g,m,w,k,b,S,u=new A.Rf,o=null==(o=i.Mf)?void 0:o.parent;for(null!=(a=null==o?void 0:o.suspendOp)&&a.call(o),c=0;c<n.length;c++){if(f=(s=n[c]).XMt,s.displayDateAxis){if(O(s.dateAxisData())&&s.dateAxisData(s.qMt),l=void 0,(h=s.dateAxisData())instanceof A.Range)l=L(t,e,r,h);else for(p=0;p<h.length;p++)l.push.apply(l,L(t,e,r,h[p]));s.dateAxisData(l)}for(p=0;p<f.length;p++)v=f[p],t<=(d=r?v.row:v.column)&&(u.set(c,p,v),i._K(v.row,v.column,x),r?v.row+=e:v.column+=e),O(v.data())&&v.data(v.gI),g=void 0,(m=v.data())instanceof A.Range?(g=L(t,e,r,m),v.data(g)):v.data(v.gI)}for(w=0;w<n.length;w++)for(b=(k=n[w]).XMt,S=0;S<b.length;S++)i.$Mt(u.get(w,S));null!=(a=null==o?void 0:o.resumeOp)&&a.call(o)}function ln(n,t,e,r,i,o){for(var a,u,c,s,f,l,h,p,v,d,g,m,w,k,a=0;a<r.length;a++)if((u=r[a]).displayDateAxis){if(s=(c=u.tCt()).Ut,f=!1,o&&!s.G8&&(s.G8=[],f=!0),O(u.dateAxisData())&&u.dateAxisData(u.qMt),l=void 0,(h=u.dateAxisData())instanceof A.Range)l=L(n,t,e,h);else for(p=0;p<h.length;p++)l.push.apply(l,L(n,t,e,h[p]));u.dateAxisData(l),f&&(o.push({sheetName:c.name(),changes:s.G8}),s.G8=C)}for(p=0;p<i.length;p++)g=(d=(v=i[p]).Tp()).Ut,m=!1,o&&!g.G8&&(g.G8=[],m=!0),O(v.data())&&v.data(v.gI),w=void 0,(k=v.data())instanceof A.Range?(w=L(n,t,e,k),v.data(w)):v.data(v.gI),m&&(o.push({sheetName:d.name(),changes:g.G8}),g.G8=C)}function L(n,t,e,r){var e,e=(e?cn:sn)(n,t,r);return e}function hn(n,t,e){var n=vn(e.col,e.col+e.colCount-1,n,n+t-1);return n?N(e.row,n.start,e.rowCount,n.end-n.start+1):x}function pn(n,t,e){var n=vn(e.row,e.row+e.rowCount-1,n,n+t-1);return n?N(n.start,e.col,n.end-n.start+1,e.colCount):x}function vn(n,t,e,r){var i,o,a,u,u,c,s,i=-1;if(r<n)return{start:i=n-(u=r-e+1),end:o=t-u};if(t<e)return{start:i=n,end:o=t};if(e<=n){for(u=t-n+1,c=0,a=n;a<=r&&a<=t;a++)c++;return{start:i=e,end:o=i+u-c-1}}for(s=0,a=n;a<=t;a++)-1===i&&(a<e||r<a)&&(i=a),(a<e||r<a)&&s++;return-1!==i&&0<s?{start:i,end:o=i+s-1}:x}function dn(n,t,e,r,i){var o,a,a,u,c,s,o,f,l,h,p,v,d,g,m,w,w,k,b,S,C,u=new A.Rf,c=n.length,s=0,o=null==(o=i.Mf)?void 0:o.parent;for(null!=(a=null==o?void 0:o.suspendOp)&&a.call(o),f=c-1;-1<f;f--){if((l=n[f]).displayDateAxis){if(O(l.dateAxisData())&&l.dateAxisData(l.qMt),h=void 0,(p=l.dateAxisData())instanceof A.Range)h=R(t,e,r,p);else for(v=0;v<p.length;v++)h.push.apply(h,R(t,e,r,p[v]));if(O(h)){l.clear(),i.remove(l);continue}l.dateAxisData(h)}for(d=(d=[]).concat(l.XMt),g=y(d),s=_(g,s),v=g-1;-1<v;v--)m=d[v],t<=(w=r?m.row:m.column)&&w<t+e&&O(m.gI)?(l.remove(m),i._K(m.row,m.column,x)):(t<=w&&(i._K(m.row,m.column,x),r?m.row-=e:m.column-=e,u.set(f,v,m)),O(m.data())&&m.data(m.gI),w=void 0,w=(k=m.data())instanceof A.Range?R(t,e,r,k):(m.data(m.gI),m.data()),O(w)?l.remove(m):m.data(w));l.count()<=0&&i.remove(l)}for(S=0;S<c;S++)for(C=0;C<s;C++)(b=u.get(S,C))&&i.$Mt(b);null!=(a=null==o?void 0:o.resumeOp)&&a.call(o)}function R(n,t,e,r){var e,e=(e?pn:hn)(n,t,r);return e}function gn(n,t,e,r,i,o){for(var a,u,c,s,f,l,h,p,v,d,g,m,w,k,b,S,S,a,u=r.length-1;-1<u;u--)if((c=r[u]).displayDateAxis){if(f=(s=c.tCt()).Ut,l=!1,o&&!f.G8&&(f.G8=[],l=!0),O(c.dateAxisData())&&c.dateAxisData(c.qMt),h=void 0,(p=c.dateAxisData())instanceof A.Range)h=R(n,t,e,p);else for(v=0;v<p.length;v++)h.push.apply(h,R(n,t,e,p[v]));O(h)?(c.clear(),c.RB.remove(c)):c.dateAxisData(h),l&&(o.push({sheetName:s.name(),changes:f.G8}),f.G8=C)}for(v=(d=i.length)-1;-1<v;v--)w=(m=(g=i[v]).Tp()).Ut,k=!1,o&&!w.G8&&(w.G8=[],k=!0),O(g.data())&&g.data(g.gI),b=void 0,b=(S=g.data())instanceof A.Range?R(n,t,e,S):(g.data(g.gI),g.data()),O(b)?((S=g.group()).remove(g),S.count()<=0&&S.RB.remove(S)):g.data(b),k&&(o.push({sheetName:m.name(),changes:w.G8}),w.G8=C)}function F(n){var e=this;e.options=Y(m,function(n,t){e.$Dr(n,t)},x),e.Zp(n),e.eJ=x,e.L_r=new A.EventNotifier}function j(n,t){var e=this;e.assignId(),e.displayDateAxis=!1,e.RB=x,e.XMt=[],e.nCt=x,e.eCt=1,e.qMt=x,(e.setting=t)&&t.F_r(e.fEr.bind(e)),e.sparklineType=n}function mn(n,t){var e=!1;return"setting"===n||"axisReference"===n?e=t===x:"displayDateAxis"===n?e=!1===t:"axisOrientation"===n?e=1===t:"sparklines"===n&&(e=0===t.length),e}function I(n,t,e,r,i,o,a){var u=this;u.assignId(),u.row=n,u.column=t,u.iCt=r,u._data=e,u.rCt=new b(i,o),u.rCt.add(u),u.gI=a}function wn(n,t){var e,t,e=n.parent,t=n.getCustomName(t)||e.getCustomName(t);if(!O(t))return w.formulaToRanges(n,w.expressionToFormula(n,t.getExpression()),0,0,1===e.options.referenceStyle)}function P(n){var e,r,e=[],r=[];return n.forEach(function(n){e=e.concat(n.ranges);for(var t=0;t<n.ranges.length;t++)r.push(n.sheetName)}),{ranges:e,sheetName:r}}function kn(n){var t=n.row,e=n.col,r=n.rowCount,n=n.colCount;return new A.Range(t,e,r,n)}e=this&&this.__assign||function(){return(e=Object.assign||function(n){for(var t,e,r,i,e=1,r=arguments.length;e<r;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.Sparkline=n.SparklineGroup=n.DataOrientation=n.SparklineType=n.SparklineSetting=n.SparklineAxisMinMax=n.EmptyValueStyle=void 0,A=t("Core"),c=t("Common"),G=t("CalcEngine"),w=t("SheetsCalc"),t=A.mt,a=t.xr,T=t.Hue,u=A.range_parser.Dc,r=A.NodeHelper.ar,i=A.NodeHelper.ur,o=t.d1,s=t.h1,f=A.range_parser.Oc,D=A.GC$.isEmptyObject,N=A.Ec,O=c.Common.lt.ht,l=c.Common.Uf,g=l.VP,y=l.tR,H=l.OS,K=c.Sparklines.oCt,B=c.Sparklines.SparklineRender,x=null,C=void 0,_=Math.max,h=Number.MAX_VALUE,V=A.UsedRangeUtil.vh,W=t.vo,X=t.n1,Y=t.b0,z=A.GC$.each,J=A.GC$.extend,(l=p=p||{})[l.line=0]="line",l[l.column=1]="column",l[l.stacked=2]="stacked",(t=v=v||{})[t.span=2]="span",t[t.gap=0]="gap",t[t.zero=1]="zero",(l=d=d||{})[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",A.GC$.extend(A.Y8.prototype,{aCt:function(n){var t,e,r,i,o,a,t,e=this.G8,r=arguments[1];if(e){switch(e.originalSparklines||(e.originalSparklines=[]),i={type:n},n){case 0:a=void 0,a=r&&r.sparkline?r.sparkline:x,i.changeInfo={row:r.row,col:r.col,sparkline:a};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:i.changeInfo=r}e.originalSparklines.push(i)}},uCt:function(n){var t,e,r,i,o,a,u,c,s,f,l,h,p,v,d,t=this,e=n.changeInfo;switch(n.type){case 12:e.sparkline?(e.sparkline.row=e.row,e.sparkline.column=e.col,t.RB._K(e.row,e.col,e.sparkline)):t.RB._K(e.row,e.col,x);break;case 0:t.RB._K(e.row,e.col,e.sparkline),e.sparkline&&!t.RB.contains(e.sparkline.group())&&t.RB.add(e.sparkline.group());break;case 1:for(a=o=i=void 0,u=y(e),c=0;c<u;c++)i=e[c].row,o=e[c].col,a=t.RB.sCt(i,o),0===c&&a.rCt.count()===u&&t.RB.remove(a.rCt),this.RB.add(a.group(e[c].group).rCt);break;case 2:for(s=[],f=0;f<y(e);f++)s.push(t.RB.sCt(e[f].row,e[f].col));t.RB.Mf.groupSparkline(s);break;case 3:(r=t.RB.sCt(e.row,e.col)).sparklineType(e.sparklineType);break;case 4:(r=t.RB.sCt(e.row,e.col)).setting(e.setting);break;case 5:e.sparkline.data(e.data);break;case 15:(r=t.RB.sCt(e.row,e.col)).dataSheetName(e.dataSheetName);break;case 6:(r=t.RB.sCt(e.row,e.col)).dataOrientation(e.dataOrientation);break;case 7:(r=t.RB.sCt(e.row,e.col)).displayDateAxis(e.displayDateAxis);break;case 8:l=void 0,l=(h=e.rangeInfo)&&N(h.row,h.col,h.rowCount,h.colCount),e.group.dateAxisData(l);break;case 16:e.group.dateAxisDataSheetName(e.dateAxisDataSheetName);break;case 9:e.group.dateAxisOrientation(e.dateAxisOrientation);break;case 10:for((p=e.group.XMt).forEach(function(n){t.RB.cCt(n)}),e.group.XMt=e.innerList,v=e.group.XMt,d=0;d<y(v);d++)v[d].group(e.group);v.forEach(function(n){t.RB.fCt(n)});break;case 11:(r=t.RB.sCt(e.row,e.col)).group(e.group);break;case 13:g(t.RB.groups(),e),t.RB.lCt(e);break;case 14:t.RB.groups().push(e),t.RB.hCt(e)}},dCt:function(n){for(var t,e,t,e=y(n)-1;0<=e;e--)this.uCt(n[e])},vCt:function(n,t){this.RB.JO(n,t)},mCt:function(n,t){this.RB.xP(n,t)},gCt:function(n,t){this.RB.qO(n,t)},pCt:function(n,t){this.RB.NP(n,t)},bCt:function(n,t,e,r){this.RB.clear(n,t,e,r)},yCt:function(){var n=this.G8;return n?(n.wCt||(n.wCt=[]),n.wCt):x}}),A.Y8.ch("sparkline",{init:function(){var n=this.Mf;this.RB=new q(n)},undo:function(n){var t,e,t,t=n.originalSparklines;t&&this.dCt(t),e=this.Mf,(t=n.wCt)&&t.forEach(function(n){var t;e.parent.getSheetFromName(n.sheetName).Ut.undo(n.changes)})}}),A.Worksheet.ch("sparkline",U={init:function(){this.RB=this.Ut.RB},getUsedRange:function(n){var t,e,r;n.type&A.UsedRangeType.sparkLine&&(r=(e=(t=this).RB).getUsedRange(),V(n.range,r))},dispose:function(n){var n;!1!==n.clearCache&&((n=this).RB&&(n.RB.Mf=x,n.RB.evaluator=x,n.RB=x),n.Ut)&&(n.Ut.RB=x)},onLayoutChanged:function(n){var t,e,r,i,o,a,t;!O(n.sheetArea)&&3!==n.sheetArea||(t=n.changeType,e=n.row,r=n.rowCount,i=n.col,o=n.colCount,a=this.Ut,"addRows"===t?a.vCt(e,r):"deleteRows"===t?a.mCt(e,r):"addColumns"===t?a.gCt(i,o):"deleteColumns"===t?a.pCt(i,o):"clear"===t&&(t=n.type,3===n.sheetArea)&&16==(16&t)&&a.bCt(e,i,r,o))},onLayoutChangedFromOp:function(n){var t,e,r,i,n,o;!O(n.sheetArea)&&3!==n.sheetArea||(t=n.changeType,e=n.row,r=n.rowCount,i=n.col,n=n.colCount,o=this.Ut,"addRows"===t?o.vCt(e,r):"deleteRows"===t?o.mCt(e,r):"addColumns"===t?o.gCt(i,n):"deleteColumns"===t&&o.pCt(i,n))},toJson:function(n,t){var e;t&&t.ignoreStyle||(n.sparklineGroups=this.RB.toJSON(t))},wh:function(n,t,e){var r,e,n,r;(!e||!1!==e.includeStyles)&&(e=this.RB.wh(),n=a(n,A.XFileConstants.Au),0<e.c_.length)&&n.c_.push({n_:"ext",c_:[e],r_:[0,1]})},fromJson:function(n,t,e){var e,r,i,o,o,e=e&&e.ignoreStyle,r,i=this.RB,o=n.sparklineGroupManager,o=t?o&&o.groups:n.sparklineGroups;o&&!e&&i.AP(o,t)},yh:function(n,t,e){var r,i,o,n,n,r=e&&!1===e.includeStyles,i,o=this.RB,n=T(a(n,"extLst"),"sparklineGroups"),n=n&&n.c_;n&&!r&&(o.MCt(n,e),o.groups().forEach(function(n){n.XMt.forEach(function(n){o.$Mt(n)})}))},setName:function(n){var t=n.oldName,n=n.newName;this.RB.CCt(t,n)}}),A.GC$.extend(A.Worksheet.prototype,Z={getSparkline:function(n,t){return this.RB?this.RB.sCt(n,t):x},setSparkline:function(n,t,e,r,i,o,a,u){var c,o,s,f,l,h,p,v,d,l,g,m,p,c,e,r,i,h,s=this,f;if(!s.RB)return x;if("string"==typeof e&&(p=en(s,e,n,t),v=s.getCustomName(e)||s.parent.getCustomName(e),d=void 0,(d=O(v)?d:w.formulaToRanges(s,w.expressionToFormula(s,v.getExpression(),n,t,1===s.parent.options.referenceStyle)))?(h=e,e=g=(l=P(d)).ranges,l=m=l.sheetName):p&&(e=p.range,l=p.sheetName),!p)&&!d)return x;if(null!=(c=null==(p=s.parent)?void 0:p.suspendOp)&&c.call(p),c=new S(n,t,e,r,i,o,h),l&&l!==s.name()&&c.dataSheetName(l),a&&!O(u)){if(e=void 0,"string"==typeof a&&(r=en(s,a,n,t),v=s.getCustomName(a)||s.parent.getCustomName(a),d=void 0,(d=O(v)?d:w.formulaToRanges(s,w.expressionToFormula(s,v.getExpression(),n,t,1===s.parent.options.referenceStyle)))?(c.group().qMt=a,a=g=(i=P(d)).ranges,e=m=i.sheetName):r&&(a=r.range,e=r.sheetName),!r)&&!d)return x;c.dateAxisData(a),e&&e!==s.name()&&c.dateAxisDataSheetName(e),c.dateAxisOrientation(u),c.group().displayDateAxis=!0}return null!=(o=null==p?void 0:p.resumeOp)&&o.call(p),h=s.getSparkline(n,t),s.removeSparkline(n,t),an.call(s,n,t,h,c),s.zw(),c},SCt:function(n,t,e){var r,i=this.getSparkline(n,t);an.call(this,n,t,i,e)},removeSparkline:function(n,t){var e,r,i,o,a,e=this,r=e.RB;r&&(i=e.getSparkline(n,t),e.Ut.aCt(0,o={row:n,col:t,sparkline:i}),i&&((a=i.group()).remove(i),a.count()<=0&&r.remove(a),an.call(e,n,t,i,x,a)),e.zw())},groupSparkline:function(n){var t,e,e,t,r,i,o,a,u,c,s,f,r=this,i=r.RB;if(!i)return x;for(o=x,a=[],u=r.Ut.G8!==C,null!=(e=null==(t=r.parent)?void 0:t.suspendOp)&&e.call(t),c=0;c<n.length;c++)(s=n[c])&&(u&&a.push({group:s.group().clone(),row:s.row,col:s.column}),o?((f=s.group()).remove(s),o.add(s),f.count()<=0&&i.remove(f)):o=s.group());return null!=(t=null==(e=r.parent)?void 0:e.resumeOp)&&t.call(e),o&&r.$Dr({type:"groupSparkline",group:o}),r.zw(),r.Ut.aCt(1,a),o},ungroupSparkline:function(n){var t,e,r,i,o,a,u,c,t=this,e=t.RB;if(e&&n){for(i=[],o=t.Ut.G8!==C,r=(r=[]).concat(n.XMt),a=0;a<r.length;a++)(u=r[a])&&(o&&i.push({row:u.row,col:u.column}),n.remove(u),c=n.clone(),e.add(c),c.add(u));e.remove(n),t.Ut.aCt(2,i),t.zw()}}}),E.prototype.getUsedRange=function(){var n,t,e,r,i,o,a,u,c,s,n,t=this.cE,e={};if(t)for(a=o=i=void 0,u=0,c=r=Object.keys(t);u<c.length;u++)o=(i=t[s=c[u]]).row,a=i.column,V(e,{minRow:o,minCol:a,maxRow:o,maxCol:a});return e},E.prototype.AP=function(n,t){var e=this;e.fromJSON(n,t),e.groups().forEach(function(n){n.XMt.forEach(function(n){e.$Mt(n)})})},E.prototype.MCt=function(n,t){var e,r,e=this,r=e.Mf;e.yh(n,t),e.groups().forEach(function(n){n.XMt.forEach(function(n){e.$Mt(n),n.row>=r.getRowCount()&&r.setRowCount(n.row+1),n.column>=r.getColumnCount()&&r.setColumnCount(n.column+1)})})},E.prototype.$Mt=function(n){n&&this._K(n.row,n.column,n)},E.prototype._K=function(n,t,e){var r;this.Mf.Ut.G8&&(r={row:n,col:t,sparkline:this.sCt(n,t),newSparkline:e},this.Mf.Ut.aCt(12,r)),e?this.cE[n+"_"+t]=e:delete this.cE[n+"_"+t]},E.prototype.sCt=function(n,t){return this.cE[n+"_"+t]||x},E.prototype.groups=function(n){if(0===arguments.length)return this.QMt;this.QMt=n},E.prototype.add=function(n){var t=this,e=t.Mf;e.Ut.aCt(13,n),t.groups().push(n),e.$Dr({type:"addSparklineGroup",group:n}),n.RB=t,n.TCt(),t.hCt(n)},E.prototype.hCt=function(n){var t=this;t.ACt(n),n.all().forEach(function(n){t.fCt(n)})},E.prototype.remove=function(n){var t=this,e=t.Mf;e.Ut.aCt(14,n),g(t.groups(),n),e.$Dr({type:"removeSparklineGroup",group:n}),t.lCt(n)},E.prototype.lCt=function(n){var t=this;t.ICt(n),n.all().forEach(function(n){t.cCt(n)})},E.prototype.contains=function(n){return H(this.groups(),n)},E.prototype.count=function(){return this.groups().length},E.prototype.JO=function(n,t){fn(this.QMt,n,t,!0,this),ln(n,t,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.qO=function(n,t){fn(this.QMt,n,t,!1,this),ln(n,t,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.xP=function(n,t){dn(this.QMt,n,t,!0,this),gn(n,t,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.NP=function(n,t){dn(this.QMt,n,t,!1,this),gn(n,t,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.CCt=function(t,e){this.JMt.forEach(function(n){n.dateAxisDataSheetName()===t&&n.dateAxisDataSheetName(e)}),this.KMt.forEach(function(n){n.dataSheetName()===t&&n.dataSheetName(e)})},E.prototype.fCt=function(n){var t,e,t,e,t=this.Mf,e=n.dataSheetName();e&&e!==t.name()&&(t=t.parent&&t.parent.getSheetFromName(e))&&(e=t.RB.KMt).indexOf(n)<0&&e.push(n)},E.prototype.cCt=function(n){var t,t,t,n,t=n.dataSheetName();t&&(t=this.Mf.parent.getSheetFromName(t))&&0<=(n=(t=t.RB.KMt).indexOf(n))&&t.splice(n,1)},E.prototype.ACt=function(n){var t,e,t,e,t=this.Mf,e=n.dateAxisDataSheetName();e&&e!==t.name()&&(t=t.parent.getSheetFromName(e))&&(e=t.RB.JMt).indexOf(n)<0&&e.push(n)},E.prototype.ICt=function(n){var t,t,t,n,t=n.dateAxisDataSheetName();t&&(t=this.Mf.parent.getSheetFromName(t))&&0<=(n=(t=t.RB.JMt).indexOf(n))&&t.splice(n,1)},E.prototype.clear=function(n,t,e,r){var i,o,a,u,c,s,f,l,h,p,i=this;if(0===arguments.length){for(o=i.QMt,a=y(o)-1;-1<a;a--)if(u=o[a]){for(c=u.count()-1;-1<c;c--)s=u.XMt[c],i._K(s.row,s.column,x),u.remove(s);i.remove(u)}}else for(f=n;f<n+e;f++)for(l=t;l<t+r;l++)(h=i.Hq(f,l))&&(i._K(h.row,h.column,x),(p=h.group()).remove(h),0===p.count())&&i.remove(p)},E.prototype.Hq=function(n,t){for(var e,r,i,o,a,e=this.QMt,r=0;r<e.length;r++)for(i=e[r],o=0;o<i.count();o++)if((a=i.XMt[o])&&a.row===n&&a.column===t)return a;return x},E.prototype.lEr=function(n){for(var t,e,r,i,o,t=this.QMt,e=0;e<t.length;e++)for(r=t[e],i=0;i<r.count();i++)if((o=r.XMt[i])&&o.jKe()===n)return o;return x},E.prototype.hEr=function(n){for(var t,e,r,t=this.QMt,e=0;e<t.length;e++)if((r=t[e])&&r.jKe()===n)return r;return x},E.prototype.tE=function(n,t,e,r,i,o,a,u){var c,s,f,l,h,p,v,d,g,m,w,k,b,S,C,y,y,x,x,c=this,s=c.Mf;if(s){for(f=new A.Rf,l=e-n,h=r-t,d=s.getRowCount(),g=s.getColumnCount(),k=i,b=o,S=s.RB,C=!u&&s.o5(),m=p=0;p<i&&e+p<d;p++)if(C&&0===s.getRowHeight(e+p))i++;else{if(!(a&&s.XT&&s.XT(e+p)))for(w=v=0,o=b;v<o&&r+v<g;v++)C&&0===s.getColumnWidth(r+v)?o++:((y=s.getSparkline(n+m,t+w))&&((y=y.clone()).row=e+p,y.column=r+v,O(y.dateAxisData())&&y.dateAxisData(y.group().qMt),x=y.dateAxisData(),C&&(l=e-n+p-m,h=r-t+v-w),!O(x)&&c.xCt(x,l,h,d,g)&&O(y.group().customName)&&y.dateAxisData(x.offset(h,l)),O(y.data())&&y.data(y.gI),x=y.data(),!O(x)&&c.xCt(x,l,h,d,g)&&O(y.gI)&&y.data(x.offset(h,l)),c.add(y.group()),f.set(p,v,y)),w++);m++}for(p=0,i=k;p<i&&e+p<d;p++)if(C&&0===s.getRowHeight(e+p))i++;else if(!(a&&s.XT&&s.XT(e+p)))for(v=0,o=b;v<o&&r+v<g;v++)C&&0===s.getColumnWidth(r+v)?o++:S._K(e+p,r+v,f.get(p,v))}},E.prototype.xCt=function(n,t,e,r,i){var n,o,a,u,n,n=this.NCt(n);return!(!n||(o=_(n.row,0),a=_(n.col,0),u=n.row<0?r:n.rowCount,n=n.col<0?i:n.colCount,o+t<0)||a+e<0||r<o+u+t||i<a+n+e)},E.prototype.iE=function(n,t,e,r,i,o){var a,u,c,s,f,l,h,p,v,d,g,m,w,a=this.Mf;if(a){for(s=a.o5(),f=o,l=i,this.kCt(n,t,e,r,i,o),h=a.RB,p=new A.Rf,g=a.getRowCount(),m=a.getColumnCount(),u=v=0;v<i&&v+e<g;v++)if(s&&0===a.getRowHeight(e+v))i++;else{for(c=d=0,o=f;d<o&&r+d<m;d++)s&&0===a.getColumnWidth(r+d)?o++:((w=a.getSparkline(n+u,t+c))&&(w.row=e+v,w.column=r+d,p.set(u,c,w)),h._K(n+u,t+c,x),c++);u++}for(u=v=0,i=l;v<i&&v+e<g;v++)if(s&&0===a.getRowHeight(e+v))i++;else{for(c=d=0,o=f;d<o&&r+d<m;d++)s&&0===a.getColumnWidth(r+d)?o++:(a.removeSparkline(e+v,r+d),h._K(e+v,r+d,p.get(u,c)),c++);u++}}},E.prototype.kCt=function(n,t,e,r,i,o,a){var u,c,a,s,f,l,h,p,v,d,g,m,w,k,b,S,C,y,x,A,O,u=this,a=(c=(u=a?a:u).Mf).o5(),s=N(n,t,i,o),h=o,m=c.getRowCount(),w=c.getColumnCount(),k=u.QMt;if(a)for(g=v=0;v<i&&v+e<m;v++)if(0===c.getRowHeight(e+v))i++;else{for(d=p=0,o=h;p<o&&p+r<w;p++)if(0===c.getColumnWidth(r+p))o++;else{if(b=c.getSparkline(n+g,t+d))for(f=e-n+v-g,l=r-t+p-d,C=(S=b.rCt).XMt,y=0;y<C.length;y++)(x=C[y])&&u.DCt(x,f,l,s);d++}g++}else for(f=e-n,l=r-t,y=0;y<k.length;y++)for(C=(A=k[y]).XMt,O=0;O<C.length;O++)(b=C[O])&&u.DCt(b,f,l,s)},E.prototype.DCt=function(n,t,e,r){var i,o,a,a,o,i=this;O(n.dateAxisData())&&n.dateAxisData(n.group().qMt),o=n.dateAxisData(),(a=i.NCt(o))&&r.containsRange(a)&&r.contains(n.row,n.column)&&n.dateAxisData(o.offset(e,t)),O(n.data())&&n.data(n.gI),a=n.data(),(o=i.NCt(a))&&r.containsRange(o)&&r.contains(n.row,n.column)&&n.data(a.offset(e,t))},E.prototype.NCt=function(n){return n},E.prototype.LB=function(n,t,e,r,i,o,a,u,c){var s,f,l,h,p,v,d,g,m,w,k,b,S,C,C,y,y,s=this,f=s.Mf;if(f)if(n===f)s.tE(t,e,r,i,o,a);else for(l=r-t,h=i-e,p=f.RB,v=!c&&f.o5(),d=f.getRowCount(),g=f.getColumnCount(),m=a,b=w=0;w<o&&r+w<d;w++)if(v&&0===f.getRowHeight(r+w))o++;else{if(!(u&&f.XT&&f.XT(r+w)))for(S=k=0,a=m;k<a&&i+k<g;k++)v&&0===f.getColumnWidth(i+k)?a++:((C=n.getSparkline(t+b,e+S))?((C=C.clone()).row=r+w,C.column=i+k,O(C.dateAxisData())&&C.dateAxisData(C.group().qMt),y=C.dateAxisData(),v&&(l=r+w-t-b,h=i-e+k-S),!O(y)&&s.xCt(y,l,h,d,g)&&C.dateAxisData(y.offset(h,l)),O(C.data())&&C.data(C.gI),y=C.data(),!O(y)&&s.xCt(y,l,h,d,g)&&C.data(y.offset(h,l)),s.add(C.group()),p._K(r+w,i+k,C)):p._K(r+w,i+k,x),S++);b++}},E.prototype.BB=function(n,t,e,r,i,o,a){var u,c,s,f,l,h,p,v,d,g,m,w,k,b,S,u=this,c=u.Mf;if(c)if(n===c)u.iE(t,e,r,i,o,a);else for(s=c.o5(),f=a,l=n.RB,h=c.RB,m=c.getRowCount(),w=c.getColumnCount(),u._Ct(n,t,e,r,i,o,a),d=p=0;p<o&&r+p<m;p++)if(s&&0===c.getRowHeight(r+p))o++;else for(g=v=0,a=f;v<a&&i+v<w;v++)s&&0===c.getColumnWidth(i+v)?a++:((k=n.getSparkline(t+0,e+0))?(k.row=r+p,k.column=i+v,S=(b=k.group()).clone(),b.remove(k),b.count()<=0&&l.remove(b),S.add(k),u.add(S),h._K(r+p,i+v,k)):h._K(r+p,i+v,x),l._K(t+0,e+0,x))},E.prototype._Ct=function(n,t,e,r,i,o,a){var u,c,u=this,c=u.Mf;n&&c&&u.kCt(t,e,r,i,o,a,n.RB)},E.prototype.toJSON=function(n){for(var t,e,r,t=this.QMt,e=[],r=0;t&&r<t.length;r++)e.push(t[r].toJSON(n));return 0===e.length?C:e},E.prototype.wh=function(){for(var n,t,e,r,i,n=this.QMt,t={n_:"sparklineGroups",c_:[],r_:[2]},e=0;n&&e<n.length;e++)i=(r=n[e]).wh(),t.c_.push(i);return t},E.prototype.fromJSON=function(n,t){var e,r,i;for(this.QMt.length=0,this.cE={},e=0;n&&e<n.length;e++)r=n[e],(i=new b).fromJSON(r,t),this.add(i)},E.prototype.yh=function(n,t){var e,r,i;for(this.QMt.length=0,this.cE={},e=0;n&&e<n.length;e++)r=n[e],(i=new b).yh(r,t),0<i.count()&&this.add(i)},q=E,(t=Q=n.EmptyValueStyle||(n.EmptyValueStyle={}))[t.gaps=0]="gaps",t[t.zero=1]="zero",t[t.connect=2]="connect",(l=$=n.SparklineAxisMinMax||(n.SparklineAxisMinMax={}))[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",t=c.Common.ft.j(255,149,179,215),l=c.Common.ft.j(255,36,64,98),m={axisColor:"black",firstMarkerColor:t,highMarkerColor:"Blue",lastMarkerColor:t,lowMarkerColor:"Blue",markersColor:l,negativeColor:"Brown",seriesColor:l,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},F.prototype.L0=function(){var n=this;n.L_r&&(n.L_r.destroy(),n.L_r=x),n.eJ=x},F.prototype.$Dr=function(n,t){var e,r=this.L_r;null!=r&&r.notify({propName:n,value:t})},F.prototype.F_r=function(n){var t,t,t=this;0===t.L_r.count()&&null!=(t=t.L_r)&&t.addListener(n)},F.prototype.dEr=function(n){var t,e,e;null!=(t=this.L_r)&&t.removeListener(n)},F.prototype.Zp=function(n){var e,n,e=this.options,n=n||{};n=J(!0,{},m,n),z(n,function(n,t){e.hasOwnProperty(n)&&(e[n]=t)})},F.prototype.clone=function(){return new F(this.options)},F.prototype.toJSON=function(){var n,t,e,r,n,t=this.options,e={};for(r in t)"_ps"!==r&&m[r]!==t[r]&&(e[r]=t[r]);return D(e)?C:e},k=F,n.SparklineSetting=k,(t=nn=n.SparklineType||(n.SparklineType={}))[t.line=0]="line",t[t.column=1]="column",t[t.winloss=2]="winloss",(l=tn=n.DataOrientation||(n.DataOrientation={}))[l.vertical=0]="vertical",l[l.horizontal=1]="horizontal",j.prototype.L0=function(){var n=this;n.setting&&(n.setting.dEr(n.fEr.bind(n)),n.setting.L0(),n.setting=x),n.XMt=x,n.RB=x},j.prototype.$Dr=function(n){var t=this.tCt();t&&t.$Dr(e({sparklineGroupId:this.jKe()},n))},j.prototype.fEr=function(n){this.vEr(e(e({},n),{isSetting:!0}))},j.prototype.vEr=function(n){this.$Dr(e({type:"updateSparklineGroup"},n))},j.prototype.gEr=function(n){for(var t,e,r,t,e=this.XMt,r=0;r<e.length;r++)if(e[r].jKe()===n)return e[r];return x},j.prototype.tCt=function(){var n=this,t;return t=n.RB?n.RB.Mf:t},j.prototype.ECt=function(){var n,t,n,n=this,t=n.tCt();t&&t.Ut.G8&&(n={group:n,innerList:n.XMt.concat()},t.Ut.aCt(10,n))},j.prototype.add=function(n){var t,e,t=this;n&&(t.ECt(),t.XMt.push(n),n.group(t),t.$Dr({type:"addSparklineForGroup",row:n.row,col:n.column,sparkline:n}),t.TCt(),(e=t.RB)&&e.fCt(n),t.onGroupChanged())},j.prototype.clear=function(){this.ECt();var t=this.RB;t&&this.XMt.forEach(function(n){t.cCt(n)}),this.XMt=[],this.$Dr({type:"clearSparklineForGroup",sparklineGroupId:this.jKe()})},j.prototype.all=function(){return this.XMt},j.prototype.remove=function(n){var t,e,r,t=this,e=t.XMt;return t.ECt(),g(e,n),n&&t.$Dr({type:"removeSparklineForGroup",sparklineGroupId:t.jKe(),sparklineId:n.jKe()}),n.onSparklineChanged(),n.rCt=t.clone(),t.TCt(),(r=t.RB)&&r.cCt(n),t.onGroupChanged(),e},j.prototype.contains=function(n){return H(this.XMt,n)},j.prototype.onGroupChanged=function(){var n,t,e,n=this.XMt;if(n)for(t=0;t<n.length;t++)(e=n[t])&&e.onSparklineChanged()},j.prototype.clone=function(){var n,t,t,n=this,t=n.setting?n.setting.clone():x,t=new j(n.sparklineType,t);return t.displayDateAxis=n.displayDateAxis,t.qMt=n.qMt,t.nCt=n.nCt,t.jCt=n.jCt,t.eCt=n.eCt,t},j.prototype.dateAxisData=function(n){var t,e,r,i,i,i,o,i,o,i,a,u,t=this;if(O(t.qMt)||t.OCt(),0===arguments.length)return t.nCt;if(r="string"==typeof n,(e=t.tCt())&&e.Ut.G8){if(r){if(i=e.getCustomName(n)||e.parent.getCustomName(n),O(i))return t.nCt;i=w.formulaToRanges(e,w.expressionToFormula(e,i.getExpression()),0,0,1===t.tCt().parent.options.referenceStyle),t.qMt=n,o=(i=P(i)).ranges,i=i.sheetName,n=o,t.jCt=i}i=o=void 0,o=t.nCt?{row:t.nCt.row,col:t.nCt.col,rowCount:t.nCt.rowCount,colCount:t.nCt.colCount}:x,i=n?{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount}:x,e.Ut.aCt(8,a={group:t,rangeInfo:o,newRangeInfo:i})}(u=t.nCt)!==(t.nCt=n)&&(r||t.vEr({propName:"dateAxisData",value:n}),t.onGroupChanged())},j.prototype.OCt=function(){var n,t,t,e,t,n=this;O(n.tCt())||(t=wn(n.tCt(),n.qMt),O(t))||(e=(t=P(t)).ranges,t=t.sheetName,n.nCt=e,n.jCt=t)},j.prototype.dateAxisDataSheetName=function(n){var t,e,r,i,t=this;return 0===arguments.length?t.jCt:(e=t.jCt,(r=t.tCt())&&r.Ut.G8&&r.Ut.aCt(16,i={group:t,dateAxisDataSheetName:e,newDateAxisDataSheetName:n}),e!==n&&(e&&r&&r.RB.ICt(t),t.jCt=n,t.vEr({propName:"dateAxisDataSheetName",value:n}),n&&r&&r.RB.ACt(t),t.onGroupChanged()),t)},j.prototype.dateAxisOrientation=function(n){var t,e,r,i,t=this;if(0===arguments.length)return t.eCt;(e=t.tCt())&&e.Ut.G8&&(r={group:t,dateAxisOrientation:t.eCt,newDateAxisOrientation:n},e.Ut.aCt(9,r)),(i=t.eCt)!==(t.eCt=n)&&(t.vEr({propName:"dateAxisOrientation",value:n}),t.onGroupChanged())},j.prototype.count=function(){return this.XMt.length},j.prototype.TCt=function(){var n,t,e,r,i,o,a,u,u,c,u,n=this,t=n.setting,e=n.XMt;if(t&&((r=t.options).groupMaxValue=-h,r.groupMinValue=h,i=1===r.maxAxisType,o=1===r.minAxisType,i||o))for(a=0;a<e.length;a++)u=e[a],c=(u=n.RCt(u)).min,u=u.max,i&&r.groupMaxValue<u&&(r.groupMaxValue=u),o&&r.groupMinValue>c&&(r.groupMinValue=c)},j.prototype.RCt=function(n){var t,e,r,i,o,a,u,c,s,t=-h,e=h;if(O(n.data())&&n.data(n.gI),r=n.data())for(o=(i=n.Tp())&&i.parent.getSheetFromName(n.dataSheetName()),a=n.BCt(r,n.dataOrientation(),!1,o||i),u=0;u<a.length;u++)"number"==typeof(c=(c=a[u])===K?0:c)&&(t=t<c?c:t,e=c<e?c:e);return{min:e,max:t}},j.prototype.toJSON=function(t){var n,e,r,i,o,a,u,n=this,e={setting:n.setting?n.setting.toJSON():x,displayDateAxis:n.displayDateAxis,sparklineType:n.sparklineType,axisOrientation:n.eCt,sparklines:n.XMt.map(function(n){return n.toJSON(t)})},r=n.nCt,i=n.qMt;for(a in i?e.axisReference=i:r&&(e.axisReference={row:r.row,col:r.col,rowCount:r.rowCount,colCount:r.colCount,sheetName:n.jCt}),o={},e)!e.hasOwnProperty(a)||mn(a,u=e[a])||(o[a]=u);return D(o)?C:(null!=t&&t.isServer&&(o.__ID__=n.jKe()),o)},j.prototype.wh=function(){var n,t,e,r,r,e,n={n_:"sparklineGroup"},t=this,e=t.tCt();return O(t.sparklineType)||(n.type=p[t.sparklineType]),t.displayDateAxis&&(n.dateAxis="1"),r=t.setting.options,!O(r.lineWeight)&&.001<3*r.lineWeight.toString()/4-.75&&(n.lineWeight=3*r.lineWeight.toString()/4),r.displayEmptyCellsAs?n.displayEmptyCellsAs=v[r.displayEmptyCellsAs]:n.displayEmptyCellsAs=v[0],r.showMarkers&&(n.markers="1"),r.showHigh&&(n.high="1"),r.showLow&&(n.low="1"),r.showFirst&&(n.first="1"),r.showLast&&(n.last="1"),r.showNegative&&(n.negative="1"),r.displayXAxis&&(n.displayXAxis="1"),r.displayHidden&&(n.displayHidden="1"),r.rightToLeft&&(n.rightToLeft="1"),r.minAxisType&&(n.minAxisType=d[r.minAxisType]),r.maxAxisType&&(n.maxAxisType=d[r.maxAxisType]),r.manualMin&&(n.manualMin=r.manualMin),r.manualMax&&(n.manualMax=r.manualMax),n.c_=[s(r.seriesColor||"rgba(36,64,98,1.0)",!1,"colorSeries"),s(r.negativeColor||"brown",!1,"colorNegative"),s(r.axisColor||"black",!1,"colorAxis"),s(r.markersColor||"rgba(36,64,98,1.0)",!1,"colorMarkers"),s(r.firstMarkerColor||"rgba(149,179,215,1.0)",!1,"colorFirst"),s(r.lastMarkerColor||"rgba(149,179,215,1.0)",!1,"colorLast"),s(r.highMarkerColor||"blue",!1,"colorHigh"),s(r.lowMarkerColor||"blue",!1,"colorLow")],(r=t.nCt)&&n.c_.push({n_:"f",c_:[(t.jCt?(0,A.qTe)(t.jCt):e.name())+"!"+f([N(r.row,r.col,r.rowCount,r.colCount)])]}),e={n_:"sparklines",c_:t.XMt.map(function(n){return n.wh()})},n.c_.push(e),n},j.prototype.fromJSON=function(n,t){var e,r,i,o,a,u,c,s,f;if(n&&(e=this,r=n.displayDateAxis,i=n.sparklineType,o=n.axisReference,a=n.axisOrientation,u=n.sparklines,n.__ID__&&e.UKn(n.__ID__),e.setting=new k(n.setting),e.setting&&e.setting.F_r(e.fEr.bind(e)),O(r)||(e.displayDateAxis=r),O(i)||(e.sparklineType=i),O(o)||("string"==typeof o?e.qMt=o:(e.nCt=N(o.row,o.col,o.rowCount,o.colCount),e.jCt=o.sheetName)),O(a)||(e.eCt=a),u))for(e.XMt=[],c=0,s=u.length;c<s;c++)(f=new S).fromJSON(u[c]),e.add(f)},j.prototype.yh=function(n,r){var i,t,t,e,t,e,t,e,t,e,i=this,t=i.LCt(n);i.setting=new k(t),i.setting&&i.setting.F_r(i.fEr.bind(i)),t="1"===n.dateAxis,e=p[n.type]||0,O(t)||(i.displayDateAxis=t),O(e)||(i.sparklineType=e),(t=a(n,"f"))&&(t=(e=t.c_&&t.c_[0])&&rn(e))&&(e=u(t[1])[0]||x,O(e)||(i.nCt=N(e.row,e.col,e.rowCount,e.colCount),t=1===e.rowCount?1:0,O(t))||(i.eCt=t)),(e=a(n,"sparklines"))&&(i.XMt=[],e.c_.forEach(function(n){var t,e,t=new S,e;!1!==t.yh(n,r)&&i.add(t)}))},j.prototype.LCt=function(n){var t={};return O(n.manualMax)||(t.manualMax=r(n.manualMax,0)),O(n.manualMin)||(t.manualMin=r(n.manualMin,0)),O(n.lineWeight)||(t.lineWeight=4*r(n.lineWeight,1)/3),O(n.displayEmptyCellsAs)||(t.displayEmptyCellsAs=v[n.displayEmptyCellsAs]||0),O(n.markers)||(t.showMarkers=i(n.markers,!1)),O(n.high)||(t.showHigh=i(n.high,!1)),O(n.low)||(t.showLow=i(n.low,!1)),O(n.first)||(t.showFirst=i(n.first,!1)),O(n.last)||(t.showLast=i(n.last,!1)),O(n.negative)||(t.showNegative=i(n.negative,!1)),O(n.displayXAxis)||(t.displayXAxis=i(n.displayXAxis,!1)),O(n.displayHidden)||(t.displayHidden=i(n.displayHidden,!1)),O(n.rightToLeft)||(t.rightToLeft=i(n.rightToLeft,!1)),O(n.minAxisType)||(t.minAxisType=d[n.minAxisType]||0),O(n.maxAxisType)||(t.maxAxisType=d[n.maxAxisType]||0),n.c_.forEach(function(n){"colorSeries"===n.n_&&(t.seriesColor=o(n)||"rgba(36,64,98,255)"),"colorNegative"===n.n_&&(t.negativeColor=o(n)||"Brown"),"colorAxis"===n.n_&&(t.axisColor=o(n)||"Black"),"colorMarkers"===n.n_&&(t.markersColor=o(n)||"rgba(36,64,98,255)"),"colorFirst"===n.n_&&(t.firstMarkerColor=o(n)||"rgba(149,179,215,255)"),"colorLast"===n.n_&&(t.lastMarkerColor=o(n)||"rgba(149,179,215,255)"),"colorHigh"===n.n_&&(t.highMarkerColor=o(n)||"Blue"),"colorLow"===n.n_&&(t.lowMarkerColor=o(n)||"Blue")}),t},b=j,n.SparklineGroup=b,(0,A.qDr)(b),I.prototype.$Dr=function(n,t){var e=this.Tp();e&&e.$Dr({type:"updateSparkline",sparklineGroupId:this.rCt.jKe(),sparklineId:this.jKe(),propName:n,value:t})},I.prototype.group=function(n){var t,e,e,r,i,t=this;return 0===arguments.length?((e=t.rCt)||((e=new b).add(t),t.rCt=e),e):(e=t.rCt,(r=t.Tp())&&r.Ut.G8&&(i={row:t.row,col:t.column,group:e,newGroup:n},r.Ut.aCt(11,i)),n!==e&&(e&&e.remove(t),(t.rCt=n)&&!n.contains(t)&&n.add(t),t.onSparklineChanged(),r)&&r.zw(),t)},I.prototype.sparklineType=function(n){var t,e,r,e,r,t=this;return 0===arguments.length?t.group().sparklineType:((r=(e=t.group()).sparklineType)!==n&&(e.sparklineType=n,e.vEr({propName:"sparklineType",value:n}),(e=t.Tp())&&e.Ut.G8&&(r={row:t.row,col:t.column,sparklineType:r,newSparklineType:n},e.Ut.aCt(3,r)),t.onSparklineChanged(),e)&&e.zw(),t)},I.prototype.onSparklineChanged=function(){var n,t,n=this,t=n.Tp();t&&t.ki(A.Events.SparklineChanged,{sheet:t,sheetName:t.name(),sparkline:n})},I.prototype.setting=function(n){var t,e,r,i,o,i,a,u,t=this,e=t.group(),r=t.Tp(),i=r&&r.Ut.G8;if(0===arguments.length)return o=void 0,o=i?A.GC$.extend(!0,{},e.setting):e.setting;if(i&&(i={row:t.row,col:t.column,setting:A.GC$.extend(!0,{},e.setting),newSetting:A.GC$.extend(!0,{},n)},r.Ut.aCt(4,i)),e.setting){if(n.options)for(a in n.options)"_ps"!==a&&n.options.hasOwnProperty(a)&&(u=n.options[a])!==e.setting.options[a]&&(e.setting.options[a]=u)}else(e.setting=n)&&e.setting.F_r(e.fEr.bind(t));return r&&r.zw(),t},I.prototype.data=function(n){var t,e,r,i,r,i,r,i,t=this;if(O(t.gI)||t.FCt(),e=t.Tp(),0===arguments.length)return O(t.gI)?t._data:O(e)||(r=e.getCustomName(t.gI)||e.parent.getCustomName(t.gI),O(r))?[]:((i=w.formulaToRanges(e,w.expressionToFormula(e,r.getExpression()),t.row,t.column,1===e.parent.options.referenceStyle))[0]&&t._data!==i[0].ranges&&(t._data=i[0].ranges,t.onSparklineChanged()),t._data);if("string"==typeof n){if(t.gI=n,!e)return t;if(r=e.getCustomName(n)||e.parent.getCustomName(n),i=void 0,O(r))return t;i=(r=P(i=w.formulaToRanges(e,w.expressionToFormula(e,r.getExpression()),t.row,t.column,1===e.parent.options.referenceStyle))).ranges,r=r.sheetName,n=i,t.ZY=r,t.$Dr("dataSheetName",r)}return e&&e.Ut.G8&&(i={row:t.row,col:t.column,sparkline:t,data:kn(t._data),newData:kn(n)},e.Ut.aCt(5,i)),t._data!==n&&(t._data=n,t.$Dr("data",n),t.onSparklineChanged(),e)&&e.zw(),t},I.prototype.dataSheetName=function(n){var t,e,r,i,t,e=this;return 0===arguments.length?e.ZY:(r=e.ZY,(i=e.Tp())&&(null==(t=i.name)?void 0:t.call(i))===n||(i&&i.Ut.G8&&(t={row:e.row,col:e.column,dataSheetName:r,newDataSheetName:n},i.Ut.aCt(15,t)),r!==n&&(r&&i&&i.RB.cCt(e),e.ZY=n,e.$Dr("dataSheetName",n),n&&i&&i.RB.fCt(e),e.onSparklineChanged())),e)},I.prototype.dataOrientation=function(n){var t,e,r,t=this;return 0===arguments.length?t.iCt:((e=t.Tp())&&e.Ut.G8&&(r={row:t.row,col:t.column,dataOrientation:t.iCt,newDataOrientation:n},e.Ut.aCt(6,r)),t.iCt!==n&&(t.iCt=n,t.$Dr("dataOrientation",n),t.onSparklineChanged(),e)&&e.zw(),t)},I.prototype.dateAxisData=function(n){var t=this,e=t.group();return 0===arguments.length?(O(e.dateAxisData())&&e.dateAxisData(e.qMt),e.dateAxisData()):(e.dateAxisData(n),t)},I.prototype.dateAxisDataSheetName=function(n){var t=this,e=t.group();return 0===arguments.length?e.dateAxisDataSheetName():(e.dateAxisDataSheetName(n),t)},I.prototype.dateAxisOrientation=function(n){var t=this,e=t.group();return 0===arguments.length?e.dateAxisOrientation():(e.dateAxisOrientation(n),t)},I.prototype.displayDateAxis=function(n){var t,e,r,i,o,t=this,e=t.group();return 0===arguments.length?e.displayDateAxis:((r=t.Tp())&&r.Ut.G8&&(i={row:t.row,col:t.column,displayDateAxis:e.displayDateAxis,newDisplayDateAxis:n},r.Ut.aCt(7,i)),(o=e.displayDateAxis)!==(e.displayDateAxis=n)&&e.vEr({propName:"displayDateAxis",value:n}),t)},I.prototype.clone=function(){var n,t,n=this,t=new I;return t.row=n.row,t.column=n.column,O(n.gI)?t.data(n.data()):t.gI=n.gI,t.dataSheetName(n.dataSheetName()),t.dataOrientation(n.dataOrientation()),t.group(n.group().clone()),t},I.prototype.paintSparkline=function(n,t,e,r,i){var o,a,u,c,u,o=this,a=o.Tp();this.O_r&&(a=this.O_r),O(o.data())&&!O(o.gI)&&o.data(o.gI),O(o.dateAxisData())&&o.dateAxisData(o.group().qMt),u=o.PCt(!0),c=o.PCt(!1),u={sparklineType:o.sparklineType(),displayDateAxis:o.displayDateAxis(),zoomFactor:a.zoom(),values:u,dateValues:c,settings:o.setting(),getColor:function(n){if(a&&n){var t=A.Pf.vl(a,n);if(t)return t}return n}},(new B).paint(n,u,t,e,r,i)},I.prototype.PCt=function(n){var t,e,r,i,o,a,u,c,s,f,l,t=this,e=[],r=n?t.dataSheetName():t.dateAxisDataSheetName(),i=n?t.WY:t.KY,o=n?t.dataOrientation():t.dateAxisOrientation(),a=n?t.data():t.dateAxisData(),u=t.Tp();if(this.O_r&&(u=this.O_r),i)e=i;else if("string"==typeof r)c=t.mEr(u,r),e=t.BCt(a,o,!n,c||u);else if("object"==typeof r)for(s=r,f=0;f<s.length;f++)c=t.mEr(u,s[f]),l=t.BCt(a[f],o,!n,c||u),e=e.concat(l);else O(r)&&(e=t.BCt(a,o,!n,u));return e},I.prototype.mEr=function(n,t){var e,n,r=/^\[\d+\].+/g,e=n.parent.getSheetFromName(t),n=n.parent._p;return e=r.test(t)&&n?n.parseSource(t,!0):e},I.prototype.QY=function(n){var t=this;return O(t.data())&&!O(t.gI)&&t.data(t.gI),t.BCt(t.data(),t.dataOrientation(),!1,n)},I.prototype.JY=function(n){var t=this;return O(t.dateAxisData())&&t.dateAxisData(t.group().qMt),t.BCt(t.dateAxisData(),t.dateAxisOrientation(),!0,n)},I.prototype.BCt=function(n,t,e,r){var i,o=this.setting().options.displayHidden;return I.EMt(C,r,o,n,t,e)},I.prototype.Tp=function(){var n=this.group(),n=n&&n.RB;return n?n.Mf:x},I.prototype.toJSON=function(n){var t,e,e,t=this,e=O(t.gI)?{row:t._data.row,rowCount:t._data.rowCount,col:t._data.col,colCount:t._data.colCount,sheetName:t.ZY}:t.gI,e={row:t.row,col:t.column,data:e};return O(t.iCt)||(e.orientation=t.iCt),null!=n&&n.isServer&&(e.__ID__=t.jKe()),e},I.prototype.wh=function(){var n,t,e,t,r,n=this,t=n.Tp(),e=n._data,t=O(n.gI)?(r=(0,A.qTe)(n.ZY||t.name()))+"!"+f([N(e.row,e.col,e.rowCount,e.colCount)]):n.gI;return{n_:"sparkline",c_:[{n_:"f",c_:[W(t)]},{n_:"sqref",c_:[f([N(n.row,n.column,1,1)])]}],lossless:{iCt:n.iCt}}},I.prototype.fromJSON=function(n){var t,e,r,i,o,n;n&&(t=this,e=n.row,r=n.col,i=n.orientation,o=n.data,n.__ID__&&t.UKn(n.__ID__),O(e)||(t.row=e),O(r)||(t.column=r),O(i)||(t.iCt=i),o)&&("string"==typeof o?t.gI=o:(t._data=N((n=o).row,n.col,n.rowCount,n.colCount),t.ZY=n.sheetName))},I.prototype.yh=function(n,t){var e,r,i,o,t,e=this,t=A.Util.ko(t)?void 0:1;if(n.c_.forEach(function(n){"f"===n.n_&&(1===(o=rn(X(n.c_[0]))).length?e.gI=o[0]:r=u(o[1])[0]||x),"sqref"===n.n_&&(i=u(n.c_[0])[0]||x)}),O(i)||O(e.gI)&&O(r))return!1;O(i.row)||(e.row=i.row),O(i.col)||(e.column=i.col),r&&(t=1===r.rowCount?1:0,e._data=N(r.row,r.col,r.rowCount,r.colCount),e.ZY=o[0]),O(t)||(e.iCt=t),n.lossless&&(e.iCt=n.lossless.iCt)},I.prototype.FCt=function(){var n,t,t,e,t,n=this;O(n.Tp())||(t=wn(n.Tp(),n.gI),O(t))||(e=(t=P(t)).ranges,t=t.sheetName,n._data=e,n.ZY=t,n.$Dr("data",e),n.$Dr("dataSheetName",t))},I.EMt=function(n,t,e,r,i,o){var a,u,a=[];if(!O(r)){if(!(r instanceof Array))return I.UCt(n,t,e,r,i,o);for(u=0;u<r.length;u++)a.push.apply(a,I.UCt(n,t,e,r[u],i,o,!0))}return a},I.UCt=function(n,t,e,r,i,o,a){var u,c,s,f,l,h,p,v,d;if(0<(null==n?void 0:n.length)&&!Array.isArray(n[0]))return n;if(u=[],c=1===i,t&&r)for(s=0,f=a?c?r.rowCount:r.colCount:1;s<f;s++)for(l=0,h=c?r.colCount:r.rowCount;l<h;l++)p=c?s:l,v=c?l:s,d=n?n[p][v]:t.getValue(r.row+p,r.col+v),d=I.HCt(t,d,r,p,v,e,o),u.push(d);return u},I.HCt=function(n,t,e,r,i,o,a){var u="number";return t instanceof G.CalcError?C:(!o&&n.getRowHeight&&(n.getRowHeight(e.row+r)<=0||n.getColumnWidth(e.col+i)<=0)?t=NaN:O(t)||(a?t=typeof t==u?c.Common.ct.Y0(t):Date.parse(t):typeof t!=u&&(t=K)),t)},S=I,n.Sparkline=S,(0,A.qDr)(S)},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine},CellTypes:function(n){n.exports=GC.Spread.Sheets.CellTypes}},r={},t=n={},Object.defineProperty(t,"__esModule",{value:!0}),t.SparklineGroup=t.Sparkline=t.DataOrientation=t.SparklineType=t.SparklineSetting=t.SparklineAxisMinMax=t.EmptyValueStyle=t.ImageSparkline=t.HistogramSparkline=t.SparklineExValue=t.SparklineEx=t.GaugeKPISparkline=t.RangeBlockSparkline=t.WinlossSparkline=t.ColumnSparkline=t.LineSparkline=t.YearSparkline=t.MonthSparkline=t.ParetoSparkline=t.CascadeSparkline=t.BoxPlotSparkline=t.LollipopVariSparkline=t.VariSparkline=t.VBarSparkline=t.HBarSparkline=t.StackedSparkline=t.SpreadSparkline=t.BulletSparkline=t.ScatterSparkline=t.AreaSparkline=t.PieSparkline=t.jMt=void 0,i=a("./dist/plugins/sparkline/functions-sparkline.js"),Object.defineProperty(t,"jMt",{enumerable:!0,get:function(){return i.jMt}}),Object.defineProperty(t,"PieSparkline",{enumerable:!0,get:function(){return i.PieSparkline}}),Object.defineProperty(t,"AreaSparkline",{enumerable:!0,get:function(){return i.AreaSparkline}}),Object.defineProperty(t,"ScatterSparkline",{enumerable:!0,get:function(){return i.ScatterSparkline}}),Object.defineProperty(t,"BulletSparkline",{enumerable:!0,get:function(){return i.BulletSparkline}}),Object.defineProperty(t,"SpreadSparkline",{enumerable:!0,get:function(){return i.SpreadSparkline}}),Object.defineProperty(t,"StackedSparkline",{enumerable:!0,get:function(){return i.StackedSparkline}}),Object.defineProperty(t,"HBarSparkline",{enumerable:!0,get:function(){return i.HBarSparkline}}),Object.defineProperty(t,"VBarSparkline",{enumerable:!0,get:function(){return i.VBarSparkline}}),Object.defineProperty(t,"VariSparkline",{enumerable:!0,get:function(){return i.VariSparkline}}),Object.defineProperty(t,"LollipopVariSparkline",{enumerable:!0,get:function(){return i.LollipopVariSparkline}}),Object.defineProperty(t,"BoxPlotSparkline",{enumerable:!0,get:function(){return i.BoxPlotSparkline}}),Object.defineProperty(t,"CascadeSparkline",{enumerable:!0,get:function(){return i.CascadeSparkline}}),Object.defineProperty(t,"ParetoSparkline",{enumerable:!0,get:function(){return i.ParetoSparkline}}),Object.defineProperty(t,"MonthSparkline",{enumerable:!0,get:function(){return i.MonthSparkline}}),Object.defineProperty(t,"YearSparkline",{enumerable:!0,get:function(){return i.YearSparkline}}),Object.defineProperty(t,"LineSparkline",{enumerable:!0,get:function(){return i.LineSparkline}}),Object.defineProperty(t,"ColumnSparkline",{enumerable:!0,get:function(){return i.ColumnSparkline}}),Object.defineProperty(t,"WinlossSparkline",{enumerable:!0,get:function(){return i.WinlossSparkline}}),Object.defineProperty(t,"RangeBlockSparkline",{enumerable:!0,get:function(){return i.RangeBlockSparkline}}),Object.defineProperty(t,"GaugeKPISparkline",{enumerable:!0,get:function(){return i.GaugeKPISparkline}}),Object.defineProperty(t,"SparklineEx",{enumerable:!0,get:function(){return i.SparklineEx}}),Object.defineProperty(t,"SparklineExValue",{enumerable:!0,get:function(){return i.SparklineExValue}}),Object.defineProperty(t,"HistogramSparkline",{enumerable:!0,get:function(){return i.HistogramSparkline}}),Object.defineProperty(t,"ImageSparkline",{enumerable:!0,get:function(){return i.ImageSparkline}}),o=a("./dist/plugins/sparkline/sparkline-wrapper.js"),Object.defineProperty(t,"EmptyValueStyle",{enumerable:!0,get:function(){return o.EmptyValueStyle}}),Object.defineProperty(t,"SparklineAxisMinMax",{enumerable:!0,get:function(){return o.SparklineAxisMinMax}}),Object.defineProperty(t,"SparklineSetting",{enumerable:!0,get:function(){return o.SparklineSetting}}),Object.defineProperty(t,"SparklineType",{enumerable:!0,get:function(){return o.SparklineType}}),Object.defineProperty(t,"DataOrientation",{enumerable:!0,get:function(){return o.DataOrientation}}),Object.defineProperty(t,"Sparkline",{enumerable:!0,get:function(){return o.Sparkline}}),Object.defineProperty(t,"SparklineGroup",{enumerable:!0,get:function(){return o.SparklineGroup}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Sparklines=n}();