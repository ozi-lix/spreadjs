/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,e,n;function r(n){var t,t,t=e[n];return void 0!==t||(t=e[n]={exports:{}},i[n].call(t.exports,t,t.exports,r)),t.exports}i={"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js":function(n,t,i){var j,y,D,h,B,t,p,N,x,A;function E(n,t,i,e,r){var t,n,o,u,a,f,s,t=t.Ut,n=n.Qvt(),o=j.SheetArea.viewport;return n===j.SheetArea.colHeader&&r===j.SheetArea.colHeader?i<(u=t.getFreeAreaRowCount(j.SheetArea.colHeader))&&(o=j.SheetArea.colHeader):n===j.SheetArea.rowHeader&&r===j.SheetArea.rowHeader&&e<(f=t.getFreeAreaColumnCount(j.SheetArea.rowHeader))&&(o=j.SheetArea.rowHeader),o}function S(n,t,i,e,r,o,u,a){var f=n.xA(t,i,t,i,u,a),f=(0,j.Ec)(f.row,f.col,1,1);return f=o&&0<=e?n.xA(t,i,e,r,u,a):f}Object.defineProperty(t,"__esModule",{value:!0}),j=i("Core"),y=i("CalcEngine"),D=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),h=i("Common"),B=h.Common.lt.ht,t=j.GC$.extend,p=null,N=void 0,x=Math.max,A=Math.min,t(j.nk.prototype,{Kvt:function(n){var t,i,e,r,o,o,u,a,f,s,c,l,v,h,g,d,I,m,p,x,A,C,b,T,u,s,a,c,e,l,R,M,w,t,i=this,e=i.Mf,r=i.Pde(),o=e.parent,o=o&&0!==o.options.pivotAreaReference;r&&(i.Gde(),u=e.frozenRowCount(),a=e.frozenColumnCount(),(f=r.XD)&&i.Lvt||(i.Lvt={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),s=e.getRowCount(),c=e.getColumnCount(),l=n.hitTestType,v=n.row,h=n.col,g=i.shift,d=i.ctrl,r&&r.Xvt&&(r.Xvt===j.SelectionUnit.row?l=2:r.Xvt===j.SelectionUnit.column&&(l=1)),m=(I=i.Lvt).anchorRow,p=I.anchorCol,A=x=-1,b=E(r,e,v,h,l),0===l?(x=u?e.N9():e.Tb,A=a?e.k9():e.Ab,C=(0,j.Ec)(-1,-1,-1,-1),r.Gvt((0,D.Uvt)(e,C),g,!d,N,b),i.rb=!0):1===l?(b===j.SheetArea.viewport?(x=u?e.N9():e.Tb,C=e.xA(0,A=h,s-1,h,!0),g&&0<=p&&(C=e.xA(0,h,s-1,p,!0)),C=(0,j.Ec)(-1,C.col,-1,C.colCount)):b===j.SheetArea.colHeader&&(C=S(e,x=v,A=h,m,p,g,!0,b)),(T=n.tableSelectInfo&&n.tableSelectInfo.tableSelection)?i.Dse(T,C,v,h,m,p,g,d,b):r.Gvt((0,D.Uvt)(e,C,N,b),g,!d,N,b),i.rb=!0):2===l?(x=v,A=a?e.k9():e.Ab,C=e.xA(v,0,v,c-1,!0),g&&0<=m&&(C=e.xA(v,0,m,c-1,!0)),C=(0,j.Ec)(C.row,-1,C.rowCount,-1),r.Gvt((0,D.Uvt)(e,C),g,!d,N,b),i.rb=!0):3===l&&(A=h,(x=v)!==N)&&h!==N&&(u=n.row,s=n.col,c=(a=n.pivotTableInfo)&&a.getPivotInfoImp(u,s,!1,!0),T=n.tableSelectInfo&&n.tableSelectInfo.tableSelection,w=M=R=l=e=void 0,c&&(e=c.area,l=c.valueFieldName,R=c.rowInfos,M=c.colInfos,w=null==(t=null==R?void 0:R[R.length-1])?void 0:t.isBlankRow),!w&&o&&y.Functions.findGlobalFunction("GETPIVOTDATA")&&!r.Ivt&&a&&c&&4===e?(r.Fvt=new j.Range(u,s,1,1),B(l)||!R&&!M?i.Dse(T,C,v,h,m,p,g,d,b):(t=i.Pvt(e,l,R,M,a.position()))&&(r.Gvt(t,g,!d,!0,b),i.rb=!0,i.LD=!0)):(I&&(I.Skr=v),i.Dse(T,C,v,h,m,p,g,d,b))),i.Wk=i.rb,g&&f||(I.anchorRow=x,I.anchorCol=A,I.leadingRow=x,I.leadingCol=A,I.sheetArea=b),i.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},i.Ok())},Dse:function(n,t,i,e,r,o,u,a,f){var s,c,l,s=this,c=s.Mf,l=this.Pde();delete l.Fvt,t=n||S(c,i,e,r,o,u,!0,f),l.Gvt((0,D.Uvt)(c,t,N,f),u,!a,N,f),s.rb=!0},Pvt:function(n,t,i,e,r){var o,u,n,a,f,s,r,s,c,r,l,v,u,s,o,u=this.Mf;if(4===n)return a=n=void 0,s=r.row,r=r.col,s=(f="",j.Ec)(s,r,1,1),n=(0,D.Uvt)(u,s,!0),c=[],r=[],r=Array.isArray(i)&&Array.isArray(e)?i.concat(e):Array.isArray(i)&&i||Array.isArray(e)&&e,l=/\"/g,v='""',r&&r.forEach(function(n){"number"==typeof n.fieldName?c.push(n.fieldName):c.push('"'+n.fieldName.replace(l,v)+'"'),"number"==typeof n.itemName?c.push(n.itemName):c.push('"'+n.itemName.replace(l,v)+'"')}),u=h.Common.CultureManager.Fe().NumberFormat.listSeparator||",",f=c.join(u),s='GETPIVOTDATA("'+(a=t.replace(l,v))+'"'+u+n,""!==f&&(s+=u+f),s+")"},qvt:function(n){var t=D.Hde.Ude();return!!t&&t.zde(n)},Qk:function(){var n,t,i,e,i,e,n=this,t=this.Pde(),i=n.Rk,e=n.Lvt;i&&n.rb&&(i=i.Bk,e=e.sheetArea,t&&t.Xvt&&(t.Xvt===j.SelectionUnit.row?i=2:t.Xvt===j.SelectionUnit.column&&(i=1)),i===j.SheetArea.viewport||e===j.SheetArea.colHeader||e===j.SheetArea.rowHeader?n.tmt():2===i?n.nmt():1===i&&n.emt())},tmt:function(){var n,t,i,e,t,r,o,u,r,o,i,n=this,t=n.Lvt,i=t.anchorRow,e=t.anchorCol,t=t.sheetArea,r=n.Q9(N,t,!0),o=n.K9(N,t,!0);0<=i&&0<=e&&0<=r&&0<=o&&(r=(u=n.Mf).xA(r,o,i,e,!0,t),o=(0,D.Uvt)(u,r,N,t))&&(i=n.Pde(),n.LD?r.equals(i.Fvt)||(delete i.Fvt,i.Gvt(o,!0,!0)):i.Gvt(o,!0,!1)),n.a9()},nmt:function(){var n,t,i,e,i,t,r,n=this,t=n.Lvt.anchorRow,i=n.Q9();0<=t&&0<=i&&(i=(e=n.Mf).xA(i,0,t,e.getColumnCount()-1,!0),i=(0,j.Ec)(i.row,-1,i.rowCount,-1),t=(0,D.Uvt)(e,i))&&(r=n.Pde()).Gvt(t,!0,!1),n.a9()},emt:function(){var n,t,i,e,i,t,r,n=this,t=n.Lvt.anchorCol,i=n.K9();0<=t&&0<=i&&(i=(e=n.Mf).xA(0,i,e.getRowCount()-1,t,!0),i=(0,j.Ec)(-1,i.col,-1,i.colCount),t=(0,D.Uvt)(e,i))&&(r=n.Pde()).Gvt(t,!0,!1),n.a9()},_D:function(){var n,n,n=this;n.l9(),n.Rk=p,n.rb=!1,n.Wk=!1,(n=n.Pde()).onRangeAppend&&n.onRangeAppend()},Mk:function(n){var t,i,e,r,e,r,o,r,i,u,a,u,a,t=this,i=t.Mf,e=t.Pde(),r=n.formulaRangeHitInfo;r&&r.inBorder&&e&&(e.XD&&e.qD(),e.close(),r=(e=r.paramRange)&&e.text,o=B(e.sheetArea)?j.SheetArea.viewport:e.sheetArea,r)&&(r=(0,D.Vvt)(i,r))&&(t.Gde(),i=i.JS(r,o),u=n.row,a=n.col,(u=u<i.row?i.row:u)>=i.row+i.rowCount&&(u=i.row+i.rowCount-1),(a=a<i.col?i.col:a)>=i.col+i.colCount&&(a=i.col+i.colCount-1),u=u-i.row,a=a-i.col,t.rb=!0,t.Kk=!0,t.imt={paramRange:e,fromRange:r,rowOffset:u,colOffset:a,sheetArea:o},t.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},t.Ok())},Jk:function(){var n,t,i,e,r,o,u,a,f,s,c,l,f,s,l,v,h,g,o,d,I,I,d,I,v,m,n=this;n.rb&&n.Kk&&(i=(t=n.imt).sheetArea,e=n.Q9(N,i,!0),r=n.K9(N,i,!0),0<=e&&0<=r&&(o=t.fromRange,u=t.rowOffset,a=t.colOffset,f=t.toRow,s=t.toCol,l=r,e!==f||l!==s)&&(t.toRow=e,t.toCol=l,s=(f=n.Mf).getRowCount(i),l=f.getColumnCount(i),v=o.row,h=o.col,g=o.rowCount,o=o.colCount,(I=(d=f.Ut).getFreeAreaRowCount(i))<s&&(s=I),(I=d.getFreeAreaColumnCount(i))<l&&(l=I),d=v<0?-1:x(0,A(s-g,e-u)),I=h<0?-1:x(0,A(l-o,r-a)),v=(0,D.Uvt)(f,(0,j.Ec)(d,I,g,o),N,i))&&(m=n.Pde()).Vde(t.paramRange.index,v,!0),n.a9())},ED:function(){var n,n,n=this;n.l9(),n.rb=!1,n.Kk=!1,n.imt=p,(n=n.Pde()).onRangeMoved&&n.onRangeMoved()},Ck:function(n){var t,i,e,r,e,o,u,i,o,a,u,f,s,c,l,t=this,i=t.Mf,e=t.Pde(),r=n.formulaRangeHitInfo;if(r&&e&&(e.XD&&e.qD(),o=(e=r.paramRange)&&e.text,e)&&o&&(u=(0,D.Vvt)(i,o))){if(t.Gde(),i=u.row,o=u.row<0?-1:u.row+u.rowCount-1,a=u.col,u=u.col<0?-1:u.col+u.colCount-1,r.inTopLeft)f=o,s=u,c=i,l=a;else if(r.inTopRight)f=o,s=a,c=i,l=u;else if(r.inBottomLeft)f=i,s=u,c=o,l=a;else{if(!r.inBottomRight)return;f=i,s=a,c=o,l=u}t.rb=!0,t.Xk=!0,t.omt={paramRange:e,anchorRow:f,anchorCol:s,toRow:c,toCol:l,sheetArea:n.hitTestType},t.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},t.Ok()}},Ik:function(n,t){var i=this.Pde();return!(i&&i.qMi||(i&&i.Dvt()?(this.Kvt(t),0):!this.qvt(n)))},qk:function(){var n,t,i,e,r,o,u,a,f,e,r,a,f,i,o,u,s,c,o,e,u,r,f,n=this;n.rb&&n.Xk&&(t=n.omt,i=j.SheetArea.viewport,t&&!B(t.sheetArea)&&(i=t.sheetArea),e=n.Q9(N,i,!0),r=n.K9(N,i,!0),0<=e&&0<=r&&(o=t.anchorRow,u=t.anchorCol,a=t.toRow,f=t.toCol,r=r,(e=e)!==a||r!==f)&&(t.toRow=e,t.toCol=r,f=(a=n.Mf).getRowCount(i),i=a.getColumnCount(i),u=u<0?i-1:u,s=A(o=o<0?f-1:o,e),c=A(u,r),o=x(o,e)-s+1,e=x(u,r)-c+1,u=n.Pde(),(0===s&&o===f||u&&u.Xvt===j.SelectionUnit.column)&&(o=s=-1),(0===c&&e===i||u&&u.Xvt===j.SelectionUnit.row)&&(e=c=-1),r=t.paramRange,f=(0,D.Uvt)(a,(0,j.Ec)(s,c,o,e),N,r.sheetArea))&&u.Vde(r.index,f,!0),n.a9())},jD:function(){var n,n,t,n=this;n.l9(),n.rb=!1,n.Xk=!1,n.omt=p,(n=n.Pde()).rl&&-(n.umt=1)!==(t=n.text().lastIndexOf(",",n.caret()))&&(n.umt=t+1),n.onRangeResized&&n.onRangeResized()},ZL:function(n,t,i){var e,r,o,u,a,f,s,c,l,v,l,h,h,g,d,I,m,l,e=this.Mf,r=this.Pde(),o=r&&r.smt();if(o&&0!==o.length&&r.cmt&&(u=n.rowViewportIndex,a=n.colViewportIndex,f=n.hitTestType,!this.yD(u,a,t,i)))for(v=o.length-1;0<=v;v--)if(l=(s=o[v]).sheetArea,!1!==s.allowDrag&&(B(l)||l===f)&&!((h=D.Hde.Ude())&&h._text||(c=(0,D.Vvt)(e,s.text),B(c)))){if(B(l)&&(l=j.SheetArea.viewport),(h=e.Ut.findSpan(c.row,c.col,l))&&h.containsRange(c)&&(c=h),d=(l=e.getRangeRect(u,a,c)).x-2,I=l.x+l.width+1-(g=5),m=l.y-2,l=l.y+l.height+1-5,5+d<=t&&t<I&&(1+m<=i&&i<=3+m||1+l<=i&&i<=3+l))return{paramRange:s,inBorder:!0};if(5+m<=i&&i<l&&(1+d<=t&&t<=3+d||1+I<=t&&t<=3+I))return{paramRange:s,inBorder:!0};if(I<=t&&t<5+I&&l<=i&&i<5+l)return{paramRange:s,inBottomRight:!0};if(d<=t&&t<5+d&&l<=i&&i<5+l)return{paramRange:s,inBottomLeft:!0};if(I<=t&&t<5+I&&m<=i&&i<5+m)return{paramRange:s,inTopRight:!0};if(d<=t&&t<5+d&&m<=i&&i<5+m)return{paramRange:s,inTopLeft:!0}}return p},Pde:function(){var n=this.Mf;return n.il||n.mnn||n.Bde},Gde:function(){var n=this.Pde();n&&n.mmt()}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js":function(n,t,i){var P,F,L,t,U;function c(n,t,i,e,r,o){var u,a,f,s,c,l,v,h,g,d,I,m,p,x,A,C,b,T,A,R,M,w,w,A,j,j,y,D,B,N,k,E,S,O,G,u=n.Mf,a=u.rt,f=u.C6(i,e),s=o&&o.smt(),c=s&&s.length;if(!(c<=0)&&(l=n.uO(i,e,r))){for(t.save(),t.rect(l.x,l.y,l.width,l.height),t.clip(),t.beginPath(),v=[],h=a.isFormulaRangeHovering,g=a.AD,d=a.Kk,I=a.imt,m=a.Xk,p=a.omt,R=0;R<c;R++)if(("number"!=typeof(A=(x=s[R]).sheetArea)||A===f)&&(A=x.text,C=x.ranges&&0<x.ranges.length?x.ranges:[(0,L.Vvt)(u,A)])){if((M=L.Hde.Ude())&&M.Mf&&void 0!==A)if(U.OS(A,"!")){if(w=U.gmt(A,"!"),u.name()!==w&&"'"+u.name()+"'"!==w)continue}else if(w=U.gmt(A,"["),A=u.tables,j=(j=u.NMi)&&j._gi===P.SheetType.tableSheet&&j.name()===w,!(u.getCustomNames()[w]||A&&A.findByName(w)||j))continue;for(b=n.fO(i,e,C,l),y=0;y<b.length;y++)(D=b[y])&&0<D.width&&0<D.height&&(T=o.pmt(R),o.bmt(x)||x.isPivotClickCell?(h&&g.paramRange.index===R&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(D.x+1,D.y+1,D.width-3,D.height-3),t.stroke()),n.wO(t,D,T)):(h&&g.paramRange.index===R||d&&I.paramRange.index===R||m&&p.paramRange.index===R?(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(D.x+1,D.y+1,D.width-3,D.height-3)):(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(D.x,D.y,D.width-1,D.height-1)),t.stroke()),o.ymt(x)&&((B=F.Common.ft._(T)).a=.1,t.beginPath(),t.fillStyle=F.Common.ft.j(B),t.fillRect(D.x+1,D.y+1,D.width-3,D.height-3)),v.push({rect:D,color:T,allowDrag:x.allowDrag}))}if(0<v.length&&o.cmt)for(N=v.length,R=0;R<N;R++)D=v[R].rect,T=v[R].color,E=D.x-2,S=D.x+D.width+1-(k=5),O=D.y-2,G=D.y+D.height+1-5,!1===v[R].allowDrag||(M=L.Hde.Ude())&&M._text||(t.beginPath(),t.fillStyle=T,t.fillRect(E,O,5,5),t.fillRect(S,O,5,5),t.fillRect(E,G,5,5),t.fillRect(S,G,5,5));t.beginPath(),t.restore()}}Object.defineProperty(t,"__esModule",{value:!0}),P=i("Core"),F=i("Common"),L=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),t=P.GC$.extend,U=F.Common.zf,t(P.g7.prototype,{Fde:function(){var n,t,t,i,n=this,t=n.Mf;0<t.My||(t=t.Fi(),i=n.J(),n.FA(t.x,t.y,t.width,t.height),n.jy(i))}}),P.Worksheet.ch("formulaReferencedRanges",{paintAdornment:function(n){var t,i,e,r,o,u,a,f,s,t=this,i=n.ctx,e=n.clipRect,r=t.Dn,o=t.Fi(),s=t.rt.Pde();if(s)for(a=-1;a<=2;a++)for(f=-1;f<=2;f++)-1===a&&-1===f||(u=-1===a?o.L1(f):-1===f?o.B1(a):o.c9(a,f))&&0!==u.width&&0!==u.height&&c(r,i,a,f,e,s)}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js":function(n,t,i){var d,e,I,m,a,p;function r(){}function o(n,t){var i,i,e,r;if(t){e=(i=(i=p.Ude())&&i.Mf||n).ui,r=i.ci;try{return d.formulaToRange(n,t,e,r,i)}catch(n){}}return m}function u(n,i,t,e){var r,o,u,a,f,s,s,c,l,v,h,v,t,v,g;return void 0===e&&(e=I.SheetArea.viewport),i?(r=n.Bde,o=p.Ude(),u=o&&o.Mf||n,a=u.ui,f=u.ci,s=(s=n.parent)&&1===s.options.referenceStyle,c=15,(r&&r.Ivt||t)&&(c=0),i.row<0&&i.col<0&&(i=new I.Range(0,-1,n.getRowCount(),-1)),l=f,v=n.tables,h=v&&v.find(i.row,i.col),v=function(){var n,t=u.tables;return(n=t?(n=t.find(a,l))||t.find(a,l-1):n)!==h&&h&&n&&n.xkr(a,l)&&1===i.rowCount&&1===i.colCount&&h.$Gr(i.row,i.col)||1===i.rowCount&&1===i.colCount&&h&&h.xkr(a,l)?i.row:a},(o&&o.Ivt||t)&&(c=0),r&&(!r.rl||r.lBe)&&d.isStructureReference(h,i,v())?((o&&o._text&&o.Mf!==n||r.lBe)&&(f=-1),d.rangeToFormulaWithStructReference(n,i,v(),f,c,s,h)):(t=n.NMi,!h&&e===I.SheetArea.viewport&&t&&t._gi===I.SheetType.tableSheet?(h=t,x(n,i.col,i.colCount,h)):(v=d.rangeToFormula(i,a,f,c,s),o&&o._text||r&&r.rl&&r.Smt?(g=(0,I.qTe)(n.name()))+"!"+v:v))):m}function f(n){return n&&"["===n[0]&&"]"===n[n.length-1]}function x(n,t,i,e){var r,o,r,e,r,r,i,t,r=s(e),o=r.columns,r=r.groupInfo,e=e.name();if(-1===t&&(t=0),-1===i&&(i=o.length),r){if(r=r.rightGroupColumnIndex,1===i&&t<=r)return"";if(1<i&&t<=r){if(t+i<=r+1)return"";i-=r-t+1,t=r+1}}return 1===i?"".concat(e,"[").concat(o[t].name,"]"):1<i?(r=t+i-1,f(i=o[t].name)||(i="[".concat(i,"]")),f(t=o[r].name)||(t="[".concat(t,"]")),"".concat(e,"[").concat(i,":").concat(t,"]")):""}function s(n){for(var t,i,e,r,o,u,t=[],i=0,e="";e!==m;)e=n.getColumnName(i),o=void 0,n.Mf.NMi&&(o=n.FDi(i))&&(r=i),i++,e!==m&&t.push({name:e,description:"",isGroupColumn:o});return u={columns:t},a(r)||(u.groupInfo={rightGroupColumnIndex:r}),u}function c(n,t,i,e,r){var o,u,e,o,o=n.rowRelative,u=n.columnRelative;e&&(o&&u?(n.rowRelative=!1,n.columnRelative=!1,n.row+=t,n.column+=i):!o&&u?(n.rowRelative=!0,n.columnRelative=!1,n.row-=t,n.column+=i):(n.columnRelative=!0,n.column-=i)),e=n.endRowRelative,o=n.endColumnRelative,r&&(e&&o?(n.endRowRelative=!1,n.endColumnRelative=!1,n.endRow+=t,n.endColumn+=i):!e&&o?(n.endRowRelative=!0,n.endColumnRelative=!1,n.endRow-=t,n.endColumn+=i):(n.endColumnRelative=!0,n.endColumn-=i))}function l(n,t,i){var e=n.rowRelative,r=n.columnRelative;e&&r?(n.rowRelative=!1,n.columnRelative=!1,n.row+=t,n.column+=i):!e&&r?(n.rowRelative=!0,n.columnRelative=!1,n.row-=t,n.column+=i):(n.columnRelative=!0,n.column-=i)}Object.defineProperty(t,"__esModule",{value:!0}),t.dmt=t.lmt=t.Uvt=t.Vvt=t.Hde=void 0,d=i("SheetsCalc"),e=i("Common"),I=i("Core"),m=null,a=e.Common.lt.ht,r.Ude=function(){return r.DJ},p=r,t.Hde=p,t.Vvt=o,t.Uvt=u,t.lmt=c,t.dmt=l,I.GC$.extend(I.Hv.prototype,{C2:function(n){return!n||!n.Bde||!n.Bde.Dvt()},D2:function(n){return!n||!n.Bde||!!n.Bde.xmt}})},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(n,t,i){var e,r,o,u,a,e=this&&this.__createBinding||(Object.create?function(n,t,i,e){void 0===e&&(e=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,e,r)}:function(n,t,i,e){n[e=void 0===e?i:e]=t[i]}),r=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.findControl=void 0,o=i("Core"),r(i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),t),i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js"),i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js"),r(i("./dist/plugins/formulaTextbox/formulatextbox.js"),t),r(i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),t),i("./dist/plugins/formulaTextbox/formulatextbox-event.js"),i("./dist/plugins/formulaTextbox/formulatextbox-render.js"),i("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),u=i("./dist/plugins/formulaTextbox/formulatextbox.js"),t.findControl=a=function(n){return"string"==typeof n&&(n=document.getElementById(n)),(0,o.GC$)(n).data(u.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(n,t,i){var h,e,g,r,d,I,o,u,a;function f(n){var t,i,t=h.mt.En("textarea"),i;return(0,h.GC$)(t).css({display:"none"}),(0,h.GC$)(n).append(t),t}function s(n,t){var i,n,t,t;n&&n.il&&(i=n.il.Kmt,n=n.il.Jmt,t=t?"addClass":"removeClass",i&&(0,h.GC$)(i)[t](r),n)&&(0,h.GC$)(n)[t](r)}function c(){var n=this;n.bZ=-1,n.mvt=-1,n._text="",n.gvt=-1,n.Mf=null,n.XD=!1,n.pvt=-1,n.bvt=null,n.Vv=null,n.yvt=null}function l(){}Object.defineProperty(t,"__esModule",{value:!0}),t.wvt=t.Mvt=void 0,h=i("Core"),e=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),g=i("./dist/plugins/formulaTextbox/formulatextbox.js"),r="gc-across-sheet-func-popup",d=null,I=void 0,t.Mvt=f,c.prototype.d5=function(){var n=this;n.Cvt(),n.bZ=-1,n.mvt=-1,n._text="",n.gvt=-1,n.XD=!1,n.pvt=-1,n.Mf=null,n.Vv=null,n.yvt=null},c.prototype.Cvt=function(){var n,t,i,n=this;n.Mf.xT||(t=n.Mf.getCellType(n.bZ,n.mvt),i={sheet:n.Mf,row:n.bZ,col:n.mvt,sheetArea:3},n.bvt&&n.bvt.firstChild&&t.deactivateEditor(n.bvt.firstChild.firstChild,i)),(0,h.GC$)(n.bvt).remove(),n.bvt=null},c.prototype.Svt=function(n){var t,i,e,t=this,i=n.il;i&&(e=n.vA,t._text=i.text(),t.bZ=e?e.row:n.getActiveRowIndex(),t.mvt=e?e.col:n.getActiveColumnIndex(),t.nT=e?e.sheetArea:h.SheetArea.viewport,t.gvt=i.caret(),t.XD=i.XD,t.pvt=i.Tvt(),t.rl=i.rl,t.Avt=i.Avt,t.Ivt=i.Ivt,t.Mf=n,t.Vv=n.parent,t.yvt=n.rt.it())},c.prototype._6=function(n){var t=this;n.il&&t.Mf&&(t._text=n.il.text(),t.gvt=n.il.caret(),t.XD=n.il.XD,t.pvt=n.il.Tvt())},c.prototype.xvt=function(n){var t,n,t=this,n=n.il;n&&(n.rl=t.rl,n.Avt=t.Avt,n.Ivt=t.Ivt,n.text(t._text),n.caret(t.gvt),t.XD)&&(n.Nvt(),n.Tvt(t.pvt))},c.prototype.kvt=function(n){var t,i,e,r,t=n.oldSheet,i=this,e=t&&t.il;if(e)if(e.close(),(!i.Mf||i.Mf.xT)&&e.Dvt()||i.Avt!==e.Avt){i.Svt(t),r=t.getValue(i.bZ,i.mvt,i.nT),t.suspendEvent();try{if(!t.endEdit(!0,!1))return}finally{t.resumeEvent()}t.setValue(i.bZ,i.mvt,r,i.nT,!0),t.Di=1,n.needTriggerSheetChange=!1}else i._text&&(i._6(t),e.destroy(),t.il=d,t.Bde=d,n.needTriggerSheetChange=!1)},c.prototype._vt=function(n){var t,n,i,e,e,r,e,r,t=n.oldSheet,n=n.newSheet,i=this;if(n&&!n.xT){if(i.bvt&&""===i._text&&(t&&t.cR(),s(n,!1),i.d5()),i._text&&i.Mf===n)n.Di=0,n.Zg(),n.suspendEvent(),i.rl?(e=f(n.parent.Ti),(0,g.Evt)(n,e,d,n.ui,n.ci,3),n.Di=2,n.Dn.ID()):(r=e=void 0,i.nT===h.SheetArea.rowHeader?r=-(e=1):i.nT===h.SheetArea.colHeader&&(e=-1,r=1),n.f6(n.Dg(),i.bZ,i.mvt,e,r,!1)),n.resumeEvent(),i.xvt(n),i.GG(n,i.bZ,i.mvt,i.nT),t&&t.cR(),s(n,!1),i.d5();else if(i._text&&!i.bvt){if(n.Di=1,t&&(t.Di=1),i.jvt(n),s(n,!0),!i.Mf||i.Mf.xT)return;n.e4()}else if(i._text&&i.Mf!==n){if(n.Di=1,t&&(t.Di=1,t.cR()),i.jvt(n),s(n,!0),!i.Mf||i.Mf.xT)return;n.e4()}(e=i.Mf)&&(r=n.il)&&(r.U6=e!==n)}},c.prototype.jvt=function(n){var t,i,e,r,o,u,a,f,s,c,l,c,l,v,t=this,i=t.Mf;i&&!i.xT&&(e=t.bZ,r=t.mvt,o=t.nT,u=i.getCellType(e,r,o),a={sheet:i,row:e,col:r,sheetArea:o,canvasOffset:this.yvt},(f=u.isImeAware(a))||o!==h.SheetArea.viewport)&&(n.Di=1,s=u.jn(a),t.bvt&&t.Cvt(),l=c=void 0,t.nT===h.SheetArea.rowHeader?l=-(c=1):t.nT===h.SheetArea.colHeader&&(c=-1,l=1),t.bvt=s,(0,h.GC$)(s).css("position","absolute"),(c=i.getCellRect(e,r,c,l)).width===I&&(c.width=0),c.height===I&&(c.height=0),(0,h.GC$)(s).attr("id","across"),(0,h.GC$)(s).addClass("gc-across-sheet-ftb"),l=i.getActualStyle(e,r,o),u.On(s,l,c,a),(v=t.Vv&&t.Vv.getHost()||document.body).insertBefore(s,d),t.rl&&(0,h.GC$)(s).css({display:"none"}),(0,g.Evt)(n,u.getEditingElement(),!0,n.ui,n.ci,3),s.firstChild&&!t.rl&&u.focus(s.firstChild.firstChild),t.xvt(n),u.Rn(s,l,c,a))},c.prototype.GG=function(n,t,i,e){var r,o,u,a,f,s,r,o,c;e===h.SheetArea.rowHeader?o=-1:e===h.SheetArea.colHeader&&(r=-1),u=n.getCellType(t,i,e),a=n.li,f=n.Fi(),s=n.getActualStyle(t,i,e),r=n.getCellRect(t,i,r,o),o=!1,e===h.SheetArea.rowHeader?o=r.x>=f.x&&r.y>=f.y+f.qC&&r.x+r.width<=f.Py&&r.y+r.height<=f.Ay+f.Iy:e===h.SheetArea.colHeader?o=r.x>=f.x+f.XC&&r.y>=f.y&&r.x+r.width<=f.Hy+f.zy&&r.y+r.height<=f.Cy:e===h.SheetArea.viewport&&(o=r.x>=f.b6&&r.y>=f.T6&&r.x+r.width<=f.Hy+f.zy&&r.y+r.height<=f.Ay+f.Iy),r&&0<r.width&&0<r.height&&o&&a&&a.parentNode&&u.Rn(a.parentNode.parentNode,s,r,c={sheet:n,row:t,col:i,sheetArea:e})},c.prototype.zde=function(n){var t,i,e,r,t=this;if(!t.bvt)return!1;if(i=!1,e=t.Mf,(r=n.il)&&e.setFormula(t.bZ,t.mvt,r.text()),e!==n){if(h.Commands.VA.Yvt(e),!e.endEdit())return;i=!0}else r&&(r.destroy(),n.il=d,n.Bde=d),t.d5();return i},o=c,l.Ovt=function(n,t){(l.Rvt=l.Rvt?l.Rvt:new o).kvt(t)},l.Bvt=function(n,t){(l.Rvt=l.Rvt?l.Rvt:new o)._vt(t)},t.wvt=u=l,a=e.Hde.Ude,e.Hde.Ude=function(){return a()||u.Rvt}},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(k,n,t){var b,n,r,o,T,a,R,u;function M(n){var t,t,i,t=n.il,i=n.rt,t=t.XD&&i.Lvt?i.Lvt:i.Lvt={anchorRow:n.ui,anchorCol:n.ci,leadingRow:n.qA,leadingCol:n.hR};return t}function f(n,t,i,e,r){var o,u,a,a,a,f,s,c,l,f,s,t,v,h,g,a,d,I,m,p,x,A,C,o,o,m,u=n.il,a=n.parent,a=a&&a.options;if(u&&u.Dvt()&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox){switch(f=(a=M(n)).anchorRow,s=a.anchorCol,c=a.leadingRow,l=a.leadingCol,R(e)&&(e=f),R(r)&&(r=s),f=n.rt,t){case 3:g=n.sI(e,r,i,c);break;case 4:g=n.uI(e,r,i,c);break;case 1:g=n.lR(e,r,i,l);break;case 2:g=n.gR(e,r,i,l);break;case 5:g=n.yR();break;case 6:g=n.bR()}g&&(s=g.row,t=g.col,v=g.leadingCellRow||s,h=g.leadingCellCol||t,n.dR(s,t))&&(a.anchorRow=s,a.anchorCol=t,a.leadingRow=v,a.leadingCol=h,a=n.pivotTables&&n.pivotTables.findPivotTable(v,h),d=u.shift,I=u.ctrl,(m=a&&a.getPivotInfoImp(v,h,!1,!0))&&(p=m.area,x=m.valueFieldName,A=m.rowInfos,C=m.colInfos,o=null==(o=null==A?void 0:A[A.length-1])?void 0:o.isBlankRow),!o&&!u.Ivt&&a&&m&&4===p?(u.Fvt=new b.Range(v,h,1,1),(A||C)&&(o=n.rt.Pvt(p,x,A,C,a.position()))&&(u.Gvt(o,d,!I,!0),u.rb=!1)):(delete u.Fvt,(m=(0,T.Uvt)(f.Mf,(0,b.Ec)(s,t,1,1)))&&u.Gvt(m,!1,!0)),0<=s)&&0<=t&&n.OA(s,t)}}function i(n,t){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(3===t?t=4:4===t&&(t=3));var i=n.il;return i&&i.Dvt()?f(n,t,!1):(n=i?u.Hvt(n):n).G5(t,!1),!0}return!1}function e(n,t,i,e){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(3===t?t=4:4===t&&(t=3));var r=n.il;return r&&r.Dvt()?f(n,t,!1,i,e):(n=r?u.Hvt(n):n).G5(t,!1,i,e),!0}return!1}function s(n,t,i){var e,r,r,r,o,u,o,a,a,n,a,e=n.il,r=n.parent,r=r&&r.options;e&&e.Dvt()&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox&&(r=n.rt,u=(o=M(n)).anchorRow,o=o.anchorCol,a=e.XD?(a=e.zvt(),(0,T.Vvt)(n,a.text)):(0,b.Ec)(u,o,1,1))&&(n=n.HR(a,t,i,u,o),a=(0,T.Uvt)(r.Mf,n))&&e.Gvt(a,!0,!1)}function c(n,t,i){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(37===t?t=39:39===t&&(t=37));var e=n.il;if(e&&e.Dvt())s(n,t,i);else{if(!(n=e?u.Hvt(n):n).endEdit())return!1;n.HA(t,i)}return!0}return!1}function l(n,t,i){return null!==n.getValue(t,i)||n.isReportTemplateSheet&&!!n.getTemplateCell(t,i)}function v(n,t,i){for(var e=i,r=0;0<=i;){if(n.getRowVisible(i)){if(!l(n,i,t)){i++;break}e=i}i--}return n.getRowVisible(i=i<0?0:i)?i:e}function h(n,t,i){for(var e=i,r=0;0<=i&&(!n.getRowVisible(i)||!l(n,e=i,t));)i--;return n.getRowVisible(i=i<0?0:i)?i:e}function g(n,t,i){for(var e=i,r=n.getRowCount();i<r;){if(n.getRowVisible(i)){if(!l(n,i,t)){i--;break}e=i}i++}return n.getRowVisible(i=r<=i?r-1:i)?i:e}function d(n,t,i){for(var e=i,r=n.getRowCount();i<r&&(!n.getRowVisible(i)||!l(n,e=i,t));)i++;return n.getRowVisible(i=r<=i?r-1:i)?i:e}function I(n,t,i){for(var e=i,r=0;0<=i;){if(n.getColumnVisible(i)){if(!l(n,t,i)){i++;break}e=i}i--}return n.getColumnVisible(i=i<0?0:i)?i:e}function m(n,t,i){for(var e=i,r=0;0<=i&&(!n.getColumnVisible(i)||!l(n,t,e=i));)i--;return n.getColumnVisible(i=i<0?0:i)?i:e}function p(n,t,i){for(var e=i,r=n.getColumnCount();i<r;){if(n.getColumnVisible(i)){if(!l(n,t,i)){i--;break}e=i}i++}return n.getColumnVisible(i=r<=i?r-1:i)?i:e}function x(n,t,i){for(var e=i,r=n.getColumnCount();i<r&&(!n.getColumnVisible(i)||!l(n,t,e=i));)i++;return n.getColumnVisible(i=r<=i?r-1:i)?i:e}function A(n,t,i){var e,r,t,o,u,e=0,r=l(n,t,i),t=t,o=i;if(!(o-1<0)){for(o--;0<=o&&!n.getColumnVisible(o);)o--;if(o<0)return{row:t,col:0};o=((u=r&&l(n,t,o))?I:m)(n,t,o)}return{row:t,col:o}}function C(n,t,i){var e,r,o,t,u,a,e=n.getColumnCount(),r=e,o=l(n,t,i),t=t,u=i;if(!(r<=u+1)){for(u++;u<r&&!n.getColumnVisible(u);)u++;if(e<=u)return{row:t,col:e-1};u=((a=o&&l(n,t,u))?p:x)(n,t,u)}return{row:t,col:u}}function w(n,t,i){var e,r,o,t,u,e=0,r=l(n,t,i),o=t,t=i;if(!(o-1<0)){for(o--;0<=o&&!n.getRowVisible(o);)o--;if(o<0)return{row:0,col:t};o=((u=r&&l(n,o,t))?v:h)(n,t,o)}return{row:o,col:t}}function j(n,t,i){var e,r,o,u,t,a,e=n.getRowCount(),r=l(n,t,i),o=n.getRowCount(),u=t,t=i;if(!(e<=u+1)){for(u++;u<e&&!n.getRowVisible(u);)u++;if(o<=u)return{row:o-1,col:t};u=((a=r&&l(n,u,t))?g:d)(n,t,u)}return{row:u,col:t}}function y(n,t,i,e,r){var o,u,a,a,a,f,s,f,s,t,c,l,v,a,h,g,d,I,m,p,x,o,o,d,u=n.il,a=n.parent,a=a&&a.options;if(u&&u.Dvt()&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox){switch(f=(null==(a=M(n))?void 0:a.anchorRow)||0,s=(null==a?void 0:a.anchorCol)||0,R(e)&&(e=f),R(r)&&(r=s),f=n.rt,t){case 3:v=A(n,e,r);break;case 4:v=C(n,e,r);break;case 1:v=w(n,e,r);break;case 2:v=j(n,e,r)}v&&(s=v.row,t=v.col,c=v.leadingCellRow||s,l=v.leadingCellCol||t,n.dR(s,t))&&(a.anchorRow=s,a.anchorCol=t,a.leadingRow=c,a.leadingCol=l,a=n.pivotTables&&n.pivotTables.findPivotTable(c,l),h=u.shift,g=u.ctrl,(d=a&&a.getPivotInfoImp(c,l,!1,!0))&&(I=d.area,m=d.valueFieldName,p=d.rowInfos,x=d.colInfos,o=null==(o=null==p?void 0:p[p.length-1])?void 0:o.isBlankRow),!o&&!u.Ivt&&a&&d&&4===I?(u.Fvt=new b.Range(c,l,1,1),(p||x)&&(o=n.rt.Pvt(I,m,p,x,a.position()))&&(u.Gvt(o,h,!g,!0),u.rb=!1)):(delete u.Fvt,(d=(0,T.Uvt)(f.Mf,(0,b.Ec)(s,t,1,1)))&&u.Gvt(d,!1,!0)),0<=s)&&0<=t&&n.OA(s,t)}}function D(n,t,i,e){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(3===t?t=4:4===t&&(t=3));var r=n.il;return r&&r.Dvt()?y(n,t,!1,i,e):(n=r?u.Hvt(n):n).G5(t,!1,i,e),!0}return!1}function B(n,t){var t,t=t===n.row||-1===n.row&&0===t?0:t===n.row+n.rowCount-1||-1===n.row&&t===n.rowCount-1?2:1;return t}function N(n,t){var t,t=t===n.col||-1===n.col&&0===t?0:t===n.col+n.colCount-1||-1===n.col&&t===n.colCount-1?2:1;return t}function E(n,t){for(var i,e,r,o,u,i,e=t,r=0,o=n.getSpans(t);r<o.length;r++)u=o[r],e=e.union(u);return t.row=e.row,t.col=e.col,t.rowCount=e.rowCount,t.colCount=e.colCount,t}function S(n,t,i,e){var i,e,r,o,o,u,a,o,f,s,i=null!=i?i:n.getActiveRowIndex(),e=null!=e?e:n.getActiveColumnIndex(),r=N(t,e);if(1===r&&-1===t.col)return t;for(o=2!==r&&0===r?t.col+t.colCount-1:t.col,a=0===r?t.col+t.colCount-1-1:t.col-1,u=o-1;0<=u&&!n.getColumnVisible(u);)u--;return o=l(n,i,o),f=l(n,i,u),o=((s=o&&f)?I:m)(n,i,a),t.colCount=2===r?e-o+1:0===r?Math.abs(o-e)+1:t.col+t.colCount-o,o<e?t.col=o:1!==r&&(t.col=e),E(n,t)}function O(n,t,i,e){var r,i,e,o,u,u,a,f,u,s,c,r=n.getColumnCount(),i=null!=i?i:n.getActiveRowIndex(),e=null!=e?e:n.getActiveColumnIndex(),o=N(t,e);if(1===o&&-1===t.col)return t;for(u=2===o?t.col:t.col+t.colCount-1,f=2===o?t.col+1:t.col+t.colCount,a=u+1;a<r&&!n.getColumnVisible(a);)a++;return u=l(n,i,u),s=l(n,i,a),u=((c=u&&s)?p:x)(n,i,f),t.colCount=2===o?Math.abs(u-e)+1:0===o?u-e+1:u-t.col+1,u<e?t.col=u:1!==o&&(t.col=e),E(n,t)}function P(n,t,i,e){var i,e,r,o,o,u,a,o,f,s,i=null!=i?i:n.getActiveRowIndex(),e=null!=e?e:n.getActiveColumnIndex(),r=B(t,i);if(1===r&&-1===t.row)return t;for(o=2!==r&&0===r?t.row+t.rowCount-1:t.row,a=0===r?t.row+t.rowCount-1-1:t.row-1,u=o-1;0<=u&&!n.getRowVisible(u);)u--;return o=l(n,o,e),f=l(n,u,e),o=((s=o&&f)?v:h)(n,e,a),t.rowCount=2===r?i-o+1:0===r?Math.abs(o-i)+1:t.row+t.rowCount-o,o<i?t.row=o:1!==r&&(t.row=i),E(n,t)}function F(n,t,i,e){var r,i,e,o,u,u,a,f,u,s,c,r=n.getRowCount(),i=null!=i?i:n.getActiveRowIndex(),e=null!=e?e:n.getActiveColumnIndex(),o=B(t,i);if(1===o&&-1===t.row)return t;for(u=2===o?t.row:t.row+t.rowCount-1,f=2===o?t.row+1:t.row+t.rowCount,a=u+1;a<r&&!n.getRowVisible(a);)a++;return u=l(n,u,e),s=l(n,a,e),u=((c=u&&s)?g:d)(n,e,f),t.rowCount=2===o?Math.abs(u-i)+1:0===o?u-i+1:u-t.row+1,u<i?t.row=u:1!==o&&(t.row=i),E(n,t)}function L(n,t,i,e,r){var o,u,o=n.JS(t),u=a;return 3===i?u=S(n,o,e,r):4===i?u=O(n,o,e,r):1===i?u=P(n,o,e,r):2===i&&(u=F(n,o,e,r)),u&&(t.row<0&&(u.row=-1,u.rowCount=n.getRowCount()),t.col<0)&&(u.col=-1,u.colCount=n.getColumnCount()),u}function U(n,t){var i,e,e,e,r,o,r,u,u,n,a,i=n.il,e=n.parent,e=e&&e.options;return!!(i&&i.Dvt()&&e&&e.allowUserEditFormula&&e.enableFormulaTextbox)&&(e=n.rt,o=(r=M(n)).anchorRow,r=r.anchorCol,!!((u=i.XD?(u=i.zvt(),(0,T.Vvt)(n,u.text)):(0,b.Ec)(o,r,1,1))&&(n=L(n,u,t,o,r),a=(0,T.Uvt)(e.Mf,n))))&&(i.Gvt(a,!0,!1),!0)}function G(){}Object.defineProperty(n,"__esModule",{value:!0}),b=t("Core"),n=t("Common"),r=t("./dist/plugins/formulaTextbox/formulatextbox.js"),o=t("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),T=t("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),a=void 0,R=n.Common.lt.ht,b.GC$.extend(b.Worksheet.prototype,{changeFormulaText:D,changeFormulaTextCtrlShift:U}),b.Commands.B5=i,b.Commands.UA=e,b.Commands.L5=c,G.YA=function(n){return G.Hvt(n)},G.ZA=function(n){return G.Hvt(n)},G.WA=function(n){return G.Hvt(n)},G.Hvt=function(n){var n,t,n=n,t=o.wvt.Rvt;return t&&t._text&&t.Mf&&(n=t.Mf,G.Yvt(n)),n},G.Yvt=function(n,t){var i,e;void 0===t&&(t=!0),i=n.parent,(e=o.wvt.Rvt)&&e._text&&i.e3(n,t)},G.KA=function(n,t,i){var e,r,o,t,e=!1,r=n.il;return r&&r.Dvt()?((o=M(n)).anchorRow=t,o.leadingRow=t,(t=(0,T.Uvt)(n,(0,b.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(t,!1,!0),n.$A(i),e=!0):r&&(n=G.Hvt(n)),{sheet:n,r:e}},G.eI=function(n,t,i){var e,r,o,t,e=!1,r=n.il;return r&&r.Dvt()?((o=M(n)).anchorRow=t,o.leadingRow=t,(t=(0,T.Uvt)(n,(0,b.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(t,!1,!0),n.$A(i),e=!0):r&&(n=G.Hvt(n)),{sheet:n,r:e}},G.Zvt=function(n,t){var i,t,e,r,o,i=!1,t=t?5:6,e=n.il,r=n.ui,o=n.ci;return e&&e.Dvt()?(e.XD||(n.rt.Lvt={anchorRow:r,anchorCol:o,leadingRow:n.qA,leadingCol:n.hR}),f(n,t,!1,r,o),i=!0):e&&(n=G.Hvt(n)),{sheet:n,r:i}},G.iI=function(n){return G.Zvt(n,!0)},G.rI=function(n){return G.Zvt(n,!1)},G.oI=function(n){return G.Hvt(n)},G.aI=function(n){return G.Hvt(n)},G.cI=function(n){var t,i,e,t,t=o.wvt.Rvt;if(t&&t._text&&t.Mf&&(n=t.Mf,i=t.bZ,e=t.mvt,G.Yvt(n,!1),(0,r.Wvt)(n),t.rl||n.t4(i,e,a,a,1),n.isEditing()))return t=n.getValue(i,e,3),!!n.ol(!0,void 0,void 0,!0)&&(n.setValue(i,e,t,3,!0),!0)},u=G,b.Commands.VA=u},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(n,t,i){var t,h,g,d,i,I;Object.defineProperty(t,"__esModule",{value:!0}),t=i("Core"),h=i("CalcEngine"),g=i("SheetsCalc"),d=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),i=t.GC$.extend,I=null,i(t.nk.prototype,{hI:function(){var n,t,i,e,r,o,o,u,a,f,s,c,l,t,v,o,n,t=this.Mf,i=t.il;if(i)if(e=t.ui,r=t.ci,o=(o=t.parent)&&1===o.options.referenceStyle,u=new g.SheetParserContext(t,o,(0,h.eV)(e,r)),a=new h.Parser,i.XD)for(c=i.fmt(),l=0;l<c.length;l++){f=c[l];try{s=a.parse(u,f.text)}catch(n){s=I}s&&1===s.type&&((0,d.lmt)(s,e,r,!0,!0),i.Vde(f.index,a.unparse(u,s)))}else if(f=i.zvt()){try{s=a.parse(u,f.text)}catch(n){s=I}s&&1===s.type&&(s.isFullColumn||s.isFullRow?((0,d.lmt)(s,e,r,!0,!0),i.Vde(f.index,a.unparse(u,s))):s.hmt()?((0,d.dmt)(s,e,r),i.Vde(f.index,a.unparse(u,s))):(t=f.textOffset+f.text.lastIndexOf(":"),(v=i.caret()<=t)?((0,d.lmt)(s,e,r,!0,!1),o=a.unparse(u,s),i.Vde(f.index,o),i.caret(f.textOffset+o.lastIndexOf(":"))):((0,d.lmt)(s,e,r,!1,!0),i.Vde(f.index,a.unparse(u,s)))))}}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(n,t,i){var t,e;Object.defineProperty(t,"__esModule",{value:!0}),(e=(t=i("Core")).GC$.extend)(t.g7.prototype,{ID:function(){this.Fde()}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(t,a,n){var x,F,h,A,l,C,f,c,L,e,u,U,v,s,g,d,b,i,I,m,r,p,T,R,o,M,w,j,y,Z,z,_,Y,Q,D,B,N,W,V,X,K,H,J,q,$,nn,tn,en,E,S,O,rn,n,on,un,an;function fn(n,t){for(var i,e,i=0,e=0;e<n.length;e++)n[e]===t&&i++;return i}function sn(){var i=[];return A.GC$.each(x.sR().wmt,function(n,t){x.Functions.Mmt[n]&&(t.name=n,i.push(t))}),i}function cn(n){var i=[],e;return A.GC$.each(n,function(n,t){(e=t.description())&&(e.name=n,i.push(e))}),i}function G(n){var t,t,t=x.getMapping()&&x.getMapping().builtInFunctionsMapping,t=t&&t[n]&&t[n].alias||n;return g.j0(t)}function ln(n,t,i){var i;return i?(i=new RegExp(O,"g"),n.replace(i,"")===t.replace(i,"")):n===t}function vn(n){for(var t,i,e,r,o,u,t=[],i=0,e="";e!==C;)e=n.getColumnName(i),o=void 0,n.Mf.NMi&&(o=n.FDi(i))&&(r=i),i++,e!==C&&t.push({name:e,description:"",isGroupColumn:o});return u={columns:t},b(r)||(u.groupInfo={rightGroupColumnIndex:r}),u}function hn(i,n,t,e,r,o){var u,a,t,n,f,s,c,u=i.parent,a=u&&u.options;(n&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox||t)&&(i.il&&i.il.destroy(),i.il=new an(n,null,u),i.Bde=i.il,t=i.il.text(),n=i.getFormulaInformation(e,r,o),t[0]!==rn||n&&n.hasFormula||t===rn||a.allowInvalidFormula||i.il.text(t="'"+t),f=i.il,s=i.rt,c=i.Dn,f.bind("AppendStarted",function(){f.close();var n=i.Di;1!==n&&(i.Di=1,i._i(n,1))}),f.bind("AppendEnded",function(){c.ID()}),f.bind(j,function(n,t){var t;i.xT||(t&&t.type!==p&&(s.By(t),t=i.getCellType(e,r,o),i.ki(A.Events.EditChange,{sheet:i,sheetName:i.name(),row:e,col:r,editingText:t.getEditorValue(i.li)})),c.ID(),i.ki(A.Events.FormulaTextBoxTextChanged,{sheet:i,sheetName:i.name(),text:f.text(),sheetArea:o}))}),f.bind("CaretChanged",function(){c.ID(),i.ki(A.Events.FormulaTextBoxCaretChanged,{sheet:i,sheetName:i.name(),caret:f.caret()})}),f.add(sn()),f.add(cn(x.Functions.Tmt)),f.add(cn(i.Amt).concat(cn(u.Amt))),c.ID())}function gn(n){n.il&&(n.il.destroy(),n.il=C,n.Bde=C,n.Dn.ID());var t=n.parent&&n.parent.h6;U()===(t&&t.Ti)&&n.rt.aA()}function dn(n,t){var n,i,e,i,e,r,i,n,o,e,o,n=(0,A.GC$)(n);return n.attr("contenteditable","false"),i=u("table"),(0,A.GC$)(i).css("border-spacing","0"),(0,A.GC$)(i).css("width","100%"),n.append(i),e=u("tbody"),i.appendChild(e),i=document.createElement("tr"),e.appendChild(i),e=document.createElement("td"),(0,A.GC$)(e).css("padding-right","0px"),i.appendChild(e),r=document.createElement("td"),(0,A.GC$)(r).css("width","23px"),(0,A.GC$)(r).css("padding-right","0px"),i.appendChild(r),i=n.width()-(0,A.GC$)(r).width(),n=u("div"),o=u("div"),(0,A.GC$)(o).width(i),(0,A.GC$)(o).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),o.appendChild(n),e.appendChild(o),e=u("div"),r.appendChild(e),(0,A.GC$)(n).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),(0,A.GC$)(n).width(i),(0,A.GC$)(n).attr("contenteditable","true"),(0,A.GC$)(n).attr("spellcheck","false"),(o=(0,A.GC$)(e)).css({display:"block",float:"right",width:"23px",height:"23px",background:$,"background-repeat":"no-repeat"}),o.bind("click",function(){t.Imt?(t.Vv.ki("RangeSelectEnding",t),t.endSelectMode()):t.startSelectMode()}),{contentDiv:n,button:e}}function In(n){for(var t,i,t=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","PIVOTBY","GROUPBY","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"],i=0;i<t.length;i++)if(n===t[i])return 1}function k(n,t,i){var e,r,t,t,o,u,e=this,r=n;if(e.rl=!1,e.Ivt=!1,e.xmt=!0,e.Smt=!0,e.Nmt=[],e.kmt=[],e.Dmt=[],e.U6=!1,t&&t.rangeSelectMode&&(!0===t.absoluteReference&&(e.Ivt=!0),!1===t.needSheetName&&(e.Smt=!1),!1===t.acrossSheet&&(e.xmt=!1),e.Pve=t.needFuncHelp,e.lBe=t.convertStructureReference,e.Xvt=t.selectionUnit,e.rl=!0,e.Imt=!1,e._mt=!1,r=(t=dn(e.Emt=n,e)).contentDiv,e.jmt=t.button,e.Avt=un,un++),e.cmt=!0,e.Hc(i&&i.getHost()||s.body),r&&e.Rmt(r),i&&(e.Bmt=!0,e.Lmt(i),e.Vv._3(A.Events.ActiveSheetChangingInternal+M,l.wvt.Ovt),e.Vv.D3(A.Events.ActiveSheetChangingInternal+M,l.wvt.Ovt),e.Vv._3(A.Events.ActiveSheetChangedInternal+M,l.wvt.Bvt),e.Vv.D3(A.Events.ActiveSheetChangedInternal+M,l.wvt.Bvt),e.Vv._3(A.Events.FormulaTextBoxUpdatePosition+R,void 0),e.Vv.D3(A.Events.FormulaTextBoxUpdatePosition+R,function(n,t){e.u_()})),t=e.text(),e.Fmt=e.Ost(t),o=e.vmt(r)){e.Pmt(e.Fmt);try{(u=v.getSelection()).selectAllChildren(r),0<u.rangeCount&&u.collapseToEnd()}catch(n){}(0,A.GC$)(e.Ti).data(E,t)}(0,A.GC$)(n).data(a.CONST_FORMULATEXTBOX,e)}function mn(){var n,t,i,t,n=v.getSelection();0<n.rangeCount&&(t=n.getRangeAt(0),(i=s.createElement("span")).innerHTML="<br/>\u200b",t.insertNode(i),(t=s.createRange()).setStartAfter(i),t.setEndAfter(i),t.collapse(!1),n.removeAllRanges(),n.addRange(t))}function P(n){return"gcAttachedFormulaTextBox"===n.target.getAttribute("gcuielement")}Object.defineProperty(a,"__esModule",{value:!0}),a.FormulaTextBox=a.Wvt=a.Evt=a.CONST_FORMULATEXTBOX=void 0,x=n("CalcEngine"),F=n("SheetsCalc"),h=n("Common"),A=n("Core"),l=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),C=null,f=void 0,c=Math.max,L=Math.min,e=A.GC$.extend,u=A.mt.En,U=A.mt.ai,v=window,s=document,g=h.Common.zf,d=A.mt.vi,b=h.Common.lt.ht,i=A.mt.Tt,I=i.msie&&parseInt(i.version,10)<10,m=g.Gmt,a.CONST_FORMULATEXTBOX="formulatextbox",r="gcUIElement",p="input",T="\xa0",R=".gcFormulaTextBoxInternal",o=".gcFormulaTextBox",M=".gcFormulaTextBoxAcrossSheetInternal",w=".gcsj-func-ac-row",j="TextChanged",y="CaretChanged",Z="AppendStarted",z="AppendEnded",Y=37,Q=39,D=38,B=40,N=9,W=13,V=33,X=34,K=35,H=36,J=27,q=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],$='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',nn='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',tn="background",en="background-repeat",E="text-before",S="caret-before",O="\u200b",rn="=",A.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",A.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",A.Events.FormulaTextBoxUpdatePosition="FormulaTextBoxUpdatePosition",v.gcGlobal.wf.push(function(n,t){var i,t,i=l.wvt;!t&&n.endEdit&&i&&(t=i.Rvt)&&t.bvt&&n.il&&(n.il&&n.il.destroy(),n.il=C,n.Bde=C,t.rl||t.d5())}),a.Evt=hn,a.Wvt=gn,A.Worksheet.ch(a.CONST_FORMULATEXTBOX,{startEdit:function(n){n.preventFormulaTextBox||hn(this,n.element,f,n.row,n.col,n.sheetArea)},endEdit:function(){gn(this)},preProcessKeyDown:function(n){var t,t,i,i,t=this.il;(t&&t.$D(n.e)||(i=(t=this.parent)&&t.h6)&&i.$D(n.e,n.c)||(i=t&&t.ske)&&i.$D(n.e,n.c))&&(n.r=!0)}}),n=A.Hv.prototype,on=n.O2,A.Hv.ch(a.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(n){var t,t,t,i,t=(0,A.jf)(this.Vv),t=t?t.il:void 0,t=t&&t.Dvt(),i=l.wvt.Rvt;t?n.r=!1:i&&i.bvt&&i.d5()}}),n.O2=function(){var n=(0,A.jf)(this.Vv),n=n&&n.il,t=l.wvt.Rvt,t=t&&t._text;return on.call(this)&&!t&&!n},un=1,k.prototype.Umt=function(n){var t,i,e,i,n,r,o,t=this;t.Hmt(),t.FD(),t._mt=!0,i=(0,l.Mvt)(t.Vv.Ti),(e=(t.Vv.ske=t).zmt())&&(e.suspendPaint(),hn(e,i,!0,e.ui,e.ci,3),(i=e.il).rl=!0,i.Avt=t.Avt,i.Ivt=t.Ivt,i.Smt=t.Smt,i.Xvt=t.Xvt,i.xmt=t.xmt,i.lBe=t.lBe,n&&(t.text(n),t.caret(n.length)),n=t.text(),(r=t.caret())<=0&&(r=n.length),t.focus(),t.caret(r),t.XD=!0,-(t.umt=1)!==(o=n.lastIndexOf(",",r))&&(t.umt=o+1),n||(t.text("="),n="=",t.caret(1),r=1),"="!==n[0]&&(n="="+n,r++),i.text(n),i.caret(r),i.XD=t.XD,i.umt=t.umt,e.resumePaint())},k.prototype.startSelectMode=function(n){var n,t,n=n;n&&0!==n.indexOf("=")&&(n="="+n),(t=this).rl=!0,t.Imt=!0,(0,A.GC$)(t.jmt).css([tn,en],[nn,"no-repeat"]),t.Umt(n)},k.prototype.endSelectMode=function(){this.Imt=!1,this.Vmt(),(0,A.GC$)(this.jmt).css([tn,en],[$,"no-repeat"]);var n=l.wvt.Rvt;n&&n.bvt&&n.d5()},k.prototype.Vmt=function(){var n,n,t,n=this.Vv;n&&(n.ske=null),(n=this.zmt())&&(n.ol(!(t=!1),f,!0,void 0,!1),n.repaint())},k.prototype.Ak=function(n){n&&(this.Dmt=[n])},k.prototype.Hce=function(){this.Dmt=C},k.prototype.Ymt=function(){return this.Dmt},k.prototype.destroy=function(){var n=this;n.Imt&&n.Vmt(),n.Dmt=C,n.XD=!1,n.umt=-1,n.Zmt(),n.Wmt(),n.Qmt(),(0,A.GC$)(n.Kmt).remove(),(0,A.GC$)(n.Jmt).remove(),(0,A.GC$)(n.F0).remove()},k.prototype.bind=function(n,t,i){var e=this.Ti;e&&n&&(n=n.split(/\s+/).join(o+" "),(0,A.GC$)(e).bind(n+o,t,i))},k.prototype.unbind=function(n,t){var i=this.Ti;i&&n&&(n=n.split(/\s+/).join(o+" "),(0,A.GC$)(i).unbind(n+o,t))},k.prototype.unbindAll=function(){var n=this.Ti;n&&(0,A.GC$)(n).unbind(o)},k.prototype.caret=function(n){var t,i,e,r,t=this,i=t.Ti;if(i){if(e=U()===i,r=(0,A.GC$)(i),0===arguments.length)return e?t.Xmt(i).end:r.data(S);n!==t.caret()&&(e?(t.qmt(i,n),r.data(S,t.Xmt(i).end)):r.data(S,n),t.ki(y,{}))}},k.prototype.Xmt=function(n){var t,i,e,t,t,r,t=this,i=-1,e=-1;return t.$mt(n)?(i=n.selectionStart,e=n.selectionEnd):t.vmt(n)&&0<(t=v.getSelection()).rangeCount&&((r=(t=t.getRangeAt(0)).cloneRange()).selectNodeContents(n),r.setEnd(t.endContainer,t.endOffset),e=r.toString().length,(r=t.cloneRange()).selectNodeContents(n),r.setEnd(t.startContainer,t.startOffset),i=r.toString().length,r.detach()),{start:i,end:e}},k.prototype.qmt=function(n,t){var i,t,e,i,r,i=this;i.$mt(n)?n.setSelectionRange(t,t):i.vmt(n)&&(i=this.tgt(n,t))&&(t=v.getSelection(),e=s.createRange(),(r=i.node)&&1===r.childNodes.length?e.setStart(r.firstChild,i.offset):r.lastChild&&r.lastChild.length&&e.setStart(r.lastChild,r.lastChild.length),e.collapse(!0),t.removeAllRanges(),t.addRange(e),this.rl)&&(n.parentElement.scrollTop=n.parentElement.scrollHeight)},k.prototype.text=function(n){var t,i,e,r,o,u,a,f,s,s,s,u,a,t=this,i=t.Ti,e=t.zmt();if(!i)return"";if(!e||e.xT)return i.innerHTML="";if(r=e.getActiveRowIndex(),o=e.getActiveColumnIndex(),A.mt.HRe(r,o,e)&&t.kgt(!(n="")),u=t.$mt(i),a=t.vmt(i),f=t.hfe(i),0===arguments.length){if(s="",u)s=i.value;else if(a){if(t.b0r())return"";0<=(s=(s=I?A.mt.oi(i):i.innerText).replace(/\r\n?/g,"\n")).indexOf(T)&&(s=A.mt.yi(s,T," "))}else f&&0<=(s=(s=I?A.mt.oi(i):i.innerText).replace(/\r\n?/g,"\n")).indexOf(T)&&(s=A.mt.yi(s,T," "));return s}(n=null==n?"":n)!==t.text()&&(s=t.ngt(n),t.Fmt=s?t.Ost(s):t.Ost(n),u?i.value=n:a?(s=t.egt(t.Fmt,n),t.Pmt(s),t.caret(n.length)):f?i.innerHTML=n:i.value=n,u={},(a=l.wvt.Rvt)&&a._text&&(u={sheet:a.Mf,editor:a.bvt&&a.bvt.firstChild.firstChild,canvasOffset:a.yvt}),t.ki(j,u)),t.igt&&!A.mt.HRe(r,o,e)&&t.rgt()},k.prototype.I6=function(){var n=this;(0,A.GC$)(n.Ti).data(E,n.text())},k.prototype.autoComplete=function(n){if(0===arguments.length)return this.ogt;this.ogt=n},k.prototype.showHelp=function(n){if(0===arguments.length)return this.agt;this.agt=n},k.prototype.add=function(n){var t,i;if(n)if(A.GC$.isArray(n))for(t=n.length,i=0;i<t;i++)this.ZP(n[i]);else this.ZP(n)},k.prototype.ZP=function(n){var t,i,e,r,o,t=n&&m(G(n.name));if(t){for(e=(i=this.ugt).length,r=0;r<e;r++){if((o=m(i[r].name))===t)return;if(t<o)break}i.splice(r,0,n)}},k.prototype.remove=function(n){var t,i,e;if(n)for(n=m(n),i=(t=this.ugt).length,e=0;e<i;e++)if(m(t[e].name)===n){t.splice(e,1);break}},k.prototype.workbook=function(n){var t=this;if(0===arguments.length)return t.Vv;n===C?t.rl&&t.Vmt():(t.Lmt(n),t.sgt())},k.prototype.Lmt=function(n){var t,i;n&&((t=this).Vv&&t.Wmt(),i=t.Ti)&&(t.Vv=n)},k.prototype.smt=function(){var n,t,i,e,r,o,u,a,f,s,n=[],t=this.Fmt,i=t&&t.length,o=0,u=0;if(0<i)for(a=0;a<i;a++)r=(e=t[a]).text,11===e.type&&(f={textOffset:o,text:r,ranges:e.ranges,index:u,allowDrag:e.allowDrag},"number"==typeof e.sheetArea&&(f.sheetArea=e.sheetArea),n.push(f),u++),o+=r.length;return(s=this.Fvt)&&n.push({ranges:[s],index:u,allowDrag:!1,isPivotClickCell:!0}),n},k.prototype.zvt=function(){var n,t,i,e,r,o,u,n=this.Ti,t=this.smt();if(n&&t&&0<t.length)for(i=this.caret(),e=t.length,o=r=void 0,u=0;u<e;u++){if((o=(r=t[u]).textOffset)<=i&&i<=o+r.text.length)return r;if(i<=o)break}return C},k.prototype.ymt=function(n){var t,i,n;return!!n&&(t=this.caret(),i=n.text,(n=n.textOffset)<=t)&&t<=n+i.length},k.prototype.pmt=function(n){var t,i,e,r,o,u,a,f,s,t=this.smt(),i=t.length;if(n<0||i<=n)return"";for(e=[],u=o=0;u<i;u++){for(r=t[u],a=!1,f=0;f<e.length;f++)if(r.text&&e[f].text.replace(/\s+/g,"").toUpperCase()===r.text.replace(/\s+/g,"").toUpperCase()){a=!0;break}if(a){if(n===u){o=f;break}}else if(e.push(r),n===u){o=e.length-1;break}}return q[o%q.length]},k.prototype.Dvt=function(){var n,t,n;return!!this.XD||!!this.rl||!!(0,A.Df)(this.text())||!!(n=this.cgt(this.caret()))&&(t=n.type,n=n.text,1===t||8===t||7===t&&"%"!==n||5===t||9===t||15===t)},k.prototype.bmt=function(n){var t,i,t;return!(!n||!this.XD)&&(t=this.umt,i=this.caret(),t<=(t=n.textOffset))&&t<i},k.prototype.fmt=function(){var n,t,i,e,r,n=[],t=this.smt(),i=t.length;if(0<i)for(r=0;r<i;r++)e=t[r],this.bmt(e)&&n.push(e);return n},k.prototype.Gvt=function(n,t,i,e,r){var o,u,u,a,f,s,i,t,t,c,i,e,a;if(void 0===r&&(r=A.SheetArea.viewport),u=(o=this).Ti,n&&u){if(!o.XD){if(!o.Dvt())return;o.XD=!(t=!1),o.umt=o.caret(),o.ki(Z,{})}u=o.umt,a=o.text(),f=o.caret(),a||(a="=",f=u=o.umt=1),s=f,i&&(t=!1,a=a.substr(0,u)+(f<0?"":a.substr(f)),o.Fmt=o.Ost(a),s=f=u),i=o.cgt(f),t?(t=(t=a.substr(0,f)).substr(0,t.length-i.text.length)).length>=u&&(i.text=n,s=t.length+n.length):(t=o.Fmt,c=h.Common.Uf.hD(t,i),i=o.rl&&1<t.length&&c===t.length-1&&11===i.type,e?(n=u<f||i?a+this.fgt()+n:a.slice(0,f)+n+a.slice(f),o.Fmt=o.Ost(n)):u<f||i?(t.splice(c+1,0,{text:this.fgt(),type:8}),t.splice(c+2,0,{text:n,type:11,sheetArea:r}),n=","+n):t.splice(c+1,0,{text:n,type:11,sheetArea:r}),s=f+n.length),o.lgt(),e={},(a=l.wvt.Rvt)&&a._text&&(e={sheet:a.Mf,editor:a.bvt&&a.bvt.firstChild.firstChild,canvasOffset:a.yvt}),o.ki(j,e),o.caret(s)}},k.prototype.qD=function(){var n=this;n.XD&&(n.XD=!1,n.umt=-1,n.ki(z,{}))},k.prototype.Nvt=function(){this.XD=!0,this.umt=this.caret()},k.prototype.Tvt=function(n){return void 0!==n&&(this.umt=n),this.umt},k.prototype.Vde=function(n,t,i){var e,r,o,u,a,f,s,c,l,e=this,r=e.Ti;if(r&&!(n<0)&&t){for(o="",u=!1,f=(a=e.Fmt)&&a.length,l=c=0;l<f;l++){if(11===(s=a[l]).type&&c++===n){a[l]={text:t,type:11,sheetArea:s.sheetArea},u=!0;break}o+=s.text}u&&(e.lgt(),e.ki(j,{}),i?e.caret(e.text().length):e.caret(o.length+t.length))}},k.prototype.sgt=function(){var n,t,t,n=this;n.Vv&&(t=n.Ti,n.Vv)&&t&&(t.setAttribute(r,"gcAttachedFormulaTextBox"),n.rl||(n.Vv.h6=n),n.Vv.D3(A.Events.FormulaTextboxEditStarted+R,n,n.hgt),n.Vv.D3(A.Events.EnterCellInternal+R,n,n.dgt),n.Vv.D3(A.Events.FormulaTextboxEditEnded+R,n,n.vgt),n.Vv.D3(A.Events.ActiveSheetChangedInternal+R,n,n.mgt),n.Vv.D3(A.Events.RangeChangedInternal+R,n,n.ggt),n.Vv.D3(A.Events.FormulaTextBoxTextChanged+R,n,n.pgt),n.Vv.D3(A.Events.FormulaTextBoxCaretChanged+R,n,n.bgt),n.Vv.D3(A.Events.ValueChanged+R,n,n.ygt),n.Vv.D3(A.Events.CellChanged+R,n,n.ygt),(t=(0,A.jf)(n.Vv))&&!n.rl&&n.text(n.wgt(t,t.ui,t.ci)),n.D3(j,n,n.Mgt),n.D3(y,n,n.Cgt))},k.prototype.refresh=function(n){var t,i,t,t=this.Vv,i=this;t&&(t=(0,A.jf)(t))&&!i.rl&&(i.rb=!!n||i.rb,i.text(i.wgt(t,t.ui,t.ci)),i.rb=!1)},k.prototype.Wmt=function(){var n=this,t=n.Vv;!n.Bmt&&t&&(n.rl||(t.h6=null,t._3(A.Events.FormulaTextboxEditStarted+R,n.hgt),t._3(A.Events.EnterCellInternal+R,n.dgt),t._3(A.Events.FormulaTextboxEditEnded+R,n.vgt),t._3(A.Events.ActiveSheetChangedInternal+R,n.mgt),t._3(A.Events.RangeChangedInternal+R,n.ggt),t._3(A.Events.FormulaTextBoxTextChanged+R,n.pgt),t._3(A.Events.FormulaTextBoxCaretChanged+R,n.bgt),t._3(A.Events.ValueChanged+R,n.ygt),t._3(A.Events.CellChanged+R,n.ygt),n._3(j,n.Mgt),n._3(y,n.Cgt)),n.text("")),n.Vv=null},k.prototype.Hmt=function(){var n,t,t,n=this;n.rb||(n.rb=!0,(t=(t=this.Vv)&&(0,A.jf)(t))&&!t.isEditing()?(n.rl||t.f6(null,t.ui,t.ci,null,null,!1,null),n.Sgt=!0):t&&1===t.Di?(t.Di=2,t._i(1,2)):n.Sgt=!1,n.rb=!1,n.Tgt)||n.w6()},k.prototype.Agt=function(){var n=this,t=n.Ti,i=n.Igt;t.insertBefore(i,t.firstChild),i.innerText=n.igt},k.prototype.xgt=function(n,t){var i;n&&this.Ngt!==t&&(this.Ngt=t,n.style.display=t?"":"none")},k.prototype.rgt=function(){var n,t,i,e,n=this,t=n.Ti,i;n.vmt(t)?((e=n.Igt)||((e=n.Igt=u("span")).className="gcsj-func-gray-formula"),n.xgt(e,!0),n.Agt()):t.placeholder=n.igt},k.prototype.b0r=function(){var n,t,n=this,t=n.Igt;return t&&"none"!==t.style.display&&n.Ti.contains(t)},k.prototype.kgt=function(n){var t,n,i,t=this;(t.igt||n)&&(t.igt="",n=t.Ti,(i=t.vmt(n))?t.xgt(t.Igt,!1):n&&(n.placeholder=""))},k.prototype.FD=function(){var n,t,t,i,e,r,o,u,e,n=this,t=n.Vv,t=t&&(0,A.jf)(t);t&&(i=t.il,n.Sgt&&i&&(e=i.text(),ln(r=n.text(),e,!0)||(o=n.caret(),u=t.getFormulaInformation(t.getActiveRowIndex(),t.getActiveColumnIndex(),3),n.text(e),u.isArrayFormula&&(o>=r.length&&(o-=1),o=c(0,o-1)),n.caret(o))),n.Sgt&&i||n.rl)&&2!==(e=t.Di)&&(t.Di=2,t._i(e,2))},k.prototype.wgt=function(n,t,i){var e,r,r,o,o,u,e="";if(n){if(r=(r=n.parent)&&r.options,(o=n.getFormulaInformation(t,i,3))&&o.hasFormula){if(e="="+o.formulaWithCulture,o.isDynamicArray)return this.igt=e,"";this.igt="",o.isArrayFormula&&(e="{"+e+"}")}else o=n.getActualStyle(t,i),e="string"==typeof(u=n.getValue(t,i))&&(o.quotePrefix||1<u.length&&"="===u[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+u:A.mt.mi(o,u,n,{sheet:n,row:t,col:i,sheetArea:3})||"";this.kgt()}return e},k.prototype.Ove=function(){var n,t,i,i,n,e,i,t=this,i=t.Vv,i=i&&(0,A.jf)(i),n=i.ui,e=i.ci,i=i.getCellType(n,e);!1===(null==(n=null==i?void 0:i.editable)?void 0:n.call(i))&&t.ike(!0)},k.prototype.ike=function(n){var t,i,e,t,t=this,i=t.Ti;i&&(e=t.$mt(i),t=t.hfe(i),e?i.disabled=n:t&&(i.contentEditable=n?"false":"true"))},k.prototype.mgt=function(n,t){var n,i,e,n=n.data;n.rb||(i=t.newSheet,n.rl)||(n.rb=!0,n.close(),t&&i&&n.text(n.wgt(i,i.ui,i.ci)),n.rb=!1)},k.prototype.hgt=function(n,t){var n,i,i,i,n=n.data;n.rb||(i=(i=(i=n.Vv)&&(0,A.jf)(i))&&i.il)&&n.rl===i.rl&&n.Avt===i.Avt&&t.sheetArea!==A.SheetArea.colHeader&&t.sheetArea!==A.SheetArea.rowHeader&&(n.kgt(),n.rb=!0,n.text(i.text()),n.rb=!1)},k.prototype.dgt=function(n,t){var n=n.data;n.rl||n.rb||(n.rb=!0,t&&(n.text(n.wgt(t.sheet,t.row,t.col)),n.Ti)&&n.ike(!!t.readonly),n.rb=!1)},k.prototype.ggt=function(n,t){var n,i,e,r,o,t,n=n.data;n.rb||n.rl||(n.rb=!0,t&&(i=t.sheet,e=t.row,r=t.col,o=t.rowCount,t=t.colCount,new A.Range(e,r,o,t).contains(i.ui,i.ci))&&n.text(n.wgt(i,i.ui,i.ci)),n.rb=!1)},k.prototype.vgt=function(n,t){var n,i,n=n.data;n.rl&&n.Imt&&n._mt?t.ignore=!0:n.rb||t.sheetArea!==A.SheetArea.colHeader&&t.sheetArea!==A.SheetArea.rowHeader&&(n.rb=!0,n.close(),(i=l.wvt.Rvt)&&i.Mf&&i.Mf!==t.sheet&&i._6(t.sheet),t&&t.sheet.il&&!t.sheet.il.rl&&!n.rl&&n.text(n.wgt(t.sheet,t.row,t.col)),n.rb=!1)},k.prototype.ygt=function(n,t){var i,e,i=t.sheet,e=i&&i.parent&&i.parent.h6;e&&e.Dgt()===t.row&&e._gt()===t.col&&e.zmt()===i&&n.data instanceof k&&(n.data.rl||("[styleinfo]"===t.propertyName&&n.data.Ove(),t.text=n.data.wgt(i,t.row,t.col),n.data.pgt(n,t)))},k.prototype.pgt=function(n,t){var n,i,n=n.data;n.rb||t.sheet.il&&(n.rl!==t.sheet.il.rl||n.Avt!==t.sheet.il.Avt)||t.sheetArea===A.SheetArea.colHeader||t.sheetArea===A.SheetArea.rowHeader||(n.rb=!0,t&&(i=n.caret(),n.text(t.text),n.caret(i)),n.rb=!1)},k.prototype.bgt=function(n,t){var n=n.data;n.rb||t.sheet.il&&(n.rl!==t.sheet.il.rl||n.Avt!==t.sheet.il.Avt)||(n.rb=!0,t&&n.caret(t.caret),n.rb=!1)},k.prototype.Mgt=function(n){var n,t,t,i,e,r,o,u,r,n=n.data;if(!n.rb&&(t=(t=n.Vv)&&(0,A.jf)(t))){if(t.isEditing()||(n.Hmt(),n.focus()),n.rb=!0,i=t.ui,e=t.ci,r=t.il,o=t.getCellType(i,e),r){if(n.rl!==r.rl||n.Avt!==r.Avt)return;u=r.caret(),r.text(n.text()),r.caret(u)}else r={sheet:t,row:i,col:e,sheetArea:3},o.setEditorValue(t.li,n.text(),r);n.rb=!1}},k.prototype.Cgt=function(n){var n,t,t,t,n=n.data;n.rb||(t=(t=n.Vv)&&(0,A.jf)(t))&&t.isEditing()&&((t=t.il)&&(n.rl!==t.rl||n.Avt!==t.Avt)||(n.rb=!0,t&&(t.caret(n.caret()),n.w6()),n.rb=!1))},k.prototype.Hc=function(n){var t,i,e,e,t=this;t.Egt=!1,t.XD=!1,t.umt=-1,t.ugt=[],t.ogt=!0,t.agt=!0,t.Ogt=!0,(i=u("div")).className="gcsj-func-ac-popup",i.style.display="none",i.setAttribute(r,"gcFuncACPopup"),n.insertBefore(i,C),t.Kmt=i,t.Tgt=!1,(e=u("div")).className="gcsj-func-help-popup",e.style.display="none",e.setAttribute(r,"gcFuncHelpPopup"),n.insertBefore(e,C),t.Jmt=e,(t.Rgt=!1,A.GC$)(i).bind("mouseover",function(){t.Ogt=!1}).bind("mouseout",function(){t.Ogt=!0}),(0,A.GC$)(e).bind("mouseover",function(){t.Ogt=!1}).bind("mouseout",function(){t.Ogt=!0}),(0,A.GC$)(i).bind("scroll",function(){t.Bgt&&clearTimeout(t.Bgt),t.Bgt=v.setTimeout(function(){t.Ti&&t.Ti.focus()},100)}),(e=u("div")).style.display="none",e.setAttribute(r,"gcFuncHelpDiv"),n.insertBefore(e,C),t.F0=e,t.Vv=null,t.rb=!1,t.Sgt=!1,t.Bmt=!1},k.prototype.Rmt=function(n){var s,c,t;n&&(c=(s=this).vmt(n),s.$mt(n)||s.LIr(n)||c)&&(t=(0,A.GC$)(n),s.Ti&&s.Zmt(),s.Ti=n,i&&(i.msie||i.chrome)?c||I||i.chrome?(s.D3("focus",function(){t.data(E,s.text())}),s.D3("click",function(){t.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(n){s.D3(n,function(n){s.Lgt(n)})})):s.D3(p,function(){s.Fgt()}):s.D3(p,function(){var n;c&&(n=s.Ti.lastChild,i.chrome)&&n&&"BR"===n.tagName&&s.Ti.removeChild(n),s.Fgt()}),s.D3("keydown",function(n){var t,i,e,r,o,u,a,f,a,a,f,t=n.ctrlKey,i=n.shiftKey,e=n.altKey,r=n.metaKey,o,u=n.keyCode;t||i||e||r||!s.Tgt||(u===B?(s.Pgt(1),d(n)):u===D?(s.Pgt(-1),d(n)):u===N&&(s.Ggt(),d(n))),u===J&&s.close(),s.Ugt(n),f=(a=(0,A.jf)(s.Vv))&&a.rt.Pi(n),s.rl&&f&&(a=a.il)&&a.XD&&a.qD(),c&&(f?(8===u?P(n)&&A.di.processBackspaceAndLeftArrowKeyEvent(n,!0):46===u&&P(n)&&A.di.processDeleteAndRightArrowKeyEvent(n,!0),s.mmt()):13===u&&(t||e)?(P(n)&&mn(),s.mmt(!0)):37===u?P(n)&&A.di.processBackspaceAndLeftArrowKeyEvent(n,!1):39===u&&P(n)&&A.di.processDeleteAndRightArrowKeyEvent(n,!1),c)&&t&&(90===u||89===u)&&d(n),a=s.text(),A.mt.Qf()&&c&&r&&(f=void 0,90===u)&&(i?(f=s.kmt.pop())&&(s.text(f),s.Nmt.push(a)):(f=s.Nmt.pop()||"",s.text(f),s.kmt.push(a)),n.preventDefault(),n.stopPropagation())}),s.D3("keyup",function(n){var t,i,e,n;s.Ugt(n),t=s.text(),c&&(i=void 0,e=n.keyCode,(n=n.ctrlKey)&&90===e?(i=s.Nmt.pop()||"",s.text(i),s.kmt.push(t)):n&&89===e&&(i=s.kmt.pop())&&(s.text(i),s.Nmt.push(t)))}),s.D3("focus",function(n){var t;i&&i.mozilla&&!s.Ti.innerText&&(s.Ti.innerText=""),s.Ugt(n),s.rl&&s.Imt&&(s._mt=!0,s.Umt())}),s.D3("blur",function(){s.Ogt&&s.close(),s.rl&&(s.Vmt(),s._mt=!1)}),s.D3("mousedown",function(){var n={r:C};A.Worksheet.et(s.zmt(),"preProcessFormulaTextBoxEdit",n),n.r||(s._mt=!0,s.Ngt&&s.igt&&(s.kgt(),s.Hgt=!0),s.Hmt())}),s.D3("mouseup",function(){var n,t;s.Hgt&&(s.Hgt=!1,(n=s.Ti)!==(t=v.getSelection()).anchorNode)&&t.selectAllChildren(n),s.FD()}),s.D3("click",function(n){var t,t,t;s.XD&&s.qD(),(t=(t=(t=s.Vv)&&(0,A.jf)(t))&&t.il)&&t.XD&&!t.rl&&t.qD(),s.Ugt(n)}),s.D3("compositionstart",function(){s.Egt=!0}),s.D3("compositionend",function(n){s.Egt=!1,(i.edge||i.chrome||i.msie)&&s.Lgt(n)}))},k.prototype.Zmt=function(){var n,t,t,n=this,t=n.Ti;t&&((t=(0,A.GC$)(t)).removeData(E),t.removeData(S),t.removeAttr(r),t.data(a.CONST_FORMULATEXTBOX)&&t.data(a.CONST_FORMULATEXTBOX,C),n.E3(),n.unbindAll(),n.rl&&((0,A.GC$)(n.Emt).empty(),n.Emt=C),n.Ti=C)},k.prototype.Lgt=function(n){var t,i,e,r,t=this,i=(0,A.GC$)(t.Ti),e=t.text(),r={r:C};A.Worksheet.et(t.zmt(),"preProcessFormulaTextBoxEdit",r),r.r?n.preventDefault():i.data(E)!==e&&(t.Egt||i.data(E,e),t.Fgt())},k.prototype.Ugt=function(n){var t;i&&i.msie?setTimeout(function(n,t){return function(){n.zgt(n,t)}}(this,n),10):this.zgt(this,n)},k.prototype.zgt=function(n,t){var i,e,i,t,e,i,t,i=t.keyCode,e=i===Y||i===Q||i===H||i===K||i===X||i===V||i===N||i===W;n.ogt||(e=e||i===D||i===B),i=void 0!==t.button,(e||i)&&(t=n.Ti,e=(0,A.GC$)(t),(i=n.Xmt(t)).start===i.end)&&(t=i.end,e.data(S)!==t)&&(e.data(S,t),n.ki(y,{}),n.w6())},k.prototype.Dgt=function(n){var n,t,n,n=n||this.zmt();return n?(t=n.ui,(n=n.vA)?n.row:t):f},k.prototype._gt=function(n){var n,t,n,n=n||this.zmt();return n?(t=n.ci,(n=n.vA)?n.col:t):f},k.prototype.Qvt=function(n){var n,t,n,n=n||this.zmt();return n?(t=A.SheetArea.viewport,(n=n.vA)?n.sheetArea:t):f},k.prototype.zmt=function(){if(this.Vv)return(0,A.jf)(this.Vv)},k.prototype.parseInternal=function(n,t,i,e,r){var o,u,a,a;return void 0===r&&(r=A.SheetArea.viewport),o=this,u=[],(0,A.kf)(n)&&fn(n,'"')%2!=1?(a=new x.Parser,a=F.Vgt(a,n,t,i,e,!0,f,f,r),u=o.Ygt(a,n)):u.push({text:n,type:17}),u},k.prototype.Ost=function(n){var t,i,e,t,i,r,t=this.Vv&&1===this.Vv.options.referenceStyle,i=l.wvt.Rvt,e=this.zmt();return t&&i&&i.Mf&&i.Mf!==e&&(e=i.Mf),t=this.Dgt(e),i=this._gt(e),r=this.Qvt(e),this.parseInternal(n,e,t,i,r)},k.prototype.Fgt=function(){var n,t,i,e,r,i,n=this,t=n.text();"\n"!==t&&0<=t.indexOf("\n")?n.ki(j,{type:p}):(i=n.Ti,e=(0,A.GC$)(i),n.Fmt=n.Ost(t),n.vmt(i)?n.Egt||("\n"===t?(e.empty(),n.ki(j,{type:p})):(r=n.caret(),n.Pmt(n.Fmt),n.ki(j,{type:p}),n.caret(r))):n.ki(j,{type:p}),r=n.caret(),e.data(S)!==r&&(e.data(S,r),n.ki(y,{})),(i=n.zmt())&&i.ignoreShowFunctions&&i.ignoreShowFunctions()||(n.Zgt(),n.Tgt)||n.w6())},k.prototype._CR=function(){return h.Common.CultureManager.Fe().NumberFormat},k.prototype.Qgt=function(){var n=this._CR();return n&&n.arrayGroupSeperator||";"},k.prototype.Kgt=function(){var n=this._CR();return n&&n.arrayListSeparator||","},k.prototype.fgt=function(){var n=this._CR();return n&&n.listSeparator||","},k.prototype.Jgt=function(){var n=this._CR();return n&&n.numberDecimalSeparator||"."},k.prototype.Ygt=function(n,t){for(var i,e,r,o,u,a,f,s,c,l,v,v,i=[],e=[],r=t&&"="!==t[0],o=this.Qgt(),u=this.Kgt(),a=!1,f=0;f<n.length;f++)0<f&&f<n.length-1&&";"===n[f-1].text&&","===n[f].text&&"ARRAYROW"===n[f+1].text||(s=n[f],c=this.Xgt(s,e),l=s.text,2===c?i.push({text:l,type:c}):a&&8===c&&","===l?i.push({text:u,type:9}):a&&8===c&&";"===l?i.push({text:o,type:10}):8===c?i.push({text:l,type:c}):3===c?("ARRAY"===l&&(a=!0),i.push({text:"{",type:3})):4===c?"ARRAY"===l||"}"===l?(a=!1,i.push({text:"}",type:4})):i.push({text:l,type:4}):6===c?i.push({text:")",type:c}):13===c?i.push({text:h.Common.st.Ge(l),type:c,ranges:s.ranges,allowDrag:s.canDrag}):1===c&&r||null!==c&&(11===c&&n[f+1]&&"#"===n[f+1].text&&s.ranges&&0<s.ranges.length?(v=new x.CalcReference(this.zmt().qgt,s.ranges).getSpillRef())&&v.$gt&&(f++,s.ranges=v.$gt,l+="#"):11===c&&l.length===s.endIndex-s.index&&"!"===t[s.endIndex]&&(l+="!"),v={text:l,type:c,ranges:s.ranges,allowDrag:s.canDrag},11===c&&(v.sheetArea=s.sheetArea),i.push(v)));return i},k.prototype.Xgt=function(n,t){var i,e,r,n,r,i=n.type,e=n.subType,r=n.text,n=n.value;if(1===i){if(1===e)return"ARRAY"===r||"ARRAYROW"===r?(t.push(3),3):(t.push(5),"@"===n||"("===n.trim()?5:2);if(2===e){if(")"===n.trim())return 6;if(0<t.length){if(3===(r=t[t.length-1]))return t.pop(),4;if(5===r)return t.pop(),6}}if("="===n.trim())return 1}else if(3===i){if(0===e)return 8}else{if(5===i||6===i||4===i)return 7;if(0===i)return 7===e||0===e||12===e?11:5===e?12:4===e?13:3!==e&&6===e?16:14;if(7===i)return 15;if(8===i);}return 17},k.prototype.lgt=function(){for(var n,t,i,e,r,o,n=this,t=n.Ti,i=n.Fmt,e="",r=i&&i.length,o=0;o<r;o++)e+=i[o].text;n.$mt(t)?t.value=e:n.vmt(t)&&n.Pmt(i)},k.prototype.$mt=function(n){var n=n&&n.tagName;return"TEXTAREA"===n||"INPUT"===n},k.prototype.LIr=function(n){var t,n,t=n&&n.tagName,n=n&&n.getAttribute("gcuielement");return"DIV"===t||"gcComboBox"===n},k.prototype.vmt=function(n){return n&&"DIV"===n.tagName&&"true"===n.contentEditable},k.prototype.hfe=function(n){return n&&"DIV"===n.tagName},k.prototype.t2t=function(n){return"gcEditingInput"===(0,A.GC$)(n).attr(r)},k.prototype.D3=function(n,t,i){var e=this.Ti;e&&n&&(n=n.split(/\s+/).join(R+" "),(0,A.GC$)(e).bind(n+R,t,i))},k.prototype._3=function(n,t){var i=this.Ti;i&&n&&(n=n.split(/\s+/).join(R+" "),(0,A.GC$)(i).unbind(n+R,t))},k.prototype.E3=function(){var n=this.Ti;n&&(0,A.GC$)(n).unbind(R)},k.prototype.ki=function(n,t){var i=this.Ti;i&&(0,A.GC$)(i).trigger(n,t)},k.prototype.cgt=function(n){var t,i,e,r,o;if(!(n<=0)&&0<(i=(t=this.Fmt)&&t.length))for(r=void(e=0),o=0;o<i;o++)if(n<=(e+=(r=t[o]).text.length))return r;return C},k.prototype.n2t=function(){var n,t,i,e,r,e,o,n=this.Vv;if(n&&(t=(0,A.jf)(n))&&(i=t.getCalcService().allowDynamicArray,e=t.il)){for(r=[].concat(e.ugt),A.Worksheet.et(t,"getAllFunctions",e={funcs:r,isFuncGet:!1}),o=(r=e.funcs).length-1;0<=o;o--)!i&&r[o]&&In(r[o].name)?r.splice(o,1):b(r[o].isFunc)&&(r[o].isFunc=!0);return e.isFuncGet?r:r.concat(this.e2t(n,t)).concat(this.i2t(n.sheets)).concat(this.r2t(n))}return this.ugt},k.prototype.e2t=function(n,t){var i,t,t,i=[],t=t.getCustomNames();return t&&A.GC$.each(t,function(n,t){i.push({name:t.Zc,description:t.TZ})}),(t=n.getCustomNames())&&A.GC$.each(t,function(n,t){i.push({name:t.Zc,description:t.TZ})}),i},k.prototype.i2t=function(n){var e=[];return n.forEach(function(n){var n,t,i,n=n.tables;if(n&&(t=n.all()))for(i=0;i<t.length;i++)e.push({name:t[i].name(),description:x.sR().Fbx_TableName_Description+t[i].name()})}),e},k.prototype.r2t=function(n){for(var t,i,e,t=[],i=n.mp,e=0;e<i.length;e++)i[e]._gi===A.SheetType.tableSheet&&t.push({name:i[e].name(),description:x.sR().Fbx_TableSheetName_Description+i[e].name()});return t},k.prototype.o2t=function(n,t){var i,e,r,o;for(n=m(n),g.OS(n,"[")&&(n=n.substr(n.lastIndexOf("[")+1),n=g.Vi(n,"@","")),i=[],e=t&&t.length,o=0;o<e;o++)r=t[o],0===m(G(r.name)).indexOf(n)&&i.push(r);return i},k.prototype.a2t=function(){var n,t,i,e,r,o,n=this.caret();if(!(n<=0)&&0<(i=(t=this.Fmt)&&t.length))for(r=void(e=0),o=0;o<i;o++){if(e+(r=t[o]).text.length>=n)return r.text.substring(0,n-e);e+=r.text.length}return""},k.prototype.u2t=function(){for(var n,t,i,e,r,o,u,a,f,s,c,l,v,h,n=this.caret(),t=this.Fmt,i=t&&t.length,e=[],r=0,u=0;u<i;u++){if(o=t[u],e.push(o),6===o.type)for(a=0;0<e.length;)if(6===(f=e.pop()).type&&a++,5===f.type&&a--,0===a){0<e.length&&(f=e[e.length-1])&&2===f.type&&e.pop();break}if(n<=(r+=o.text.length))break}if(0<e.length)for(s=0;0<e.length;)if(8===(o=e.pop()).type)s++;else if(2===o.type){for(c=m(o.text),v=(l=this.n2t())&&l.length,h=void 0,u=0;u<v;u++)if(h=l[u],m(G(h.name))===c)return{func:h,activeParamterIndex:s,isFunc:h.isFunc};break}return C},k.prototype.Zgt=function(){var t,n,i,e,r,o,u,a,e,f,s,t=this,n=t.s2t(),i;if(!(t.ogt&&(0,A.kf)(t.text())&&n&&0<n.length&&(!t.XD||t.Pve)&&!t.Egt)||t.rl&&!t.Pve)t.f2t();else{for(t.c2t(),e=t.Kmt,8<n.length?(e.style.height="204px",e.style.overflowY="scroll"):(e.style.height="auto",e.style.overflowY=""),r="",o=n.length,u=void 0,a=0;a<o;a++)r+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(u=n[a]).isFunc+">"+G(u.name)+"</div><div class='gcsj-func-ac-row-description'>"+(u.description||"")+"</div></div>";(e=(0,A.GC$)(t.Kmt)).html(r).show(),t.Tgt=!0,0<(f=e.find(w)).length&&(s="gcsj-ac-row-active",(0,A.GC$)(f[0]).addClass(s),f.bind("mouseover",function(){t.$cr||(f.removeClass(s),(0,A.GC$)(this).addClass(s))}),f.bind("click",function(){t.Ggt()}),t.Ngi)&&f.bind("mousedown",function(n){t.Ggt(),d(n)}),t.u_()}},k.prototype.Qmt=function(){var n,t,n=this,t=(0,A.GC$)(n.Kmt).find(w);t&&(t.unbind("mouseover"),t.unbind("click"),n.Ngi)&&t.unbind("mousedown")},k.prototype.s2t=function(){var n,t,i,e,r,t,r,o,u,a,f,s,t,n=this,t=n.cgt(n.caret()),i=t&&t.text,e=[],r=n.Fmt.indexOf(t);if(t&&14===t.type)return e;if(t=this._getTable(r),0<(r=n.h2t(r,t)).length){if(o=[],!t.Mf.NMi)for(f in u=JSON.parse(JSON.stringify(x.sR().d2t)),a=x.getMapping()&&x.getMapping().tableFunctionsMapping,u)(s=a&&a[u[f].name])&&(u[f].name=s),o.push(u[f]);if(e=e.concat(r).concat(o),g.dT(i,"[")||g.dT(i,"[@"))return e}else e=this.n2t();return t=[],t=(i=n.a2t())?n.o2t(i,e):t},k.prototype._getTable=function(n){var t,i,e,t,n,t,e,t,t=this.Fmt;return!(n<0||!t||n>=t.length)&&(e=(i=this.Vv)&&(0,A.jf)(i),b(n)&&(n=t.length),e)?(t=t[n],n=g.gmt(t.text,"["),e=(t=e.tables)&&t.findByName(n),b(e)&&(t=i.getSheetTab(n))&&t._gi===A.SheetType.tableSheet?t:e):null},k.prototype.h2t=function(n,t){var i=[];return i=b(t)?i:vn(t).columns},k.prototype.f2t=function(){(0,A.GC$)(this.Kmt).hide(),this.Tgt=!1},k.prototype.Pgt=function(n){var t,i,e,r,o,u,a,f,s,t=this,i=(0,A.GC$)(this.Kmt).find(w),e=i.length;if(0!==e){if(r="gcsj-ac-row-active",o=0,n)for(u=0;u<e;u++)if((0,A.GC$)(i[u]).hasClass(r)){o=u+n;break}a=(0,A.GC$)(this.Kmt).scrollTop(),i.removeClass(r),(f=0)<e&&(f=i[0].offsetHeight),o=c(o,0),s=i[o=L(o,e-1)],(0,A.GC$)(s).addClass(r),this.$cr=!0,s.offsetTop+s.offsetHeight>(0,A.GC$)(this.Kmt).scrollTop()+(0,A.GC$)(this.Kmt).height()?(0,A.GC$)(this.Kmt).scrollTop((0,A.GC$)(this.Kmt).scrollTop()+f):s.offsetTop<(0,A.GC$)(this.Kmt).scrollTop()?(0,A.GC$)(this.Kmt).scrollTop(s.offsetTop):(0,A.GC$)(this.Kmt).scrollTop(a),setTimeout(function(){delete t.$cr})}},k.prototype.Ggt=function(){var n,t,i,t,e,r,o,u,a,f,s,c,l,v,h,h,l,c,h,n=this,t=(0,A.GC$)(n.Kmt).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),i=t.text(),t="true"===t.attr("isFunc");if(i){for(e=n.caret(),o=(r=n.Fmt)&&r.length,f=a=u=0,s=C;f<o&&!(e<=u+(a=(s=r[f]).text.length));)f++,u+=a;c=e-u,l=s.text,h=v=0,g.OS(l,"[")?-1===(v=l.lastIndexOf("[",c-1))?(v=l.indexOf("["),s.text=-1===v?i:i+l.substr(v),v=0):("@"===l.charAt(++v)&&(v+=1),-1===(h=l.indexOf("]",c))&&(h=l.length),s.text=l.substring(0,v)+i+l.substr(h)):(s.text=i,(h=l.substr(c))&&1<(l=n.Ost("="+h)).length&&r.splice(f+1,0,l[1])),s.type=t?2:11,h=r[c=f+1],!t||h&&5===h.type||r.splice(c,0,{text:"(",type:5}),n.f2t(),n.Ti.focus(),n.lgt(),n.caret(u+i.length+v+(t?1:0)),n.w6(),n.Fmt=n.Ost(n.text()),n.ki(j,{})}},k.prototype.w6=function(){var n,t,t,i,e,r,o,u,a,f,s,c,l,v,h,g,d,I,m,p,t,n=this,t=n.zmt();if(!(t&&t.ignoreShowFunctions&&t.ignoreShowFunctions()))if(n.Tgt&&n.f2t(),(t=n.u2t())===C||!0!==t.isFunc)n.c2t();else if(i=n.fgt(),!(e=n.agt&&(0,A.kf)(n.text())&&t&&!n.XD&&!n.Egt)||n.rl&&!n.Pve)n.c2t();else{for(u=(o=(r=t.func).parameters)&&o.length,a=L(u-1,t.activeParamterIndex),f=void 0,s="",c=0;c<u;c++){if(l=(f=o[c]).name,f.optional){if(v=[l],f.repeatable)for(h=c+1;h<u&&(!b(o[h])&&o[h].optional&&o[h].repeatable);h++)v.push(o[h].name),c++;l="["+v.join(i+" ")+"]"}f.repeatable&&(l+=i+" ..."),g=c===u-1?"":i+" ",s+=l=c===a?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+l+"</span>"+g:"<span class='gcsj-func-help-paramter'>"+l+"</span>"+g}t=(d="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+G(r.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+s+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>")+(p="<div class='gcsj-func-help-body'>"+(m="<div class='gcsj-func-help-section-content'>"+(I="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+x.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(r.description||"")+"</div></div>")+"</div>")+"</div>"),(0,A.GC$)(n.Jmt).html(t).show(),n.Rgt=!0,n.u_()}},k.prototype.c2t=function(){(0,A.GC$)(this.Jmt).hide(),this.Rgt=!1},k.prototype.close=function(){this.f2t(),this.c2t()},k.prototype.$D=function(n,t){var i,e,r,o,u,a,i=n.ctrlKey||n.shiftKey||n.altKey||n.metaKey,e=n.keyCode,r=n.ctrlKey,o=n.altKey,u=n.metaKey,a=n.srcElement||n.target;return n.target===this.Ti&&(46===e||8===e)||!this.XD&&(!(!this.Tgt||i||e!==B&&e!==D&&e!==N)||!!(a&&t&&t.isEditing&&"gcAttachedFormulaTextBox"===a.getAttribute("gcUIElement"))&&(67===e&&(r||u)&&!o||88===e&&(r||u)&&!o))},k.prototype.u_=function(){var n,n,t,i,n,n,e,n,r,o,u,a,f,i,r,i,n=this,t=C;n.Tgt?t=n.Kmt:n.Rgt&&(t=n.Jmt),t&&(i=n.Ti.getBoundingClientRect(),n.t2t(n.Ti)&&(n=null==(n=n.Ti.parentElement)?void 0:n.parentElement)&&(i=n.getBoundingClientRect()),e=(n=t.getBoundingClientRect()).height,n=n.width,r=s.body.clientHeight,o=s.body.clientWidth,u=i.left,a=i.top,f=i.width,i=i.height,t.style.position="fixed",r<(r=a+i)+e&&0<=a-e&&(r=a-e),o<(i=u)+n&&0<=u+f-n&&(i=u+f-n),(0,A.GC$)(t).css("top",r).css("left",i))},k.prototype.focus=function(){(0,A.GC$)(this.Ti).focus()},k.prototype.Pmt=function(n){for(var t,i,e,r,o,u,a,f,s,t=this,i="",e="",r=n&&n.length,o=0,a=0;a<r;a++)f="",11===(u=n[a]).type&&(f=" style='color: "+t.pmt(o)+"'",o++),t.F0.innerText=u.text,i+="<span"+f+" class='gcsj-func-color-text'>"+t.F0.innerHTML+"</span>",e+=u.text;if(e||t.text())if(s=t.Ti,i)s.innerHTML="<span class='gcsj-func-color-content'>"+i+"</span>";else for(;s.firstChild;)s.removeChild(s.firstChild)},k.prototype.tgt=function(n,t){var i,e,r,o,u,i=(0,A.GC$)(n).find(".gcsj-func-color-content .gcsj-func-color-text"),e=i.length;for(t=c(0,t),u=0;u<e;u++)if((t-=(o=(r=i[u]).innerText).length)<=0)return{node:r,offset:o.length+t};return o?{node:r,offset:o.length}:C},k.prototype.y6=function(n,t){var i,e,r,i=v.getSelection(),e=this.Ti.children[0],r=document.createRange();r.setStart(e,n),r.setEnd(e,t),i.removeAllRanges(),i.addRange(r)},k.prototype.mmt=function(n){var t,i,i,e,t=this,i=t.Ti,i=t.vmt(i),e=t.text();i&&e&&(e=n?e.substr(0,e.length-2):e,t.Nmt.push(e))},k.prototype.egt=function(n,t){var i,e,r,o,u,a,f,s,c;if(t)for(o=t.length,u=r=e=i=0;u<n.length;u++){for(a=n[u].text;e<o;e++)if((f=t[e].toUpperCase())===(s=a[r]?a[r].toUpperCase():void 0))r+=1;else{if("\n"!==f)break;e+1<o&&t[e+1]===O&&(e+=1)}c=t.substring(i,e),u===n.length-1&&"\n"===c[c.length-1]&&(c=c.substring(0,c.length-1)),n[u].text=c,i=e,r=0}return n},k.prototype.ngt=function(n){var t,i,e,r,o;if("="===n[0]&&-1!==n.indexOf("\n")){for(i=n.length,e=!(t=[]),r=0;r<i;r++)(e='"'===(o=n[r])?!e:e)||"\n"!==o?t.push(o):r+1<i&&n[r+1]===O&&(r+=1);return t.join("")}},k.prototype.isOutFormulaTextBox=function(n){if(0===arguments.length)return this.Ngi;this.Ngi=n},an=k,a.FormulaTextBox=an},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},e={},n=r("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).FormulaTextBox=n}();