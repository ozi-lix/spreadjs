/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@mescius/spread-sheets")):"function"==typeof define&&define.amd?define(["@mescius/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@mescius/spread-sheets")):t(GC)}(function(r){function i(t){var n,n,n=o[t];return void 0!==n||(n=o[t]={exports:{}},e[t].call(n.exports,n,n.exports,i)),n.exports}var e,o,t;e={"./dist/plugins/report/base/sheet-tab-base.js":function(t,n,i){"use strict";var o,r;function e(){}Object.defineProperty(n,"__esModule",{value:!0}),n.SheetTabBase=void 0,o=i("./dist/plugins/report/utils/utils.js"),e.prototype.name=function(t){var n=this.Mf;return n.name.apply(n,arguments),n.name()},e.prototype.getParent=function(){return this.Mf&&this.Mf.getParent()},e.prototype.visible=function(t){var n=this.Mf;return n.visible.apply(n,arguments)},e.prototype.e1e=function(){return this.Mf.options.sheetTabColor},e.prototype.hg=function(t){this.Mf.hg(t)},e.prototype.L0=function(t,n){var i;this.Mf.L0(t,n),t&&(this.E3(),this.UMi)&&this.UMi.detach()},e.prototype.Zg=function(t){this.Mf.Zg(t)},e.prototype.pM=function(t){this.Mf.pM(t)},e.prototype.b2=function(t,n){return this.Mf&&this.Mf.b2(t,n)},e.prototype.ow=function(){this.Mf.ow()},e.prototype.aw=function(){this.Mf.aw()},e.prototype.tw=function(){this.Mf.tw()},e.prototype.Wb=function(t,n){this.Mf.Wb(t,n)},e.prototype.Kb=function(t){this.Mf.Kb(t)},e.prototype.Fb=function(t,n){this.Mf.Fb(t,n)},e.prototype.onHorizontalDockScroll=function(t,n){this.Mf.onHorizontalDockScroll(t,n)},e.prototype.Gb=function(t){this.Mf.Gb(t)},e.prototype.WC=function(t,n,i){this.Mf.WC(t,n,i)},e.prototype.$C=function(t){this.Mf.$C(t)},e.prototype.QC=function(t,n,i){this.Mf.QC(t,n,i)},e.prototype.Cg=function(){this.Mf.Cg()},e.prototype.suspendPaint=function(){this.Mf.suspendPaint()},e.prototype.resumePaint=function(){var t=this.Mf.getDataSource();this.Mf.resumePaint()},e.prototype.isPaintSuspended=function(){return this.Mf.isPaintSuspended()},e.prototype.v3=function(t){var n,i,r,e,n=this.rM;if(n)for(i=0,r=n;i<r.length;i++)e=r[i],t.bind(e.type,e.data,e.fn)},e.prototype.bind=function(t,n,i){this.rM||(this.rM=[]),this.Mf.bind(t,n,i),this.rM.push({type:t,data:n,fn:i})},e.prototype.unbind=function(t,n){this.Mf.unbind(t,n),this.nwr(t,n)},e.prototype.unbindAll=function(){this.rM=[],this.Mf.unbindAll()},e.prototype.D3=function(t,n,i){this.rM||(this.rM=[]),this.Mf.D3(t,n,i),this.rM.push({type:t,data:n,fn:i})},e.prototype._3=function(t,n){this.Mf._3(t,n),this.nwr(t,n)},e.prototype.nwr=function(t,n){var i,r,e,i=this.rM;if(i)for(r=i.length-1;0<=r;r--)(e=i[r]).type!==t&&!(0,o.k3)(e.type,t)||void 0!==n&&e.fn===n||i.splice(r,1)},e.prototype.E3=function(){this.rM=[],this.Mf.E3()},e.prototype.parameter=function(t){return 0!==arguments.length&&(this.o1e=t),this.o1e},e.prototype.suspendEvent=function(){this.Mf.suspendEvent()},e.prototype.resumeEvent=function(){this.Mf.resumeEvent()},e.prototype.isEventSuspended=function(){return this.Mf.isEventSuspended()},e.prototype.bC=function(){this.Mf.bC()},e.prototype.ki=function(t,n,i){this.Mf.ki(t,n,i)},e.prototype.isEditing=function(){return this.Mf.isEditing()},e.prototype.ol=function(t,n,i,r){return this.Mf.ol(t,n,i,r)},e.prototype.currentTheme=function(t){var n=this.Mf;return n.currentTheme.apply(n,arguments)},e.prototype.FM=function(){this.Mf.FM()},e.prototype.uw=function(){return this.Mf.uw()},e.prototype.ot=function(){return this.Mf.ot()},e.prototype.hitTest=function(t,n,i,r){return this.Mf.hitTest(t,n,i,r)},e.prototype.toJSON=function(t){},e.prototype.fromJSON=function(t,n,i,r,e){},n.SheetTabBase=e},"./dist/plugins/report/calc-model/calc-model.js":function(t,n,i){"use strict";var h,r,l,e,o,u;function s(t,n,i,r){this.Anr=!1;var e=this;e.oji=n,e.uji=i,e.POt=r,e.nir(n,t),e.c5()}Object.defineProperty(n,"__esModule",{value:!0}),n.CalcModel=void 0,h=i("CalcEngine"),r=i("./dist/plugins/report/helpers/smart-cache.js"),l=i("./dist/plugins/report/utils/utils.js"),e=i("./dist/plugins/report/calc-model/helpers/hierarchical-cell-indexing-helper.js"),o=i("SheetsCalc"),s.prototype.nir=function(t,n){var i=this,r;i.POt.setReportContext(t,i,new e.HierarchicalCellIndexingHelper(i,t,n))},s.prototype.cji=function(){return this.POt.hierarchicalCellIndexingHelper},s.prototype.fji=function(){this.c5(),this.Anr=!0},s.prototype.hji=function(){this.Anr=!1},s.prototype.ltr=function(t){var n,t,n=this,t=(0,o.formulaToExpression)(n.POt.Mf.reportSheet.templateSheet,t);return this.vtr(n.POt.Mf.reportSheet,t),(0,o.expressionToFormula)(n.POt.Mf,t)},s.prototype.vtr=function(t,n){var i,r,e;if(8===n.type)this.ptr(t,n);else{if(n.arguments)for(i=0,r=n.arguments;i<r.length;i++)e=r[i],this.vtr(t,e);n.value&&this.vtr(t,n.value),n.value2&&this.vtr(t,n.value2)}},s.prototype.ptr=function(t,n){var i,r,e,o,t,i=t.parameter();if(i){for(o in e=n.value+"",i)i.hasOwnProperty(o)&&o.toUpperCase()===e.toUpperCase()&&(r=i[o]);void 0!==r&&("string"==(t=typeof r)?n.type=3:"boolean"==t?n.type=4:"number"==t?n.type=2:r instanceof Date&&(r=r.toString(),n.type=3),n.value=r)}},s.prototype.aji=function(t){var n,i,r,e,o,u,s,c,f,n=this,i=(0,l.lji)(t);if(!(0,l.ht)(i)){if(i=n.ltr(i),r=t.row,e=t.col,n.vji.get(r,e)||n.dji.get(r,e))return n.pji.get(r,e);if((u=n.W5i)[r]){if(u[r][e])return h.Errors.Value}else u[r]=[];return i.startsWith("{")&&i.endsWith("}")?o=t.value:(u[r][e]=!0,s=n.uji,f=(c=n.POt).getBaseRowCol(),c.setContext({row:r,col:e}),o=s.evaluate(c,i,0,0),u[r][e]=!1,this.POt.hierarchicalCellIndexingHelper.resetOffsetContent(),c.setContext(f)),n.pji.set(r,e,o),n.dji.set(r,e,!0),t.group.value=o,t.value=o,t.group.defaultFormula&&(t.group.defaultFormula=void 0),o}},s.prototype.wji=function(t,n,i){var r,e,o,r=this,e=r.uji,o=r.POt;return o.setContext({row:t,col:n}),i=r.ltr(i),e.evaluate(o,i,0,0)},s.prototype.Sl=function(t,n){return this.pji.get(t,n)},s.prototype.gji=function(t,n,i){this.vji.set(t,n,!0),this.pji.set(t,n,i),this.POt.hierarchicalCellIndexingHelper.resetRankCache(),this.reCalcCellsFrom(t,n)},s.prototype.Mji=function(t,n,i){var r,e,o;this.Anr&&(e=(r=this).jji,o={row:n,col:i},t.forEach(function(t){var n=t.row,t=t.col;(0,l.ht)(e[n])&&(e[n]=[]),(0,l.ht)(e[n][t])?e[n][t]=[o]:e[n][t].push(o)}))},s.prototype.Fnr=function(t,i){var r;this.Anr&&(r=this.jji,t.forEach(function(t){var n=t.row,t=t.col;(0,l.ht)(r[n])&&(r[n]=[]),(0,l.ht)(r[n][t])?r[n][t]=[i]:r[n][t].push(i)}))},s.prototype.brr=function(t,n){var i=[];return this.Orr(t,n,i),i},s.prototype.eG=function(){var t=this;t.pji=l.KEYWORD_UNDEFINED,t.uji=l.KEYWORD_UNDEFINED,t.POt.destroy(),t.POt=l.KEYWORD_UNDEFINED,t.dji=l.KEYWORD_UNDEFINED,t.jji=l.KEYWORD_UNDEFINED,t.vji=l.KEYWORD_UNDEFINED,t.W5i=l.KEYWORD_UNDEFINED},s.prototype.c5=function(){var t=this;t.pji=new r.SmartCache,t.dji=new r.SmartCache,t.vji=new r.SmartCache,t.POt.hierarchicalCellIndexingHelper.reset(),t.jji=[],t.W5i=[]},s.prototype.Orr=function(t,n,r,e){var i,o,u,i,s;void 0===e&&(e={}),i="".concat(t,"-").concat(n),!e[i]&&(e[i]=!0,i=(u=(o=this).jji)[t]&&u[t][n])&&(s=function(t){var n,t,i,n=t.row,t=t.col,i=o.oji.getCell(n,t);r.includes(i)||r.push(i),e["".concat(n,"-").concat(t)]||(0,l.ht)(u[n])||(0,l.ht)(u[n][t])||o.Orr(n,t,r,e)},i.forEach(function(t){Array.isArray(t)?t.forEach(function(t){s(t)}):s(t)}))},s.prototype.reCalcCellsFrom=function(t,n){var i,r,i=this,r=[];i.dji.reset(),i.Orr(t,n,r),r.forEach(function(t){i.aji(t)})},n.CalcModel=s},"./dist/plugins/report/calc-model/calc-source.js":function(t,n,i){"use strict";var r,e,S,y,R,o,L,P,x,u,s,c;function f(t,n,i){var n=c.call(this,t,n,i)||this;return n.Mf=t,n}function _(t,n,i){var r,e,o,u;if(t.arguments&&t.arguments.some(function(t){return t===n||8===t.type&&i.getCustomName(t.value)===n})||t.value===n||t.value2===n)return t.functionName;if(t.arguments)for(r=0,e=t.arguments;r<e.length;r++)if(u=_(o=e[r],n,i))return u;return t.value&&(u=_(t.value,n,i))||t.value2&&(u=_(t.value2,n,i))?u:void 0}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportCalcSource=void 0,S=i("CalcEngine"),y=i("./dist/plugins/report/utils/utils.js"),R=i("Core"),o=i("SheetsCalc"),L=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),x=e(["ROW","ROWS","COLUMN","COLUMNS","INDEX","SUMIF","SUMIFS","SCATTERSPARKLINE","BOXPLOTSPARKLINE","MONTHSPARKLINE","YEARSPARKLINE","HISTOGRAMSPARKLINE","RANGEBLOCKSPARKLINE"],P=["R.INDEX","R.RANK","R.R","R.A","R.V","R.PROPORTION","R.CUMULATIVE","R.YOY","R.MOM"],!0),c=o.SheetSource,r(f,c),f.prototype.setReportContext=function(t,n,i){this.Cji=t,this.mji=n,this.hierarchicalCellIndexingHelper=i},f.prototype.getResolver=function(){return this.resolvers},f.prototype.evaluateReference=function(t,n,i){return this.Crr(t,n,i)},f.prototype.Crr=function(t,n,i,r){var e,o,u,s,c,f,h,l,a,v,d,p,M,w,I,g,C,o,w,i,e,o,N,j,E,A,D,b,T,O,m;if(void 0===r&&(r=!1),o=(e=this).DJ,u=e.Cji,s=e.mji,c=isNaN(n.row)?0:n.row,f=isNaN(n.column)?0:n.column,d=t.getRange&&t.getRange(c,f),l=(0===c&&0===f||!t.rowRelative&&!t.columnRelative?(h=d.row,d):(h=(p=u.getCell(c,f)).cellNode.templateCell.row,p.cellNode.templateCell)).col,a=d.rowCount,v=d.colCount,M=t.source||n.source,w=n.WK,g=o?(I=o.row,o.col):(I=n.row,n.column),o=w&&t instanceof S.ReferenceExpression?_(w,t,n.source)||w.functionName:"",x.includes(o)){if(i||n.arrayFormulaMode)return w=void 0,t.endSource&&(w=n.getSheetRangeReference({source:t.source,endSource:t.endSource,row:d.row,col:d.col,rowCount:d.rowCount,colCount:d.colCount})),!((w=n.getReference(M,d))instanceof S.CalcReference)||(C=e.WCi(w,I,g),this.Nrr(C),P.includes(o))?w:C.length?(i=!(0,L.pCi)(C[0]),n.getReference(M,(0,L.dCi)(C,i)[0])):n.getReference(M,new R.Range(0,0,0,0));if(1<a||1<v){if(e=c>=d.row&&c<d.row+a,o=f>=d.col&&f<d.col+v,e&&o)h=c,l=f;else{if(!e&&!o)return S.Errors.Value;if(e&&1===v)h=c;else{if(!o||1!==a)return S.Errors.Value;l=f}}n.WK&&n.WK.ensureSingle&&(t.$9t=!0)}else if(-1===d.row&&-1===a){if(1!==v)return S.Errors.Value;h=c}else if(-1===d.col&&-1===v){if(1!==a)return S.Errors.Value;l=f}if(h===I&&l===g)return null;if((C=u.getCells(h,l,I,g))&&C.length&&this.Nrr(C),r)return;for(N=[],j=0,E=C;j<E.length;j++)p=E[j],A=(0,y.lji)(p)?s.aji(p):p.value,Array.isArray(A)?A.forEach(function(t){N.push(t)}):N.push(A);return new S.TwoDimensionalCalcArray([N])}if(d){for(D=[],b=0;b<a;b++)for(T=0;T<v;T++)if(C=u.getCells(h+b,l+T,I,g))for(this.Nrr(C),O=0,m=C;O<m.length;O++)p=m[O],A=(0,y.lji)(p)?s.aji(p):p.value,r||(Array.isArray(A)?A.forEach(function(t){D.push(t)}):D.push(A));return r?void 0:new S.TwoDimensionalCalcArray([D])}return S.Errors.Reference},f.prototype.getSheet=function(){return this.Mf},f.prototype.getBaseRowCol=function(){var t=this.DJ;if(t)return{row:t.row,col:t.col}},f.prototype.getValue=function(t,n){var i,r,i,i=this.Cji,r=this.mji,i=i.getCell(t,n);if(i)return(0,y.lji)(i)?r.aji(i):i.value},f.prototype.getCustomFunction=function(t){return this.Mf?this.Mf.Jbt(t):null},f.prototype.op=function(){return this.getCalcService()},f.prototype.setContext=function(t){this.DJ=t},f.prototype.destroy=function(){this.mji=y.KEYWORD_UNDEFINED,this.DJ=y.KEYWORD_UNDEFINED,this.resolvers=y.KEYWORD_UNDEFINED,this.Cji=y.KEYWORD_UNDEFINED},f.prototype.updateBranchPrecedents=function(t,n,i){var r,e,o,u,r=this;if(1===t.type)r.Crr(t,n,i,!0);else{if(t.arguments)for(e=0,o=t.arguments;e<o.length;e++)1===(u=o[e]).type?r.Crr(u,n,i,!0):r.updateBranchPrecedents(u,n,i);t.value&&r.updateBranchPrecedents(t.value,n,i),t.value2&&r.updateBranchPrecedents(t.value2,n,i)}},f.prototype.Nrr=function(t){var n,i,r,e,o,i;this.DJ&&(r=(i=(n=this).DJ).row,e=i.col,o=i.formula,i=i.triggerUpdatePrecedents,n.mji.Mji(t,r,e),i)&&R.Worksheet.et(n.getSheet(),"updatePrecedents",{row:r,col:e,cells:t,formula:o})},f.prototype.WCi=function(t,n,i){for(var r,e,o,u,s,c,f,h,r=t.getRow(),e=t.getColumn(),o=r+t.getRowCount()-1,u=e+t.getColumnCount()-1,s=this.Mf.reportSheet.templateSheet,c=this.Cji,f=[];r<=o;r++){for(;e<=u;e++)(h=s.getSpan(r,e))&&(h.row!==r||h.col!==e)||c.getCells(r,e,n,i).forEach(function(t){f.push(t)});e=t.getColumn()}return f},n.ReportCalcSource=f},"./dist/plugins/report/calc-model/helpers/hierarchical-cell-indexing-helper.js":function(t,n,i){"use strict";var m,S,i,y,l,r,i;function R(){return m.Functions.CALC_PRECISION||14}function e(t,n,i){this.Vnr={},this.Cji=n,this.mCi=i,this.mji=t,this.g_i={},this.gir={}}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchicalCellIndexingHelper=void 0,m=i("CalcEngine"),S=i("./dist/plugins/report/utils/utils.js"),i=i("Common"),y=i.Common.st.E8,(i=l=l||{})[i.noJuxtaposition=0]="noJuxtaposition",i[i.nonSkippingNumber=1]="nonSkippingNumber",i[i.skipNumber=2]="skipNumber",e.prototype.getYearOverYear=function(t,n,i,r){for(var e,o,u,s,c,n,f,h,l,a,v,d,p,M,h,w,I,g,C,N,j,E,e,A,D,b,T,O,h,w,s,I,e=this,o=e.Cji,u=e.mji,s=e.gir,c=n.getRow(),n=n.getColumn(),f=o.getCells(c,n,t.row,t.col)[0],h=i||r,l=o.getCells(h.getRow(),h.getColumn(),f.row,f.col)[0],a=e.Tnr({row:c,col:n},{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:f.row,col:f.col}),v=-1,p=0,M=a.length;p<M;p++)if((d=a[p]).row===f.row&&d.col===f.col){v=p;break}if(v<0)return m.Errors.Reference;for(h=l.cellNode.templateCell,w=e.mCi.tfr(h.row,h.col),s[I=this.Mir(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()})]||(s[I]=e.Tnr({row:h.row,col:h.col},w.upParent,w.leftParent,{row:l.row,col:l.col})),C=-1,j=0,E=(g=s[I]).length;j<E;j++){if((N=g[j]).row===l.row&&N.col===l.col){N=g[j-1],C=j-1;break}if(N.row>l.row&&N.col>l.col)break}if(C<0)return 0;if(e=o.getCells(c,n,N.row,N.col),i&&r){for(A=[],D=o.getCells(r.getRow(),r.getColumn(),f.row,f.col)[0],b=0,T=e;b<T.length;b++)O=T[b],(0,S.Enr)(O.group,D.group)&&A.push(O);e=A}return(h=e[v])&&(u.Mji([h],t.row,t.col),void 0!==h.value&&u.Anr||(h.value=(0,S.lji)(h)?u.aji(h):h.value||null)),w=+f.value,s=h&&+h.value,isNaN(w)&&(w=0),isNaN(s)&&(s=0),I="number"==typeof(I=(0,S.calculationValue)(w,s,1))?y(I,R()):I},e.prototype.getMonthOverMonth=function(t,n,i,r){var e,o,u,s,c,n,f,o,h,l,a,v,d,e,c,n,e=this,o=e.Cji,u=e.mji,s=e.gir,c=n.getRow(),n=n.getColumn(),f=o.getCells(c,n,t.row,t.col)[0],o=this.Mir(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()});for(s[o]||(s[o]=e.Tnr({row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:f.row,col:f.col})),a=-1,v=0,d=(h=s[o]).length;v<d;v++){if((l=h[v]).row===f.row&&l.col===f.col){a=v-1;break}if(l.row>f.row&&l.col>f.col)break}return(l=(0,S.ht)(a)?null:h[a])&&(u.Mji([l],t.row,t.col),void 0!==l.value&&u.Anr||(l.value=(0,S.lji)(l)?u.aji(l):l.value||null)),e=+f.value,c=l&&+l.value,isNaN(e)&&(e=0),isNaN(c)&&(c=0),a<0?0:"number"==typeof(n=(0,S.calculationValue)(e,c,1))?y(n,R()):n},e.prototype.Mir=function(t,n,i,r){var e,o,u,u,n,i,e,o=this.Cji,u=o.getCell(t.row,t.col).cellNode.templateCell,u="".concat(u.row,"_").concat(u.col,"_").concat(n.row,"_").concat(n.col,"_");return i&&(u=(n=o.getCells(i.row,i.col,t.row,t.col)[0])?"".concat(u).concat(n.row,"_").concat(n.col,"_"):u),u=r?(i=o.getCells(r.row,r.col,t.row,t.col)[0])?"".concat(u).concat(i.row,"_").concat(i.col,"_"):u:u},e.prototype.getCumulative=function(t,n,i,r){var e,o,u,s,c,n,f,o,h,l,a,v,d,p,M,w,e=this,o=e.Cji,u=e.mji,s=e.gir,c=n.getRow(),n=n.getColumn(),f=o.getCells(c,n,t.row,t.col)[0],o=this.Mir(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()});for(s[o]||(s[o]=e.Tnr({row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},t)),a=-1,d=[],M=p=v=0,w=(h=s[o]).length;M<w;M++){if((l=h[M]).row===f.row&&l.col===f.col){a=M-1;break}if(l.row>f.row&&l.col>f.col)break;void 0!==l.value&&u.Anr||(l.value=(0,S.lji)(l)?u.aji(l):l.value||null),p=+l.value,isNaN(p)&&(p=0),d.push(l),v+=p}return(l=(0,S.ht)(a)?null:h[a])&&u.Mji(d,t.row,t.col),p=+f.value,isNaN(p)&&(p=0),(0,S.calculationValue)(p,l&&v,0)},e.prototype.getProportion=function(t,n,i,r){var e,o,u,s,c,n,o,f,t,c,h,l,a,e=this,o=e.Cji,u=e.mji,s=e.gir,c=n.getRow(),n=n.getColumn(),o=o.getCells(c,n,t.row,t.col)[0],f=o&&+o.value;for(isNaN(f)&&(f=0),s[t=this.Mir(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()})]||(s[t]=e.Tnr({row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:o.row,col:o.col})),h=0,l=c=s[t];h<l.length;h++)void 0===(a=l[h]).value&&(a.value=(0,S.lji)(a)?u.aji(a):a.value||null);return e.Snr(f,c)},e.prototype.Tnr=function(t,n,i,r){var e,o,u,s,c,f,h,l,a,s,n,e,o=this.Cji,u=[];if(n&&i){for(s=o.getCells(n.row,n.col,r.row,r.col)[0],c=o.getCells(i.row,i.col,r.row,r.col)[0],h=0,l=f=o.getCells(t.row,t.col,s.row,s.col);h<l.length;h++)a=l[h],(0,S.Enr)(a.group,c.group)&&u.push(a);(0,S.atr)(u,"V"===s.cellNode.templateCell.expansionDirection)}else n||i?(n=o.getCells((s=n||i).row,s.col,r.row,r.col)[0],u=o.getCells(t.row,t.col,n.row,n.col),(0,S.atr)(u,"V"===n.cellNode.templateCell.expansionDirection)):(u=o.getCells(t.row,t.col),(0,S.atr)(u,!0));return u},e.prototype.getIndex=function(t,n,i){var r,e,o,u,s,o,c,f,h,r=this,e=this,o=e.Cji,u=e.mji,s=o.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],o=i?{row:i.getRow(),col:i.getColumn()}:null;return u.Mji([s],t.row,t.col),void 0!==s.value&&u.Anr||(s.value=(0,S.lji)(s)?u.aji(s):s.value||null),c=o?"-".concat(o.row,"-").concat(o.col):"",void 0===(f=this.Vnr["".concat(s.row,"-").concat(s.col,"-").concat(c)])&&(h=e.M_i(t,{row:n.getRow(),col:n.getColumn()},o)).forEach(function(t,n){r.Vnr["".concat(t.row,"-").concat(t.col,"-").concat(c)]=n+1,t===s&&(f=n+1)}),f},e.prototype.getRank=function(t,n,i,r,e){var o,u,s,c,i,n,i,f,h,h,h,f,n,h;return void 0===e&&(e=1),s=(u=(o=this).Cji).getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],c=o.j_i(t,n,i),i=i instanceof m.CalcReference?{row:i.getRow(),col:i.getColumn()}:i,i=(n=o.M_i(t,{row:n.getRow(),col:n.getColumn()},i)).length,(f=o.g_i[c])?(h=o.Cji.getCell(t.row,t.col).cellNode.templateCell,h="".concat(c,"_").concat(h.row,"_").concat(h.col),o.g_i[h]||(o.g_i[h]=f,o.Ynr(n,t))):(h=[].concat(n),o.C_i(c,h,t),o.Ynr(h,t)),(0,S.ht)(s.value)?null:(f=o.g_i[c])&&f[s.row]&&f[s.row][s.col]?(n=f[s.row][s.col],h=r?i-n.index+1:n.index,e===l.noJuxtaposition?h-=r?n.afterEmptyCellCount:n.beforeEmptyCellCount:e===l.skipNumber?h-=r?n.currentAfterEmptyCellCount:n.currentBeforeEmptyCellCount:r||(h=h+n.currentAfterEmptyCellCount-n.sameValueCount+n.currentAfterEmptyCellCount),h):void 0},e.prototype.coordinateExecute=function(t,n,i,r){var e,o,e,u,s,c,f,i,r,f,i,h,l,a,v,d,p,M,w,I,f,g,C,N,j,E,i,h,c;if("string"==typeof i&&"CURRENTPAGE"===i.toUpperCase())return e=this.Cji.getCellsInPage(n.getRow(),n.getColumn(),t.row,t.col),this.N_i(e,t);if(e=(o=this).Cji,u=o.m_i,s=o.mji,c=o.Cji,o.resetOffsetContent(),i||r)return(f=e.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0])?(i=o.Tnr({row:n.getRow(),col:n.getColumn()},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:f.row,col:f.col}),o.N_i(i,t)):m.Errors.Null;if(!u||!u.length)return o.N_i(e.getCells(n.getRow(),n.getColumn()),t);for(r=u[0].parent,f=e.getCells(r.row,r.col,t.row,t.col)[0],(i=o.mCi.tfr(f.cellNode.templateCell.row,f.cellNode.templateCell.col)).leftParent&&i.upParent?h=(a="H"===f.cellNode.templateCell.expansionDirection)?i.upParent:i.leftParent:(i.leftParent||i.upParent)&&(h=i.leftParent||i.upParent),h&&(l=e.getCells(h.row,h.col,t.row,t.col)[0]),v=[],d=[],p=0,M=u.length;p<M&&(w=u[p],!l||o.b_i(w.parent,{row:l.cellNode.templateCell.row,col:l.cellNode.templateCell.col})||(v.push(l),l=null),l=o.getCell(t,l,w));p++);if(0<v.length&&l){for(v.push(l),f=v[0],g=v[1],N=0,j=C=c.getCells(n.getRow(),n.getColumn(),f.row,f.col);N<j.length;N++)E=j[N],(0,S.Enr)(E.group,g.group)&&d.push(E);I=o.O_i(d,{row:n.getRow(),col:n.getColumn()},v,t)}else l&&(i=e.getCell(t.row,t.col),h=o.b_i({row:i.cellNode.templateCell.row,col:i.cellNode.templateCell.col},r),I=o.getCell(t,l,{parent:{row:n.getRow(),col:n.getColumn()},offset:0,isAbsolute:!1},!h));return I?I instanceof Array?o.N_i(I,t):(s.Mji([I],t.row,t.col),void 0!==(c=o.mCi.getValue(I.row,I.col))&&s.Anr?c:(0,S.lji)(I)?s.aji(I):I.value||null):null},e.prototype.getCell=function(t,n,i,r){var e,o,u,s,i,c,f,h,e,l,a,v,e=this,o=e.Cji,u=i.parent,s=i.isAbsolute,i=i.offset,c=n?{row:n.cellNode.templateCell.row,col:n.cellNode.templateCell.col}:null,f=e.M_i(t,u,c),h=o.getCells(u.row,u.col,t.row,t.col)[0],e=o.getCells(u.row,u.col,n&&n.row,n&&n.col);if(!h||r)return e;for(l=void 0,a=0,v=f.length;a<v;a++)if(f[a]===h){l=a;break}if(s){if(!i)return null;l=0<i?i-1:e.length+i}else l+=i;return e[l]},e.prototype.N_i=function(t,n){for(var i,r,e,o,u,s,i=this.mji,r=[],o=0,u=t;o<u.length;o++)s=u[o],void 0!==(e=this.mCi.getValue(s.row,s.col))&&i.Anr||(e=(0,S.lji)(s)?i.aji(s):s.value||null),Array.isArray(e)?e.forEach(function(t){r.push(t)}):r.push(e);return i.Mji(t,n.row,n.col),new m.TwoDimensionalCalcArray([r])},e.prototype.O_i=function(t,n,i,r){var e,o,u,s,i,e,r,c,f,h,e=this,o=e.Cji,u=o.getCell(r.row,r.col),s=i[0],i=i[1];if(!e.b_i({row:u.cellNode.templateCell.row,col:u.cellNode.templateCell.col},s)&&!e.b_i({row:u.cellNode.templateCell.row,col:u.cellNode.templateCell.col},i))return t;for(e=o.getCells(n.row,n.col,r.row,r.col)[0],r=o.getCells(s.cellNode.templateCell.row,s.cellNode.templateCell.col,e.row,e.col)[0],c=o.getCells(i.cellNode.templateCell.row,i.cellNode.templateCell.col,e.row,e.col)[0],f=o.getCells(n.row,n.col,r.row,r.col),h=0;h<f.length;h++)if((0,S.Enr)(u.group,c.group))return t[h]},e.prototype.b_i=function(t,n){var i,r,i=this,r=i.mCi.tfr(t.row,t.col);return r.leftParent?r.leftParent.row===n.row&&r.leftParent.col===n.col||i.b_i(t,r.leftParent):!!r.upParent&&(r.upParent.row===n.row&&r.upParent.col===n.col||i.b_i(t,r.upParent))},e.prototype.coordinateOffset=function(t,n,i){var r,e,r=this;r.m_i=r.m_i||[],(e=r.m_i).push({parent:{row:t.getRow(),col:t.getColumn()},offset:n,isAbsolute:i})},e.prototype.reset=function(){this.Hnr(),this.resetRankCache(),this.resetOffsetContent(),this.gir={}},e.prototype.resetRankCache=function(){this.g_i={}},e.prototype.resetOffsetContent=function(){this.m_i=void 0},e.prototype.Hnr=function(){this.Vnr={}},e.prototype.C_i=function(t,n,i){for(var r,e,o,u,s,c,f,h,l,a,v,d,p,M,w,r=this,e=r.g_i,o=r.mji,u=e[t]=[],c=0,f=n;c<f.length;c++)h=f[c],o.Mji([h],i.row,i.col),h.value=(0,S.lji)(h)?o.aji(h):h.value||null;for((n=n.filter(function(t){return!(0,S.ht)(t.value)})).sort(function(t,n){return t.value>n.value?1:-1}),a=n.length,p=d=v=l=0;v<a;v++)u[(s=n[v]).row]||(u[s.row]=[]),v&&s.value===n[v-1].value?(d++,p++,l++):p=l=0,u[s.row][s.col]={index:v+1,sameValueCount:l,beforeEmptyCellCount:d,currentBeforeEmptyCellCount:p};for(v=a-1,w=M=0;-1<v;v--)s=n[v],v<a-1&&s.value===n[v+1].value?(M++,w++,l++):w=l=0,u[s.row][s.col].afterEmptyCellCount=M,u[s.row][s.col].currentAfterEmptyCellCount=w,u[s.row][s.col].sameValueCount+=l},e.prototype.Ynr=function(t,n){var i,n,n,i=this,n=i.Cji.getCell(n.row,n.col),n=i.Cji.getCells(n.cellNode.templateCell.row,n.cellNode.templateCell.col).map(function(t){return{row:t.row,col:t.col}});i.mji.Fnr(t,n)},e.prototype.j_i=function(t,n,i){var r,e,t,o,e,r,e=this.Cji,t=e.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],o="";return i instanceof m.CalcReference&&(e=e.getCells(i.getRow(),i.getColumn(),t.row,t.col)[0],o=S.CONNECTOR+e.row+S.CONNECTOR+e.col),n.getRow()+S.CONNECTOR+n.getColumn()+o},e.prototype.M_i=function(t,n,i){var r,e,o,u,i,r,e=this.Cji,o=e.getCells(n.row,n.col,t.row,t.col)[0],u=[];return u=i?(i=e.getCells(i.row,i.col,t.row,t.col)[0],e.getCells(o.cellNode.templateCell.row,o.cellNode.templateCell.col,i.row,i.col)):e.getCells(n.row,n.col)},e.prototype.Snr=function(t,n){for(var i,r,e,o,u,n,i=0,e=0,o=n;e<o.length;e++)r=+(u=o[e]).value,isNaN(r)&&(i+=0),i+=r;return n="number"==typeof(n=(0,S.calculationValue)(t,i,1))?y(n,R()):n},n.HierarchicalCellIndexingHelper=e},"./dist/plugins/report/calc-model/supported-functions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.reportSupportFunctionNames=void 0,n.reportSupportFunctionNames=["SUM","EOMONTH","ISBLANK","NORMINV","COUNT","ISOWEEKNUM","ISERR","PEARSON","AVERAGE","NETWORKDAYS","ISERROR","PERCENTILE.EXC","CHAR","NETWORKDAYS.INTL","ISEVEN","PERCENTILE.INC","DATE","TIMEVALUE","ISFORMULA","PERCENTRANK.EXC","MAX","WEEKNUM","ISLOGICAL","PERCENTRANK.INC","MIN","WORKDAY","ISNA","PERMUT","TIME","WORKDAY.INTL","ISNONTEXT","PERMUTATIONA","ABS","YEARFRAC","ISNUMBER","PHI","CEILING","BESSELI","ISODD","POISSON.DIST","COMBIN","BESSELJ","ISTEXT","PROB","EVEN","BESSELK","N","QUARTILE.EXC","EXP","BESSELY","NA","QUARTILE.INC","FACT","BIN2DEC","SHEET","RANK.AVG","FLOOR","BIN2HEX","SHEETS","RANK.EQ","INT","BIN2OCT","FALSE","RSQ","LN","BITAND","IFERROR","SKEW","LOG","BITLSHIFT","IFNA","SKEW.P","LOG10","BITOR","IFS","SLOPE","MOD","BITRSHIFT","NOT","SMALL","PI","BITXOR","TRUE","STANDARDIZE","POWER","COMPLEX","XOR","STDEV.P","PRODUCT","CONVERT","ADDRESS","STDEV.S","RAND","DEC2BIN","COLUMN","STDEVA","RANDBETWEEN","DEC2HEX","COLUMNS","STDEVPA","ROUND","DEC2OCT","FORMULATEXT","STEYX","ROUNDDOWN","DELTA","HYPERLINK","T.DIST","ROUNDUP","ERF","ROWS","T.DIST.2T","SIGN","ERF.PRECISE","ACOT","T.DIST.RT","ODD","ERFC","ACOTH","T.INV","SQRT","ERFC.PRECISE","ARABIC","T.INV.2T","SUMSQ","GESTEP","BASE","T.TEST","TRUNC","HEX2BIN","CEILING.MATH","TRIMMEAN","SIN","HEX2DEC","CEILING.PRECISE","VAR.P","COS","HEX2OCT","COMBINA","VAR.S","TAN","IMABS","COT","VARA","SINH","IMAGINARY","COTH","VARPA","COSH","IMARGUMENT","CSC","WEIBULL.DIST","TANH","IMCONJUGATE","CSCH","Z.TEST","ASIN","IMCOS","DECIMAL","ASC","ACOS","IMCOSH","FACTDOUBLE","BAHTTEXT","ATAN","IMCOT","FLOOR.MATH","CLEAN","ATAN2","IMCSC","FLOOR.PRECISE","CONCAT","ASINH","IMCSCH","GCD","DBCS","ACOSH","IMDIV","ISO.CEILING","DOLLAR","ATANH","IMEXP","LCM","FINDB","DEGREES","IMLN","MROUND","FIXED","RADIANS","IMLOG10","MULTINOMIAL","JIS","CODE","IMLOG2","QUOTIENT","LEFTB","CONCATENATE","IMPOWER","ROMAN","LENB","EXACT","IMPRODUCT","SEC","MIDB","FIND","IMREAL","SECH","REPLACEB","LEFT","IMSEC","SERIESSUM","REPT","LEN","IMSECH","SQRTPI","RIGHTB","LOWER","IMSIN","SUMIF","SEARCH","MID","IMSINH","SUMIFS","SEARCHB","PROPER","IMSQRT","SUMPRODUCT","T","REPLACE","IMSUB","SUMX2MY2","TEXT","RIGHT","IMSUM","SUMX2PY2","TEXTJOIN","SUBSTITUTE","IMTAN","SUMXMY2","UNICHAR","TRIM","OCT2BIN","AVEDEV","UNICODE","UPPER","OCT2DEC","AVERAGEA","ENCODEURL","DATEDIF","OCT2HEX","AVERAGEIF","WEBSERVICE","DAY","ACCRINT","AVERAGEIFS","EURO","DAYS360","ACCRINTM","BETA.DIST","EUROCONVERT","HOUR","AMORDEGRC","BETA.INV","ISOMITTED","MINUTE","AMORLINC","BINOM.DIST","LAMBDA","MONTH","COUPDAYBS","BINOM.DIST.RANGE","OBJECT","NOW","COUPDAYS","BINOM.INV","PROPERTY","SECOND","COUPDAYSNC","CHISQ.DIST","REFRESH","TODAY","COUPNCD","CHISQ.DIST.RT","REDUCE","WEEKDAY","COUPNUM","CHISQ.INV","SCAN","YEAR","COUPPCD","CHISQ.INV.RT","CHITEST","AND","CUMIPMT","CHISQ.TEST","MEDIAN","IF","CUMPRINC","CONFIDENCE.NORM","RANGEBLOCKSPARKLINE","OR","DB","CONFIDENCE.T","RANK","SWITCH","DDB","COUNTA","HBARSPARKLINE","ROW","DISC","COUNTBLANK","VBARSPARKLINE","VALUE","DOLLARDE","COUNTIF","VARISPARKLINE","CORREL","DOLLARFR","COUNTIFS","PIESPARKLINE","BETADIST","DURATION","COVARIANCE.P","AREASPARKLINE","BETAINV","EFFECT","COVARIANCE.S","SCATTERSPARKLINE","BINOMDIST","FV","DEVSQ","LINESPARKLINE","CHIDIST","FVSCHEDULE","EXPON.DIST","COLUMNSPARKLINE","CONFIDENCE","INTRATE","F.DIST","WINLOSSSPARKLINE","COVAR","IPMT","F.DIST.RT","BULLETSPARKLINE","CRITBINOM","IRR","F.INV","SPREADSPARKLINE","EXPONDIST","ISPMT","F.INV.RT","STACKEDSPARKLINE","FDIST","MDURATION","F.TEST","BOXPLOTSPARKLINE","FTEST","MIRR","FINV","CASCADESPARKLINE","GAMMADIST","NOMINAL","FISHER","PARETOSPARKLINE","GAMMAINV","NPER","FISHERINV","MONTHSPARKLINE","HYPGEOMDIST","NPV","FORECAST","YEARSPARKLINE","MODE","ODDFPRICE","GAMMA","GAUGEKPISPARKLINE","NEGBINOMDIST","ODDFYIELD","GAMMA.DIST","HISTOGRAMSPARKLINE","NORM.INV","ODDLPRICE","GAMMA.INV","STDEV","NORMDIST","ODDLYIELD","GAMMALN","BC_QRCODE","NORMSDIST","PDURATION","GAMMALN.PRECISE","BC_EAN13","NORMSINV","PMT","GAUSS","BC_EAN8","PERCENTILE","PPMT","GEOMEAN","BC_CODABAR","PERCENTRANK","PRICE","GROWTH","BC_CODE39","POISSON","PRICEDISC","HARMEAN","BC_CODE93","QUARTILE","PRICEMAT","HYPGEOM.DIST","BC_CODE128","STDEVP","PV","INTERCEPT","BC_GS1_128","TDIST","RATE","KURT","BC_CODE49","TINV","RECEIVED","LARGE","BC_PDF417","TTEST","RRI","LOGNORM.DIST","BC_DATAMATRIX","VAR","SLN","LOGNORM.INV","LET","VARP","SYD","MAXA","IMAGE","WEIBULL","TBILLEQ","MAXIFS","TEXTBEFORE","ZTEST","TBILLPRICE","MINA","TEXTAFTER","CHIINV","TBILLYIELD","MINIFS","TEXTSPLIT","CHIDIST","VDB","MODE.MULT","GC.REGEXEXTRACT","LOGINV","XIRR","MODE.SNGL","GC.REGEXMATCH","LOGNORMDIST","XNPV","NEGBINOM.DIST","GC.REGEXREPLACE","DATEPART","YIELD","NORM.DIST","SJS.UUID","DATEVALUE","YIELDDISC","NORM.S.DIST","SJS.ENDWITH","DAYS","YIELDMAT","NORM.S.INV","SJS.STARTWITH","EDATE","ERROR.TYPE","SJS.REGEXEXTRACT","SJS.REGEXMATCH","SJS.REGEXREPLACE","R.R","R.A","R.V","R.INDEX","R.RANK","R.CURRENTPAGE","R.PAGESCOUNT","R.PROPORTION","R.CUMULATIVE","R.MOM","R.YOY"]},"./dist/plugins/report/commands/add-record.js":function(t,n,i){"use strict";var r,s,c,f,i,e,o,u,h;function l(t,n){return h.call(this,t,n)||this}function a(t){var n="reportSheetAddRecord";s.Commands[n]={canUndo:!1,execute:function(t,n,i){return e(t,o,n,i)}},t.register(n,s.Commands[n])}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerAddRecordCommand=void 0,s=i("Core"),c=i("./dist/plugins/report/events/index.js"),f=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=s.Commands.ActionBase,e=s.Commands.zA,r(l,h=i),l.prototype.execute=function(){var n,i,t,r,e,o,u;this.Mf&&this.Mf instanceof f.ReportWorksheet&&this.tT&&(n=this.Mf,i=n.reportSheet,t=this.tT,r=t.activeRow,e=t.activeCol,o=(0,c.Nji)(function(){n.reportSheet.addRecordAt(r,e)}),u={type:"insert",sheet:i,sheetName:i.name(),row:r,col:e,cancel:!1,oldValue:i.getValue(r,e),newValue:void 0},setTimeout(function(){var t;n.ki(s.Events.ReportSheetDataChanging,u),u.cancel||(o.addRecordSingleUseAction(),t={type:"insert",sheet:i,sheetName:i.name(),row:i.reportWorksheet.getActiveRowIndex(),col:i.reportWorksheet.getActiveColumnIndex()},n.ki(s.Events.ReportSheetDataChanged,t))}))},o=l,n.registerAddRecordCommand=a},"./dist/plugins/report/commands/chart-preview-visible.js":function(t,n,i){"use strict";var r,c,f,i,e,o,u,s;function h(t,n){return s.call(this,t,n)||this}function l(t){var n="ReportChartPreviewVisible";f.Commands[n]={canUndo:!0,execute:function(t,n,i){return e(t,o,n,i)}},t.register(n,f.Commands[n])}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.registerChartPreviewVisibleCommand=void 0,f=i("Core"),i=f.Commands.ActionBase,e=f.Commands.zA,r(h,s=i),h.prototype.execute=function(){var t,n,i,r,e,o,n,u,s,n,t=this,n=t.tT,i=!1;if(t.canExecute()){r=t.Mf,e=n.row,o=n.col,n=n.visible,(u=r.Ut).startTransaction(),t.X5(r,!0);try{(s=c({},r.getTemplateCell(e,o))).chartPreviewVisible=n,r.setTemplateCell(e,o,s),i=!0}finally{t.q5(r,!0),n=f.Commands.TI(r.name()),t.tT[n]=u.endTransaction()}}return i},h.prototype.undo=function(){var t,n,i,r,e,t=this,n=t.Mf,i=!1;if(t.canUndo()){t.X5(n,!0);try{r=f.Commands.TI(n.name()),e=t.tT[r],n.Ut.undo(e),i=!0}finally{t.q5(n,!0)}}return i},o=h,n.registerChartPreviewVisibleCommand=l},"./dist/plugins/report/commands/collapse-all.js":function(t,n,i){"use strict";var r,e,i,o,u,s,c;function f(t,n){return c.call(this,t,n)||this}function h(t){var n="reportSheetCollapseAll";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return o(t,u,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerCollapseAllCommand=void 0,e=i("Core"),i=e.Commands.ActionBase,o=e.Commands.zA,r(f,c=i),f.prototype.execute=function(){var h,t;this.canExecute()&&((h=this.Mf).suspendPaint(),((t=this.tT.selections)||[]).forEach(function(t){for(var n,i,r,e,o,u,s,c,f,n=t.row,i=t.rowCount,r=t.col,e,o=n+i-1,u=r+t.colCount-1,s=n;s<=o;s++)for(c=r;c<=u;c++)(f=h.getSpan(s,c))&&(f.row!==s||f.col!==c)||h.Oji(s,c,"Collapsed",!0,!0)}),h.invalidateLayout(),h.gP(),h.resumePaint())},u=f,n.registerCollapseAllCommand=h},"./dist/plugins/report/commands/delete-record.js":function(t,n,i){"use strict";var r,s,c,f,i,e,o,u,h;function l(t,n){return h.call(this,t,n)||this}function a(t){var n="reportSheetDeleteRecord";s.Commands[n]={canUndo:!1,execute:function(t,n,i){return e(t,o,n,i)}},t.register(n,s.Commands[n])}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerDeleteRecordCommand=void 0,s=i("Core"),c=i("./dist/plugins/report/events/index.js"),f=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=s.Commands.ActionBase,e=s.Commands.zA,r(l,h=i),l.prototype.execute=function(){var n,i,t,r,e,o,u;this.Mf&&this.Mf instanceof f.ReportWorksheet&&this.tT&&(n=this.Mf,i=n.reportSheet,t=this.tT,r=t.activeRow,e=t.activeCol,o=(0,c.bji)(function(){n.reportSheet.deleteRecordAt(r,e)}),u={type:"delete",sheet:i,sheetName:i.name(),row:r,col:e,cancel:!1,oldValue:i.getValue(r,e),newValue:void 0},setTimeout(function(){var t;n.ki(s.Events.ReportSheetDataChanging,u),u.cancel||(o.deleteRecordSingleUseAction(),t={type:"delete",sheet:i,sheetName:i.name(),row:r,col:e},n.ki(s.Events.ReportSheetDataChanged,t))}))},o=l,n.registerDeleteRecordCommand=a},"./dist/plugins/report/commands/expand-all.js":function(t,n,i){"use strict";var r,e,i,o,u,s,c;function f(t,n){return c.call(this,t,n)||this}function h(t){var n="reportSheetExpandAll";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return o(t,u,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerExpandAllCommand=void 0,e=i("Core"),i=e.Commands.ActionBase,o=e.Commands.zA,r(f,c=i),f.prototype.execute=function(){var h,t;this.canExecute()&&((h=this.Mf).suspendPaint(),((t=this.tT.selections)||[]).forEach(function(t){for(var n,i,r,e,o,u,s,c,f,n=t.row,i=t.rowCount,r=t.col,e,o=n+i-1,u=r+t.colCount-1,s=n;s<=o;s++)for(c=r;c<=u;c++)(f=h.getSpan(s,c))&&(f.row!==s||f.col!==c)||h.Oji(s,c,"Expanded",!0,!0)}),h.invalidateLayout(),h.gP(),h.resumePaint())},u=f,n.registerExpandAllCommand=h},"./dist/plugins/report/commands/index.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f,h,l;function a(t){(0,r.registerAddRecordCommand)(t),(0,o.registerDeleteRecordCommand)(t),(0,f.registerResetRecordCommand)(t),(0,l.registerSubmitCommand)(t),(0,c.registerCollapseCommand)(t),(0,s.registerRegenerateReportCommand)(t),(0,e.registerCollapseAllCommand)(t),(0,u.registerExpandAllCommand)(t),(0,h.registerChartPreviewVisibleCommand)(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.registerCommands=void 0,r=i("./dist/plugins/report/commands/add-record.js"),e=i("./dist/plugins/report/commands/collapse-all.js"),o=i("./dist/plugins/report/commands/delete-record.js"),u=i("./dist/plugins/report/commands/expand-all.js"),s=i("./dist/plugins/report/commands/regenerate-report.js"),c=i("./dist/plugins/report/commands/report-collapse.js"),f=i("./dist/plugins/report/commands/reset-current-cell.js"),h=i("./dist/plugins/report/commands/chart-preview-visible.js"),l=i("./dist/plugins/report/commands/submit.js"),n.registerCommands=a},"./dist/plugins/report/commands/regenerate-report.js":function(t,n,i){"use strict";var r,e,o,i,u,s,c,f;function h(t,n){return f.call(this,t,n)||this}function l(t){var n="reportSheetRegenerateReport";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return u(t,s,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerRegenerateReportCommand=void 0,e=i("Core"),o=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,u=e.Commands.zA,r(h,f=i),h.prototype.execute=function(){var t;this.Mf&&this.Mf instanceof o.ReportWorksheet&&this.tT&&this.Mf.reportSheet.regenerateReport()},s=h,n.registerRegenerateReportCommand=l},"./dist/plugins/report/commands/report-collapse.js":function(t,n,i){"use strict";var r,e,i,o,u,s,c;function f(t,n){return c.call(this,t,n)||this}function h(t){var n="ReportCollapseButtonToggle";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return o(t,u,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerCollapseCommand=void 0,e=i("Core"),i=e.Commands.ActionBase,o=e.Commands.zA,r(f,c=i),f.prototype.execute=function(){var t,n,i,t,r,n,t=this,n=t.tT,i=!1;return t.canExecute()&&(t=t.Mf,r=n.row,n=n.col,t.Oji(r,n)),i=!0},u=f,n.registerCollapseCommand=h},"./dist/plugins/report/commands/reset-current-cell.js":function(t,n,i){"use strict";var r,e,o,u,i,s,c,f,h;function l(t,n){return h.call(this,t,n)||this}function a(t){var n="reportSheetResetCellValue";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return s(t,c,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerResetRecordCommand=void 0,e=i("Core"),o=i("./dist/plugins/report/events/index.js"),u=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,s=e.Commands.zA,r(l,h=i),l.prototype.execute=function(){var f,t,n,i,r;this.Mf&&this.Mf instanceof u.ReportWorksheet&&this.tT&&(f=this.Mf,t=this.tT.selections,n=(0,o.J5i)(t,function(){Array.isArray(t)&&(f.reportSheet.suspendPaint(),t.forEach(function(t){for(var n,i,r,e,o,u,s,c,n=t.row,i=t.col,r,e,o=n+t.rowCount-1,u=i+t.colCount-1,s=n;s<=o;s++)for(c=i;c<=u;c++)f.reportSheet.t4i.K5i(s,c,!0)}),f.reportSheet.resumePaint())}),i=n.name,r=n.event,setTimeout(function(){f.ki(i,r),r.canceled||r.resetCellValueSingleUseAction()}))},c=l,n.registerResetRecordCommand=a},"./dist/plugins/report/commands/submit.js":function(t,n,i){"use strict";var r,e,o,i,u,s,c,f;function h(t,n){return f.call(this,t,n)||this}function l(t){var n="reportSheetSubmit";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return u(t,s,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerSubmitCommand=void 0,e=i("Core"),o=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,u=e.Commands.zA,r(h,f=i),h.prototype.execute=function(){var t;this.Mf&&this.Mf instanceof o.ReportWorksheet&&this.tT&&this.Mf.reportSheet.Xcr(!0)},s=h,n.registerSubmitCommand=l},"./dist/plugins/report/convertors/helpers/shape-generator.js":function(t,n,i){"use strict";var o,r,s,l,a,e,u;function c(){this.Ivr={}}o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.ShapeGenerator=void 0,r=i("Barcode"),s=i("Core"),l=i("Sparkline"),a=i("./dist/plugins/report/worksheet/report-worksheet.js"),e=i("./dist/plugins/report/utils/utils.js"),c.prototype.generate=function(t,n,i){this.Ivr={},this.Cvr(t,n,i)},c.prototype.Cvr=function(t,n,i){for(var r,e,o,u,s,c,f,h,r=[],e=t instanceof a.ReportWorksheet?t.reportDataModel.lOi():null,o=e?e.rowCount-1:t.getRowCount()-1,u=e?e.colCount-1:t.getColumnCount()-1,s=0;s<=o;s++)for(c=0;c<=u;c++)(f=t.getValue(s,c))&&f instanceof l.SparklineExValue&&f.value&&(f.value.imageBase64Data||f.value.url||f.value.isBarcode)&&((h=t.getSpan(s,c))&&(h.row!==s||h.col!==c)||(r.push(this.Nvr({row:s,col:c,endRow:h?h.row+h.rowCount-1:s,endCol:h?h.col+h.colCount-1:c,sheet:n,value:f})),n.setValue(s,c,"")));i&&0<r.length&&i.push(Promise.all(r))},c.prototype.Nvr=function(p){var M=this;return new Promise(function(c){var f,h,l,t,a,v,d,t,n,t,n,f=p.value.value.imageBase64Data,h=0,l=0,t=p.value.value,a=t.url,v=t.isBarcode,d=document.createElement("img");d.crossOrigin="anonymous",d.onload=function(){var t,n,i,r,e,t,o,u,s,o,n;f||(f=M.jvr(d),M.Ivr[a]=f),f&&(n=(t=v?{width:d.width,height:d.height,rowOffset:l,colOffset:h,crop:null}:M._vr(p,d)).width,i=t.height,r=t.rowOffset,e=t.colOffset,t=t.crop,o=p.sheet,u=p.row,s=p.col,(o=o.shapes.addPictureShape(M.Avr(),f,0,0,n,i)).startRow(u),o.startColumn(s),o.x(o.x()+e),o.y(o.y()+r),t)&&((n=o.pictureFormat()||{}).crop=t,o.pictureFormat(n)),c(!0)},d.onerror=function(){c(!0)},d.onabort=function(){c(!0)},v&&(n=(t=M.Tvr(p)).width,t=t.height,n=(0,r.generatePaintBarcodeViewModel)(n,t,p.value.value))&&(f=n.dataUrl,h=n.plotRect.plotX,l=n.plotRect.plotY),d.src=f||M.Ivr[a]||a})},c.prototype.jvr=function(t){var n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d").drawImage(t,0,0);try{return n.toDataURL()}catch(t){return""}},c.prototype.Avr=function(){return"pic-".concat(Math.ceil(1e9*Math.random()).toString())},c.prototype._vr=function(t,n){var i,r,i,n,i=this.Tvr(t),r=this.Dvr(n,i,t.value),i=this.Svr(t,r,i),n=this.Bvr(r,n,t);return o(o(o({},r),i),{crop:n})},c.prototype.Svr=function(t,n,i){var t,r,e,t=this.Rvr(t),r=1,e=1;return t.v===s.VerticalAlign.center?r=(i.height-n.height)/2:t.v===s.VerticalAlign.bottom&&(r=i.height-n.height),t.h===s.HorizontalAlign.center?e=(i.width-n.width)/2:t.h===s.HorizontalAlign.right&&(e=i.width-n.width),{rowOffset:Math.max(r,1),colOffset:Math.max(e,1)}},c.prototype.Dvr=function(t,n,i){var i,n,r,e;return 1===i.value.drawType?o({},n):2===i.value.drawType?{width:t.width,height:t.height}:3===i.value.drawType?{width:Math.min(i.value.width,n.width-2),height:Math.min(i.value.height,n.height-2)}:(i=n.width-2,n=n.height-2,(r=t.width*(n/t.height))<=i?{width:r,height:n}:{width:i,height:e=t.height*(i/t.width)})},c.prototype.Bvr=function(t,n,i){var r,e,r,o,u,o,s,c,f,h,f,h,r=i.value.value,e=r.width,r=r.height;return 3===i.value.value.drawType&&(e>t.width||r>t.height)?this.kvr(i.value)?(u=(o=i.value.value).clipX,o=o.clipY,s=Math.min(i.value.value.clipWidth,n.width-u),c=Math.min(i.value.value.clipHeight,n.width-o),f=Math.max((e-t.width)*(s/e),0),h=Math.max((r-t.height)*(c/r),0),{left:(u+(f=this.zvr(i,f,h)).left)/n.width,top:(o+f.top)/n.height,right:(n.width-u-s+f.right)/n.width,bottom:(n.height-o-c+f.bottom)/n.height}):{left:(h=this.zvr(i,e-t.width,r-t.height)).left/e,top:h.top/r,right:h.right/e,bottom:h.bottom/r}:null},c.prototype.kvr=function(t){var t=t.value,n=t.clipX,i=t.clipY,r=t.clipWidth,t=t.clipHeight;return!((0,e.ht)(n)||(0,e.ht)(i)||(0,e.ht)(r)||(0,e.ht)(t))},c.prototype.zvr=function(t,n,i){var r,e,o,u,t,r=0,e=0,o=0,u=0,t=this.Rvr(t);return t.h===s.HorizontalAlign.center?o=r=n/2:t.h===s.HorizontalAlign.right?r=n:o=n,t.v===s.VerticalAlign.center?u=e=i/2:t.v===s.VerticalAlign.bottom?e=i:u=i,{left:r,top:e,right:o,bottom:u}},c.prototype.Rvr=function(t){var n,i,n,i,r,n,i,t,r,r=t.sheet,n=t.row,i=t.col,t=t.value,r=r.getActualStyle(n,i);return{v:null!=(n=t.value.vAlign)?n:null!=(i=null==r?void 0:r.vAlign)?i:s.VerticalAlign.top,h:null!=(n=t.value.hAlign)?n:null!=(i=null==r?void 0:r.hAlign)?i:s.HorizontalAlign.left}},c.prototype.Tvr=function(t){for(var n,i,r,e,o,u,s,c,f,n=t.row,i=t.col,r=t.endRow,e=t.endCol,o=t.sheet,u=0,s=0,c=n;c<=r;c++)s+=+o.getRowHeight(c);for(f=i;f<=e;f++)u+=+o.getColumnWidth(f);return{width:u,height:s}},n.ShapeGenerator=c},"./dist/plugins/report/convertors/report-json-convertor.js":function(t,n,i){"use strict";var a,v,c,r,d,e;function o(t){this.yji=!1,this.Iji=t,this.workSheetConvertor=new r.WorkSheetConvertor(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportJSONConvertor=void 0,a=i("Core"),v=i("./dist/plugins/report/print/print-sheet.js"),c=i("./dist/plugins/report/utils/utils.js"),r=i("./dist/plugins/report/convertors/worksheet-convertor.js"),d=i("Print"),o.prototype.Np=function(t){var n,i,r,e,o,u,s,c,f,h,u,s,n,l,u,n=this,i=n.Iji,r=n.workSheetConvertor,e={},o=i.options.dirtyStyle,u=(t=t||{}).gp,s="PaginatedPreview"===i.renderMode(),c="Preview"===i.renderMode(),f=t.convertReportSheetToWorksheet;if(u){if(s){if(i.options.printAllPages)return this.yji?(this._ji?this.Dji():this._ji=n.Aji(t,i.name()),this._ji):n.Aji(t,i.name());u=i.templateSheet.printInfo(),s=new d.PrintInfo,n=i.Mf.Pie,s.fromJSON(u.toJSON()),s.fitPagesTall(1),s.fitPagesWide(1),s.sheet(i.Mf),i.Mf.Pie=s,h=i.Mf.toJSON(t),i.Mf.Pie=n}if(c)return(u=(l=r.Tji(t)).printInfo())&&(u.showRowHeader(1),u.showColumnHeader(1)),new v.PrintSheet(l).toJSON(t)}return h=t.cb===a.FileType.excel&&i.Pvr?i.Pvr.toJSON(t):f?(c?l=r.Tji(t):i.Mf).toJSON(t):h||i.templateSheet.toJSON(t),e.template=h,e.reportName=t.newWorkSheetName||i.name(),e.name=t.newWorkSheetName||i.name(),e.sheetType=i._gi,e.renderMode=i.options.renderMode,e.printAllPages=i.options.printAllPages,o&&(e.dirtyStyle=o.toJSON()),e.parameter=i.o1e,e.parameterUI=i.Sji,e},o.prototype.wh=function(t,n,i){var r,e,o,u,s,c,f,r,r=this,e=r.Iji,o=r.workSheetConvertor,s=e.options.dirtyStyle,c=n.styleManager;return i&&i.gp&&"PaginatedPreview"===e.renderMode()&&e.options.printAllPages?r.Aji(i,e.name()):(i&&(i.gp||i.fileType===a.OpenSaveFileType.excel)?((u=(e.Pvr||("Preview"===e.options.renderMode?f=o.Tji(i):e.Mf)).wh(t,n,i)).lossless||(u.lossless={}),u.lossless.reportLossless={}):(e.templateSheet!==e.Mf&&e.templateSheet.b2(e.b2(),!1),(u=e.templateSheet.wh(t,n,i)).lossless||(u.lossless={}),u.lossless.reportLossless={reportName:e.name()}),u.lossless.sheetType=e._gi,(r=u.lossless.reportLossless).renderMode=e.options.renderMode,r.printAllPages=e.options.printAllPages,s&&(r.dirtyStyle=c.getStyleIndex(s,3,e.name())),r.parameter=e.o1e,r.parameterUI=e.Sji,u)},o.prototype.xji=function(t,n,i,r,e){var t,i,o,u,s,o,u=this.Iji;u.options.renderMode=t.renderMode,u.options.printAllPages=t.printAllPages,u.o1e=t.parameter,u.Sji=t.parameterUI,(0,c.ht)(t.reportName)||u.name(t.reportName),u.M5i(t.template,null,(null==r?void 0:r.gp)||(null==r?void 0:r.sb)),t.dirtyStyle&&((s=new a.Style).fromJSON(t.dirtyStyle,i&&i.noSchema,null),u.options.dirtyStyle=s),"Design"!==u.renderMode()&&(r&&(r.gp||r.sb)?u.regenerateReport():(null!=(i=null==(t=u.getParent())?void 0:t.Ymr)?i:[]).push(u.fetchAllTablesAsync().then(function(){u.getParent()&&u.regenerateReport()})))},o.prototype.yh=function(t,n,i){var r,e,o,u,t,s,r,e=this.Iji,o=t.lossless&&t.lossless.reportLossless;o&&(u=a.util.o1(t,"sheetViews&sheetView"),e.options.renderMode=o.renderMode,e.options.printAllPages=o.printAllPages,e.o1e=o.parameter,e.Sji=o.parameterUI,(0,c.ht)(o.reportName)||e.name(o.reportName),e.M5i(t,{sjsCommonInfo:n,openOptions:i}),e.b2(!(!u||"1"!==u.tabSelected)),t=n.styleManager,o.dirtyStyle&&(e.options.dirtyStyle=t.getStyle(o.dirtyStyle)),s=a.Util.wo(i,e.getParent().v2))&&e.fetchAllTablesAsync().then(function(){e.getParent()&&e.regenerateReport()})},o.prototype.Dji=function(){for(var t,n,i,r,e,o,u,s,c,t,n=this.Iji,i=this._ji,r=n.printInfo(),e=r.pageRange(),o=0,u=i;o<u.length;o++)(c=(s=u[o]).sheet.printInfo).pageRange=e,c.pageHeaderFooter=r.pageHeaderFooter()},o.prototype.Eji=function(t){return this.yji=!!t,t||(this._ji=void 0),this.yji},o.prototype.Aji=function(i,r){var e=this.Iji;return e.reportWorksheet.paginationHelper.Gf().zji().filter(function(t,n){return 0===e.printPageIndexArray.length||-1!==e.printPageIndexArray.indexOf(n)}).map(function(t,n){return new v.PrintSheet(t,r,n,e.E0i).toJSON(i)})},n.ReportJSONConvertor=o},"./dist/plugins/report/convertors/worksheet-convertor.js":function(t,n,i){"use strict";var u,s,c,f,h,r;function e(t){this.Pji=t}Object.defineProperty(n,"__esModule",{value:!0}),n.WorkSheetConvertor=void 0,u=i("Core"),s=i("./dist/plugins/report/convertors/helpers/shape-generator.js"),c=i("./dist/plugins/report/utils/chart-utils.js"),f=i("./dist/plugins/report/worksheet/helpers/utils.js"),h=i("CellTypes"),e.prototype.Tji=function(t,n){var i,r,e,o,i,r=this.Pji,e=r.Mf,o=new u.Worksheet;return o.parent=e.parent,e.parent.suspendPaint(),o.suspendPaint(),o.suspendEvent(),o.suspendDirty(),o.fromJSON(e.toJSON(t)),null!=t&&t.saveAsView&&this.lzr(o,n),(0,c.ezr)(o,r.getAllParameters()),n&&(new s.ShapeGenerator).generate(e,o,n),o.resumeDirty(),o.resumeEvent(),o.resumePaint(),e.parent.resumePaint(),o},e.prototype.lzr=function(r,e){var o,t,o=this,t=null;"Preview"===this.Pji.renderMode()?t=this.Pji.reportWorksheet.reportDataModel.azr().map(function(t){return{row:t.row,col:t.col}}):"PaginatedPreview"===this.Pji.renderMode()&&(t=this.Pji.Mf.comboCells),t&&t.length&&(t.forEach(function(i){var t,n,n,t=function(){var t,n,t=o.Pji.Mf.getCellType(i.row,i.col),n=new h.ComboBox;n.fromJSON(t.toJSON({gp:!0})),r.setCellType(i.row,i.col,n)},n=o.Pji.Mf.getStyle(i.row,i.col),n=n.cellType.mUr(o.Pji.Mf,n.formatter);n?(n.finally(t),e&&e.push(n)):t()}),(0,f.vzr)(r,t))},n.WorkSheetConvertor=e},"./dist/plugins/report/data-model/helpers/auto-fit-helper.js":function(t,n,i){"use strict";var h,r,e;function o(t,n){this.zir={},this.kir={},this.qir=new r.SmartCache,this.trr=new r.SmartCache,this.mCi=t,this.Cji=n}Object.defineProperty(n,"__esModule",{value:!0}),n.AutoFitHelper=void 0,h=i("Core"),r=i("./dist/plugins/report/helpers/smart-cache.js"),o.prototype.Uir=function(t){var n,i,r,e,o,n=t.cellNode.templateCell.autoFit;if("None"!==n)if("Row"===n)for(i=t.row,r=t.row+t.rowCount-1;i<=r;i++)this.zir[i]=!0;else if("Column"===n)for(e=t.col,o=t.col+t.colCount-1;e<=o;e++)this.kir[e]=!0},o.prototype.yrr=function(n,i){var r,t,t,r=this,t=Object.keys(this.zir).map(function(t){return+t});this.zir={},t.forEach(function(t){0<n[t]&&(r.zir[t]=!0)}),t=Object.keys(this.kir).map(function(t){return+t}),this.kir={},t.forEach(function(t){0<i[t]&&(r.kir[t]=!0)})},o.prototype.nrr=function(){return this.irr()||this.rrr()},o.prototype.irr=function(){return 0<Object.keys(this.zir).length},o.prototype.rrr=function(){return 0<Object.keys(this.kir).length},o.prototype.c5=function(){this.zir={},this.kir={},this.err=void 0,this.orr=void 0,this.qir.reset(),this.trr.reset()},o.prototype.Hir=function(t,n){this.urr(t,n),this.Wir(n),this.Fir(t)},o.prototype.urr=function(t,n){this.irr()&&(this.err=new Array(t.length),this.srr(t,this.err)),this.rrr()&&(this.orr=new Array(n.length),this.srr(n,this.orr))},o.prototype.Wir=function(t){var n=Object.keys(this.kir).map(function(t){return+t});0!==n.length&&(this.trr.reset(),this.arr(t,n))},o.prototype.arr=function(c,t){var f,n,h,l,f=this,n=this.Cji.getReportRange(),h=n.row,l=n.rowEnd;t.forEach(function(t){var n,i,r,e,o,u,s;if(f.kir[t])for(n=h;n<=l;n++)if((i=f.Cji.getCell(n,t))&&i.row===n&&i.col===t&&!f.mrr(i)&&"Column"===i.cellNode.templateCell.autoFit&&-1!==(r=f.Qir(n,t)))for(e=i.col+i.colCount-1,1<i.colCount&&f.crr(c,i.col,e),o=r,u=i.col;u<=e;u++)u!==e?o-=c[u]:(s=Math.ceil(o))>c[u]&&(c[u]=s)})},o.prototype.crr=function(t,n,i){for(var r,e,o,u,s,c,c,r=this.Cji.getReportRange(),e=r.row,o=r.rowEnd,u=n;u<=i;u++)for(s=e;s<=o;s++)!(c=this.Cji.getCell(s,u))||1<c.colCount||c.row!==s||this.mrr(c)||"Column"===c.cellNode.templateCell.autoFit&&-1!==(c=this.Qir(s,u))&&t[u]<c&&(t[u]=c)},o.prototype.Fir=function(t){var n=Object.keys(this.zir).map(function(t){return+t});0!==n.length&&(this.qir.reset(),this.lrr(t,n))},o.prototype.lrr=function(c,t){var f,n,h,l,f=this,n=this.Cji.getReportRange(),h=n.col,l=n.colEnd;t.forEach(function(t){var n,i,r,e,o,u,s;if(f.zir[t])for(n=h;n<=l;n++)if((i=f.Cji.getCell(t,n))&&i.row===t&&i.col===n&&!f.mrr(i)&&"Row"===i.cellNode.templateCell.autoFit&&-1!==(r=f.Yir(t,n)))for(e=i.row+i.rowCount-1,1<i.rowCount&&f.frr(c,i.row,e),o=r,u=i.row;u<=e;u++)u!==e?o-=c[u]:(s=Math.ceil(o))>c[u]&&(c[u]=s)})},o.prototype.frr=function(t,n,i){for(var r,e,o,u,s,c,c,r=this.Cji.getReportRange(),e=r.col,o=r.colEnd,u=n;u<=i;u++)for(s=e;s<=o;s++)!(c=this.Cji.getCell(u,s))||1<c.rowCount||c.col!==s||this.mrr(c)||"Row"===c.cellNode.templateCell.autoFit&&-1!==(c=this.Yir(u,s))&&t[u]<c&&(t[u]=c)},o.prototype.Yir=function(t,n){var i=this.qir.get(t,n);return void 0===i&&(i=this.Jir(t,n,"RowHeight"),this.qir.set(t,n,i)),i},o.prototype.Qir=function(t,n){var i=this.trr.get(t,n);return void 0===i&&(i=this.Jir(t,n,"ColWidth"),this.trr.set(t,n,i)),i},o.prototype.Jir=function(t,n,i){var r,e,o,e,u,s,c,t,f,r=this.mCi,e=r.Dn,o=r.getActualStyle(t,n);return o.font=e._n(o.font||e.Nn()),(e=r.getCellType(t,n))?(u=h.SheetArea.viewport,s=r.getText(t,n),c=r.$t(t,n,u,h.ValueType.richText),t={sheet:r,row:t,col:n,sheetArea:u},f=3,"RowHeight"===i?e.Fn(c,s,o,r.zoom(),t)+3:e.Ln(c,s,o,r.zoom(),t)+3):-1},o.prototype.srr=function(t,n,i,r){n.length=t.length;for(var e=null!=i?i:0,o=null!=r?r:t.length-1;e<=o;e++)n[e]=t[e]},o.prototype.vrr=function(t,n){for(var i,r,i=[t],r=t+1;r<=n;r++)i.push(r);return i},o.prototype.mrr=function(t){return(void 0===t.value||null===t.value)&&!t.cellNode.templateCell.formula},o.prototype.Srr=function(i,n,t){var e,r,t,o,e=this,r=t.filter(function(t){return"Column"===t.cellNode.templateCell.autoFit}),t=t.filter(function(t){return"Row"===t.cellNode.templateCell.autoFit});0<r.length?(o=Object.keys(this.zir).map(function(t){return+t}),r.forEach(function(t){e.trr.set(t.row,t.col,void 0);var t=e.Irr(t),i=t.startCol,r=t.endCol;e.Mrr(n,i,r),0<o.length&&o.forEach(function(t){for(var n=i;n<=r;n++)e.qir.set(t,n,void 0)})}),0<o.length&&(this.srr(this.err,i,o[0],o[o.length-1]),this.lrr(i,o))):t.forEach(function(t){e.qir.set(t.row,t.col,void 0);var t=e.prr(t),n=t.startRow,t=t.endRow;e.wrr(i,n,t)})},o.prototype.Irr=function(t){for(var n,i,t,r,e,o,u,s,s,n=t.col,i=t.col+t.colCount-1,t=this.Cji.getReportRange(),r=t.row,e=t.rowEnd,o=n;o<=i;o++)for(u=r;u<=e;u++)(s=this.Cji.getCell(u,o))&&(s.col<n&&(n=s.col),i<(s=s.col+s.colCount-1))&&(i=s);return{startCol:n,endCol:i}},o.prototype.prr=function(t){for(var n,i,t,r,e,o,u,s,s,n=t.row,i=t.row+t.rowCount-1,t=this.Cji.getReportRange(),r=t.col,e=t.colEnd,o=n;o<=i;o++)for(u=r;u<=e;u++)(s=this.Cji.getCell(o,u))&&(s.row<n&&(n=s.row),i<(s=s.row+s.rowCount-1))&&(i=s);return{startRow:n,endRow:i}},o.prototype.Mrr=function(t,n,i){this.srr(this.orr,t,n,i),this.arr(t,this.vrr(n,i))},o.prototype.wrr=function(t,n,i){this.srr(this.err,t,n,i),this.lrr(t,this.vrr(n,i))},n.AutoFitHelper=o},"./dist/plugins/report/data-model/helpers/cell-collapse-helper.js":function(t,n,i){"use strict";var C,r,N,e;function o(t){this.Err=new Map;var n=this;n.Cji=t,n.Yji=new r.SmartCache,n.Wji={},n.Fji={}}Object.defineProperty(n,"__esModule",{value:!0}),n.CellCollapseHelper=void 0,C=i("./dist/plugins/report/utils/utils.js"),r=i("./dist/plugins/report/helpers/smart-cache.js"),N=i("Core"),o.prototype.Jji=function(t,n){var i,r,e,o,u,s,o,i=this.Cji.getCell(t,n);i&&(e=(r=this).Yji,"No"!==(s=(u=(o=i.cellNode).templateCell).expansionDirection))&&o.children&&0<o.children.length&&i.row===t&&i.col===n&&(o=r.Kji(i),"H"===s?(void 0===o||o>=i.col+i.colCount||o<i.col)&&(o=i.col):(void 0===o||o>=i.row+i.rowCount||o<i.row)&&(o=i.row),e.set(t,n,{index:o,type:"E"}))},o.prototype.Oji=function(t,n,i,r){var e,e;i||r?"Expanded"===i?r?this.rwr(t,n):this.Trr(null==(e=this.Cji.getCell(t,n))?void 0:e.group):"Collapsed"===i&&(r?this.ewr(t,n):this.owr(null==(e=this.Cji.getCell(t,n))?void 0:e.group)):this.uwr(t,n)},o.prototype.$ji=function(t,n){return!!(n?this.Wji:this.Fji)[t]},o.prototype.qji=function(t,n){var t=this.swr(t,n);return t&&t.type},o.prototype.Lir=function(t,n){var i,r,t,n,i,n,i=this,r,t=i.Cji.getCell(t,n);return t?(i=(n=i.getCellTreeRange(t.group)).rowCount,n=n.colCount,"H"===t.cellNode.templateCell.expansionDirection?n:i):1},o.prototype.ewr=function(t,n){var i,t,r,i=this,t=this.Cji.getCell(t,n);t&&(r=function(t){var n,n;i.owr(t),null!=(n=t.childrenArray)&&n.forEach(function(t){return null==t?void 0:t.forEach(function(t){return r(t)})}),null!=(n=t.crossChildren)&&n.forEach(function(t){return null==t?void 0:t.forEach(function(t){return null==t?void 0:t.forEach(function(t){return r(t)})})})})(t.group)},o.prototype.rwr=function(t,n){var i,t,r,i=this,t=this.Cji.getCell(t,n);t&&(r=function(t){var n,n;i.Trr(t),null!=(n=t.childrenArray)&&n.forEach(function(t){return null==t?void 0:t.forEach(function(t){return r(t)})}),null!=(n=t.crossChildren)&&n.forEach(function(t){return null==t?void 0:t.forEach(function(t){return null==t?void 0:t.forEach(function(t){return r(t)})})})})(t.group)},o.prototype.jrr=function(){var r,t,r=this,t;Array.from(this.Err.keys()).forEach(function(t){var n,i,n;r.Cji.getCell(t.dataCell.row,t.dataCell.col).group!==t?r.Err.delete(t):(i=r.swr(t.dataCell.row,t.dataCell.col))&&"E"===i.type&&(i.type="C",r.Xji(t.dataCell.row,t.dataCell.col,1))})},o.prototype.Arr=function(t,n){var t,i,r,t=this.Cji.getCell(t,n);if(t)if("H"===t.cellNode.templateCell.expansionDirection)for(i=t.group.upParent;i;)this.Trr(i),i=i.upParent;else for(r=t.group.leftParent;r;)this.Trr(r),r=r.leftParent},o.prototype.Trr=function(t){var n,i,n,r;t&&(i=(n=t.dataCell).row,n=n.col,r=this.swr(i,n))&&"C"===r.type&&(r.type="E",this.Err.delete(t),this.Xji(i,n,-1))},o.prototype.owr=function(t){var n,i,n,r;t&&(i=(n=t.dataCell).row,n=n.col,r=this.swr(i,n))&&"E"===r.type&&(r.type="C",this.Err.set(t,!0),this.Xji(i,n,1))},o.prototype.Xji=function(t,n,i){var r,e,o,u,s,c,f,h,s,t,r=this,e=r.Wji,o=r.Fji,u=r.Cji.getCell(t,n);u&&(c=(s=r.getCellTreeRange(u.group)).row,f=s.col,h=s.rowCount,s=s.colCount,t=this.swr(t,n).index,"H"===u.cellNode.templateCell.expansionDirection?r.inr(o,t,f,s,i):r.inr(e,t,c,h,i))},o.prototype.inr=function(t,n,i,r,e){var o;if(0<t[n])for(o=0;o<r;o++)if(!t[i+o]){n=i+o;break}for(o=0;o<r;o++)this.rCi(t,i+o),i+o!==n&&(t[i+o]+=e,t[i+o]<0)&&(t[i+o]=0)},o.prototype.getCellTreeRange=function(t){var n,i,r,e,t,o,u,s,c,f,h,l,a,v,d,p,M,w,I,g;if(t.dataCell){if(r=t.dataCell,e=t.childrenArray,t=t.crossChildren,u=(o=(n=this).swr(r.row,r.col))&&o.range)return new N.Range(u.row,u.col,u.rowCount,u.colCount);if(e.length||t.length){for(s=0,c=e;s<c.length;s++)for(h=0,l=f=c[s];h<l.length;h++)a=l[h],i=(0,C.oCi)(i,n.getCellTreeRange(a));for(v=0,d=t;v<d.length;v++)if(p=d[v])for(M=0,w=p;M<w.length;M++)for(I=0,g=f=w[M];I<g.length;I++)a=g[I],i=(0,C.oCi)(i,n.getCellTreeRange(a))}else i=new N.Range(r.row,r.col,r.rowCount,r.colCount);return i=(0,C.oCi)(i,new N.Range(r.row,r.col,r.rowCount,r.colCount)),o&&(o.range=new N.Range(i.row,i.col,i.rowCount,i.colCount)),i}},o.prototype.rCi=function(t,n){t[n]===C.KEYWORD_UNDEFINED&&(t[n]=0)},o.prototype.Kji=function(t){var n,n,i,n=this,i=n.uCi(t),n=i?n.sCi(t,i):"V"===t.cellNode.templateCell.expansionDirection?t.row:t.col;return n},o.prototype.sCi=function(t,n){var i,r,e,t,n,i=t.group,r="V"===t.cellNode.templateCell.expansionDirection,e=n.leftParent&&n.upParent,t=t.cellNode.children.indexOf(n),n=e?i.crossChildren[t]&&i.crossChildren[t][0]&&i.crossChildren[t][0][0].dataCell:i.childrenArray[t]&&i.childrenArray[t][0].dataCell;return n?r?n.row:n.col:void 0},o.prototype.uCi=function(t){var n,i,r,e,o;if(t.cellNode.children&&0<t.cellNode.children.length){for(n=0,i=t.cellNode.children;n<i.length;n++)if((r=i[n]).templateCell.dataSetting&&"Summary"===r.templateCell.dataSetting.type)return r;for(e=0,o=t.cellNode.children;e<o.length;e++)if((r=o[e]).templateCell.formula)return r}},o.prototype.uwr=function(t,n){var i,r,i,t,i=this,r;i.Yji&&(i=i.Cji.getCell(t,n),t=this.swr(t,n))&&("E"===t.type?this.owr(i.group):"C"===t.type&&this.Trr(i.group))},o.prototype.swr=function(t,n){var i=this.Yji.get(t,n);return i||(this.Jji(t,n),this.Yji.get(t,n))},o.prototype.destroy=function(){var t=this;t.Yji=C.KEYWORD_UNDEFINED,t.Fji=C.KEYWORD_UNDEFINED,t.Wji=C.KEYWORD_UNDEFINED,t.Cji=C.KEYWORD_UNDEFINED,t.Err=C.KEYWORD_UNDEFINED},o.prototype.reset=function(){var t=this;t.Yji=new r.SmartCache,t.Fji={},t.Wji={}},n.CellCollapseHelper=o},"./dist/plugins/report/data-model/helpers/cell-status-helper.js":function(t,n,i){"use strict";var h,l,a,r;function e(t,n,i){this.cCi=t,this.Mf=n,this.Cji=i}Object.defineProperty(n,"__esModule",{value:!0}),n.CellStatesHelper=void 0,h=i("Core"),l=i("./dist/plugins/report/utils/utils.js"),a=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),e.prototype.fCi=function(){try{var t=this,n=t.Mf;n.cellStates.reset(n),n.cellStates.fromJSON(t.cCi.toJSON()),t.hCi()}catch(t){}},e.prototype.hCi=function(){for(var t,n,i,r,e,o,u,s,c,f,t=this,n=t.Cji,i,r=t.Mf.cellStates,e,s=0,c=r.all();s<c.length;s++)f=c[s],u||f.state!==h.CellStatesType.dirty||(u=!0),r.remove(f.range,f.state),o=(0,l.JS)(n.getReportRange(),f.range),(0,l.ht)(o)||t.aCi(f,t.lCi(o));u||t.vCi()},e.prototype.lCi=function(t){for(var n,i,r,e,o,u,s,c,f,h,n,n=this,i=n.Cji,r=n.cCi.Mf,e=[],o=[],u=t.row,s=t.col,c=u+t.rowCount-1,f=s+t.colCount-1;u<=c;u++){for(;s<=f;s++)(h=r.getSpan(u,s))&&(h.row!==u||h.col!==s)||i.getAllCells(u,s).forEach(function(t){o.push(t)});s=t.col}return n=!(0,a.pCi)(o[0]),(0,l.atr)(o,n),(0,a.dCi)(o,n).forEach(function(t){e.push(t)}),e},e.prototype.aCi=function(t,n){for(var i,r,e,o,u,s,i,r,e=this.Mf.cellStates,o=0,u=n;o<u.length;o++)s=u[o],e.add(s,t.state,t.style)},e.prototype.vCi=function(){var t=this,n=t.Mf,i=n.cellStates;t.Mf.reportSheet.options.dirtyStyle&&i.add(n.Gji(),h.CellStatesType.dirty,t.Mf.reportSheet.options.dirtyStyle)},n.CellStatesHelper=e},"./dist/plugins/report/data-model/helpers/conditional-format-helper.js":function(t,n,i){"use strict";var M,w,r;function e(t,n,i){this.mJ=t,this.Mf=n,this.Cji=i}Object.defineProperty(n,"__esModule",{value:!0}),n.ConditionalFormatHelper=void 0,M=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),w=i("./dist/plugins/report/utils/utils.js"),e.prototype.wCi=function(){try{var t=this;t.Mf.conditionalFormats.fromJSON(t.mJ.toJSON(),t.Mf),t.gCi()}catch(t){}},e.prototype.gCi=function(){for(var t,n,i,r,e,o,u,t=this,n,i=t.Mf.conditionalFormats,r,e=0,o=i.getRules();e<o.length;e++)u=o[e],t.MCi(u);i.nJ=!1},e.prototype.MCi=function(t){for(var n,i,r,e,o,u,s,c,f,h,l,a,v,d,p,n=this,i=t.ranges(),r=n.Cji,c=[],h=n.mJ.eJ,l=0,a=i;l<a.length;l++){for(e=(v=a[l]).row,o=v.col,u=e+v.rowCount-1,s=o+v.colCount-1,f=[];e<=u;e++){for(;o<=s;o++)(d=h.getSpan(e,o))&&(d.row!==e||d.col!==o)||r.getAllCells(e,o).forEach(function(t){f.push(t)});o=v.col}p=!(0,M.pCi)(f[0]),(0,w.atr)(f,p),(0,M.dCi)(f,p).forEach(function(t){c.push(t)})}t.ranges(c)},n.ConditionalFormatHelper=e},"./dist/plugins/report/data-model/helpers/floating-object-helper.js":function(t,n,i){"use strict";var o,h,r;function e(t,n,i){this.CCi=t,this.Cji=n,this.mCi=i,this.Bnr={}}function l(t,n){n.width(t.width),n.height(t.height),n.x(t.x),n.y(t.y),n.allowMove(!1),n.dynamicMove(!1),n.allowResize(!1),n.allowRotate(!1),n.isSelected(!1),n.isLocked(!0)}function u(t,n,i,r){var i,i,e;return 1!==i||null!=(i=null==(i=null==r?void 0:r.shapeData)?void 0:i.pic)&&i.cameraTool||((e=new o.PictureShape(t,n.name())).fromJSON(r),e.tnV()),e}function s(t){for(var n,i,r,e,n,i=0,r=t.shapes.all().filter(function(t){return 1===t.ttV});i<r.length;i++)e=r[i],t.shapes.VP(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.FloatingObjectHelper=void 0,o=i("Shapes"),h=i("./dist/plugins/report/utils/utils.js"),e.prototype.Ptr=function(){try{this.uir()}catch(t){}},e.prototype.uir=function(){var c,t,n,t,f,n,i,h,r,e,o,c=this,t=this,n=t.CCi,t=t.mCi,f=n.qnr(),n=n.lfi();for(s(t),i=function(n){var t,i,r,e,o,u,s,t=!1;f&&(i=n.startRow(),r=n.startColumn(),e=f.titleRow,o=f.endRow,u=f.titleCol,s=f.endCol,t=e&&i>=e.start&&i<=e.end||o&&i>=o.start&&i<=o.end||u&&r>=u.start&&r<=u.end||s&&r>=s.start&&r<=s.end),t?h.Cji.getAllCells(n.startRow(),n.startColumn()).forEach(function(t){c.tir(n,t)}):h.tir(n)},h=this,r=0,e=n;r<e.length;r++)i(o=e[r])},e.prototype.tir=function(t,n){var i,r,r,i=this.mCi,r=JSON.parse(JSON.stringify(t.toJSON())),r=u(i,t,r.shapeType,r);r&&(i.shapes.ZP(r),this.Btr(t.x(),t.y(),t.height(),t.width(),r,n))},e.prototype.Btr=function(t,n,i,r,e,o){var u,s,c,f,t,n,u=this,s=u.mCi,c=u.Cji,f=u.CCi,t={x:t,y:n,width:r,height:i,cell:o},n=(0,h.getFloatObjPosition)(t,f,c,s);(0,h.updateSheetRange)(n.x+n.width,n.y+n.height,s),l(n,e),u.Bnr[e.name()]=t},e.prototype.zrt=function(){var t,n,t,i,t,r,e,o,u,n=this,t=n.mCi,i=n.Bnr,t=null==(t=t.shapes)?void 0:t.all();if(t)for(r=0,e=t;r<e.length;r++)(u=i[(o=e[r]).name()])&&n.Btr(u.x,u.y,u.height,u.width,o,u.cell)},n.FloatingObjectHelper=e},"./dist/plugins/report/data-model/helpers/merge-range-utils.js":function(t,n,i){"use strict";var d,v;function r(t){var t=t&&t.cellNode&&t.cellNode.templateCell;return t&&"V"===t.expansionDirection}function e(t,n){var i,r,e,o,u,s,c,f,h,l,a,v,i={};if(!((0,d.ht)(t)||t.length<1)){if(r=t.length,o=(e=t[0]).row,u=e.col,s=e.rowCount,f=u+(c=e.colCount),h=o+s,n){for(l=1;l<r;l++)if(o===(e=t[l]).row&&e.col===f)c+=e.colCount,f+=e.colCount,s=Math.max(s,e.rowCount);else{for(a=0;a<s;a++)i[o+a+d.CONNECTOR+u+d.CONNECTOR+c]={row:o,col:u,rowCount:1,colCount:c};s=0,s=Math.max(s,e.rowCount),o=e.row,f=(u=e.col)+(c=e.colCount)}i[o+d.CONNECTOR+u+d.CONNECTOR+c]={row:o,col:u,rowCount:s,colCount:c}}else{for(l=1;l<r;l++)if(u===(e=t[l]).col&&e.row===h)s+=e.rowCount,h+=e.rowCount,c=Math.max(c,e.colCount);else{for(v=0;v<c;v++)i[u+v+d.CONNECTOR+o+d.CONNECTOR+s]={row:o,col:u,rowCount:s,colCount:1};c=0,c=Math.max(c,e.colCount),o=e.row,u=e.col,h=o+(s=e.rowCount)}i[u+d.CONNECTOR+o+d.CONNECTOR+s]={row:o,col:u,rowCount:s,colCount:c}}return i}}function o(t,n){return u(e(t,n),n)||[]}function u(t,n){var i,r,e,o,u,s,c,f,h,l,a;if(!(0,d.ht)(t)){if(r=(i=Object.keys(t)).length,n)for(f=0;f<r;f++)(s=t[e=i[f]])&&(c=t[u=+(o=e.split(d.CONNECTOR))[0]+1+d.CONNECTOR+o[1]+d.CONNECTOR+o[2]])&&(c.row=s.row,c.rowCount=s.rowCount+c.rowCount,t[e]=void 0);else for(f=0;f<r;f++)(s=t[e=i[f]])&&(c=t[u=+(o=e.split(d.CONNECTOR))[0]+1+d.CONNECTOR+o[1]+d.CONNECTOR+o[2]])&&(c.col=s.col,c.colCount=s.colCount+c.colCount,t[e]=void 0);for(a in h=[],t)t[a]&&(l=t[a],h.push(new v.Range(l.row,l.col,l.rowCount,l.colCount)));return h}}Object.defineProperty(n,"__esModule",{value:!0}),n.oCi=n.dCi=n.jCi=n.pCi=void 0,d=i("./dist/plugins/report/utils/utils.js"),v=i("Core"),n.pCi=r,n.jCi=e,n.dCi=o,n.oCi=u},"./dist/plugins/report/data-model/helpers/report-data-chart-helper.js":function(t,n,i){"use strict";var g,p,r;function e(t,n,i){this.CCi=t,this.Cji=n,this.mCi=i,this.Efr=[],this.Dfr={},this.Ofr={},this.Rfr={},this.Lfr={}}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataChartHelper=void 0,g=i("./dist/plugins/report/utils/utils.js"),p=i("CalcEngine"),e.prototype.Pfr=function(t,n,i){var n,r;t.row===n&&t.col===i&&this.mCi.dataCharts&&(r=(n=t.cellNode.templateCell)&&n.dataChartName)&&this.Efr.push(t)},e.prototype._fr=function(){var t,n,i,r,e,o,u;if(this.mCi.suspendPaint(),this.mCi.suspendCalcService(),t=this.mCi.dataCharts,this.Rfr={},this.Lfr={},t){for(i=0,r=n=t.all();i<r.length;i++)e=r[i],t.remove(e.name());for(this.Bfr(),this.Gfr(),o=0,u=n=t.all();o<u.length;o++)(e=u[o]).isLocked(!0),e.allowMove(!1),e.allowResize(!1),e.isSelected(!1)}this.Efr=[],this.mCi.resumeCalcService(),this.mCi.resumePaint()},e.prototype.Gfr=function(){for(var c,t,f,h,t,n,l,i,r,e,c=this,t=c.CCi,f=c.Ofr,h=t.qnr(),t=t.zfr(),n=function(n){var t,i,r,e,o,u,s;if((0,g.ht)(f[n.name()]))try{t=!1,h&&(i=n.startRow(),r=n.startColumn(),e=h.titleRow,o=h.endRow,u=h.titleCol,s=h.endCol,t=e&&i>=e.start&&i<=e.end||o&&i>=o.start&&i<=o.end||u&&r>=u.start&&r<=u.end||s&&r>=s.start&&r<=s.end),t?l.Cji.getAllCells(n.startRow(),n.startColumn()).forEach(function(t){c.uEr(n,t)}):c.uEr(n)}catch(t){}},l=this,i=0,r=t;i<r.length;i++)n(e=r[i])},e.prototype.uEr=function(t,n){var i,r,t,i=this,r=i.Ufr(t.name(),null,null,!0);(0,g.ht)(r)||(t={x:t.x(),y:t.y(),width:t.width(),height:t.height(),cell:n},i.Btr(t,r),i.Rfr[r.name()]=t)},e.prototype.ACi=function(t,n){var i,r,i,t,e,o,u,s,c,f,h,s,l,i=this,r=i.Cji,i=i.Dfr,t=t+"_"+n;if(i[t])for(o=0,u=e=i[t];o<u.length;o++)c=(s=u[o]).dataChart,f=s.columnInfoMap,h=s.row,s=s.col,(l=c.getChartConfig()).data=[{name:"reportsheet_table",values:r.generateTableData(f,h,s)}],c.setChartConfig(l)},e.prototype.Bfr=function(){for(var t,n,i,r,e,o,u,s,t=this,n=t.Efr,i=t.Ofr,r=0,e=n;r<e.length;r++){i[(u=(o=e[r]).cellNode.templateCell).dataChartName]=!0;try{(s=t.Ufr(u.dataChartName,o.row,o.col)).isVisible(!0),(0,g.ht)(s)||(t.Zfr((0,g.getFloatObjRect)(o.row,o.col,t.mCi),s),t.Lfr[s.name()]={row:o.row,col:o.col})}catch(t){}}},e.prototype.Ufr=function(t,n,i,r){var e,o,u,t,t,e=this,o=e.mCi,u,t=e.CCi.Vfr(t);if(t)return t=t.clone(o),o.dataCharts.ZP(t),e.Hfr(t,n,i),t},e.prototype.Hfr=function(t,n,i){var r,n,r=t.getChartConfig();this.Wfr(r)&&(n=this.Ffr(t,r.plots,n,i),r.data=[{name:"reportsheet_table",values:n}]),t.setChartConfig(r)},e.prototype.Wfr=function(t){var t;return t&&(!t.tableName||""===t.tableName)&&(null==(t=t.plots)?void 0:t[0])},e.prototype.Ffr=function(t,n,i,r){var e,o,u,s,c,n,f,h,l,a,e=this,o=e.Cji,u={},s=1,c={},n=e.tMr(n);if(n.length)for(f=0,h=n;f<h.length;f++)l=h[f],(0,g.ht)(l.field)||""===l.field||(u[a=e.ife(u,l)]||(s++,u[a]={formula:l.field,cellNames:null}),c[a]||(c[a]=[]),c[a].push(l));return e.Yfr(u,c),e.Jfr(t,u,i,r),o.generateTableData(u,i,r)},e.prototype.fJt=function(t,n){for(var i=1,r=n;t[r];)r+="_".concat(i),i++;return r},e.prototype.tMr=function(t){var n=[],i,t=t[0].encodings;return t&&(t.values&&n.push.apply(n,t.values),t.category&&n.push(t.category),t.details&&n.push.apply(n,t.details),t.color&&n.push(t.color),t.shape&&n.push(t.shape),t.size&&n.push(t.size),t.text&&n.push.apply(n,t.text),t.tooltip)&&n.push.apply(n,t.tooltip),n},e.prototype.ife=function(t,n){var i=n.displayName;return i?t[i]&&t[i].formula===n.field?i:this.fJt(t,i):"="===(i=n.field)[0]?i.slice(1):i},e.prototype.Yfr=function(o,u){for(var s,t,n,i,r,e,c,f,h,l,a,v,d,s=this.mCi.reportSheet.getTemplate(),t,n=function(t){var n,i,r,e,n=o[t],i=[],r=s.Lp.parse(s.qgt,n.formula,0,0),e=t;r&&r.type===p.ExpressionType.reference&&"="===t[0]&&(o[t.slice(1)]=n,e=t.slice(1),delete o[t]),r.forEachNodes(function(t){var t;t.type===p.ExpressionType.reference&&(t=(0,g.e_i)(t.row,t.column),-1===i.indexOf(t))&&i.push(t)}),t!==e&&(u[e]=u[t],delete u[t]),o[e].cellNames=i},i=0,r=Object.keys(o);i<r.length;i++)n(e=r[i]);for(f=0,h=c=Object.keys(u);f<h.length;f++)for(l=h[f],a=0,v=u[l];a<v.length;a++)(d=v[a]).field=l},e.prototype.Jfr=function(t,n,i,r){for(var e,o,u,s,c,f,h,l,a,v,d,p,p,M,w,I,f,e=this,o=e.Cji,u=e.Dfr,s={dataChart:t,row:i,col:r,columnInfoMap:n},c,h=0,l=Object.keys(n);h<l.length;h++)if(n[a=l[h]].cellNames&&n[a].cellNames.length)for(v=0,d=n[a].cellNames;v<d.length;v++)for(p=d[v],p=(0,g.kOi)(p),w=0,I=M=o.getCells(p.row,p.col);w<I.length;w++)u[f=(f=I[w]).row+"_"+f.col]||(u[f]=[]),u[f].push(s)},e.prototype.zrt=function(){var t,n,t,i,r,t,e,o,u,s,s,n=this,t=n.mCi,i=n.Rfr,r=n.Lfr,t=null==(t=t.dataCharts)?void 0:t.all();if(t)for(e=0,o=t;e<o.length;e++)(s=i[(u=o[e]).name()])?n.Btr(s,u):(s=r[u.name()])&&n.Zfr((0,g.getFloatObjRect)(s.row,s.col,n.mCi),u)},e.prototype.Btr=function(t,n){var i,r,e,o,t,i=this,r=i.CCi,e=i.Cji,o=i.mCi,t=(0,g.getFloatObjPosition)(t,r,e,o);(0,g.updateSheetRange)(t.x+t.width,t.y+t.height,o),i.Zfr(t,n)},e.prototype.Zfr=function(t,n){t&&n&&(n.width(t.width-1),n.height(t.height-1),n.x(t.x+1),n.y(t.y+1))},n.ReportDataChartHelper=e},"./dist/plugins/report/data-model/helpers/validation-helper.js":function(t,n,i){"use strict";var g,C,N,j,r;function e(t,n,i,r){this.b8=t,this.Mf=n,this.Cji=i,this.mCi=r}Object.defineProperty(n,"__esModule",{value:!0}),n.ValidationHelper=void 0,g=i("Core"),C=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),N=i("./dist/plugins/report/utils/utils.js"),j=i("./dist/plugins/report/helpers/smart-cache.js"),e.prototype.copyValidation=function(){try{var t=this,n=t.Mf;n.b8.fromJSON(t.b8.toJSON(),null,n),t.updateValidation(),n.b8.C8()}catch(t){}},e.prototype.updateValidation=function(){for(var t,n,i,r,e,o,u,s,t=this,n,i,r=t.Mf.b8.YB,e,o=0,u=Object.keys(r);o<u.length;o++)s=u[o],t.updateValidatorRange(r[s])},e.prototype.updateValidatorRange=function(t){for(var n,i,n,r,e,o,u,s,c,f,h,l,a,v,d,p,M,w,I,i=this,n=t.smt(),r=i.Cji,e=i.b8.eJ,o=new j.SmartCache,u=new g.Range(0,0,e.getRowCount(),e.getColumnCount()),l=[],d=0,p=n;d<p.length;d++)if(v=(M=p[d]).getIntersect(u,e.getRowCount(),e.getColumnCount())){for(s=v.row,c=v.col,f=s+v.rowCount-1,h=c+v.colCount-1,a=[];s<=f;s++){for(;c<=h;c++)w=void 0,o.get(s,c)||(w=e.getSpan(s,c),i.V5i(w,s,c,o),r.getAllCells(s,c).forEach(function(t){a.push(t)}));c=v.col}I=!(0,C.pCi)(a[0]),(0,N.atr)(a,I),(0,N.pushArrayTo)((0,C.dCi)(a,!(0,C.pCi)(a[0])),l)}t._S=l,null!=(n=t.condition())&&n.ranges(l)},e.prototype.V5i=function(t,n,i,r){if(t)for(var e=t.row,o=e+t.rowCount-1,u=t.col,s=u+t.colCount-1;e<=o;e++){for(;u<=s;u++)r.set(e,u,!0);u=t.col}else r.set(n,i,!0)},e.prototype.getInvalidCells=function(){var t,n,i,r,e,o,u,s,c,f,h,t=this,n,i=t.Mf.b8.p6t(),e=[];if(i&&0<i.length)for(o=0,u=i;o<u.length;o++)if((r=(s=u[o]).smt())&&0<r.length)for(c=0,f=r;c<f.length;c++)h=f[c],t.KCi(h,s,e);return e},e.prototype.KCi=function(t,n,i){for(var r,e,o,u,s,c,f,h,l,r=this,e=r.Mf,o=t.row,u=t.col,s,c,f=o+t.rowCount,h=u+t.colCount,l=r.mCi;o<f;o++){for(;u<h;u++)n.isValid(e,o,u,l.Bji(o,u))||i.push([o,u]);u=t.col}},n.ValidationHelper=e},"./dist/plugins/report/data-model/report-data-model.js":function(t,n,i){"use strict";var e,c,p,f,h,l,a,r,o;function u(t,n,i,r,e,o,u,s){this.cwr=!0;var c=this;c.mCi=t,c.s_i=n,c.Cji=i,c.CCi=r,c.mji=e,c.XCi=o,c.$Ci=u,c.qCi=s,c.Gtr=t.shapes?new h.FloatingObjectHelper(r,i,t):null,c.Kfr=t.dataCharts?new a.ReportDataChartHelper(r,i,t):null,c.nOi=new f.CellCollapseHelper(i),c.Kir=new l.AutoFitHelper(c.mCi,c.Cji)}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataModel=void 0,c=i("Core"),p=i("./dist/plugins/report/utils/utils.js"),f=i("./dist/plugins/report/data-model/helpers/cell-collapse-helper.js"),h=i("./dist/plugins/report/data-model/helpers/floating-object-helper.js"),l=i("./dist/plugins/report/data-model/helpers/auto-fit-helper.js"),a=i("./dist/plugins/report/data-model/helpers/report-data-chart-helper.js"),r=i("CellTypes"),u.prototype.iOi=function(){var t,n,i,r,e,o,u,s,c,f,h,l,a,t=this;for(t.iSi(),t.H5i(),r=(i=(n=t.Cji).getReportRange()).row,e=i.col,o=i.rowEnd,s=(u=i.colEnd)-e+1,t.mji.fji(),c=r;c<=o;c++)for(f=e;f<=u;f++)h=n.getCell(c,f),l=t.U5i(h,c,f),t.Z5i(l,c,f,!0),h&&(t.Kir.Uir(h),h.row===c&&h.col===f&&(0,p.lji)(h)&&(a=t.mji.aji(h),h.value=a,h.group.value=a),t.V5i(h,c,f),t.Q5i(l,c,f,s));return t.XCi.wCi(),t.mji.hji(),t.hrr(),{rowHeightCache:this.xl,colWidthCache:this.Nl,rowToTemplateRowCache:this.rOi,colToTemplateColCache:this.eOi}},u.prototype.oOi=function(){var t,n,i,r,e,n,o,u,s,c,f,h,l,a,v,d,t,e,i=this;for(i.iSi(),i.H5i(),n=(e=(r=i.Cji).getReportRange()).row,o=e.col,u=e.rowEnd,c=(s=e.colEnd)-o+1,f=i.Kfr,i.mCi.allowEditing=!1,i.mji.fji(),h="PaginatedPreview"===i.mCi.reportSheet.renderMode(),l=n;l<=u;l++)for(a=o;a<=s;a++)v=r.getCell(l,a),d=i.U5i(v,l,a),i.Z5i(d,l,a),v&&(i.Kir.Uir(v),h&&i.ofr(v),v.row===l&&v.col===a&&(0,p.lji)(v)&&(t=i.mji.aji(v),v.value=t,v.group.value=t),!h&&i.cwr&&v.row===l&&v.col===a&&"Collapsed"===v.cellNode.templateCell.initialExpansionState&&i.nOi.owr(v.group),"7"===(null==(t=v.cellNode.templateCell.cellType)?void 0:t.name)&&i.fzr.push(v),i.V5i(v,l,a),i.Q5i(d,l,a,c),null!=f&&f.Pfr(v,l,a),i.tEr(v.group));e=i.mCi.zoom(),i.mCi.g8(1),i.mCi.reportSheet.templateSheet.g8(1),i.mCi.allowEditing=!0,i.mji.hji(),i.XCi.wCi(),i.$Ci.fCi(),i.qCi.copyValidation(),i.hrr(),null!=(n=i.Gtr)&&n.Ptr(),null!=f&&f._fr(),i.sir(),i.nOi.jrr(),i.mCi.g8(e),i.mCi.reportSheet.templateSheet.g8(e),i.cwr=!1},u.prototype.uOi=function(t,n,i){var r,e,o,r,u,r=this,e=r.mji,o=r.Cji,r=r.Kfr,u=o.getCell(t,n);u&&u.row===t&&u.col===n&&(o.updateCellValue(t,n,i),e.gji(t,n,i),r)&&r.ACi(t,n)},u.prototype.sOi=function(t,n){var i=this.Cji.addRecord(t,n);return i.success&&(this.oOi(),this.nOi.Arr(t,n)),i},u.prototype.cOi=function(t,n){var t=this.Cji.deleteRecord(t,n);return t.success&&this.oOi(),t},u.prototype.fOi=function(){return this.Cji.getDataCollectionResults()},u.prototype.Sir=function(t,n){this.Cji.resetCellsStateToNormal(t,n)},u.prototype.u=function(){return this.Cji.isDirty()},u.prototype.aOi=function(t,n){return this.Cji.getCell(t,n)},u.prototype.BEi=function(t,n,i,r){return this.Cji.getCells(t,n,i,r)},u.prototype.nfr=function(t,n,i,r){return this.Cji.getCellsInPage(t,n,i,r)},u.prototype.ifr=function(t,n){var i,t,i={upParent:null,leftParent:null};if(this.s_i){if(!(t=this.s_i.get(t,n))||t.templateCell.isEmpty)return i;t.upParent&&(i.upParent={row:t.upParent.templateCell.row,col:t.upParent.templateCell.col}),t.leftParent&&(i.leftParent={row:t.leftParent.templateCell.row,col:t.leftParent.templateCell.col})}return i},u.prototype.azr=function(){return this.fzr},u.prototype.lOi=function(){return this.Z5||new c.Range(0,0,0,0)},u.prototype.F5t=function(t){var n=this;return n.nOi.$ji(t,!1)?0:n.Nl[t]},u.prototype.L5t=function(t){var n=this;return n.nOi.$ji(t,!0)?0:n.xl[t]},u.prototype.D7=function(t,n){var t=this.vOi[t];return t&&t[n]},u.prototype.ZF=function(n){return n?this.dOi.filter(function(t){return t.intersect(n.row,n.col,n.rowCount,n.colCount)}):e([],this.dOi,!0)},u.prototype.ML=function(t,n){var i,t,t,i=this,t=i.pOi[t];return t?(t=t[n])&&i.CCi.ML(t.row,t.col):null},u.prototype.Sl=function(t,n){var i,r,i,i=this,r=i.Cji.getCell(t,n);return r&&r.row===t&&r.col===n?(i=(0,p.lji)(r)?i.mji.Sl(t,n):r.value,Array.isArray(i)?e([],i,!0):i):null},u.prototype.wOi=function(){return this.qCi.getInvalidCells()},u.prototype.Rnr=function(){var t,t,n,i,n=this,i=n.mCi.zoom();n.mCi.g8(1),n.mCi.reportSheet.templateSheet.g8(1),null!=(t=this.Gtr)&&t.zrt(),null!=(t=this.Kfr)&&t.zrt(),n.mCi.g8(i),n.mCi.reportSheet.templateSheet.g8(i)},u.prototype.aji=function(t,n,i){return this.mji.wji(t,n,i)},u.prototype.Oji=function(t,n,i,r){this.nOi.Oji(t,n,i,r),this.Rnr()},u.prototype.Drr=function(t,n){return"C"===this.nOi.qji(t,n)},u.prototype.Lir=function(t,n){return this.nOi.Lir(t,n)},u.prototype.drr=function(t,n){var i=this.mji.brr(t,n);i.unshift(this.Cji.getCell(t,n)),this.Kir.Srr(this.xl,this.Nl,i)},u.prototype.oEr=function(t,n){this.Nl[t]=n},u.prototype.$mi=function(t,n){this.xl[t]=n},u.prototype.eG=function(){this.vOi=p.KEYWORD_UNDEFINED,this.dOi=p.KEYWORD_UNDEFINED,this.Cji=p.KEYWORD_UNDEFINED,this.CCi=p.KEYWORD_UNDEFINED,this.xl=p.KEYWORD_UNDEFINED,this.MOi=p.KEYWORD_UNDEFINED,this.Nl=p.KEYWORD_UNDEFINED,this.jOi=p.KEYWORD_UNDEFINED,this.pOi=p.KEYWORD_UNDEFINED,this.Z5=p.KEYWORD_UNDEFINED,this.mji.eG(),this.nOi.destroy()},u.prototype.c5=function(){this.iSi()},u.prototype.iSi=function(){var t,n,i,r,e,o,n,t=this,n=t.Cji;t.vOi=[],t.dOi=[],o=e=r=i=0,n&&(i=(n=n.getReportRange()).row,r=n.col,e=n.rowEnd-i+1,o=n.colEnd-r+1),t.fzr=[],t.rOi=new Array(e),t.eOi=new Array(o),t.xl=new Array(e),t.MOi=new Array(e),t.Nl=new Array(o),t.jOi=new Array(o),t.pOi=new Array(e),t.Z5=new c.Range(i,r,e,o),t.mji.c5(),t.nOi.reset(),t.Kir.c5()},u.prototype.V5i=function(t,n,i){(1<t.rowCount||1<t.colCount)&&t.row===n&&t.col===i&&this.Y5i(t.row,t.col,t.rowCount,t.colCount)},u.prototype.Y5i=function(t,n,i,r){for(var e,o,u,s,e=new c.Range(t,n,i,r),o=0;o<e.rowCount;o++)for(u=e.row+o,s=0;s<e.colCount;s++)this.vOi[u]||(this.vOi[u]=[]),this.vOi[u][e.col+s]=e;this.dOi.push(e)},u.prototype.U5i=function(t,n,i){var r,e,r,o,u,s,c,n,f,i,t,h,l,o,f;return t?(e=(r=t.overwrittenCellNode||t.cellNode).leftParent||r.upParent,o=(r=r.templateCell).row===r.rowEnd,u=r.col===r.colEnd,s=t.rowCount===r.rowEnd-r.row+1,c=t.colCount===r.colEnd-r.col+1,n=n-t.row,f=r.rowEnd-r.row+1,i=i-t.col,t=r.colEnd-r.col+1,h=o?r.row:r.row+n%f,l=u?r.col:r.col+i%t,o=o&&s?r.dataColumn?7:6:s?r.dataColumn?5:e?4:3:r.dataColumn?2:f<=n?-1:1,f=u&&c?r.dataColumn?7:6:c?r.dataColumn?5:e?4:3:r.dataColumn?2:t<=i?-1:1,{rowSetterPriority:o=(r.paginateBeforeRow||r.paginateAfterRow)&&s?100:o,colSetterPriority:f=(r.paginateBeforeColumn||r.paginateAfterColumn)&&c?100:f,templateCellRow:h,templateCellCol:l}):{rowSetterPriority:0,colSetterPriority:0,templateCellRow:void 0,templateCellCol:void 0}},u.prototype.Z5i=function(t,n,i,r){void 0===r&&(r=!1);var e=t.rowSetterPriority,o=t.colSetterPriority,u=t.templateCellRow,t=t.templateCellCol;0<=e&&(void 0===this.xl[n]||e>this.MOi[n])&&(this.xl[n]=this.CCi.L5t(u),this.MOi[n]=e,r)&&void 0!==u&&(this.rOi[n]=u),0<=o&&(void 0===this.Nl[i]||o>this.jOi[i])&&(this.Nl[i]=this.CCi.F5t(t),this.jOi[i]=o,r)&&void 0!==t&&(this.eOi[i]=t)},u.prototype.Q5i=function(t,n,i,r){this.pOi[n]||(this.pOi[n]=new Array(r)),this.pOi[n][i]={row:t.templateCellRow,col:t.templateCellCol}},u.prototype.H5i=function(){var t,n,t,t=this,n=t.mCi,t=t.lOi();t&&(n.setRowCount(t.row+t.rowCount),n.setColumnCount(t.col+t.colCount))},u.prototype.sir=function(){var t,n,i,r,e,o,u,s,c,f,h,l,t=this.mCi,n=this.CCi;if(t.shapes){for(i={},e=0,o=r=t.shapes.all();e<o.length;e++)u=o[e],s=n.Knr(u.name()),!(0,p.ht)(s)&&0<=s&&(i[s]=u);for(f=0,h=c=Object.keys(i);f<h.length;f++)l=h[f],t.shapes.zIndex(i[l].name(),+l)}},u.prototype.hrr=function(){this.Kir.yrr(this.xl,this.Nl),this.Kir.nrr()&&this.Kir.Hir(this.xl,this.Nl)},u.prototype.ofr=function(t){var n,i,n=t.cellNode.templateCell.cellType;"19"===(null==n?void 0:n.name)&&(i=this.mCi,(0,r.fur)({row:t.row,col:t.col,value:t.value,valuePath:n.valuePath},i))},u.prototype.tEr=function(t){var t=t;t.recordRowNumbers=void 0,t.I1e=void 0,t.valuePath=void 0,t.sortValues=void 0,t.slices=void 0},n.ReportDataModel=u},"./dist/plugins/report/data-model/template-info.js":function(t,n,i){"use strict";var r,e;function o(t){this.COi(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateInfo=void 0,r=i("Core"),o.prototype.COi=function(t){this.mOi=t},o.prototype.ML=function(t,n){return this.mOi.getActualStyle(t,n,r.SheetArea.viewport,!0)},o.prototype.F5t=function(t){return+this.mOi.getColumnWidth(t)},o.prototype.L5t=function(t){return+this.mOi.getRowHeight(t)},o.prototype.NOi=function(){return this.mOi.conditionalFormats},o.prototype.getCellStates=function(){return this.mOi.cellStates},o.prototype.getValidations=function(){return this.mOi.b8},o.prototype.lfi=function(){return this.mOi.shapes.all()},o.prototype.zfr=function(){return this.mOi.dataCharts.all()},o.prototype.Vfr=function(t){return this.mOi.dataCharts.get(t)},o.prototype.D7=function(t,n){return this.mOi.getSpan(t,n)},o.prototype.rnr=function(){return this.mOi.getRowCount()},o.prototype.enr=function(){return this.mOi.getColumnCount()},o.prototype.e2t=function(){return this.mOi.getCustomNames()},o.prototype.anr=function(t){return this.mOi.getCustomName(t)},o.prototype.Knr=function(t){return this.mOi.shapes.zIndex(t)},o.prototype.qnr=function(){return this.mOi.getPaginationSetting()},n.TemplateInfo=o},"./dist/plugins/report/definition-comments/index.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/report/definition-comments/template-sheet/index.js"),i("./dist/plugins/report/definition-comments/report-sheet.js")},"./dist/plugins/report/definition-comments/report-sheet.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/data-entry-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/index.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/report/definition-comments/template-sheet/template-cell.js"),i("./dist/plugins/report/definition-comments/template-sheet/data-entry-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/pagination-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/layout-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/others.js")},"./dist/plugins/report/definition-comments/template-sheet/layout-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/others.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/pagination-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/template-cell.js":function(){},"./dist/plugins/report/events/add-record.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Nji=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function e(t){return{addRecordSingleUseAction:(0,r.bOi)(t)}}n.Nji=e},"./dist/plugins/report/events/delete-record.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bji=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function e(t){return{deleteRecordSingleUseAction:(0,r.bOi)(t)}}n.bji=e},"./dist/plugins/report/events/helpers/utils.js":function(t,n){"use strict";function i(t){var n=!1;return function(){n||(n=!0,t())}}Object.defineProperty(n,"__esModule",{value:!0}),n.bOi=void 0,n.bOi=i},"./dist/plugins/report/events/index.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/plugins/report/events/add-record.js"),n),e(i("./dist/plugins/report/events/delete-record.js"),n),e(i("./dist/plugins/report/events/reset-current-cell.js"),n)},"./dist/plugins/report/events/reset-current-cell.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.J5i=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function e(t,n){return{name:"ReportSheetResetCellValue",selections:t,event:{canceled:!1,resetCellValueSingleUseAction:(0,r.bOi)(n)}}}n.J5i=e},"./dist/plugins/report/helpers/break-line-helper.js":function(t,n,i){"use strict";var v,r;function e(t){this.Mf=t,this.OOi={},this.yOi={}}Object.defineProperty(n,"__esModule",{value:!0}),n.BreakLineHelper=void 0,v=i("Core"),e.prototype.IOi=function(){var t,n,i,r,e,o,t=this,n=t.Mf,i=n.getRowCount(),r=n.getColumnCount();for(this.OOi={},this.yOi={},e=0;e<i;e++)for(o=0;o<r;o++)t._Oi(e,o,n.getTemplateCell(e,o),{})},e.prototype._Oi=function(t,n,i,r,e){var o,u,s,c,f,h,l,a,o=this,u=o.Mf,s=o.OOi,c=o.yOi,h=u.getSpan(t,n),l=1,a=1;h&&h.row===t&&h.col===n&&(l=h.rowCount,a=h.colCount),r=r||u.getTemplateCell(t,n),o.DOi(t,n,l,a),null==i||!i.paginateAfterRow||null!=r&&r.paginateAfterRow&&!e||(s[t+l]+=1,f=!0),null==i||!i.paginateAfterColumn||null!=r&&r.paginateAfterColumn&&!e||(c[n+a]+=1,f=!0),null==r||!r.paginateAfterRow||null!=i&&i.paginateAfterRow&&!e||(--s[t+l],f=!0),null==r||!r.paginateAfterColumn||null!=i&&i.paginateAfterColumn&&!e||(--c[n+a],f=!0),null==i||!i.paginateBeforeRow||null!=r&&r.paginateBeforeRow&&!e||(s[t]+=1,f=!0),null==i||!i.paginateBeforeColumn||null!=r&&r.paginateBeforeColumn&&!e||(c[n]+=1,f=!0),null==r||!r.paginateBeforeRow||null!=i&&i.paginateBeforeRow&&!e||(--s[t],f=!0),null==r||!r.paginateBeforeColumn||null!=i&&i.paginateBeforeColumn&&!e||(--c[n],f=!0),f&&u.ki(v.Events.ReportPaginationSettingChanged)},e.prototype.AOi=function(t,n){return!!(n?this.OOi:this.yOi)[t]},e.prototype.DOi=function(t,n,i,r){var e=this,o=e.OOi,e=e.yOi;(!o[t]||o[t]<0)&&(o[t]=0),(!o[t+i]||o[t+i]<0)&&(o[t+i]=0),(!e[n]||e[n]<0)&&(e[n]=0),(!e[n+r]||e[n+r]<0)&&(e[n+r]=0)},e.prototype.eG=function(){this.Mf=void 0,this.OOi=void 0,this.yOi=void 0},n.BreakLineHelper=e},"./dist/plugins/report/helpers/cell-node-info-helper.js":function(t,n,i){"use strict";var r,e,o;function u(t){this.mOi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.CellNodeInfoHelper=void 0,r=i("Report"),e=i("./dist/plugins/report/template/template-resolver.js"),u.prototype.Ytr=function(){var t,n,i,t=this,n=this.mOi,i=new e.ReportTemplateResolver(n);t.Jtr=new r.ParentChildTreeGenerator(i).process(!0).cellNodeCache,t.Ktr(n.getActiveRowIndex(),n.getActiveColumnIndex())},u.prototype.Ktr=function(t,n){var i,r,r,i=this,r=i.Jtr;i.Xtr(),r&&(r=r.get(t,n))&&!r.templateCell.isEmpty&&(r.upParent&&(i.f_i=r.upParent.templateCell.row,i.h_i=r.upParent.templateCell.col),r.leftParent)&&(i.a_i=r.leftParent.templateCell.row,i.l_i=r.leftParent.templateCell.col)},u.prototype.$tr=function(){return{leftParent:{row:this.a_i,col:this.l_i},upParent:{row:this.f_i,col:this.h_i}}},u.prototype.Xtr=function(){var t=this;t.f_i=void 0,t.h_i=void 0,t.a_i=void 0,t.l_i=void 0},u.prototype.eG=function(){this.Xtr(),this.mOi=void 0},n.CellNodeInfoHelper=u},"./dist/plugins/report/helpers/cell-reference-helper.js":function(t,n,i){"use strict";var h,r,e,l,o;function u(t){var f=this;this.TOi="GCTemplateSheetBuiltInCustomName",this.SOi=new e.SmartCache,this.xOi=[],this.nMr=new Map,this.EOi={},this.zOi=/^([A-Z]+)([0-9]+)$/,this.POi=/\$/g,this.rir=function(t,n,i){var r,n,e,o,n,u,s,c,r=f.Ywt(t.obj[t.key]),n=(0,l.kOi)(n),e=n.row,o=n.col,n=(0,l.kOi)(i),u=n.row,s=n.col,c=!1;return r.forEachNodes(function(t){t.type===h.ExpressionType.reference&&t.row===e&&t.column===o&&(t.row=u,t.column=s,c=!0)}),c?f.ROi(r):t[t.key]},this.iMr=function(t,n,i){return"=".concat(i)},this.Ywt=function(t){return f.Mf.Lp.parse(f.Mf.qgt,t,0,0)},this.ROi=function(t){return f.Mf.Lp.unparse(f.Mf.qgt,t,0,0)},this.Mf=t}Object.defineProperty(n,"__esModule",{value:!0}),n.CellReferenceHelper=void 0,h=i("CalcEngine"),r=i("SheetsCalc"),e=i("./dist/plugins/report/helpers/smart-cache.js"),l=i("./dist/plugins/report/utils/utils.js"),u.prototype.GOi=function(){this.Mf.suspendPaint(),this.Mf.suspendCalcService(),this.dl(),this.BOi(),this.UOi(this.Mf.getDataEntrySetting()),this.rMr(),this.Mf.resumeCalcService(),this.Mf.resumePaint()},u.prototype.dl=function(){var n,t,n=this,t;this.Mf.getCustomNames().forEach(function(t){t.getName().startsWith(n.TOi)&&n.Mf.removeCustomName(t.getName())}),this.EOi={},this.SOi=new e.SmartCache,this.xOi=[],this.nMr.clear()},u.prototype.ftr=function(t){var n=this;t.names&&(t.names=t.names.filter(function(t){return!t.name.startsWith(n.TOi)}))},u.prototype.htr=function(t){var n,i,n=this;null!=(i=null==t?void 0:t.lossless)&&i.definedNames&&(t.lossless.definedNames=t.lossless.definedNames.filter(function(t){return!t.name.startsWith(n.TOi)}))},u.prototype.ZOi=function(t,n,i){this.Mf.suspendPaint(),this.Mf.suspendCalcService();var r=this.SOi.get(t,n);r&&(this.VOi(r),this.SOi.set(t,n,[])),this.QOi(t,n,i),this.Mf.resumeCalcService(),this.Mf.resumePaint()},u.prototype.UOi=function(t){var n=this;this.Mf.suspendPaint(),this.Mf.suspendCalcService(),this.VOi(this.xOi),this.xOi=[],t&&t.forEach(function(t){t.fields.forEach(function(t){var t;(0,l.YOi)(t.formula)&&(t=n.WOi((0,l.FOi)(t.formula),t,"formula"),n.xOi.push(t))})}),this.Mf.resumeCalcService(),this.Mf.resumePaint()},u.prototype.rMr=function(){var n,t,i,n=this;null!=(t=this.Mf)&&t.dataCharts&&(i=this.Mf.dataCharts).all().forEach(function(t){n.Hfr(t)})},u.prototype.Hfr=function(t){var i,n,r,e,r,o,u,n,s,i=this,r=this.nMr.get(t);r&&this.VOi(r),e=[],r=t.getChartConfig(),o={dataChart:t,config:r},u=function(t){var n;null!=(n=null==t?void 0:t.field)&&n.startsWith("=")&&e.push(i.WOi(t.field.replace("=",""),t,"field",i.iMr,o))},0<(null==(n=null==r?void 0:r.plots)?void 0:n.length)&&(n=r.plots[0]).encodings&&(s=Object.values(n.encodings)).forEach(function(t){Array.isArray(t)?t.forEach(u):u(t)}),0<e.length&&this.nMr.set(t,e)},u.prototype._6=function(t){var e=this;t.forEach(function(t){var n,i,t,n,i,r,i,r,t,n=t.nameInfo,i=t.oldExpr,t=t.newExpr,n=e.EOi[n.getName()];n&&(t.type===h.ExpressionType.error?"vertical"!==n.key&&"horizontal"!==n.key||(n.obj[n.key]="None"):(n.JOi?(i=e.KOi(i).replace(e.POi,""),r=e.KOi(t).replace(e.POi,""),"field"===n.key&&n.obj.displayName===i&&(n.obj.displayName=r),n.obj[n.key]=n.JOi(n,i,r)):n.obj[n.key]=e.KOi(t).replace(e.POi,""),"field"===n.key&&n.extraInfo&&(r=(i=n.extraInfo).dataChart,t=i.config,r.BMr(t))))}),this.Mf.Ytr()},u.prototype.eG=function(){this.SOi=void 0,this.xOi=void 0,this.EOi=void 0,this.Mf=void 0},u.prototype.BOi=function(){for(var t,n,i,r,e,o,t=this.Mf,n=t.getRowCount(),i=t.getColumnCount(),r=0;r<=n;r++)for(e=0;e<=i;e++)(o=t.getTemplateCell(r,e))&&this.QOi(r,e,o)},u.prototype.QOi=function(t,n,i){i&&(this.XOi(t,n,i),this.$Oi(t,n,i),this.qOi(t,n,i),this.eir(t,n,i))},u.prototype.XOi=function(t,n,i){var r,e,r;i.context&&(e=(r=i.context).horizontal,r=r.vertical,this.YOi(r)&&this.t_i(r,i.context,"vertical",t,n),this.YOi(e))&&this.t_i(e,i.context,"horizontal",t,n)},u.prototype.$Oi=function(c,f,t){var h,l,h=this,l=function(t){var n,i,r,e,o,u,s,n=t.cell;if(h.YOi(n)&&h.t_i(n,t,"cell",c,f),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],l(e);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],l(s)};t.filter&&t.filter.condition&&l(t.filter.condition)},u.prototype.qOi=function(i,r,t){var e=this;"Group"===t.type&&t.bins&&t.bins.forEach(function(n){e.n_i(n.groupBy).forEach(function(t){e.t_i(t,n,"groupBy",i,r,e.rir)})})},u.prototype.eir=function(n,i,r){var e=this;r.defaultValue&&this.n_i(r.defaultValue).forEach(function(t){e.t_i(t,r,"defaultValue",n,i,e.rir)})},u.prototype.t_i=function(t,n,i,r,e,o){var t,n,t=this.WOi(t,n,i,o),n=this.SOi.get(r,e);n||this.SOi.set(r,e,n=[]),n.push(t)},u.prototype.WOi=function(t,n,i,r,e){var o,t,t,o=this.i_i(),t=this.r_i(t);return this.Mf.addCustomName(o,t,0,0),this.EOi[(t={name:o,obj:n,key:i,JOi:r,extraInfo:e}).name]=t},u.prototype.n_i=function(t){var t,n;return t?(t=this.Ywt(t),n=[],t.forEachNodes(function(t){var t;t.type===h.ExpressionType.reference&&(t=(0,l.e_i)(t.row,t.column),-1===n.indexOf(t))&&n.push(t)}),n):[]},u.prototype.i_i=function(){return"".concat(this.TOi).concat(Math.random().toString().substring(2)).concat((new Date).getTime())},u.prototype.YOi=function(t){return this.zOi.test((t||"").toUpperCase())},u.prototype.r_i=function(t){var t=this.zOi.exec(t);return t?"$"+t[1]+"$"+t[2]:null},u.prototype.KOi=function(t){var t=(0,r.expressionToFormula)(this.Mf,t);return t.substring(t.indexOf("!")+1)},u.prototype.VOi=function(t){var n=this;t.forEach(function(t){n.Mf.removeCustomName(t.name),n.EOi[t.name]=void 0})},n.CellReferenceHelper=u},"./dist/plugins/report/helpers/data-entry-helper.js":function(t,n,i){"use strict";var T,O,m,S,i,y,R,r;function e(t){this.Pji=t}T=this&&this.__assign||function(){return(T=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryHelper=void 0,O=i("Common"),m=i("Core"),S=i("./dist/plugins/report/utils/utils.js"),i=i("./dist/plugins/report/resources/index.js"),y=m.GC$,R=i.rm.getResource.bind(i.rm),e.prototype.uOi=function(t,n,i,r){var e,o,u,s,u;"Preview"!==this.Pji.options.renderMode||(o=(e=this.Pji).reportWorksheet.reportDataModel,(0,S.ht)(o))||(u=o.aOi(t,n))&&(s=o.Sl(t,n),r&&s!==i&&this.zur("update",t,n,s,i)||(o.uOi(t,n,i),"Row"===(u=u.cellNode.templateCell.autoFit)||"Column"===u?(o.drr(t,n),e.Mf.zw()):e.repaint(),r&&s!==i&&this.Zur("update",t,n)))},e.prototype.K5i=function(t,n,i){var r,e,o,o;"Preview"!==this.Pji.options.renderMode||(o=(e=this.Pji).reportWorksheet.reportDataModel,(0,S.ht)(o))||"updated"===(null==(r=null==(o=o.aOi(t,n))?void 0:o.group)?void 0:r.state)&&this.uOi(t,n,o.group.oldValue,i)},e.prototype.sOi=function(t,n){var i,r,e,e,o,e,o,e,t,i=this.Pji;"Preview"===i.options.renderMode&&i.reportWorksheet.isExpandable(t,n)&&(e=(r=i.reportWorksheet).reportDataModel,(0,S.ht)(e)||(i.suspendPaint(),o=(e=e.sOi(t,n)).success,e=e.nextActiveCell,o&&e&&(e=(o=this.Qur(e,t,n)).nextActiveRow,t=o.nextActiveCol,r.setActiveCell(e,t),r.showCell(e,t,m.VerticalPosition.nearest,m.HorizontalPosition.nearest)),i.resumePaint()))},e.prototype.cOi=function(t,n){var i,r,r,t,n,i=this.Pji;"Preview"===i.options.renderMode&&i.reportWorksheet.isExpandable(t,n)&&(r=i.reportWorksheet.reportDataModel,(0,S.ht)(r)||(i.suspendPaint(),t=(r=r.cOi(t,n)).success,n=r.nextActiveCell,t&&n&&(i.Mf.setActiveCell(n.row,n.col),i.Mf.showCell(n.row,n.col,m.VerticalPosition.nearest,m.HorizontalPosition.nearest)),i.resumePaint()))},e.prototype._tr=function(){return this.Str},e.prototype.xtr=function(t,n){this.ztr=t,this.Str=n},e.prototype.o_i=function(n){var i,r,e,v,t,o,u,s,c,f,h,l,d,a,p,M,w,I,g,C,N,j,E,A,D,b,r=new Promise(function(t){i=t}),e=this.Pji,v=e.getParent(),t=function(t,n){return i({success:!0,error:t,invalidCells:n}),r};try{if("Preview"!==this.Pji.options.renderMode)return t("Is_Not_Preview_Mode");if(!(o=e.reportWorksheet.reportDataModel))return t("ReportService_Is_Empty");if(y[y.sd]({jS:v},1),u=o.wOi(),s=o.fOi(),this.ztr&&"function"==typeof this.ztr)return c=e.getTemplate().getDataEntrySetting(),f=s.map(function(t,n){return{records:t.records,deleteRecords:t.deletedRecords,rule:c[n]}}),this.ztr(f,u);if(0<u.length)return e.reportWorksheet.jT(m.InvalidOperationType.reportSheet,O.Common.zf.I5(R().ContainsInvalidCells,[u.map(function(t){return t.join("-")}).toString()])),t("Contains_Invalid_Cells",[u.map(function(t){return t.join("-")}).toString()]);if(n&&(h={sheet:e,sheetName:e.name(),cancel:!1},e.ki(m.Events.ReportSheetRecordsSubmitting,h),!0===h.cancel))return r;d=l=0,a=!1,p=[],M=[],w=[],I=[],g=[],C=[],N=[],j=[],E=[],A=function(){var t;a&&0===l&&0===d&&(o.Sir(g,C),e.repaint(),n&&(0<g.length||0<C.length||0<p.length||0<M.length)&&(t={sheet:e,sheetName:e.name(),updateSuccessRecords:g,deleteSuccessRecords:C,updateFailedRecords:p.map(function(t,n){return T(T({},t),{reason:w[n]})}),deleteFailedRecords:M.map(function(t,n){return T(T({},t),{reason:I[n]})})},e.ki(m.Events.ReportSheetRecordsSubmitted,t)),i({success:0===p.length&&0===M.length,updateFailedRecords:p,deleteFailedRecords:M}))},D=function(){l--,A()},b=function(){d--,A()},s.forEach(function(t){var n,r,i,e,o,u,s,c,f,h,l,a;"Smart"===t.dataCollectionSetting.type&&(n=t.dataCollectionSetting,0!==(r=n.fields.filter(function(t){return t.isPrimary})).length)&&(i=t,e=v.dataManager().tables[n.tableName])&&(o=e._dataSource.LEt.batch,u=e.getDataSync(),s=i.records.map(function(i){return(0,S.u_i)(u,function(n){return r.every(function(t){return n[t.dbColumnName]===i.entity[t.dbColumnName]})})}),f=!(c=[]),h=function(t,n){d++,e.saveItem(t,function(){g.push(i.records[n]),b()},function(t){p.push(i.records[n]),w.push(null==t?void 0:t.reason),b()})},s.forEach(function(t,n){-1!==t&&(e.updateItem(t,i.records[n].entity),o||h(t,n),f=!0)}),l=u.length,s.forEach(function(t,n){-1===t&&(s[n]=e.length(),e.insertItem(l,i.records[n].entity),o||h(l,n),l++,f=!0)}),i.deletedRecords.forEach(function(i,t){var n=(0,S.u_i)(e.getDataSync(),function(n){return r.every(function(t){return n[t.dbColumnName]===i.entity[t.dbColumnName]})});-1!==n&&(o?e.remove(n,1):(d++,e.remove(n,1,function(){C.push(i),b()},function(t){M.push(i),I.push(null==t?void 0:t.reason),b()})),f=!0,c[t]=n)}),o)&&f&&(-1===(a=N.indexOf(e))?(N.push(e),j.push(i),E.push({updateRecordsTableIndexMapCache:s,deleteRecordsTableIndexMapCache:c})):(i.records.forEach(function(t){j[a].records.push(t)}),i.deletedRecords.forEach(function(t){j[a].deletedRecords.push(t)}),s.forEach(function(t){E[a].updateRecordsTableIndexMapCache.push(t)}),c.forEach(function(t){E[a].deleteRecordsTableIndexMapCache.push(t)})))}),N.forEach(function(o,t){l++;var n=j[t],u=n.records,s=n.deletedRecords,n=E[t],c=n.updateRecordsTableIndexMapCache,f=n.deleteRecordsTableIndexMapCache;o.submitChanges(function(t,n,i){var r,e;"update"===i||"insert"===i?(r=c.indexOf(t),(e=u[r])&&(p.push(e),w.push(n),(0,S.iwr)(o,i,t,e))):"delete"===i&&(r=f.indexOf(t),e=s[r])&&(M.push(e),I.push(n))}).then(function(t){t?(u.forEach(function(t){-1===p.indexOf(t)&&g.push(t)}),s.forEach(function(t){-1===M.indexOf(t)&&C.push(t)})):(u.forEach(function(t){-1===p.indexOf(t)&&p.push(t)}),s.forEach(function(t){-1===M.indexOf(t)&&M.push(t)})),D()})}),a=!0,A()}catch(t){i({success:!1,error:t})}return r},e.prototype.Qur=function(t,n,i){var r,e,o,u,s,c,f,h,l,u,e=this.Pji,o=e.reportWorksheet,u=o.reportDataModel,s=t.row,c=t.col;if(0===u.L5t(s)||0===u.F5t(c)){for(f=o.fnr(n,i),h=t.cellNode,l=e.templateSheet;h&&"List"===(null==(r=h.templateCell.dataSetting)?void 0:r.type)&&1===h.children.length;)if(h=h.children[0],0<+l.getRowHeight(h.templateCell.row)&&0<+l.getColumnWidth(h.templateCell.col)){f=h;break}(u=e.getCells(f.templateCell.row,f.templateCell.col,s,c)[0])&&(s=u.row,c=u.col)}return{nextActiveRow:s,nextActiveCol:c}},e.prototype.zur=function(t,n,i,r,e){var t={type:t,sheet:this.Pji,sheetName:this.Pji.name(),row:n,col:i,oldValue:r,newValue:e,cancel:!1};return this.Pji.ki(m.Events.ReportSheetDataChanging,t,!0),t.cancel},e.prototype.Zur=function(t,n,i){var t={type:t,sheet:this.Pji,sheetName:this.Pji.name(),row:n,col:i};this.Pji.ki(m.Events.ReportSheetDataChanged,t,!0)},n.DataEntryHelper=e},"./dist/plugins/report/helpers/pagination-helper.js":function(t,n,i){"use strict";var g,C,N,j,l,E,A,D,b,a,v,r;function e(t,n){this.mCi=t;var t=(this.Cji=n).getPaginationInfo();this.y_i=t?t.pages:[],this.I_i=new C.PrintInfo,this.__i=this.I_i.toJSON()}Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationHelper=void 0,g=i("Core"),C=i("Print"),N=i("./dist/plugins/report/utils/utils.js"),j=i("./dist/plugins/report/overrides/sheet-override.js"),l=i("ConditionalFormatting"),E=i("./dist/plugins/report/utils/chart-utils.js"),A=i("./dist/plugins/report/worksheet/paginated-sheet.js"),D=i("CellTypes"),b=i("./dist/plugins/report/worksheet/helpers/utils.js"),a=Math.min,v=Math.max,e.prototype.D_i=function(t){return null!=t&&(t=parseInt(t,10)||0)!==this.A_i&&0<=t&&this.y_i.length>t&&(this.A_i=t,this.T_i(),this.ozr(t)),{currentPage:this.x_i,currentPageIndex:this.A_i,range:this.y_i[this.A_i]}},e.prototype.E_i=function(){return this.y_i.length},e.prototype.zji=function(t,n,i){var r,e,o,u,s,c,f,h,h,r=this,e=r.mCi.getParent(),o=r.mCi.name(),u=[],s=r.E_i();for(r.T_i(),c=0;c<s;c++)r.A_i=c,f="".concat(o,"-").concat(c+1),t&&(h=t(c),(0,N.ht)(h)||(f=h.toString())),e&&(f=this.z_i(f,e)),h=this.ozr(c,f,i),n&&n(h),u.push(h);return u},e.prototype.Gf=function(){return new e(this.mCi,this.Cji)},e.prototype.P_i=function(t,n){for(var i,r,e,o,i=this.y_i,r=0,e=i.length;r<e;r++)if((o=i[r]).row<=t&&o.rowEnd>=t&&o.col<=n&&o.colEnd>=n)return r},e.prototype.z_i=function(t,n){for(;n.Gm(t);)t="".concat(t,"(2)");return t},e.prototype.ozr=function(t,n,i){var r,e,n,n,n,o,t,u,s,c,f,t,h,l,a,v,d,p,M,w,I,r=this;if(n=n||r.mCi.name(),(e=new(i?g.Worksheet:A.PaginatedSheet)(n)).isReportSheetPaginatedWorksheet=!0,e.comboCells=[],i&&(0,b.vzr)(e),e.parent=r.mCi.parent,r.fSt(e),n=r.I_i,i?(n=new C.PrintInfo).fromJSON(r.__i):(0,j.L_i)(e,r.mCi.reportSheet),n.sheet(e),e.printInfo(n),(n=e.printInfo()).fitPagesTall(1),n.fitPagesWide(1),this.x_i=e,(0,N.k_i)(r.mCi.reportSheet.templateSheet,e),e.options.isProtected=!0,e.options.disableContextMenu=!0,e.options.gridline.showHorizontalGridline=!1,e.options.gridline.showVerticalGridline=!1,n=r.mCi.zoom(),r.mCi.g8(1),e.g8(1),o=r.mCi,t=r.y_i[t],u=t.row,s=t.col,c=t.rowEnd,f=t.colEnd,t=Math.max(c-u+1,0),h=Math.max(f-s+1,0),e.setRowCount(t),e.setColumnCount(h),0!==t&&0!==h&&(o.vT(u,s,0,0,t,h,g.CopyToOptions.all&~g.CopyToOptions.formula&~g.CopyToOptions.conditionalFormat&~g.CopyToOptions.shape,!1,!1,e,{ignoreValidator:!0}),l=this.lnr(u,s)))for(a=l.row,v=l.col,d=a+l.rowCount-1,p=v+l.colCount-1;a<=d;a++){for(;v<=p;v++)e.setStyle(a-u,v-s,o.getActualStyle(a,v));v=l.col}for(M=u;M<=c;M++)e.setRowHeight(M-u,o.getRowHeight(M));for(w=s;w<=f;w++)e.setColumnWidth(w-s,o.getColumnWidth(w));return(I=r.mCi.reportDataModel.azr()).forEach(function(t){var n,i;t.row>=u&&t.col>=s&&t.row+t.rowCount-1<=c&&t.col+t.colCount-1<=f&&(n=o.getCellType(t.row,t.col),(i=new D.ComboBox).fromJSON(n.toJSON({gp:!0})),e.setCellType(t.row-u,t.col-s,i),e.comboCells.push({row:t.row,col:t.col}))}),r.fCi(u,s),r.n9i(u,s),r.Xnr(u,s),r.Rtr(u,s),(0,E.ezr)(e,r.mCi.getAllParameters()),r.mCi.g8(n),e.g8(n),r.lSt(e),i||(0,j.G_i)(e,r.mCi.reportSheet),e},e.prototype.lnr=function(t,n){var i,r,i,t,n,i=this,r=i.x_i,i=i.mCi,t=new g.Range(t,n,r.getRowCount(),r.getColumnCount()),n=i.getUsedRange(g.UsedRangeType.conditionFormat);if(n)return-1!==n.row&&-1!==n.rowCount||(n.row=0,n.rowCount=i.getRowCount()),-1!==n.col&&-1!==n.colCount||(n.col=0,n.colCount=i.getColumnCount()),t.getIntersect(n,r.getRowCount(),r.getColumnCount())},e.prototype.fCi=function(t,n){var i,i,r,i,e,i,o,u,s,c,f,f,i=this,r=i.x_i,i=i.mCi,e=new g.Range(t,n,r.getRowCount(),r.getColumnCount()),i=null==(i=i.cellStates)?void 0:i.all();if(null!=i&&i.length)for(o=[g.CellStatesType.hover,g.CellStatesType.selected,g.CellStatesType.active],u=0,s=i;u<s.length;u++)f=(c=s[u]).range,0<=o.indexOf(c.state)&&(f=f.getIntersect(e,r.getRowCount(),r.getColumnCount()))&&(f.row=f.row-t,f.col=f.col-n,r.cellStates.add(f,c.state,c.style))},e.prototype.n9i=function(s,c){var t,t,f,t,h,n,i,r,e,o,u,t=this,f=t.x_i,t=null==(t=t.mCi.conditionalFormats)?void 0:t.getRules(),h=new g.Range(s,c,f.getRowCount(),f.getColumnCount()),n=function(t){for(var n,i,r,e,o,u,n,i=[],r=0,e=t.ranges();r<e.length;r++)(u=(o=e[r]).getIntersect(h,f.getRowCount(),f.getColumnCount()))&&(u.row=u.row-s,u.col=u.col-c,i.push(u));return i};if(null!=t&&t.length)for(i=0,r=t;i<r.length;i++)(e=r[i])instanceof l.StateRule?(o=n(e)).length&&(e.ruleType()===l.RuleType.rowStateRule?f.conditionalFormats.addRowStateRule(e.state(),e.style(),o):e.ruleType()===l.RuleType.columnStateRule&&f.conditionalFormats.addColumnStateRule(e.state(),e.style(),o)):e instanceof l.DataBarRule?(o=n(e)).length&&((u=f.conditionalFormats.addDataBarRule(e.minType(),e.minValue(),e.maxType(),e.maxValue(),e.color(),o)).showBarOnly(e.showBarOnly()),u.gradient(e.gradient()),u.borderColor(e.borderColor()),u.showBorder(e.showBorder()),u.dataBarDirection(e.dataBarDirection())):e instanceof l.IconSetRule&&(o=n(e)).length&&((u=f.conditionalFormats.addIconSetRule(e.iconSetType(),o)).showIconOnly(e.showIconOnly()),u.reverseIconOrder(e.reverseIconOrder()))},e.prototype.Xnr=function(t,n){var i,r,e,o,u,i,s,c,f,h,l,a,v,d,p,M,h,r=this,e=r.x_i,o=null==(i=r.mCi.b8)?void 0:i.YB;if(o&&(e.b8.fromJSON(r.mCi.b8.toJSON(),null,e),e.b8.d5(),u=new g.Range(t,n,e.getRowCount(),e.getColumnCount()),(i=Object.keys(o)).length))for(s=0,c=i;s<c.length;s++){for(a=[],v=0,d=l=(h=o[f=c[s]]).smt();v<d.length;v++)(M=(p=d[v]).getIntersect(u,e.getRowCount(),e.getColumnCount()))&&(M.row=M.row-t,M.col=M.col-n,a.push(M));a.length&&((h=h.clone(e))._S=a,h.g6t(a),e.b8.w6t(h))}},e.prototype.Rtr=function(t,n){var i,r,e,r,o,u,s,c,f,h,l,a,v,d,v,d,i=this,r=i.mCi,e=i.x_i;if(r.shapes)for(r=r.shapes.all(),o=e.getRowCount()+t,u=e.getColumnCount()+n,s=new g.Range(t,n,o-t,u-n),c=0,f=r;c<f.length;c++)l=(h=f[c]).startRow(),a=h.startColumn(),v=h.endRow(),d=h.endColumn(),s.intersect(l,a,v-l+1,d-a+1)&&s.intersect(l,a,1,1)&&(v=h.Gf(e))&&(e.shapes.ZP(v),d=i.Ztr(h,t,n,o-1,u-1),v.width(d.width),v.height(d.height),v.x(d.x),v.y(d.y))},e.prototype.Ztr=function(t,n,i,r,e){var o,u,s,t,n,i,c,f,h,l,o=t.x(),u=t.y(),s=t.width()+o,t=t.height()+u,n=(0,N.U_i)(this.mCi,n,i),i=(0,N.U_i)(this.mCi,r,e),c,f,h,l;return{x:v(o-n.x,0),y:v(u-n.y,0),width:a(i.x+i.width,s)-o,height:a(i.y+i.height,t)-u}},e.prototype.T_i=function(){this.__i=this.mCi.reportSheet.printInfo().toJSON(),this.I_i.fromJSON(this.__i),this.I_i.showRowHeader(1),this.I_i.showColumnHeader(1)},e.prototype.fSt=function(t){t.suspendPaint(),t.suspendEvent(),t.suspendDirty()},e.prototype.lSt=function(t){t.resumeDirty(),t.resumeEvent(),t.resumePaint()},n.PaginationHelper=e},"./dist/plugins/report/helpers/parameter-helper.js":function(t,e,n){"use strict";var i,r,c,f,o,h,l,a,u,v,s;function d(t,n){var i=n.host,r=n.initParametersUI,n=n.onChange;this.Pji=t,this.Ti=i,this.H_i=r,this.Z_i=n,this.V_i=this.Q_i(),this.bir=Object.assign({},t.parameter())}Object.defineProperty(e,"__esModule",{value:!0}),e.ParameterHelper=e.PARAMETER_PANEL_WORKBOOK=void 0,i=n("Core"),r=n("Common"),c=n("Bindings"),f=n("CellTypes"),o=i.GC$,h=r.Common.lt.ht,l=".parameterPanelEvent",a=".parameterPanelChangedEvent",u=null,v=void 0,e.PARAMETER_PANEL_WORKBOOK="workbook",d.prototype.Y_i=function(){var t=this,n=t.V_i;t.W_i(n),t.F_i(n)},d.prototype.L0=function(t,n){var i=this,r=i.V_i;t&&(i.J_i(),i.K_i(),r.destroy(),delete i.V_i,o(i.Ti).data(e.PARAMETER_PANEL_WORKBOOK,u))},d.prototype.Q_i=function(){var t,n,n,t=this,n=t.Ti,n=o(n).data(e.PARAMETER_PANEL_WORKBOOK);return n||(n=new i.Workbook(t.Ti,{sheetCount:1}),o(t.Ti).data(e.PARAMETER_PANEL_WORKBOOK,n)),n.options.allowDynamicArray=!0,n},d.prototype.W_i=function(t){var n,i,r,r,n=this;t.suspendPaint(),t.suspendEvent(),i=t.getActiveSheet(),(r=this.Pji.Sji)&&i.fromJSON(r),n.H_i(i),r=i.toJSON({}),t.options.highlightInvalidData&&(r.highlightInvalidData=!0),this.Pji.Sji=r,n.X_i(i),t.resumeEvent(),t.resumePaint()},d.prototype.X_i=function(t){var n,i,i,r,e,o,u,s,n,i=this.Pji.parameter(),i=new c.CellBindingSource(i);for(t.setDataSource(i),r=t.getRowCount(),e=t.getColumnCount(),o=0;o<r;o++)for(u=0;u<e;u++)((s=t.getCell(o,u)).bindingPath()||s.cellType())&&s.locked(!1)},d.prototype.F_i=function(t){var n,i,n,i=this,n=t.getActiveSheet();t.suspendPaint(),t.suspendEvent(),i.$_i(t),i.q_i(n),i._Ti(t),t.setDataManager(null==(n=this.Pji.getParent())?void 0:n.dataManager()),t.resumeEvent(),t.resumePaint()},d.prototype.$_i=function(t){t.options.allowContextMenu=!1,t.options.allowUserZoom=!1,t.options.showVerticalScrollbar=!1,t.options.showHorizontalScrollbar=!1,t.options.tabStripVisible=!1,t.options.allSheetsListVisible=i.AllSheetsListVisibility.hide,t.options.allowUserDragDrop=!1,t.options.allowDragHeaderToMove=i.AllowDragHeaderToMove.none},d.prototype.q_i=function(t){t.options.colHeaderVisible=!1,t.options.rowHeaderVisible=!1,t.setRowCount(100),t.setColumnCount(100),t.options.gridline.showHorizontalGridline=!1,t.options.gridline.showVerticalGridline=!1,t.selectionPolicy(i.SelectionPolicy.single),t.protect()},d.prototype._Ti=function(t){var u,s,r,c,u=this,s=u.Pji,r=t.getActiveSheet();u.J_i(),u.K_i(),r.bind(i.Events.TopRowChanged+l,function(t,n){r.showRow(0,i.VerticalPosition.top),n.newTopRow=0}),r.bind(i.Events.LeftColumnChanged+l,function(t,n){r.showColumn(0,i.HorizontalPosition.left),n.newLeftCol=0}),r.bind(i.Events.EditStarting+l,function(t,n){var i,r,e,o,u,i=n.sheet,r=n.row,e=n.col,o,u;i.getCell(r,e).cellType()instanceof f.CheckBox&&(n.cancel=!0)}),u.Ti.addEventListener("contextmenu",u.PTi),i.Worksheet.ch("parameterPanel",{priority:1800,needPaintSelection:function(t){var n,i,n;this===r&&(n=this.getActiveRowIndex(),i=this.getActiveColumnIndex(),(n=this.getCell(n,i)).bindingPath()||n.cellType()||(t.nps=!1))}}),c=function(t,n,i,r,e,o){var n,i,n,t,i,n=t.getCell(n,i),i=n.tag(),n=n.bindingPath(),t=t.getDataSource().getSource();!h(n)&&h(e)&&(t[n]=e=""),s.parameter(t),i={tag:h(i)?n:i,oldValue:o?u.bir[n]:r,newValue:e},u.Z_i(s,i),i.newValue!==e&&t&&n&&(t[n]=i.newValue,s.parameter(t)),u.bir=Object.assign({},s.parameter())},r.bind(i.Events.ValueChanged+a,function(t,n){var i=n.sheet,r=n.row,e=n.col,o=n.newValue,n=n.oldValue;i&&c(i,r,e,n,o)}),r.bind(i.Events.RangeChanged+a,function(t,n){var i=n.sheet,n=n.changedCells;i&&null!=n&&n.length&&n.forEach(function(t){var n=t.row,t=t.col;void 0!==n&&void 0!==t&&c(i,n,t,void 0,i.getValue(n,t),!0)})}),t.bind(i.Events.ButtonClicked+a,function(t,n){var i,r,n,i,r,n,i=n.sheet,r=n.row,n=n.col;!i||(r=(i=i.getCell(r,n)).cellButtons())&&r.length||(n={tag:i.tag(),oldValue:v,newValue:v},u.Z_i(s,n))})},d.prototype.J_i=function(){var t,n,i,t,n=this.V_i,i=n.getActiveSheet();n&&n.unbind(a),i&&i.unbind(a)},d.prototype.K_i=function(){var t,n,t=this,n=t.V_i.getActiveSheet();n&&n.unbind(l),t.Ti.removeEventListener("contextmenu",t.PTi)},d.prototype.PTi=function(t){t.preventDefault()},e.ParameterHelper=d},"./dist/plugins/report/helpers/smart-cache.js":function(t,n){"use strict";var i;function r(){this.cE=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.SmartCache=void 0,r.prototype.get=function(t,n){if(this.cE[t])return this.cE[t][n]},r.prototype.set=function(t,n,i){this.cE[t]||(this.cE[t]=[]),this.cE[t][n]=i},r.prototype.getCache=function(){return this.cE},r.prototype.reset=function(){this.cE=[]},n.SmartCache=r},"./dist/plugins/report/helpers/template-alias-helper.js":function(t,n,i){"use strict";var h,c,s,r;function e(t){this.vnr=new s.SmartCache,this.template=t}Object.defineProperty(n,"__esModule",{value:!0}),n.AliasHelper=void 0,h=i("Core"),c=i("./dist/plugins/report/utils/utils.js"),s=i("./dist/plugins/report/helpers/smart-cache.js"),e.prototype.dnr=function(t,n,i){var r,e,o,u,s,o,r,e=this.template,o=this.pnr(t,n,i),u=o.oldAlias,s=o.newAlias,o=o.oldColumnInfo;if(u!==s){if(s){e.getCustomName(s)&&(s=this.wnr(s));try{this.template.addCustomName(s,(0,c.gnr)(t,n),0,0),this.vnr.set(t,n,s),i.alias=s,this.Mnr(u,s)}catch(t){if(o===i.binding)return void(i.alias=u);i.alias=s=null}}u&&(s||this.vnr.set(t,n,null),this.template.removeCustomName(u))}},e.prototype.Mnr=function(t,n){var i,r,e,o,u,s,c,f,i,r=this.template;if(t&&n&&(e=r.getUsedRange(h.UsedRangeType.formula)))for(u=e.row+e.rowCount-1,s=e.col+e.colCount-1,c=e.row;c<=u;c++)for(f=e.col;f<=s;f++)(o=r.bMt(c,f))&&this.mtr(o,t,n)},e.prototype.mtr=function(t,n,i){var r,e,o;if(8===t.type&&t.value.toLocaleUpperCase()===n.toLocaleUpperCase()&&(t.value=i),t.arguments)for(r=0,e=t.arguments;r<e.length;r++)o=e[r],this.mtr(o,n,i);t.value&&this.mtr(t.value,n,i),t.value2&&this.mtr(t.value2,n,i)},e.prototype.jnr=function(){var t,n,i,r,e,t,o,u,n=this,i=n.template;for(n.Cir(),n.vnr=new s.SmartCache,r=i.getRowCount()-1,e=i.getColumnCount()-1,o=0;o<=r;o++)for(u=0;u<=e;u++)(t=null==(t=i.getTemplateCell(o,u))?void 0:t.alias)&&(n.vnr.set(o,u,t),n.template.addCustomName(t,(0,c.gnr)(o,u),0,0))},e.prototype.Cir=function(){for(var t,n,i,r,e,o,t=this,n=t._nr(),i,r=0,e=Object.keys(n);r<e.length;r++)o=e[r],t.template.removeCustomName(o)},e.prototype.ftr=function(t){var n;t.names&&(n=this._nr(),t.names=t.names.filter(function(t){return!n[t.name]}))},e.prototype.htr=function(t){var n,i;null!=(n=null==t?void 0:t.lossless)&&n.definedNames&&(i=this._nr(),t.lossless.definedNames=t.lossless.definedNames.filter(function(t){return!i[t.name]}))},e.prototype._nr=function(){var n={},t;return this.vnr.getCache().forEach(function(t){t&&t.forEach(function(t){t&&(n[t]=!0)})}),n},e.prototype.pnr=function(t,n,i){var i,r,e,r=this,e={oldAlias:r.vnr.get(t,n),newAlias:null,oldColumnInfo:null};return i&&(e.newAlias=i.alias),e.oldColumnInfo=null==(i=r.template.getTemplateCell(t,n))?void 0:i.binding,e},e.prototype.wnr=function(t,n){var i=this,r=(n=void 0===n?0:n)?t+"_"+n:t;return this.template.getCustomName(r)?i.wnr(t,++n):r},n.AliasHelper=e},"./dist/plugins/report/helpers/template-tooltip-helper.js":function(t,n,i){"use strict";var r,e,o,f,h,l,u;function s(t){this.dV=t}Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateTooltipHelper=void 0,r=i("Common"),e=i("Core"),o=i("./dist/plugins/report/resources/index.js"),f=i("./dist/plugins/report/template/utils.js"),h=o.rm.getResource.bind(o.rm),l=r.Common.zf,s.prototype.RTi=function(t,n){var i,r,e,o,u,s,r,c,i=this.dV,r=i.getTemplateCell(t,n),e=[];if(r){switch(o=(0,f.BTi)(r),u="",r.type){case"List":u=h().listCellType;break;case"Group":u=h().groupCellType;break;case"Summary":u=h().summaryCellType}if("Summary"===r.type){switch(s="",r.aggregate){case"Sum":s=h().summarySumTip;break;case"Avg":s=h().summaryAvgTip;break;case"Max":s=h().summaryMaxTip;break;case"Min":s=h().summaryMinTip;break;case"Count":s=h().summaryCountTip;break;case"None":s=h().summaryNoneTip}u+=s}"Chart"!==r.type&&"Static"!==r.type&&e.push(h().toolTipCellType+u),o&&(o.tableName&&e.push(h().toolTipTableName+o.tableName),o.columnName)&&e.push(h().toolTipColumnName+o.columnName)}if((r=i.getFormula(t,n))&&e.push(h().toolTipFormula+r),0<e.length){for(c=0;c<e.length;c++)e[c]=l.j0(e[c]);return e.join("\r\n")}},n.TemplateTooltipHelper=s,e.GC$.extend(e.Workbook.prototype,{rpwm:function(t,n,i){return i?[h().wmk1,0]:-1===t?i?[h().wmk1,0]:[h().wmk2,1]:void 0}}),e.GC$.extend(e.Worksheet.prototype,{rpwm:function(t,n,i){return i?[h().wmk1,0]:-1===t?i?[h().wmk1,0]:[h().wmk2,1]:void 0}})},"./dist/plugins/report/index.js":function(t,n,i){"use strict";var r,e,o;Object.defineProperty(n,"__esModule",{value:!0}),n.SR=n.TemplateSheet=n.ReportSheet=void 0,r=i("./dist/plugins/report/report-sheet.js"),Object.defineProperty(n,"ReportSheet",{enumerable:!0,get:function(){return r.ReportSheet}}),e=i("./dist/plugins/report/worksheet/template-sheet.js"),Object.defineProperty(n,"TemplateSheet",{enumerable:!0,get:function(){return e.TemplateSheet}}),o=i("./dist/plugins/report/resources/report.ns.js"),Object.defineProperty(n,"SR",{enumerable:!0,get:function(){return o.SR}}),i("./dist/plugins/report/definition-comments/index.js")},"./dist/plugins/report/overrides/container-feature-register.js":function(t,n,i){"use strict";var M,r,v,i,d;function e(){M.Worksheet.ch("reportsheetContainer",{paintAdornment:function(t){var l,a,e,t,o,l=this,a=t.ctx,e=t.clipRect;l instanceof r.TemplateSheet&&(t=l.fwr(),o=e,t.forEach(function(h){var t,t,t,n,i,r,t,t=h.viewportRangeRect;(e=o?e:l.Fi().c9(1,1)).intersectRect(t)&&(a.save(),t=e.getIntersectRect(t),a.rect(t.x-1,t.y-1,t.width+2,t.height+2),a.clip(),h.isActive?h.rangeRects.forEach(function(t,n){for(var i,r,e,o,u,s,c,f,i=!1,r=h.ranges[n],e=r.row,o=r.col,u=r.rowCount,s=r.colCount,c=0;c<u;c++){for(f=0;f<s;f++)if(l.getTemplateCell(e+c,o+f)||null!==l.getValue(e+c,o+f)){i=!0;break}if(i)break}(0,v.hwr)(a,t,n,h.backColor,!i)}):(n=(t=h.rangeRect).x,i=t.y,r=t.width,t=t.height,a.lineWidth=1,a.setLineDash([3,2]),a.beginPath(),a.strokeStyle="rgb(0, 0, 208)",a.moveTo(n,i),a.lineTo(n+r,i),a.lineTo(n+r,i+t),a.lineTo(n,i+t),a.lineTo(n,i),a.stroke(),a.closePath()),a.restore())}))},onLayoutChanged:function(t){var v,d,p,u,s,t,n,c,v=this,d=t.col,p=t.colCount,u=t.row,s=t.rowCount,t=t.changeType;!v.isReportTemplateSheet||"deleteRows"!==t&&"deleteColumns"!==t||v.updateAllAliasInfo(),v.isReportTemplateSheet&&(n=v.containers(),c=[],"addColumns"===t?n.forEach(function(l){var a,t,n,a=l.ranges,t=a[1].col,n=a[2].col+a[2].colCount-1;d<=t?a.forEach(function(t){t.col+=p}):d<=n&&a.forEach(function(t,n){var i,r,e,o,u,s,c,f,o,h,i=t.col,r=t.col+t.colCount-1;if((0===n||2===n)&&i<=d){if(t.colCount+=p,0===n&&d===i)for(e=0;e<t.rowCount;e++)e===t.rowCount-1&&l.options.aggLabelVisible||((o=v.getSpan(t.row+e,t.col+p))&&o.row===t.row+e&&o.col===t.col+p||!o&&2===t.colCount&&1===p)&&(u=v.getSelections()[0],s=o?o.row:t.row+e,c=o?o.col:t.col+p,f=o?o.rowCount:1,o=o?o.colCount:1,v.removeSpan(s,c),v.awr=!0,v.copyTo(s,c,s,c-1,1,1,M.CopyToOptions.style),v.moveTo(s,c,s,c-1,1,1,M.CopyToOptions.all^M.CopyToOptions.style),v.awr=!1,v.addSpan(s,c-p,f,o+p),v.setSelection(u.row,u.col,u.rowCount,u.colCount))}else if(1===n&&i<d&&d<=r&&(t.colCount+=p,a[0].col+=p,a[2].col+=p,1<a[0].rowCount)&&v.getSpan(t.row,t.col))for(h=0;h<p;h++)v.addSpan(t.row,d+h,a[0].rowCount,1)})}):"deleteColumns"===t?n.forEach(function(r){var e,t,n,o,u,e=r.ranges,t=e[1].col,n=e[2].col+e[2].colCount-1;d+p-1<t?e.forEach(function(t){t.col-=p}):n<d||(o=new M.Range(0,d,v.getRowCount(),p),u=0,e.forEach(function(t,n){var i=o.getIntersect(t,0,0);i&&(0===n||2===n?i.col===t.col&&i.colCount===t.colCount?c.push(r):i.col>=t.col&&i.colCount<=t.colCount&&(t.colCount-=i.colCount):1===n&&(i.col===t.col&&i.colCount===t.colCount?c.push(r):i.col>=t.col&&i.colCount<=t.colCount&&(t.colCount-=i.colCount,e[0].col-=i.colCount,u=i.colCount)))}),u&&(e[2].col-=u))}):"addRows"===t?n.forEach(function(t){var o,t,n,o=t.ranges,t=o[1].row,n=o[2].row+o[2].rowCount-1;u<=t?o.forEach(function(t){t.row+=s}):u<=n&&o.forEach(function(t,n){var i,r,e,i=t.row,r=t.row+t.rowCount-1;if((u<=r&&2!==n||2===n&&i<=u&&u<=r)&&(t.rowCount+=s,0===n)&&(o[2].row+=s,1<o[0].colCount))for(e=0;e<s;e++)v.addSpan(u+e,t.col,1,o[0].colCount)})}):"deleteRows"===t&&n.forEach(function(r){var e,t,n,o,e=r.ranges,t=e[1].row,n=e[1].row+e[1].rowCount-1;u+s-1<t?e.forEach(function(t){t.row-=s}):n<u||(o=new M.Range(u,0,s,v.getColumnCount()),e.forEach(function(t,n){var i=o.getIntersect(t,0,0);i&&(0===n?i.row===t.row&&i.rowCount===t.rowCount?c.push(r):i.row>=t.row&&i.rowCount<=t.rowCount&&(t.rowCount-=i.rowCount,e[2].row-=i.rowCount):1!==n&&2!==n||(i.row===t.row&&i.rowCount===t.rowCount?c.push(r):i.row>=t.row&&i.rowCount<=t.rowCount&&(t.rowCount-=i.rowCount)))}))}),n=n.filter(function(t){return-1===c.indexOf(t)}),v.containers(n))},copyOrMoveTo:function(t){var n,i,r,e,o,u,s,c,f,h,n,i,l,a,v,r,n=t.src,i=t.dest,r=t.srcRow,e=t.srcColumn,o=t.destRow,u=t.destColumn,s=t.rowCount,c=t.columnCount,f=t.isMove,h=this;n.isReportTemplateSheet&&i.isReportTemplateSheet&&!i.awr&&(n=n.containers(),i=i.containers(),l=new M.Range(r,e,s,c),a=[],n.forEach(function(t){var n=new M.Range(t.ranges[1].row,t.ranges[1].col,t.ranges[1].rowCount,t.ranges[1].colCount+t.ranges[2].colCount);l.containsRange(n)&&a.push(t)}),v=new M.Range(o,u,s,c),(r=i.some(function(n){return v.intersect(n.ranges[1].row,n.ranges[1].col,n.ranges[1].rowCount,n.ranges[1].colCount+n.ranges[2].colCount)&&(!f||!a.find(function(t){return n.ranges[1].row===t.ranges[1].row&&n.ranges[1].col===t.ranges[1].col&&n.ranges[1].rowCount===t.ranges[1].rowCount&&n.ranges[1].colCount===t.ranges[1].colCount}))}))&&h.ki(M.Events.InvalidOperation,{invalidType:17,sheet:h,sheetName:h.name(),message:d().Exp_InvalidPasteRange},!0),t.cancel=r)}}),M.Y8.ch("templateSheet",{applyChanges:function(t){var n,i,t,t,n,i=t.changes,t=t.isUndo;i&&(t=t?i.originalContainers:i.currentContainers)&&this.lwr(t)},undo:function(t){var n,t,n,t=t.originalContainers;t&&this.lwr(t)}}),M.GC$.extend(M.Y8.prototype,{vwr:function(t){var n,i,n,n=this,i=n.Mf;i.isReportTemplateSheet&&(n=n.G8)&&(t||!n.originalContainers)&&(t?n.currentContainers=i.containers():n.originalContainers=i.containers())},lwr:function(t){var n=this.Mf;n.isReportTemplateSheet&&(n.suspendPaint(),t&&n.containers(t),n.resumePaint())}})}Object.defineProperty(n,"__esModule",{value:!0}),n.dwr=void 0,M=i("Core"),r=i("./dist/plugins/report/worksheet/template-sheet.js"),v=i("./dist/plugins/report/render/paint-container-range.js"),i=i("./dist/plugins/report/resources/index.js"),d=i.rm.getResource.bind(i.rm),n.dwr=e},"./dist/plugins/report/overrides/feature-register.js":function(t,n,i){"use strict";var a,v,r,e,o,d,p,M,w,I,g,C,u,N,j,E,A,D,b,T;function O(t){var n,n;return t&&(n=t.getParent())&&(n=n.getSheetTab(t.name()))instanceof p.ReportSheet?n:null}function s(){v.Workbook.ch("reportSheet",{adlc:function(t){var n,i,r,e,o,t,u,s,c,f,n=t.flg,i=t.checkRs,r=t.m,e=t.d,o=t.nl,t=t.fn,u,s=["tSheet","epor"],c=this.rpwm||this.parent&&this.parent.rpwm;n&&-1===n.indexOf("r".toUpperCase()+s[1]+s[0])?(i.wm=i.wm||[],(f=c&&c(r,e,!0))&&i.wm.push(f),i.nwm=!0,i.state||(i.state=[]),i.state.push(["rpe",0]),i.dis||(i.dis=[]),i.dis.push("7265706f72745368656574"),this.parent&&t&&t(this,i.dis,"ad")):-1===r&&(i.wm=i.wm||[],(f=c&&c(r,e,!1))&&i.wm.push(f),i.nwm=!0)},init:function(){(0,e.registerCommands)(this.commandManager())},createSheetTab:function(t){var n=this.ls,i,r=["e","p"];n&&0===n["r"+r[1]+r[0]]&&(n.hl||!n.b)||t.type!==v.SheetType.reportSheet||(t.name||(t.name=(0,M.HTi)(this)),t.sheetTab=new p.ReportSheet(t.name))},afterContextMenuInsertSheet:function(t){var t=t.sheetOrSheetTab;t&&t._gi===v.SheetType.reportSheet&&t.renderMode("Design")},createSheet:function(t){var n=this.ls,i,r=["e","p"];n&&0===n["r"+r[1]+r[0]]&&(n.hl||!n.b)||t.type!==v.WorksheetType.reportTemplateSheet||(t.sheet=new I.TemplateSheet(t.name,null))},getAdditionalWorksheetToSJSFormat:function(t){for(var n,i,r,e,o,n,i=0,r=this.mp;i<r.length;i++)(e=r[i])._gi===v.SheetType.reportSheet&&(e.Pvr?t.sheets.push(e.Pvr):(o=void 0,(o=t.fileType===v.OpenSaveFileType.excel?e.getSheet():e.templateSheet)&&t.sheets.push(o)))},getAdditionalSheet:function(t){for(var n,i,r,e,e,n,i=0,r=this.mp;i<r.length;i++)(e=r[i])._gi===v.SheetType.reportSheet&&(e=e.templateSheet)&&t.sheets.push(e)},onCultureChanged:function(){T()},preSave:function(t){var n=t.saveOptions,i=t.workingPromiseArray;(this.mp||[]).forEach(function(t){t instanceof p.ReportSheet&&(null==n?void 0:n.fileType)===v.OpenSaveFileType.excel&&("Preview"===t.options.renderMode||"PaginatedPreview"===t.options.renderMode)&&(t.Pvr=new E.WorkSheetConvertor(t).Tji(n,i))}),(null==n?void 0:n.fileType)===v.OpenSaveFileType.excel&&(this.sheets||[]).forEach(function(t){t.isReportSheetPaginatedWorksheet&&(new A.ShapeGenerator).generate(t,t,i)})},clearSaveWorkbookCache:function(){(this.mp||[]).forEach(function(t){t instanceof p.ReportSheet&&(t.Pvr=void 0)})}}),v.Workbook.ch("printSheet",{createSheetTab:function(t){var n=this.ls,i,r=["e","p"];n&&0===n["r"+r[1]+r[0]]&&(n.hl||!n.b)||t.type!==v.SheetType.printSheet||(t.sheetTab=new o.PrintSheet)}}),v.Y8.ch("reportWorksheet",{isValid:function(t){return this.Mf.isReportWorkSheet},getValue:function(t){var n,i,r,e;this.Mf.isReportWorkSheet&&(n=t.row,i=t.col,r=t.sheetArea,e=this.Mf,r===v.SheetArea.viewport)&&(t.value=e.Bji(n,i),t.isValueGet=!0)},setValue:function(t){var n,i,r,e,o,n=this.Mf;n.isReportWorkSheet&&n.allowEditing&&(i=t.row,r=t.col,e=t.sheetArea,o=t.value,e===v.SheetArea.viewport)&&(n.reportSheet.t4i.uOi(i,r,v.util.V0(o),!0),t.isValueSet=!0)},clear:function(t){var n,i,r,e,t,o,u,s,n=t.row,i=t.col,r=t.rowCount,e=t.colCount,t=t.sheetArea,o=this.Mf;if(t===v.SheetArea.viewport&&o instanceof w.ReportWorksheet)for(u=n;u<n+r;u++)for(s=i;s<i+e;s++)o.reportSheet.t4i.uOi(u,s,null,!0)},getStyle:function(t){var n,i,n,r,e,n,o,n,i,i,i,n;this.Mf.isReportWorkSheet&&(r=t.row,e=t.col,n=t.sheetArea,o=this.Mf,n===v.SheetArea.viewport)&&-1!==r&&-1!==e&&((n=o.Uji(r,e))&&(null!=(i=n.cellButtons)&&i.length&&(n.cellButtons=i.filter(function(t){return"ReportCollapseButtonToggle"!==t.command&&"ReportCollapseButtonToggle-empty"!==t.command})),n.decoration&&n.decoration.icons&&(n.decoration.icons=n.decoration.icons.filter(function(t){return!t.isReport})),(i=new v.Style).h5(n),t.style=i),i=null==(n=null==(i=null==(n=o.reportDataModel)?void 0:n.aOi(r,e))?void 0:i.cellNode)?void 0:n.templateCell,"PaginatedPreview"===(n=o.reportSheet.renderMode())?t.style&&(t.style.cellButtons=void 0,t.style.dropDowns=void 0):"Preview"===n&&i&&i.showCollapseButton&&"No"!==i.expansionDirection&&(t.style||(t.style=new v.Style),1<o.Lir(r,e)?(0,M.XTi)(t.style,o.gOi(r,e)):(0,M.Pir)(t.style)),!i||"Row"!==i.autoFit&&"Column"!==i.autoFit||(t.style||(t.style=new v.Style),t.style.wordWrap=!0),t.isStyleGet=!0)},getSpans:function(t){var n,i,r,e,o,u,s,c,u;this.Mf.isReportWorkSheet&&(n=t.row,i=t.col,r=t.rowCount,e=t.colCount,o=t.isAll,u=t.sheetArea,s=t.spans,c=this.Mf,u===v.SheetArea.viewport)&&(u=void 0,o?u=c.Zji():!(0,M.ht)(n)&&(0,M.ht)(r)?u=[c.VTi(n,i)]:(0,M.ht)(n)||(0,M.ht)(r)||(u=c.Zji(new v.Range(n,i,r,e))),!(0,M.ht)(u)&&0<u.length&&(0,M.pushArrayTo)(u,s),t.isSpansGet=!0)},getSize:function(t){var n,i,r,e;this.Mf.isReportWorkSheet&&(n=t.isRow,i=t.index,r=t.sheetArea,e=this.Mf,r===v.SheetArea.viewport?(t.size=n?e.Vji(i):e.Qji(i),t.isSizeGet=!0):r!==v.SheetArea.colHeader||n?r===v.SheetArea.rowHeader&&n&&(t.size=e.Vji(i),t.isSizeGet=!0):(t.size=e.Qji(i),t.isSizeGet=!0))},getHyperlink:function(t){var n=t.row,i=t.col,r=t.sheetArea,e=this.Mf;r===v.SheetArea.viewport&&e instanceof w.ReportWorksheet&&(t.hyperlink=e.Hji(n,i),t.isLinkGet=!0)},getLastNonNullRowOrCol:function(t){var n=t.sheetArea,i=t.isRow,r=this.Mf;n===v.SheetArea.viewport&&r instanceof w.ReportWorksheet&&(t.index=i?r.QTi():r.YTi(),t.isIndexGet=!0)}}),v.Worksheet.ch("reportWorksheet",{init:function(){var t=this;t instanceof w.ReportWorksheet&&t.initReportCalcSource()},paint:function(){var t,n,t=this;this instanceof w.ReportWorksheet&&"Preview"===this.reportSheet.renderMode()&&(n=t.Uw()).setContext()},applyEditingSetFormula:function(t){var n;t.sheetArea===v.SheetArea.viewport&&this instanceof w.ReportWorksheet&&"Design"!==this.reportSheet.renderMode()&&(t.isAllow=!1)},fromJsonAfterSJSFormula:function(){var n,t,t,i,n=this,t=this.parent;n instanceof I.TemplateSheet&&t&&(t=t.mp)&&(i=t.filter(function(t){return 3===t._gi&&t.getTemplate()===n})[0])&&i.fetchAllTablesAsync().then(function(){i.refresh()})},getActualToSJSFormatSheet:function(t){var n=O(t.sheet);n&&(t.sheet=n.templateSheet)},preProcessKeyDown:function(t){var n,i,i,n,i,n,n=this,i=O(n);i&&"Design"!==i.renderMode()&&(i=t.e,i=(n=n.Qy()).getShortcutKey(i.keyCode,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey),n=n.getCommands(i),t.r=null==n?void 0:n.some(function(t){return"undo"===t.Zc||"redo"===t.Zc}))},getCellActualLockedInfo:function(t){var n,n,i,r,e,n=t.sheetArea;if(n===v.SheetArea.viewport&&this instanceof w.ReportWorksheet&&"Preview"===this.reportSheet.renderMode()&&(n=this.reportSheet.getStyle(t.row,t.col))&&n.cellButtons)for(i=0,r=n.cellButtons;i<r.length;i++)if("ReportCollapseButtonToggle"===(e=r[i]).command)return void(t.isLocked=!1)},getStatusBarSheetSource:function(t){this.isReportWorkSheet&&(t.sheetSource=new N.SheetSource(this))}});var f=[];function h(t){t instanceof I.TemplateSheet&&t.enqueueBuildExpansionInfoCacheMessage()}function l(t,n){t instanceof I.TemplateSheet&&n.sheetArea===v.SheetArea.viewport&&t.buildBreadLineCache()}function u(t,n,i,r){var t,e,o,u,o,s,c,f,f,t,t,f,t=t,e=t.options,o=t.Ut,u=o.getRowCount(r),o=o.getColumnCount(r);return 1===r?((f=t.H3)&&f._dataSource&&(f=t.Ut.q_(!1,3,i),t=e.colHeaderAutoTextIndex,f)&&(0<=t&&n===t||-1===t&&n===u-1)&&(c=f.displayName||f.name),(0,M.ht)(c)&&n===(s=(s=e.colHeaderAutoTextIndex)<0||u<=s?u-1:s)&&(2===(t=e.colHeaderAutoText)?c=v.util.Vf(i+1):1===t&&(c=i+1))):2===r&&(0,M.ht)(c)&&i===(s=(s=e.rowHeaderAutoTextIndex)<0||o<=s?o-1:s)&&(2===(f=e.rowHeaderAutoText)?c=v.util.Vf(n+1):1===f&&(c=n+1)),c}function s(t,n,i,r,e){var o,u,t,s,c,f,o,o=t.getPaginationSetting(),u=t.getRowCount(r),t=t.getColumnCount(r);return o&&(s=o.titleRow,c=o.endRow,f=o.titleCol,o=o.endCol,1===r&&(f||o)&&n===u-1?f&&f.start<=i&&f.end>=i?e+="(HR)":o&&o.start<=i&&o.end>=i&&(e+="(FR)"):2===r&&(s||c)&&i===t-1&&(s&&s.start<=n&&s.end>=n?e+="(H)":c&&c.start<=n&&c.end>=n&&(e+="(F)"))),e}function c(t,n,i,r,e,o){var u,s,c;if(void 0===o&&(o=!1),t&&t.dataCharts)for(o&&(f=[]),u=n;u<=r;u++)for(s=i;s<=e;s++)(c=(0,D.eMr)(t.getTemplateCell(u,s)))&&(o?f.push(c):t.dataCharts.remove(c))}v.Worksheet.ch("templateSheet",{paintCell:function(t){var n,i,r,n,e,t,t,n,o,o,o,n,i=this,r=t.ctx,n=t.sheetArea,e=t.cell,t=t.isPrinting;i instanceof I.TemplateSheet&&!t&&n===v.SheetArea.viewport&&(t=null,o=(n=i.getTemplateCell(e.row,e.col))?(0,C.WTi)(n):"No",n&&"Summary"!==n.type&&("H"===o?t|=d.TemplateCellPaintType.horizontalParent:"V"===o&&(t|=d.TemplateCellPaintType.verticalParent)),n&&n.filter&&n.filter.condition&&(t|=d.TemplateCellPaintType.filter),!(o=n&&n.pin)||"Row"!==o&&"Column"!==o&&"Both"!==o||(t|=d.TemplateCellPaintType.staticPin),n&&"Chart"===n.type&&void 0!==n.dataChartName&&(t|=d.TemplateCellPaintType.DataChartPreview),null!=(n=null==(o=i.getPaginationSetting())?void 0:o.rowPagination)&&n.paginationDataCell&&(n=(0,M.kOi)(o.rowPagination.paginationDataCell))&&n.col===e.col&&n.row===e.row&&(t|=d.TemplateCellPaintType.paginationIcon),t)&&(0,d.FTi)(r,new v.Rect(e.x,e.y,e.width,e.height),t,i.templateOptions,i,e)},paintAdornment:function(t){var r,e,t,n,i,o,u,o,r=this,e=t.ctx,t=t.clipRect;r instanceof I.TemplateSheet&&(n=r.$tr(),i=[],(o=void 0,M.ht)(n.leftParent.row)||(i[0]=r.getCellRect(n.leftParent.row,n.leftParent.col),o=!0),(0,M.ht)(n.upParent.row)||(i[1]=r.getCellRect(n.upParent.row,n.upParent.col),o=!0),u=function(t,n,i){t&&(e.save(),e.rect(t.x,t.y,t.width,t.height),e.clip(),(0,d.JTi)(e,n,r.templateOptions,t.x,t.y,i),e.restore())},o)&&(u((o=(0,M.KTi)(r,n,t))[0],i[0],!0),u(o[1],i[1],!1))},sheetHighlightInvalid:function(t){var n,i=t.sheetArea;this instanceof I.TemplateSheet&&i===v.SheetArea.viewport&&(t.isNeedHighlightInvalid=!1)},adjustCustomNameOnMove:function(t){var n;this instanceof I.TemplateSheet&&(t.needAdjustCustomNameOnMove=!1)},getAllFunctions:function(t){var n,i,r,e,i,o,u,s,n=this,i=n.getParent(),r=i&&i.Amt,e=n.Amt;if(n.isReportTemplateSheet){if(t.funcs=t.funcs.filter(function(t){return!t.isFunc||r&&r[t.name.toUpperCase()]||e&&e[t.name.toUpperCase()]||t.isFunc&&-1<j.reportSupportFunctionNames.indexOf(t.name)}),i=n.getCustomNames())for(o=0,u=i;o<u.length;o++)s=u[o],t.funcs.push({name:s.getName(),description:s.getComment(),isFunc:!1});t.isFuncGet=!0}},onLayoutChanged:function(t){var n,i,r,e,o,n=this;n.isReportTemplateSheet&&(i=t.row,r=t.col,e=t.rowCount,o=t.colCount,"clear"===t.changeType?c(n,i,r,i+e-1,r+o-1):"deletingRows"===t.changeType?c(n,i,0,i+e-1,n.getColumnCount()-1,!0):"deletingColumns"===t.changeType?c(n,0,r,n.getRowCount()-1,r+o-1,!0):"deleteRows"!==t.changeType&&"deleteColumns"!==t.changeType||(n.updateAllAliasInfo(),f.length&&n.dataCharts&&(f.forEach(function(t){return n.dataCharts.remove(t)}),f=[])))},preProcessMouseDown:function(t){var n,t,i,t,r,e,n=this;n.isReportTemplateSheet&&(t=(0,M.oMr)(n,t.e)).result&&(i=t.row,t=t.col,e=!(r=n.getTemplateCell(i,t)).chartPreviewVisible,n.getParent().commandManager().execute({cmd:"ReportChartPreviewVisible",sheetName:n.name(),row:i,col:t,visible:e}))},preProcessMouseDbClick:function(t){var n,n,n=this;n.isReportTemplateSheet&&(n=(0,M.oMr)(n,t.e),t.r=n.result)},preProcessMouseMove:function(t){var n,i,n=this;n.isReportTemplateSheet?(i=(0,M.oMr)(n,t.e),n.uMr={row:i.row,col:i.col},n.sMr&&(n.repaint(n.sMr),n.fg.style.cursor=void 0,n.sMr=void 0),i.result&&(n.repaint(i.cellRect),n.sMr=i.cellRect,n.fg.style.cursor="pointer",t.r=!0)):(n.sMr=void 0,n.uMr=void 0)},onCopyOrMoveRange:function(t){var n,i,r,t,u,n=t.srcSheet,i=t.isMove,r=t.copyToOption,t=t.bindingPathInfos,u=this;!i&&t&&r&v.CopyToOptions.bindingPath&&n.isReportTemplateSheet&&t.forEach(function(t){var n,i,t,r,e,r,o,n=t.r,i=t.c,t=t.value;t&&"Chart"===t.type&&t.dataChartName&&(e=null==(r=u.dataCharts)?void 0:r.get(t.dataChartName))&&(r=r.add(e.name(),e.x(),e.y(),e.width(),e.height(),"column"))&&(r.setChartConfig(e.getChartConfig()),o=a(a({},t),{dataChartName:r.name()}),u.setTemplateCell(n,i,o),r.isVisible(!!o.chartPreviewVisible),e.isVisible(!!t.chartPreviewVisible))})}}),v.Y8.ch("templateSheet",{isValid:function(){return this.Mf.isReportTemplateSheet},undoBindingPath:function(t){var n,i,r,t,n=this.Mf,i=t.row,r=t.col,t=t.value;n.isReportTemplateSheet&&n.setTemplateCell(i,r,t)},clear:function(t){var n,i,r,e,o,u,s,c,f,n=this.Mf,i=t.row,r=t.col,e,o,u=i+t.rowCount-1,s=r+t.colCount-1;if(n.isReportTemplateSheet)for(c=i;c<=u;c++)for(f=r;f<=s;f++)n.Ntr(c,f,void 0);h(this.Mf),l(this.Mf,t)},getValue:function(t){var n,i,r,e,o,e,n=t.row,i=t.col,r=t.sheetArea,e=t.valueType,o=this.Mf;r!==v.SheetArea.colHeader&&r!==v.SheetArea.rowHeader||!o.isReportTemplateSheet||(e=this.W_(r).getValue(n,i,e),(0,M.ht)(e)&&(e=u(o,n,i,r)),(0,M.ht)(e)&&(e=""),t.value=s(o,n,i,r,e),t.isValueGet=!0)}}),g.ConditionalFormats.ch("templateSheet",{onRuleAdded:function(){h(this)},onRuleRemoved:function(){h(this)},onRuleUpdated:function(){h(this)}}),v.CellTypes.Base.ch("templateSheet",{beforePaintDecoration:function(t){var n,t,i,r,e,n,r,o,n=t.context,t=t.style,i=n.sheet,r=n.sheetArea,e=n.row,n=n.col;i.isReportTemplateSheet&&r===v.SheetArea.viewport&&t&&(r=i.getTemplateCell(e,n),o=(0,M.getTemplateIcon)(i,r,t))&&((0,M.Iir)(e,n,i,r,t)&&(t.textIndent=t.textIndent||1),t.decoration?t.decoration.icons||(t.decoration.icons=[]):t.decoration={icons:[]},t.decoration.icons=t.decoration.icons.filter(function(t){return!t.isReport}),t.decoration.icons.push(o))},beforePaintCellContent:function(t){var n,t,i,r,e,n,r,i,n=t.context,t=t.style,i=n.sheet,r=n.sheetArea,e=n.row,n=n.col;i.isReportTemplateSheet&&r===v.SheetArea.viewport&&t&&(r=i.getTemplateCell(e,n),null!=(i=t.cellButtons)&&i.length&&(t.cellButtons=i.filter(function(t){return"ReportCollapseButtonToggle"!==t.command})),r)&&r.showCollapseButton&&"None"!==r.spillDirection&&(0,M.XTi)(t,!1)}}),g.Condition.ch("reportWorksheet",{initConditionExpression:function(t){var n,i,r,t,n,i=t.expr,r=t.baseRow,t=t.baseCol;this.isReportWorkSheet&&(0,M.mir)(i,r,t)}}),null!=r&&r.DataChart.ch("reportWorksheet",{afterSetConfig:function(t){var n,i,r,e,r,i,r,i,i,r,n=this,e=this.sheet();e instanceof I.TemplateSheet&&(e.cMr().Hfr(this),0<(null==(i=null==(r=this.getChartConfig())?void 0:r.plots)?void 0:i.length))&&null!=(r=(i=r.plots[0]).config)&&r.updateAnimation&&(r=(null!=(i=(r=i.config.updateAnimation).startDelay)?i:0)+(null!=(i=r.duration)?i:0)+100,this.rzr&&clearTimeout(this.rzr),this.rzr=setTimeout(function(){n.rzr=void 0,e.repaint()},r))}}),(0,b.dwr)()}a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.registerFeatures=void 0,v=i("Core"),r=i("DataChart"),e=i("./dist/plugins/report/commands/index.js"),o=i("./dist/plugins/report/print/print-sheet.js"),d=i("./dist/plugins/report/render/paint-template-cell.js"),p=i("./dist/plugins/report/report-sheet.js"),M=i("./dist/plugins/report/utils/utils.js"),w=i("./dist/plugins/report/worksheet/report-worksheet.js"),I=i("./dist/plugins/report/worksheet/template-sheet.js"),g=i("ConditionalFormatting"),C=i("./dist/plugins/report/template/utils.js"),u=i("./dist/plugins/report/resources/index.js"),N=i("SheetsCalc"),j=i("./dist/plugins/report/calc-model/supported-functions.js"),E=i("./dist/plugins/report/convertors/worksheet-convertor.js"),A=i("./dist/plugins/report/convertors/helpers/shape-generator.js"),D=i("./dist/plugins/report/worksheet/utils.js"),b=i("./dist/plugins/report/overrides/container-feature-register.js"),T=u.rm.getResource.bind(u.rm),n.registerFeatures=s},"./dist/plugins/report/overrides/sheet-override.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sur=n.G_i=n.L_i=void 0;var c=i("Core");function r(t,n){t.TF=function(){return n},t.hP=function(){return!t.parent||t.parent.getActiveSheetTab()===n}}function e(t,n){t.printInfo=function(){return n.printInfo.apply(n,arguments)}}function o(t){var s=t.isEditingValueChanged;t.isEditingValueChanged=function(t,n,i){var r,e,o,u,r,r=i.sheet,e=i.row,o=i.col,u=i.sheetArea||c.SheetArea.viewport,r=r&&r.getValue(e,o,u,c.ValueType.richText);return(!r||"SparklineExValue"!==r.typeName)&&s(t,n,i)}}n.L_i=r,n.G_i=e,n.sur=o},"./dist/plugins/report/print/print-sheet.js":function(t,n,i){"use strict";var r,u,i,e,o,s;function c(t,n,i,r){var e,o,e=s.call(this)||this,o=e;return o._gi=u.SheetType.printSheet,o.Mf=t||new u.Worksheet("s".concat(Math.random().toString().substring(1).replace(".","")).concat((new Date).getTime())),e.$Ti(),e.reportSheetName=n,e.reportPageIndex=i,e.E0i=r,e}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.PrintSheet=void 0,u=i("Core"),i=i("./dist/plugins/report/base/sheet-tab-base.js"),s=i.SheetTabBase,r(c,s),c.prototype.toJSON=function(t){return{sheet:this.Mf.toJSON(t),sheetType:this._gi,reportSheetName:this.reportSheetName,reportPageIndex:this.reportPageIndex,order:this.E0i,name:this.Mf.name()}},c.prototype.fromJSON=function(t,n,i,r,e){this.reportSheetName=t.reportSheetName,this.reportPageIndex=t.reportPageIndex,this.E0i=t.order,t.sheet&&(this.Mf.fromJSON(t.sheet),this.$Ti())},c.prototype.$Ti=function(){this.Mf.isReportPrintWorkSheet=!0},n.PrintSheet=c},"./dist/plugins/report/render/paint-container-range.js":function(t,n,i){"use strict";var r,i,e,d,p;function o(t,n,i,r,e){var o,u,s,c,n,f,h,l,a,v,r;for(t.save(),o="rgb(150, 150, 150)",u=n.x,s=n.y,c=n.width,n=n.height,t.textAlign="center",t.textBaseline="middle",t.fillStyle=r,t.lineWidth=2,t.beginPath(),t.strokeStyle="rgb(0, 0, 208)",t.moveTo(u,s),t.lineTo(u+c,s),t.lineTo(u+c,s+n),t.lineTo(u,s+n),t.lineTo(u,s),t.stroke(),t.closePath(),f=p()[i],l=c-20,a=n-4,t.font=(h=["12px Calibri","16px Calibri","20px Calibri","24px Calibri"])[v=3],1===i&&(r=a,a=l,l=r);-1<v&&(d(f,h[v])>a||t.measureText(f).width>l);)t.font=h[--v];t.fillStyle=o,e&&(1===i?(t.translate(u+c/2,s+n/2),t.rotate(Math.PI/2),t.translate(-u-c/2,-s-n/2),t.fillText(f,u+c/2,s+n/2,n-20)):t.fillText(f,u+c/2,s+n/2,c-20)),t.restore()}Object.defineProperty(n,"__esModule",{value:!0}),n.hwr=void 0,r=i("Core"),i=i("./dist/plugins/report/resources/index.js"),e=i.rm.getResource.bind(i.rm),d=r.mt.bi,p=function(){return[e().dropFieldsIntoColumn,e().dropFieldsIntoRow,e().dropFieldsIntoValue]},n.hwr=o},"./dist/plugins/report/render/paint-template-cell.js":function(t,n){"use strict";var h,u,o,e,s,l,c,f,i;function r(t,n,i,r,e,o){var u=n.x,s=n.y,c=n.width,f=n.height;c<=0||f<=0||(t.save(),t.rect(u,s,c,f),t.clip(),v(t,u,s,i,r.expansionDirectionArrowColor),d(t,u,s,i,r.expansionDirectionArrowColor),b(t,n,i,e),D(t,n,i,e),j(t,n,i,e),E(t,u,s,c,f,e,o),t.restore())}function a(t,n,i,r,e,o){var i,u,s,c,f;t.save(),i=i.parentArrowColor||"rgba(21,101,192,0.8)",o?(u=n.x,s=n.y,c=n.width,f=n.height,c&&f&&(t.rect(u-2,s-2,c+3,f+3),g(t,u,s,c,f,i,r))):(u=n.x,s=n.y,c=n.width,f=n.height,c&&f&&(t.rect(u-2,s-2,c+3,f+3),t.clip(),I(t,u,s,c,f,i,e))),t.restore()}function v(t,n,i,r,e){r&o.horizontalParent&&(M(t,n,i,e),w(t,n+1,i+3,n+9,i+3,e))}function d(t,n,i,r,e){r&o.verticalParent&&(p(t,n,i,e),w(t,n+3,i+1,n+3,i+9,e))}function p(t,n,i,r){t.beginPath(),t.fillStyle=r||"#FFEA37",t.fillRect(n,i,7,11),t.closePath()}function M(t,n,i,r){t.beginPath(),t.fillStyle=r||"#FFEA37",t.fillRect(n,i,11,7),t.closePath()}function w(t,n,i,r,e,o){var u,s,c,f,u=4,s,c,f=Math.atan2(e-i,r-n);t.beginPath(),t.strokeStyle=o||h,t.moveTo(n,i),t.lineTo(r,e),t.lineTo(r-4*Math.cos(f-Math.PI/6),e-4*Math.sin(f-Math.PI/6)),t.moveTo(r,e),t.lineTo(r-4*Math.cos(f+Math.PI/6),e-4*Math.sin(f+Math.PI/6)),t.stroke(),t.closePath()}function I(t,n,i,r,e,o,u){t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.rect(n-1,i-1,r+1,e+1),t.stroke(),t.closePath(),t.restore(),t.save(),t.fillStyle=o,6+u<i?(t.clearRect(n-2,i-10,r+3,10),t.fillRect(n-2,i-10,r+3,10),N(t,n-2,i-9,r+3,"white")):(t.clearRect(n-2,i,r+3,10),t.fillRect(n-2,i,r+3,10),N(t,n-2,i,r+3,"white"))}function g(t,n,i,r,e,o,u){t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.rect(n-1,i-1,r+1,e+1),t.stroke(),t.closePath(),t.fillStyle=o,6+u<n?(t.clearRect(n-10,i-2,10,e+3),t.beginPath(),t.fillRect(n-10,i-2,10,e+3),C(t,n-9,i-2,e+3,"white")):(t.clearRect(n,i-2,10,e+3),t.fillRect(n,i-2,10,e+3),C(t,n,i-2,e+3,"white"))}function C(t,n,i,r,e){var o;t.beginPath(),i=Math.floor(i+r/2)-6,t.fillStyle=e||u,t.moveTo(n+3,i-2),t.lineTo(n+3,i+10),t.lineTo(n+1,i+10),t.lineTo(n+4,i+18),t.lineTo(n+7,i+10),t.lineTo(n+5,i+10),t.lineTo(n+5,i-2),t.fill()}function N(t,n,i,r,e){var o;t.beginPath(),n=Math.floor(n+r/2)-6,t.fillStyle=e||u,t.moveTo(n-2,i+3),t.lineTo(n+10,i+3),t.lineTo(n+10,i+1),t.lineTo(n+18,i+4),t.lineTo(n+10,i+7),t.lineTo(n+10,i+5),t.lineTo(n-2,i+5),t.fill(),t.closePath()}function j(t,n,i,r){i&o.paginationIcon&&(t.beginPath(),t.fillStyle="#4FC3F7",t.fillRect(n.x,n.y+n.height-7,6,6))}function E(t,n,i,r,e,o,u){var s,s,s,c,f,c,s,h,s=u.row,c=u.col,f=o.getTemplateCell(s,c);f&&"Chart"===f.type&&void 0!==f.dataChartName&&(c=null==(s=o.dataCharts)?void 0:s.all().find(function(t){return t.name()===f.dataChartName}))&&null!=(s=null==c?void 0:c.ctV)&&s.Qje&&(h=(s=c.ctV).Qje.getContext("2d"),s.r5e(h,s.width,s.height,function(){}),s.c5e(s.width,s.height,h.getTransform()),t.drawImage(c.ctV.Qje,n,i,r,e),A(t,n,i,r,e,o,u))}function A(t,n,i,r,e,o,u){var s,c,i,e,s,f,n,r,s=o.BO();t.save(),t.beginPath(),i=i+e-(c=18),s.getImage(l)||s.addImage(l,"anonymous"),s.getState(l)&&s.qh(l)&&(e=s.getImage(l),s=n+r-18,f=2,n=o.uMr,r=o.getTemplateCell(u.row,u.col),t.fillStyle="white",t.fillRect(s-2,i-2,18,18),(n&&n.row===u.row&&n.col===u.col||null!=r&&r.chartPreviewVisible)&&(t.fillStyle="rgb(225, 225, 225)",t.fillRect(s-4,i-4,22,22)),t.drawImage(e,s-2,i-2,18,18)),t.restore()}function D(t,n,i,r){i&o.staticPin&&(t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(n.x+8,n.y),t.lineTo(n.x+8,n.y+10),t.lineTo(n.x,n.y+10),t.fillStyle="white",t.fill(),t.closePath(),f?t.drawImage(f,n.x+1,n.y+1):((f=new Image).src=s,f.onload=function(){r.repaint()}))}function b(t,n,i,r){i&o.filter&&(t.beginPath(),t.moveTo(n.x+n.width-9,n.y),t.lineTo(n.x+n.width,n.y),t.lineTo(n.x+n.width,n.y+9),t.lineTo(n.x+n.width-9,n.y+9),t.fillStyle="white",t.fill(),t.closePath(),c?t.drawImage(c,n.x+n.width-8,n.y+1):((c=new Image).src=e,c.onload=function(){r.repaint()}))}Object.defineProperty(n,"__esModule",{value:!0}),n.JTi=n.FTi=n.TemplateCellPaintType=void 0,h="rgb(94, 94, 94)",u="rgb(34, 115, 71)",(i=o=n.TemplateCellPaintType||(n.TemplateCellPaintType={}))[i.horizontalParent=1]="horizontalParent",i[i.verticalParent=2]="verticalParent",i[i.filter=4]="filter",i[i.staticPin=8]="staticPin",i[i.paginationIcon=16]="paginationIcon",i[i.DataChartPreview=32]="DataChartPreview",e="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iN3B4IiBoZWlnaHQ9IjdweCIgdmlld0JveD0iMCAwIDUgNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDx0aXRsZT5maWx0ZXI8L3RpdGxlPgogICAgPGcgaWQ9ImZpbHRlciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTMuMTI0ODk2NjksMi40OTk2NTI4MyBMMy4xMjQ4OTY2OSw0LjY4ODIzNzc0IEMzLjEzNzM5NDYzLDQuNzcxNTU5NTEgMy4xMDYxNDk3OSw0Ljg2MDQzNjA1IDMuMDM0Mjg2NjcsNC45MTg3NjEyOCBDMi45MTI0MzE4Miw1LjAyNzA3OTU3IDIuNzE1NTg5MzYsNS4wMjcwNzk1NyAyLjU5MzczNDUsNC45MTg3NjEyOCBMMS45NjU3MTMzMyw0LjM2MDUwNTQ5IEMxLjg5Mzg1MDIxLDQuMjk2NjI1NDcgMS44NjI2MDUzNyw0LjIxMDUyNjMyIDEuODc1MTAzMzEsNC4xMjk5ODE5NSBMMS44NzUxMDMzMSwyLjQ5OTY1MjgzIEwxLjg2NTcyOTg2LDIuNDk5NjUyODMgTDAuMDY2MDI3MzgyLDAuNDQ5OTM3NTA5IEMtMC4wNDAyMDUwNTU4LDAuMzMwNTA5NjUxIC0wLjAxNTIwOTE4OCwwLjE1NTUzMzk1NCAwLjExOTE0MzYwMSwwLjA2MTEwMjYyNDYgQzAuMTc4NTA4Nzg3LDAuMDIyMjE5MTM2MiAwLjI0NDEyMjkzOSwwIDAuMzEyODYxNTc2LDAgTDAuMzEyODYxNTc2LDAgTDQuNjg3MTM4NDIsMCBMNC42ODcxMzg0MiwwIEM0Ljc1NTg3NzA2LDAgNC44MjE0OTEyMSwwLjAyMjIxOTEzNjIgNC44ODA4NTY0LDAuMDYxMTAyNjI0NiBDNS4wMTUyMDkxOSwwLjE1NTUzMzk1NCA1LjA0MDIwNTA2LDAuMzMwNTA5NjUxIDQuOTMzOTcyNjIsMC40NDk5Mzc1MDkgTDMuMTM0MjcwMTQsMi40OTk2NTI4MyBMMy4xMjQ4OTY2OSwyLjQ5OTY1MjgzIFoiIGlkPSLot6/lvoQiIGZpbGw9InJnYigyMSwxMDEsMTkyKSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==",s="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjlweCIgdmlld0JveD0iMCAwIDQgNyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDx0aXRsZT5waW4yPC90aXRsZT4KICAgIDxnIGlkPSJwaW4yIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMS41MTI3ODg5LDQuNjE5MjM3NzIgTDIuNDgxOTc3OTQsNC42Mzg5ODA2OSBMMi40ODQ1NTYzLDUuOTU0NDg1NzUgQzIuNDg1ODc3OSw2LjA4NDA4MzI3IDIuNDU5NzU0MSw2LjIxMjQ4NTY0IDIuNDA3NzczNTYsNi4zMzE4ODQzNCBMMi4xNTI1NjU2NSw2LjkwMzM3OTE3IEMyLjEyNjQ4MTY4LDYuOTYyMTEyNzQgMi4wNjY0MTYyMyw3LjAwMDEyMDE1IDEuOTk5ODcwMjQsNyBDMS45MzMzMjQyNSw2Ljk5OTg3OTI4IDEuODczMTA5MzksNi45NjE2NTQyIDEuODQ2Nzk0OTksNi45MDI4MjU3OSBMMS41OTM4Nzg1Miw2LjMxNjgwNDM0IEMxLjU0MTU2NTI0LDYuMTk3MTc3MTMgMS41MTQ5NDM1Miw2LjA2ODcwNjMgMS41MTU2MTU4Niw1LjkzOTEyNTE2IEwxLjUxMjc4ODksNC42MTkyMzc3MiBaIE0wLjcyNTY1OTk4NywwLjE0ODA2OTkyMiBDMC43ODY2MjEzNjUsMC4wNTU0Mzg4NDk5IDAuODkyOTA4MjgxLC0wLjAwMDQ2NzM0NjgyNCAxLjAwNzE1OTc4LDAgTDIuOTgzMzg4NjYsMC4wMDM1Nzk0NjQ4NSBDMy4xMDE3Nzg0OCwtMC4wMDA5NzA2MzAxMDkgMy4yMTQwMTY5OSwwLjA1NTIzMjgzNTYgMy4yNzgxODM4MSwwLjE1MTE5ODIxNiBDMy4zNDIzNTA2MiwwLjI0NzE2MzU5NyAzLjM0ODc5NTgxLDAuMzY4NDU4ODQ2IDMuMjk1MTEyMTQsMC40Njk3ODA5NCBMMy4wNzcwODg3OCwwLjkxMDM0NjUzIEMzLjAxNDkzMTYsMS4wMzUyMzQyNSAyLjk5NzIwODA3LDEuMTc2NTc2OTYgMy4wMjYwMzUzMSwxLjMxMjQ2ODg0IEwzLjI4MDE2NTkyLDIuNTE3OTU4NSBDMy4zMTc3MzgzMywyLjcwNzM3MTg0IDMuNDE0MDgyNSwyLjg4MTQzOTQ4IDMuNTU2MTk0NTksMy4wMTc5OTc2NCBMMy45MDcyNjY3NywzLjM1NTM0OTQ1IEMzLjk3MDI5OTU1LDMuNDE1MTc2NDkgNC4wMDYwNDA4NiwzLjQ5NjU2OTc0IDQuMDA2NTkzMiwzLjU4MTU0NDM1IEw0LjAwNDU2MTA2LDMuNzY5MjcxNjIgQzQuMDA0Mzg3NjUsMy45NDUwOTMwNCAzLjg1NjQ2NjQyLDQuMDg3MjMzMzEgMy42NzM0OTQyLDQuMDg3Mzk5OTUgTDAuMzQ5MzczODEsNC4wNzkwNzc3OCBDMC4xNjYzOTk2NDQsNC4wNzgyNDg4NiAwLjAxNzkyMDE3NjcsMy45MzU1NzIxNyAwLjAxNzA1NzU0NzcsMy43NTk3NDg4OCBMMC4wMDczMTYxNjM2MiwzLjU2NTMxMjEgQzAuMDA3NTM1NDExNTYsMy40ODAzMzg4OCAwLjA0Mjk1NzkxMTcsMy4zOTkwNzQ0MiAwLjEwNTc1NjYyNSwzLjMzOTQ3NTExIEwwLjQ1NTUwODg4MiwzLjAwMzM5MTYzIEMwLjU5Njk0ODE5OCwyLjg2NzM4MTk3IDAuNjkyNDMzMzMyLDIuNjkzNTE3MDYgMC43Mjk1NzkzODIsMi41MDQzNDgwNCBMMC45Nzg3NDY3NjYsMS4yOTk5OTk4NyBDMS4wMDcyODEwNywxLjE2Mzk4MTE3IDAuOTg4NzYzNzk5LDEuMDIyODAzNSAwLjkyNjM1NjE4MiwwLjg5NzQ1OTcxNyBMMC43MDY4NDQ3MzksMC40NTYzMzI5MTcgQzAuNjU3NTk0NDY3LDAuMzU3MDkyOTkzIDAuNjY0Njk4NjEsMC4yNDA3MDA5OTQgMC43MjU2NTk5ODcsMC4xNDgwNjk5MjIgWiIgaWQ9IuW9oueKtiIgZmlsbD0icmdiKDIxLDEwMSwxOTIpIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",l="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgdmlld0JveD0iMCAwIDE2IDE2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNiAoNjc0OTEpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPg0KICAgIDx0aXRsZT5maW5kMjwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGcgaWQ9ImZpbmQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS4wMDAwMDAsIDEuMDAwMDAwKSIgZmlsbD0iIzY2NiIgZmlsbC1ydWxlPSJub256ZXJvIiBpZD0i5b2i54q2Ij4NCiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy44MjE4NDM4LDEzLjExNDM5MTEgQzE0LjA0MDk4NCwxMy4zMzM1MzEzIDE0LjA1OTk5NjIsMTMuNjY5MjQ2MiAxMy44NjQ4NzEzLDEzLjg2NDg3MTMgQzEzLjY2OTI0NjIsMTQuMDYwNDk2NSAxMy4zMzM1MzEzLDE0LjA0MTQ4NDMgMTMuMTE0MzkxMSwxMy44MjIzNDQxIEw5Ljg3ODMyMDU2LDEwLjU4NjI3MzUgQzguODMyNjUxNSwxMS40NzEzMzk4IDcuNDgxNzg3MTYsMTIuMDA3NjgzIDYuMDAzODQxNTEsMTIuMDA3NjgzIEMyLjY4ODIyMDA0LDEyLjAwNzY4MyAtNC43OTYxNjM0N2UtMTQsOS4zMTk0NjI5OCAtNC43OTYxNjM0N2UtMTQsNi4wMDM4NDE1MSBDLTQuNzk2MTYzNDdlLTE0LDIuNjg4MjIwMDQgMi42ODgyMjAwNCwwIDYuMDAzODQxNTEsMCBDOS4zMTk0NjI5OCwwIDEyLjAwNzY4MywyLjY4ODIyMDA0IDEyLjAwNzY4Myw2LjAwMzg0MTUxIEMxMi4wMDc2ODMsNy40ODE3ODcxNiAxMS40NzEzMzk4LDguODMyNjUxNSAxMC41ODU3NzMyLDkuODc4MzIwNTYgTDEzLjgyMTg0MzgsMTMuMTE0MzkxMSBaIE02LjAwMzg0MTUxLDExLjAwNzA0MjggQzguNzY3MTA5NTYsMTEuMDA3MDQyOCAxMS4wMDcwNDI4LDguNzY3MTA5NTYgMTEuMDA3MDQyOCw2LjAwMzg0MTUxIEMxMS4wMDcwNDI4LDMuMjQwNTczNDUgOC43NjcxMDk1NiwxLjAwMDY0MDI1IDYuMDAzODQxNTEsMS4wMDA2NDAyNSBDMy4yNDA1NzM0NSwxLjAwMDY0MDI1IDEuMDAwNjQwMjUsMy4yNDA1NzM0NSAxLjAwMDY0MDI1LDYuMDAzODQxNTEgQzEuMDAwNjQwMjUsOC43NjcxMDk1NiAzLjI0MDU3MzQ1LDExLjAwNzA0MjggNi4wMDM4NDE1MSwxMS4wMDcwNDI4IFoiPjwvcGF0aD4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg==",n.FTi=r,n.JTi=a},"./dist/plugins/report/report-all-entry.js":function(t,n,i){(r=r||{}).Report=i("./node_modules_local/@spreadjs/js-report/dist/gc.report.js"),r.Spread=r.Spread||{},r.Spread.Report=i("./dist/plugins/report/index.js"),t.exports=r.Spread.Report},"./dist/plugins/report/report-sheet.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f,h,l,a,v,d,p,M,w,I,g,C,N,j,E,A;function D(t){var n,i,t,n=A.call(this)||this;return n.qTi="Preview",n.yir=!1,n.canClone=!0,(i=n)._gi=u.SheetType.reportSheet,i.t4i=new h.DataEntryHelper(i),i.n4i=new v.ReportJSONConvertor(i),i.options={renderMode:i.qTi,printAllPages:!0,dirtyStyle:(0,s.i4i)()},t=t||(0,s.r4i)(),i.templateSheet=new d.TemplateSheet(t,n),(0,c.L_i)(i.templateSheet,i),i.reportWorksheet=i.e4i(t),i.Mf=i.reportWorksheet,i.printPageIndexArray=[],i.o1e={},i.regenerateReport(),n}r=this&&this.__extends||(E=function(t,n){return(E=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}E(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),e=this&&this.__awaiter||function(t,u,i,s){function c(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i=i||Promise)(function(n,i){function r(t){try{o(s.next(t))}catch(t){i(t)}}function e(t){try{o(s.throw(t))}catch(t){i(t)}}function o(t){t.done?n(t.value):c(t.value).then(r,e)}o((s=s.apply(t,u||[])).next())})},o=this&&this.__generator||function(t,i){var r={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},e,o,u,s,s={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function n(n){return function(t){return c([n,t])}}function c(n){if(e)throw new TypeError("Generator is already executing.");for(;r=s&&n[s=0]?0:r;)try{if(e=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,o=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(u=0<(u=r.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))r.label=n[1];else if(6===n[0]&&r.label<u[1])r.label=u[1],u=n;else{if(!(u&&r.label<u[2])){u[2]&&r.ops.pop(),r.trys.pop();continue}r.label=u[2],r.ops.push(n)}}n=i.call(t,r)}catch(t){n=[6,t],o=0}finally{e=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportSheet=void 0,u=i("Core"),s=i("./dist/plugins/report/utils/utils.js"),c=i("./dist/plugins/report/overrides/sheet-override.js"),f=i("./dist/plugins/report/worksheet/report-worksheet.js"),h=i("./dist/plugins/report/helpers/data-entry-helper.js"),l=i("./dist/plugins/report/overrides/feature-register.js"),a=i("./dist/plugins/report/base/sheet-tab-base.js"),v=i("./dist/plugins/report/convertors/report-json-convertor.js"),d=i("./dist/plugins/report/worksheet/template-sheet.js"),p=i("./dist/plugins/report/helpers/parameter-helper.js"),M=i("./dist/plugins/report/resources/index.js"),w=i("./dist/plugins/report/worksheet/utils.js"),I=u.GC$,g=M.rm.getResource.bind(M.rm),C=u.util.Z0,N=u.util.V0,(0,l.registerFeatures)(),A=a.SheetTabBase,r(D,A),D.prototype.getAllParameters=function(){var n=this.parameter();return n?Object.keys(n).map(function(t){return{name:t,value:n[t]}}):[]},D.prototype.pM=function(t){A.prototype.pM.call(this,t),this.templateSheet&&this.templateSheet!==this.Mf&&(this.templateSheet.parent=t)},D.prototype.adrs=function(){var t,n,t=this.name(),n=this.getParent();n&&(n.suspendPaint(),n.suspendEvent(),n.g3(n.getSheetTabIndex(t),2),n.setActiveSheetIndex(0),n.resumeEvent(),n.resumePaint())},D.prototype.e4i=function(t){var n,t,n=this,t=new f.ReportWorksheet(t,n);return t.parent=n.getParent(),(0,c.L_i)(t,n),t},D.prototype.renderMode=function(t){var n;return(t=this.o4i(t))&&t!==this.options.renderMode&&(n=this.options.renderMode,"Design"===(this.options.renderMode=t)?(this.u4i(this.templateSheet,this.reportWorksheet),(0,w.wir)(this.reportWorksheet,this.getParent(),this.name()),this.yir&&(this.yir=!1,this.fetchAllTablesAsync(!0))):this.regenerateReport(),this.ki(u.Events.ReportSheetModeChanged,{oldMode:n,newMode:t})),this.options.renderMode},D.prototype.o4i=function(n){var t,i;return n&&((i=(t=["Preview","PaginatedPreview","Design"]).find(function(t){return t.toUpperCase()===n.toUpperCase()}))||this.options.renderMode)},D.prototype.u4i=function(t,n){var i,r;t.name(this.name()),(i=this.getParent())&&this.Mf!==t&&(I[I.sd]({jS:i},1),t.parent=i,t.suspendPaint(),r=this.b2(),null!=n&&n.destroy(),this.Mf.fAn(!1,void 0,!0),this.Mf=t,this.Mf===this.templateSheet?this.s4i||(this.v3(this.Mf),this.s4i=!0):this.v3(this.Mf),i.getActiveSheetTab()===this?(i.c3=void 0,i.jb=-1,i.setActiveSheetTab(this.name())):this.Mf.isSelected(r),t.resumePaint())},D.prototype.c4i=function(t){var n=this.reportWorksheet;return this.reportWorksheet=t,n&&((0,w.wir)(n,this.getParent(),this.name()),n.bC()),n},D.prototype.getPagesCount=function(){return"PaginatedPreview"===this.options.renderMode?this.reportWorksheet.getPagesCount():1},D.prototype.currentPage=function(t){var n,i,t,r,t,t,e;return"PaginatedPreview"===this.options.renderMode&&this.reportWorksheet?(n=this.reportWorksheet.currentPage(),i=this.reportWorksheet.currentPage(),r=(t=this.reportWorksheet.currentPage(t)).currentPageIndex,t=t.currentPage,n.currentPage!==t&&(this.u4i(t,n.currentPage),t=this.getParent())&&t.ki(u.Events.ReportPaginationPageChanged,e={oldPageIndex:i,currentPageIndex:r}),r):0},D.prototype.generatePageSheets=function(t,n){var i,r,e,o,u,n;return"PaginatedPreview"!==this.options.renderMode?[]:(i=this.getParent(),r=i.getSheetPosition(this.name()),e=i.getSheetCount(),t&&i&&i.suspendPaint(),o=t?function(t){var n=t.name();i.addSheet(e++,t),i.changeSheetPosition(n,++r),void 0===u&&(u=n)}:null,n=this.reportWorksheet.paginationHelper.Gf().zji(n,o,!0),(0,s.hir)(n),t&&i&&(void 0!==u&&i.setActiveSheet(u),i.resumePaint()),n)},D.prototype.printPageIndexes=function(t){return t&&(this.printPageIndexArray=t),this.printPageIndexArray},D.prototype.printInfo=function(t){var n=this.templateSheet,i;return n.printInfo&&(i=n.printInfo.apply(n,arguments)),arguments.length?this:i},D.prototype.updateCellValue=function(t,n,i){this.t4i.uOi(t,n,i)},D.prototype.addRecordAt=function(t,n){this.t4i.sOi(t,n)},D.prototype.deleteRecordAt=function(t,n){this.t4i.cOi(t,n)},D.prototype.resetCellValue=function(t,n){this.t4i.K5i(t,n)},D.prototype.submit=function(){return e(this,void 0,void 0,function(){return o(this,function(t){return[2,this.Xcr()]})})},D.prototype.Xcr=function(i){return e(this,void 0,void 0,function(){var n;return o(this,function(t){switch(t.label){case 0:return[4,this.t4i.o_i(i)];case 1:return n=t.sent(),this.yir=!n.success,[2,n]}})})},D.prototype.isDirty=function(){var t,t;return null==(t=null==(t=this.reportWorksheet)?void 0:t.reportDataModel)?void 0:t.u()},D.prototype.isExpandable=function(t,n){if("Preview"===this.options.renderMode)return this.reportWorksheet.isExpandable(t,n)},D.prototype.setSubmitHandler=function(t,n){this.t4i.xtr(t,n=void 0===n?!1:n)},D.prototype.fetchAllTablesAsync=function(t){return void 0===t&&(t=!1),this.templateSheet.fetchAllTablesAsync(this.getParent(),t)},D.prototype.loadTemplate=function(t){var n,t;t&&((n=this).M5i(t),n.regenerateReport(),t=n.getParent())&&t.undoManager().clear()},D.prototype.M5i=function(t,n,i){var n,r,t;t&&((r=new d.TemplateSheet(this.name(),this)).parent=this.Mf.parent,r.vf=0,t.keepUnknownFormulas=!0,n?r.yh(t,n.sjsCommonInfo,n.openOptions,!0):r.fromJSON(t),t.type===u.WorksheetType.reportTemplateSheet||(null==(n=t.lossless)?void 0:n.type)===u.WorksheetType.reportTemplateSheet||i||(0,s.vir)(r),r.name(this.name()),this.s4i=!1,t=this.templateSheet,(0,w.wir)(t,this.getParent(),this.name()),"Design"===this.options.renderMode?(this.templateSheet=r,this.u4i(r,t)):this.templateSheet=r,(0,c.L_i)(r,this))},D.prototype.getTemplate=function(){return this.templateSheet},D.prototype.regenerateReport=function(){var t,n,i,r,e,o,t=this,n=t.options.renderMode;"Design"===n?(t.templateSheet.Ytr(),t.repaint()):(t.printPageIndexArray=[],(e=(i=t.e4i(t.name())).regenerateReportData(r="PaginatedPreview"===n))&&(o=t.c4i(i),"Preview"===n?t.u4i(i,o):r&&t.u4i(i.currentPage(0).currentPage,o)))},D.prototype.refresh=function(){"Design"===this.renderMode()?(this.templateSheet.Ytr(),this.repaint()):this.regenerateReport()},D.prototype.repaint=function(){var t,n,t,n=this.Mf;n&&n.hP()&&n.repaint()},D.prototype.getRange=function(){var t=this;return t.f4i()?t.reportWorksheet.Gji():new u.Range(0,0,t.Mf.getRowCount(),t.Mf.getColumnCount())},D.prototype.getValue=function(t,n){return this.Mf.getValue(t,n)},D.prototype.getTemplateCell=function(t,n){var i,t,i;return"Design"===this.renderMode()?this.templateSheet.getTemplateCell(t,n):(t=this.reportWorksheet.fnr(t,n))?this.templateSheet.getTemplateCell(t.templateCell.row,t.templateCell.col):null},D.prototype.getCells=function(t,n,i,r){var e=this;return e.f4i()&&e.reportWorksheet?e.reportWorksheet.getCells(t,n,i,r):[]},D.prototype.getStyle=function(t,n){return this.Mf.getStyle(t,n)},D.prototype.getActualStyle=function(t,n){return this.Mf.getActualStyle(t,n)},D.prototype.getSpan=function(t,n){return this.Mf.getSpan(t,n)},D.prototype.getColumnWidth=function(t){return+this.Mf.getColumnWidth(t)},D.prototype.getRowHeight=function(t){return+this.Mf.getRowHeight(t)},D.prototype.parameter=function(t){var n,i,r,e,o,u,s,n=this;if(0===arguments.length){for(e in r={},i=n.o1e)i.hasOwnProperty(e)&&(r[e]=N(i[e]));return r}if(t){for(e in o={},u={},t)if(t.hasOwnProperty(e)){if(o[e]=C(t[e]),u[s=e.toUpperCase()])throw new Error(g().Exp_InvalidParameterName);u[s]=!0}n.o1e=o,this.templateSheet.fMr()}},D.prototype.setParametersUI=function(t,n,i){var r=this;(t="string"==typeof t?document.getElementById(t):t)&&(r.h4i&&r.h4i.Ti!==t&&r.h4i.L0(!0),r.h4i=new p.ParameterHelper(r,{host:t,initParametersUI:n,onChange:i}),r.h4i.Y_i())},D.prototype.f4i=function(){return"Preview"===this.options.renderMode},D.prototype.toggleCollapseState=function(t,n,i,r){this.f4i()&&this.reportWorksheet.Oji(t,n,i,r)},D.prototype.getCollapseState=function(t,n){if(this.f4i())return this.reportWorksheet.gOi(t,n)},D.prototype.getChanges=function(){var t,i;return"Preview"===this.renderMode()?(t=this.reportWorksheet.reportDataModel.fOi(),i=this.templateSheet.getDataEntrySetting(),t.map(function(t,n){return{records:t.records,deleteRecords:t.deletedRecords,rule:i[n]}})):[]},D.prototype.bind=function(t,n,i){A.prototype.bind.call(this,t,n,i)},D.prototype.unbind=function(t,n){A.prototype.unbind.call(this,t,n)},D.prototype.getCellsLength=function(t,n){return this.reportWorksheet?this.reportWorksheet.getCells(t,n).length:0},D.prototype.e1e=function(){return this.templateSheet.options.sheetTabColor},D.prototype.getSheet=function(){return this.Mf},D.prototype.iir=function(){var t;return null==(t=this.Mf.options)?void 0:t.isProtected},D.prototype.togglePaginatedPreviewCache=function(t){return this.n4i.Eji(t)},D.prototype.internalIsDirtyCell=function(t,n){return this.reportWorksheet.isDirtyCell(t,n)},D.prototype.internalCellIsProtected=function(t,n){var i,i,r,i,i=this,r;return!!i.iir()&&(null==(i=null==(i=i.reportWorksheet)?void 0:i.Uji(t,n))?void 0:i.locked)},D.prototype.internalParameterUI=function(t){if(0===arguments.length)return this.Sji;this.Sji=t},D.prototype.internalCanCollapse=function(t,n){var i,i;return this.f4i()&&(null==(i=this.getTemplateCell(t,n))?void 0:i.showCollapseButton)&&1<(null==(i=this.reportWorksheet)?void 0:i.Lir(t,n))},D.prototype.toWorksheet=function(){var t=this.n4i.workSheetConvertor.Tji();return t.isReportSheetPaginatedWorksheet=!0,t},D.prototype.toJSON=function(t){return this.n4i.Np(t)},D.prototype.wh=function(t,n,i){return this.n4i.wh(t,n,i)},D.prototype.fromJSON=function(t,n,i,r,e){this.n4i.xji(t,n,i,r,e)},D.prototype.yh=function(t,n,i){this.n4i.yh(t,n,i)},D.prototype.L0=function(t,n){var i,r;t&&(r=(i=this).name(),(0,w.wir)(i.reportWorksheet,i.getParent(),r),(0,w.wir)(i.templateSheet,i.getParent(),r),i.reportWorksheet.bC(),i.templateSheet.bC(),i.reportWorksheet.destroy(),i.templateSheet.destroy(),i.h4i&&i.h4i.L0(t,n),i.h4i=void 0,i.n4i=void 0,i.templateSheet=void 0,i.reportWorksheet=void 0,i.printPageIndexArray=void 0,i.Sji=void 0),A.prototype.L0.call(this,t,n)},n.ReportSheet=D},"./dist/plugins/report/resources/index.js":function(t,n,i){"use strict";var r,i;Object.defineProperty(n,"__esModule",{value:!0}),n.rm=void 0,r=i("Common"),i=i("./dist/plugins/report/resources/report.ns.js"),n.rm=new r.Common.ResourceManager(i.SR,"ReportSheet")},"./dist/plugins/report/resources/lr.msc.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.wmk2=n.wmk1=void 0,n.wmk1="5265706f72745368656574",n.wmk2="5265706f72745368656574"},"./dist/plugins/report/resources/report.ns.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var i=i("./dist/plugins/report/resources/res.en.js");n.SR={en:i}},"./dist/plugins/report/resources/res.en.js":function(t,n,i){"use strict";var r,e;for(e in Object.defineProperty(n,"__esModule",{value:!0}),n.dropFieldsIntoValue=n.dropFieldsIntoColumn=n.dropFieldsIntoRow=n.Exp_InvalidPasteRange=n.Exp_InvalidParameterName=n.configDataChart=n.summaryNoneTip=n.summaryCountTip=n.summaryMinTip=n.summaryMaxTip=n.summaryAvgTip=n.summarySumTip=n.summaryCellType=n.groupCellType=n.listCellType=n.toolTipCellType=n.toolTipFormula=n.toolTipColumnName=n.toolTipTableName=n.ContainsInvalidCells=void 0,n.ContainsInvalidCells="Report sheet contains invalid cells({0}), please check.",n.toolTipTableName="Table: ",n.toolTipColumnName="Column: ",n.toolTipFormula="Formula: ",n.toolTipCellType="Type: ",n.listCellType="List",n.groupCellType="Group",n.summaryCellType="Summary",n.summarySumTip="(Sum)",n.summaryAvgTip="(Avg)",n.summaryMaxTip="(Max)",n.summaryMinTip="(Min)",n.summaryCountTip="(Count)",n.summaryNoneTip="(None)",n.configDataChart="Please Config DataChart.",n.Exp_InvalidParameterName="invalid parameter name",n.Exp_InvalidPasteRange="Cannot paste or move data into the container range.",n.dropFieldsIntoRow="Drop Row Fields Here",n.dropFieldsIntoColumn="Drop Column Fields Here",n.dropFieldsIntoValue="Drop Value Fields Here",r=i("./dist/plugins/report/resources/lr.msc.en.js"))r.hasOwnProperty(e)&&(n[e]=r[e])},"./dist/plugins/report/template/template-overwrite.js":function(t,n){"use strict";function i(t){t.getText=function(t,n){var i,r,n,e,o,u,n,i=n.row,r=n.col,n=n.sheet,e=n.getTemplateCell(i,r);return c(e)||"object"!=typeof e||c(o=n.getCellAlias(i,r))?c(u=n.getFormula(i,r))?c(t)&&!c(n=n.getValue(i,r))?n:t:u:s(e,o)}}function s(t,n){return c(n)?null:"Summary"===t.type?(t.aggregate||"Sum")+"("+n+")":n}function c(t){return null==t}Object.defineProperty(n,"__esModule",{value:!0}),n.a4i=void 0,n.a4i=i},"./dist/plugins/report/template/template-resolver.js":function(t,n,i){"use strict";var r,e,v,c,o,u;function s(t,n){var i,n,t,r,e,n,i=this;i.Mf=t,i.mCi=n,i.Xfr=new o.SmartCache,i.ktr=new o.SmartCache,(0,v.ht)(t)||((n=(0,c.v4i)(t))?(i.$fr(n),i.Utr(n),t=n.row,r=n.col,e=n.rowCount,n=n.colCount,i.d4i={row:0,col:0,rowEnd:t+e-1,colEnd:r+n-1}):i.d4i={row:0,col:0,rowEnd:0,colEnd:0})}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTemplateResolver=void 0,e=i("CalcEngine"),v=i("./dist/plugins/report/utils/utils.js"),c=i("./dist/plugins/report/template/utils.js"),o=i("./dist/plugins/report/helpers/smart-cache.js"),s.prototype.getTemplatePaginationSetting=function(){return this.p4i(this.Mf.getPaginationSetting(),this.Mf.printInfo())},s.prototype.getRowHeight=function(t){return+this.Mf.getRowHeight(t)},s.prototype.getColumnWidth=function(t){return+this.Mf.getColumnWidth(t)},s.prototype.evaluateFormula=function(t,n,i){return this.mCi?this.mCi.reportDataModel.aji(t,n,i):i},s.prototype.getCellNamesInFormula=function(t){var t,n,t=this.Mf.Lp.parse(this.Mf.qgt,t,0,0),n=[];return t.forEachNodes(function(t){var t;t.type===e.ExpressionType.reference&&(t=(0,v.e_i)(t.row,t.column),-1===n.indexOf(t))&&n.push(t)}),n},s.prototype.getTemplateRange=function(){return this.d4i},s.prototype.getTemplateCell=function(t,n){var i,r,e,o,u,s,i=this,r=i.Mf,e=r.getTemplateCell(t,n),o=(0,c.w4i)(e||{}),u=r.getSpan(t,n),s=r.getCellType(t,n);return s&&(o.cellType={name:s.typeName,valuePath:s._valuePath}),o.newRecordDefaultValueGenerator=i.g4i(e),o.dataColumn||(o.formula=r.getFormula(t,n)),o.value=o.dataColumn||o.formula?void 0:r.getValue(t,n),o.isEmpty=!(e||null!==o.value||o.dataColumn||o.formula||r.getStyle(t,n)||r.getStyle(-1,n)||r.getStyle(t,-1)||u||o.dataChartName||void 0!==i.Xfr.get(t,n)||void 0!==i.ktr.get(t,n)||i.M4i(t,n)||i.C4i(t,n)),o.isColWidthChanged=+r.getColumnWidth(n)!=+r.defaults.colWidth,o.isRowHeightChanged=+r.getRowHeight(t)!=+r.defaults.rowHeight,!o.isEmpty||o.isColWidthChanged||o.isRowHeightChanged?(o.row=t,o.col=n,(0,v.ht)(u)?(o.rowEnd=t,o.colEnd=n):(o.rowEnd=u.row+u.rowCount-1,o.colEnd=u.col+u.colCount-1),o):null},s.prototype.getTemplateDataCollectionSetting=function(){var i,t,n,i=this,t=this.Mf&&this.Mf.getDataEntrySetting();if(t)return n={dataCollections:t.map(function(t){var n,n;return{type:"Smart",tableName:t.tableName,ignoreContainsEmptyValueRecord:t.skipRecordWithEmptyValue,ignoreNonUpdatedCell:!t.includeUnmodified,allowEmptyKey:null==(n=null==(n=i.mCi)?void 0:n.reportSheet)?void 0:n.t4i._tr(),fields:t.fields.map(function(t){return(0,v.YOi)(t.formula)?{type:"Cell",cellName:t.formula,dbColumnName:t.dbColumnName,isPrimary:t.isPrimary}:r({type:"Formula"},t)})}})}},s.prototype.getTemplateSplitSetting=function(){return this.etr(this.Mf.getLayoutSetting())},s.prototype.g4i=function(t){if(t&&void 0!==t.defaultValue)return function(){return{formula:t.defaultValue}}},s.prototype.M4i=function(t,n){var i,r,i=this.Mf.getDataEntrySetting();return!!i&&(r=(0,v.e_i)(t,n),i.some(function(t){return t.fields.some(function(t){return(0,v.YOi)(t.formula)&&(0,v.FOi)(t.formula)===r})}))},s.prototype.C4i=function(t,n){for(var i,r,e,o,u,i,r,e=0,o=this.Mf.cellStates.all();e<o.length;e++)if((u=o[e]).range.intersect(t,n,1,1))return!0},s.prototype.$fr=function(t){for(var n,i,r,e,o,u,s,n,c,f,h,l,a,l,i=this,r=i.Mf,e={},o=0;o<t.rowCount;o++)for(u=0;u<t.colCount;u++)(s=r.getTemplateCell(o,u))&&"Chart"===s.type&&!(0,v.ht)(s.dataChartName)&&(e[s.dataChartName]=!0);if(n=null==(n=r.dataCharts)?void 0:n.all())for(c=0,f=n;c<f.length;c++)e[(h=f[c]).name()]||(l=h.position(),a=(0,v.y5i)(l.x,l.y,r),l=(0,v.y5i)(l.x+h.width(),l.y+h.height(),r),i.Xfr.set(a.row,a.col,!0),i.Xfr.set(l.row,l.col,!0),t.rowCount=Math.max(t.row+t.rowCount-1,l.row)-t.row+1,t.colCount=Math.max(t.col+t.colCount-1,l.col)-t.col+1)},s.prototype.Utr=function(t){var n,i,r,n,e,o,u,s,c,f,u,h,s,i=this,r=i.Mf,n=null==(n=r.shapes)?void 0:n.all();if(n)for(e=0,o=n;e<o.length;e++)1===(u=o[e]).ttV&&(s=u.x(),c=u.y(),f=u.width(),u=u.height(),h=(0,v.y5i)(s,c,r),s=(0,v.y5i)(s+f,c+u,r),i.ktr.set(h.row,h.col,!0),i.ktr.set(s.row,s.col,!0),t.rowCount=Math.max(t.row+t.rowCount-1,s.row)-t.row+1,t.colCount=Math.max(t.col+t.colCount-1,s.col)-t.col+1)},s.prototype.p4i=function(t,n){var i,r,e,o,i,i=(0,c.m4i)((t=t||{}).titleRow),r=(0,c.m4i)(t.titleCol),e=(0,c.m4i)(t.endRow),o=(0,c.m4i)(t.endCol),i={titleRows:i,endRows:e=i&&e&&e[0]<i[i.length-1]?void 0:e,titleCols:r,endCols:o=r&&o&&o[0]<r[r.length-1]?void 0:o,rowPagination:t.rowPagination,paginationOrder:"OverThenDown"===t.paginationOrder?"ColumnFirst":"RowFirst"};return t.rowPagination||(i.pagePixelSize=(0,c.N4i)(n)),i.rowPagination&&(!i.rowPagination.rowCountPerPage||i.rowPagination.rowCountPerPage<0)&&(i.rowPagination.rowCountPerPage=10),i},s.prototype.etr=function(t){return t?"RowLayout"===t.type?{type:"RowSplit",dataRange:this.Air(t.dataRange),rowCount:t.rowCount,repeatRows:t.repeatRows}:"ColumnLayout"===t.type?{type:"ColumnSplit",dataRange:this.Air(t.dataRange),columnCount:t.columnCount,repeatCols:t.repeatCols}:null:null},s.prototype.Air=function(t){var n,i,n,r,e,r;return!t||2!==(n=t.split(":").map(function(t){return t.trim()}).filter(function(t){return t})).length?"":(i=n[0],n=n[1],r=/^\d+$/,e=this.getTemplateRange(),r.test(i)&&r.test(n)?"".concat((0,v.e_i)(+i-1,e.col),":").concat((0,v.e_i)(+n-1,e.colEnd)):(r=/^[a-zA-Z]+$/).test(i)&&r.test(n)?"".concat(i).concat(e.row+1,":").concat(n).concat(e.rowEnd+1):t)},n.ReportTemplateResolver=s},"./dist/plugins/report/template/utils.js":function(t,n,i){"use strict";var h,l,o,u,a,r;function e(t){var n,n,i,r,i=t.autoExpand,r=t.pin;return{row:void 0,col:void 0,rowEnd:void 0,colEnd:void 0,value:void 0,formula:void 0,cellType:void 0,isEmpty:void 0,isRowHeightChanged:void 0,isColWidthChanged:void 0,newRecordDefaultValueGenerator:void 0,leftParent:(null==(n=null==t?void 0:t.context)?void 0:n.vertical)||"Default",upParent:(null==(n=null==t?void 0:t.context)?void 0:n.horizontal)||"Default",expansionDirection:s(t),dataColumn:c(t),dataSetting:f(t),overwriteWhenExpand:"List"===t.type&&"Overwrite"===t.spillMode,lineBreakOption:t.lineBreakOption,filter:t.filter||{},sorts:t.sortOptions,dataChartName:t.dataChartName,autoFit:t.autoFit||"None",hExpansible:!i||"Both"===i||"Horizontal"===i,vExpansible:!i||"Both"===i||"Vertical"===i,clearRowOffset:"Both"===r||"Row"===r,clearColOffset:"Both"===r||"Column"===r,paginateBeforeRow:!!t.paginateBeforeRow,paginateAfterRow:!!t.paginateAfterRow,paginateBeforeColumn:!!t.paginateBeforeColumn,paginateAfterColumn:!!t.paginateAfterColumn,repeatContentWhenPaging:void 0===t.repeatContentWhenPaging||!!t.repeatContentWhenPaging,canBreakWhenPaging:void 0===t.canBreakWhenPaging||!!t.canBreakWhenPaging,showCollapseButton:!!t.showCollapseButton,initialExpansionState:t.initialExpansionState||"Expanded"}}function s(t){var n,t,t=t;return"SUMMARY"===(null==(n=t.type)?void 0:n.toUpperCase())?"No":r[(t.spillDirection||(t.binding?"VERTICAL":"NONE")).toUpperCase()]}function c(t){var t,t,n,t=t;return!t.binding||1===(n=(t=t.binding.trim()).split("[")).length?null:{tableName:n[0],columnName:t.substring(n[0].length+1,t.length-1)}}function f(t){var n;return t.binding?"List"===t.type?{type:"List"}:"Group"===t.type?{type:"Group",bins:t.bins,formula:t.formula}:{type:"Summary",aggregation:t.aggregate}:null}function v(t){var n,n;return C(t,n=(n=d(t)).union(w(t)).union(I(t)).union(g(t)))}function d(t){var n,i,r,i,e,e,n=t.getUsedRange(o)||new h.Range(0,0,0,0);return-1===n.rowCount||-1===n.colCount?(r=(i=t.getUsedRange(u)||new h.Range(0,0,0,0)).row+i.rowCount-1,i=i.col+i.colCount-1,(e=t.getUsedRange(h.UsedRangeType.rowStyle))&&(r=Math.max(r,e.row+e.rowCount-1)),r=Math.max(r,p(t)),(e=t.getUsedRange(h.UsedRangeType.colStyle))&&(i=Math.max(i,e.col+e.colCount-1)),i=Math.max(i,M(t)),new h.Range(n.row,n.col,r-n.row+1,i-n.col+1)):n}function p(t){var n,n,n,i,r,e,n,o,n=null==(n=t.rowOutlines)?void 0:n.getUsedRange(h.UsedRangeType.axis),n=null==n?void 0:n.maxRow,i=0;if((0,l.ht)(n)||(i=Math.max(i,n)),r=t.Ut.rowInfos[3].infos,0<(n=(e=Object.keys(r)).length))for(o=n-1;0<=o;o--)if(!(0,l.ht)(r[e[o]])){i=Math.max(i,+e[o]);break}return i}function M(t){var n,n,n,i,r,e,n,o,n=null==(n=t.columnOutlines)?void 0:n.getUsedRange(h.UsedRangeType.axis),n=null==n?void 0:n.maxCol,i=0;if(n&&(i=Math.max(i,n)),r=t.Ut.colInfos[3].infos,0<(n=(e=Object.keys(r)).length))for(o=n-1;0<=o;o--)if(!(0,l.ht)(r[e[o]])){i=Math.max(i,+e[o]);break}return i}function w(t){var n,i,t,r,e,o,u,s,c,c,f,c,n=0,i=0,t=t.getDataEntrySetting();if(!(0,l.ht)(t))for(r=0,e=t;r<e.length;r++)for(u=0,s=(o=e[r]).fields;u<s.length;u++)c=s[u],(0,l.YOi)(c.formula)&&(f=(c=(0,l.kOi)(c.formula)).row,c=c.col,n=a(n,f+1),i=a(i,c+1));return new h.Range(0,0,n,i)}function I(t){for(var t,n,i,r,e,t=t.cellStates.all(),n=new h.Range(0,0,0,0),i=0,r=t;i<r.length;i++)e=r[i],n=n.union(e.range);return-1!==n.row&&-1!==n.rowCount||(n.row=0,n.rowCount=0),-1!==n.col&&-1!==n.colCount||(n.col=0,n.colCount=0),n}function g(t){var t,t,n,i,r,e,o,u,s,e,t=null==(t=t.shapes)?void 0:t.all(),n=new h.Range(0,0,0,0);if(t)for(i=0,r=t;i<r.length;i++)1===(e=r[i]).ttV&&(o=e.startRow(),u=e.startColumn(),s=e.endRow(),e=e.endColumn(),n=n.union(new h.Range(o,u,s-o+1,e-u+1)));return n}function C(t,n){for(var i,r,e,o,u,s,c,f,i=t.getRowCount()-1,r=t.getColumnCount()-1,e=n.row+n.rowCount-1,o=n.col+n.colCount-1;e<=i;i--){for(c=r;0<=c;c--)if(s=t.getTemplateCell(i,c),!(0,l.ht)(s)){u=i,n.rowCount=u-n.row+1,o=Math.max(o,c);break}if(!(0,l.ht)(u))break}for(u=u||t.getRowCount()-1;o<=r;r--)for(f=u;0<=f;f--)if(s=t.getTemplateCell(f,r),!(0,l.ht)(s))return n.colCount=r-n.col+1,n;return n}function N(t){var n,i,r;if(t){for(n=[],i=t.start,r=t.end;i<=r;i++)n.push(i);return n}}function j(t){var n,i,r,e,r,o,t,u,t,n=.96,i=2,r=t.paperSize(),e=.96*r.width(),r=.96*r.height(),o=t.orientation(),t=t.margin(),u=.96*((t.left||0)+(t.right||0)),t=.96*((t.top||0)+(t.bottom||0));return 2===o?{width:r-u,height:e-t}:{width:e-u,height:r-t}}Object.defineProperty(n,"__esModule",{value:!0}),n.N4i=n.m4i=n.b4i=n.v4i=n.l4i=n.BTi=n.WTi=n.w4i=void 0,h=i("Core"),l=i("./dist/plugins/report/utils/utils.js"),o=h.UsedRangeType.style+h.UsedRangeType.rowStyle+h.UsedRangeType.colStyle+h.UsedRangeType.data+h.UsedRangeType.formula+h.UsedRangeType.span+h.UsedRangeType.sparkLine+h.UsedRangeType.comment+h.UsedRangeType.dataValidation+h.UsedRangeType.conditionFormat+h.UsedRangeType.axis,u=h.UsedRangeType.style+h.UsedRangeType.data+h.UsedRangeType.formula+h.UsedRangeType.span+h.UsedRangeType.sparkLine+h.UsedRangeType.comment+h.UsedRangeType.dataValidation+h.UsedRangeType.conditionFormat,a=Math.max,n.w4i=e,r={HORIZONTAL:"H",VERTICAL:"V",NONE:"No"},n.WTi=s,n.BTi=c,n.l4i=f,n.v4i=v,n.b4i=C,n.m4i=N,n.N4i=j},"./dist/plugins/report/utils/chart-utils.js":function(t,n){"use strict";function i(t,o){var t,n,n;((null==(t=t.dataCharts)?void 0:t.all())||[]).forEach(function(r){var e=r.getChartConfig();e&&e.plots&&e.plots.forEach(function(t){var n,i;null!=(n=t.encodings)&&n.filter&&(i=u(t.encodings.filter,o))&&r.setChartConfig(e)})})}function u(t,n){var i,r,t,t,i=!0,r=t,t=t;return t.conditions?t.conditions.forEach(function(t){u(t,n)&&(i=!0)}):r.valueIsParameter&&(t=n.find(function(t){var t;return t.name.toUpperCase()===(null==(t=r.value)?void 0:t.toString().toUpperCase())}),r.value=t?t.value:void 0,r.valueIsParameter=!1,i=!0),i}Object.defineProperty(n,"__esModule",{value:!0}),n.ezr=void 0,n.ezr=i},"./dist/plugins/report/utils/utils.js":function(_,a,t){"use strict";var i,u,r,n,s,e,c,o,f,h,l,v,d,p,M,w,I,g,C,N,z,j;function B(t){return t&&(t.cellNode.templateCell.formula||t.group.defaultFormula)}function E(){var t=o+f;return f++,t}function G(t){for(var n=E();t.Gm(n);)n=E();return n}function k(t){for(var n,i,r,e,n=-1,i=1,r="A".charCodeAt(0)-1,e=t.length-1;0<=e;e--)n+=(t.charCodeAt(e)-r)*i,i*=26;return n}function A(t){return(t=(t=t||"").startsWith("=")?t.substring(1):t).trim().toUpperCase()}function U(t){var t=A(t);return!Z(t)&&j.test(t)}function Z(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)}function D(t){var t=j.exec(A(t));return t?{row:parseInt(t[2],10)-1,col:k(t[1])}:null}function b(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return i+(t+1)}function V(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return"$"+i+"$"+(t+1)}function H(t,n){for(var i=0,r=t.length;i<r;i++)if(n(t[i],i,t))return i;return-1}function W(t,n){var i;if(n)return i=new u.Range(n.row,n.col,n.rowCount,n.colCount),(n.row<0||n.rowCount<0)&&(i.row=0,i.rowCount=t.rowEnd+1),(n.col<0||n.colCount<0)&&(i.col=0,i.colCount=t.colEnd+1),i}function F(n,t,i){var r=0,e=0,o=0,u=0,e=T(t,function(t){return n.getRowHeight(t)}),r,o,u;return{x:T(i,function(t){return n.getColumnWidth(t)}),y:e,height:+n.getRowHeight(t),width:+n.getColumnWidth(i)}}function T(t,n){for(var i,r,i=0,r=0;r<t;r++)i+=+n(r);return i}function Q(t,n,i,r,e){for(var o,u,s,c,f,h,l,a,v,d,o=0,u=0,s=0,c=0,f=0,h=0,l=0,a=0,v=i.rnr(),d=i.enr();s<=t;){if(d<=u){if(!(l=e))break}else l=i.F5t(u);if(t<s+l)break;s+=l,u+=1}for(f=l-(t-s);c<=n;){if(v<=o){if(!(a=r))break}else a=i.L5t(o);if(n<c+a)break;c+=a,o+=1}return{row:o,col:u,offsetX:f,offsetY:h=a-(n-c)}}function Y(t,n,i){for(var r,e,o,u,s,c,f,h,l,a,r=0,e=0,o=0,u=0,s=0,c=0,f=i.getColumnCount(),h=i.getRowCount();o<=t&&((l=i.getColumnWidth(e))||!(f<=e)||(l=i.defaults.colWidth))&&!(t<o+(s=+l));)o+=s,e+=1;for(;u<=n&&((a=i.getRowHeight(r))||!(h<=r)||(a=i.defaults.rowHeight||0))&&!(n<u+(c=+a));)u+=c,r+=1;return{row:r,col:e}}function J(){var t=new u.Style;return t.decoration={cornerFold:{size:6,position:u.CornerPosition.leftTop,color:"#FF3D00"}},t}function K(t){if(t){var n=t.titleRow,i=t.endRow,r=t.titleCol,t=t.endCol;if(!(O(n)&&O(i)&&O(r)&&O(t)))return!1;if(!nt(n,i)||!nt(r,t))return!1}return!0}function X(t,n){try{if(t){var i=(0,r.formulaToRange)(n,t.dataRange);if(!i)return!1;if(t.dataRange=(0,r.rangeToFormula)(i,0,0,15),"RowLayout"===t.type){if(!(0<t.rowCount))return!1;if(t.repeatRows&&!O(t.repeatRows))return!1}if("ColumnLayout"===t.type){if(!(0<t.columnCount))return!1;if(t.repeatCols&&!O(t.repeatCols))return!1}}return!0}catch(t){return!1}}function $(t,n){return t.cellButtons=t.cellButtons||[],t.cellButtons.unshift({position:u.ButtonPosition.leftOfText,command:"ReportCollapseButtonToggle",imageType:u.ButtonImageType.custom,visibility:u.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:n?a.collapseImg:a.expandImg,Ltr:!0,imageSize:{width:16,height:16}}),t}function q(t){return t.cellButtons=t.cellButtons||[],t.cellButtons.unshift({position:u.ButtonPosition.leftOfText,command:"ReportCollapseButtonToggle-empty",imageType:u.ButtonImageType.custom,visibility:u.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a.emptyCollapse,Ltr:!0,imageSize:{width:16,height:16}}),t}function tt(t,n){var i,r;return t&&n?(i=g(t.row+t.rowCount-1,n.row+n.rowCount-1),r=g(t.col+t.colCount-1,n.col+n.colCount-1),t.row=I(t.row,n.row),t.col=I(t.col,n.col),t.rowCount=i-t.row+1,t.colCount=r-t.col+1):!t&&n&&(t=new u.Range(n.row,n.col,n.rowCount,n.colCount)),t}function O(t){return!t||!((0,a.ht)(t.start)||(0,a.ht)(t.end)||t.start>t.end||t.start<0||t.end<0)}function nt(t,n){return!(t&&n&&t.end>=n.start)}function it(t,n){n.defaults.rowHeight=t.defaults.rowHeight,n.defaults.colWidth=t.defaults.colWidth,n.options.allowCellOverflow=t.options.allowCellOverflow,n.options.showFormulas=!1,n.options.sheetTabColor=t.options.sheetTabColor,n.options.frozenlineColor=t.options.frozenlineColor,n.options.clipBoardOptions=u.ClipboardPasteOptions.values,n.options.gridline={},n.options.rowHeaderVisible=!1,n.options.colHeaderVisible=!1,n.options.rowHeaderAutoText=t.options.rowHeaderAutoText,n.options.colHeaderAutoText=t.options.colHeaderAutoText,n.options.rowHeaderAutoTextIndex=t.options.rowHeaderAutoTextIndex,n.options.colHeaderAutoTextIndex=t.options.colHeaderAutoTextIndex,n.options.isProtected=t.options.isProtected,n.options.protectionOptions=i({},t.options.protectionOptions),n.options.selectionBackColor=t.options.selectionBackColor,n.options.selectionBorderColor=t.options.selectionBorderColor,n.options.sheetAreaOffset=t.options.sheetAreaOffset,n.options.reversalTrailingResizeOrder=t.options.reversalTrailingResizeOrder,n.options.keepUnknownFormulas=t.options.keepUnknownFormulas,n.options.disableContextMenu=t.options.disableContextMenu,n.options.frozenlineColor=t.options.frozenlineColor,n.frozenRowCount(t.frozenRowCount()),n.frozenColumnCount(t.frozenColumnCount()),n.frozenTrailingRowCount(t.frozenTrailingRowCount()),n.frozenTrailingColumnCount(t.frozenTrailingColumnCount()),n.currentTheme(t.currentTheme()),n.zoom(t.zoom())}function rt(t){var n,c,n=t&&t.filter;return n&&n.condition&&(c=function(t){var n,i,r,e,o,u,s,n=t.value;if((0,a.ht)(n)||"object"!=typeof n||(t.value=C(n)),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],c(e);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],c(s)})(n.condition),t}function et(t){var n,i,c,n=t&&t.filter;return n&&n.condition&&(i=(0,u.RF)(n.condition),(c=function(t){var n,i,r,e,o,u,s,n=t.value;if((0,a.ht)(n)||"string"!=typeof n||(t.value=N(n)),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],c(e);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],c(s)})(i),n.condition=i),t}function ot(t,n,i){var r,e,o,u,s,c,f,h,l,t,r=[],e=t.Dn,o=1,u=1,s=t.frozenRowCount(),c=t.frozenColumnCount(),f=t.frozenTrailingRowCount(),h=t.frozenTrailingColumnCount(),l=t.getRowCount(),t=t.getColumnCount();return(0,a.ht)(n.leftParent.row)||(n.leftParent.row<s?o--:n.leftParent.row>=l-f&&o++,n.leftParent.col<c?u--:n.leftParent.col>=t-h&&u++,r[0]=e.uO(o,u),u=o=1),(0,a.ht)(n.upParent.row)||(n.upParent.row<s?o--:n.upParent.row>=l-f&&o++,n.upParent.col<c?u--:n.upParent.col>=t-h&&u++,r[1]=e.uO(o,u)),r}function ut(t,n){var i=t.titleRow,r=t.endRow;i&&(t.titleRow=m(i,n)),r&&(t.endRow=m(r,n)),ht(t,n)}function st(t,n){var i=t.titleCol,r=t.endCol;i&&(t.titleCol=m(i,n)),r&&(t.endCol=m(r,n)),ht(t,n)}function ct(t,n){"RowLayout"===t.type&&t.repeatRows&&(t.repeatRows=m(t.repeatRows,n)),lt(t,n)}function ft(t,n){"ColumnLayout"===t.type&&t.repeatCols&&(t.repeatCols=m(t.repeatCols,n)),lt(t,n)}function ht(t,n){var i,i,i=t.rowPagination;i&&i.paginationDataCell&&((i=vt(i.paginationDataCell,n))?t.rowPagination.paginationDataCell=i:t.rowPagination=void 0)}function lt(t,n){var i;t.dataRange&&((i=t.dataRange.trim().toUpperCase().split(":").map(function(t){return vt(t,n)})).some(function(t){return!t})&&(t.dataRange=void 0),t.dataRange=i.join(":"))}function m(t,n){var n,i,r,n,e,t,n=at(n),i=n.active,r=n.type,n=n.count,e=S(t.start,i,n,r);if(!(e<0||(t=S(t.end,i,n,r))<0))return{start:e,end:t}}function at(t){var n,i,r,n,i,r;return{active:t.propertyName.includes("Rows")?t.row:t.col,type:t.propertyName.includes("add")&&!t.isUndo||t.propertyName.includes("delete")&&t.isUndo?"Add":"Delete",count:t.isUndo?t.oldValue:t.count}}function S(t,n,i,r){return n<=t?"Add"===r?t+i:t<n+i?-1:t-i:t}function vt(t,n){var t,i,r,e,i,o,n,t=D(t);if(t&&(r=(i=at(n)).active,e=i.count,i=i.type,o=n.propertyName.includes("Rows")?S(t.row,r,e,i):t.row,n=n.propertyName.includes("Columns")?S(t.col,r,e,i):t.col,!(o<0||n<0)))return b(o,n)}function dt(t){Mt(t,3),pt(t),wt(t),It(t),gt(t)}function pt(t){var n,i,r;if(t.RB&&(n=t.RB.cE))for(i in n)n.hasOwnProperty(i)&&(r=n[i],t.removeSparkline(r.row,r.column))}function Mt(n,i){var t;n.tables&&n.tables.all().forEach(function(t){n.tables.remove(t,i)})}function wt(n){var t;n.pivotTables&&n.pivotTables.all().forEach(function(t){n.pivotTables.remove(t.name())})}function It(t){var n,i,r,e;if(t.charts)for(i=0,r=n=t.charts.all();i<r.length;i++)e=r[i],t.charts.remove(e.name())}function gt(t){var n,i,r,e,o;if(t.shapes)for(r=0,e=i=(n=t.shapes).all();r<e.length;r++)(o=e[r]).ttV!==c.CT_ShapeType.CT_Picture&&o.ttV!==c.CT_ShapeType.CT_Chart&&n.remove(o.name())}function Ct(t,n,i){var r,i,t;if(n)return r={src:"",position:u.IconPosition.leftOfText,width:12,height:12,Ltr:!0,isReport:!0},t="string"==typeof(i=null==i?void 0:i.backColor)&&Nt(u.I.m(t,i)),"Group"===n.type?r.src=t?p:l:"List"===n.type?r.src=t?M:v:"Summary"===n.type?r.src=t?w:d:r=void 0,r}function Nt(t){var n=!1;return n=t&&h.rp(h._(t))<127.5?!0:n}function jt(t,n){n?t.sort(function(t,n){return t.row!==n.row?t.row-n.row:t.col-n.col}):t.sort(function(t,n){return t.col!==n.col?t.col-n.col:t.row-n.row})}function Et(t,n,i,r){var e,o,u,s,c,f,h,l,c,n,a,v,t,i,a,e=t.x,o=t.y,u=t.width,s=t.height,c=Q(e,o,n,r.defaults.rowHeight,r.defaults.colWidth),f=c.row,h=c.col,l=c.offsetX,c=c.offsetY,n=At(n,f,h),a=!1,v=!1;return n&&(a=h-n.col>=n.colCount/2,v=f-n.row>=n.rowCount/2),t=t.cell||i.getCells(f,h).sort(function(t,n){return t.row>=n.row&&t.col>=n.col?1:-1})[0],i=r.getSpan(t.row,t.col),a&&i?h=i.col+i.colCount-(n.colCount+n.col-h):t&&(h=Math.max(t.col,h)),v&&i?f=i.row+i.rowCount-(n.rowCount+n.row-f):t&&(f=Math.max(t.row,f)),(a=Dt(f,h,r)).x+=+r.getColumnWidth(h),a.y+=+r.getRowHeight(f),{x:e=a.x-l,y:o=a.y-c,width:u,height:s,cell:t}}function At(t,n,i){var n,i,n=t.D7(n,i);if(n)return i=new u.Range(n.row,n.col,n.rowCount,n.colCount),-1!==n.row&&-1!==n.rowCount||(i.row=0,i.rowCount=t.rnr()),-1!==n.col&&-1!==n.colCount||(i.col=0,i.colCount=t.enr()),i}function Dt(t,n,i){var r,e,e,r=y(0,0,t,n,i),e=i.getSpan(t,n),e=e?y(e.row,e.col,e.rowCount,e.colCount,i):y(t,n,1,1,i);return{x:r.width,y:r.height,width:e.width,height:e.height}}function y(t,n,i,r,e){for(var o,u,s,c,o=t+i,u=n+r,s=0,c=0;t<o;t++)s+=+e.getRowHeight(t);for(;n<u;n++)c+=+e.getColumnWidth(n);return{width:c,height:s}}function bt(t,n,i){var t,n,r,t=Y(t,n,i),n=i.getRowCount(),r=i.getColumnCount();t.row+1>n&&i.setRowCount(t.row+1),t.col+1>r&&i.setColumnCount(t.col+1)}function Tt(t,n,i,r,e){var r,o,e,o,e,o=r?(0,s.WTi)(r):"No";if(e.hAlign===u.HorizontalAlign.left||e.hAlign===u.HorizontalAlign.general||(0,a.ht)(e.hAlign)){if(r&&"Summary"!==r.type&&"Static"!==r.type&&("H"===o||"V"===o))return!0;if((e=r&&r.pin)&&("Row"===e||"Column"===e||"Both"===e))return!0;if(null!=(r=null==(o=i.getPaginationSetting())?void 0:o.rowPagination)&&r.paginationDataCell&&(e=D(o.rowPagination.paginationDataCell))&&e.col===n&&e.row===t)return!0}return!1}function Ot(t,n,i){if((0,a.ht)(t)&&(0,a.ht)(n))return null;if((0,a.ht)(t))t=0;else if((0,a.ht)(n)&&1!==i)return t;if(t instanceof e.CalcError)return t;if(n instanceof e.CalcError)return n;switch(i){case 0:return t+n;case 1:return 0===n||(0,a.ht)(n)?e.Errors.DivideByZero:t/n}}function R(t,n){var i=!1;return t.upParent===n||t.leftParent===n||(!(i=t.upParent&&(t.upParent.upParent||t.upParent.leftParent)?R(t.upParent,n):i)&&t.leftParent&&(t.leftParent.upParent||t.leftParent.leftParent)?R(t.leftParent,n):i)}function L(t,n,i){var n=t.tfr(n.row,n.col);return n.leftParent?n.leftParent.row===i.row&&n.leftParent.col===i.col||L(t,n.leftParent,i):!!n.upParent&&(n.upParent.row===i.row&&n.upParent.col===i.col||L(t,n.upParent,i))}function mt(t){var n,i,r;if(t&&t.length)for(n=0,i=t;n<i.length;n++)(r=i[n]).options.disableContextMenu=!1,St(r),yt(r)}function St(t){var t,t,n,i,r,t=null==(t=t.dataCharts)?void 0:t.all();if(t)for(n=0,i=t;n<i.length;n++)(r=i[n]).isLocked(!1),r.allowMove(!0),r.allowResize(!0),r.isSelected(!0),r.dynamicMove(!0)}function yt(t){var t,t,n,i,r,t=null==(t=t.shapes)?void 0:t.all();if(t)for(n=0,i=t;n<i.length;n++)1===(r=i[n]).ttV&&(r.isLocked(!1),r.allowMove(!0),r.allowResize(!0),r.allowRotate(!0),r.isSelected(!0))}function P(t,n,i){var r,e,o;if(t&&1===t.type)x(t,n,i);else{if(t.arguments)for(r=0,e=t.arguments;r<e.length;r++)P(o=e[r],n,i);t.value&&(1===t.value.type?x:P)(t.value,n,i),t.value2&&(1===t.value2.type?x:P)(t.value2,n,i)}}function x(t,n,i){t.columnRelative&&(t.columnRelative=!1,t.column+=i),t.rowRelative&&(t.rowRelative=!1,t.row+=n)}function Rt(t,n){for(var i=0,r=t.length;i<r;i++)n.push(t[i])}function Lt(t,n){return 0===n.indexOf(".")&&t.substring(t.length-n.length)===n}function Pt(t,n,i,r){var e,o,u,s;if("update"===n){for(u in o={},e=r.info)e.hasOwnProperty(u)&&"updated"===(s=e[u]).state&&(o[u]=s.oldValue);t.updateItem(i,o)}else"insert"===n&&t.remove(i,1)}function xt(t,n){var i,r,n,e,i,o,u,s,i,c,t,s,i,c,i=t.uw(),r=n.pageX-i.left,n=n.pageY-i.top,i=t.hitTest(r,n),o=i.row,u=i.col,s=i.rowViewportIndex,i=i.colViewportIndex;return-1<o&&-1<u&&1===s&&1===i&&(c=t.getTemplateCell(o,u),e=t.getCellRect(o,u,s,i),"Chart"===(null==c?void 0:c.type))&&void 0!==c.dataChartName&&(t=e.x,s=e.y,i=e.width,c=e.height,t+i-r<22)&&s+c-n<22?{result:!0,cellRect:e,row:o,col:u}:{result:!1,cellRect:e}}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(a,"__esModule",{value:!0}),a.oMr=a.iwr=a.k3=a.pushArrayTo=a.mir=a.hir=a.b_i=a.Enr=a.calculationValue=a.Iir=a.updateSheetRange=a.getFloatObjRect=a.getFloatObjPosition=a.atr=a.getTemplateIcon=a.vir=a.otr=a.utr=a.l5i=a.v5i=a.KTi=a.O4i=a.y4i=a.k_i=a.oCi=a.Pir=a.XTi=a.str=a._4i=a.i4i=a.y5i=a.JCi=a.U_i=a.JS=a.u_i=a.gnr=a.e_i=a.kOi=a.YOi=a.FOi=a.HTi=a.r4i=a.ht=a.lji=a.emptyCollapse=a.collapseImg=a.expandImg=a.LINKER=a.CONNECTOR=a.KEYWORD_UNDEFINED=void 0,u=t("Core"),r=t("SheetsCalc"),n=t("Common"),s=t("./dist/plugins/report/template/utils.js"),e=t("CalcEngine"),c=t("Shapes"),a.KEYWORD_UNDEFINED=void 0,o="Report",f=1,h=n.Common.ft,a.CONNECTOR="_",a.LINKER="&",a.expandImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",a.collapseImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",a.emptyCollapse="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",l="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Z3JvdXA8L3RpdGxlPgogICAgPGcgaWQ9Imdyb3VwIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMCw2IEwwLDEgTDMsMSBMMyw2IEwwLDYgWiBNMiwyIEwxLDIgTDEsNSBMMiw1IEwyLDIgWiBNMiwxMSBMMiw4IEwxLDggTDEsMTEgTDIsMTEgWiBNMCwxMiBMMCw3IEwzLDcgTDMsMTIgTDAsMTIgWiBNNCwyIEwxMiwyIEwxMiwzIEw0LDMgTDQsMiBaIE00LDQgTDEyLDQgTDEyLDUgTDQsNSBMNCw0IFogTTQsOCBMMTIsOCBMMTIsOSBMNCw5IEw0LDggWiBNNCwxMCBMMTIsMTAgTDEyLDExIEw0LDExIEw0LDEwIFoiIGlkPSLlvaLnirYiIGZpbGw9IiMyQjcwNDkiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",v="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bGlzdDwvdGl0bGU+CiAgICA8ZyBpZD0ibGlzdCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAsMSBMMiwxIEwyLDIgTDAsMiBaIE0wLDQgTDIsNCBMMiw1IEwwLDUgWiBNMCw3IEwyLDcgTDIsOCBMMCw4IFogTTAsMTAgTDIsMTAgTDIsMTEgTDAsMTEgWiBNMywxIEwxMiwxIEwxMiwyIEwzLDIgWiBNMyw0IEwxMiw0IEwxMiw1IEwzLDUgWiBNMyw3IEwxMiw3IEwxMiw4IEwzLDggWiBNMywxMCBMMTIsMTAgTDEyLDExIEwzLDExIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMyQjcwNDkiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",d="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c3VtbWFyeTwvdGl0bGU+CiAgICA8ZyBpZD0ic3VtbWFyeSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gaWQ9Iui3r+W+hCIgZmlsbD0iIzJCNzA0OSIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjEwIDIgMi43MjEyNSAyIDcuNTgxMjUgNiAyLjcyMTI1IDEwIDEwIDEwIDEwIDExIDEgMTEgMSAxMCA1LjkyODU3MTQzIDYgMSAyIDEgMSAxMCAxIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==",p="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Z3JvdXAgd2hpdGU8L3RpdGxlPgogICAgPGcgaWQ9Imdyb3VwLXdoaXRlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMCw2IEwwLDEgTDMsMSBMMyw2IEwwLDYgWiBNMiwyIEwxLDIgTDEsNSBMMiw1IEwyLDIgWiBNMiwxMSBMMiw4IEwxLDggTDEsMTEgTDIsMTEgWiBNMCwxMiBMMCw3IEwzLDcgTDMsMTIgTDAsMTIgWiBNNCwyIEwxMiwyIEwxMiwzIEw0LDMgTDQsMiBaIE00LDQgTDEyLDQgTDEyLDUgTDQsNSBMNCw0IFogTTQsOCBMMTIsOCBMMTIsOSBMNCw5IEw0LDggWiBNNCwxMCBMMTIsMTAgTDEyLDExIEw0LDExIEw0LDEwIFoiIGlkPSLlvaLnirYiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",M="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bGlzdCB3aGl0ZTwvdGl0bGU+CiAgICA8ZyBpZD0ibGlzdC13aGl0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAsMSBMMiwxIEwyLDIgTDAsMiBaIE0wLDQgTDIsNCBMMiw1IEwwLDUgWiBNMCw3IEwyLDcgTDIsOCBMMCw4IFogTTAsMTAgTDIsMTAgTDIsMTEgTDAsMTEgWiBNMywxIEwxMiwxIEwxMiwyIEwzLDIgWiBNMyw0IEwxMiw0IEwxMiw1IEwzLDUgWiBNMyw3IEwxMiw3IEwxMiw4IEwzLDggWiBNMywxMCBMMTIsMTAgTDEyLDExIEwzLDExIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",w="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c3VtbWFyeSB3aGl0ZTwvdGl0bGU+CiAgICA8ZyBpZD0ic3VtbWFyeS13aGl0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gaWQ9Iui3r+W+hCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjEwIDIgMi43MjEyNSAyIDcuNTgxMjUgNiAyLjcyMTI1IDEwIDEwIDEwIDEwIDExIDEgMTEgMSAxMCA1LjkyODU3MTQzIDYgMSAyIDEgMSAxMCAxIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==",I=Math.min,g=Math.max,C=u.util.Z0,N=u.util.V0,a.lji=B,a.ht=z=function(t){return null==t},a.r4i=E,a.HTi=G,j=/^([A-Z]+)([0-9]+)$/,a.FOi=A,a.YOi=U,a.kOi=D,a.e_i=b,a.gnr=V,a.u_i=H,a.JS=W,a.U_i=F,a.JCi=Q,a.y5i=Y,a.i4i=J,a._4i=K,a.str=X,a.XTi=$,a.Pir=q,a.oCi=tt,a.k_i=it,a.y4i=rt,a.O4i=et,a.KTi=ot,a.v5i=ut,a.l5i=st,a.utr=ct,a.otr=ft,a.vir=dt,a.getTemplateIcon=Ct,a.atr=jt,a.getFloatObjPosition=Et,a.getFloatObjRect=Dt,a.updateSheetRange=bt,a.Iir=Tt,a.calculationValue=Ot,a.Enr=R,a.b_i=L,a.hir=mt,a.mir=P,a.pushArrayTo=Rt,a.k3=Lt,a.iwr=Pt,a.oMr=xt},"./dist/plugins/report/worksheet/helpers/report-worksheet-helper.js":function(t,n,i){"use strict";var w,I,g,C,r;function e(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportWorksheetHelper=void 0,w=i("Core"),I=i("./dist/plugins/report/utils/utils.js"),g=w.util.Z0,C=w.util.g0,e.nEr=function(t,n,i){t.r3(),e.iEr(t,n,i),e.rEr(t,n),e.eEr(t,n),t.r3()},e.iEr=function(t,n,i){for(var r,e,o,u,s,c,f,h,l,a,v,d,p,v,M,r=t.Gji(),e=r.row,o=r.col,u,s,c=e+r.rowCount,f=o+r.colCount,h=n.Ut,l=h.sheetModels[3],a=new Map;e<c;e++){for(;o<f;o++)v=t.Bji(e,o),d=t.getActualStyle(e,o,w.SheetArea.viewport,void 0,{doNotAddCache:!0}),p=t.Hji(e,o),(0,I.ht)(v)||(v=g(v),v=C(v),p&&v.toString&&(v=v.toString()),l.setValue(e,o,v,null,null)),d&&(v=JSON.stringify(d.toJSON(void 0,void 0,i)),(M=a.get(v))||(M="STYLE-".concat(e,"-").concat(o),a.set(v,M),d.name=M,n.$p(d)),h.cAn(e,o,M,w.SheetArea.viewport)),p&&n.setHyperlink(e,o,p,w.SheetArea.viewport);o=r.col}},e.rEr=function(t,n){var i,t,i=t.Gji(),t=t.Zji(i);t&&t.forEach(function(t){n.addSpan(t.row,t.col,t.rowCount,t.colCount,w.SheetArea.viewport)})},e.eEr=function(t,n){for(var i,r,e,o,u,i=t.Gji(),r,e,o=i.rowCount-1,u=i.colCount-1;-1<o;)n.sEr(o,t.Vji(o)),o--;for(;-1<u;)n.cEr(u,t.Qji(u)),u--},n.ReportWorksheetHelper=e},"./dist/plugins/report/worksheet/helpers/utils.js":function(t,n){"use strict";function i(t,n){n&&(t.comboCells=n),t.dzr=function(n,i){var t,r,e,r={success:!1,value:void 0},e;return(null==(t=this.comboCells)?void 0:t.filter(function(t){return t.row===n&&t.col===i}))&&(r.value=this.getText(n,i),r.success=!0),r}}Object.defineProperty(n,"__esModule",{value:!0}),n.vzr=void 0,n.vzr=i},"./dist/plugins/report/worksheet/paginated-sheet.js":function(t,n,i){"use strict";var r,e,o,u,s,c;function f(t){var t=c.call(this,t)||this;return t.comboCells=[],(0,o.vzr)(t),t}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.PaginatedSheet=void 0,e=i("Core"),o=i("./dist/plugins/report/worksheet/helpers/utils.js"),c=e.Worksheet,r(f,c),f.prototype.r1cf=function(t){var n,i;if(!t)return n=this.getRowCount(),"A"+ ++this.getCell(3,0).row},f.prototype.uzr=function(){return!0},n.PaginatedSheet=f},"./dist/plugins/report/worksheet/report-worksheet.js":function(t,n,i){"use strict";var r,s,c,f,o,h,u,l,e,a,v,d,p,M,w,I,g,C,N,j,E,A;function D(t,n){var o,t,o=A.call(this,t)||this;return o.isReportWorkSheet=!0,o.shapeIsProtected=function(){return!0},o.getParent=function(){var t,t;return o.parent||(null==(t=null==(t=o.reportSheet)?void 0:t.Mf)?void 0:t.parent)},o.resetCalc=function(){o.initReportCalcSource(),o.eMt=!0},o.dzr=function(n,i){var t,r,t={success:!1,value:void 0},r;return o.reportDataModel.azr().filter(function(t){return t.row===n&&t.col===i})&&(t.value=o.getText(n,i),t.success=!0),t},o.Hji=function(t,n){var i,r,e,r,r,e,r,i=o,r=i.reportDataModel,e=i.reportSheet.templateSheet;if(!(0,v.ht)(r)&&e.getHyperlink&&(r=r.aOi(t,n)))return r=r.cellNode.templateCell,(e=e.getHyperlink(r.row,r.col,s.SheetArea.viewport))&&!(0,v.ht)(r.formula)&&""!==r.formula&&(r=i.QEr(t,n))&&r.__hyperlink__&&((e=(0,s.RF)(e)).url=r.__hyperlink__),e},o.toJSON=function(t){var n,t,n=o;return n.allowEditing=!1,n.suspendPaint(),n.suspendEvent(),n.suspendCalcService(),C.ReportWorksheetHelper.nEr(n,n,t),t=A.prototype.toJSON.call(o,t),n.Nir(t),o.allowEditing=!0,n.resumeCalcService(),n.resumeEvent(),n.resumePaint(),t},(t=o).reportSheet=n,t.allowEditing=!0,t.templateInfo=new e.TemplateInfo(n.templateSheet),t.init(),(0,g.sur)(t.$f()),o}r=this&&this.__extends||(E=function(t,n){return(E=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}E(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ReportWorksheet=void 0,s=i("Core"),c=i("Report"),f=i("./dist/plugins/report/calc-model/calc-model.js"),o=i("./dist/plugins/report/data-model/helpers/cell-status-helper.js"),h=i("./dist/plugins/report/data-model/helpers/conditional-format-helper.js"),u=i("./dist/plugins/report/data-model/helpers/validation-helper.js"),l=i("./dist/plugins/report/data-model/report-data-model.js"),e=i("./dist/plugins/report/data-model/template-info.js"),a=i("./dist/plugins/report/template/template-resolver.js"),v=i("./dist/plugins/report/utils/utils.js"),d=i("./dist/plugins/report/helpers/pagination-helper.js"),p=i("SheetsCalc"),M=i("./dist/plugins/report/calc-model/calc-source.js"),w=i("ConditionalFormatting"),I=i("./dist/plugins/report/worksheet/utils.js"),g=i("./dist/plugins/report/overrides/sheet-override.js"),C=i("./dist/plugins/report/worksheet/helpers/report-worksheet-helper.js"),N=s.GC$,A=s.Worksheet,r(D,A),D.prototype.getAllParameters=function(){var t,t;return null!=(t=null==(t=this.reportSheet)?void 0:t.getAllParameters())?t:[]},D.prototype.getSpan=function(t,n){return this.VTi(t,n)},D.prototype.initReportCalcSource=function(){var t,n,t=this;t.Amt={},t.hyt={},n=t.getParent(),t.iMt?t.iMt.clearAll():t.T3=new M.ReportCalcSource(t,s.SheetArea.colHeader,n&&n.getCalcService()),t.rMt?t.rMt.clearAll():t.A3=new M.ReportCalcSource(t,s.SheetArea.rowHeader,n&&n.getCalcService()),t.oMt?t.oMt.clearAll():t.qgt=new M.ReportCalcSource(t,s.SheetArea.viewport,n&&n.getCalcService())},D.prototype.getPagesCount=function(){return this.paginationHelper?this.paginationHelper.E_i():1},D.prototype.currentPage=function(t){return this.paginationHelper?this.paginationHelper.D_i(t):{currentPage:this,currentPageIndex:0,range:{row:0,col:0,rowEnd:this.getRowCount(),colEnd:this.getColumnCount()}}},D.prototype.getPageIndexByCell=function(t,n){return this.paginationHelper?this.paginationHelper.P_i(t,n):0},D.prototype.ignoreShowFunctions=function(){return!0},D.prototype.getHierarchicalCellIndexingHelper=function(){return this.reportDataModel.mji.cji()},D.prototype.regenerateReportData=function(t){var i,n,r,n,e,o,u,n,i=this,n=i.reportSheet.templateSheet,r=i.getParent();if(N[N.sd]({jS:r},1),r&&r.dataManager()&&n&&!n.xT)return i.suspendPaint(),i.defaults.colWidth=n.defaults.colWidth,i.defaults.rowHeight=n.defaults.rowHeight,n=new a.ReportTemplateResolver(n,this),e=i.reportSheet.parameter(),n=(o=new c.ReportEngine(n,r.dataManager())).generateReport(u=t?{enablePagination:!0,beforePageSizePaginate:function(t){var t,n,t,t=new l.ReportDataModel(i,o.getTreeGenerateResult().cellNodeCache,t,i.templateInfo,new f.CalcModel(i,t,i.getParent().getCalcService(),i.Uw(s.SheetArea.viewport)),new h.ConditionalFormatHelper(i.templateInfo.NOi(),i,t),null,null),n=i.reportDataModel,t=(i.reportDataModel=t).iOi();return i.reportDataModel=n,t},parameter:e}:{enablePagination:!1,parameter:e}),i.paginationHelper=t?new d.PaginationHelper(i,n):null,i.T4i(n,o.getTreeGenerateResult().cellNodeCache),t&&i.currentPage(0),i.resumePaint(),n},D.prototype.isExpandable=function(t,n){var i,i,i=null==(i=this.reportDataModel)?void 0:i.aOi(t,n);return!(!i||"No"===i.cellNode.templateCell.expansionDirection)},D.prototype.isDirtyCell=function(t,n){var i,r,r,i,r=this.reportDataModel;if(!(0,v.ht)(r)&&(r=r.aOi(t,n))&&"updated"===r.group.state)return!0},D.prototype.getActualStyle=function(t,n,i,r,e){return(e=e||{}).doNotAddCache=!0,A.prototype.getActualStyle.call(this,t,n,i,r,e)},D.prototype.setColumnWidth=function(t,n){this.reportDataModel.oEr(t,n),this.zw()},D.prototype.setRowHeight=function(t,n){this.reportDataModel.$mi(t,n),this.zw()},D.prototype.cEr=function(t,n){A.prototype.setColumnWidth.call(this,t,n)},D.prototype.sEr=function(t,n){A.prototype.setRowHeight.call(this,t,n)},D.prototype.Bji=function(t,n){var i,r,r,i,r=this.reportDataModel;if(!(0,v.ht)(r))return r=r.Sl(t,n),!(0,v.ht)(r)&&r.__hyperlink__&&r.toString?r.toString():r},D.prototype.QEr=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.Sl(t,n)},D.prototype.Uji=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.ML(t,n)},D.prototype.Zji=function(t){var n,i=this.reportDataModel;if(!(0,v.ht)(i))return i.ZF(t)},D.prototype.VTi=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.D7(t,n)},D.prototype.Qji=function(t){var n,i=this.reportDataModel;if(!(0,v.ht)(i))return i.F5t(t)},D.prototype.Vji=function(t){var n,i=this.reportDataModel;if(!(0,v.ht)(i))return i.L5t(t)},D.prototype.QTi=function(){var t,n,n,t,n=this.reportDataModel,n=null==n?void 0:n.lOi();return(null==n?void 0:n.rowCount)||0},D.prototype.YTi=function(){var t,n,n,t,n=this.reportDataModel,n=null==n?void 0:n.lOi();return(null==n?void 0:n.colCount)||0},D.prototype.Gji=function(){var t,n=this.reportDataModel;return(null==n?void 0:n.lOi())||new s.Range(0,0,0,0)},D.prototype.Oji=function(t,n,i,r,e){var o,u,s,i,r,u,o=this,u=o.reportDataModel;(0,v.ht)(u)||(s=u.Drr(t,n),u.Oji(t,n,i,r),i=u.Drr(t,n),r=u.aOi(t,n),s===i||i||((u=o.VTi(t,n))?(0,I.showCellInViewport)(u.row,u.col,o,r):(0,I.showCellInViewport)(t,n,o,r)),e)||(o.invalidateLayout(),o.gP(),o.repaint())},D.prototype.gOi=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.Drr(t,n)},D.prototype.Lir=function(t,n){var i,r;return this.reportDataModel.Lir(t,n)},D.prototype.fnr=function(t,n){var t,i,r,e,i=t,r=n;return this.paginationHelper&&(i=(e=this.paginationHelper.D_i().range).row+t,r=e.col+n),null==(t=this.reportDataModel.aOi(i,r))?void 0:t.cellNode},D.prototype.tfr=function(t,n){var i;return null==(i=this.reportDataModel)?void 0:i.ifr(t,n)},D.prototype.getCells=function(t,n,i,r){return this.reportDataModel?this.reportDataModel.BEi(t,n,i,r).map(function(t){return{value:t.value,row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}):[]},D.prototype.destroy=function(){A.prototype.destroy.call(this),this.reportDataModel=null,this.paginationHelper=null,this.templateInfo=null,this.reportSheet=null},D.prototype.init=function(){var t,n,n,t=this;t.suspendDirty(),t.setRowCount(0),t.setColumnCount(0),t.k_i(),t.options.gridline.showVerticalGridline=!1,t.options.gridline.showHorizontalGridline=!1,t.JT=!1,t.UB=!1,t.hA=s.ClipboardPasteOptions.values,t.lF=s.CopyToOptions.value,(n=null==(n=t.reportSheet.getParent())?void 0:n.Lp)&&(t.Lp.useR1C1=n.useR1C1,t.Lp.allowDynamicArray=n.allowDynamicArray,t.Lp.iterativeCalculation=n.iterativeCalculation,t.Lp.iterativeCalculationMaximumIterations=n.iterativeCalculationMaximumIterations,t.Lp.iterativeCalculationMaximumChange=n.iterativeCalculationMaximumChange,t.Lp.calcOnDemand=n.calcOnDemand,t.Lp.incrementalCalculation=n.incrementalCalculation,t.Lp.dynamicReferences=n.dynamicReferences),t.Inr()},D.prototype.Inr=function(){var t,n,i,r,e,o,u,s,t=this,n,i=t.templateInfo.e2t();if(i&&i.length)for(r=0,e=i;r<e.length;r++)u=(o=e[r]).getName(),0<(s=(0,p.expressionToFormula)(t.reportSheet.templateSheet,o.getExpression())).indexOf("!")&&(s=s.slice(s.indexOf("!")+1)),t.addCustomName(u,s,o.getRow(),o.getColumn())},D.prototype.k_i=function(){var t,n,i,t=this,n=t.reportSheet.templateSheet;n&&((0,v.k_i)(n,t),t.Amt=n.Amt,(i=n.printInfo()).sheet(t),t.printInfo(i),t.setDefaultStyle(n.getDefaultStyle()))},D.prototype.r1cf=function(t){var n,i;if(!t)return n=this.getRowCount(),"A"+ ++this.getCell(3,0).row},D.prototype.T4i=function(t,n){var i,r,e,i=this,r=i.getParent(),e=i.templateInfo;i.reportDataModel=new l.ReportDataModel(i,n,t,e,new f.CalcModel(i,t,r&&r.getCalcService(),i.Uw(s.SheetArea.viewport)),new h.ConditionalFormatHelper(e.NOi(),i,t),new o.CellStatesHelper(e.getCellStates(),i,t),new u.ValidationHelper(e.getValidations(),i,t,i)),i.reportDataModel.oOi()},D.prototype.Nir=function(t){var n,n,n=null==(n=null==t?void 0:t.conditionalFormats)?void 0:n.rules;null!=n&&n.length&&(t.conditionalFormats.rules=n.filter(function(t){return t.ruleType!==w.RuleType.formulaRule}))},n.ReportWorksheet=D},"./dist/plugins/report/worksheet/template-sheet.js":function(t,n,i){"use strict";var r,l,a,e,o,v,u,d,s,c,f,h,p,M,w,I,g;function C(t,n){var p,t,p=g.call(this,t)||this;return p.isReportTemplateSheet=!0,p.E4i=0,p.z4i=!0,p.pwr=[],p.canClone=!0,p.getBindingPath=function(t,n,i){return g.prototype.getBindingPath.call(p,t,n,i)},p.dzr=function(t,n){var i,r,i={success:!1,value:void 0},r=p.getCellType(t,n);return r&&"7"===r.typeName&&(i.value=p.getText(t,n),i.success=!0),i},p.enqueueBuildExpansionInfoCacheMessage=function(){var t=p;t.E4i&&window.clearTimeout(t.E4i),t.E4i=window.setTimeout(function(){t.xT||(t.Ytr(),t.repaint(),t.E4i=0)})},p.getRowPageBreak=function(t){return p.P4i.AOi(t,!0)},p.getColumnPageBreak=function(t){return p.P4i.AOi(t,!1)},p.d5i=function(t,n){3===n.sheetArea&&-1!==["addRows","deleteRows"].indexOf(n.propertyName)&&(p.updateAllAliasInfo(),p.k4i&&(0,v.v5i)(p.k4i,n),p.ctr)&&(0,v.utr)(p.ctr,n)},p.p5i=function(t,n){3===n.sheetArea&&-1!==["addColumns","deleteColumns"].indexOf(n.propertyName)&&(p.Ttr.jnr(),p.k4i&&(0,v.l5i)(p.k4i,n),p.ctr)&&(0,v.otr)(p.ctr,n)},p.qfr=function(t,n){var i=n.sheet,n=n.shape;i===p&&p.thr(n)},C.prototype.r1cf=function(t){var n,i;if(!t)return n=this.getRowCount(),"A"+ ++this.getCell(3,0).row},p.nhr=function(t,n){var i=n.sheet,r=n.shape,e=n.propertyName,n=n.oldValue;i===p&&p.ihr(r,e,n)},p.k5i=function(t,n){var i,r,e,o,n,u,s,c,f,h,l,a,v,d,i=n.sheet,r=n.type,e=n.range,o=n.isAdd,n=n.isClear;if("span"===r&&i===p)if(o)for(u=e.row,s=e.col,h=u+(c=e.rowCount),l=s+(f=e.colCount),a=u;a<h;a++)for(v=s;v<l;v++)!(d=p.getBindingPath(a,v))||a===u&&v===s?a===u&&v===s&&p.P4i._Oi(u,s,d,null,!0):(d.paginateBeforeRow=!1,d.paginateAfterRow=!1,d.paginateBeforeColumn=!1,d.paginateAfterColumn=!1,p.P4i._Oi(u,s,d),p.setBindingPath(a,v,d));else n&&p.P4i.IOi()},p.GOi=function(){p.Ytr(),p.L4i.GOi(),p.P4i.IOi(),p.Ttr.jnr()},p.$t=function(t,n,i,r){if(i===a.SheetArea.viewport||(0,v.ht)(i)){var e,o=void 0;if(p.getTemplateCell(t,n))return(o=p.$f()).getText(null,{sheet:p,row:t,col:n})}return p.getValue(t,n,i,r)},p.MAe=function(t,n,i,r,e){var o,i,r,e,t,o=p,i=o.getActualStyle(t,n,i,r,e),r=o.getTemplateCell(t,n),e=(0,v.getTemplateIcon)(o,r,i);return e&&((0,v.Iir)(t,n,o,r,i)&&(i.textIndent=i.textIndent||1),i.decoration?i.decoration.icons||(i.decoration.icons=[]):i.decoration={icons:[]},i.decoration.icons=i.decoration.icons.filter(function(t){return!t.isReport}),i.decoration.icons.push(e)),null!=(t=i.cellButtons)&&t.length&&(i.cellButtons=t.filter(function(t){return"ReportCollapseButtonToggle"!==t.command})),r&&r.showCollapseButton&&"None"!==r.spillDirection&&(0,v.XTi)(i,!1),i},p.toJSON=function(t){var t=g.prototype.toJSON.call(p,t);return(0,h.Vtr)(t),p.HOi(t,!0),t.templateSetting={paginationSetting:p.k4i,layoutSetting:p.ctr,dataEntrySetting:p.R4i,templateOptions:p.templateOptions,containers:p.pwr.map(function(t){return{ranges:t.ranges.map(function(t){return t.toJSON()}),options:l({},t.options)}})},t.type=a.WorksheetType.reportTemplateSheet,t},p.wh=function(t,n,i){var t=g.prototype.wh.call(p,t,n,i);return t&&((0,h.Htr)(t),p.HOi(t,!1),t.lossless||(t.lossless={}),t.lossless.templateLossless={paginationSetting:p.k4i,layoutSetting:p.ctr,dataEntrySetting:p.R4i,templateOptions:p.templateOptions,containers:p.pwr.map(function(t){return{ranges:t.ranges.map(function(t){return t.toJSON()}),options:l({},t.options)}})},t.lossless.type=a.WorksheetType.reportTemplateSheet),t},p.fromJSON=function(t,n,i,r,e){(0,h.Wtr)(t);try{g.prototype.fromJSON.call(p,t,n,i,r,e)}catch(t){}var n=t.templateSetting;n&&(p.k4i=n.paginationSetting,p.ctr=n.layoutSetting,p.R4i=n.dataEntrySetting,p.templateOptions=n.templateOptions||{},p.pwr=(n.containers||[]).map(function(t){return{ranges:t.ranges.map(function(t){return new a.Range(t.row,t.col,t.rowCount,t.colCount)}),options:l({},t.options)}})),p.GOi()},p.yh=function(t,n,i,r){var n,i;(0,h.Qtr)(t);try{g.prototype.yh.call(p,t,n,i,r)}catch(t){}(i=null==(n=null==t?void 0:t.lossless)?void 0:n.templateLossless)&&(p.k4i=i.paginationSetting,p.ctr=i.layoutSetting,p.R4i=i.dataEntrySetting,p.templateOptions=i.templateOptions||{},p.pwr=(i.containers||[]).map(function(t){return{ranges:t.ranges.map(function(t){return new a.Range(t.row,t.col,t.rowCount,t.colCount)}),options:l({},t.options)}})),p.GOi()},p.destroy=function(){var t,t,t;p.unbindEvents(),g.prototype.destroy.call(p),null!=(t=p.P4i)&&t.eG(),null!=(t=p.nnr)&&t.eG(),null!=(t=p.L4i)&&t.eG(),p.R4i=void 0,p.k4i=void 0,p.nnr=void 0,p.L4i=void 0,p.P4i=void 0,p.B4i=void 0,p.Ttr=void 0,p.templateOptions=void 0},(t=p).Pji=n,t.Tir=!0,t.nnr=new e.CellNodeInfoHelper(t),t.L4i=new u.CellReferenceHelper(t),t.options.showFormulas=!0,t.P4i=new s.BreakLineHelper(t),t.B4i=new c.TemplateTooltipHelper(t),t.Ttr=new f.AliasHelper(t),t.templateOptions={},t.getCalcService().allowDynamicArray=!0,t.U4i(),t.bindEvents(),p}r=this&&this.__extends||(I=function(t,n){return(I=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}I(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateSheet=void 0,a=i("Core"),e=i("./dist/plugins/report/helpers/cell-node-info-helper.js"),o=i("./dist/plugins/report/template/template-overwrite.js"),v=i("./dist/plugins/report/utils/utils.js"),u=i("./dist/plugins/report/helpers/cell-reference-helper.js"),d=i("./dist/plugins/report/template/utils.js"),s=i("./dist/plugins/report/helpers/break-line-helper.js"),c=i("./dist/plugins/report/helpers/template-tooltip-helper.js"),f=i("./dist/plugins/report/helpers/template-alias-helper.js"),h=i("./dist/plugins/report/worksheet/utils.js"),p=i("DataChart"),M=".template-sheet",g=a.Worksheet,r(C,g),C.prototype.getAllParameters=function(){var t,t;return null!=(t=null==(t=this.Pji)?void 0:t.getAllParameters())?t:[]},C.prototype.fMr=function(){var t;null!=(t=this.dataCharts)&&t.all().forEach(function(t){var n,n,n,i,n,e,i=t.getChartConfig(),n=null==(n=null==(n=null==(n=null==i?void 0:i.plots)?void 0:n[0])?void 0:n.encodings)?void 0:n.filter;n&&(e=function(t){var n,i,r;if(t.valueIsParameter)return!0;if(t.conditions)for(n=0,i=t.conditions;n<i.length;n++)if(r=i[n],e(r))return!0;return!1})(n)&&t.setChartConfig(i)})},C.prototype.getTemplateCell=function(t,n){return this.getBindingPath(t,n)},C.prototype.setTemplateCell=function(t,n,i){this.Ntr(t,n,i),this.setBindingPath(t,n,i)},C.prototype.getDataEntrySetting=function(){return this.R4i},C.prototype.setDataEntrySetting=function(t){this.L4i.UOi(t),this.R4i=t},C.prototype.getPaginationSetting=function(){return this.k4i},C.prototype.setPaginationSetting=function(t){(0,v._4i)(t)&&(this.k4i=t)},C.prototype.getLayoutSetting=function(){return this.ctr},C.prototype.setLayoutSetting=function(t){(0,v.str)(t,this)&&(this.ctr=t)},C.prototype.Ntr=function(t,n,i){(0,h.hMr)(this,t,n,i),this.L4i.ZOi(t,n,i),this._Oi(t,n,i),this.dnr(t,n,i)},C.prototype.dnr=function(t,n,i){this.Ttr.dnr(t,n,i)},C.prototype.getCellAlias=function(t,n){var t,n,t,i,t=this.getTemplateCell(t,n);if(t)return!(n=t.alias)&&t.binding&&(i=(t=t.binding.trim()).split("["),n=t.substring(i[0].length+1,t.length-1)),n},C.prototype.cMr=function(){return this.L4i},C.prototype.getAllCellAlias=function(){return this.Ttr._nr()},C.prototype.getActualText=function(t,n){return this.$f().getText(t,n)},C.prototype.showToolTip=function(t){return 0<arguments.length&&(this.z4i=!!t),!!this.z4i},C.prototype.getCellTipContent=function(t,n){return this.B4i.RTi(t,n)},C.prototype.Ytr=function(){this.nnr.Ytr()},C.prototype.$tr=function(){return this.nnr.$tr()},C.prototype.fwr=function(){var r,e,o,u,s,c,r=this,e=this.getActiveRowIndex(),o=this.getActiveColumnIndex(),u=this.pwr.filter(function(t){var t,n,i,r,t,t=t.ranges;if(1===t.length?n=t[0]:3===t.length&&(i=t[0],r=t[1],t=t[2],n=new a.Range(i.row,r.col,i.rowCount+t.rowCount,r.colCount+t.colCount)),n&&n.intersect(e,o,1,1))return!0})[0],s=this.getViewportLeftColumn(1),c=this.getViewportTopRow(1);return this.pwr.map(function(t){var n,n,i,n=t.ranges,i=new a.Range(n[1].row,n[1].col,n[1].rowCount,n[1].colCount+n[2].colCount);return{ranges:n,rangeRects:n.map(function(t){return r.getRangeRect(1,1,t)}),range:i,rangeRect:r.getRangeRect(1,1,i),backColor:r.getActualStyle(e,o).backColor||(null==(n=r.parent)?void 0:n.options.backColor)||"white",isActive:t===u,viewportRangeRect:r.getRangeRect(1,1,new a.Range(Math.max(c,i.row),Math.max(s,i.col),i.rowCount-Math.max(c,i.row)+i.row,i.colCount-Math.max(s,i.col)+i.col))}})},C.prototype.bindEvents=function(){var i=this;i.bind(a.Events.ActiveCellChanged+M,function(t,n){i.nnr.Ktr(n.row,n.col),i.repaint()}),[a.Events.CellChanged,a.Events.WorksheetDataChanged,a.Events.RowChanged,a.Events.ColumnChanged,a.Events.RowHeightChanged,a.Events.ColumnWidthChanged,a.Events.DragFillBlockCompleted,a.Events.DragMerged,a.Events.PasteEnd,a.Events.ClipboardPasted,a.Events.ValueChanged,a.Events.RangeChanged,a.Events.ShapeChanged,a.Events.ShapeRemoved].forEach(function(t){i.bind("".concat(t).concat(M),i.enqueueBuildExpansionInfoCacheMessage)}),i.bind("".concat(a.Events.RowChanged).concat(M,"-ns"),i.d5i),i.bind("".concat(a.Events.ColumnChanged).concat(M,"-ns"),i.p5i),i.bind("".concat(a.Events.ShapeRemoved).concat(M,"-ns"),i.qfr),i.bind("".concat(a.Events.ShapeChanged).concat(M,"-ns"),i.nhr),i.bind("".concat(a.Events.WorksheetDataChanged).concat(M,"-ns"),i.k5i)},C.prototype.unbindEvents=function(){var t=this;t._3(M),t._3("".concat(M,"-ns"))},C.prototype.buildBreadLineCache=function(){this.P4i.IOi();var t=this.getParent();t&&(t.needUpdatePrintCache=!0,this.ki(a.Events.ReportPaginationSettingChanged))},C.prototype.updateAllAliasInfo=function(){this.Ttr.jnr()},C.prototype._Oi=function(t,n,i){var r,e=this.getSpan(t,n);e&&(e.row!==t||e.col!==n)&&i?(i.paginateAfterColumn=!1,i.paginateAfterRow=!1,i.paginateBeforeColumn=!1,i.paginateBeforeRow=!1):this.P4i._Oi(t,n,i)},C.prototype.U4i=function(){var t,t,t=this.$f();(0,o.a4i)(t),this.dataCharts&&((t=this.dataCharts).Bje?t.paintBlankChart=h.rhr:t.paintBlankChart=h.ehr)},C.prototype.thr=function(t){var n,i,r,e,o,u;if(null!=p&&p.DataChart&&t&&t instanceof p.DataChart)for(n=t.name(),i=this.getRowCount(),r=this.getColumnCount(),e=0;e<i;e++)for(o=0;o<r;o++)(u=this.getBindingPath(e,o))&&u.dataChartName===n&&this.setBindingPath(e,o,null)},C.prototype.ihr=function(t,n,i){var r,e,o,u,s,c;if(null!=p&&p.DataChart&&t&&t instanceof p.DataChart&&"name"===n)for(r=t.name(),e=this.getRowCount(),o=this.getColumnCount(),u=0;u<e;u++)for(s=0;s<o;s++)(c=this.getBindingPath(u,s))&&c.dataChartName===i&&(c.dataChartName=r,this.setBindingPath(u,s,c))},C.prototype.HOi=function(t,n){n?(this.L4i.ftr(t),this.Ttr.ftr(t)):(this.L4i.htr(t),this.Ttr.htr(t))},C.prototype.KI=function(t,n,i,r,e,o,u,s,c,f){var h,l,a,v,d,h,t;for(this.suspendPaint(),a=(l=t)+i-1;l<=a;l++)for(d=(v=n)+r-1;v<=d;v++)(h=null==(h=this.getStyle(l,v))?void 0:h.clone())&&h._autoFormatter&&(delete h._autoFormatter,h.toJSON()||this.setStyle(l,v,void 0));return t=g.prototype.KI.call(this,t,n,i,r,e,o,u,s,c,f),this.resumePaint(),t},C.prototype.internalUpdateSettingsToReferNewTable=function(t,n){var t=t.toUpperCase();(0,h.xir)(this,t,n),(0,h._ir)(this,t,n),(0,h.tzr)(this,t,n)},C.prototype.internalUpdateSettingsToReferNewColumn=function(t,n,i){var t=t.toUpperCase(),n=n.toUpperCase();(0,h.Bir)(this,t,n,i),(0,h.Gir)(this,t,n,i)},C.prototype.onCustomNameFormulaChanged=function(t){this.L4i._6(t)},C.prototype.fetchAllTablesAsync=function(t,n){var i,r,e,o;return void 0===n&&(n=!1),i=this.A4i(t),r=t.dataManager(),e=Object.keys(r.tables),o=function(n){return r.tables[e.find(function(t){return t.toUpperCase()===n})]},Promise.all(i.map(function(t){var t=o(t);return!t||!n&&t.isFetched()?Promise.resolve():t.fetch(n).catch(function(){})}))},C.prototype.A4i=function(r){var e,t,n,i,o,u,s,c,f,h,h,l,e={},t=(0,d.v4i)(this);if(t)for(n=t.row,i=t.col,s=n+(o=t.rowCount),c=i+(u=t.colCount);n<s;n++){for(;i<c;i++)f=this.getTemplateCell(n,i),(0,v.ht)(f)||"string"==typeof f||((h=(0,d.BTi)(f))&&!(0,v.ht)(h.tableName)&&(e[h.tableName.toUpperCase()]=!0),h=f.filter&&f.filter.condition,this.x4i(h,e));i=t.col}return(l=this.dataCharts)&&l.all().forEach(function(t){var n,n,i,n=t.getChartConfig&&(null==(n=t.getChartConfig())?void 0:n.tableName);n&&(i=t.LPr(n,r)).forEach(function(t){e[t.toUpperCase()]=!0})}),Object.keys(e)},C.prototype.x4i=function(t,n){var i,r,e,o,u,s;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],this.x4i(e,n);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],this.x4i(s,n)}},C.prototype.getText=function(t,n,i){var r,e,e,o,r=this,e=r.getTemplateCell(t,n);return(0,v.ht)(i)&&(i=3),e?r.$t(t,n,i):(e=r.t0(t,n,i),(0,v.ht)(e)?(o=r.getValue(t,n,i),r.vL(t,n,o,i,!0)):e)},C.prototype.isActualProtected=function(){return!1},C.prototype.getActualUsedRange=function(){var t=this,n=t.Ut,i=n.getLastNonNullCol(3,!0),n=n.getLastNonNullRow(3,!0),n=(0,v.ht)(n)?0:n+1,i=(0,v.ht)(i)?0:i+1;return(0,d.b4i)(t,new a.Range(0,0,n,i))},C.prototype.containers=function(t){var n,i;return t&&(this.Ut.vwr(),n=this.getRowCount(),i=this.getColumnCount(),t.forEach(function(t){var t=t.ranges;t[0].colCount=Math.min(t[0].colCount,i-t[0].col),t[2].colCount=Math.min(t[2].colCount,i-t[2].col),t[1].rowCount=Math.min(t[1].rowCount,n-t[1].row),t[2].rowCount=Math.min(t[2].rowCount,n-t[2].row)}),this.pwr=t,this.Ut.vwr(!0)),this.pwr.map(function(t){return{ranges:t.ranges.map(function(t){return new a.Range(t.row,t.col,t.rowCount,t.colCount)}),options:l({},t.options)}})},C.prototype.wwr=function(t,n){var i,r,e,o,u,i=[],o=this.pwr;if(o.length)for(this.Ut.vwr(),e=o.length-1;0<=e;e--)r=o[e],u=new a.Range(r.ranges[1].row,r.ranges[1].col,r.ranges[1].rowCount,r.ranges[1].colCount+r.ranges[2].colCount),t.containsRange(u)&&(n&&o.splice(e,1),i.push(r));return i},C.prototype.Mwr=function(t,n,i,r,e,o){var u,s,c,f,c,h;if(t.length){for(u=0,s=t.length;u<s;u++)c=t[u],f=void 0,h=e-i,(f=o?c:{ranges:c.ranges.map(function(t){return new a.Range(t.row,t.col,t.rowCount,t.colCount)}),options:l({},c.options)}).ranges[0].row+=c=r-n,f.ranges[0].col+=h,f.ranges[1].row+=c,f.ranges[1].col+=h,f.ranges[2].row+=c,f.ranges[2].col+=h,this.pwr.push(f);this.Ut.vwr(!0)}},C.prototype.czr=function(){return!0},n.TemplateSheet=C},"./dist/plugins/report/worksheet/utils.js":function(_,t,n){"use strict";var o,l,i,s,c,f,e,u;function r(t){var n,i,r,e,o,u,n=t&&t.data&&t.data.dataTable;if(n)for(i in n)if(n.hasOwnProperty(i))for(e in r=n[i])r.hasOwnProperty(e)&&(u=(o=r[e])&&o.bindingPath)&&"object"==typeof u&&(o.bindingPath=(0,s.y4i)((0,l.RF)(u)))}function h(t){var n,i,r,e,o,u,n=t&&t.data&&t.data.dataTable;if(n)for(i in n)if(n.hasOwnProperty(i))for(e in r=n[i])r.hasOwnProperty(e)&&(u=(o=r[e])&&o.bindingPath)&&"object"==typeof u&&(o.bindingPath=(0,s.O4i)(u))}function a(t){var n,t,i,r,e,o,u,n,t=null==t?void 0:t.c_;if(null!=t&&t.length&&(i=t.filter(function(t){return"sheetData"===t.n_})[0]))for(r in i)if(i.hasOwnProperty(r)&&"object"==typeof i[r])for(o in e=i[r])e.hasOwnProperty(o)&&"object"==typeof e[o]&&(n=null==(n=null==(u=e[o])?void 0:u.lossless)?void 0:n.bindingPath)&&"object"==typeof n&&(u.lossless.bindingPath=(0,s.y4i)((0,l.RF)(n)))}function v(t){var n,t,i,r,e,o,u,n,t=null==t?void 0:t.c_;if(null!=t&&t.length&&(i=t.filter(function(t){return"sheetData"===t.n_})[0]))for(r in i)if(i.hasOwnProperty(r)&&"object"==typeof i[r])for(o in e=i[r])e.hasOwnProperty(o)&&"object"==typeof e[o]&&(n=null==(n=null==(u=e[o])?void 0:u.lossless)?void 0:n.bindingPath)&&"object"==typeof n&&(u.lossless.bindingPath=(0,s.O4i)(n))}function d(t,n){var i=document.createElement("div");i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.border="1px solid #BDBDBD",i.style.backgroundColor="white",i.style.color="#424242",i.style.height="100%",i.style.fontSize="14px",i.style.fontStyle="italic",i.textContent=e().configDataChart,n.appendChild(i)}function p(t,n,i,r){n.save(),n.beginPath(),n.rect(0,0,i,r),n.fillStyle="#FFFFFF",n.fill(),n.beginPath(),n.rect(0,0,i,r),n.strokeStyle="#BDBDBD",n.lineWidth=1,n.stroke(),n.font="italic 14px sans-serif",n.fillStyle="#424242",n.textAlign="center",n.textBaseline="middle",n.fillText(e().configDataChart,i/2,r/2,i),n.restore()}function M(t,n,i){var r,e,o,u,s,r=t.Ut.W_(l.SheetArea.viewport).dataTable;if(r)for(e in r)if(r.hasOwnProperty(e))for(u in o=r[e])o.hasOwnProperty(u)&&(s=o[u])&&s.bindingPath&&N(s.bindingPath,n,i)}function w(t,n,i){var t=t.getDataEntrySetting();null!=t&&t.length&&t.forEach(function(t){t.tableName.toUpperCase()===n&&(t.tableName=i)})}function I(t,r,e){var t,t,t=null==(t=t.dataCharts)?void 0:t.all();null!=t&&t.length&&t.forEach(function(t){var n,i,i=null==t?void 0:t.getChartConfig();i&&(null==(n=i.tableName)?void 0:n.toUpperCase())===r&&(i.tableName=e,t.setChartConfig(i))})}function g(t,n,i,r){var e,o,u,s,c,e=t.Ut.W_(l.SheetArea.viewport).dataTable;if(e)for(o in e)if(e.hasOwnProperty(o))for(s in u=e[o])u.hasOwnProperty(s)&&(c=u[s])&&c.bindingPath&&j(t,c.bindingPath,n,i,r)}function C(t,n,i,r){var t=t.getDataEntrySetting();null!=t&&t.length&&t.forEach(function(t){t.tableName.toUpperCase()===n&&t.fields.forEach(function(t){t.dbColumnName.toUpperCase()===i&&(t.dbColumnName=r)})})}function N(t,n,i){var t;t&&"object"==typeof t&&["List","Group","Summary"].includes(t.type)&&((t=t).binding&&t.binding.toUpperCase().startsWith(n+"[")&&(t.binding="".concat(i).concat(t.binding.substring(n.length))),t.filter)&&t.filter.condition&&O(t.filter.condition,n,i)}function j(r,t,n,e,o){var i,i,t,u;t&&"object"==typeof t&&["List","Group","Summary"].includes(t.type)&&((t=t).binding&&t.binding.toUpperCase().startsWith(n+"[")?(t.binding.toUpperCase()==="".concat(n,"[").concat(e,"]")&&(t.binding=t.binding.replace(/\[.*\]/g,"[".concat(o,"]"))),t.filter&&t.filter.condition&&(u=b(r,t.filter.condition,n,e,o),t.filter.condition=u),null!=(i=t.sortOptions)&&i.length&&t.sortOptions.forEach(function(t){var n=!1,i;t.asc?(n=!0,i=t.asc):t.desc&&(i=t.desc),i=E(r,i,e,o),n?t.asc=i:t.desc=i}),t.formula&&(t.formula=A(r,t.formula,e,o)),null!=(i=t.bins)&&i.length&&t.bins.forEach(function(t){t.groupBy=A(r,t.groupBy,e,o)})):t.filter&&t.filter.condition&&(u=b(r,t.filter.condition,n,e,o,!0),t.filter.condition=u))}function E(t,n,i,r){if((n=n.trim()).startsWith("=")){var e=n.substring(1);if(!u.test(e))return A(t,n,i,r)}else if(n.toUpperCase()===i)return r}function A(t,n,i,r){var e,o,u,e=D(t,n),o=new RegExp("\\[@?".concat(i,"\\]"),"i"),u=new RegExp("".concat(i),"i");return e.forEachNodes(function(t){t.type===c.ExpressionType.name&&t.value.match(o)&&(t.value=t.value.replace(u,r))}),(n.startsWith("=")?"=":"")+(0,f.expressionToFormula)(t,e)}function D(t,n){return t.Lp.parse(t.qgt,n,0,0)}function b(i,r,e,o,u,s){var t=T(i,r,e,o,u,s);return r.and&&r.and.forEach(function(t,n){var t=b(i,t,e,o,u,s);r.and[n]=t}),r.or&&r.or.forEach(function(t,n){var t=b(i,t,e,o,u,s);r.or[n]=t}),t}function T(t,n,i,r,e,o){var i,u,u,u=n&&n.dataColumn;return u&&u.tableName.toUpperCase()===i&&u.columnName.toUpperCase()===r&&(n.dataColumn.columnName=e),o||("string"==typeof n?n=A(t,n,r,e):(null==(i=null==n?void 0:n.column)?void 0:i.toUpperCase())===r&&(n.column=e),(u=n)&&"string"==typeof u.formula&&(u.formula=A(t,u.formula,r,e))),n}function O(t,n,i){m(t,n,i),t.and&&t.and.forEach(function(t){O(t,n,i)}),t.or&&t.or.forEach(function(t){O(t,n,i)})}function m(t,n,i){var r;t&&(null==(r=t.dataColumn)?void 0:r.tableName.toUpperCase())===n&&(t.dataColumn.tableName=i)}function S(t,n,i){var n,t,r,e,r=null==n?void 0:n.Lp;r&&((e=o(o([],y(t),!0),[t.Uw(),t.T3,t.A3],!1)).forEach(function(t){t&&r.removeSource(t)}),null!=(t=null==(n=r.MX)?void 0:n.asyncManager))&&t.clearNodesByName(i)}function y(t){var n={calcSources:[]};return l.Worksheet.et(t,"getRelatedCalcSources",n),n.calcSources}function R(t,n,i,r){var e,o,u,s,c,f,h,e=i.getViewportTopRow(1),o=i.getViewportBottomRow(1),u=i.getViewportLeftColumn(1),s=i.getViewportRightColumn(1);!r||(n<u||s<n)&&(t<e||o<t)||("H"===r.cellNode.templateCell.expansionDirection?(n<u||s<n)&&(f=i.ly,i.showColumn(n,l.HorizontalPosition.left),i.scroll(0-f,0)):(t<e||o<t)&&(f=i.my,i.showRow(t,l.VerticalPosition.top),i.scroll(0,0-f)))}function L(t,n,i,r){var e,o;t.dataCharts&&((e=P(t.getTemplateCell(n,i)))!==(o=P(r))&&(e&&k(t,e),o)&&B(t,o),G(t,o,z(r),n,i))}function P(t){return t&&"Chart"===t.type?t.dataChartName:""}function z(t){return!(!t||"Chart"!==t.type)&&t.chartPreviewVisible}function B(t,n){var t,t,t=null==(t=t.dataCharts)?void 0:t.get(n);t&&t.isVisible(!1)}function G(t,n,i,r,e){var o,t,o,n,e,o=null==(o=t.dataCharts)?void 0:o.get(n);o&&(o.isVisible(i),n=U(t,0,e),e=i?x(t,0,r+1)+4:x(t,0,r),o.x(n),o.y(e),i?o.dynamicSize(o.tIr):(o.tIr=null!=(t=o.dynamicSize())&&t,o.dynamicSize(!1)))}function k(t,n){var t,t,t=null==(t=t.dataCharts)?void 0:t.get(n);t&&t.isVisible(!0)}function U(t,n,i){for(var r,e,r=0,e=n;e<i;e++)r+=t.getColumnWidth(e);return r}function x(t,n,i){for(var r,e,r=0,e=n;e<i;e++)r+=t.getRowHeight(e);return r}o=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.eMr=t.hMr=t.showCellInViewport=t.wir=t.Gir=t.Bir=t.tzr=t._ir=t.xir=t.ehr=t.rhr=t.Qtr=t.Htr=t.Wtr=t.Vtr=void 0,l=n("Core"),i=n("./dist/plugins/report/resources/index.js"),s=n("./dist/plugins/report/utils/utils.js"),c=n("CalcEngine"),f=n("SheetsCalc"),t.Vtr=r,t.Wtr=h,t.Htr=a,t.Qtr=v,e=i.rm.getResource.bind(i.rm),t.rhr=d,t.ehr=p,t.xir=M,t._ir=w,t.tzr=I,t.Bir=g,t.Gir=C,u=/^([A-Z]+)(\d+)$/,t.wir=S,t.showCellInViewport=R,t.hMr=L,t.eMr=P},"./node_modules_local/@spreadjs/js-report/dist/gc.report.js":function(t,n){var i,n,o,r;!function(){"use strict";var r,e,t,r={8346:function(t,n){var i,r;function e(t,n,i,r){this.reset(t,n,i,r)}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.SmartCache=void 0,e.prototype.get=function(t,n){var t=t-this.Dyt;if(this.cE[t])return this.cE[t][n-this._yt]},e.prototype.set=function(t,n,i){var r=t-this.Dyt;this.cE[r]||(0<this.Tx?this.cE[r]=new Array(this.Tx):this.cE[r]=[]),t>this.Z5.rowEnd&&(this.Z5.rowEnd=t),n>this.Z5.colEnd&&(this.Z5.colEnd=n),this.cE[r][n-this._yt]=i},e.prototype.getRange=function(){return i({},this.Z5)},e.prototype.reset=function(t,n,i,r){this.cE=0<i?new Array(i-t+1):[],this.Tx=r-n,this.Dyt=t,this._yt=n,this.Z5={row:t,col:n,rowEnd:i,colEnd:r}},n.SmartCache=e},7789:function(t,n){var e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))};function i(t){for(var n=-1,i=1,r="A".charCodeAt(0)-1,e=t.length-1;0<=e;e--)n+=(t.charCodeAt(e)-r)*i,i*=26;return n}function o(t,n,i){var r=e(e([],i=void 0===i?[]:i,!0),[t],!1);0<t.children.length?t.children.forEach(function(t){return o(t,n,r)}):n.push(r)}Object.defineProperty(n,"__esModule",{value:!0}),n.H4i=n.Q1e=n.cellNameReg=n.kOi=void 0,n.kOi=function(t){t=(t||"").replace("=","").trim().toUpperCase();var t=n.cellNameReg.exec(t);return t?{row:parseInt(t[2],10)-1,col:i(t[1])}:null},n.cellNameReg=/^([A-Z]+)([0-9]+)$/,n.Q1e=function(t){var n=[];return o(t,n),n},n.H4i=function n(t,i){i(t)||t.children.forEach(function(t){return n(t,i)})}},3607:function(t,n,i){var r,e,o,u,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),n.ParentChildTreeGenerator=n.ReportEngine=void 0,o=i(6401),Object.defineProperty(n,"ReportEngine",{enumerable:!0,get:function(){return o.ReportEngine}}),u=i(9034),Object.defineProperty(n,"ParentChildTreeGenerator",{enumerable:!0,get:function(){return u.ParentChildTreeGenerator}}),e(i(1129),n),e(i(6546),n),e(i(7770),n),e(i(9876),n),e(i(4869),n),e(i(6807),n),e(i(1422),n)},7770:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},4869:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},6807:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},9876:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},1129:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},6546:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},1422:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},9089:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.CellNodeFinder=void 0;var e=i(8346),o=i(7789),u=i(391),r;function s(t,n){void 0===n&&(n=null),this.s_i=t,this.Z4i=n,this.d4i=null!==this.Z4i?this.Z4i.getTemplateRange():this.s_i.getRange();var t=this.d4i,n=t.row,i=t.col,r=t.rowEnd,t=t.colEnd;this.V4i=new e.SmartCache(n,i,r,t)}s.prototype.Q4i=function(t){var n,i,r,e,n;if((0,u.Y4i)(t.templateCell.leftParent)){if((n=this.V4i.get(t.templateCell.row,t.templateCell.col))&&void 0!==n.leftParent)return n.leftParent;for(i=[],r=t.templateCell.col-1;r>=this.d4i.col;r--)if(e=this.W4i(t.templateCell.row,r)){if((0,u.F4i)(e.templateCell.leftParent)&&(r=-1),this.J4i(e))return this.K4i(i,e,"left"),e;(0,u.Y4i)(e.templateCell.leftParent)&&(0,u.e5t)(e)&&e.templateCell.col===r&&i.push({row:t.templateCell.row,col:r})}this.K4i(i,null,"left")}else if(!(0,u.F4i)(t.templateCell.leftParent)&&(n=(0,o.kOi)(t.templateCell.leftParent))&&(e=this.W4i(n.row,n.col,this.X4i(n.row,n.col)))&&e!==t)return e;return null},s.prototype.$4i=function(t){var n,i,r,e,n;if((0,u.Y4i)(t.templateCell.upParent)){if((n=this.V4i.get(t.templateCell.row,t.templateCell.col))&&void 0!==n.upParent)return n.upParent;for(i=[],r=t.templateCell.row-1;r>=this.d4i.row;r--)if(e=this.W4i(r,t.templateCell.col)){if((0,u.F4i)(e.templateCell.upParent)&&(r=-1),this.q4i(e))return this.K4i(i,e,"up"),e;(0,u.Y4i)(e.templateCell.upParent)&&(0,u.e5t)(e)&&e.templateCell.row===r&&i.push({row:r,col:t.templateCell.col})}this.K4i(i,null,"up")}else if(!(0,u.F4i)(t.templateCell.upParent)&&(n=(0,o.kOi)(t.templateCell.upParent))&&(e=this.W4i(n.row,n.col,this.X4i(n.row,n.col)))&&e!==t)return e;return null},s.prototype.W4i=function(t,n,i){var r=this.s_i.get(t,n);return r||(r=this.tSi(t,n,i),this.nSi(r)),r},s.prototype.nSi=function(t){var n,i,r,e;if(t)for(n=t.templateCell.rowEnd,i=t.templateCell.colEnd,r=t.templateCell.row;r<=n;r++)for(e=t.templateCell.col;e<=i;e++)this.s_i.set(r,e,t)},s.prototype.tSi=function(t,n,i){var r,n,i,t,e,o,u,n,r=this.Z4i.getTemplateCell(t,n);if(!r){if(!i)return null;r={row:t,col:n,rowEnd:t,colEnd:n,value:void 0,formula:void 0,isEmpty:!0,isRowHeightChanged:!1,isColWidthChanged:!1,leftParent:"Default",upParent:"Default",expansionDirection:"No",filter:null,hExpansible:!0,vExpansible:!0}}return t=i=!1,(n=this.Z4i.getTemplatePaginationSetting())&&(e=n.titleRows,o=n.endRows,u=n.titleCols,n=n.endCols,i=e&&r.row>=e[0]&&r.row<=e[e.length-1]||o&&r.row>=o[0]&&r.row<=o[o.length-1],t=u&&r.col>=u[0]&&r.col<=u[u.length-1]||n&&r.col>=n[0]&&r.col<=n[n.length-1]),{templateCell:r,treeRange:{row:r.row,col:r.col,rowEnd:r.rowEnd,colEnd:r.colEnd},children:[],leftParent:null,upParent:null,data:{groups:[]},indexOfLeftParentChildren:-1,indexOfUpParentChildren:-1,isInTitleRowOrEndRow:i,isInTitleColOrEndCol:t}},s.prototype.J4i=function(t){var t=t.templateCell;return"V"===t.expansionDirection&&(t.dataColumn||t.formula)&&(!t.dataSetting||"Summary"!==t.dataSetting.type)},s.prototype.q4i=function(t){var t=t.templateCell;return"H"===t.expansionDirection&&(t.dataColumn||t.formula)&&(!t.dataSetting||"Summary"!==t.dataSetting.type)},s.prototype.X4i=function(t,n){return t>=this.d4i.row&&t<=this.d4i.rowEnd&&n>=this.d4i.col&&n<=this.d4i.colEnd},s.prototype.K4i=function(t,r,e){var o=this;t.forEach(function(t){var n=t.row,t=t.col,i=o.V4i.get(n,t);i||o.V4i.set(n,t,i={}),"left"===e?i.leftParent=r:i.upParent=r})},n.CellNodeFinder=s},9034:function(t,n,i){var e,o,h,u,l,r;function s(t){this.Z4i=t}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ParentChildTreeGenerator=void 0,o=i(8346),h=i(7789),u=i(9089),l=i(391),s.prototype.process=function(t){var n,i,r,e,o,u,o;if(void 0===t&&(t=!1),performance.now(),!this.Z4i)return null;if(this.d4i=this.Z4i.getTemplateRange(),!this.d4i)return null;for(this.iSi(),this.rSi(),n=this.eSi(),i=this.d4i.rowEnd;i>=this.d4i.row;i--)for(r=this.d4i.colEnd;r>=this.d4i.col;r--)(e=this.oSi.W4i(i,r))&&e.templateCell.row===i&&e.templateCell.col===r&&(this.uSi(n,e),this.sSi(e),(0,l.e5t)(e))&&(u=(o=this.cSi(e)).leftParent,o=o.upParent,(u||o)&&this.fSi(u,o,e)?(this.hSi(u,n),this.hSi(o,n),u&&o&&n.crossCells.unshift(e)):this.aSi(n,e));return this.lSi(n),t||(0,l.fir)(n),this.Cnr(n),this.dSi(n),this.pSi(),performance.now(),n},s.prototype.iSi=function(){var t=this.d4i,n=t.row,i=t.col,r=t.rowEnd,t=t.colEnd;this.s_i=new o.SmartCache(n,i,r,t),this.xnr=new o.SmartCache(n,i,r,t),this.oSi=new u.CellNodeFinder(this.s_i,this.Z4i),this.wSi=[],this.gSi=[],this.MSi=[],this.jSi=[]},s.prototype.eSi=function(){return{verticalExpansionTrees:[],horizontalExpansionTrees:[],crossCells:[],cellNodeCache:this.s_i,templateResolver:this.Z4i,colOffsetClearCache:this.wSi,rowOffsetClearCache:this.gSi,paginateBeforeRowCache:{},paginateAfterRowCache:{},paginateBeforeColumnCache:{},paginateAfterColumnCache:{},canNotBreakCells:[]}},s.prototype.rSi=function(){for(var t,n,i,r,e,r,t=this.d4i.row;t<=this.d4i.rowEnd;t++)for(n=this.d4i.col;n<=this.d4i.colEnd;n++)(i=this.oSi.W4i(t,n))&&i.templateCell.row===t&&i.templateCell.col===n&&(0,l.e5t)(i)&&((0,l.CSi)(i.templateCell.leftParent)||(0,l.CSi)(i.templateCell.upParent))&&(e=(r=this.cSi(i)).leftParent,r=r.upParent,e||r)&&this.fSi(e,r,i)},s.prototype.cSi=function(t){var n=this.oSi.Q4i(t),i=this.oSi.$4i(t);return n&&i&&n===i&&((0,l.Y4i)(t.templateCell.upParent)?i=null:n=null),{leftParent:n,upParent:i}},s.prototype.aSi=function(t,n){"V"===n.templateCell.expansionDirection?t.verticalExpansionTrees.unshift(this.mSi(n)):"H"===n.templateCell.expansionDirection?t.horizontalExpansionTrees.unshift(this.mSi(n)):n.templateCell.dataColumn&&t.verticalExpansionTrees.unshift(this.mSi(n))},s.prototype.lSi=function(t){var f=this;t.verticalExpansionTrees.forEach(function(t){var t,n,i,r,e,n,o,i,u,s,c,t=t.root,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;for(f.xnr.reset(i,r,e,n),i=(o=(0,h.Q1e)(t).sort(function(t,n){return n.length-t.length}))[0].length,u=[],s=function(n){o.forEach(function(t){t[n]&&!u.includes(t[n])&&f.NSi(t[n])})},c=i-2;0<=c;c--)s(c)}),t.horizontalExpansionTrees.forEach(function(t){var t,n,i,r,e,n,o,i,u,s,c,t=t.root,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;for(f.xnr.reset(i,r,e,n),i=(o=(0,h.Q1e)(t).sort(function(t,n){return n.length-t.length}))[0].length,u=[],s=function(n){o.forEach(function(t){t[n]&&!u.includes(t[n])&&f.bSi(t[n])})},c=i-2;0<=c;c--)s(c)}),t.verticalExpansionTrees=t.verticalExpansionTrees.filter(function(t){return!t.root.leftParent&&!t.root.upParent}),t.horizontalExpansionTrees=t.horizontalExpansionTrees.filter(function(t){return!t.root.leftParent&&!t.root.upParent})},s.prototype.NSi=function(t){for(var n,i,r,e,o,u,s,c,f,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,u=!1,s=i;s<=e;s++)for(c=r;c<=o;c++)!(f=this.oSi.W4i(s,c))||f===t||this.xnr.get(f.templateCell.row,f.templateCell.col)||f.templateCell.row<i||f.templateCell.col<r||f.templateCell.isEmpty&&this.OSi(f)||(0,l.F4i)(f.templateCell.leftParent)||!f||f.leftParent||f.upParent||(this.fSi(t,null,f)?u=!0:this.xnr.set(f.templateCell.row,f.templateCell.col,!0));u&&this.NSi(t)},s.prototype.bSi=function(t){for(var n,i,r,e,o,u,s,c,f,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,u=!1,s=i;s<=e;s++)for(c=r;c<=o;c++)!(f=this.oSi.W4i(s,c))||f===t||this.xnr.get(f.templateCell.row,f.templateCell.col)||f.templateCell.row<i||f.templateCell.col<r||f.templateCell.isEmpty&&this.OSi(f)||(0,l.F4i)(f.templateCell.upParent)||!f||f.upParent||f.leftParent||(this.fSi(null,t,f)?u=!0:this.xnr.set(f.templateCell.row,f.templateCell.col,!0));u&&this.bSi(t)},s.prototype.OSi=function(t){var n,i,r,e,o,n,u,s,c,n,f,h,l,a,v,n=this.d4i,i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,n=t.templateCell,u=n.row,s=n.col,c=n.isRowHeightChanged,n=n.isColWidthChanged;if(!c&&!n)return!0;if(f=this.jSi[u],h=this.MSi[s],c&&!f)for(l=r;l<=o;l++)if((v=this.s_i.get(u,l))&&v!==t&&!v.templateCell.isEmpty){f=!0;break}if(n&&!h)for(a=i;a<=e;a++)if((v=this.s_i.get(a,s))&&v!==t&&!v.templateCell.isEmpty){h=!0;break}return c&&!n?f:(n&&!c||!(!c||!n)&&f)&&h},s.prototype.Cnr=function(t){var t=e(e([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0),r=function(i){i.children.sort(l.ASi),i.children.forEach(function(t,n){t.leftParent===i?t.indexOfLeftParentChildren=n:t.indexOfUpParentChildren=n,r(t)})};t.forEach(function(t){return r(t.root)})},s.prototype.ISi=function(t){var t=t.templateCell,n=t.row,t=t.col;this.jSi[n]||(this.jSi[n]=!0),this.MSi[t]||(this.MSi[t]=!0)},s.prototype.dSi=function(t){var n=t.crossCells;e(e([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0).forEach(function(t){t.pathArray=(0,h.Q1e)(t.root),t.crossCells=n.filter(function(n){return t.pathArray.find(function(t){return t.find(function(t){return t===n})})})})},s.prototype.mSi=function(t){return this.ISi(t),{root:t,pattern:"Unanalyzed",pathArray:null,crossCells:[]}},s.prototype.fSi=function(t,n,i){return this._Si=i,t&&i&&!t.children.includes(i)&&(t.children.unshift(i),i.leftParent=t),n&&i&&!n.children.includes(i)&&(n.children.unshift(i),i.upParent=n),this.DSi(i,!0)?(this.DSi(i,!1),this.ISi(i),!0):(t&&i&&t.children.includes(i)&&(t.children=t.children.filter(function(t){return t!==i}),i.leftParent=null),n&&i&&n.children.includes(i)&&(n.children=n.children.filter(function(t){return t!==i}),i.upParent=null),!1)},s.prototype.DSi=function(t,n,i){void 0===i&&(i=[]);var r=t.leftParent,e=t.upParent,o=!0;return!r||this.TSi(t,r,i,n)||(o=!1),o=!e||this.TSi(t,e,i,n)?o:!1},s.prototype.TSi=function(t,n,i,r){var e=!0;if(n){if(r||(t.treeRange.row<n.treeRange.row&&(n.treeRange.row=t.treeRange.row),t.treeRange.col<n.treeRange.col&&(n.treeRange.col=t.treeRange.col),t.treeRange.rowEnd>n.treeRange.rowEnd&&(n.treeRange.rowEnd=t.treeRange.rowEnd),t.treeRange.colEnd>n.treeRange.colEnd&&(n.treeRange.colEnd=t.treeRange.colEnd)),n===this._Si&&i.includes(n))return!1;i.unshift(n),e=this.DSi(n,r,i)}return e},s.prototype.hSi=function(n,t){var i,r;n&&!n.templateCell.dataColumn&&"No"===n.templateCell.expansionDirection&&(i=this.oSi.Q4i(n),r=this.oSi.$4i(n),i||r||t.verticalExpansionTrees.find(function(t){return t.root===n})||t.verticalExpansionTrees.unshift(this.mSi(n)))},s.prototype.uSi=function(t,n){var i,r,e,o,u,s,c,i=n.templateCell,r=i.row,e=i.col,o=i.rowEnd,u=i.colEnd;if(n.templateCell.paginateBeforeRow)for(s=r;s<=o;s++)t.paginateBeforeRowCache[s]||(t.paginateBeforeRowCache[s]={}),t.paginateBeforeRowCache[s][e]=!0;if(n.templateCell.paginateAfterRow)for(s=r;s<=o;s++)t.paginateAfterRowCache[s]||(t.paginateAfterRowCache[s]={}),t.paginateAfterRowCache[s][e]=!0;if(n.templateCell.paginateBeforeColumn)for(c=e;c<=u;c++)t.paginateBeforeColumnCache[c]||(t.paginateBeforeColumnCache[c]={}),t.paginateBeforeColumnCache[c][r]=!0;if(n.templateCell.paginateAfterColumn)for(c=e;c<=u;c++)t.paginateAfterColumnCache[c]||(t.paginateAfterColumnCache[c]={}),t.paginateAfterColumnCache[c][r]=!0;n.templateCell.canBreakWhenPaging||t.canNotBreakCells.includes(n)||t.canNotBreakCells.unshift(n)},s.prototype.sSi=function(t){var t,n,i,r,e,o,t,u,s,c,f,t=t.templateCell,n=t.row,i=t.col,r=t.rowEnd,e=t.colEnd,o=t.clearColOffset,t=t.clearRowOffset;if(o)for(u=i;u<=e;u++)for((s=this.wSi[u])||(this.wSi[u]=s=[]),c=n;c<=r;c++)s.push(c);if(t)for(c=n;c<=r;c++)for((f=this.gSi[c])||(this.gSi[c]=f=[]),u=i;u<=e;u++)f.push(u)},s.prototype.pSi=function(){var o=this,t=this.d4i,u=t.row,s=t.col,c=t.rowEnd,f=t.colEnd;Object.keys(this.wSi).forEach(function(t){var t=parseInt(t,10),n=o.wSi[t];n&&(o.wSi[t]=n.filter(function(t){for(var n,i,i,r,e,i,n=s;n<=f;n++)if(i=o.s_i.get(t,n)){if(i.leftParent||i.upParent)return!1;if(r=(i=i.templateCell).dataColumn,e=i.expansionDirection,i=i.formula,"No"!==e&&(r||i))return!1}return!0}))}),Object.keys(this.gSi).forEach(function(t){var t=parseInt(t,10),n=o.gSi[t];n&&(o.gSi[t]=n.filter(function(t){for(var n,i,i,r,e,i,n=u;n<=c;n++)if(i=o.s_i.get(n,t)){if(i.leftParent||i.upParent)return!1;if(r=(i=i.templateCell).dataColumn,e=i.expansionDirection,i=i.formula,"No"!==e&&(r||i))return!1}return!0}))})},n.ParentChildTreeGenerator=s},391:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.fir=n.e5t=n.ASi=n.CSi=n.F4i=n.Y4i=void 0;var o=i(7789);function r(t){return"DEFAULT"===(t||"").toUpperCase()}function e(t){return"NONE"===(t||"").toUpperCase()}function s(t){var e=[];return t.forEach(function(t){return t=t,n=[],((i=(0,o.Q1e)(t.root)).some(function(t){return t.some(function(t){return(t.templateCell.dataColumn||t.templateCell.formula)&&("No"!==t.templateCell.expansionDirection||0<Object.values(t.templateCell.filter||{}).length)})})?[t]:(i.some(function(t){return t.some(function(t){return t.templateCell.dataColumn||t.templateCell.formula})})&&(0,o.H4i)(t.root,function(t){(t.templateCell.dataColumn||t.templateCell.formula)&&n.push({root:t,pattern:"Unanalyzed",pathArray:null,crossCells:[]})}),r=[],i.forEach(function(t){return t.forEach(function(t){r.includes(t)||(r.push(t),t.children=[],t.leftParent=null,t.upParent=null,t.indexOfLeftParentChildren=-1,t.indexOfUpParentChildren=-1)})}),n)).forEach(function(t){return e.push(t)});var t,n,i,r}),e}n.Y4i=r,n.F4i=e,n.CSi=function(t){return!e(t)&&!r(t)},n.ASi=function(t,n){return t.templateCell.row<n.templateCell.row?-1:t.templateCell.row>n.templateCell.row?1:t.templateCell.col<n.templateCell.col?-1:t.templateCell.col>n.templateCell.col?1:0},n.e5t=function(t){var t;return!(!t||!(t=t.templateCell).dataColumn&&t.isEmpty)},n.fir=function(t){var n,n,r,e,o,u;r=(n=t).crossCells,e=[],o=function(n){n.upParent&&(n.upParent.children=n.upParent.children.filter(function(t){return t!==n}),n.upParent=null)},u=function(n){n.leftParent&&(n.leftParent.children=n.leftParent.children.filter(function(t){return t!==n}),n.leftParent=null)},r.forEach(function(t){for(var n,i,n=t.leftParent;n;){if(r.includes(n))return void o(t);n=n.leftParent}for(i=t.upParent;i;){if(r.includes(i))return void u(t);i=i.upParent}t.leftParent.upParent!==t.upParent?t.upParent.leftParent!==t.leftParent?e.push(t):u(t):o(t)}),n.crossCells=e,(n=t).verticalExpansionTrees=s(n.verticalExpansionTrees),n.horizontalExpansionTrees=s(n.horizontalExpansionTrees)}},4568:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryService=void 0;var e=i(1633),o=i(9036),u=i(8974),s=i(8334),c=i(7680),r;function f(t,n,i){var r=t.SSi().templateResolver.getTemplateDataCollectionSetting();this.xSi=new u.GroupsCache(r),this.ESi=new e.AddRecordHelper(t,n,this.xSi),this.zSi=new o.DeleteRecordHelper(t,r,n),this.PSi=new s.UpdateRecordHelper(n,this.xSi),this.LSi=new c.DataCollectionHelper(this.zSi.kSi(),t.SSi(),r,i,n)}f.prototype.addRecord=function(t,n){return this.ESi.sOi(t,n)},f.prototype.deleteRecord=function(t,n){return this.zSi.cOi(t,n)},f.prototype.updateCellValue=function(t,n,i){return this.PSi.uOi(t,n,i)},f.prototype.resetCellsStateToNormal=function(t,n){performance.now(),this.xSi.RSi(t,function(t){t.isNew=!1,t.state="normal"}),this.zSi.dl(n),performance.now()},f.prototype.getDataCollectionResults=function(){return this.LSi.fOi()},f.prototype.isDirty=function(){var t,n,i,r,t=this.getDataCollectionResults();if(0!==t.length)for(n=0;n<t.length;n++)if("Smart"===(i=t[n]).dataCollectionSetting.type){if(0<i.deletedRecords.length||0<i.records.length)return!0}else if(0<i.records.length)return!0;return!1},n.DataEntryService=f},1633:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AddRecordHelper=void 0;var r=i(5443),s=i(1453),e;function o(t,n,i){this.GSi=t,this.BSi=n,this.xSi=i}o.prototype.sOi=function(t,n){var i,t,n,i={success:!1,nextActiveCell:null},t=this.BSi.get(t,n);return this.USi(i,t)&&(performance.now(),n=this.HSi(t),performance.now(),this.GSi.ZSi(),i.success=!0,i.nextActiveCell=n.dataCell),i},o.prototype.USi=function(t,n){var n;return n?(n=n.cellNode.templateCell).dataColumn&&n.dataColumn.tableName&&n.dataColumn.columnName?"No"===n.expansionDirection&&(t.error=r.DataEntryErrorCreator.cellIsNonExpansible()):t.error=r.DataEntryErrorCreator.noDataBindingCellNotSupportThisAction():t.error=r.DataEntryErrorCreator.invalidCellRowCol(),!t.error},o.prototype.HSi=function(t){var t=(0,s.VSi)(t.group)||t.group,n=this.QSi(t);return(0,s.YSi)(t.cellNode.data.groups,t,n),this.WSi(n,t.dataCell),this.FSi(n),n},o.prototype.WSi=function(t,n){var i,r,e,o,e,u,i=t.leftParent,r=t.upParent,e=t.cellNode,o=e.indexOfLeftParentChildren,e=e.indexOfUpParentChildren;i&&r?(u=i.crossChildren[o].find(function(t){return t.includes(n.group)}),(0,s.YSi)(u,n.group,t)):(i&&(0,s.YSi)(i.childrenArray[o],n.group,t),r&&(0,s.YSi)(r.childrenArray[e],n.group,t))},o.prototype.FSi=function(t){this.JSi(t)},o.prototype.JSi=function(n){var i=this;n.cellNode.children.forEach(function(t){var t;t.leftParent&&t.upParent?"V"===n.cellNode.templateCell.expansionDirection?i.KSi(t,n):i.XSi(t,n):(t=i.$Si(t,n),i.JSi(t))})},o.prototype.KSi=function(r,e){var o=this,t=this.qSi(r.upParent,e),u=[];t.forEach(function(t){var n,i,n=o.txi(r);n.leftParent=e,n.upParent=t,i=[n],u.push(i),t.crossChildren[r.indexOfUpParentChildren].push(i),r.children.forEach(function(t){return o.nxi(t,n)})}),e.crossChildren[r.indexOfLeftParentChildren]=u},o.prototype.XSi=function(r,e){var o=this,t=this.qSi(r.leftParent,e),u=[];t.forEach(function(t){var n,i,n=o.txi(r);n.upParent=e,n.leftParent=t,i=[n],u.push(i),t.crossChildren[r.indexOfLeftParentChildren].push(i),r.children.forEach(function(t){return o.nxi(t,n)})}),e.crossChildren[r.indexOfUpParentChildren]=u},o.prototype.qSi=function(t,n){var i,r,e,o,i=this,r=t.data.groups,e=[];return this.ixi(n,e),r=0<e.length&&(o=this.rxi(t,e))?r.filter(function(t){return i.exi(t,o)}):r},o.prototype.nxi=function(t,n){var i=this,r=this.$Si(t,n);t.children.forEach(function(t){return i.nxi(t,r)})},o.prototype.$Si=function(t,n){var i=this.txi(t);return(t.leftParent?(i.leftParent=n).childrenArray[t.indexOfLeftParentChildren]:(i.upParent=n).childrenArray[t.indexOfUpParentChildren]).push(i),i},o.prototype.QSi=function(t){var t=(0,s.QSi)(t,this.oxi(t.cellNode));return this.xSi.ZP(t),t},o.prototype.oxi=function(t){var n,t,t,n={value:void 0,formula:void 0},t=t.templateCell.newRecordDefaultValueGenerator;return"function"==typeof t&&((t=t())&&"object"==typeof t&&Object.keys(t).includes("formula")?n.formula=t.formula:n.value=t),n},o.prototype.txi=function(t){var t=(0,s.uxi)(t,this.oxi(t));return this.xSi.ZP(t),t.cellNode.data.groups.push(t),t},o.prototype.ixi=function(t,n){t.leftParent&&(n.push(t.leftParent),this.ixi(t.leftParent,n)),t.upParent&&(n.push(t.upParent),this.ixi(t.upParent,n))},o.prototype.rxi=function(n,t){var i,i,i,i=t.find(function(t){return t.cellNode===n});return i||(n.leftParent&&(i=this.rxi(n.leftParent,t))?i:n.upParent&&(i=this.rxi(n.upParent,t))?i:null)},o.prototype.exi=function(t,n){return t===n||!(!t.leftParent||!this.exi(t.leftParent,n))||!(!t.upParent||!this.exi(t.upParent,n))},n.AddRecordHelper=o},7680:function(t,n,i){var v,o,d,u,e,s,r;function c(t,n,i,r,e){this.sxi=t,this.cxi=o(o([],n.verticalExpansionTrees,!0),n.horizontalExpansionTrees,!0),this.Z4i=n.templateResolver,this.fxi=i,this.BSi=n.cellNodeCache,this.z3i=r,this.twr=e}v=this&&this.__assign||function(){return(v=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},o=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.DataCollectionHelper=void 0,d=i(7789),u=i(1589),e=i(1453),s=i(5041),c.prototype.fOi=function(){var n=this;return this.fxi&&this.fxi.dataCollections?this.fxi.dataCollections.map(function(t){return n.hxi(t)}):[]},c.prototype.hxi=function(t){switch(t.type){case"Smart":return this.axi(t);case"Delete":return this.lxi(t);case"Insert":return this.vxi(t);case"Update":return this.dxi(t);default:return null}},c.prototype.axi=function(n){var t,i=this.pxi(n),t=this.sxi.find(function(t){return t.setting===n});return this.wxi(t,i),{dataCollectionSetting:n,deletedRecords:null!=(t=null==t?void 0:t.records)?t:[],records:i,type:"Smart"}},c.prototype.lxi=function(t){return{dataCollectionSetting:t,records:this.gxi(t),type:"Delete"}},c.prototype.vxi=function(t){return{dataCollectionSetting:t,records:this.gxi(t),type:"Insert"}},c.prototype.dxi=function(t){return{dataCollectionSetting:t,records:this.pxi(t),type:"Update"}},c.prototype.pxi=function(t){var n=this.Mxi(t),n=this.jxi(n);return this.Cxi(n,t.ignoreContainsEmptyValueRecord,t.ignoreNonUpdatedCell,t.allowEmptyKey)},c.prototype.gxi=function(t){var n=this.Mxi(t),n=this.jxi(n);return this.Cxi(n,t.ignoreContainsEmptyValueRecord)},c.prototype.Mxi=function(t){var h=this,l=[],a=[];return t.fields.forEach(function(t){var t,n;"Formula"!==t.type&&("CellGroup"===t.type?l.push(v(v({},t),{rowCols:t.cellNames.map(function(t){return(0,d.kOi)(t)})})):(l.push("Cell"===t.type?v(v({},t),(0,d.kOi)(t.cellName)):v({},t)),"Cell"===t.type&&(n=h.BSi.get((t=l[l.length-1]).row,t.col),a.push({trees:h.cxi.filter(function(t){return h.mxi(t,n)}),node:n}))))}),t.fields.forEach(function(t){var c,t,f;"Formula"===t.type&&(c=v(v({},t),{allDepRowCols:[]}),l.push(c),t=h.Z4i.getCellNamesInFormula(t.formula))&&0<t.length&&(f=-1,t.forEach(function(n){var t,i,r,e,t,o,u,u,s,t=(0,d.kOi)(n),i=h.BSi.get(t.row,t.col);i&&(c.allDepRowCols.push(t),r=h.cxi.find(function(t){return h.mxi(t,i)}))&&((e=l.find(function(t){return"Cell"===t.type&&t.cellName===n}))||(e=v({type:"Cell",cellName:n,dbColumnName:"n".concat((new Date).getTime()).concat(Math.floor(1e9*Math.random())),isAutoGeneratedFromFormula:!0},t),l.push(e)),t=0,t=(o=a.find(function(n){return n.trees.some(function(t){return h.Nnr(t,n.node,i)})}))?(u=o.trees.find(function(t){return h.Nnr(t,o.node,i)}),(s=(u=h.Nnr(u,o.node,i)).indexOf(i))>u.indexOf(o.node)?1e4*(s+1):100*(s+1)):h.mxi(r,i).indexOf(i)+1,f<t)&&(f=t,c.calcBaseFieldDbColumnName=e.dbColumnName)}))}),l},c.prototype.wxi=function(t,i){var r;t&&(r=t.primaryFields.map(function(t){return t.dbColumnName}),t.records=t.records.filter(function(n){return!i.some(function(t){return(0,e.Nxi)(n.entity,t.entity,r)})}))},c.prototype.jxi=function(t){for(var r,n,i,e,o,u,s,c,f,h,l,a,v,a,r=this,n=t.filter(function(t){return"Formula"===t.type}),i=t.filter(function(t){return t&&"Formula"!==t.type&&"Cell"!==t.type&&"CellGroup"!==t.type}),e=t.filter(function(t){return"CellGroup"===t.type}),o=t.filter(function(t){return"Cell"===t.type}),u=[];0===e.length&&0<o.length;){if(!(s=o.find(function(t){var t=r.BSi.get(t.row,t.col);return t.leftParent&&t.upParent})))for(f=function(t){var t,n,i,i,t=o[t],n=h.BSi.get(t.row,t.col),i=h.cxi.find(function(t){return r.mxi(t,n)});i&&(i=h.mxi(i,n).indexOf(n),c<i)&&(c=i,s=t)},h=this,l=c=0;l<o.length;l++)f(l);s=s||o[0],v=(a=this.bxi(s,o)).entry,a=a.newFields,u.push(v),o=a}return{entries:u,cellFields:t.filter(function(t){return"Cell"===t.type}),cellGroupFields:e,formulaFields:n,valueFields:i,allFields:t}},c.prototype.bxi=function(u,t){var s,c,f,h,l,s=this,c={field:u,routedFields:[]},f=this.BSi.get(u.row,u.col),h=this.cxi.filter(function(t){return s.mxi(t,f)});return 0===h.length?{newFields:t.filter(function(t){return t!==u}),entry:c}:(l=[],t.forEach(function(t){var n,i,r,e,o;if(t!==u)if(n=s.BSi.get(t.row,t.col),(i=h.find(function(t){return s.Nnr(t,n,f)}))&&(r=s.Nnr(i,n,f)))c.routedFields.push({field:t,steps:s.yxi(r,f,r,n)});else{for(e=0;e<h.length;e++)if(o=s.Oxi(h[e],n,f))return void c.routedFields.push({field:t,steps:s.yxi(s.Oxi(h[e],f,n),f,o,n)});l.push(t)}}),{newFields:l,entry:c})},c.prototype.mxi=function(t,n){return t.pathArray.find(function(t){return t.some(function(t){return t===n})})},c.prototype.Nnr=function(t,n,i){return t.pathArray.find(function(t){return t.some(function(t){return t===n})&&t.some(function(t){return t===i})})},c.prototype.Oxi=function(t,n,i){return t.pathArray.find(function(t){return t.some(function(t){return t===i})&&t.some(function(t){return t===n})})||t.pathArray.find(function(t){return t.some(function(t){return t===n})})},c.prototype.yxi=function(t,n,i,r){var e=t===i?Math.min(t.indexOf(n),i.indexOf(r)):(0,u.Ixi)(t,i),t=(0,u._xi)(t,n,e,function(t){return new("left"===t?s.LeftParentStep:s.UpParentStep)}),n=(0,u.Dxi)(i,r,e,function(t,n){return new(t.leftParent&&t.upParent?s.CrossChildStep:s.NormalChildStep)(n)});return o(o([],t,!0),n,!0)},c.prototype.Cxi=function(t,r,e,o){var u,n,i,s,c,f,t,h,l,a,v,d,p,M,u=this,n=t.entries,i=t.cellFields,s=t.cellGroupFields,c=t.formulaFields,f=t.valueFields,t=t.allFields,h=[];return 0<n.length&&(h=this.Axi(n)),0===(h=0<s.length?this.m5i(s):h).length&&(0<c.length||0<f.length)&&h.push({entity:{},info:{}}),h.forEach(function(e){f.forEach(function(t){e.entity[t.dbColumnName]=t.value}),c.forEach(function(t){var n,i,r,n=-1,i=-1;t.calcBaseFieldDbColumnName&&(r=e.info[t.calcBaseFieldDbColumnName])&&(n=r.row,i=r.col,(e.info[t.dbColumnName]=r).depRowCols=[],t.allDepRowCols.forEach(function(t){u.z3i.BEi(t.row,t.col,n,i).forEach(function(t){return r.depRowCols.push({row:t.row,col:t.col})})})),e.entity[t.dbColumnName]=u.Z4i.evaluateFormula(n,i,t.formula)}),0<s.length&&i.forEach(function(t){var n,n,i=u.BSi.get(t.row,t.col);0<(null==(n=null==(n=null==i?void 0:i.data)?void 0:n.groups)?void 0:n.length)&&u.Sxi(e,i.data.groups[0],t)})}),0!==(l=t.filter(function(t){return t.isPrimary})).length||e?(a=[],v=t.filter(function(t){return!("Cell"===t.type&&t.isAutoGeneratedFromFormula)}).map(function(t){return t.dbColumnName}),d=t.filter(function(t){return"Cell"===t.type||"CellGroup"===t.type}).map(function(t){return t.dbColumnName}),p=l.map(function(t){return t.dbColumnName}),M=v.filter(function(t){return!p.includes(t)}),h.forEach(function(i){var n;d.some(function(t){return i.info[t]&&"deleted"===i.info[t].state})||0!==l.length&&(!o&&!p.every(function(t){return void 0!==i.entity[t]&&null!==i.entity[t]&&""!==i.entity[t]})||a.find(function(n){return p.every(function(t){return void 0!==i.entity[t]&&null!==i.entity[t]&&""!==i.entity[t]&&i.entity[t]===n.entity[t]})}))||e&&!d.some(function(t){return i.info[t]&&("updated"===i.info[t].state||"new"===i.info[t].state&&u.twr.get(i.info[t].row,i.info[t].col).group.isNew)})||r&&(o?M:v).some(function(t){return void 0===i.entity[t]||null===i.entity[t]||""===i.entity[t]})||(n={entity:{},info:{}},v.forEach(function(t){n.entity[t]=i.entity[t],n.info[t]=i.info[t]}),a.push(n))}),a):h},c.prototype.Axi=function(t){for(var n=[],i=0;i<t.length;i++)n=this.Txi(t[i],n);return n},c.prototype.Txi=function(t,n){var s=this,i=t.field,r=t.routedFields,e=[];return this.BSi.get(i.row,i.col).data.groups.forEach(function(o){var u={entity:{},info:{}};s.Sxi(u,o,i),r.forEach(function(t){for(var n=t.steps,t=t.field,i=[o],r=o,e=0;e<n.length;e++){if(!(r=n[e]._go(r,i)))return;i.push(r)}s.Sxi(u,r,t)}),0<n.length?n.forEach(function(t){var n=s.Exi(t);Object.keys(u.entity).forEach(function(t){n.entity[t]=u.entity[t],n.info[t]=v({},u.info[t])}),e.push(n)}):e.push(u)}),e},c.prototype.Exi=function(n){var i={entity:{},info:{}};return Object.keys(n.entity).forEach(function(t){i.entity[t]=n.entity[t],i.info[t]=v({},n.info[t])}),i},c.prototype.Sxi=function(t,n,i){var r=n.value,e=n.dataCell,o=e.row,e=e.col,u=n.state,n={oldValue:n.oldValue,state:u,row:o,col:e};t.entity[i.dbColumnName]=r,t.info[i.dbColumnName]=n},c.prototype.m5i=function(t){var e=this,o=t[0].rowCols.map(function(){return{entity:{},info:{}}});return t.forEach(function(r){r.rowCols.forEach(function(t,n){var i,i,t=e.BSi.get(t.row,t.col);0<(null==(i=null==(i=null==t?void 0:t.data)?void 0:i.groups)?void 0:i.length)&&e.Sxi(o[n],t.data.groups[0],r)})}),o},n.DataCollectionHelper=c},5733:function(t,n){var i;function r(t){this.Dnr=t}Object.defineProperty(n,"__esModule",{value:!0}),n.CrossChildStep=void 0,r.prototype._go=function(t,n){for(var i,r,e,o,i=t.crossChildren[this.Dnr],r=n[0],e=0;e<i.length;e++)if((o=i[e][0])&&this.Iwr(o,r)&&this.gwr(o,r))return o;return null},r.prototype.Iwr=function(t,n){for(var i=n.leftParent;i;){if(i===t.leftParent)return!0;i=i.leftParent}return!1},r.prototype.gwr=function(t,n){for(var i=n.upParent;i;){if(i===t.upParent)return!0;i=i.upParent}return!1},n.CrossChildStep=r},5041:function(t,n,i){var r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i(1626),n),e(i(6702),n),e(i(8560),n),e(i(5733),n)},1626:function(t,n){var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.LeftParentStep=void 0,r.prototype._go=function(t){return t.leftParent},n.LeftParentStep=r},8560:function(t,n){var i;function r(t){this.Dnr=t}Object.defineProperty(n,"__esModule",{value:!0}),n.NormalChildStep=void 0,r.prototype._go=function(t){return t.childrenArray[this.Dnr][0]},n.NormalChildStep=r},6702:function(t,n){var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.UpParentStep=void 0,r.prototype._go=function(t){return t.upParent},n.UpParentStep=r},9036:function(t,n,i){var r,e,o,u,s;function c(t,n,i){this.GSi=t,this.BSi=i,this.sxi=n?n.dataCollections.filter(function(t){return"Smart"===t.type&&t.fields.some(function(t){return t.isPrimary})}).map(function(t){return{setting:t,primaryFields:t.fields.filter(function(t){return t.isPrimary&&"CellGroup"!==t.type}).map(function(t){return"Cell"===t.type?r(r({},t),(0,e.kOi)(t.cellName)):r({},t)}),records:[]}}):[],this.Rxi=new Array(this.sxi.length)}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.DeleteRecordHelper=void 0,e=i(7789),o=i(5443),u=i(1453),c.prototype.cOi=function(t,n){var i,t,n,r,r,i={success:!1,nextActiveCell:null},t=this.BSi.get(t,n);return this.Gxi(i,t)&&(performance.now(),n=this.Bxi(t),r=(r=(0,u.VSi)(t.group))?r.dataCell:t,this.Uxi(r),(0,u.Hxi)(r.cellNode)?this.Zxi(r):(this.Vxi(r.cellNode.data.groups,r.group),this.WSi(r),this.FSi(r)),performance.now(),this.GSi.ZSi(),i.success=!0,i.nextActiveCell=null==n?void 0:n.dataCell),i},c.prototype.kSi=function(){return this.sxi},c.prototype.dl=function(i){this.sxi.forEach(function(t){t.records=i&&0<i.length?t.records.filter(function(n){return!i.find(function(t){return(0,u.Rir)(n,t)})}):[]})},c.prototype.Zxi=function(n){var t=n.cellNode,i=[];t.leftParent&&t.upParent?i=n.group.leftParent.crossChildren[t.indexOfLeftParentChildren].find(function(t){return t.includes(n.group)}):t.leftParent?i=n.group.leftParent.childrenArray[t.indexOfLeftParentChildren]:t.upParent&&(i=n.group.upParent.childrenArray[t.indexOfUpParentChildren]),this.Qxi(n.group),1===i.length?this.Yxi(n.group):((0,u.Wxi)(i,n.group),(0,u.Wxi)(n.cellNode.data.groups,n.group)),this.Fxi(n.group)},c.prototype.Fxi=function(i){var r=this;i.childrenArray.forEach(function(t,n){var t;0!==t.length&&(t.forEach(function(t){r.Vxi(t.cellNode.data.groups,t),r.Fxi(t)}),t=t[0],r.Yxi(t),i.childrenArray[n]=[t])})},c.prototype.Bxi=function(n){var t,i;return n.group.leftParent&&n.group.upParent||(t=n.cellNode.data.groups,n.group.leftParent?t=n.group.leftParent.childrenArray[n.cellNode.indexOfLeftParentChildren]:n.group.upParent&&(t=n.group.upParent.childrenArray[n.cellNode.indexOfUpParentChildren]),-1===(i=t.findIndex(function(t){return t===n.group})))||1===t.length?null:0===i?t[i+1]:t[i-1]},c.prototype.WSi=function(t){var n=t.group;n.leftParent&&this.Jxi(t),n.upParent&&this.Kxi(t)},c.prototype.Jxi=function(t){var n=t.group;if(n.leftParent)for(this.Vxi(n.leftParent.childrenArray[n.cellNode.indexOfLeftParentChildren],n);n.leftParent&&(0,u.Xxi)(n.leftParent);)this.Vxi(n.leftParent.cellNode.data.groups,n.leftParent),this.$xi(n.leftParent),this.qxi(n.leftParent),n=n.leftParent},c.prototype.Kxi=function(t){var n=t.group;if(n.upParent)for(this.Vxi(n.upParent.childrenArray[n.cellNode.indexOfUpParentChildren],n);n.upParent&&(0,u.Xxi)(n.upParent);)this.Vxi(n.upParent.cellNode.data.groups,n.upParent),this.$xi(n.upParent),this.tEi(n.upParent),n=n.upParent},c.prototype.FSi=function(t){this.nEi(t.group)},c.prototype.nEi=function(t){this.iEi(t),this.$xi(t)},c.prototype.iEi=function(t){var n=this;t.childrenArray.forEach(function(t){t.forEach(function(t){n.Vxi(t.cellNode.data.groups,t),n.nEi(t)})})},c.prototype.$xi=function(i){var r=this;i.crossChildren.forEach(function(t){t.forEach(function(t){var n=t[0];n&&(t.forEach(function(t){(0,u.Wxi)(n.cellNode.data.groups,t),r.iEi(t)}),n.upParent===i?r.rEi(t):r.eEi(t))})})},c.prototype.rEi=function(t){var n,i,n=t[0];if(n)for(this.oEi(n.leftParent.crossChildren[n.cellNode.indexOfLeftParentChildren],t),i=n.leftParent;i&&(0,u.Xxi)(i);)this.Vxi(i.cellNode.data.groups,i),this.qxi(i),i=i.leftParent},c.prototype.eEi=function(t){var n,i,n=t[0];if(n)for(this.oEi(n.upParent.crossChildren[n.cellNode.indexOfUpParentChildren],t),i=n.upParent;i&&(0,u.Xxi)(i);)this.Vxi(i.cellNode.data.groups,i),this.tEi(i),i=i.upParent},c.prototype.tEi=function(t){var n=t.upParent;n&&this.Vxi(n.childrenArray[t.cellNode.indexOfUpParentChildren],t)},c.prototype.qxi=function(t){var n=t.leftParent;n&&this.Vxi(n.childrenArray[t.cellNode.indexOfLeftParentChildren],t)},c.prototype.Gxi=function(t,n){var n;return n?(n=n.cellNode.templateCell).dataColumn&&n.dataColumn.tableName&&n.dataColumn.columnName||(t.error=o.DataEntryErrorCreator.noDataBindingCellNotSupportThisAction()):t.error=o.DataEntryErrorCreator.invalidCellRowCol(),!t.error},c.prototype.Vxi=function(t,n){this.Qxi(n),(0,u.Wxi)(t,n)},c.prototype.Yxi=function(t){t.oldValue=void 0,t.value=void 0,t.isNew=void 0,t.cached=void 0,t.state="deleted",t.expandedCols=[]},c.prototype.oEi=function(t,n){var i=this;n.forEach(function(t){return i.Qxi(t)}),(0,u.Wxi)(t,n)},c.prototype.Qxi=function(r){var e=this;0<r.cellNode.children.length||r.isNew||this.sxi.forEach(function(t,n){var i;e.Rxi[n]&&(i=(0,u.uEi)(t.primaryFields,r,e.GSi.SSi().cellNodeCache),t.primaryFields.some(function(t){return void 0===i.entity[t.dbColumnName]})||t.records.find(function(t){return(0,u.Nxi)(t.entity,i.entity)})||t.records.push(i))})},c.prototype.Uxi=function(i){var r=this;this.sxi.forEach(function(t,n){r.Rxi[n]=r.sEi(i,t)})},c.prototype.sEi=function(t,n){var i=t.cellNode.templateCell;return!!n.primaryFields.some(function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col})||!!this.cEi(t.cellNode,n.primaryFields)||n.setting.fields.some(function(t){var t,n,t;return"Cell"===t.type&&(n=(t=(0,e.kOi)(t.cellName)).row,t=t.col,i.row===n)&&i.col===t})&&this.fEi(t.cellNode,n.primaryFields)},c.prototype.cEi=function(t,n){var i,r,e,i=t.templateCell,r=n.some(function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col});if(!r)for(e=0;e<t.children.length&&!(r=this.cEi(t.children[e],n));e++);return r},c.prototype.fEi=function(t,n){var i=t.templateCell;return!!n.some(function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col})||!(!t.leftParent||!this.fEi(t.leftParent,n))||!(!t.upParent||!this.fEi(t.upParent,n))},n.DeleteRecordHelper=c},8334:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.UpdateRecordHelper=void 0;var r=i(5443),e;function o(t,n){this.BSi=t,this.xSi=n}o.prototype.uOi=function(t,n,i){var r={success:!1,updatedCell:null},t=this.BSi.get(t,n);return this.hEi(r,t)&&(performance.now(),i!==t.value&&("updated"!==t.group.state&&(t.group.oldValue=t.group.value),t.value=i,t.group.value=i,t.group.oldValue!==i?(t.group.state="updated",this.xSi.ZP(t.group)):(t.group.state=t.group.isNew?"new":"normal",this.xSi.VP(t.group))),performance.now(),r.success=!0,r.updatedCell=t),r},o.prototype.hEi=function(t,n){return n||(t.error=r.DataEntryErrorCreator.invalidCellRowCol()),!t.error},n.UpdateRecordHelper=o},96:function(t,n,i){var r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i(4568),n)},5443:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryErrorCreator=void 0,n.DataEntryErrorCreator={invalidCellRowCol:function(){return{code:"InvalidCellRowCol",message:"Invalid cell row, col."}},cellIsNonExpansible:function(){return{code:"CellIsNonExpansible",message:"Cell is non-expansible."}},noDataBindingCellNotSupportThisAction:function(){return{code:"noDataBindingCellNotSupportThisAction",message:"No data binding cell not support this action."}},crossCellNotSupportThisAction:function(){return{code:"crossCellNotSupportThisAction",message:"Cross cell not support this action."}}}},8974:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.GroupsCache=void 0;var h=i(7789),r;function e(t){this.QMt=[],this.fxi=t}e.prototype.ZP=function(t){t.cached||(this.QMt.push(t),t.cached=!0)},e.prototype.VP=function(n){n.cached=!1;var t=this.QMt.findIndex(function(t){return t===n});this.QMt.splice(t,1)},e.prototype.RSi=function(t,n){var i,r,e,o,u,s,i=t?{}:null;for(null!=t&&t.forEach(function(t){Object.values(t.info).forEach(function(t){t&&(t.depRowCols?t.depRowCols.forEach(function(t){i["".concat(t.row,"-").concat(t.col)]=!0}):i["".concat(t.row,"-").concat(t.col)]=!0)})}),r=[],e=this.QMt.length,o=function(t){return t&&t.dataCell?"".concat(t.dataCell.row,"-").concat(t.dataCell.col):""},u=0;u<e;u++)s=this.QMt[u],!i||i[o(s)]||this.Uvr(s.cellNode)&&this.Zvr(s,[]).some(function(t){return i[t]})?(n(s),s.cached=!1):r.push(s);this.QMt=r},e.prototype.Uvr=function(t){var t,n,i,r,e,o,u,s,c,f;if(this.fxi&&0!==this.fxi.dataCollections.length&&t&&t.templateCell)for(n=(t=t.templateCell).row,i=t.col,r=this.fxi.dataCollections,e=0;e<r.length;e++)for(o=r[e].fields,u=0;u<o.length;u++){if("Cell"===(s=o[u]).type&&(f=(0,h.kOi)(s.cellName))&&f.row===n&&f.col===i)return!1;if("CellGroup"===s.type)for(c=0;c<s.cellNames.length;c++)if((f=(0,h.kOi)(s.cellNames[c]))&&f.row===n&&f.col===i)return!1}return!0},e.prototype.Zvr=function(t,n){return t.dataCell&&n.push("".concat(t.dataCell.row,"-").concat(t.dataCell.col)),t.leftParent&&this.Zvr(t.leftParent,n),t.upParent&&this.Zvr(t.upParent,n),n},n.GroupsCache=e},1453:function(t,n,i){var f,h;function e(n,i,t){if(!t){var r=Object.keys(n),e=Object.keys(i);if(r.length!==e.length)return!1;t=r}return t.every(function(t){return n[t]===i[t]})}function l(t,n,i){var r,e,o,u,s,c,u,f,h,i,r=i.leftParent,e=i.upParent,o=i.value,u=i.cellNode.templateCell,s=u.row,c=u.col,u=i.state,f=i.dataCell,h=n.find(function(t){return t.row===s&&t.col===c});h&&(i={oldValue:i.oldValue,state:u,row:f.row,col:f.col},t.entity[h.dbColumnName]=o,t.info[h.dbColumnName]=i),r&&l(t,n,r),e&&l(t,n,e)}f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.Hxi=n.Xxi=n.uEi=n.aEi=n.Nxi=n.Rir=n.Wxi=n.uxi=n.QSi=n.YSi=n.VSi=void 0,h=i(1589),n.VSi=function(t){var n,i,r,n,e,o,u,s,c,f;if(!t)return null;for(r=null!=(n=t.cellNode.templateCell.expansionDirection)?n:"V",e=(n=t.cellNode.templateCell).row,o=n.col,u=n.rowEnd,s=n.colEnd,c=null;t&&(!t.leftParent||!t.upParent)&&(t=t.leftParent||t.upParent)&&t.cellNode.templateCell.expansionDirection===r&&("List"===(null==(i=(f=t.cellNode.templateCell).dataSetting)?void 0:i.type)&&("V"===r&&f.row===e&&f.rowEnd===u||"H"===r&&f.col===o&&f.colEnd===s));)c=t;return c},n.YSi=function(t,n,i){var r=t.findIndex(function(t){return t===n});t.splice(r+1,0,i)},n.QSi=function(t,n){return{value:n.value,defaultFormula:n.formula,leftParent:t.leftParent,upParent:t.upParent,childrenArray:t.childrenArray.map(function(){return[]}),crossChildren:t.crossChildren.map(function(){return[]}),cellNode:t.dataCell.cellNode,dataCell:null,isNew:!0,state:"new"}},n.uxi=function(t,n){var i=t.templateCell.value;return{value:void 0!==n.value?n.value:i,defaultFormula:n.formula,leftParent:null,upParent:null,childrenArray:t.children.map(function(){return[]}),crossChildren:t.children.map(function(){return[]}),cellNode:t,dataCell:null,isNew:!0,state:"new"}},n.Wxi=function(t,n){var i=t.findIndex(function(t){return t===n});return-1!==i&&t.splice(i,1),i},n.Rir=function(t,n){return!(!t||!n)&&e(t.entity,t.entity)&&(i=t.info,r=t.info,!(!i||!r))&&(n=Object.keys(i),t=Object.keys(r),n.length===t.length)&&n.every(function(t){return i[t].row===r[t].row&&i[t].col===r[t].col});var i,r,n,t},n.Nxi=e,n.aEi=function(t,n){for(var i=t.length;i--;)if(n(t[i],i,t))return i;return-1},n.uEi=function(t,n,i){void 0===i&&(i=null);var r={entity:{},info:{}},e=[],n,i,o,u,s,c;return t.forEach(function(t){"CellGroup"!==t.type&&("Cell"===t.type?e.push(t):"Formula"===t.type?r.entity[t.dbColumnName]=t.formula:r.entity[t.dbColumnName]=t.value)}),l(r,e,n),i&&(n=[r],o=i,0<(u=(i=t).filter(function(t){var t;return"Cell"===t.type&&(t=o.get(t.row,t.col))&&!t.leftParent&&!t.upParent&&0===t.children.length&&!(0,h.lEi)(t)})).length&&(0===n.length&&n.push({entity:{},info:{}}),i=u.map(function(t){return o.get(t.row,t.col)}),s=i.map(function(t){return t.data.groups[0].value}),c=i.map(function(t){var t=t.data.groups;return{oldValue:t[0].oldValue,state:t[0].state,row:t[0].dataCell.row,col:t[0].dataCell.col}}),n.forEach(function(i){u.forEach(function(t,n){i.entity[t.dbColumnName]=s[n],i.info[t.dbColumnName]=f({},c[n])})}))),r},n.Xxi=function(t){return t.childrenArray.every(function(t){return!t||0===t.length})&&t.crossChildren.every(function(t){return!t||0===t.length})},n.Hxi=function t(n){return!(!n.leftParent||!n.upParent)||!(!n.leftParent||!t(n.leftParent))||!(!n.upParent||!t(n.upParent))}},3670:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataPopulatorsBootstrapper=void 0;var e=i(8346),r=i(2e3),o=i(9918),u=i(4305),s=i(1986),v=i(1589),c=i(1038),f;function h(t){this.vEi=[],this.dEi=[],this.pEi=[],this.wEi=t,this.gEi=(0,u.createVTreeDataPopulators)(),this.MEi=(0,u.createHTreeDataPopulators)();var t=this.wEi.cellNodeCache.getRange(),n=t.row,i=t.col,r=t.rowEnd,t=t.colEnd;this.BSi=new e.SmartCache(n,i,-1,-1),this.jEi=new e.SmartCache(n,i,r,t),this.CEi={},this.mEi={}}h.prototype.ZSi=function(t){return performance.now(),this.C8(t),this.NEi(),this.bEi(),performance.now(),this.BSi},h.prototype.SSi=function(){return this.wEi},h.prototype.OEi=function(){return new s.ExpandedContext(this.vEi,this.dEi)},h.prototype.yEi=function(){return this.IEi},h.prototype.NEi=function(){var i=this;(0,r._Ei)(this.wEi).forEach(function(t){var n=i.DEi(t);0<n.length&&(n.sort(r.AEi),n.forEach(function(t){return i.TEi(t,!0)})),i.TEi(t)})},h.prototype.TEi=function(n,t){var i,r;if(void 0===t&&(t=!1),i=("H"===n.root.templateCell.expansionDirection?this.MEi:this.gEi).find(function(t){return t.Pit(n)})){r={tree:n,cells:this.BSi,templateCellAccessCache:this.jEi,rowOffset:this.SEi(n.root.treeRange.row),colOffset:this.xEi(n.root.treeRange.col),expandedRows:this.vEi,expandedCols:this.dEi,overwriteRoots:this.pEi,treeGeneratorResult:this.wEi,unCreatedHTreeCellsAfterCrossCells:this.CEi,dryRun:t,paginationContext:this.IEi};try{i.ZSi(r),t||i.EEi()}catch(n){}t||i.zEi(),this.mEi[this.PEi(n)]=!0}},h.prototype.DEi=function(n){var i=this;return this.wEi.horizontalExpansionTrees.filter(function(t){return!i.mEi[i.PEi(t)]&&t.root.treeRange.col<n.root.treeRange.col})},h.prototype.PEi=function(t){return"".concat(t.root.templateCell.row,"-").concat(t.root.templateCell.col)},h.prototype.bEi=function(){var t,n,i,r,e,o,u,n,s,n,c,f,h,l,a,v,d,l,t=this.wEi.cellNodeCache,n=t.getRange(),i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,u=[];for(this.IEi.enable&&"PaginationByRow"===this.IEi.paginationSetting.type&&(s=(n=this.IEi.paginationSetting).titleRows,n=n.endRows,s&&0<s.length&&s.forEach(function(t){u[t]=!0}),n)&&0<n.length&&n.forEach(function(t){u[t]=!0}),c=i;c<=e;c++)for(f=r;f<=o;f++)this.jEi.get(c,f)||(h=t.get(c,f))&&(a=(l=h.templateCell).row,v=l.col,d=l.value,l=l.formula,a!==c||v!==f||void 0===d&&!l||this.LEi(h,u))},h.prototype.LEi=function(t,n){var i,r,e,o,i,u,s,o,e,c,f,h,l,a,i=t.templateCell,r=i.row,e=i.col,o=i.rowEnd,i=i.colEnd,u=this.SEi(r,e),s=this.xEi(e,r),o=this.SEi(o+1,e),e=this.xEi(i+1,r),c=(0,v.kEi)(t,u,s,o,e,n[r]);if(this.BSi.get(c.row,c.col))(0,v.REi)(this.BSi,c);else for(f=c.row+c.rowCount-1,h=c.col+c.colCount-1,l=c.row;l<=f;l++)for(a=c.col;a<=h;a++)this.BSi.set(l,a,c)},h.prototype.SEi=function(t,n){return(0,o.SEi)(this.vEi,t,n,this.wEi.rowOffsetClearCache)},h.prototype.xEi=function(t,n){return(0,o.xEi)(this.dEi,t,n,this.wEi.colOffsetClearCache)},h.prototype.C8=function(t){var n,i,r,e,n,o,n=this.wEi.cellNodeCache.getRange(),i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;this.BSi.reset(i,r,-1,-1),this.jEi.reset(i,r,e,n),this.CEi={},this.vEi=[],this.dEi=[],o=new c.PaginationSettingAnalyser(this.wEi).GEi(),this.IEi={enable:t&&!!o,paginationSetting:o,paginationStartCols:[0],paginationStartRows:[0],titleRowsCount:o?o.titleRows.length:0,endRowsCount:o?o.endRows.length:0,titleColsCount:o?o.titleCols.length:0,endColsCount:o?o.endCols.length:0},(0,v.Unr)(i,r,e,n)},n.DataPopulatorsBootstrapper=h},1986:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ExpandedContext=void 0;var r=i(9918),e;function o(t,n){this.vEi=t,this.dEi=n}o.prototype.calcExpandedRowCountBeforeRow=function(t){return(0,r.SEi)(this.vEi,t)},o.prototype.calcExpandedColCountBeforeCol=function(t){return(0,r.xEi)(this.dEi,t)},n.ExpandedContext=o},4455:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.GetCellsHelper=void 0;var l=i(2e3),f=i(1589),r;function e(t,n,i){this.Wnr={},this.BSi=t,this.wEi=n,this.vur=i}e.prototype.BEi=function(t,n,i,r,e){void 0===e&&(e=!1);var o="".concat(t,"-").concat(n,"-").concat(i,"-").concat(r,"-include-all-splitted-cells-").concat(e),u=this.Wnr[o];return u||(u=this.Qnr(t,n,i,r,e),this.Wnr[o]=u),u},e.prototype.t9i=function(t,n){var t=this.wEi.cellNodeCache.get(t,n);return t?this.Wur(t.data.groups,!0):[]},e.prototype.pur=function(t,n,i,r){var e="".concat(t,"-").concat(n,"-").concat(i,"-").concat(r,"-current-page"),o=this.Wnr[e];return o||(o=this.wur(t,n,i,r),this.Wnr[e]=o),o},e.prototype.dl=function(){this.Wnr={}},e.prototype.Qnr=function(t,n,i,r,e){var o,u,s;void 0===e&&(e=!1);try{return(o=this.wEi.cellNodeCache.get(t,n))?void 0!==i&&void 0!==r&&this.BSi.get(i,r)&&(u=this.BSi.get(i,r),s=(s=this.ynr(u,o))||this.HEi(u,o,e))||this.Wur(o.data.groups,e):[]}catch(t){return[]}},e.prototype.HEi=function(i,r,n){var e,t,o,u,s,c,o,f,t,h,e=this;return void 0===n&&(n=!1),0===(t=(0,l.ZEi)(i.cellNode,this.wEi)).length||(o=r.templateCell,u=o.row,s=o.col,c=[],t.forEach(function(t){var n;t.pathArray.some(function(t){return t.some(function(t){var t=t.templateCell;return t.row===u&&t.col===s})})&&e.VEi(t,i,r).forEach(function(t){return c.push(t)})}),0===c.length)?null:1===(o=c.map(function(t){return e.QEi(t,i)})).length?this.Wur(o[0],n):(f=[],t=o[0],h=o[1],t.forEach(function(t){h.includes(t)&&e.Wur([t],n).forEach(function(t){return f.push(t)})}),f)},e.prototype.VEi=function(t,u,s){var n=t.pathArray.find(function(t){return t.some(function(t){return t===u.cellNode})&&t.some(function(t){return t===s})}),i=n?[n]:t.pathArray.filter(function(t){return t.some(function(t){return t===u.cellNode})}),c=n?[n]:t.pathArray.filter(function(t){return t.some(function(t){return t===s})});return i.map(function(t){var n,i,r,e,o,i=-1,r=c.findIndex(function(t){return t.some(function(t){return t===u.cellNode})});if(-1!==r)i=c[r].findIndex(function(t){return t===u.cellNode}),n=c[r];else for(e=0;e<c.length;e++)i<(o=(0,f.Ixi)(t,c[e]))&&(i=o,n=c[e]);return{currentCellToClosestAncestor:(0,f._xi)(t,u.cellNode,i,function(t){return t}),closestAncestorToTargetCell:(0,f.Dxi)(n,s,i,function(t){return t})}})},e.prototype.QEi=function(t,n){var o,u,s,o=n.group;return t.currentCellToClosestAncestor.forEach(function(t){o="left"===t?o.leftParent:o.upParent}),u=[],s=o.cellNode.children,t.closestAncestorToTargetCell.forEach(function(n,t){var i,r,r,e,i=s.findIndex(function(t){return t===n}),r=s[i];s=r.children,r=r.leftParent&&r.upParent,u=0===t?r?o.crossChildren[i].reduce(function(n,t){return t.forEach(function(t){return n.push(t)}),n},[]):o.childrenArray[i]:(e=[],r?u.forEach(function(t){t.crossChildren[i].forEach(function(t){t.forEach(function(t){return e.push(t)})})}):u.forEach(function(t){t.childrenArray[i].forEach(function(t){return e.push(t)})}),e)}),u},e.prototype.ynr=function(t,n){var i,r,i,e,o,e,u,r,o,i,i=t.cellNode.templateCell,r=i.row,i=i.col,e=n.templateCell,o=e.row,e=e.col;return r===o&&i===e?[t]:(o=(r=t.group).leftParent,i=r.upParent,o&&(u=this.ynr(o.dataCell,n))||i&&(u=this.ynr(i.dataCell,n))?u:null)},e.prototype.wur=function(t,n,i,r){var e,o,t,u,s,c,f,e=this.Tur(i,r),o=[];if(e){if(t=this.BEi(t,n,i,r,!0),1===this.vur.pages.length)return t;u=e.row,s=e.col,c=e.rowEnd,f=e.colEnd,t.forEach(function(t){t.row>=u&&t.row+t.rowCount-1<=c&&t.col>=s&&t.col+t.colCount-1<=f&&o.push(t)})}return o},e.prototype.Tur=function(t,n){for(var i,r,e,o,i=this.vur.pages,r=0,e=i.length;r<e;r++)if((o=i[r]).row<=t&&o.rowEnd>=t&&o.col<=n&&o.colEnd>=n)return o;return 0},e.prototype.Wur=function(t,n){for(var i,r,e,o,i=[],r=0,e=t.length;r<e;r++)o=t[r],n&&o.dataCells?o.dataCells.forEach(function(t){return i.push(t)}):o.wholeDuplicatedCells?o.wholeDuplicatedCells.forEach(function(t){return i.push(t)}):i.push(o.dataCell);return i},n.GetCellsHelper=e},943:function(t,n){var i;function r(t,n){this.IEi=t,this.BSi=n}Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationInfoGenerator=void 0,r.prototype.Pjn=function(){var t;return"RowFirst"===(null==(t=this.IEi.paginationSetting)?void 0:t.paginationOrder)?this.YEi():this.WEi()},r.prototype.WEi=function(){for(var t=this.BSi.getRange().rowEnd,n=this.IEi.paginationStartRows,i={pages:[]},r=n[0],e=1;e<n.length;e++)this.FEi(r,n[e]-1,i),r=n[e];return this.FEi(r,t,i),i},r.prototype.FEi=function(t,n,i){for(var r=this.BSi.getRange().colEnd,e=this.IEi.paginationStartCols,o=e[0],u=1;u<e.length;u++)i.pages.push({row:t,col:o,rowEnd:n,colEnd:e[u]-1}),o=e[u];i.pages.push({row:t,col:o,rowEnd:n,colEnd:r})},r.prototype.YEi=function(){for(var t=this.BSi.getRange().colEnd,n=this.IEi.paginationStartCols,i={pages:[]},r=n[0],e=1;e<n.length;e++)this.JEi(r,n[e]-1,i),r=n[e];return this.JEi(r,t,i),i},r.prototype.JEi=function(t,n,i){for(var r=this.BSi.getRange().rowEnd,e=this.IEi.paginationStartRows,o=e[0],u=1;u<e.length;u++)i.pages.push({row:o,col:t,rowEnd:e[u]-1,colEnd:n}),o=e[u];i.pages.push({row:o,col:t,rowEnd:r,colEnd:n})},n.PaginationInfoGenerator=r},1038:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationSettingAnalyser=void 0;var h=i(7789),r;function e(t){this.wEi=t}e.prototype.GEi=function(){var t,n,i,r,e,o,u,s,c,i,f,f,n=this.wEi,i=n.templateResolver.getTemplatePaginationSetting();return i?(r=i.rowPagination,e=i.titleRows,o=i.endRows,u=i.titleCols,s=i.endCols,c=i.pagePixelSize,i=i.paginationOrder||"RowFirst",r&&r.paginationDataCell?(f=(0,h.kOi)(r.paginationDataCell),!(f=n.cellNodeCache.get(f.row,f.col))||"List"!==(null==(t=f.templateCell.dataSetting)?void 0:t.type)||!r.rowCountPerPage||r.rowCountPerPage<0?null:{type:"PaginationByRow",titleRows:e||[],endRows:o||[],titleCols:u||[],endCols:s||[],pagePixelSize:c,paginationDataCell:f,rowCountPerPage:r.rowCountPerPage,paginationOrder:i}):c?{type:"PaginationByPageSize",titleRows:e||[],endRows:o||[],titleCols:u||[],endCols:s||[],pagePixelSize:c,paginateBeforeRowCache:n.paginateBeforeRowCache,paginateAfterRowCache:n.paginateAfterRowCache,paginateBeforeColCache:n.paginateBeforeColumnCache,paginateAfterColCache:n.paginateAfterColumnCache,paginationOrder:i}:null):null},n.PaginationSettingAnalyser=e},8615:function(t,n,i){var v,r,d,e;function o(t,n){this.Mur={},this.cxi=r(r([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0),this.z3i=n,this.Iur=t.cellNodeCache,this.Z4i=t.templateResolver}v=this&&this.__assign||function(){return(v=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},r=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.TableDataGenerator=void 0,d=i(7789),o.prototype.generateData=function(h,t,n){var l,i,r,e,e,a,l=this;return this.gur(h),i=[],r=Object.keys(h),(e=this.Cur(h))&&(e=this.z3i.BEi(e.templateCell.row,e.templateCell.col,t,n),a=function(t,n,i){for(var r=0;r<t.length;r++)t[r][n]=i},e.forEach(function(c){var f,t,f=[{}];for(r.forEach(function(n){var t,i,t,t,r,t,e,o,u,s,t=h[n],i=t.formula,t=t.cellNames;1===t.length&&d.cellNameReg.test(i)?(t=l.Mur[t[0]].templateCell,1===(r=l.z3i.BEi(t.row,t.col,c.row,c.col)).length?(a(f,n,r[0].value),f.forEach(function(t){t[n]=r[0].value})):(o=n,u=r,s=[],f.forEach(function(i){u.forEach(function(t){var n;s.push(v(v({},i),((n={})[o]=t.value,n)))})}),f=s)):(t=l.Z4i.evaluateFormula(c.row,c.col,i),a(f,n,t))}),t=0;t<f.length;t++)i.push(f[t])})),i},o.prototype.Cur=function(t){for(var n,i,r,e,o,u,u,n=this.Nur(t),i=null,r=-1,e=0;e<n.length;e++)o=n[e],(u=this.jur(o))&&r<(u=this.mxi(u,o).indexOf(o))&&(r=u,i=o);return i},o.prototype.Nur=function(t){var i=this,r=[];return Object.values(t).forEach(function(t){t.cellNames.forEach(function(t){var n,n,n=(0,d.kOi)(t);n&&(n=i.Iur.get(n.row,n.col),r.includes(n)||r.push(n),i.Mur[t]||(i.Mur[t]=n))})}),r},o.prototype.jur=function(n){var i=this;return this.cxi.find(function(t){return i.mxi(t,n)})},o.prototype.mxi=function(t,n){return t.pathArray.find(function(t){return t.some(function(t){return t===n})})},o.prototype.gur=function(t){Object.values(t).forEach(function(i){i.formula=(i.formula||"").trim().toUpperCase(),i.formula.startsWith("=")&&(i.formula=i.formula.substring(1)),i.cellNames=i.cellNames||[],i.cellNames.forEach(function(t,n){i.cellNames[n]=t.toUpperCase()})})},n.TableDataGenerator=o},2e3:function(t,n){var s=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))};function c(t,n){return t.root.treeRange.row<n.root.treeRange.row?-1:t.root.treeRange.row>n.root.treeRange.row?1:t.root.treeRange.col<n.root.treeRange.col?-1:t.root.treeRange.col>n.root.treeRange.col?1:0}Object.defineProperty(n,"__esModule",{value:!0}),n.ZEi=n._Ei=n.AEi=void 0,n.AEi=c,n._Ei=function(t){var n,i,r,e,o,n,u,n,n=t.templateResolver.getTemplatePaginationSetting();return n&&(i=n.titleRows,r=n.titleCols,e=n.endRows,o=n.endCols,t.verticalExpansionTrees.forEach(n=function(t){var n,n;1<t.root.data.groups.length&&("V"===t.root.templateCell.expansionDirection&&(n=(n=t).root.templateCell.row,i&&n>=i[0]&&n<=i[i.length-1]||e&&n>=e[0]&&n<=e[e.length-1])||"H"===t.root.templateCell.expansionDirection&&(n=(n=t).root.templateCell.col,r&&n>=r[0]&&n<=r[r.length-1]||o&&n>=o[0]&&n<=o[o.length-1]))&&(t.root.data.groups=[t.root.data.groups[0]])}),t.horizontalExpansionTrees.forEach(n)),u=t.verticalExpansionTrees.filter(function(t){return 0===t.root.children.length&&"No"===t.root.templateCell.expansionDirection}),n=t.verticalExpansionTrees.filter(function(t){return-1===u.indexOf(t)}),s(s([],s(s([],t.horizontalExpansionTrees,!0),n,!0).sort(c),!0),u.sort(c),!0)},n.ZEi=function(t,n){var t=t.templateCell,i=t.row,r=t.col,t=n.verticalExpansionTrees,n=n.horizontalExpansionTrees;return s(s([],t,!0),n,!0).filter(function(t){return t.pathArray.find(function(t){return t.find(function(t){return t.templateCell.row===i&&t.templateCell.col===r})})})}},1589:function(t,n,i){var i,v;function e(t,n){for(var i,r,e,o,u,s,i=t.row,r=t.col,e=t.rowEnd,o=t.colEnd,u=i;u<=e;u++)for(s=r;s<=o;s++)n(u,s)}function d(t,n){var i;return{value:t.templateCell.dataColumn?null==(i=t.data.groups[0])?void 0:i.value:t.templateCell.value,leftParent:null,upParent:null,childrenArray:[],crossChildren:[],cellNode:t,dataCell:n,state:"normal"}}Object.defineProperty(n,"__esModule",{value:!0}),n.Dxi=n._xi=n.Ixi=n.lEi=n.KEi=n.REi=n.XEi=n.kEi=n.Unr=n.$Ei=n.qEi=void 0,i=i(8346),n.qEi=function(i,t,r){e(t,function(t,n){i.set(t,n,r)})},n.$Ei=e,v=new i.SmartCache(1,1,1,1),n.Unr=function(t,n,i,r){v.reset(t,n,i,r)},n.kEi=function(t,n,i,r,e,o){var u,s,c,f,h,l,u,f,u,a,s=(u=t.templateCell).row,c=u.col,f=u.rowEnd,h=u.colEnd,l=u.hExpansible,u=u.vExpansible,f={cellNode:t,value:(t.templateCell.dataColumn?t.data.groups[0]:t.templateCell).value,group:null,row:s+n,col:c+i,rowCount:f-s+1+(u?r-n:0),colCount:h-c+1+(l?e-i:0)};return(o=void 0===o?!1:o)?0===t.data.groups.length?(f.group=d(t,f),f.group.dataCells=[f],f.group.wholeDuplicatedCells=f.group.dataCells,t.data.groups.push(f.group)):(t.data.groups[0].dataCells||(t.data.groups[0].dataCells=[]),(u=t.data.groups[0].dataCells[0])&&f.row<=u.row&&f.col<=u.col?((a=d(t,f)).dataCells=[],a.wholeDuplicatedCells=a.dataCells,f.group=a,u.group.dataCells.forEach(function(t){(t.group=a).dataCells.push(t)}),a.dataCells.unshift(f),t.data.groups=[a]):(f.group=t.data.groups[0],f.group.dataCells.push(f))):(f.group=d(t,f),v.get(s,c)?t.data.groups.push(f.group):(t.data.groups=[f.group],v.set(s,c,!0))),f},n.XEi=d,n.REi=function(t,n){for(var i,r,e,o,u,s,i=n.cellNode,r=n.row+n.rowCount-1,e=n.col+n.colCount-1,o=n.row;o<=r;o++)for(u=n.col;u<=e;u++)(s=t.get(o,u))&&(s.overwrittenCellNode=i)},n.KEi=function(t,n){return t.children.findIndex(function(t){return t===n})},n.lEi=function(t){return!("No"===(null==t?void 0:t.templateCell.expansionDirection))},n.Ixi=function(t,n){for(var i=Math.min(t.length,n.length),r=0;r<=i;){if(t[r]!==n[r]){r--;break}r++}return r},n._xi=function(t,n,i,r){for(var e,n,o,u,s,c,f,h,l,h,a,v,a,e=[],n=n.templateCell,o=n.row,u=n.col,s,c=t.findIndex(function(t){var t=t.templateCell;return t.row===o&&t.col===u});i<c;c--)(f=t[c]).leftParent&&f.upParent?(l=(h=f.leftParent.templateCell).row,h=h.col,v=(a=t[c-1].templateCell).row,a=a.col,e.push(r(l===v&&h===a?"left":"up"))):f.leftParent?e.push(r("left")):e.push(r("up"));return e},n.Dxi=function(i,t,n,r){for(var e=[],t=t.templateCell,o=t.row,u=t.col,s=i.findIndex(function(t){var t=t.templateCell;return t.row===o&&t.col===u}),c=function(t){var n=i[t+1];e.push(r(n,i[t].children.findIndex(function(t){return t===n})))},f=n;f<s;f++)c(f);return e}},3530:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.HeightPager=void 0;var e=i(8346),r;function m(t,n,i,r){this.t3i=t,this.wEi=t.SSi(),this.IEi=t.yEi(),this.BSi=n,this.xl=i,this.rOi=r,this.sE()}m.prototype.n3i=function(){var t,n,i,r,e,o,t,u,s,c,f,h,t,l,a,v,d,p,M,w,I,g,C,N,j,E,A,D,b,T,O,t=this.BSi.getRange(),n=t.rowEnd,i=t.col,r=t.colEnd,e=this.xl,o=this.rOi,t=this.IEi.paginationSetting,u=t.pagePixelSize.height,s=t.paginateBeforeRowCache,c=t.paginateAfterRowCache;if(this.i3i+this.r3i>u)return this.IEi.paginationStartRows=[0],this.BSi;for(f=this.wEi.canNotBreakCells,this.IEi.paginationStartRows=h=[],l=u-this.r3i+(t=m.e3i),a=u+t,v=0<this.u3i.length,d=this.u3i[0],M=(p=v?this.u3i[this.u3i.length-1]:-1)+1,w=v?p-d+1:0,C=(g=(I=0<this.s3i.length)?this.s3i[0]:-1)-1,N=this.s3i[this.s3i.length-1],j=I?N-g+1:0,E=0,D=A=-1;A<n;){if(h.push(E),b=0,T={},v&&p<A&&(!I||A+1<g)&&(this.c3i(d,p,E),E+=w,b+=this.i3i),(O=A+1)===D)return this.IEi.paginationStartRows=[0],this.BSi;for(D=O;b+e[A+1]<=(d<A?l:a)&&A+1<=n;)if(++A!==g){if(A!==O&&A!==M&&s[o[A]]&&this.f3i(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.h3i(c[o[A]],A,i,r))break;b+=e[A],T[A]=b}else A=N;if(0<f.length)for(A=this.a3i(f,T,O,A,i,r);0===e[A+1]&&A+1<=n;)if(++A!==g){if(A!==O&&A!==M&&s[o[A]]&&this.f3i(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.h3i(c[o[A]],A,i,r))break}else A=N;O<=A&&(this.c3i(O,A,E),E+=A-O+1,I)&&p<A&&A<=C&&(this.c3i(g,N,E),E+=j,A===C)&&(A+=j)}return this.l3i},m.prototype.sE=function(){var t=this.BSi.getRange(),n=t.row,t=t.col,i=this.IEi.paginationSetting,r=i.titleRows,i=i.endRows;this.l3i=new e.SmartCache(n,t,-1,-1),this.u3i=this.v3i(r),this.s3i=this.v3i(i),this.i3i=this.d3i(r),this.r3i=this.d3i(i)},m.prototype.v3i=function(t){var n;return 0===t.length?[]:(n=this.t3i.OEi().calcExpandedRowCountBeforeRow(t[0]),t.map(function(t){return t+n}))},m.prototype.d3i=function(t){var n=0,i=this.wEi.templateResolver;return t.forEach(function(t){n+=i.getRowHeight(t)}),n},m.prototype.f3i=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.BSi.get(n,e))&&t[o.cellNode.templateCell.col]&&o.row===n)return!0;return!1},m.prototype.h3i=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.BSi.get(n,e))&&t[o.cellNode.templateCell.col]&&o.rowCount+o.row-1===n)return!0;return!1},m.prototype.a3i=function(t,n,i,r,e,o,u,s){var c,f,h;if(void 0===u&&(u=-1),void 0===s&&(s=-1),0!==t.length)for(c=e;c<=o;)if(f=this.BSi.get(r,c)){if(t.includes(f.cellNode)&&f.row+f.rowCount-1>r)return i<(h=0<s?f.row+f.rowCount-1:f.row-1)&&0<n[h]?this.a3i(t,n,i,h,e,o,-1===u?f.row+f.rowCount-1:u,s):this.a3i(t,n,i,-1===u?f.row+f.rowCount-1:u,e,o,-1,1);c+=f.cellNode.templateCell.colEnd-f.cellNode.templateCell.col+1}else c++;return r},m.prototype.c3i=function(t,n,i){for(var r,i,e,o,u,s,c,f,f,r=i-t,i=this.BSi.getRange(),e=i.col,o=i.colEnd,u=t;u<=n;u++)for(s=n-u+1,c=e;c<=o;c++)this.l3i.get(u+r,c)||(f=this.BSi.get(u,c))&&(f=this.p3i(f,u,s,u+r),this.w3i(f))},m.prototype.p3i=function(t,n,i,r){var r={cellNode:t.cellNode,value:t.cellNode.templateCell.repeatContentWhenPaging||n===t.row?t.value:"",group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:t.col,rowCount:Math.min(t.rowCount-(n-t.row),i),colCount:t.colCount};return this.q5i(t.group,r),r},m.prototype.w3i=function(t){for(var n,i,r,e,o,n=this.l3i,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,e=t.row;e<=i;e++)for(o=t.col;o<=r;o++)n.set(e,o,t)},m.prototype.q5i=function(t,n){t.heightPagerAccessed||(t.cellNode.isInTitleRowOrEndRow&&(t.wholeDuplicatedCells=[]),t.dataCells=[],t.dataCell=n,t.heightPagerAccessed=!0),t.dataCells.push(n),t.cellNode.isInTitleRowOrEndRow&&t.wholeDuplicatedCells.push(n)},m.e3i=0,n.HeightPager=m},5630:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.WidthPager=void 0;var e=i(8346),r;function m(t,n,i,r){this.t3i=t,this.wEi=t.SSi(),this.IEi=t.yEi(),this.BSi=n,this.Nl=i,this.eOi=r,this.sE()}m.prototype.n3i=function(){var t,n,i,r,e,o,t,u,s,c,f,h,t,l,a,v,d,p,M,w,I,g,C,N,j,E,A,D,b,T,O,t=this.BSi.getRange(),n=t.colEnd,i=t.row,r=t.rowEnd,e=this.Nl,o=this.eOi,t=this.IEi.paginationSetting,u=t.pagePixelSize.width,s=t.paginateBeforeColCache,c=t.paginateAfterColCache;if(this.g3i+this.M3i>u)return this.IEi.paginationStartCols=[0],this.BSi;for(f=this.wEi.canNotBreakCells,this.IEi.paginationStartCols=h=[],l=u-this.M3i+(t=m.j3i),a=u+t,v=0<this.C3i.length,d=this.C3i[0],M=(p=v?this.C3i[this.C3i.length-1]:-1)+1,w=v?p-d+1:0,C=(g=(I=0<this.m3i.length)?this.m3i[0]:-1)-1,N=this.m3i[this.m3i.length-1],j=I?N-g+1:0,E=0,D=A=-1;A<n;){if(h.push(E),b=0,T={},v&&p<A&&(!I||A+1<g)&&(this.N3i(d,p,E),E+=w,b+=this.g3i),(O=A+1)===D)return this.IEi.paginationStartCols=[0],this.BSi;for(D=O;b+e[A+1]<=(d<A?l:a)&&A+1<=n;)if(++A!==g){if(A!==O&&A!==M&&s[o[A]]&&this.b3i(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.O3i(c[o[A]],A,i,r))break;b+=e[A],T[A]=b}else A=N;if(0<f.length)for(A=this.y3i(f,T,O,A,i,r);0===e[A+1]&&A+1<=n;)if(++A!==g){if(A!==O&&A!==M&&s[o[A]]&&this.b3i(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.O3i(c[o[A]],A,i,r))break}else A=N;O<=A&&(this.N3i(O,A,E,!0),E+=A-O+1,I)&&p<A&&A<=C&&(this.N3i(g,N,E),E+=j,A===C)&&(A+=j)}return this.l3i},m.prototype.sE=function(){var t=this.BSi.getRange(),n=t.row,t=t.col,i=this.IEi.paginationSetting,r=i.titleCols,i=i.endCols;this.l3i=new e.SmartCache(n,t,-1,-1),this.C3i=this.I3i(r),this.m3i=this.I3i(i),this.g3i=this._3i(r),this.M3i=this._3i(i)},m.prototype.I3i=function(t){var n;return 0===t.length?[]:(n=this.t3i.OEi().calcExpandedColCountBeforeCol(t[0]),t.map(function(t){return t+n}))},m.prototype._3i=function(t){var n=0,i=this.wEi.templateResolver;return t.forEach(function(t){n+=i.getColumnWidth(t)}),n},m.prototype.b3i=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.BSi.get(e,n))&&t[o.cellNode.templateCell.row]&&o.col===n)return!0;return!1},m.prototype.O3i=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.BSi.get(e,n))&&t[o.cellNode.templateCell.row]&&o.colCount+o.col-1===n)return!0;return!1},m.prototype.y3i=function(t,n,i,r,e,o,u,s){var c,f,h;if(void 0===u&&(u=-1),void 0===s&&(s=-1),0!==t.length)for(c=e;c<=o;)if(f=this.BSi.get(c,r)){if(t.includes(f.cellNode)&&f.col+f.colCount-1>r)return i<(h=0<s?f.col+f.colCount-1:f.col-1)&&0<n[h]?this.y3i(t,n,i,h,e,o,-1===u?f.col+f.colCount-1:u,s):this.y3i(t,n,i,-1===u?f.col+f.colCount-1:u,e,o,-1,1);c+=f.cellNode.templateCell.rowEnd-f.cellNode.templateCell.row+1}else c++;return r},m.prototype.N3i=function(t,n,i,r){var e,i,o,u,s,c,f,h,h;for(void 0===r&&(r=!1),e=i-t,o=(i=this.BSi.getRange()).row,u=i.rowEnd,s=t;s<=n;s++)for(c=n-s+1,f=o;f<=u;f++)this.l3i.get(f,s+e)||(h=this.BSi.get(f,s))&&(h=this.p3i(h,s,c,s+e,r&&s===t&&0<this.C3i.length),this.w3i(h))},m.prototype.p3i=function(t,n,i,r,e){var i,o,e,e;return void 0===e&&(e=!1),i=Math.min(t.colCount-(n-t.col),i),e&&0<r&&(o=this.l3i.get(t.row,r-1),e=this.IEi.paginationStartCols[this.IEi.paginationStartCols.length-1],o)&&o.cellNode===t.cellNode&&o.col>=e?(o.colCount+=i,o):(e={cellNode:t.cellNode,value:t.cellNode.templateCell.repeatContentWhenPaging||n===t.col?t.value:"",group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:t.row,col:r,rowCount:t.rowCount,colCount:i},this.q5i(t.group,e),e)},m.prototype.w3i=function(t){for(var n,i,r,e,o,n=this.l3i,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,e=t.row;e<=i;e++)for(o=t.col;o<=r;o++)n.set(e,o,t)},m.prototype.q5i=function(t,n){t.widthPagerAccessed||(t.cellNode.isInTitleColOrEndCol&&(t.wholeDuplicatedCells=[]),t.dataCells=[],t.dataCell=n,t.widthPagerAccessed=!0),t.dataCells.push(n),t.cellNode.isInTitleColOrEndCol&&t.wholeDuplicatedCells.push(n)},m.j3i=0,n.WidthPager=m},5910:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PageSizePager=void 0;var r=i(1269),h=i(3530),l=i(5630),e;function o(t,n,i){this.t3i=t,this.BSi=n,this.MU=i}o.prototype.n3i=function(){performance.now();var t=new r.ReportDataService(this.BSi,this.t3i),t=this.MU.beforePageSizePaginate(t),n=this.BSi;return this.D3i(t.rowHeightCache)&&(n=new h.HeightPager(this.t3i,this.BSi,t.rowHeightCache,t.rowToTemplateRowCache).n3i()),this.A3i(t.colWidthCache)&&(n=new l.WidthPager(this.t3i,n,t.colWidthCache,t.colToTemplateColCache).n3i()),performance.now(),n},o.prototype.D3i=function(t){var n,i,r,e,o,u,i,s,c,f,n=this.BSi.getRange().rowEnd,i=this.t3i.yEi().paginationSetting,r=i.paginateBeforeRowCache,e=i.paginateAfterRowCache,o=i.titleRows,u=i.endRows,i=i.pagePixelSize;if(!(0===n||o.length&&o[o.length-1]===n)){if(0<Object.keys(r).length||0<Object.keys(e).length||0<o.length||0<u.length)return!0;for(s=i.height+h.HeightPager.e3i,f=c=0;f<=n;){if((c+=t[f])>s)return!0;f++}}return!1},o.prototype.A3i=function(t){var n,i,r,e,o,u,i,s,c,f,n=this.BSi.getRange().colEnd,i=this.t3i.yEi().paginationSetting,r=i.paginateBeforeColCache,e=i.paginateAfterColCache,o=i.titleCols,u=i.endCols,i=i.pagePixelSize;if(!(0===n||o.length&&o[o.length-1]===n)){if(0<Object.keys(r).length||0<Object.keys(e).length||0<o.length||0<u.length)return!0;for(s=i.width+l.WidthPager.j3i,f=c=0;f<=n;){if((c+=t[f])>s)return!0;f++}}return!1},n.PageSizePager=o},7329:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataGenerator=void 0;var r=i(4396),e=i(3670),o=i(5910),u=i(355),s;function c(t,n){this.wEi=t,this.N3=n,this.t3i=new e.DataPopulatorsBootstrapper(t)}c.prototype._process=function(t){var n,i;return this.T3i(null==t?void 0:t.parameter),n=this.t3i.ZSi(null==t?void 0:t.enablePagination),null!=t&&t.enablePagination?((i=this.wEi.templateResolver.getTemplateSplitSetting())&&(n=new u.Spliter(i,n,this.wEi).n3i()),this.S3i(n,t)):n},c.prototype.x3i=function(){return this.t3i},c.prototype.T3i=function(t){new r.TreeDataGenerator(this.wEi,this.N3).Pjn(t)},c.prototype.S3i=function(t,n){var i=this.t3i.yEi(),r=i.enable,i=i.paginationSetting;return r&&"PaginationByPageSize"===i.type?new o.PageSizePager(this.t3i,t,n).n3i():t},n.ReportDataGenerator=c},1269:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataService=void 0;var r=i(96),e=i(4455),o=i(943),u=i(8615),s;function c(t,n){this.BSi=t,this.P3i=new o.PaginationInfoGenerator(n.yEi(),t),this.z3i=new e.GetCellsHelper(t,n.SSi(),this.P3i.Pjn()),this.E3i=new r.DataEntryService(n,t,this.z3i),this.Eur=new u.TableDataGenerator(n.SSi(),this.z3i)}c.prototype.getCell=function(t,n){return this.BSi.get(t,n)},c.prototype.getCells=function(t,n,i,r){return this.z3i.BEi(t,n,i,r)},c.prototype.getAllCells=function(t,n){return this.z3i.t9i(t,n)},c.prototype.getReportRange=function(){return this.BSi.getRange()},c.prototype.getPaginationInfo=function(){return this.P3i.Pjn()},c.prototype.getCellsInPage=function(t,n,i,r){return this.z3i.pur(t,n,i,r)},c.prototype.generateTableData=function(t,n,i){return this.Eur.generateData(t,n,i)},c.prototype.addRecord=function(t,n){var t=this.E3i.addRecord(t,n);return t.success&&this.z3i.dl(),t},c.prototype.updateCellValue=function(t,n,i){return this.E3i.updateCellValue(t,n,i)},c.prototype.deleteRecord=function(t,n){var t=this.E3i.deleteRecord(t,n);return t.success&&this.z3i.dl(),t},c.prototype.resetAllCellsStateToNormal=function(){this.E3i.resetCellsStateToNormal()},c.prototype.resetCellsStateToNormal=function(t,n){this.E3i.resetCellsStateToNormal(t,n)},c.prototype.getDataCollectionResults=function(){return this.E3i.getDataCollectionResults()},c.prototype.isDirty=function(){return this.E3i.isDirty()},n.ReportDataService=c},794:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnSpliter=void 0;var p=i(8346),M=i(4125),r;function e(t,n,i,r){this.J2i=t,this.BSi=n,this.K2i=i,this.X2i=r;var t=this.BSi.getRange(),n=t.row,i=t.col;this.l3i=new p.SmartCache(n,i,-1,-1)}e.prototype.n3i=function(){for(var t,n,i,t,r,e,o,u,t,s,c,f,h,l,t,t=this.J2i,n=t.columnCount,i=t.repeatCols,t=this.X2i,r=t.row,e=t.col,o=t.rowEnd,u=t.colEnd,t=e-this.K2i.col,s=i?i.start+t:-1,c=i?i.end+t:-1,f=o-r+1,h=r,l=e;l<=u;)i&&this.N3i(s,c,h,s),this.$2i(l,h,e),h+=f,l+=n;return this.q2i(t=h-r-f),this.t5i(t),this.n5i(),this.i5i(t),this.l3i},e.prototype.q2i=function(t){var n,i,r,e,o,r,n=this.BSi.getRange().col,i=this.X2i.col;n!==i&&((r=this.J2i.repeatCols)?(e=i-this.K2i.col,o=r.start+e,r=r.end+e+1,n<o&&this.r5i(n,o-1,n,t),r<i&&this.r5i(r,i-1,r,t)):this.r5i(n,i-1,n,t))},e.prototype.t5i=function(t){var n,i,r,n,n=this.J2i.columnCount,i=this.BSi.getRange().colEnd,r=this.X2i.colEnd+1;r<=i&&(n=this.X2i.col+n,this.r5i(r,i,n,t))},e.prototype.$2i=function(t,n,i){var r=this.J2i.columnCount,r=Math.min(t+r-1,this.X2i.colEnd);this.N3i(t,r,n,i)},e.prototype.N3i=function(t,n,i,r){for(var e,o,u,s,c,f,h,l,a,a,e=this.X2i,o=e.row,u=e.rowEnd,s=r-t,c=i-o,f=t;f<=n;f++)for(h=n-f+1,l=o;l<=u;l++)this.l3i.get(l+c,f+s)||(a=this.BSi.get(l,f))&&(a=this.p3i(a,f,h,l+c,f+s),(0,M.w3i)(this.l3i,a))},e.prototype.r5i=function(t,n,i,r){for(var e,o,u,s,c,f,h,l,e,a,v,d,p,p,o=this.X2i,u=o.row,s=o.rowEnd,c=i-t,f=[],h=[],l=t;l<=n;l++)!(e=null==(e=this.BSi.get(u,l))?void 0:e.cellNode.templateCell)||!e.clearRowOffset&&e.vExpansible||(h[l]=!0),e&&e.clearRowOffset&&(f[l]=!0);for(l=t;l<=n;l++)for(a=n-l+1,v=void 0,d=u;d<=s;d+=v?v.rowCount:1)(v=this.BSi.get(d,l))&&(p=v.row===u||f[l]?0:r,this.l3i.get(d+p,l+c)||(p=this.p3i(v,l,a,d+p,l+c,v.row!==u||h[l]?0:r),(0,M.w3i)(this.l3i,p)))},e.prototype.p3i=function(t,n,i,r,e,o){var r={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:e,rowCount:t.rowCount+(o=void 0===o?0:o),colCount:Math.min(t.colCount-(n-t.col),i)};return t.group.dataCell=r},e.prototype.n5i=function(){var t=this.BSi.getRange().row,n=this.X2i.row;t<n&&this.c3i(t,n-1,t)},e.prototype.i5i=function(t){var n=this.BSi.getRange().rowEnd,i=this.X2i.rowEnd;i<n&&this.c3i(i+1,n,i+1+t)},e.prototype.c3i=function(t,n,i){for(var r,e,o,u,s,c,f,h,l,a,v,v,d,d,r=this.BSi.getRange(),e=r.col,o=r.colEnd,u=this.X2i.col,s=this.X2i.colEnd-u+1-this.J2i.columnCount,c=i-t,f=new p.SmartCache(0,0,n,o),h=t;h<=n;h++)for(l=e;l<=o;l++)(a=this.BSi.get(h,l))&&!f.get(a.row,a.col)&&(v=a.col>u?-s:0,this.l3i.get(h+c,l+v)||(v=(0,M.e5i)(a,h+c,l+v),a.col<=u&&a.col+a.colCount-1>=u&&(d=(d=v.cellNode.templateCell).colEnd-d.col+1,v.colCount>d&&v.colCount>s&&(v.colCount-=s),l=a.col+a.colCount-1),(0,M.w3i)(this.l3i,v),f.set(a.row,a.col,!0)))},n.ColumnSpliter=e},2148:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.RowSpliter=void 0;var p=i(8346),M=i(4125),r;function e(t,n,i,r){this.J2i=t,this.BSi=n,this.K2i=i,this.X2i=r;var t=this.BSi.getRange(),n=t.row,i=t.col;this.l3i=new p.SmartCache(n,i,-1,-1)}e.prototype.n3i=function(){for(var t,n,i,t,r,e,o,t,u,s,c,f,h,l,u,t=this.J2i,n=t.rowCount,i=t.repeatRows,t=this.X2i,r=t.row,e=t.col,o=t.rowEnd,t=t.colEnd,u=r-this.K2i.row,s=i?i.start+u:-1,c=i?i.end+u:-1,f=t-e+1,h=e,l=r;l<=o;)i&&this.c3i(s,c,s,h),this.$2i(l,r,h),h+=f,l+=n;return this.q2i(u=h-e-f),this.t5i(u),this.o5i(),this.u5i(u),this.l3i},e.prototype.q2i=function(t){var n,i,r,e,o,r,n=this.BSi.getRange().row,i=this.X2i.row;n!==i&&((r=this.J2i.repeatRows)?(e=i-this.K2i.row,o=r.start+e,r=r.end+e+1,n<o&&this.s5i(n,o-1,n,t),r<i&&this.s5i(r,i-1,r,t)):this.s5i(n,i-1,n,t))},e.prototype.t5i=function(t){var n,i,r,n,n=this.J2i.rowCount,i=this.BSi.getRange().rowEnd,r=this.X2i.rowEnd+1;r<=i&&(n=this.X2i.row+n,this.s5i(r,i,n,t))},e.prototype.$2i=function(t,n,i){var r=this.J2i.rowCount,r=Math.min(t+r-1,this.X2i.rowEnd);this.c3i(t,r,n,i)},e.prototype.c3i=function(t,n,i,r){for(var e,o,u,s,c,f,h,l,a,a,e=this.X2i,o=e.col,u=e.colEnd,s=i-t,c=r-o,f=t;f<=n;f++)for(h=n-f+1,l=o;l<=u;l++)this.l3i.get(f+s,l+c)||(a=this.BSi.get(f,l))&&(a=this.p3i(a,f,h,f+s,l+c),(0,M.w3i)(this.l3i,a))},e.prototype.s5i=function(t,n,i,r){for(var e,o,u,s,c,f,h,l,e,a,v,d,p,p,o=this.X2i,u=o.col,s=o.colEnd,c=i-t,f=[],h=[],l=t;l<=n;l++)!(e=null==(e=this.BSi.get(l,u))?void 0:e.cellNode.templateCell)||!e.clearColOffset&&e.hExpansible||(h[l]=!0),e&&e.clearColOffset&&(f[l]=!0);for(l=t;l<=n;l++)for(a=n-l+1,v=void 0,d=u;d<=s;d+=v?v.colCount:1)(v=this.BSi.get(l,d))&&(p=v.col===u||f[l]?0:r,this.l3i.get(l+c,d+p)||(p=this.p3i(v,l,a,l+c,d+p,u!==v.col||h[l]?0:r),(0,M.w3i)(this.l3i,p)))},e.prototype.p3i=function(t,n,i,r,e,o){void 0===o&&(o=0);var r={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:e,rowCount:Math.min(t.rowCount-(n-t.row),i),colCount:t.colCount+o};return t.group.dataCell=r},e.prototype.o5i=function(){var t=this.BSi.getRange().col,n=this.X2i.col;t<n&&this.N3i(t,n-1,t)},e.prototype.u5i=function(t){var n=this.BSi.getRange().colEnd,i=this.X2i.colEnd;i<n&&this.N3i(i+1,n,i+1+t)},e.prototype.N3i=function(t,n,i){for(var r,e,o,u,s,c,f,h,l,a,v,v,d,d,r=this.BSi.getRange(),e=r.row,o=r.rowEnd,u=this.X2i.row,s=this.X2i.rowEnd-u+1-this.J2i.rowCount,c=i-t,f=new p.SmartCache(0,0,o,n),h=t;h<=n;h++)for(l=e;l<=o;l++)(a=this.BSi.get(l,h))&&!f.get(a.row,a.col)&&(v=a.row>u?-s:0,this.l3i.get(l+v,h+c)||(v=(0,M.e5i)(a,l+v,h+c),a.row<=u&&a.row+a.rowCount-1>=u&&(d=(d=v.cellNode.templateCell).rowEnd-d.row+1,v.rowCount>d&&v.rowCount>s&&(v.rowCount-=s),l=a.row+a.rowCount-1),(0,M.w3i)(this.l3i,v),f.set(a.row,a.col,!0)))},n.RowSpliter=e},4125:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.e5i=n.w3i=void 0,n.w3i=function(t,n){for(var i,r,e,o,i=n.row+n.rowCount-1,r=n.col+n.colCount-1,e=n.row;e<=i;e++)for(o=n.col;o<=r;o++)t.set(e,o,n)},n.e5i=function(t,n,i){var n={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:n,col:i,rowCount:t.rowCount,colCount:t.colCount};return t.group.dataCell=n}},355:function(t,n,i){var l,c,r,e,o;function u(t,n,i){this.J2i=t,this.BSi=n,this.wEi=i}l=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.Spliter=void 0,c=i(7789),r=i(2148),e=i(794),u.prototype.n3i=function(){var t,n,t,t=this.c5i();return!t||-1===(n=this.f5i(t)).rowEnd||-1===n.colEnd?this.BSi:(performance.now(),t=new("RowSplit"===this.J2i.type?r.RowSpliter:e.ColumnSpliter)(this.J2i,this.BSi,t,n).n3i(),performance.now(),t)},u.prototype.c5i=function(){var t,n,i,r,e,o,u,s;if(!this.J2i.dataRange)return null;if(2<(t=this.J2i.dataRange.split(":").map(c.kOi)).length)return null;for(n=Number.MAX_VALUE,i=Number.MAX_VALUE,e=r=-1,o=0,u=t.length;o<u;o++){if(!(s=t[o]))return null;n=Math.min(n,s.row),i=Math.min(i,s.col),r=Math.max(r,s.row),e=Math.max(e,s.col)}return{row:n,col:i,rowEnd:r,colEnd:e}},u.prototype.f5i=function(t){var n=Number.MAX_VALUE,i=Number.MAX_VALUE,r=-1,e=-1,o=l(l([],this.wEi.verticalExpansionTrees,!0),this.wEi.horizontalExpansionTrees,!0),u=t.row,s=t.col,c=t.rowEnd,f=t.colEnd,h=function(t){t.dataCell&&(n=Math.min(n,t.dataCell.row),i=Math.min(i,t.dataCell.col),r=Math.max(r,t.dataCell.row+t.dataCell.rowCount-1),e=Math.max(e,t.dataCell.col+t.dataCell.colCount-1)),t.childrenArray&&t.childrenArray.forEach(function(t){t&&t.forEach(h)}),t.crossChildren&&t.crossChildren.forEach(function(t){t&&t.forEach(function(t){t&&t.forEach(h)})})};return o.forEach(function(t){var n,i,r,e,n,i,n=t.root.treeRange,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;i<=u&&r<=s&&c<=e&&f<=n&&((i=t.root.data.groups)[0]&&h(i[0]),1<i.length)&&h(i[i.length-1])}),{row:n,col:i,rowEnd:r,colEnd:e}},n.Spliter=u},4396:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0;var r=i(7789),e;function o(t,n){this.wEi=t,this.N3=n}o.prototype.Pjn=function(t){performance.now(),this.L3i(t),performance.now()},o.prototype.L3i=function(t){var i,t,i=this;this.N3&&(t={verticalExpansionTrees:this.wEi.verticalExpansionTrees,horizontalExpansionTrees:this.wEi.horizontalExpansionTrees,crossCells:this.wEi.crossCells,cellNodeGetter:function(t){var t=(0,r.kOi)(t),n=t.row,t=t.col;return i.wEi.cellNodeCache.get(n,t)},parameter:t},this.N3.generateTreeData(t))},n.TreeDataGenerator=o},8226:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataPopulatorBase=void 0;var r=i(9918),e=i(7789),s=i(1589),o=i(6319),u;function c(){}c.prototype.k3i=function(t){this.DJ=t,this.R3i=this.DJ.tree.pathArray.some(function(t){return t.some(function(t){return t.templateCell.overwriteWhenExpand&&(0,r.G3i)(t)})}),this.BSi=this.DJ.cells,this.s_i=this.DJ.treeGeneratorResult.cellNodeCache,this.B3i=!!this.DJ.dryRun,this.d4i=this.DJ.treeGeneratorResult.templateResolver.getTemplateRange(),this.U3i=this.DJ.paginationContext.enable},c.prototype.EEi=function(){var r=this,t=this.DJ,e=t.templateCellAccessCache,o=t.treeGeneratorResult.cellNodeCache,u=this.DJ.tree.root.treeRange;(0,s.$Ei)(u,function(t,n){var i=o.get(t,n);!i||i.templateCell.isEmpty||e.get(t,n)||i.templateCell.row<u.row||i.templateCell.col<u.col||i.templateCell.row!==t||i.templateCell.col!==n||i.leftParent||i.upParent||0<i.children.length||i.templateCell.dataColumn||"No"!==i.templateCell.expansionDirection||r.H3i(i)})},c.prototype.zEi=function(){var t=this.DJ,n=t.tree.root,t=t.templateCellAccessCache;(0,s.qEi)(t,n.treeRange,!0)},c.prototype.H3i=function(t){var i=this.DJ.cells,r=this.kEi(t);(0,s.$Ei)({row:r.row,col:r.col,rowEnd:r.row+r.rowCount-1,colEnd:r.col+r.colCount-1},function(t,n){return i.set(t,n,r)})},c.prototype.Z3i=function(t,n,i,r,e,o){var u=e.cellNode.templateCell,s=u.row,c=u.col,f=u.rowEnd,u=u.colEnd,e={cellNode:e.cellNode,value:e.value,group:e,row:s+t,col:c+n,rowCount:f-s+1+i,colCount:u-c+1+r};return this.LEi(e,o),e},c.prototype.V3i=function(t,n,i){return this.Z3i(t,n,0,0,i)},c.prototype.LEi=function(t,n,i){(i=void 0===i?!0:i)&&(t.group.dataCell=t);var i=t.cellNode.templateCell;i.hExpansible||(t.colCount=i.colEnd-i.col+1),i.vExpansible||(t.rowCount=i.rowEnd-i.row+1),n&&this.R3i&&this.BSi.get(t.row,t.col)?(0,s.REi)(this.BSi,t):this.w3i(t)},c.prototype.w3i=function(t){var n,i,r,e,o;if(!this.B3i)for(n=this.DJ.cells,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,e=t.row;e<=i;e++)for(o=t.col;o<=r;o++){if(n.get(e,o))return t.rowCount=e-t.row+1-(o===t.col?1:0),void(t.colCount=o-t.col+1-(o===t.col?0:1));n.set(e,o,t)}},c.prototype.Q3i=function(t,n){(0,r.Q3i)(n||this.DJ.expandedRows,t)},c.prototype.Y3i=function(t,n){(0,r.Y3i)(n||this.DJ.expandedCols,t)},c.prototype.SEi=function(t){return(0,r.SEi)(this.DJ.expandedRows,t)},c.prototype.xEi=function(t){return(0,r.xEi)(this.DJ.expandedCols,t)},c.prototype.W3i=function(t,n,i,r,e){var t=t.templateCell,o=t.row,t=t.col,o=this.DJ.treeGeneratorResult.cellNodeCache.get(o,t),u=this.createSubTree(o),t=function(n){return!u.pathArray.some(function(t){return t.some(function(t){var t=t.templateCell;return t.row===n.row&&t.col===n.col})})},s=JSON.parse(JSON.stringify(this.DJ.expandedRows.filter(t))),c=JSON.parse(JSON.stringify(this.DJ.expandedCols.filter(t)));return i&&(i.F3i().forEach(function(n){s.some(function(t){return t.row===n.row&&t.col===n.col})||s.push(n)}),i.J3i().forEach(function(n){c.some(function(t){return t.row===n.row&&t.col===n.col})||c.push(n)})),{tree:u,cells:this.DJ.cells,templateCellAccessCache:this.DJ.templateCellAccessCache,rowOffset:r,colOffset:e,expandedRows:s,expandedCols:c,overwriteRoots:this.DJ.overwriteRoots,treeGeneratorResult:this.DJ.treeGeneratorResult,subTreeContext:this.K3i(n),unCreatedHTreeCellsAfterCrossCells:this.DJ.unCreatedHTreeCellsAfterCrossCells,dryRun:this.DJ.dryRun,paginationContext:this.DJ.paginationContext}},c.prototype.K3i=function(t){var t;return{rootGroups:t,ancestor:(null==(t=this.DJ.subTreeContext)?void 0:t.ancestor)||this.DJ.tree.root}},c.prototype.createSubTree=function(t){var i=(0,e.Q1e)(t);return{root:t,pattern:"Unanalyzed",pathArray:i,crossCells:this.DJ.treeGeneratorResult.crossCells.filter(function(t){var n=t.templateCell;return i.some(function(t){return t.some(function(t){var t=t.templateCell;return n.row===t.row&&n.col===t.col})})})}},c.prototype.X3i=function(){return(this.DJ.subTreeContext?this.DJ.subTreeContext.rootGroups:this.DJ.tree.root.data.groups)||[]},c.prototype.$3i=function(t,n,i,r,e){var o=t.templateCell,u=o.expansionDirection,s=o.row,o=o.col,c=this.W3i(t,n,i,r,e),t=("H"===u?this.MEi:this.gEi).find(function(t){return t.Pit(c.tree)}).ZSi(c),n=t.rowEnd-t.row+1,r=t.colEnd-t.col+1,e=c.tree.root.treeRange,n={rowCount:n-(e.rowEnd-e.row+1),colCount:r-(e.colEnd-e.col+1)};return 0<n.rowCount&&("H"!==u||0===c.tree.crossCells.length)&&i.Q3i({row:s,col:o,expandedCount:n.rowCount}),0<n.colCount&&("H"===u||0===c.tree.crossCells.length)&&i.Y3i({row:s,col:o,expandedCount:n.colCount}),{dataRange:t,expansion:n}},c.prototype.kEi=function(t){var n=t.templateCell,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd,i=this.SEi(i),r=this.xEi(r),e=this.SEi(e+1),n=this.xEi(n+1);return(0,s.kEi)(t,i,r,e,n)},c.prototype.N2i=function(t){var s,n,i,r,s=[];for(t.pathArray.forEach(function(t){return t.forEach(function(t){var n;"Summary"!==(null==(n=t.templateCell.dataSetting)?void 0:n.type)||s.includes(t)||s.push(t)})}),n=function(u){if((0,o.B_t)(t.root,function(t){var t,n,i,r,e,o,t,e,o,r,t;return s[u]!==t&&(n=(t=t.templateCell).row,i=t.col,r=t.dataSetting,e=t.dataColumn,o=t.formula,t=t.expansionDirection,!(!e&&!o||"Summary"===(null==r?void 0:r.type)||"No"===t))&&(o=(e=s[u].templateCell).row,r=e.rowEnd,t=e.col,o<=n)&&n<=r&&t<i}))return{value:!0}},i=0;i<s.length;i++)if("object"==typeof(r=n(i)))return r.value;return!1},n.DataPopulatorBase=c},277:function(t,n,i){var r,e,o,u,s,c;function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.rzi=!1,t.ezi=Number.MAX_SAFE_INTEGER,t}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HDataPopulatorBase=void 0,o=i(8226),u=i(1589),c=o.DataPopulatorBase,e(f,c),f.prototype.k3i=function(t){c.prototype.k3i.call(this,t),this.ozi=[],this.rzi=0<this.DJ.tree.crossCells.length,this.ezi=this.rzi?Math.min.apply(Math,this.DJ.tree.crossCells.map(function(t){return t.templateCell.row})):Number.MAX_SAFE_INTEGER},f.prototype.EEi=function(){c.prototype.EEi.call(this),this.populateCellsAfterCrossCell()},f.prototype.H3i=function(t){var n=t.templateCell,i=n.col,n=n.colEnd,i=this.xEi(i),n=this.xEi(n+1);this.rzi&&t.templateCell.row>this.ezi?this.ozi.push({colOffset:i,expandedRowCount:0,expandedColCount:n-i,group:(0,u.XEi)(t)}):c.prototype.H3i.call(this,t)},f.prototype.populateCellsAfterCrossCell=function(t){var n,n,t,i;0!==this.ozi.length&&(n=this.DJ.tree,n="".concat(n.root.templateCell.row,"-").concat(n.root.templateCell.col),(t=this.Eir(t))&&((i=this.DJ.unCreatedHTreeCellsAfterCrossCells[t])||(this.DJ.unCreatedHTreeCellsAfterCrossCells[t]=i=[]),i.push({rowCol:n,cells:this.ozi})),this.ozi=[])},f.prototype.Eir=function(t){var r,n,t,r=null;return this.DJ.tree.crossCells.forEach(function(t){for(var n=t.leftParent,i=t.leftParent;i;)"V"===i.templateCell.expansionDirection&&(n=i),i=i.leftParent;(!r||n.templateCell.row>=r.templateCell.row)&&(r=n)}),r?(n="".concat(r.templateCell.row,"-").concat(r.templateCell.col),t&&(t=this.jir(t))&&(t.id||(t.id="g".concat((new Date).getTime()).concat(Math.random())),n="".concat(n,"-").concat(t.id)),n):null},f.prototype.jir=function(t){var n;return"V"===t.cellNode.templateCell.expansionDirection?t:t.leftParent&&(n=this.jir(t.leftParent))||t.upParent&&(n=this.jir(t.upParent))?n:null},n.HDataPopulatorBase=f},5856:function(t,n,i){var r,e,o,u,s,c,f;function h(){var t=null!==f&&f.apply(this,arguments)||this;return t.rzi=!1,t.fzi=Number.MAX_SAFE_INTEGER,t}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.VDataPopulatorBase=void 0,o=i(9918),u=i(8226),s=i(6319),f=u.DataPopulatorBase,e(h,f),h.prototype.k3i=function(t){var i,t,r,i=this;f.prototype.k3i.call(this,t),this.hzi={},this.azi={},this.rzi=0<this.DJ.tree.crossCells.length,this.fzi=this.rzi?Math.min.apply(Math,this.DJ.tree.crossCells.map(function(t){return t.templateCell.col})):Number.MAX_SAFE_INTEGER,this.lzi=[],t=this.DJ.tree.crossCells.map(function(t){return(0,s.vzi)(t)}),r=Math.max.apply(Math,t),t.forEach(function(t,n){t===r&&i.lzi.push(i.DJ.tree.crossCells[n])})},h.prototype.dzi=function(t,n,i,r){var e,o,u,e=r.cellNode.templateCell.col,o=this.hzi[e];return void 0===o&&(u=this.xEi(this.DJ.tree.root.templateCell.col),o=this.xEi(e)-u+this.DJ.colOffset,this.hzi[e]=o),this.Z3i(t,o,n,i,r)},h.prototype.pzi=function(t,n,i,r,e){var e,o,u,e=(r||e).cellNode.templateCell.row,o=this.azi[e];return void 0===o&&(u=this.SEi(this.DJ.tree.root.templateCell.row),o=this.SEi(e)-u+this.DJ.rowOffset,this.azi[e]=o),this.Z3i(o,t,n,i,r)},h.prototype.wzi=function(i,r,t,n){var e=this,o=r.templateCell,u=o.row,s=o.col,c=o.rowEnd,f=o.colEnd,o=r.leftParent.templateCell,h=o.row,o=o.rowEnd,l=c-u+1+(u===h&&c===o?n:0);t.forEach(function(t){var n,t;t&&t[0]&&(n=e.gzi(r,t[0].upParent),t={cellNode:r,value:t[0].value,group:t[0],row:u+i,col:s+n,rowCount:l,colCount:f-s+1},e.LEi(t))})},h.prototype.gzi=function(t,n){var t,i;return n.dataCell&&n.expandedCols?(t=(0,o.xEi)(n.expandedCols,t.templateCell.col),i=(0,o.xEi)(n.expandedCols,n.cellNode.templateCell.col),n.dataCell.col-n.cellNode.templateCell.col+(t-i)):0},h.prototype.Mzi=function(t){var n,i,i,r,n=this,i=this.DJ.tree,i="".concat(i.root.templateCell.row,"-").concat(i.root.templateCell.col);t&&(i="".concat(i,"-").concat(t.id)),(r=this.DJ.unCreatedHTreeCellsAfterCrossCells[i])&&0!==r.length&&(this.jzi=t,r.forEach(function(t){t.cells.forEach(function(t){return n.pzi(t.colOffset,t.expandedRowCount,t.expandedColCount,t.group,null)})}),this.DJ.unCreatedHTreeCellsAfterCrossCells[i]=void 0,this.jzi=void 0)},n.VDataPopulatorBase=h},7528:function(t,n,i){var r,e,o,u,s,c,f,M,w,I,h,l;function a(){return null!==l&&l.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HCommonDataPopulator=void 0,o=i(7789),u=i(277),s=i(8357),c=i(9955),f=i(470),M=i(6319),w=i(1589),I=i(9918),l=u.HDataPopulatorBase,e(a,l),a.prototype.Pit=function(t){return"H"===t.root.templateCell.expansionDirection&&(t.pattern="HorizontalCommon",!0)},a.prototype.ZSi=function(t){return this.k3i(t),this.Czi()},a.prototype.k3i=function(t){l.prototype.k3i.call(this,t),this.gEi=(0,f.createVTreeDataPopulators)(),this.MEi=(0,s.createHTreeDataPopulators)(),this.Dyt=this.DJ.rowOffset,this._yt=this.DJ.colOffset,this.mzi=this.DJ.rowOffset,this.Nzi=this.DJ.colOffset,this.bzi=0,this.Ozi=0,this.yzi=0,this.Izi=new c.ExpandedCountHelper(t.overwriteRoots)},a.prototype.Czi=function(){var t,u,s,i,n,r,c,f,n,h,l,a,t,n,e,o,t,v,d,p,o,v,u=this,s=this.DJ.tree,i=s.root.children.filter(function(t){return!(t.upParent&&t.leftParent||(0,w.lEi)(t)||0!==t.children.length)}),n=s.root.children.filter(function(t){return(0,w.lEi)(t)||0!==t.children.length}).filter(function(t){return!t.leftParent||!t.upParent}),r=n.filter(function(t){return"H"===t.templateCell.expansionDirection}),c=n.filter(function(t){return"H"!==t.templateCell.expansionDirection}),f=s.root.children.filter(function(t){return t.upParent&&t.leftParent}),n=this.X3i(),h=(null==(t=s.root.templateCell.lineBreakOption)?void 0:t.groupsCount)||Number.MAX_SAFE_INTEGER,l=[],a=1;return n.forEach(function(e){var o,n,t,t,o=[];u.Izi.c5(),r.forEach(function(t){return u._zi(t,e,o)}),n=[],c.forEach(function(t){u.Dzi(t)?n.push(t):u._zi(t,e,o)}),f.forEach(function(t){var n,n,n,n=e.crossChildren[t.indexOfUpParentChildren],n=n&&0!==n.length?n[0]:[];u.Azi(t),n=u.Tzi(n,t),o.push(n),(0,I.Szi)(t,n,u.Izi)}),i.forEach(function(t){u.Azi(t);var n=(0,I.xzi)(u.DJ,u.Izi,t),i=(0,M.Ezi)(s.root,t),r=(0,M.zzi)(s.root,t);o.push(u.Pzi(e.childrenArray[(0,w.KEi)(e.cellNode,t)][0],i?0:n.rowCount,r?0:n.colCount,!0))}),u.populateCellsAfterCrossCell(e),n.forEach(function(t){return u._zi(t,e,o)}),u.Azi(e.cellNode),t=(0,I.xzi)(u.DJ,u.Izi,e.cellNode),o.push(u.Pzi(e,t.rowCount,t.colCount)),t=(0,M.Lzi)(o),l.push(t),a===h?(a=1,u.Ozi=0,u.bzi+=u.yzi):(a++,u.Ozi+=t.colEnd-t.col+1,u.yzi=Math.max(u.yzi,t.rowEnd-t.row+1)),u.rzi&&(e.expandedCols=u.Izi.J3i())}),n=(t=s.root.treeRange).row,e=t.col,o=t.rowEnd,t=t.colEnd,o=(v=(0,M.Lzi)(l)).rowEnd-v.row+1-(d=o-n+1),v=v.colEnd-v.col+1-(p=t-e+1),(0,I.kzi)(s.root)&&(0<o&&0===s.crossCells.length&&this.Q3i({row:n,col:e,expandedCount:o}),0<v)&&this.Y3i({row:n,col:e,expandedCount:v}),{row:s.root.treeRange.row+this.DJ.rowOffset,col:s.root.treeRange.col+this.DJ.colOffset,rowEnd:s.root.treeRange.rowEnd+this.DJ.rowOffset+o,colEnd:s.root.treeRange.colEnd+this.DJ.colOffset+v}},a.prototype.Azi=function(t){this.Dyt=this.Izi.SEi(t.templateCell.row)+this.mzi+this.bzi,this._yt=this.Izi.xEi(t.templateCell.col)+this.Nzi+this.Ozi},a.prototype._zi=function(t,n,i){this.Azi(t);var n=this.$3i(t,n.childrenArray[(0,w.KEi)(n.cellNode,t)],this.Izi,this.Dyt,this._yt);i.push(n.dataRange)},a.prototype.Pzi=function(t,n,i,r){var e,e,e,n,r,e=t.cellNode;return!(this.rzi&&e.templateCell.row>this.ezi)||(e=e.upParent||e.leftParent).leftParent&&e.upParent?{row:n=(e=this.Z3i(this.Dyt,this._yt,n,i,t,r)).row,col:r=e.col,rowEnd:n+e.rowCount-1,colEnd:r+e.colCount-1}:(this.ozi.push({colOffset:this._yt,expandedRowCount:0,expandedColCount:i,group:t}),null)},a.prototype.Dzi=function(n){var i;return"V"===n.templateCell.expansionDirection&&((i=!1,o.H4i)(n,function(t){return!(t===n||!t.leftParent||!t.upParent||(i=!0,0))}),i)},a.prototype.Tzi=function(t,n){var r=this,n=n.templateCell,e=n.row,o=n.col,u=n.rowEnd,s=n.colEnd,c=n.expansionDirection,n=this.DJ.treeGeneratorResult.cellNodeCache.get(e,o).treeRange,f=n.rowEnd-n.row+1,h=n.colEnd-n.col+1,l=[{row:n.row+this.Dyt,col:n.col+this._yt,rowEnd:n.rowEnd+this.Dyt,colEnd:n.colEnd+this._yt}];return t.forEach(function(t,n){var i=r.Dyt+("V"===c?n*f:0),n=r._yt+("H"===c?n*h:0);l.push({row:e+i,col:o+n,rowEnd:u+i,colEnd:s+n})}),(0,M.Lzi)(l)},n.HCommonDataPopulator=a},9078:function(t,n,i){var r,e,o,u;function s(){return null!==u&&u.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HFreeDataPopulator=void 0,u=i(8226).DataPopulatorBase,e(s,u),s.prototype.Pit=function(t){var n,i;return"H"===t.root.templateCell.expansionDirection&&1!==t.pathArray.length&&!!t.pathArray.every(function(t){return 2===t.length})&&!t.pathArray.some(function(t){return t.some(function(t){return t.leftParent&&t.upParent})})&&!(t.root.data.groups.some(function(t){return t.childrenArray.some(function(t){return 1<t.length})})||(n=t.pathArray.some(function(t){return t[1].templateCell.row!==t[0].templateCell.row}),i=t.pathArray.some(function(t){return t[1].templateCell.col!==t[0].templateCell.col}),!n)||!i||(t.pattern="HorizontalFree",0))},s.prototype.ZSi=function(t){var n,e,t,i,r,t,o,u,s,n,i,r,c,f,h,r,l,r,a,a,i,e=this;return this.k3i(t),i=(t=this.DJ).rowOffset,r=t.colOffset,t=t.tree,o=i,u=r,s=(null==(n=t.root.templateCell.lineBreakOption)?void 0:n.groupsCount)||Number.MAX_SAFE_INTEGER,n={row:t.root.treeRange.row+i,col:t.root.treeRange.col+r,rowEnd:t.root.treeRange.rowEnd+i,colEnd:t.root.treeRange.colEnd+r},0!==(i=this.X3i()).length&&(r=t.root.treeRange,c=r.rowEnd-r.row+1,f=r.colEnd-r.col+1,h=t.root.children,i.forEach(function(r,t){s!==Number.MAX_SAFE_INTEGER&&(e.DJ.rowOffset=o+(Math.ceil((t+1)/s)-1)*c,e.DJ.colOffset=u+t%s*f);var t=r.cellNode.templateCell,t={cellNode:r.cellNode,value:r.value,group:r,row:t.row+e.DJ.rowOffset,col:t.col+e.DJ.colOffset,rowCount:t.rowEnd-t.row+1,colCount:t.colEnd-t.col+1};e.LEi(t,null),h.forEach(function(t,n){var n=r.childrenArray[n][0],i=t.templateCell,t={cellNode:t,value:n.value,group:n,row:i.row+e.DJ.rowOffset,col:i.col+e.DJ.colOffset,rowCount:i.rowEnd-i.row+1,colCount:i.colEnd-i.col+1};e.LEi(t)}),s===Number.MAX_SAFE_INTEGER&&(e.DJ.colOffset+=f)}),l=(r=t.root.templateCell).row,r=r.col,s===Number.MAX_SAFE_INTEGER?(a=f*(i.length-1),n.colEnd=u+t.root.treeRange.colEnd+a,0<a&&this.Y3i({row:l,col:r,expandedCount:a})):(a=(Math.ceil(i.length/s)-1)*c,n.rowEnd=o+t.root.treeRange.rowEnd+a,i=(Math.min(s,i.length)-1)*f,n.colEnd=u+t.root.treeRange.colEnd+i,0<a&&this.Q3i({row:l,col:r,expandedCount:a}),0<i&&this.Y3i({row:l,col:r,expandedCount:i}))),n},n.HFreeDataPopulator=s},750:function(t,n,i){var r,e,f,o,h,u,s;function c(){return null!==s&&s.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HNormalDataPopulator=void 0,f=i(1589),o=i(277),h=i(9918),s=o.HDataPopulatorBase,e(c,s),c.prototype.Pit=function(t){var n,i,r,n,e,o,u;return"H"===t.root.templateCell.expansionDirection&&!t.crossCells.some(function(t){return 0<t.children.length})&&!((t.root.leftParent||t.root.upParent)&&0<t.crossCells.length||t.pathArray.some(function(t){return t.some(function(t){return t.leftParent&&"H"===t.leftParent.templateCell.expansionDirection})})||(n=t.root.templateCell,i=n.col,r=n.colEnd,n=t.pathArray.every(function(t){return t.every(function(t){return t.templateCell.col===i&&t.templateCell.colEnd===r})}),e=!t.pathArray.some(function(t){return t.some(function(t){return!("V"!==t.templateCell.expansionDirection||t.leftParent&&t.upParent)})}),o=!t.pathArray.some(function(t){return t.some(function(t){return"No"===t.templateCell.expansionDirection&&0<t.children.length&&(!t.upParent||!t.leftParent)})}),u=!this.N2i(t),!(n&&e&&o&&u))||(t.pattern="HorizontalNormal",0))},c.prototype.ZSi=function(t){var n,i,r,t,e,n=t.rowOffset,i=t.colOffset,r=t.tree;return this.k3i(t),this.Rzi(),t=this.Gzi(),e=this.Bzi(),this.populateCellsAfterCrossCell(),{row:r.root.treeRange.row+n,col:r.root.treeRange.col+i,rowEnd:r.root.treeRange.rowEnd+n+e,colEnd:r.root.treeRange.colEnd+i+t}},c.prototype.k3i=function(t){s.prototype.k3i.call(this,t),this.Dyt=this.DJ.rowOffset;var t=this.DJ.tree.root;this.Uzi=t.templateCell.overwriteWhenExpand&&(0,h.G3i)(t)},c.prototype.Q3i=function(t,n){this.Uzi||s.prototype.Q3i.call(this,t,n)},c.prototype.Y3i=function(t,n){this.Uzi||s.prototype.Y3i.call(this,t,n)},c.prototype.Rzi=function(){this.Uzi&&(0,h.Rzi)(this.DJ.overwriteRoots,this.DJ.tree.root)},c.prototype.Gzi=function(){var t,t,n,i,n,t=this.X3i(),t=this.Hzi(t,this.DJ.colOffset);return t&&(i=(n=this.DJ.tree.root.templateCell).row,n=n.col,this.Y3i({row:i,col:n,expandedCount:t})),t},c.prototype.Hzi=function(t,n){var i,r,t,t,i=this;return 0===t.length?0:(r=0,t.forEach(function(t){r+=i.Zzi(t,r+n)}),t=(t=t[0].cellNode.templateCell).colEnd-t.col+1,r-t)},c.prototype.Zzi=function(r,e){var o,i,t,u,s,c,o=this,i=r.cellNode.templateCell,t=this.s_i.get(i.row,i.col);return t?(u=[],r.childrenArray.forEach(function(t,n){var n,t,n,i,n,n=r.cellNode.children[n];(0,f.lEi)(n)&&0!==(t=o.Hzi(t,(0,h.xEi)(u,n.templateCell.col)+e))&&(i=(n=n.templateCell).row,n=n.col,(0,h.Y3i)(u,{row:i,col:n,expandedCount:t}))}),r.crossChildren.forEach(function(t,n){var n,t,n,i,n;t&&0!==t.length&&(n=r.cellNode.children[n],(0,f.lEi)(n))&&0!==(t=o.Vzi(t,n))&&(i=(n=n.templateCell).row,n=n.col,(0,h.Y3i)(u,{row:i,col:n,expandedCount:t}))}),s=(0,h.xEi)(u,Number.MAX_SAFE_INTEGER),c=this.Qzi(e,s,r),t.children.forEach(function(t,n){(0,f.lEi)(t)||t.leftParent&&t.upParent||!r.childrenArray[n]||(t.templateCell.col===i.col&&t.templateCell.colEnd===i.colEnd?o.Qzi(e,s,r.childrenArray[n][0],c):o.Qzi((0,h.xEi)(u,t.templateCell.col)+e,0,r.childrenArray[n][0]))}),this.rzi&&(r.expandedCols=u),i.colEnd-i.col+1+s):0},c.prototype.Qzi=function(t,n,i,r){var e,o,u,s,e,e,e,e,e=i.cellNode.templateCell,o=e.row,u=e.col,s=e.rowEnd,e=e.colEnd;return(r=r||e-u+1+n,!(this.rzi&&o>this.ezi)||(e=(e=i.cellNode).upParent||e.leftParent).leftParent&&e.upParent)?(e={cellNode:i.cellNode,value:i.value,group:i,row:o+this.Dyt,col:u+t,rowCount:s-o+1,colCount:r},this.LEi(e)):this.ozi.push({colOffset:t,expandedRowCount:0,expandedColCount:n,group:i}),r},c.prototype.Bzi=function(){return this.rzi?this.SEi(this.DJ.tree.root.treeRange.rowEnd+1)-this.SEi(this.DJ.tree.root.treeRange.row):0},c.prototype.Vzi=function(t,n){var n,i,r,n=n.templateCell,i=n.colEnd-n.col+1;return 0===t.length||"H"!==n.expansionDirection?0:(r=0,t.forEach(function(t){var t=(t.length-1)*i;r<t&&(r=t)}),r)},n.HNormalDataPopulator=c},8357:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.createHTreeDataPopulators=void 0;var r=i(750),e=i(9078),o=i(7528);n.createHTreeDataPopulators=function(){return[new r.HNormalDataPopulator,new e.HFreeDataPopulator,new o.HCommonDataPopulator]}},9955:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ExpandedCountHelper=void 0;var r=i(9918),e;function o(t){this.vEi=[],this.dEi=[],this.pEi=t}o.prototype.c5=function(){this.vEi=[],this.dEi=[]},o.prototype.Q3i=function(t){this.Xzi(t.row,t.col)||(0,r.Q3i)(this.vEi,t)},o.prototype.Y3i=function(t){this.Xzi(t.row,t.col)||(0,r.Y3i)(this.dEi,t)},o.prototype.SEi=function(t){return(0,r.SEi)(this.vEi,t)},o.prototype.xEi=function(t){return(0,r.xEi)(this.dEi,t)},o.prototype.$zi=function(t){return(0,r.$zi)(this.vEi,this.dEi,t)},o.prototype.F3i=function(){return JSON.parse(JSON.stringify(this.vEi))},o.prototype.J3i=function(){return JSON.parse(JSON.stringify(this.dEi))},o.prototype.Xzi=function(n,i){return this.pEi.some(function(t){return t.templateCell.row===n&&t.templateCell.col===i})},n.ExpandedCountHelper=o},9918:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.G3i=n.Szi=n.Rzi=n.kzi=n.xzi=n.Rs=n.BN=n.$zi=n.xEi=n.SEi=n.Y3i=n.Q3i=void 0;var s=i(6319);function r(t,n,i){return{rowCount:e(t,i),colCount:o(n,i)}}function e(t,n){var n=n.templateCell,i=n.row,r=n.rowEnd;return t.reduce(function(t,n){return n.row>=i&&n.row<=r&&(t+=n.expandedCount),t},0)}function o(t,n){var n=n.templateCell,i=n.col,r=n.colEnd;return t.reduce(function(t,n){return n.col>=i&&n.col<=r&&(t+=n.expandedCount),t},0)}function u(t){return t.leftParent||t.upParent||0<t.children.length||"No"!==t.templateCell.expansionDirection}function c(t,n){var i,i,r,i,r,i,r,e;if("V"===n.templateCell.expansionDirection&&(r=(i=n.templateCell).row,i=i.rowEnd,t.templateCell.row!==r||t.templateCell.rowEnd!==i))return!1;if("H"===n.templateCell.expansionDirection&&(i=(r=n.templateCell).col,r=r.colEnd,t.templateCell.col!==i||t.templateCell.colEnd!==r))return!1;if("Group"===(null==(i=t.templateCell.dataSetting)?void 0:i.type))return!1;for(e=0;e<t.children.length;e++)if(!c(t.children[e],n))return!1;return!0}n.Q3i=function(t,n){var i=t.findIndex(function(t){return t.row===n.row});-1!==i?n.expandedCount>t[i].expandedCount&&(t[i]=n):t.push(n)},n.Y3i=function(t,n){var i=t.findIndex(function(t){return t.col===n.col});-1!==i?n.expandedCount>t[i].expandedCount&&(t[i]=n):t.push(n)},n.SEi=function(t,i,r,e){var o=0;return t.forEach(function(t){if(void 0!==r&&e){var n=e[t.row];if(n&&n.includes(r))return}i>t.row&&(o+=t.expandedCount)}),o},n.xEi=function(t,i,r,e){var o=0;return t.forEach(function(t){if(void 0!==r&&e){var n=e[t.col];if(n&&n.includes(r))return}i>t.col&&(o+=t.expandedCount)}),o},n.$zi=r,n.BN=e,n.Rs=o,n.xzi=function(t,n,i){var n,t,n=n.$zi(i);return u(t.tree.root)?n:(t=r(t.expandedRows,t.expandedCols,i),{rowCount:n.rowCount+t.rowCount,colCount:n.colCount+t.colCount})},n.kzi=u,n.Rzi=function(t,n){var i=n.templateCell,r=i.row,e=i.col;t.find(function(t){return t.templateCell.row===r&&t.templateCell.col===e})||t.push(n)},n.Szi=function(t,n,i){var r,e,r,e,n,r,o,u,r,r=t.treeRange,e=r.rowEnd-r.row-1,r=r.colEnd-r.col-1,e=n.rowEnd-n.row-1-e,n=n.colEnd-n.col-1-r;0<e&&(o=(r=(0,s.qzi)(t,"V").templateCell).row,u=r.col,i.Q3i({row:o,col:u,expandedCount:e})),0<n&&(o=(r=(0,s.qzi)(t,"H").templateCell).row,u=r.col,i.Y3i({row:o,col:u,expandedCount:n}))},n.G3i=function(t){return c(t,t)}},6319:function(t,n){function r(t,n){if(n(t))return!0;for(var i=0;i<t.children.length;i++)if(r(t.children[i],n))return!0;return!1}Object.defineProperty(n,"__esModule",{value:!0}),n.qzi=n.zzi=n.Ezi=n.B_t=n.Kzi=n.vzi=n.Lzi=void 0,n.Lzi=function(t){var n=Number.MAX_SAFE_INTEGER,i=0,r=Number.MAX_SAFE_INTEGER,e=0;return t.forEach(function(t){t&&(t.col<r&&(r=t.col),t.colEnd>e&&(e=t.colEnd),t.row<n&&(n=t.row),t.rowEnd>i)&&(i=t.rowEnd)}),{row:n,col:r,rowEnd:i,colEnd:e}},n.vzi=function(t){for(var n=0;t.upParent;)n++,t=t.upParent;return n},n.Kzi=function(t){return{value:t.templateCell.value,leftParent:null,upParent:null,childrenArray:t.children.map(function(){return[]}),crossChildren:t.children.map(function(){return[]}),cellNode:t,dataCell:null,state:"normal"}},n.B_t=r,n.Ezi=function(n,i){return r(n,function(t){return t!==i&&t!==n&&t.templateCell.row>=i.templateCell.row&&"No"!==t.templateCell.expansionDirection&&(t.templateCell.col<=i.templateCell.col&&t.templateCell.colEnd>=i.templateCell.colEnd||t.templateCell.col>=i.templateCell.col&&t.templateCell.col<i.templateCell.colEnd||t.templateCell.colEnd>i.templateCell.col&&t.templateCell.colEnd<=i.templateCell.colEnd)})},n.zzi=function(n,i){return r(n,function(t){return t!==i&&t!==n&&t.templateCell.col>=i.templateCell.col&&"No"!==t.templateCell.expansionDirection&&(t.templateCell.row<=i.templateCell.row&&t.templateCell.rowEnd>=i.templateCell.rowEnd||t.templateCell.row>=i.templateCell.row&&t.templateCell.row<i.templateCell.rowEnd||t.templateCell.rowEnd>i.templateCell.row&&t.templateCell.rowEnd<=i.templateCell.rowEnd)})},n.qzi=function(t,n){for(var i,r,i=[t];0<i.length;){if((r=i.shift()).templateCell.expansionDirection===n&&(r.templateCell.formula||r.templateCell.dataColumn))return r;r.leftParent&&i.push(r.leftParent),r.upParent&&i.push(r.upParent)}return t}},4305:function(t,n,i){var r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i(8357),n),e(i(470),n)},470:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.createVTreeDataPopulators=void 0;var r=i(3443),e=i(2942),o=i(839);n.createVTreeDataPopulators=function(){return[new e.VFreeDataPopulator,new r.VNormalDataPopulator,new o.VCommonDataPopulator]}},839:function(t,n,i){var r,e,c,o,u,s,f,h,d,p,M,l,a;function v(){return null!==a&&a.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.VCommonDataPopulator=void 0,o=i(7789),u=i(5856),s=i(8357),f=i(9955),h=i(470),d=i(6319),p=i(1589),M=i(9918),a=u.VDataPopulatorBase,e(v,a),v.prototype.Pit=function(t){return"No"===t.root.templateCell.expansionDirection?(t.pattern="NoExpansionNode",!0):"V"===t.root.templateCell.expansionDirection&&(t.pattern="VerticalCommon",!0)},v.prototype.ZSi=function(t){this.k3i(t);var t=this.Czi();return this.Mzi(),t},v.prototype.k3i=function(t){a.prototype.k3i.call(this,t),this.gEi=(0,h.createVTreeDataPopulators)(),this.MEi=(0,s.createHTreeDataPopulators)(),this.Dyt=this.DJ.rowOffset,this._yt=this.DJ.colOffset,this.mzi=this.DJ.rowOffset,this.Nzi=this.DJ.colOffset,this.bzi=0,this.Ozi=0,this.f2i=0,this.Izi=new f.ExpandedCountHelper(t.overwriteRoots)},v.prototype.pzi=function(t,n,i,r,e){var o,u,u,s;return this.jzi?(u=(o=(r||e).cellNode).templateCell.row,u=this.jzi?"".concat(u,"-").concat(this.jzi.id):u,void 0===(s=this.azi[u])&&(this.Azi(o),s=this.Dyt,this.azi[u]=s),this.Z3i(s,t,n,i,r)):a.prototype.pzi.call(this,t,n,i,r,e)},v.prototype.Czi=function(){var t,u,s,n,i,r,c,f,i,h,l,a,v,t,i,e,o,e,i,o,e,t,u=this,s=this.DJ.tree,n=s.root.children.filter(function(t){return!(t.upParent&&t.leftParent||(0,p.lEi)(t)||0!==t.children.length)}),i=s.root.children.filter(function(t){return(0,p.lEi)(t)||0!==t.children.length}).filter(function(t){return!t.upParent||!t.leftParent}),r=i.filter(function(t){return"H"===t.templateCell.expansionDirection}),c=i.filter(function(t){return"H"!==t.templateCell.expansionDirection}),f=s.root.children.filter(function(t){return t.upParent&&t.leftParent}),i=this.X3i(),h=(null==(t=s.root.templateCell.lineBreakOption)?void 0:t.groupsCount)||Number.MAX_SAFE_INTEGER,l=[],a=1,v=r.map(function(){return[]});return i.forEach(function(e){var o,t,t,o=[];u.Izi.c5(),r.forEach(function(t,n){return v[n].push(u._zi(t,e,o))}),c.forEach(function(t){return u._zi(t,e,o)}),f.forEach(function(i){var t,r;u.Azi(i),(t=e.crossChildren[i.indexOfLeftParentChildren])&&0!==t.length&&(r=[],t.forEach(function(t){var n,n,n=t[0];n&&(n.upParent.dataCell&&(u._yt=u.gzi(i,n.upParent)),n=u.$3i(i,t,u.Izi,u.Dyt,u._yt),o.push(n.dataRange),r.push(n.dataRange))}),(0,M.Szi)(i,(0,d.Lzi)(r),u.Izi))}),n.forEach(function(t){u.Azi(t,!0);var n=(0,M.xzi)(u.DJ,u.Izi,t),i=(0,d.Ezi)(s.root,t),r=(0,d.zzi)(s.root,t);o.push(u.Pzi(e.childrenArray[(0,p.KEi)(e.cellNode,t)][0],i?0:n.rowCount,r?0:n.colCount,!0))}),u.Azi(e.cellNode),t=u.$zi(u.DJ,u.Izi,e),o.push(u.Pzi(e,t.rowCount,t.colCount)),t=(0,d.Lzi)(o),l.push(t),u.Mzi(e),a===h?(a=1,u.bzi=0,u.Ozi+=u.f2i):(a++,u.bzi+=t.rowEnd-t.row+1,u.f2i=Math.max(u.f2i,t.colEnd-t.col+1))}),t=(0,d.Lzi)(l),e=(i=s.root.treeRange).row,o=i.col,e=i.rowEnd-e+1,i=i.colEnd-o+1,o=t.rowEnd-t.row+1-e,e=t.colEnd-t.col+1-i,(0,M.kzi)(s.root)&&(t=s.root.templateCell,0<o&&this.Q3i({row:t.row,col:t.col,expandedCount:o}),0<e)&&(0<r.length&&this.Dir(c,f)?this.Oir(r,v):0===s.crossCells.length&&this.Y3i({row:t.row,col:t.col,expandedCount:e})),{row:s.root.treeRange.row+this.DJ.rowOffset,col:s.root.treeRange.col+this.DJ.colOffset,rowEnd:s.root.treeRange.rowEnd+this.DJ.rowOffset+o,colEnd:s.root.treeRange.colEnd+this.DJ.colOffset+e}},v.prototype._zi=function(t,n,i){this.Azi(t,!0);var n=this.$3i(t,n.childrenArray[(0,p.KEi)(n.cellNode,t)],this.Izi,this.Dyt,this._yt);return i.push(n.dataRange),n.dataRange},v.prototype.Azi=function(t,n){void 0===n&&(n=!1),this.Dyt=this.Izi.SEi(t.templateCell.row)+this.mzi+this.bzi,n&&this.a2i(t)||(this._yt=this.Izi.xEi(t.templateCell.col)+this.Nzi+this.Ozi)},v.prototype.a2i=function(e){var t,o,n,i,t,u,s,t,r,o=c(c([],this.DJ.treeGeneratorResult.verticalExpansionTrees,!0),this.DJ.treeGeneratorResult.horizontalExpansionTrees,!0),n=this.DJ.tree.root.treeRange,i=(null==(t=this.DJ.subTreeContext)?void 0:t.ancestor)||this.DJ.tree;return!!(o.some(function(t){return t!==i&&t.root.templateCell.col>n.col&&t.root.templateCell.col<n.colEnd})&&(t=e.templateCell.col,u=[],s=[],this.DJ.expandedCols.forEach(function(n){var t,i,r,i,t,t=o.find(function(t){return t.root.treeRange.row===n.row&&t.root.treeRange.col===n.col});t&&(r=(i=e.templateCell).row,i=i.col,r>=(t=t.root.treeRange).row&&r<=t.rowEnd&&i>=t.col&&i<=t.colEnd||(u.push(n),s.push(t)))}),(t=(0,M.xEi)(u,t))>this.Nzi))&&(r=this.Izi.J3i().filter(function(r){return!s.some(function(t){var n=r.row,i=r.col;return n>=t.row&&n<=t.rowEnd&&i>=t.col&&i<=t.colEnd})}),this._yt=(0,M.xEi)(r,e.templateCell.col)+t+this.Ozi,!0)},v.prototype.Oir=function(t,e){var o=this,n=e[e.length-1],u=-1,i=-1;n.forEach(function(t,n){t.colEnd>i&&(u=n,i=t.colEnd)}),t.forEach(function(t,n){var n=e[n][u],i=t.treeRange,r=i.col,i=i.colEnd-r+1,r=n.colEnd-n.col+1-i;o.Y3i({row:t.templateCell.row,col:t.templateCell.col,expandedCount:r})})},v.prototype.Dir=function(t,n){return!(t.some(function(t){return(0,o.H4i)(t,function(t){return"H"===t.templateCell.expansionDirection})})||n.some(function(t){return(0,o.H4i)(t,function(t){return"H"===t.templateCell.expansionDirection})}))},v.prototype.$zi=function(t,n,i){var t,n,r,r,t=(0,M.xzi)(t,n,i.cellNode);return i.leftParent&&i.upParent&&i.upParent.dataCell&&(n=i.upParent.cellNode.templateCell,(r=i.cellNode.templateCell).col===n.col)&&r.colEnd===n.colEnd&&(r=i.upParent.dataCell,t.colCount=r.colCount-(n.colEnd-n.col+1)),t},v.prototype.Pzi=function(t,n,i,r){var n=this.Z3i(this.Dyt,this._yt,n,i,t,r),i=n.row,t=n.col;return{row:i,col:t,rowEnd:i+n.rowCount-1,colEnd:t+n.colCount-1}},n.VCommonDataPopulator=v},2942:function(t,n,i){var r,e,o,u;function s(){return null!==u&&u.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.VFreeDataPopulator=void 0,u=i(8226).DataPopulatorBase,e(s,u),s.prototype.Pit=function(t){var n,i;return"V"===t.root.templateCell.expansionDirection&&1!==t.pathArray.length&&!!t.pathArray.every(function(t){return 2===t.length})&&!t.pathArray.some(function(t){return t.some(function(t){return t.leftParent&&t.upParent})})&&!(t.root.data.groups.some(function(t){return t.childrenArray.some(function(t){return 1<t.length})})||(n=t.pathArray.some(function(t){return t[1].templateCell.row!==t[0].templateCell.row}),i=t.pathArray.some(function(t){return t[1].templateCell.col!==t[0].templateCell.col}),!n)||!i||(t.pattern="VerticalFree",0))},s.prototype.ZSi=function(t){var n,e,t,i,r,t,o,u,s,n,i,r,c,f,h,r,l,r,a,a,i,e=this;return this.k3i(t),i=(t=this.DJ).rowOffset,r=t.colOffset,t=t.tree,o=i,u=r,s=(null==(n=t.root.templateCell.lineBreakOption)?void 0:n.groupsCount)||Number.MAX_SAFE_INTEGER,n={row:t.root.treeRange.row+i,col:t.root.treeRange.col+r,rowEnd:t.root.treeRange.rowEnd+i,colEnd:t.root.treeRange.colEnd+r},0!==(i=this.X3i()).length&&(r=t.root.treeRange,c=r.rowEnd-r.row+1,f=r.colEnd-r.col+1,h=t.root.children,i.forEach(function(r,t){s!==Number.MAX_SAFE_INTEGER&&(e.DJ.rowOffset=o+t%s*c,e.DJ.colOffset=u+(Math.ceil((t+1)/s)-1)*f);var t=r.cellNode.templateCell,t={cellNode:r.cellNode,value:r.value,group:r,row:t.row+e.DJ.rowOffset,col:t.col+e.DJ.colOffset,rowCount:t.rowEnd-t.row+1,colCount:t.colEnd-t.col+1};e.LEi(t,null),h.forEach(function(t,n){var n=r.childrenArray[n][0],i=t.templateCell,t={cellNode:t,value:n.value,group:n,row:i.row+e.DJ.rowOffset,col:i.col+e.DJ.colOffset,rowCount:i.rowEnd-i.row+1,colCount:i.colEnd-i.col+1};e.LEi(t,null)}),s===Number.MAX_SAFE_INTEGER&&(e.DJ.rowOffset+=c)}),l=(r=t.root.templateCell).row,r=r.col,s===Number.MAX_SAFE_INTEGER?(a=c*(i.length-1),n.rowEnd=o+t.root.treeRange.rowEnd+a,0<a&&this.Q3i({row:l,col:r,expandedCount:a})):(a=(Math.min(s,i.length)-1)*c,n.rowEnd=o+t.root.treeRange.rowEnd+a,i=(Math.ceil(i.length/s)-1)*f,n.colEnd=u+t.root.treeRange.colEnd+i,0<a&&this.Q3i({row:l,col:r,expandedCount:a}),0<i&&this.Y3i({row:l,col:r,expandedCount:i}))),n},n.VFreeDataPopulator=s},3443:function(t,n,i){var r,e,h,l,o,f,u,s;function c(){var t=null!==s&&s.apply(this,arguments)||this;return t.m2i=!0,t}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.VNormalDataPopulator=void 0,h=i(8346),l=i(1589),o=i(5856),f=i(9918),s=o.VDataPopulatorBase,e(c,s),c.prototype.Pit=function(t){var n,i,r,n,e,o,u;return"V"===t.root.templateCell.expansionDirection&&!t.crossCells.some(function(t){return 0<t.children.length})&&!((t.root.leftParent||t.root.upParent)&&0<t.crossCells.length||t.pathArray.some(function(t){return t.some(function(t){return t.upParent&&"V"===t.upParent.templateCell.expansionDirection})})||(n=t.root.templateCell,i=n.row,r=n.rowEnd,n=t.pathArray.every(function(t){return t.every(function(t){return t.templateCell.row===i&&t.templateCell.rowEnd===r})}),e=!t.pathArray.some(function(t){return t.some(function(t){return!("H"!==t.templateCell.expansionDirection||t.upParent&&t.leftParent)})}),o=!t.pathArray.some(function(t){return t.some(function(t){return"No"===t.templateCell.expansionDirection&&0<t.children.length&&(!t.upParent||!t.leftParent)})}),u=!this.N2i(t),!(n&&e&&o&&u))||(t.pattern="VerticalNormal",0))},c.prototype.ZSi=function(t){var n,i,r,t,e,n=t.rowOffset,i=t.colOffset,r=t.tree;return this.k3i(t),this.Rzi(),t=this.Czi(),e=this.xEi(r.root.treeRange.colEnd)-this.xEi(r.root.treeRange.col),this.Mzi(),{row:r.root.treeRange.row+n,col:r.root.treeRange.col+i,rowEnd:r.root.treeRange.rowEnd+n+t,colEnd:r.root.treeRange.colEnd+i+e}},c.prototype.k3i=function(t){s.prototype.k3i.call(this,t),this._yt=this.DJ.colOffset;var t=this.DJ.tree.root;this.Uzi=t.templateCell.overwriteWhenExpand&&(0,f.G3i)(t),this.m2i=!this.b2i(t),this.FN={}},c.prototype.Q3i=function(t,n){this.Uzi||s.prototype.Q3i.call(this,t,n)},c.prototype.Y3i=function(t,n){this.Uzi||s.prototype.Y3i.call(this,t,n)},c.prototype.Rzi=function(){this.Uzi&&(0,f.Rzi)(this.DJ.overwriteRoots,this.DJ.tree.root)},c.prototype.Czi=function(){var t,t,n,i,n,t=this.X3i(),t=this.Hzi(t,this.DJ.rowOffset,!0);return t&&(i=(n=this.DJ.tree.root.templateCell).row,n=n.col,this.Q3i({row:i,col:n,expandedCount:t})),t},c.prototype.Hzi=function(r,e,t){var o,u,s,c,f,t,t,o=this;return void 0===t&&(t=!1),0===r.length?0:(s=u=0,c=this.U3i&&t&&"PaginationByRow"===this.DJ.paginationContext.paginationSetting.type&&this.DJ.paginationContext.paginationSetting.paginationDataCell.templateCell.row===this.DJ.tree.root.templateCell.row,f=this.DJ.paginationContext.paginationSetting,r.forEach(function(t,n){var t,i;u+=o.Zzi(t,u+e),c&&f.paginationDataCell===t.cellNode&&n+1<r.length&&(n+1)%f.rowCountPerPage==0&&(o.znr(r[s],f.rowCountPerPage),t=t.dataCell.row+t.dataCell.rowCount,i=o.izi(t),u+=i,o.q3i(t+=i),u+=o.nzi(t),s=n+1)}),c&&this.znr(r[s],r.length-s),t=(t=r[0].cellNode.templateCell).rowEnd-t.row+1,u-t)},c.prototype.Zzi=function(r,e){var o,n,t,u,i,o=this,n=r.cellNode.templateCell,t=this.s_i.get(n.row,n.col);return t?(u=[],r.childrenArray.forEach(function(t,n){var n,t,n,i,n,n=r.cellNode.children[n];(0,l.lEi)(n)&&0!==(t=o.Hzi(t,(0,f.SEi)(u,n.templateCell.row)+e))&&(i=(n=n.templateCell).row,n=n.col,o.Q3i({row:i,col:n,expandedCount:t},u))}),r.crossChildren.forEach(function(t,n){var n,t,n,i,n;t&&0!==t.length&&(n=r.cellNode.children[n],(0,l.lEi)(n))&&0!==(t=o.O2i(t,(0,f.SEi)(u,n.templateCell.row)+e,n))&&(i=(n=n.templateCell).row,n=n.col,o.Q3i({row:i,col:n,expandedCount:t},u))}),i=(0,f.SEi)(u,Number.MAX_SAFE_INTEGER),this.Qzi(e,i,r),t.children.forEach(function(t){(0,l.lEi)(t)||(t.templateCell.row===n.row&&t.templateCell.rowEnd===n.rowEnd?o.y2i(e,t,r,i):o.y2i((0,f.SEi)(u,t.templateCell.row)+e,t,r,0))}),n.rowEnd-n.row+1+i):0},c.prototype.Qzi=function(t,n,i){var r,e,o,u,r,u,s,c,s,r=i.cellNode.templateCell,e=r.row,o=r.col,u=r.rowEnd,r=r.colEnd,u=u-e+1+n,s=o===r?o:"".concat(o,"-").concat(r),c=this.FN[s];return(void 0===c&&(c=(0,f.Rs)(this.DJ.expandedCols,i.cellNode),this.FN[s]=c),this.m2i)?this.dzi(t,n,c,i):(s={cellNode:i.cellNode,value:i.value,group:i,row:e+t,col:o+this._yt,rowCount:u,colCount:r-o+1+c},this.LEi(s)),u},c.prototype.y2i=function(t,n,i,r){n.upParent?this.wzi(t,n,i.crossChildren[n.indexOfLeftParentChildren],r):i.childrenArray[n.indexOfLeftParentChildren][0]&&this.Qzi(t,r,i.childrenArray[n.indexOfLeftParentChildren][0])},c.prototype.O2i=function(t,e,o){var u=this,s=o.templateCell,c=s.rowEnd-s.row+1,f=s.colEnd-s.col+1,h=0,l=Math.max.apply(Math,t.map(function(t){return t.length}));return t.forEach(function(t){var n,i,r;if(0!==t.length)if(n=t.length,i=u.gzi(o,t[0].upParent),"No"===s.expansionDirection)u.V3i(e,i,t[0]);else if("V"===s.expansionDirection)for(h=(l-1)*c,r=0;r<n;r++)u.V3i(e+r*c,i,t[r]);else if("H"===s.expansionDirection)for(r=0;r<n;r++)u.V3i(e,i+r*f,t[r])}),h},c.prototype.b2i=function(t){return!(!t.leftParent||!t.upParent)||!(!t.leftParent||!this.b2i(t.leftParent))||!(!t.upParent||!this.b2i(t.upParent))},c.prototype.znr=function(i,t){var r=this,n=this.Lnr(),e=this.DJ.tree.root.treeRange,o=(e.rowEnd-e.row+1)*(t-1);n.forEach(function(t){var n=(0,l.kEi)(t,0,0,0,0);n.row=i.dataCell.row,t.templateCell.row===e.row&&(n.rowCount+=o),r.LEi(n)})},c.prototype.Lnr=function(){var t,n,i,t,r,e,o,u,s,c,f;if(!this.Pnr)for(this.Pnr=[],n=(t=this.d4i).col,i=t.colEnd,r=(t=this.DJ.tree.root.treeRange).row,e=t.rowEnd,o=t.col,u=t.colEnd,s=n;s<=i;s++)if(s!==o){if(s<o||u<s)for(c=r;c<=e;c++)(f=this.s_i.get(c,s))&&!this.Pnr.includes(f)&&((0,l.qEi)(this.DJ.templateCellAccessCache,f.templateCell,!0),this.Pnr.push(f))}else s=u;return this.Pnr},c.prototype.q3i=function(t){this.DJ.paginationContext.paginationStartRows.push(t)},c.prototype.nzi=function(t){return this.zpt(t,this.DJ.paginationContext.paginationSetting.titleRows),this.DJ.paginationContext.titleRowsCount},c.prototype.izi=function(t){return this.zpt(t,this.DJ.paginationContext.paginationSetting.endRows),this.DJ.paginationContext.endRowsCount},c.prototype.zpt=function(t,n){var r,e,i,o,u,s,c,f,r=this;0!==n.length&&(e=this.s_i,o=(i=this.d4i).row,u=i.col,s=i.colEnd,c=new h.SmartCache(o,u,-1,-1),f=t-n[0],n.forEach(function(t){for(var n,i,i,n=u;n<=s;n++)(i=e.get(t,n))&&!c.get(i.templateCell.row,i.templateCell.col)&&(c.set(i.templateCell.row,i.templateCell.col,!0),i=(0,l.kEi)(i,f,0,f,0,!0),r.LEi(i,!1,!1))}))},n.VNormalDataPopulator=c},6401:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportEngine=void 0;var r=i(9034),e=i(7329),o=i(1269),u;function s(t,n){this.Z4i=t,this.N3=n}s.prototype.generateReport=function(t){try{performance.now(),this.I2i=new r.ParentChildTreeGenerator(this.Z4i).process(),this._2i=new e.ReportDataGenerator(this.I2i,this.N3);var n=this._2i._process(t),i=new o.ReportDataService(n,this._2i.x3i());return performance.now(),null!=t&&t.enablePagination,i}catch(t){return null}},s.prototype.getTreeGenerateResult=function(){return this.I2i},s.prototype.getExpandedContext=function(){var t;return null==(t=this._2i)?void 0:t.x3i().OEi()},n.ReportEngine=s}},e={},t=function t(n){var i,i,i=e[n];return void 0!==i||(i=e[n]={exports:{}},r[n].call(i.exports,i,i.exports,t)),i.exports}(3607);(o={}).Report=t}(),r=o||{},"object"==typeof t.exports?t.exports=r.Report:void 0!==(n=function(){return r.Report}.apply(n,i=[]))&&(t.exports=n)},Report:function(t){"use strict";t.exports=r.Report},Common:function(t){"use strict";t.exports=r.Spread},CalcEngine:function(t){"use strict";t.exports=r.Spread.CalcEngine},Core:function(t){"use strict";t.exports=r.Spread.Sheets},Barcode:function(t){"use strict";t.exports=r.Spread.Sheets.Barcode},Bindings:function(t){"use strict";t.exports=r.Spread.Sheets.Bindings},SheetsCalc:function(t){"use strict";t.exports=r.Spread.Sheets.CalcEngine},CellTypes:function(t){"use strict";t.exports=r.Spread.Sheets.CellTypes},ConditionalFormatting:function(t){"use strict";t.exports=r.Spread.Sheets.ConditionalFormatting},DataChart:function(t){"use strict";t.exports=r.Spread.Sheets.DataCharts},Print:function(t){"use strict";t.exports=r.Spread.Sheets.Print},Shapes:function(t){"use strict";t.exports=r.Spread.Sheets.Shapes},Sparkline:function(t){"use strict";t.exports=r.Spread.Sheets.Sparklines}},o={},t=i("./dist/plugins/report/report-all-entry.js"),((r=void 0===r?{}:r).Spread=r.Spread||{}).Report=t});