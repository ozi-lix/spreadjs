/*!
 * 
 * SpreadJS Library 18.0.2
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
!function(o){"object"==typeof module&&"object"==typeof module.exports?module.exports=o(require("@mescius/spread-sheets")):"function"==typeof define&&define.amd?define(["@mescius/spread-sheets"],o):"object"==typeof exports?exports.Spread=o(require("@mescius/spread-sheets")):o(GC)}(function(n){function e(o){var t,t,t=a[o];return void 0!==t||(t=a[o]={exports:{}},i[o].call(t.exports,t,t.exports,e)),t.exports}var i,a,o;i={"./dist/plugins/collaboration/all-entry.js":function(o,t,e){(n=n||{}).Spread=n.Spread||{},n.Spread.Sheets.Collaboration=e("./node_modules_local/@spreadjs/js-sheets-collaboration-types/dist/index.js");var e=e("./dist/plugins/collaboration/collaboration.entry.js");n.Spread.Sheets.Collaboration={...n.Spread.Sheets.Collaboration,...e},o.exports=n.Spread.Sheets.Collaboration},"./dist/plugins/collaboration/collaboration.entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/index.js"),t),i(e("./dist/plugins/collaboration/presence/presence.js"),t),i(e("./dist/plugins/collaboration/presence/permissions.js"),t),i(e("./dist/plugins/collaboration/enum.js"),t),i(e("./dist/plugins/collaboration/merge/op-merge-manager.js"),t),i(e("./dist/plugins/collaboration/util/formula-info/util.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/entry.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/entry.js"),t),i(e("./dist/plugins/collaboration/ops/sort/ops.js"),t),i(e("./dist/plugins/collaboration/ops/filter/filter-entry.js"),t),i(e("./dist/plugins/collaboration/ops/comment/entry.js"),t),i(e("./dist/plugins/collaboration/ops/group/entry.js"),t),i(e("./dist/plugins/collaboration/ops/slicer/entry.js"),t),i(e("./dist/plugins/collaboration/dirty/slicer/refresh-slicer-data.js"),t),i(e("./dist/plugins/collaboration/dirty/slicer/refresh-slicers.js"),t),i(e("./dist/plugins/collaboration/ops/table/entry.js"),t),i(e("./dist/plugins/collaboration/ops/shape/add-shape.js"),t),i(e("./dist/plugins/collaboration/ops/shape/update-shape-anchor.js"),t),i(e("./dist/plugins/collaboration/ops/shape/remove-shape.js"),t),i(e("./dist/plugins/collaboration/ops/shape/zIndex-shape.js"),t),i(e("./dist/plugins/collaboration/ops/shape/update-shape-prop.js"),t),i(e("./dist/plugins/collaboration/ops/shape/update-shape-formula.js"),t),i(e("./dist/plugins/collaboration/ops/shape/group-shape/add-shape.js"),t),i(e("./dist/plugins/collaboration/ops/shape/group-shape/remove-shape.js"),t),i(e("./dist/plugins/collaboration/ops/shape/group-shape/zIndex-shape.js"),t),i(e("./dist/plugins/collaboration/ops/shape/group-shape.js"),t),i(e("./dist/plugins/collaboration/ops/shape/ungroup-shape.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/entry.js"),t),i(e("./dist/plugins/collaboration/ops/auto-merge/entry.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/entry.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/entry.js"),t),i(e("./dist/plugins/collaboration/ops/cell-state/entry.js"),t),i(e("./dist/plugins/collaboration/ops/data-validator/entry.js"),t),i(e("./dist/plugins/collaboration/ops/hyperlink/entry.js"),t),i(e("./dist/plugins/collaboration/ops/outline-column/entry.js"),t),i(e("./dist/plugins/collaboration/ops/chart/entry.js"),t),i(e("./dist/plugins/collaboration/ops/print/entry.js"),t)},"./dist/plugins/collaboration/dirty-process.js":function(o,n){"use strict";function t(o,e){(o=Array.isArray(o)?o:[o]).forEach(function(o){var t=n.DIRTY_PROCESSES_MAP.get(o);t||n.DIRTY_PROCESSES_MAP.set(o,t=[]),t.push(e)})}Object.defineProperty(n,"__esModule",{value:!0}),n.processDirtyList=n.updateDirtyList=n.dirtySubscribe=n.DIRTY_PROCESSES_MAP=void 0,n.DIRTY_PROCESSES_MAP=new Map,n.dirtySubscribe=t;var e=function(t){var o;return null==(o=n.DIRTY_PROCESSES_MAP.get(t.type))?void 0:o.filter(function(o){return o.opCheck(t)})};function i(n,i){var o=e(n);o&&o.forEach(function(o){var t,e,t,e=o.keyGenerate(n),t=null==(t=o.argsGenerate)?void 0:t.call(o,n);i.find(function(o){return o.key===e})||i.push({dirtyProcess:o,args:t,key:e})})}function a(t,o){0<o.length&&(o.sort(function(o,t){return o.dirtyProcess.priority-t.dirtyProcess.priority}),o.forEach(function(o){o.dirtyProcess.processFunction(t,o.args)}))}n.updateDirtyList=i,n.processDirtyList=a},"./dist/plugins/collaboration/dirty/slicer/refresh-slicer-data.js":function(o,t,e){"use strict";var t,n;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/dirty-process.js"),n=e("./dist/plugins/collaboration/enum.js"),(0,t.dirtySubscribe)([n.OpType.filterItemMap],{keyGenerate:function(o){var o=o.payload;return"rfsd_"+o.tableName+"_"+o.col},opCheck:function(o){if(o.type===n.OpType.filterItemMap)return"table"===o.payload.filterType},argsGenerate:function(o){var t,e,n,i,t=o.payload,e,n,i;return{sheetId:o.sheetId,tableName:t.tableName,col:t.col}},processFunction:function(o,t){var e,n,t,i,o,e,e=t.sheetId,n=t.tableName,t=t.col,i,o=o.c_r(e).tables._bt(n);o&&(e=o.LSt)&&(void 0===t?e.WEr():e.JEr(t))},priority:1e3})},"./dist/plugins/collaboration/dirty/slicer/refresh-slicers.js":function(o,t,e){"use strict";var t,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/dirty-process.js"),e=e("./dist/plugins/collaboration/enum.js"),(0,t.dirtySubscribe)([e.OpType.updateSlicerCache],{keyGenerate:function(o){var o=o.payload;return"rfs_"+o.slicerCacheType+"_"+o.slicerCacheId},opCheck:function(o){return!0},argsGenerate:function(o){var t;return o.payload},processFunction:function(o,t){var e,t,e,e=t.slicerCacheType,t=t.slicerCacheId;"table"===e&&(e=o.odi.get(t))&&e.refreshSlicers()},priority:1e3})},"./dist/plugins/collaboration/enum.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpType=void 0;var n=e("CollaborationTypes");Object.defineProperty(t,"OpType",{enumerable:!0,get:function(){return n.OpType}})},"./dist/plugins/collaboration/index.js":function(o,t,e){"use strict";var t,i,s,n,l,a,r,u,p;function c(o,t){var e,n,e,e,i,a;if(o&&!o.isOpSuspended()&&o.ooo&&(n=(0,s.getOpProcess)(t.type))&&(!(e=t.sheetId)||(e=o.c_r(e),i=t.type===l.OpType.removeSheet||t.type===l.OpType.clearSheets,e)||i)){o.suspendOp();try{a=n.createOp(t,o)}catch(o){}o.resumeOp(),a&&null!=(e=o.submitOp)&&e.call(o,a)}}Object.defineProperty(t,"__esModule",{value:!0}),t=e("Core"),i=e("./dist/plugins/collaboration/dirty-process.js"),s=e("./dist/plugins/collaboration/op-manager.js"),n=e("./dist/plugins/collaboration/merge/op-merge-manager.js"),l=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/ssjson-convert/from/workbook.js"),r=e("./dist/plugins/collaboration/ssjson-convert/to/workbook.js"),u=function(o){var o;return null!=(o=null==o?void 0:o.koo)?o:[]},t.Workbook.prototype.toSnapshot=function(){var o,t,o=this,t=o.toJSON({isServer:!0,Moo:!1});return t=JSON.parse(JSON.stringify(t)),(0,r.convertToWorkbookCollaborationJSON)(t,o)},t.Workbook.prototype.fromSnapshot=function(o){var t,e,t=this;(0,a.isCollaborationJson)(o)&&(o=JSON.parse(JSON.stringify(o)),e=(0,a.buildIdMap)(o),(0,a.convertFromWorkbookCollaborationJSON)(o,e)),t.fromJSON(o)},p="sjs_collaboration",t.Workbook.ch("collaboration",{modelChanged:function(o){c(this,o)},init:function(){var t=this,o=t.commandManager();t.ooo=new n.OpMergeManager,t.koo=[],o&&o.cM(p,function(o){o.isBefore?t.startBatchOp():t.endBatchOp()})},dispose:function(){var o=this,t=o.commandManager();t&&t.zUt(p),o.koo=[]}}),t.Worksheet.ch("collaboration",{modelChanged:function(o){var t;c(this.parent,o)}}),t.Workbook.prototype.applyOp=function(o){var e,n,e=this;e.suspendOp(),e.suspendPaint(),e.suspendCalcService(),n=[],o.ops.forEach(function(o){var t;(0,s.getOpProcess)(o.type).applyOp(e,o),(0,i.updateDirtyList)(o,n)}),(0,i.processDirtyList)(e,n),e.resumeCalcService(!0),e.resumePaint(),e.resumeOp()},t.Workbook.prototype.suspendOp=function(){var o=this;void 0===o.eoo&&(o.eoo=0),o.eoo++},t.Workbook.prototype.resumeOp=function(){var o;this.eoo--},t.Workbook.prototype.isOpSuspended=function(){var o;return 0<this.eoo},t.Workbook.prototype.startBatchOp=function(){var o=this;void 0===o.too&&(o.too=0),o.too++},t.Workbook.prototype.endBatchOp=function(){var o,t,t=this;t.too=Math.max(t.too-1,0),t.isOpBatch()||(null!=(o=t.triggerOp)&&o.call(t),t.noo=[])},t.Workbook.prototype.isOpBatch=function(){var o;return 0<this.too},t.Workbook.prototype.submitOp=function(o){var o,t,t=this;void 0===t.noo&&(t.noo=[]),t.noo.push(o),t.isOpBatch()||(null!=(o=t.triggerOp)&&o.call(t),t.noo=[])},t.Workbook.prototype.onOp=function(t){var o=this,e=u(o);return e.push(t),function(){o.koo=e.filter(function(o){return o!==t})}},t.Workbook.prototype.triggerOp=function(){var o,t,o,e,o=this,t=u(o);t.length<1||!(o=o.ooo.reduceOp(o.noo))||o.length<1||(e={ops:o},t.forEach(function(o){o(e)}))}},"./dist/plugins/collaboration/merge/op-merge-manager.js":function(o,t,e){"use strict";var n,i,a;function s(){}Object.defineProperty(t,"__esModule",{value:!0}),t.OpMergeManager=void 0,n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/util/stack.js"),s.prototype.reduceOp=function(o){var o;return o&&0!==o.length?(o=this.aoo(o),this.ioo(o)):[]},s.prototype.aoo=function(o){var t,e;if(o.length<=1)return o;for((t=new i.Stack).push(o[0]),e=1;e<o.length;e++)this.loo(o[e],t);return t.toArray()},s.prototype.loo=function(o,t){var e,e;!t.isEmpty()&&(e=t.peek(),e=this.soo(e,o))?(t.pop(),this.loo(e,t)):t.push(o)},s.prototype.soo=function(o,t){var e,e,e,e;return o.source===t.source&&o.type===t.type&&o.sheetId===t.sheetId&&(void 0===o.sheetId||(null==(e=o.target)?void 0:e.sheetArea)===(null==(e=t.target)?void 0:e.sheetArea))&&(e=null==(e=(0,n.getOpProcess)(o.type))?void 0:e.mergeOp)?e(o,t):void 0},s.prototype.ioo=function(o){return o.map(function(o){var t,t,t=null==(t=(0,n.getOpProcess)(o.type))?void 0:t.minifyOp;return t?t(o):o})},t.OpMergeManager=s},"./dist/plugins/collaboration/op-manager.js":function(o,t,e){"use strict";var n,i;function a(o){i[o.type]=o}function s(o){return i[o]}Object.defineProperty(t,"__esModule",{value:!0}),t.OpSource=t.getOpProcess=t.registerOpProcess=void 0,n=e("CollaborationTypes"),Object.defineProperty(t,"OpSource",{enumerable:!0,get:function(){return n.OpSource}}),i={},t.registerOpProcess=a,t.getOpProcess=s},"./dist/plugins/collaboration/ops/auto-merge/add-auto-merge.js":function(o,t,e){"use strict";var p,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),p=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.addAutoMerge,createOp:function(o){return{type:n.OpType.addAutoMerge,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{row:o.range.row,col:o.range.col,rowCount:o.range.rowCount,colCount:o.range.colCount,sheetArea:o.sheetArea},payload:{selectionMode:o.selectionMode,mode:o.mode,direction:o.direction}}},applyOp:function(o,t){var e,n,t,i,a,s,l,t,r,u,n,o,e,e=t.sheetId,n=t.payload,t=t.target,i=t.row,a=t.rowCount,s=t.col,l=t.colCount,t=t.sheetArea,r=n.selectionMode,u=n.mode,n=n.direction,o=o.c_r(e),e=new p.Range(i,s,a,l);o.Cb._Qt(e,n,u,t,r)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/auto-merge/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/auto-merge/add-auto-merge.js"),t),i(e("./dist/plugins/collaboration/ops/auto-merge/remove-auto-merge.js"),t),i(e("./dist/plugins/collaboration/ops/auto-merge/update-auto-merge-range-infos.js"),t)},"./dist/plugins/collaboration/ops/auto-merge/remove-auto-merge.js":function(o,t,e){"use strict";var l,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),l=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.removeAutoMerge,createOp:function(o){return{type:n.OpType.removeAutoMerge,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{row:o.range.row,col:o.range.col,rowCount:o.range.rowCount,colCount:o.range.colCount,sheetArea:o.sheetArea}}},applyOp:function(o,t){var e,t,n,i,a,s,t,o,e,e=t.sheetId,t=t.target,n=t.row,i=t.rowCount,a=t.col,s=t.colCount,t=t.sheetArea,o=o.c_r(e),e=new l.Range(n,a,i,s);o.Cb.__r(e,t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/auto-merge/update-auto-merge-range-infos.js":function(o,t,e){"use strict";var i,n,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),e={type:n.OpType.updateAutoMergeRangeInfos,createOp:function(o){return{type:n.OpType.updateAutoMergeRangeInfos,module:a.OpModule.worksheet,sheetId:o.sheetId,payload:{sheetArea:o.sheetArea,rangeInfos:o.rangeInfos.map(function(o){var t=o.range;return{range:{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount},direction:o.direction,mode:o.mode,sheetArea:o.sheetArea,selectionMode:o.selectionMode}})}}},applyOp:function(o,t){var e,n,t,o,e=t.sheetId,n,t=t.payload.rangeInfos,o=o.c_r(e);0===t.length?o.Cb.clear():(o.Cb.SP=t.map(function(o){var t=o.range;return o.range=new i.Range(t.row,t.col,t.rowCount,t.colCount),o}),o.Cb.IP())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/cell-state/add-cell-state.js":function(o,t,e){"use strict";var s,n,t,l,i,e;Object.defineProperty(t,"__esModule",{value:!0}),s=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/ops/cell-state/cell-state-util.js"),i=e("CollaborationTypes"),e={type:n.OpType.addCellState,createOp:function(o){return{type:n.OpType.addCellState,module:i.OpModule.cellState,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:{range:o.range.toJSON(),style:o.style.toJSON(),state:o.state}}},applyOp:function(o,t){var e,n,t,i,a,t,o,e,t,n,a,i,e=t.sheetId,n=t.target,t=t.payload,i=t.range,a=t.style,t=t.state,o=(0,l.roo)(o,e,t),e=o.UP(n.sheetArea),t=new s.Style;t.fromJSON(a),a={range:n=new s.Range(i.row,i.col,i.rowCount,i.colCount),style:t},-1===(i=o.zP(e,n))?e.push(a):e[i]=a}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/cell-state/cell-state-util.js":function(o,t){"use strict";function e(o,t,e,n){var i;return a(o,t,e).UP(n)}function a(o,t,e){var n;return o.c_r(t).cellStates.getCollection(e,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.roo=t.UP=void 0,t.UP=e,t.roo=a},"./dist/plugins/collaboration/ops/cell-state/entry.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/ops/cell-state/add-cell-state.js"),e("./dist/plugins/collaboration/ops/cell-state/remove-cell-state.js"),e("./dist/plugins/collaboration/ops/cell-state/set-cell-state.js")},"./dist/plugins/collaboration/ops/cell-state/remove-cell-state.js":function(o,t,e){"use strict";var a,n,t,s,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/cell-state/cell-state-util.js"),i=e("CollaborationTypes"),e={type:n.OpType.removeCellState,createOp:function(o){return{type:n.OpType.removeCellState,module:i.OpModule.cellState,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:{range:o.range,state:o.state}}},applyOp:function(o,t){var e,n,t,i,t,o,e,i,e=t.sheetId,n=t.target,t=t.payload,i=t.state,t=t.range,o=(0,s.roo)(o,e,i),e=o.UP(n.sheetArea),i=o.zP(e,new a.Range(t.row,t.col,t.rowCount,t.colCount));-1<i&&e.splice(i,1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/cell-state/set-cell-state.js":function(o,t,e){"use strict";var n,t,s,i,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/cell-state/cell-state-util.js"),i=e("CollaborationTypes"),e={type:n.OpType.setCellState,createOp:function(o){return{type:n.OpType.setCellState,module:i.OpModule.cellState,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:{list:o.list,state:o.state}}},applyOp:function(o,t){var e,n,t,i,t,a,e=t.sheetId,n=t.target,t=t.payload,i=t.list,t=t.state,a;(0,s.roo)(o,e,t).cE[n.sheetArea]=i}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/entry.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/ops/chart/series/add-series.js"),e("./dist/plugins/collaboration/ops/chart/series/remove-series.js"),e("./dist/plugins/collaboration/ops/chart/series/update-series.js"),e("./dist/plugins/collaboration/ops/chart/set-axes.js"),e("./dist/plugins/collaboration/ops/chart/update-plot-area.js"),e("./dist/plugins/collaboration/ops/chart/set-chart-area.js"),e("./dist/plugins/collaboration/ops/chart/set-chart-option.js"),e("./dist/plugins/collaboration/ops/chart/set-legend.js"),e("./dist/plugins/collaboration/ops/chart/update-chart-group.js"),e("./dist/plugins/collaboration/ops/chart/set-title.js")},"./dist/plugins/collaboration/ops/chart/series/add-series.js":function(o,t,e){"use strict";var i,a,t,s,g,l,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("Chart"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),g=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),l=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),e={type:a.OpType.addSeries,createOp:function(o,t){var e,t,n,e,e=o.chartModel.PlotArea.ToOOModel();return(0,l.parseChartFormulaNodes)(e,t),t=e.chartGroups,n=e.plotAreaRegion,e=i.ChartUtility.GetPrimaryAxises(e),{type:a.OpType.addSeries,module:s.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,chartGroups:t,plotAreaRegion:n,primaryAxes:e}}},applyOp:function(o,t){var e,t,n,i,a,s,l,t,e,r,u,p,c,d,b,f,v,e=t.sheetId,t=t.payload,n=t.chartId,i=t.chartGroups,a=t.plotAreaRegion,s=t.primaryAxes,l,t=o.c_r(e).shapes.lEr(n);if(t){if(r=(e=t.utn).SeriesCollection,e.SuspendElementChanged(),r.$tn=[],u=[],c=e.PlotVisibleOnly,(0,g.unparseChartFormulaNodes)({chartGroups:i,plotAreaRegion:a},p=void 0,o),i)for(d=0,b=i;d<b.length;d++)for(p=r.RestoreSeriesImp(b[d],{chartGroup:i},c,s),f=0;f<p.length;f++)u.push(p[f]);else u=r.Restore2016ChartSeriesImp({plotAreaRegion:a},c);for(v=0;v<u.length;v++)r.$tn.push(u[v]);e.ResumeElementChanged(4,r,"Restore")}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/series/remove-series.js":function(o,t,e){"use strict";var n,i,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeSeries,createOp:function(o){return{type:i.OpType.removeSeries,module:n.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,sourceIndex:o.sourceIndex}}},applyOp:function(o,t){var e,t,n,t,o,e,n,i,e=t.sheetId,t=t.payload,n=t.chartId,t=t.sourceIndex,o=o.c_r(e),e=o.shapes.lEr(n);e&&(i=(n=e.utn.SeriesCollection).Get(t))&&(o.Cnn(e),n.UpdatePlotOrders(i.PlotOrder,!0),n.$tn.splice(t,1),i.$0i=a,e.utn.HandleElementChanged(4,e,"Collection"),e.Fnn())}},(a=null,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/series/update-series.js":function(o,t,e){"use strict";var r,u,p,t,c,d,b,e;Object.defineProperty(t,"__esModule",{value:!0}),r=e("Chart"),u=e("CollaborationTypes"),p=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),c=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),d=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),b=e("./dist/plugins/collaboration/util/formula-info/util.js"),e={type:p.OpType.updateSeries,createOp:function(o,t){var e,n,i,a,s,e,l,n=o.sourceIndex,i=o.prop,a=o.value,s=o.series,l=r.ChartUtility.Is2016ChartType(s.ChartType);return"seriesStyle"===i?a=s.ToShapeProperties():"layoutPr"===i?a=s.ToCT_SeriesLayoutProperties():"dataLabels"===i?a=s.ToCT_DLbls():"dataPoints"===i?a=l?s.Btn&&s.Btn.To2016ChartOOModel():s.ToDataPoints():"invertColor"===i?a=s.ToCT_InvertSolidFillFmt():"nameFormula"===i?e=l?null==(e=null==(a=s.ToCT_Text())?void 0:a.txData)?void 0:e.f:null==(a=s.ToCT_SerTx())?void 0:a.strRef:"xValuesFormula"===i?e=l?a=s.ToCT_2016ChartFormulaObj():(null==(a=s.XValuesToCT_AxDataSource())?void 0:a.numRef)||(null==a?void 0:a.strRef):"valuesFormula"===i?e=l?a=s.ToCT_2016ChartFormulaObj():null==(a=s.ValuesToCT_NumDataSource())?void 0:a.numRef:"bubbleFormula"===i?e=null==(a=s.BubbleSizesToCT_NumDataSource())?void 0:a.numRef:"dataLabelRangeFormula"===i?e=null==(a={strRef:{f:s.Q0i.ChartText.Formula}})?void 0:a.strRef:"trendline"===i?a=s.ToCT_Trendlines():"errorBars"===i?a=s.ToCT_ErrorBars():"chartType"===i||"axisGroup"===i?a=s.Parent.Parent.PlotArea.ToOOModel():"marker"===i&&(a=s.ToCT_Marker()),void 0!==e&&(0,d.traverseChartNodeParseFormula)(e,t),{type:p.OpType.updateSeries,module:u.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,is2016Chart:l,sourceIndex:n,prop:i,value:a}}},applyOp:function(o,t){var e,n,n,i,t,a,e,s,l,t,r,i,a,o,u,i,p,e,i=t.sheetId,t=t.payload,a=t.chartId,e=t.sourceIndex,s=t.is2016Chart,l=t.prop,t=t.value,r,i=o.c_r(i).shapes.lEr(a);i&&(a=(0,b.buildIdMapByWorkbook)(o),o=i.utn,i=(u=i.utn.SeriesCollection).Get(e))&&("seriesStyle"===l?i.FromShapeProperties(t):"layoutPr"===l?i.FromCT_SeriesLayoutProperties(t):"dataLabels"===l?i.FromCT_DLbls(t):"dataPoints"===l?t&&i.Btn&&(s?i.Btn.From2016ChartOOModel(t):i.Btn.FromChartOOModel(t)):"invertColor"===l?0===(p=null==(e=null==t?void 0:t.dataObject)?void 0:e.extDataType)&&(e=t.dataObject).spPr&&null!=(n=i.Uv)&&n.FromOOModel(e.spPr.solidFill):"nameFormula"===l?s?(i.FromCT_Text(t),(0,c.traverseChartNodeUnparseFormula)(null==(n=null==t?void 0:t.txData)?void 0:n.f,a)):(i.FromCT_SerTx(t),(0,c.traverseChartNodeUnparseFormula)(null==t?void 0:t.strRef,a)):"xValuesFormula"===l?s?(i.FromCT_2016ChartFormulaObj(t),(0,c.traverseChartNodeUnparseFormula)(t,a)):(i.FromCT_AxDataSource(t),(0,c.traverseChartNodeUnparseFormula)((null==t?void 0:t.numRef)||(null==t?void 0:t.strRef),a)):"valuesFormula"===l?s?(i.FromCT_2016ChartFormulaObj(t),(0,c.traverseChartNodeUnparseFormula)(t,a)):(i.FromCT_NumDataSource(t),(0,c.traverseChartNodeUnparseFormula)(null==t?void 0:t.numRef,a)):"bubbleFormula"===l?(i.BubbleFromCT_NumDataSource(t),(0,c.traverseChartNodeUnparseFormula)(null==t?void 0:t.numRef,a)):"dataLabelRangeFormula"===l?i.Q0i&&((0,c.traverseChartNodeUnparseFormula)(null==t?void 0:t.strRef,a),i.Q0i.ChartText.Formula=t,i.Q0i.ShowDataLabelsRange=!0):"trendline"===l?i.FromCT_Trendlines(t):"errorBars"===l?i.FromCT_ErrorBars(t):"chartType"===l||"axisGroup"===l?o.PlotArea.FromOOModel(t):"explosion"===l?i.Explosion=t:"invertIfNegative"===l?i.InvertIfNegative=t:"smooth"===l?i.Smooth=t:"marker"===l?i.FromCT_Marker(t):"plotVisibleOnly"===l?i.PlotVisibleOnly=t:"tableSettingIndex"===l&&(i.L2i=t))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/set-axes.js":function(o,t,e){"use strict";var i,a,t,s,l,r,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("Chart"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),l=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),r=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),e={type:a.OpType.setAxes,createOp:function(o,t){var e,e,n,e=o.chartModel.ChartType,e=i.ChartUtility.Is2016ChartType(e),n=o.chartModel.PlotArea.ToOOModel();return(0,l.parseChartFormulaNodes)(n,t),{type:a.OpType.setAxes,module:s.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,plotAreaJson:n,is2016Chart:e}}},applyOp:function(o,t){var e,t,n,i,t,a,e,n,e=t.sheetId,t=t.payload,n=t.chartId,i=t.plotAreaJson,t=t.is2016Chart,a,e=o.c_r(e).shapes.lEr(n);e&&(n=e.utn,i)&&((0,r.unparseChartFormulaNodes)(i,void 0,o),t?n.Axes.Restore2016ChartAxes(i):n.Axes.RestoreAxes(i))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/set-chart-area.js":function(o,t,e){"use strict";var s,a,t,l,r,e;Object.defineProperty(t,"__esModule",{value:!0}),s=e("Chart"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),l=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),e={type:a.OpType.setChartArea,createOp:function(o,t){var e,n,i,t,e,n=o.chartModel.hin.ToOOModel(),i=o.chartModel.ToCT_Chart();return(0,r.parseChartFormulaNodes)(i.plotArea,t),(t={chartId:o.chartId}).spPr=n.SpPr,t.txPr=n.TxPr,t.chartJson=i,{type:a.OpType.setChartArea,module:l.OpModule.chart,sheetId:o.sheetId,payload:t}},applyOp:function(o,t){var e,t,n,i,t,a,o,e,e=t.sheetId,t=t.payload,n=t.chartId,i=t.txPr,t=t.spPr,a,o=o.c_r(e).shapes.lEr(n);o&&((e={}).SpPr=t,e.TxPr=i,e.Is2016Chart=s.ChartUtility.Is2016ChartType(o.utn.ChartType),o.utn.hin.FromOOModel(e))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/set-chart-option.js":function(o,t,e){"use strict";var n,i,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Chart"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),e={type:i.OpType.setChartOptions,createOp:function(o){var t;return"hoverStyle"===o.prop?o.value=o.value.hoverStyle():"colorScheme"===o.prop?o.value=(0,n.cloneColorScheme)(o.value):"formatOvers"===o.prop&&0<o.value.length&&(t=[],o.value.forEach(function(o){t.push(o.ToOOModel())}),o.value=t),{type:i.OpType.setChartOptions,module:a.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,prop:o.prop,value:o.value}}},applyOp:function(o,t){var e,t,n,i,t,a,o,e,e=t.sheetId,t=t.payload,n=t.chartId,i=t.prop,t=t.value,a,o=o.c_r(e).shapes.lEr(n);o&&(e=o.utn,"useAnimation"===i?(e.UseAnimation=t,o.Fnn()):"displayBlankAs"===i?(e.DisplayBlanksAs=t,o.Fnn()):"ignoreHidden"===i?(e.PlotVisibleOnly=t,e.UpdatePlotVisibleOnly(t),o.Fnn(!0)):"displayNaAsBlank"===i?(e.DisplayNaAsBlank=t,o.Fnn()):"formatOvers"===i?e.FromCT_FmtOvrs(t):"colorScheme"===i?e.rd=t:"hoverStyle"===i&&o.hoverStyle(t))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/set-legend.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Chart"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.setLegend,createOp:function(o){var t;return{type:n.OpType.setLegend,module:i.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,legendJson:null==(t=o.legend)?void 0:t.ToOOModel(a.ChartUtility.Is2016ChartType(o.legend.utn.ChartType))}}},applyOp:function(o,t){var e,t,n,t,i,o,e,e=t.sheetId,t=t.payload,n=t.chartId,t=t.legendJson,i,o=o.c_r(e).shapes.lEr(n);o&&(e=o.utn,t?(e.HasLegend=!0,a.ChartUtility.Is2016ChartType(e.ChartType)?e.cin.From2016ChartOOModel(t):e.cin.FromOOModel(t)):e.HasLegend=!1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/set-title.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Chart"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.setTitle,createOp:function(o){var t;return{type:n.OpType.setTitle,module:i.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,chartTitleJson:null==(t=o.chartTitle)?void 0:t.ToOOModel(o.is2016Chart)}}},applyOp:function(o,t){var e,t,n,t,i,o,e,e=t.sheetId,t=t.payload,n=t.chartId,t=t.chartTitleJson,i,o=o.c_r(e).shapes.lEr(n);o&&(e=o.utn,t?(e.M8=!0,e.itn=new a.ChartTitle(e),e.itn.FromOOModel(t)):e.M8=!1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/update-chart-group.js":function(o,t,e){"use strict";var s,l,t,e;Object.defineProperty(t,"__esModule",{value:!0}),s=e("CollaborationTypes"),l=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:l.OpType.updateChartGroup,createOp:function(o){var t=o.chartId,e=o.axisGroup,n=o.chartType,i=o.prop,a=o.value;return{type:l.OpType.updateChartGroup,module:s.OpModule.chart,sheetId:o.sheetId,payload:{chartId:t,axisGroup:e,chartType:n,prop:i,value:a}}},applyOp:function(o,t){var e,t,n,i,a,s,t,l,o,r,e,e=t.sheetId,t=t.payload,n=t.chartId,i=t.axisGroup,a=t.chartType,s=t.prop,t=t.value,l,o=o.c_r(e).shapes.lEr(n);o&&(e=(r=o.utn).FindChartGroup(a,i))&&("overlap"===s?e.Overlap=t:"gapWidth"===s?e.GapWidth=t:"firstSliceAngle"===s?e.FirstSliceAngle=t:"doughnutHoleSize"===s&&(e.DoughnutHoleSize=t))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/chart/update-plot-area.js":function(o,t,e){"use strict";var n,i,t,a,s,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),s=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),e={type:i.OpType.updatePlotArea,createOp:function(o,t){var e=o.chartModel.PlotArea.ToOOModel();return(0,a.parseChartFormulaNodes)(e,t),{type:i.OpType.updatePlotArea,module:n.OpModule.chart,sheetId:o.sheetId,payload:{chartId:o.chartId,plotAreaJson:e}}},applyOp:function(o,t){var e,t,n,t,i,e,e=t.sheetId,t=t.payload,n=t.chartId,t=t.plotAreaJson,i,e=o.c_r(e).shapes.lEr(n);e&&((0,s.unparseChartFormulaNodes)(t,void 0,o),e.utn.PlotArea.FromOOModel(t))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/comment/add-comment.js":function(o,t,e){"use strict";var t,n,a,i,s;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("Comment"),i=e("CollaborationTypes"),s={type:t.OpType.addComment,createOp:function(o){var t=o.sheetId,e=o.row,n=o.col,o=o.comment;return{type:s.type,module:i.OpModule.comment,sheetId:t,target:{row:e,col:n},payload:{commentJSON:o.toJSON({isServer:!0})}}},applyOp:function(o,t){var e,n,t,e,i,t,o,n,e,e=t.payload,n=t.sheetId,t=t.target,e=e.commentJSON,i=t.row,t=t.col;e&&(o=o.c_r(n),e.rowIndex=i,e.colIndex=t,(n=new a.Comment).fromJSON(e),(e=(n.Mf=o).comments).wB.push(n),n.lp=e.GW,e.GW++,e.E_r[n.jKe()]=n,e._K(i,t,n),o.zw())}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/comment/entry.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/ops/comment/add-comment.js"),e("./dist/plugins/collaboration/ops/comment/remove-comment.js"),e("./dist/plugins/collaboration/ops/comment/update-comment.js")},"./dist/plugins/collaboration/ops/comment/remove-comment.js":function(o,t,e){"use strict";var t,n,i,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),t=e("Common"),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=t.Common.Uf,l={type:n.OpType.removeComment,createOp:function(o){var t=o.sheetId,o=o.id;return{type:l.type,module:a.OpModule.comment,sheetId:t,payload:{id:o}}},applyOp:function(o,t){var e,t,e,o,t,n,i,e=t.payload,t=t.sheetId,e=e.id,o=o.c_r(t),t=null==o?void 0:o.comments,n=null==t?void 0:t.R_r(e);n&&(s.VP(t.wB,n),(i=t.mW(n))&&(i.LQ()&&i.lQ(),s.VP(t.UW,i)),t.GW--,t.E_r[e]=void 0,t._K(n.bZ,n.yZ,void 0),o.zw())}},(0,i.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/comment/update-comment.js":function(o,t,e){"use strict";var i,r,u,a,t,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),r=e("Comment"),u=e("Core"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:a.OpType.updateComment,createOp:function(o){var t=o.propertyName,e=o.value,n=o.id;return{type:a.OpType.updateComment,module:i.OpModule.comment,sheetId:o.sheetId,payload:{id:n,propertyName:t,value:e}}},applyOp:function(o,t){var e,t,n,o,e,i,a,s,l,e=t.sheetId,t=t.payload,n,o=o.c_r(e).comments;if(o&&t&&(e=t.id,i=o.R_r(e))&&(a=t.propertyName,s=t.value,"commentState"!==a)){switch(l=s,a){case"location":l=new u.Point(s.x,s.y);break;case"padding":l=new r.Padding(s.top,s.right,s.bottom,s.left)}i._ps[a]=l}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/conditional/add-rule.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.addRule,createOp:function(o){var t=o.value;return{type:i.OpType.addRule,module:n.OpModule.conditional,sheetId:o.sheetId,payload:{id:t.jKe(),value:t.toJSON(void 0,{isServer:!0})}}},applyOp:function(o,t){var e,t,o,e,t,e=t.sheetId,t=t.payload,o=o.c_r(e),e=o.conditionalFormats;e&&(t=e.pJ(t.value,o,void 0),e.qK.push(t),e._Jt[t.jKe()]=t,e.fE(t))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/conditional/clear-rule.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.clearRule,createOp:function(o){return{type:i.OpType.clearRule,module:n.OpModule.conditional,sheetId:o.sheetId,payload:{}}},applyOp:function(o,t){var t,e,o,t=t.sheetId,e,o=o.c_r(t).conditionalFormats;o&&(o.qK.length=0,o.C8(),o._Jt={})}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/conditional/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/conditional/add-rule.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/clear-rule.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/remove-rule-by-range.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/update-rule.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/remove-rule.js"),t)},"./dist/plugins/collaboration/ops/conditional/remove-rule-by-range.js":function(o,t,e){"use strict";var n,t,a,i,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("Core"),i=e("CollaborationTypes"),e={type:n.OpType.removeRuleByRange,createOp:function(o){var t=o.value,e,e=(e=t.updateRangesRules).map(function(o){var t,e,t=o.ranges,e=[];return t.forEach(function(o){e.push(o&&o.toJSON())}),{id:o.id,ranges:e}});return{type:n.OpType.removeRuleByRange,module:i.OpModule.comment,sheetId:o.sheetId,payload:{updateRangesRules:e,removedRules:t.removedRules}}},applyOp:function(o,t){var e,t,n,i,o,e,e=t.sheetId,t=t.payload,n,i=o.c_r(e).conditionalFormats;i&&(o=t.updateRangesRules,e=t.removedRules,o.forEach(function(o){var t,o,t,t=o.id,o=o.ranges,t=i.B_r(t);t&&(t.ranges(o.map(function(o){var t=new a.Range;return t.fromJSON(o),t})),i.RX(t),i.fE(t))}),e.forEach(function(t){var o,o,o=i.B_r(t);i.RX(o),(o=i.qK.findIndex(function(o){return(null==o?void 0:o.jKe())===t}))<0||(i.qK.splice(o,1),i._Jt[t]=void 0)}))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/conditional/remove-rule.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeRule,createOp:function(o){return{type:i.OpType.removeRule,module:n.OpModule.comment,sheetId:o.sheetId,payload:{id:o.value}}},applyOp:function(o,t){var e,t,n,o,i,e,t,e=t.sheetId,t=t.payload,n,o=o.c_r(e).conditionalFormats;o&&(i=t.id,e=o.B_r(i),o.RX(e),(t=o.qK.findIndex(function(o){return(null==o?void 0:o.jKe())===i}))<0||(o.qK.splice(t,1),o._Jt[i]=void 0))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/conditional/update-rule.js":function(o,t,e){"use strict";var i,n,r,u,a,p,e;function c(o,t){var e;if(o)return o.jKe()===t?o:o.item1()&&o.item1().jKe()===t?o.item1():o.item2()&&o.item2().jKe()===t?o.item2():o.item1&&(e=c(o.item1(),t))||o.item2&&(e=c(o.item2(),t))?e:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getConditionById=void 0,i=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),r=e("Core"),u=e("ConditionalFormatting"),a=e("CollaborationTypes"),p=void 0,t.getConditionById=c,e={type:i.OpType.updateRule,createOp:function(o){var t,e,n,t=o.key,e=o.value;return"ranges"===t?(n=[],e.forEach(function(o){n.push(o&&o.toJSON())}),e=n):"style"===t?e=e&&e.toJSON():"condition"===t&&(e=e&&e.toJSON(p,{isServer:!0})),{type:i.OpType.updateRule,module:a.OpModule.conditional,sheetId:o.sheetId,payload:{id:o.id,key:t,value:e}}},applyOp:function(o,t){var e,t,n,o,e,e,i,t,a,o,s,l,o,e=t.sheetId,t=t.payload,n,o=o.c_r(e).conditionalFormats;o&&t&&(e=t.id,e=o.B_r(e))&&(i=t.key,t=t.value,"ranges"===i?(a=[],t.forEach(function(o){var t=new r.Range;t.fromJSON(o),a.push(t)}),e.ranges(a,p,!1),o.RX(e),o.fE(e)):"style"===i?((o=new r.Style).fromJSON(t,p,p),e.style(o,p,!1)):"condition"===i?((s=new u.Condition).fromJSON(t,p,p),e.condition(s,p,!1)):"conditionChange"===i?(s=e.condition())&&t&&(o=c(s,l=t.id))&&(o[t.key]=t.value):e[i](t,p,!1))}},(0,n.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/data-validator/add-validator.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.addDataValidator,createOp:function(o){var t=o.range;return{type:n.OpType.addDataValidator,module:i.OpModule.validation,sheetId:o.sheetId,target:{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount},payload:{validator:o.validator.toJSON(o.sheet,{isServer:!0})}}},applyOp:function(o,t){var e,n,t,o,e,n,t,i,e=t.sheetId,n=t.payload,t=t.target,o=o.c_r(e),e=o.b8;e&&(n=n.validator,t=new a.Range(t.row,t.col,t.rowCount,t.colCount),(i=e.UEr(n,o)).UKn(n[a.ID_SYMBOL],!0),e.PEr(i,t,o),e.GEr(i,o))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/data-validator/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/data-validator/add-validator.js"),t),i(e("./dist/plugins/collaboration/ops/data-validator/remove-validator.js"),t),i(e("./dist/plugins/collaboration/ops/data-validator/remove-validator-range.js"),t),i(e("./dist/plugins/collaboration/ops/data-validator/update-validator.js"),t)},"./dist/plugins/collaboration/ops/data-validator/remove-validator-range.js":function(o,t,e){"use strict";var n,i,t,s,l,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/data-validator/util.js"),l=e("SheetsCalc"),e={type:i.OpType.removeDataValidatorRange,createOp:function(o){return{type:i.OpType.removeDataValidatorRange,module:n.OpModule.validation,sheetId:o.sheetId,payload:{id:o.validator.jKe(),ranges:o.validator.FEr()}}},applyOp:function(o,t){var e,t,n,i,a,t,o,e,e=t.sheetId,t=t.payload,n=o.c_r(e),i=n.b8;i&&(a=t.id,t=t.ranges,o=(0,s.uoo)(o,e,a))&&(e=l.formulaToRanges(n,t,0,0,!0)[0].ranges,i.RX(o,!0),o._S=e,i.fE(o))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/data-validator/remove-validator.js":function(o,t,e){"use strict";var n,i,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/data-validator/util.js"),e={type:i.OpType.removeDataValidator,createOp:function(o){return{type:i.OpType.removeDataValidator,module:n.OpModule.validation,sheetId:o.sheetId,payload:{id:o.validator.jKe()}}},applyOp:function(o,t){var e,t,n,i,t,o,e=t.sheetId,t=t.payload,n,i=o.c_r(e).b8;i&&(t=t.id,o=(0,a.uoo)(o,e,t))&&(delete i.YB[t],delete o.Mf,i.C8())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/data-validator/update-validator.js":function(o,t,e){"use strict";var a,i,t,s,l,r,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("ConditionalFormatting"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/data-validator/util.js"),l=e("CollaborationTypes"),e={type:i.OpType.updateDataValidator,createOp:function(o){var t,e,n,o,t=o.sheetId,e=o.propertyName,n=o.validator,o=o.value;return"condition"===e?o=o&&o.toJSON(r,{isServer:!0}):"highlightStyle"===e&&(o=JSON.stringify(o)),{type:i.OpType.updateDataValidator,module:l.OpModule.validation,sheetId:t,payload:{propertyName:e,value:o,id:n.jKe()}}},applyOp:function(o,t){var e,t,n,i,t,o,e,e=t.sheetId,t=t.payload,n=t.propertyName,i=t.value,t=t.id,o=(0,s.uoo)(o,e,t);o&&("condition"===n?((e=new a.Condition).fromJSON(i,r,r),o.condition(e,r,{shouldModelCallback:!1})):"highlightStyle"===n?o.l6t=JSON.parse(i):o[n](i,void 0,{shouldModelCallback:!1}))}},(r=void 0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/data-validator/util.js":function(o,t){"use strict";function e(o,t,e){var n,o,n,o=o.c_r(t).b8;if(o)return o.BEr(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.uoo=void 0,t.uoo=e},"./dist/plugins/collaboration/ops/filter/add-filter.js":function(o,t,e){"use strict";var n,t,i,a,s,l,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("Filters"),a=e("Core"),s=e("./dist/plugins/collaboration/ops/filter/util.js"),l="HideRowFilter",e={type:n.OpType.addFilter,createOp:function(o){var t,t,t=o.filter,t=t?(0,a.RF)(t.toJSON(void 0,{isServer:!0})):void 0;return(0,s.poo)(n.OpType.addFilter,o,{filterJSON:t})},applyOp:function(o,t){var e,t,o,t,e,e,n,e=t.payload,t=t.sheetId,o=o.c_r(t),t=e.filterJSON;t?((e=t.typeName)&&e!==l?(e=(0,a.getTypeFromString)(e))&&(n=new e):n=new i.HideRowFilter,n.fromJSON(t),(o.IB=n).Mf=o):o.IB=t}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/filter/filter-button-visible.js":function(o,t,e){"use strict";var t,n,l,r,i,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/ops/filter/util.js"),(e=r=r||{}).update="update",e.updateAll="updateAll",i={type:t.OpType.updateFilterButtonVisibleInfo,createOp:function(o){return(0,l.poo)(i.type,o)},applyOp:function(o,t){var e,t,n,i,a,s,e,e,o,t,e=t.payload,t=t.sheetId,n=e.col,i=e.value,a=e.filterType,s=e.tableName,e=e.changedType,e=void 0===e?r.update:e,o=o.c_r(t),t=(0,l.coo)(a,o,s);t&&(e===r.update?t.srt[n]=i:e===r.updateAll&&(t.srt=i))}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/filter/filter-entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/filter/add-filter.js"),t),i(e("./dist/plugins/collaboration/ops/filter/filter-button-visible.js"),t),i(e("./dist/plugins/collaboration/ops/filter/filtered-columns.js"),t),i(e("./dist/plugins/collaboration/ops/filter/filter-row-col-indices.js"),t),i(e("./dist/plugins/collaboration/ops/filter/sort-info.js"),t),i(e("./dist/plugins/collaboration/ops/filter/row-visible-info.js"),t),i(e("./dist/plugins/collaboration/ops/filter/range.js"),t),i(e("./dist/plugins/collaboration/ops/filter/filter-item-map.js"),t)},"./dist/plugins/collaboration/ops/filter/filter-item-map.js":function(o,t,e){"use strict";var s,l,t,n,u,p,c,r,e,s=this&&this.__assign||function(){return(s=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},l=this&&this.__rest||function(o,t){var e,n,i,e={};for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(e[n]=o[n]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols)for(i=0,n=Object.getOwnPropertySymbols(o);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i])&&(e[n[i]]=o[n[i]]);return e};Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),u=e("./dist/plugins/collaboration/ops/filter/util.js"),p=e("Filters"),(e=c=c||{}).add="add",e.remove="remove",e.updateAll="updateAll",e.reset="reset",r={type:t.OpType.filterItemMap,createOp:function(o){var t,e,n,i,a,t,n,t=o.conditions,e=o.col,n=o.filterItemMap,i=o.changedType,a=l(o,["conditions","col","filterItemMap","changedType"]),t=t&&(0,p.toConditions)(t,{isServer:!0}),n=n&&(0,p.H_r)(n);return i===c.reset&&(i=c.updateAll,n=[]),(0,u.poo)(r.type,o,s({conditionsJson:t,filterItemMapJSON:n,changedType:i,col:e},a))},applyOp:function(o,t){var e,t,n,i,a,s,l,e,o,t,s,r,e=t.payload,t=t.sheetId,n=e.conditionsJson,i=e.filterItemMapJSON,a=e.col,s=e.filterType,l=e.tableName,e=e.changedType,o=o.c_r(t),t=(0,u.coo)(s,o,l);t&&(e===c.add?(s=t.rrt,r=[],(0,p.fromConditions)(n).forEach(function(o){return r.push(o)}),s[a]=r):e===c.remove?t.rrt.splice(a,1,null):e===c.updateAll&&(t.rrt=[],(0,p.z_r)(t.rrt,i)))}},(0,n.registerOpProcess)(r)},"./dist/plugins/collaboration/ops/filter/filter-row-col-indices.js":function(o,t,e){"use strict";var i,a,t,n,r,u,s,e,i=this&&this.__assign||function(){return(i=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},a=this&&this.__rest||function(o,t){var e,n,i,e={};for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(e[n]=o[n]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols)for(i=0,n=Object.getOwnPropertySymbols(o);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i])&&(e[n[i]]=o[n[i]]);return e};Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/filter/util.js"),(e=u=u||{}).update="update",e.reset="reset",e.updateAll="updateAll",s={type:t.OpType.filteredInRowsWithColIndices,createOp:function(o){var t=o.changedType,e=o.info,n=a(o,["changedType","info"]);return t===u.reset&&(t=u.updateAll,e={}),(0,r.poo)(s.type,o,i({changedType:t,info:e},n))},applyOp:function(o,t){var e,t,n,i,a,s,l,e,o,t,e=t.payload,t=t.sheetId,n=e.key,i=e.value,a=e.changedType,s=e.filterType,l=e.tableName,e=e.info,o=o.c_r(t),t=(0,r.coo)(s,o,l);t&&(a===u.update?t._ct[n]=i:a===u.updateAll&&(t._ct=e))}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/filter/filtered-columns.js":function(o,t,e){"use strict";var a,s,t,n,i,l,r,e,u,p,e,a=this&&this.__assign||function(){return(a=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},s=this&&this.__rest||function(o,t){var e,n,i,e={};for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(e[n]=o[n]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols)for(i=0,n=Object.getOwnPropertySymbols(o);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i])&&(e[n[i]]=o[n[i]]);return e};Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("Common"),l=e("./dist/plugins/collaboration/ops/filter/util.js"),(e=r=r||{}).add="add",e.remove="remove",e.reset="reset",e.updateAll="updateAll",e=i.Common.Uf,u=e.VP,p={type:t.OpType.filteredColumns,createOp:function(o){var t=o.changedType,e=o.filteredColumns,n=o.col,i=s(o,["changedType","filteredColumns","col"]);return t===r.reset&&(t=r.updateAll,e=[]),(0,l.poo)(p.type,o,a({changedType:t,filteredColumns:e,col:n},i))},applyOp:function(o,t){var e,t,n,i,a,s,e,o,t,a,e=t.payload,t=t.sheetId,n=e.col,i=e.changedType,a=e.filterType,s=e.tableName,e=e.filteredColumns,o=o.c_r(t),t=(0,l.coo)(a,o,s);t&&(a=t.Mct,i===r.add?a.push(n):i===r.remove?u(a,n):i===r.updateAll&&(t.Mct=e))}},(0,n.registerOpProcess)(p)},"./dist/plugins/collaboration/ops/filter/range.js":function(o,t,e){"use strict";var t,n,a,s,i;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/filter/util.js"),s=e("Core"),i={type:t.OpType.updateFilterRange,createOp:function(o){return(0,a.poo)(i.type,o)},applyOp:function(o,t){var e,t,n,i,e,o,t,e=t.payload,t=t.sheetId,n=e.range,i=e.filterType,e=e.tableName,o=o.c_r(t),t=(0,a.coo)(i,o,e);t&&(t.range=new s.Range(n.row,n.col,n.rowCount,n.colCount),t.ict=!0)}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/filter/row-visible-info.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/filter/util.js"),a={type:t.OpType.filterRowVisibleInfo,createOp:function(o){return(0,i.poo)(a.type,o)},applyOp:function(o,t){var e,t,e,o,t,e=t.payload,t=t.sheetId,e=e.info,o=o.c_r(t),t=o.filterRowsVisibleInfo;t&&(t.rowsVisibleInfo=e,t.Mf=o,t.empty=0===Object.keys(t.rowsVisibleInfo).length)}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/filter/sort-info.js":function(o,t,e){"use strict";var t,n,a,i;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/filter/util.js"),i={type:t.OpType.updateFilterSortInfo,createOp:function(o){return(0,a.poo)(i.type,o)},applyOp:function(o,t){var e,t,n,i,e,o,t,e=t.payload,t=t.sheetId,n=e.sortInfo,i=e.filterType,e=e.tableName,o=o.c_r(t),t=(0,a.coo)(i,o,e);t&&(t.nrt=n)}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/filter/util.js":function(o,t,e){"use strict";var s,l,r;function n(o,t,e){var o;return"hideRow"===o?t.IB:"table"!==o||null==(o=t.tables._bt(e))?void 0:o.rowFilter()}function i(o,t,e){var n=t.sheetId,i=t.filterType,a=t.tableName,t=l(t,["sheetId","filterType","tableName"]);return{type:o,module:r.OpModule.filter,sheetId:n,payload:s({filterType:i,tableName:a},e=e||t)}}s=this&&this.__assign||function(){return(s=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},l=this&&this.__rest||function(o,t){var e,n,i,e={};for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(e[n]=o[n]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols)for(i=0,n=Object.getOwnPropertySymbols(o);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i])&&(e[n[i]]=o[n[i]]);return e},Object.defineProperty(t,"__esModule",{value:!0}),t.poo=t.coo=void 0,r=e("CollaborationTypes"),t.coo=n,t.poo=i},"./dist/plugins/collaboration/ops/group/add-group.js":function(o,t,e){"use strict";var t,n,a,i;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/group/util.js"),i={type:t.OpType.addGroup,createOp:function(o){return(0,a.createGroupOp)(i.type,o)},applyOp:function(o,t){var e,n,i,e,o,e=t.payload,n=e.index,i=e.isRowGroup,e=e.count,o=(0,a.getOutline)(o,t.sheetId,i);null!=o&&o.dy&&(o.dy(n,e),o.Y_r(),o.x2t=!1)}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/group/add-row-column-for-outline.js":function(o,t,e){"use strict";var t,n,p,c,i;function d(o){o.A2t=null,o.refresh()}Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),p=e("./dist/plugins/collaboration/ops/group/util.js"),c=e("Outlines"),i={type:t.OpType.insertGroupItem,createOp:function(o){var t=o.groupItemInfo;return t&&(t={level:t.level,collapsed:t.collapsed,viewCollapsed:t.viewCollapsed},o.groupItemInfo=t),(0,p.createGroupOp)(i.type,o)},applyOp:function(o,t){var o,e,n,i,a,s,e,l,r,u,e=t.payload,n=e.index,i=e.isRowGroup,a=e.count,s=e.groupItemInfo,e=(0,p.getOutline)(o,t.sheetId,i),l=null!=(o=null==e?void 0:e.items)?o:[],r=[];if(e){for(u=0;u<a;u++)r.push(null);if(e.items=l=l.slice(0,n).concat(r,l.slice(n)),s)for(u=0;u<a;u++)l[n+u]=new c.OutlineItemInfo(s);d(e)}}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/group/direction.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/group/util.js"),a={type:t.OpType.setDirection,createOp:function(o){return(0,i.createGroupOp)(a.type,o)},applyOp:function(o,t){var e,n,e,o,e=t.payload,n=e.direction,e=e.isRowGroup,o=(0,i.getOutline)(o,t.sheetId,e);o&&o.direction(n,void 0,{shouldModelCallback:!1})}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/group/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/group/add-group.js"),t),i(e("./dist/plugins/collaboration/ops/group/remove-group.js"),t),i(e("./dist/plugins/collaboration/ops/group/reset-group.js"),t),i(e("./dist/plugins/collaboration/ops/group/set-collapsed.js"),t),i(e("./dist/plugins/collaboration/ops/group/direction.js"),t),i(e("./dist/plugins/collaboration/ops/group/show-outline.js"),t),i(e("./dist/plugins/collaboration/ops/group/add-row-column-for-outline.js"),t),i(e("./dist/plugins/collaboration/ops/group/remove-row-column-for-outline.js"),t),i(e("./dist/plugins/collaboration/ops/group/set-row-column-count.js"),t)},"./dist/plugins/collaboration/ops/group/remove-group.js":function(o,t,e){"use strict";var t,n,a,i;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/group/util.js"),i={type:t.OpType.removeGroup,createOp:function(o){return(0,a.createGroupOp)(i.type,o)},applyOp:function(o,t){var e,n,i,e,o,e=t.payload,n=e.index,i=e.isRowGroup,e=e.count,o=(0,a.getOutline)(o,t.sheetId,i);null!=o&&o.Z_r&&(o.Z_r(n,e),o.Y_r())}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/group/remove-row-column-for-outline.js":function(o,t,e){"use strict";var t,n,s,l,i;function r(o){o.A2t=null,o.refresh()}Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/group/util.js"),l=e("Outlines"),i={type:t.OpType.deleteGroupItem,createOp:function(o){var t=o.nextItem;return t&&(t={level:t.level,collapsed:t.collapsed,viewCollapsed:t.viewCollapsed},o.nextItem=t),(0,s.createGroupOp)(i.type,o)},applyOp:function(o,t){var e,n,i,a,e,o,t,e=t.payload,n=e.index,i=e.isRowGroup,a=e.count,e=e.nextItem,o=(0,s.getOutline)(o,t.sheetId,i);o&&(t=o.items.splice(n,a),0<n&&0<t.length&&e&&(o.items[n]=new l.OutlineItemInfo(e)),r(o))}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/group/reset-group.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/group/util.js"),a={type:t.OpType.resetGroup,createOp:function(o){return(0,i.createGroupOp)(a.type,o)},applyOp:function(o,t){var e,o,e=t.payload.isRowGroup,o=(0,i.getOutline)(o,t.sheetId,e);o&&(o.items=new Array(o.items.length),o.Y_r(),o.x2t=!0)}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/group/set-collapsed.js":function(o,t,e){"use strict";var r,u,t,p,n;Object.defineProperty(t,"__esModule",{value:!0}),r=e("Core"),u=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),p=e("./dist/plugins/collaboration/ops/group/util.js"),n={type:u.OpType.updateCollapsed,createOp:function(o){return(0,p.createGroupOp)(n.type,o)},applyOp:function(o,t){var e,n,i,a,e,n,s,l,l,s,e=t.payload,n=e.isRowGroup,i=e.index,a=e.collapsed,e=e.specifiedLevel,n=(0,p.getOutline)(o,t.sheetId,n);n&&(n.I2t&&!n.A2t&&(n.A2t=n.createRangeGroup()),s=n.W_r(i),(!(l=void 0!==e)&&s.collapsed!==a||l&&s.level===e-1)&&(s.collapsed=a),l=n.Q_r(i,a,e),n.J_r(l),s=o.c_r(t.sheetId),r.Worksheet.et(s,"onLayoutChangedFromOp",{changeType:u.OpType.updateCollapsed}))}},(0,t.registerOpProcess)(n)},"./dist/plugins/collaboration/ops/group/set-row-column-count.js":function(o,t,e){"use strict";var t,n,i,a;function s(o){o.A2t=null,o.refresh()}Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/group/util.js"),a={type:t.OpType.setRowColumnCountForOutline,createOp:function(o){return(0,i.createGroupOp)(a.type,o)},applyOp:function(o,t){var e,n,e,o,t,n,e=t.payload,n=e.isRowGroup,e=e.count,o=(0,i.getOutline)(o,t.sheetId,n),t=null==o?void 0:o.items;o&&((n=e-o.items.length)<0?t.splice(e,-n):o.items=t.concat(new Array(n)),s(o))}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/group/show-outline.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/group/util.js"),a={type:t.OpType.showOutline,createOp:function(o){return(0,i.createGroupOp)(a.type,o)},applyOp:function(o,t){var e,n,e,o,t,e=t.payload,n=e.isRow,e=e.value,o=o.c_r(t.sheetId);o&&(t={shouldModelCallback:!1},n?o.showRowOutline(e,void 0,t):o.showColumnOutline(e,void 0,t))}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/group/util.js":function(o,t,e){"use strict";var n,i;function a(o,t){var e=t.sheetId,t=n(t,["sheetId"]);return{type:o,module:i.OpModule.outline,sheetId:e,payload:t}}function s(o,t,e){var o=o.c_r(t);return e?o.rowOutlines:o.columnOutlines}function l(o,t){return o.items[t]}n=this&&this.__rest||function(o,t){var e,n,i,e={};for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(e[n]=o[n]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols)for(i=0,n=Object.getOwnPropertySymbols(o);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(o,n[i])&&(e[n[i]]=o[n[i]]);return e},Object.defineProperty(t,"__esModule",{value:!0}),t.getOutlineItem=t.getOutline=t.createGroupOp=void 0,i=e("CollaborationTypes"),t.createGroupOp=a,t.getOutline=s,t.getOutlineItem=l},"./dist/plugins/collaboration/ops/hyperlink/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/hyperlink/set-hyperlink.js"),t),i(e("./dist/plugins/collaboration/ops/hyperlink/interface.js"),t)},"./dist/plugins/collaboration/ops/hyperlink/interface.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"./dist/plugins/collaboration/ops/hyperlink/set-hyperlink.js":function(o,t,e){"use strict";var a,t,e,s;Object.defineProperty(t,"__esModule",{value:!0}),a=e("CollaborationTypes"),t=e("./dist/plugins/collaboration/enum.js"),e=e("./dist/plugins/collaboration/op-manager.js"),s={type:t.OpType.setHyperlink,createOp:function(o){var t=o.sheetId,e=o.row,n=o.col,i=o.sheetArea,o=o.hyperlink;return{type:s.type,module:a.OpModule.hyperlink,sheetId:t,target:{row:e,col:n,sheetArea:i},payload:{hyperlink:o}}},applyOp:function(o,t){var e,n,t,i,a,n,s,l,o,e=t.sheetId,n=t.target,t=t.payload,i=n.row,a=n.col,n=n.sheetArea,s,l,o=o.c_r(e).Ut.W_(n).J_(i,a,!0);o&&(t.hyperlink?o.hyperlink=t.hyperlink:delete o.hyperlink)}},(0,e.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/outline-column/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/outline-column/set-outline-column-options.js"),t)},"./dist/plugins/collaboration/ops/outline-column/set-outline-column-options.js":function(o,t,e){"use strict";var t,i,n,a,p,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("Common"),i=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),p=t.Common.lt.ht,e={type:i.OpType.setOutlineColumnOptions,createOp:function(o){var t=o.propName,e=o.value,n=o.options;return{type:i.OpType.setOutlineColumnOptions,module:a.OpModule.outlineColumn,sheetId:o.sheetId,payload:{propName:t,value:e,options:n}}},applyOp:function(o,t){var e,t,n,i,t,o,e,a,s,l,r,u,e=t.sheetId,t=t.payload,n=t.propName,i=t.value,t=t.options,o=o.c_r(e);if(o&&o.outlineColumn&&(e=o.outlineColumn)){if(t)e.K_r(t);else if("data"===n)if(a=e.mst,s=i.row,l=i.count,r=i.checkStatus,p(s))a.setAllItemCheckStatus(r,!1);else for(u=0;u<(null!=l?l:1);u++)a.updateCheckStatus(s+u,r,!1);else e.NB._ps[n]=i;e.refresh()}}},(0,n.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/add-pivot-cache.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/remove-pivot-cache.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache-field.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-field.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-field.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-table.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-table.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/update-pivot-table-layout.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/update-fields-model.js"),t)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/add-pivot-cache.js":function(o,t,e){"use strict";var n,t,i,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js"),a=e("CollaborationTypes"),e={type:n.OpType.addPivotCache,createOp:function(o,t){return{type:n.OpType.addPivotCache,module:a.OpModule.pivotCache,payload:{pivotCacheName:o.pivotCacheName,sourceData:o.sourceData,pivotSheetId:o.pivotSheet.jKe(),cacheJSON:(0,i.doo)(t,o.pivotCache),cacheId:o.pivotCache.jKe()}}},applyOp:function(o,t){var t,e,n,i,t,n,e,t=t.payload,e=t.pivotCacheName,n=t.pivotSheetId,i=t.sourceData,t=t.cacheId,n=o.c_r(n),e=o.sFr(e,i,n);o.uFr(e),e.UKn(t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/remove-pivot-cache.js":function(o,t,e){"use strict";var n,t,i,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("PivotTable"),a=e("CollaborationTypes"),e={type:n.OpType.removePivotCache,createOp:function(o,t){var o=o.pivotCache;return{type:n.OpType.removePivotCache,module:a.OpModule.pivotCache,payload:{pivotCacheName:o.getName(),cacheId:o.jKe()}}},applyOp:function(o,t){var t;i&&(t=t.payload,o.JYt(t.pivotCacheName))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache-field.js":function(o,t,e){"use strict";var u,t,d,b,p,c,e;Object.defineProperty(t,"__esModule",{value:!0}),u=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),d=e("PivotTable"),b=e("./dist/plugins/collaboration/ops/pivot/util.js"),p=e("./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js"),c=e("CollaborationTypes"),e={type:u.OpType.updatePivotCacheField,createOp:function(o,t){var e,n,i,a,s,o,n,o,l,r,e=o.pt,n=o.fieldsModel,i=o.propertyName,a=o.sheetId,s=o.params;if(!e)return null;switch(o=n.Ti,n=n.L,o=o.getPivotCacheByName(n),l=(0,p.doo)(t,o),r={},i){case"addCalcField":r.calcFieldJSON=l.fields.find(function(o){return o.name===s.fieldName});break;case"removeCalcField":r.removedCalcFieldName=s.fieldName;break;case"addCalcItem":case"removeCalcItem":case"updateCalcItem":r.calcItemCount=l.calcItemCount,r.calculatedItems=l.calculatedItems,r.fields=l.fields;break;case"addGroup":case"removeGroup":r.fields=l.fields,r.pivotCacheRecords=l.pivotCacheRecords;break;case"setOverwriteList":r.overwriteList=s.overwriteList}return{type:u.OpType.updatePivotCacheField,module:c.OpModule.pivotCache,payload:{id:e.jKe(),propertyName:i,params:s,sheetId:a,serverInfo:r,cacheId:o.jKe()}}},applyOp:function(o,t){var t,e,n,i,t,o,a,s,l,r,u,p,c;if(d&&(e=(t=t.payload).propertyName,n=t.params,i=t.sheetId,t=t.id,a=(o=(0,b.boo)(o,i,t)).dh,o)){switch(e){case"addGroup":if((s=n.groupInfo).dateGroups){for(l=[],r=0;r<s.dateGroups.length;r++)p={},(u=s.dateGroups[r]).start&&(p.start=new Date(u.start)),u.end&&(p.end=new Date(u.end)),u.by&&(p.by=u.by),l.push(p);s.dateGroups=l}a.dy(s);break;case"removeGroup":a.cy(n.sourceName,n.notNeedBackUp,n.notRemoveField);break;case"addCalcField":a.QVt(n.fieldName,n.formula);break;case"removeCalcField":a.fit(n.fieldName);break;case"addCalcItem":a.Db(n.sourceName,n.calcItemName,n.formula);break;case"removeCalcItem":a.Rp(n.sourceName,n.calcItemName);break;case"updateCalcItem":a.x1(n.sourceName,n.calcItemName,n.formula,n.priority);break;case"setOverwriteList":(c=a.Ti.getPivotCacheByName(a.L)).Z$t.fromJSON(n.overwriteList)}o.refresh()}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache.js":function(o,t,e){"use strict";var a,t,r,s,l,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),r=e("PivotTable"),s=e("./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js"),l=e("CollaborationTypes"),e={type:a.OpType.updatePivotCache,createOp:function(o,t){var e,n,i,o,i,e=o.sourceData,n=o.pivotCache,i=o.ptName,o=o.pivotSheet,i=o.pivotTables.get(i);return{type:a.OpType.updatePivotCache,module:l.OpModule.pivotCache,payload:{sourceData:e,sheetId:o.jKe(),ptId:i.jKe(),pivotCacheName:n.getName(),cacheId:n.jKe(),cacheJSON:(0,s.doo)(t,n)}}},applyOp:function(o,t){var t,e,n,i,t,n,t,a,s,l;if(r){for(e=(t=t.payload).sourceData,n=t.sheetId,i=t.ptId,t=t.pivotCacheName,n=o.c_r(n),t=o.fMt.cut[t],a=void 0,s=n.pivotTables.all(),l=0;l<s.length;l++)if(s[l].jKe()===i){a=s[l];break}a&&o.kx(e,t,a.getName(),n)}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doo=void 0;var n=e("PivotTable");function i(o,t){return n?n.rFr(o,t.Zc,{isServer:!0})[t.jKe()]:t.toJson()}t.doo=i},"./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-field.js":function(o,t,e){"use strict";var l,r,t,u,p,e;Object.defineProperty(t,"__esModule",{value:!0}),l=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),u=e("./dist/plugins/collaboration/ops/pivot/util.js"),p=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),e={type:r.OpType.addPivotField,createOp:function(o){var t,e,o,t,n,i,o,a,s,n,t=o.fieldsModel,e=o.sheetId,o=o.params,t=(0,u.voo)(t);return t?(n=(0,p.Coo)(t),i=o.area,o=o.index,a=n.fieldsInfo[i][o],s=n.valuePosition,n=n.pivotTablePosition,{type:r.OpType.addPivotField,module:l.OpModule.pivotTable,sheetId:e,target:(0,p.yoo)(t),payload:{id:t.jKe(),fieldInfo:a,valuePosition:s,position:n,area:i,index:o}}):null},applyOp:function(o,t){var e,t,n,i,a,s,t,o,e,n,l,r,i,n,e=t.sheetId,t=t.payload,n=t.id,i=t.fieldInfo,a=t.valuePosition,s=t.area,t=t.index,o=(0,u.boo)(o,e,n),e=o.dh;o&&(n=i.sourceName,l=i.displayName,r=i.subtotal,i=i.isShowSubtotalTop,e.isFieldActualExist(n)&&(n=e.addFieldByName(n,l,s,r,t))&&(n.Spi=i),a&&e.setSigmaValuePosition(a.positionType,a.positionIndex),o.refresh())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-table.js":function(o,t,e){"use strict";var a,n,t,i,s,l,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("PivotTable"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),s=e("CollaborationTypes"),e={type:n.OpType.addPivotTable,createOp:function(o){var t,e,t=o.pivotTable,e=(0,i.Coo)(t);return{type:n.OpType.addPivotTable,module:s.OpModule.pivotTable,sheetId:o.sheetId,target:(0,i.yoo)(t),payload:{id:t.jKe(),pt:e,cacheName:t.dh.L}}},applyOp:function(o,t){var e,t,n,i,t,e,o,i,i,e=t.sheetId,t=t.payload,n=t.pt,i=t.cacheName,t=t.id,e=o.c_r(e),o=o.UYt(i,n.serverInfo.name),i=n.pivotTablePosition,i=new a.PivotTable(n.serverInfo.name,e,i[0],i[1],n.layoutType,l,l,o);i.tJt(n,40959),i.UKn(t),e.pivotTables.oFr(i)}},(l=void 0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-field.js":function(o,t,e){"use strict";var s,l,t,r,e;Object.defineProperty(t,"__esModule",{value:!0}),s=e("CollaborationTypes"),l=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/pivot/util.js"),e={type:l.OpType.removePivotField,createOp:function(o){var t,e,o,n,i,o,a,t=o.fieldsModel,e=o.sheetId,o=o.params,n=(0,r.voo)(t);return n?(i=o.field,o=o.area,a=n.eZt,{type:l.OpType.removePivotField,module:s.OpModule.pivotTable,sheetId:e,payload:{id:n.jKe(),sourceName:i.a,area:o,valuePosition:t.getSigmaValuePosition(),position:[a.row,a.col]}}):null},applyOp:function(o,t){var e,t,n,i,t,o,e,a,s,l,e=t.sheetId,t=t.payload,n=t.id,i=t.sourceName,t=t.area,o=(0,r.boo)(o,e,n),e=o.dh;if(o){for(a=e.nw(t),l=0;l<a.length;l++)if((s=a[l]).a===i){a.splice(l,1);break}delete e.Z[s.Zc],e.q1=!0,o.refresh()}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-table.js":function(o,t,e){"use strict";var n,i,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/pivot/util.js"),e={type:i.OpType.removePivotTable,createOp:function(o){return{type:i.OpType.removePivotTable,module:n.OpModule.pivotTable,sheetId:o.sheetId,payload:{id:o.pivotTable.jKe(),isMove:o.isMove}}},applyOp:function(o,t){var e,t,n,t,i,o,e=t.sheetId,t=t.payload,n=t.id,t=t.isMove,i=o.c_r(e),o=(0,a.boo)(o,e,n);i.pivotTables.TOt(o.name(),t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-table/update-fields-model.js":function(o,t,e){"use strict";var f,t,p,v,g,e;Object.defineProperty(t,"__esModule",{value:!0}),f=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),p=e("./dist/plugins/collaboration/ops/pivot/util.js"),v=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),g=e("CollaborationTypes"),e={type:f.OpType.updateFieldsModel,createOp:function(o){var t,e,n,i,a,s,o,l,r,u,u,p,c,d,b,t=o.pivotTable,e=o.fieldsModel,n=o.propertyName,i=o.sheetId,a=o.params;if(!t)return null;switch(o=(s=(0,v.Coo)(t)).pivotTablePosition,(l={}).position=o,n){case"changeFieldName":break;case"setCollapse":l.collapseItems=s.collapseItems;break;case"setSortInfo":r=a.fieldName,u=e.Z[a.fieldName],u=s.fieldsInfo[u].find(function(o){return o.displayName===r}),l.sortInfo=u.sortInfo;break;case"subTotalType":break;case"updateValuePosition":l.valuePosition=s.valuePosition;break;case"setLabelFilterInfo":for(l.sourceName=a.sourceName,p=s.fieldsInfo,c=0;c<4;c++)for(d=p[c],b=0;b<d.length;b++)if(d[b].sourceName===a.sourceName){l.labelFilter=d[b].labelFilter;break}break;case"setValueFilterInfo":for(l.sourceName=a.sourceName,p=s.fieldsInfo,c=0;c<4;c++)for(d=p[c],b=0;b<d.length;b++)if(d[b].sourceName===a.sourceName){l.valueFilter=d[b].valueFilter;break}break;case"showNoData":l.noDataInfo=s.showNoDataInfo[a.name],l.name=a.name}return{type:f.OpType.updateFieldsModel,module:g.OpModule.pivotTable,sheetId:i,target:(0,v.yoo)(t),payload:{id:t.jKe(),propertyName:n,serverInfo:l,params:a}}},applyOp:function(o,t){var e,t,n,i,a,t,s,l,r,u,e=t.sheetId,t=t.payload,n=t.id,i=t.propertyName,a=t.params,t=(0,p.boo)(o,e,n),s=t.dh;if(t){switch(l=a.sourceName,i){case"changeFieldName":u=s.v_(l),s.changeFieldName(u,a.newFieldName);break;case"updateValuePosition":s.setSigmaValuePosition(a.newPositionType,a.newPositionIndex);break;case"setCollapse":s.setCollapse(l,a.item,a.isCollapse);break;case"setSortInfo":r=s.getFieldNameBySourceName(l),s.setSortInfo(r,a.sortInfo);break;case"subTotalType":r=s.getFieldNameBySourceName(l),s.xy(r,a.subtotalType);break;case"setLabelFilterInfo":s.setLabelFilterInfo(l,a.filterInfo);break;case"setValueFilterInfo":s.setValueFilterInfo(l,a.filterInfo,a.index)}t.refresh()}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-table/update-pivot-table-layout.js":function(o,t,e){"use strict";var a,t,f,v,g,c,s,j,e;function l(o,t,e){var n,i,a,s,l,r,u,n,n,u,p;if(!t||!e)return t;switch(a=(i=(0,c.Coo)(e)).pivotTablePosition,(s={}).position=a,l=e.dh,r=t,o){case"theme":(u=t.theme)&&((n=e.getThemeName())?(r={themeName:n},s.theme=n):(r={theme:n=u.toJSON()},s.theme=n));break;case"position":u=t.toSheet,r={row:t.row,col:t.col,sheetId:null==u?void 0:u.jKe()};break;case"setStyle":r={pivotArea:t.pivotArea,style:null==(n=t.style)?void 0:n.toJSON()};break;case"showDataAs":r={sourceName:p=d(t.fieldName,l),showDataAsInfo:t.showDataAsInfo},s.showDataAsList=i.showDataAsList;break;case"addConditionalRule":r={pivotAreas:t.pivotAreas,conditionalRule:t.conditionalRule.toJSON(j,{isServer:!0})};break;case"removeConditionalRule":r={ruleId:t.conditionalRule.jKe()};break;case"subtotalPosition":r={sourceName:d(t.fieldName,l),position:t.position},s.showSubtotalTop=t.position===v.SubtotalsPosition.top;break;case"resetPivotStyle":s.styles=i.styles}return{params:r,serverInfo:s}}function d(o,t){var t;return null!=(t=t.getSourceNameByFieldName(o))?t:o}function m(o,t){var t;return null!=(t=t.getFieldNameBySourceName(o))?t:o}Object.defineProperty(t,"__esModule",{value:!0}),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),f=e("./dist/plugins/collaboration/ops/pivot/util.js"),v=e("PivotTable"),g=e("Core"),c=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),s=e("CollaborationTypes"),e={type:a.OpType.updatePivotTableLayout,createOp:function(o){var t,e,n,o,e,i,e,t=o.pivotTable,e=o.params,n=o.sheetId,o=o.propertyName,e=l(o,e,t),i=e.params,e=e.serverInfo;return{type:a.OpType.updatePivotTableLayout,module:s.OpModule.pivotTable,sheetId:n,target:(0,c.yoo)(t),payload:{id:t.jKe(),propertyName:o,params:i,serverInfo:e}}},applyOp:function(o,t){var e,t,n,i,a,s,l,r,u,r,u,r,p,c,d,b,u;if(v&&(e=t.sheetId,n=(t=t.payload).id,i=t.propertyName,a=t.params,s=(0,f.boo)(o,e,n))){switch(s.suspendLayout(),l=s.dh,i){case"theme":a.themeName?s.theme(a.themeName):a.theme&&(r=a.theme,(u=new v.PivotTableTheme).fromJSON(r),s.theme(u));break;case"layoutType":s.layoutType(a.type);break;case"name":s.name(a.name);break;case"position":u=(r=a.sheetId)&&o.c_r(r),s.position(a.row,a.col,null==u?void 0:u.name());break;case"setStyle":r=null,a.style&&(r=new g.Style).fromJSON(a.style,j,j),s.setStyle(a.pivotArea,r);break;case"options":s.options[a.optionName]=a.value;break;case"showDataAs":p=m(a.sourceName,l),s.showDataAs(p,a.showDataAsInfo);break;case"resetPivotStyle":s.rqt(a.areaModel,a.rangeModel);break;case"adjustRange":s.adjustRange();break;case"addConditionalRule":if(!(d=(c=s.getHost()).conditionalFormats))return;b=d.pJ(a.conditionalRule,c,void 0),s.mJ.JJt(a.pivotAreas,b,!0);break;case"removeConditionalRule":if(!(d=(c=s.getHost()).conditionalFormats))return;b=d.B_r(a.ruleId),s.removeConditionalRule(b);break;case"showNoData":s.showNoData(a.cacheFieldName,a.isShow);break;case"subtotalPosition":p=m(a.sourceName,l),s.subtotalPosition(p,a.position);break;case"addPivotTableView":u={name:a.name,config:a.config},s.views.add(u);break;case"removePivotTableView":s.views.remove(a.name)}s.resumeLayout()}}},(j=void 0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/pivot/pivot-table/util.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yoo=t.Ooo=t.Coo=void 0;var n=e("Core");function i(o){return o.dh.q1&&o.refresh(),o.nqt(40959)}function a(o){return{fieldName:o.Zc,sourceName:o.a,sortInfo:(0,n.RF)(o.nrt),subtotalType:o.Ar}}function s(o){var o,t,o,e,o=o.getRange(),t=o.page,o=o.content;return t&&(e=t.union(o)),{row:o.row,col:o.col,rowCount:o.rowCount,colCount:o.colCount}}t.Coo=i,t.Ooo=a,t.yoo=s},"./dist/plugins/collaboration/ops/pivot/util.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.voo=t.boo=void 0;var n=e("PivotTable");function i(o,t,e){var n;return o.c_r(t).pivotTables.aFr(e)}function a(o){return o.z.find(function(o){return o instanceof n.PivotTable})}t.boo=i,t.voo=a},"./dist/plugins/collaboration/ops/print/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/print/set-print-info.js"),t),i(e("./dist/plugins/collaboration/ops/print/set-print-info-option.js"),t)},"./dist/plugins/collaboration/ops/print/set-print-info-option.js":function(o,t,e){"use strict";var a,s,t,l,r,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),l="pageHeaderFooter",r="normal",e={type:s.OpType.setPrintInfoOption,createOp:function(o){var t,t,e,n,i,e=o.propName,n=o.secondPropName,i=o.value;return"paperSize"!==e||n||(i=null!=(t=null==(t=null==i?void 0:i.toJSON)?void 0:t.call(i))?t:i),{type:s.OpType.setPrintInfoOption,module:a.OpModule.print,sheetId:o.sheetId,payload:{propName:e,secondPropName:n,value:i}}},applyOp:function(o,t){var e,t,n,i,t,o,e,a,s,e=t.sheetId,t=t.payload,n=t.propName,i=t.secondPropName,t=t.value,o=o.c_r(e);o&&o.printInfo()&&(e=o.printInfo())&&(i?(s=e[a="_".concat(l)][r])[n][i]=t:"paperSize"===n?e["_"+n].fromJSON(t):e["_"+n]=t,o)&&!0===o.isPrintLineVisible()&&o.repaint()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/print/set-print-info.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Print"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.setPrintInfo,createOp:function(o){var t=o.printInfo;return{type:n.OpType.setPrintInfo,module:i.OpModule.print,sheetId:o.sheetId,payload:{value:t.toJSON()}}},applyOp:function(o,t){var e,n,t,o,e,i,e=t.sheetId,n,t=t.payload.value,o=o.c_r(e);o&&o.printInfo()&&(e=o.printInfo())&&((i=new a.PrintInfo).fromJSON(t),(e.Pie=i).Mf||i.sheet(o))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/add-shape.js":function(o,t,e){"use strict";var n,i,a,s,e;function l(o,t){var t=(0,n.shapeFromJSON)(o,t);t&&t.formulaFromJSON(),t&&o.shapes.ZP(t,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.addShape=void 0,n=e("Shapes"),i=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),e={type:i.OpType.addShape,createOp:function(o){var t={shapeJson:o.shape.toJSON({isServer:!0})};return{type:i.OpType.addShape,module:s.OpModule.shape,sheetId:o.sheetId,payload:t}},applyOp:function(o,t){var e,n,t,i,e=t.sheetId,n,t=t.payload.shapeJson,i;l(o.c_r(e),t)}},t.addShape=l,(0,a.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/group-shape.js":function(o,t,e){"use strict";var n,t,a,s,l,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/shape/remove-shape.js"),s=e("./dist/plugins/collaboration/ops/shape/add-shape.js"),l=e("CollaborationTypes"),e={type:n.OpType.groupShape,createOp:function(o){var i,t,i={};return o.childShapes.forEach(function(o){var t,e,n,t=o.ytV.calcStartAndEndPoint(),e=o.ytV.ToCT_PositiveSize2D(),n=o.ytV.ToCT_Point2D();i[o.getId()]={anchor:t,size:e,pos:n}}),t={groupShapeJson:o.groupShape.toJSON({isServer:!0}),childShapeIds:o.childShapes.map(function(o){return o.getId()}),childShapeAnchorInfoMap:i},{type:n.OpType.groupShape,module:l.OpModule.shape,sheetId:o.sheetId,payload:t}},applyOp:function(o,t){var e,t,n,t,i,e=t.sheetId,t=t.payload,n=t.groupShapeJson,t=t.childShapeIds,i=o.c_r(e);t.forEach(function(o){(0,a.removeShape)(i,o)}),(0,s.addShape)(i,n)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/group-shape/add-shape.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Shapes"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.groupShape_add,createOp:function(o){return{type:n.OpType.groupShape_add,module:i.OpModule.shape,sheetId:o.sheetId,payload:{groupShapeId:o.groupShapeId,shapeJson:o.shape.toJSON({isServer:!0})}}},applyOp:function(o,t){var e,t,n,t,o,i,e,n,o,e=t.sheetId,t=t.payload,n=t.groupShapeId,t=t.shapeJson,o=o.c_r(e),i,e=o.shapes.lEr(n);e&&((n=(0,a.shapeFromJSON)(o,t))&&n.formulaFromJSON(),n)&&(e.tin.push(n),e.ytV.GroupItems.Add(n.ytV,e.ytV),o=e.ctV,e.ctV&&e.ctV.addShape(o),e.updateRelativeLocationSize())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/group-shape/remove-shape.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Shapes"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.groupShape_remove,createOp:function(o){return{type:n.OpType.groupShape_remove,module:i.OpModule.shape,sheetId:o.sheetId,payload:{groupShapeId:o.groupShapeId,removeShapeId:o.removeShapeId}}},applyOp:function(o,t){var e,t,n,t,i,o,e,n,o,t,e=t.sheetId,t=t.payload,n=t.groupShapeId,t=t.removeShapeId,i,o=o.c_r(e).shapes,e=o.lEr(n);!e||!(n=o.lEr(t))||(t=(o=e.tin).indexOf(n))<0||(o.splice(t,1),e.ytV.GroupItems.Remove(n.ytV),e.ctV&&e.ctV.removeShape(n.ctV),delete n.sft,delete n.relativeHeight,delete n.relativeWidth,delete n.relativeX,delete n.relativeY,e._iV=(0,a.isContainsDisableRotateShape)(e.all()),e.refresh())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/group-shape/zIndex-shape.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.groupShape_zIndex,createOp:function(o){return{type:i.OpType.groupShape_zIndex,module:n.OpModule.shape,sheetId:o.sheetId,payload:{groupShapeId:o.groupShapeId,zIndexShapeId:o.zIndexShapeId,zIndex:o.index}}},applyOp:function(o,t){var e,t,n,i,t,a,o,e,n,o,i,o,e=t.sheetId,t=t.payload,n=t.groupShapeId,i=t.zIndexShapeId,t=t.zIndex,a,o=o.c_r(e).shapes,e=o.lEr(n);if(e&&(n=o.lEr(i))){if(i=(o=e.tin).length,o=o.indexOf(n),1===arguments.length)return o;t=Math.min(i-1,t),t=Math.max(0,t),e.tin.splice(o,1),e.tin.splice(t,0,n),e.ctV.zIndex(o,t,n.ctV),e.ytV.GroupItems.zIndex(o,t,n.ytV),e.refresh()}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/remove-shape.js":function(o,t,e){"use strict";var a,n,i,s,e;function l(o,t){var e,n,t,i,e=o.shapes,n=e.lEr(t);n&&(t=n.name(),o.shapeLayers.forEach(function(o){var t=n.ctV;t&&o.removeShape(t)}),delete e.tin[t],-1<(i=e.dnV.indexOf(t))&&e.dnV.splice(i,1),delete n.mnV,o.RnV[t]=!1,o.cameraShapes=[],(0,a.findCameraShape)(o.shapes.all(),o.cameraShapes))}Object.defineProperty(t,"__esModule",{value:!0}),t.removeShape=void 0,a=e("Shapes"),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),e={type:n.OpType.removeShape,createOp:function(o){return{type:n.OpType.removeShape,module:s.OpModule.shape,sheetId:o.sheetId,payload:{shapeId:o.shapeId}}},applyOp:function(o,t){var e,n,t,i,e=t.sheetId,n,t=t.payload.shapeId,i;l(o.c_r(e),t)}},t.removeShape=l,(0,i.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/ungroup-shape.js":function(o,t,e){"use strict";var n,i,t,g,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),g=e("Shapes"),e={type:i.OpType.unGroupShape,createOp:function(o){var a,t,a={};return o.childShapes.forEach(function(o){var t,e,n,i,t=o.ytV.calcStartAndEndPoint(),e=o.ytV.ToCT_PositiveSize2D(),n=o.ytV.ToCT_Point2D(),i=(0,g.getWholeNumber)(o.ytV.RotationWithoutParent*g.ShapeConstants.PositiveFixedAngleConvert);a[o.getId()]={anchor:t,size:e,pos:n,rot:i}}),t={groupShapeId:o.groupShape.getId(),childShapeAnchorInfoMap:a},{type:i.OpType.unGroupShape,module:n.OpModule.shape,sheetId:o.sheetId,payload:t}},applyOp:function(o,t){var e,n,t,i,a,s,l,r,u,p,c,d,b,f,v,e=t.sheetId,n,t=t.payload.groupShapeId,i,a=o.c_r(e).shapes,s=a.lEr(t);if(s){for(l=s.tin.slice(0),r=a.zIndex(s.name()),u=s.ctV.getShapeCenter(),p=(0,g.toRadius)(s.rotate()),c=[],0!==p&&l.forEach(function(o){4===o.ttV?c.push((0,g.getLineShapePointsForUngroup)(u,p,o.ctV)):c.push((0,g.getShapeLocationForUnGroup)(u,p,o))}),s.LnV=!0,a.VP(s,!0,!0),d=l.length,s.vnV=!0,b=d-1;0<=b;b--)s.remove(l[b]);for(delete s.vnV,delete s.LnV,s.jnV(),b=0;b<d;b++)v=l[b],0!==p&&(4===v.ttV?v.nnV(c[b]):v.bnV(c[b].x,c[b].y,!0,!1,!1,!0)),a.ZP(v,void 0,!0),f=v.name(),a.zIndex(f,r+b),0!==p&&3===v.ttV&&v.ctV.move(c[b].x,c[b].y)}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/update-shape-anchor.js":function(o,t,e){"use strict";var n,i,t,r,a,s,u,p,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),r=e("Shapes"),a=e("./dist/plugins/collaboration/util/common.js"),s=e("CollaborationTypes"),u=function(o,t){o.hVV=t.row,o.uVV=t.rowOffset,o.xVV=t.col,o.yVV=t.colOffset},p=function(o,t){o.CtV=t.row,o.RtV=t.rowOffset,o.ItV=t.col,o.MtV=t.colOffset},e={type:i.OpType.updateShapeAnchor,createOp:function(o){var t,e,t=o.shapeId,e=o.shape;return{type:i.OpType.updateShapeAnchor,module:s.OpModule.shape,sheetId:o.sheetId,payload:{shapeId:t,anchor:e.ytV.calcStartAndEndPoint(),size:e.ytV.ToCT_PositiveSize2D(),pos:e.ytV.ToCT_Point2D()}}},mergeOp:function(o,t){var o;if(o.payload.shapeId===t.payload.shapeId)return(o=(0,a.clone)(o)).payload=n(n({},o.payload),{size:n(n({},o.payload.size),t.payload.size),pos:n(n({},o.payload.pos),t.payload.pos),anchor:n(n({},o.payload.anchor),t.payload.anchor)}),o},applyOp:function(o,t){var e,t,n,i,a,t,s,o,e,n,i,l,e=t.sheetId,t=t.payload,n=t.shapeId,i=t.anchor,a=t.pos,t=t.size,s,o=o.c_r(e).shapes.lEr(n);o&&(e=o.ytV,n=(0,r.readExcelIOAnchorPoint)(i.startPoint),i=(0,r.readExcelIOAnchorPoint)(i.endPoint),u(e,n),p(e,i),0!==(l=e.RotationWithoutParent)?e.fromAnchorWhenRot(l,n,i):(e.xnV(),e.mtV()),e.I0=a.x,e.A0=a.y,e.YC=t.cx,e.ZC=t.cy,3===o.ttV?o.anV():o.hiV())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/update-shape-formula.js":function(o,t,e){"use strict";var n,i,t,s,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("Shapes"),e={type:i.OpType.updateShapeFormula,createOp:function(o){return{type:i.OpType.updateShapeFormula,module:n.OpModule.shape,sheetId:o.sheetId,payload:{shapeId:o.shapeId,prop:o.prop,value:o.value,info:o.info}}},applyOp:function(o,t){var e,t,n,i,t,a,o,e=t.sheetId,t=t.payload,n=t.shapeId,i=t.prop,t=t.value,a,o=o.c_r(e).shapes.lEr(n);o&&(0,s.setFormula)(o,i,t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/update-shape-prop.js":function(o,t,e){"use strict";var n,i,t,d,b,e;function s(o,t,e,n,i){var a,a,s,a,a,l,a,i,r,u,p,p,c,c,i,s=t.ytV;"type"===e?4===t.ttV?(s.AtV.Type=d.ShapeUtility.ToConnectorType(n),s.PointNum=d.ShapeUtility.GetConnectorPointNum(n)):(s.AutoShapeType=d.ShapeUtility.ToAutoShapeType(n),n&&t.tnV(),t.GiV(),t.TrV()):"alt"===e?t.AiV=n:"isLocked"===e?t.uiV=n:"isVisible"===e?(s.Visible=n)||t.isSelected(!1):"canPrint"===e?t.xiV=n:"allowResize"===e?(s.noChangeAspect=i.noChangeAspect,t.yiV=n):"dynamicSize"===e?t.SnV=n:"dynamicMove"===e?t.FnV=n:"allowRotate"===e?t.fiV=n:"allowMove"===e?t.liV=n:"showHandle"===e?t.giV=n:"name"===e?(s.Name=n,t.mnV&&t.mnV._nV(name,n),t.Mf&&t.Mf.csV(name,n)):"hyperlink"===e?(s.ku=n,t.ctV&&(t.ctV.hyperlink=s.ku)):"rotate"===e?(a=n/d.ShapeConstants.PositiveFixedAngleConvert,s.RotationWithoutParent=a,t.ctV.setAngle(s.Rotation),t.GiV()):"isTextBox"===e?s.IsTextBox=n:"adjustments"===e?(s.edV(d.ShapeUtility.convertFromExcelAdjustValues((0,d.convertToArray)(n)),!1),d.ShapeUtility.syncShapeAdjustValues(t.ctV,s)):"fill"===e?(s.Fill.FromOOModel(n,n.colorFillType),d.ShapeUtility.syncShapeFillFormat(t.ctV.options,s)):"line"===e?(s.Line.FromOOModel(n),d.ShapeUtility.syncShapeLineFormat(t.ctV.options,s)):"text"===e?(s.FromCT_TextBody(n),d.ShapeUtility.syncShapeTextFormatOptions(t.ctV.options.textFormatOptions,s),t.TrV()):"vAlign"===e?(t.ctV.options.textFormatOptions.verticalAlignment=n,s.fzn=n,t.teV(n)):"hAlign"===e?(t.ctV.options.textFormatOptions.horizontalAlignment=n,s.czn=n,t.$nV(n)):"resizeToFitText"===e?((a=null==(a=null==(a=t.ctV)?void 0:a.options)?void 0:a.textFormatOptions)&&(a.resizeToFitText=n),s.TrV=n):"src"===e?(l=i.isFormula)?(t.MiV(""),(0,d.setFormula)(t,b,n)):((0,d.removeFormula)(t,b),t.MiV(n)):"pictureFormat"===e?(s.blipFill.FromOOModel(n),t.drV()):"formControlValue"===e?t.GtV.value=n:"formControlEnabled"===e?s.Enabled=n:"startConnector"===e||"endConnector"===e?(a=o.shapeLayers[0].model.idMaps,i=o.shapes.all().map(function(o){return o.ytV}),r=t.ctV,"startConnector"===e?(s.ConnectorFormat.fromStartCxn(n,i,a),u=s.ConnectorFormat.BeginConnectionSite,p=s.ConnectorFormat.BeginConnected,c=void 0,(p=o.shapes.get(p))&&(c={id:p.ctV.id,index:u},r.updateStartConnector(c))):"endConnector"===e&&(s.ConnectorFormat.fromEndCxn(n,i,a),u=s.ConnectorFormat.EndConnectionSite,c=s.ConnectorFormat.EndConnected,i=void 0,p=o.shapes.get(c))&&(i={id:p.ctV.id,index:u},r.updateEndConnector(i))):"flip"===e?(s.ltV=n.flipH,s.gtV=n.flipV):"range"===e?(s.Range=(0,d.getFormula)(t,"range")||n,t.ctV&&t.ctV.JrV(),t.mtV()):"doubleClickCommand"===e&&(s.VtV=n),t.hiV()}Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),d=e("Shapes"),b="src",e={type:i.OpType.updateShapeProp,createOp:function(o){var t;return["line","pictureFormat","fill"].includes(o.prop)?o.value=o.value.ToOOModel():"text"===o.prop?(t=o.value,o.value=o.value.ToCT_TextBody(),(0,d.applyTextBodyProperties)(t,o.value)):"startConnector"===o.prop?o.value=o.value.toStartCxnInfo():"endConnector"===o.prop&&(o.value=o.value.toEndCxnInfo()),{type:i.OpType.updateShapeProp,module:n.OpModule.shape,sheetId:o.sheetId,payload:{shapeId:o.shapeId,prop:o.prop,value:o.value,info:o.info}}},applyOp:function(o,t){var e,t,n,i,a,t,o,e,e=t.sheetId,t=t.payload,n=t.shapeId,i=t.prop,a=t.value,t=t.info,o=o.c_r(e),e=o.shapes.lEr(n);e&&s(o,e,i,a,t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/shape/zIndex-shape.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.zIndexShape,createOp:function(o){return{type:i.OpType.zIndexShape,module:n.OpModule.shape,sheetId:o.sheetId,payload:{shapeId:o.shapeId,zIndex:o.zIndex}}},applyOp:function(o,t){var e,t,n,t,o,e,i,e,n,i,e=t.sheetId,t=t.payload,n=t.shapeId,t=t.zIndex,o=o.c_r(e),e=o.shapes,i=e.dnV,e=e.lEr(n);e&&(n=i.indexOf(e.name()),i.splice(n,1),i.splice(t,0,e.name()),(i=o.shapeLayers[0]).shapes.splice(n,1),i.shapes.splice(t,0,e.ctV))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/slicer/add-slicer-cache.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.addSlicerCache,createOp:function(o){return{type:i.OpType.addSlicerCache,module:n.OpModule.slicer,payload:{slicerCacheType:o.slicerCacheType,json:o.slicerCache.toJSON()}}},applyOp:function(o,t){var t,e,t,e,t,t=t.payload,e=t.slicerCacheType,t=t.json;"table"===e&&(e=t.tableName,t=t.sourceName,o.odi._Qt(e,t))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/slicer/add-slicer.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.addSlicer,createOp:function(o){var t=o.slicer;return{type:n.OpType.addSlicer,module:i.OpModule.slicer,sheetId:o.sheetId,payload:{slicerJSON:t.toJSON()}}},applyOp:function(o,t){var e,n,t,o,e,i,i,e,e=t.sheetId,n,t=t.payload.slicerJSON,o=o.c_r(e),e=o.parent,i={type:t.type,name:t.name,cacheName:t.slicerCacheName,slicer:void 0};a.Worksheet.et(o,"createSlicerByType",i),i=i.slicer,"table"===t.type&&(e=e.odi.get(t.slicerCacheName))&&e._Qt(i),i.init(),i.fromJSON(t),o.slicers.WB(i)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/slicer/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/slicer/add-slicer.js"),t),i(e("./dist/plugins/collaboration/ops/slicer/remove-slicer.js"),t),i(e("./dist/plugins/collaboration/ops/slicer/add-slicer-cache.js"),t),i(e("./dist/plugins/collaboration/ops/slicer/remove-slicer-cache.js"),t),i(e("./dist/plugins/collaboration/ops/slicer/update-slicer.js"),t),i(e("./dist/plugins/collaboration/ops/slicer/update-slicer-cache.js"),t)},"./dist/plugins/collaboration/ops/slicer/remove-slicer-cache.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeSlicerCache,createOp:function(o){return{type:i.OpType.removeSlicerCache,module:n.OpModule.slicer,payload:{slicerCacheId:o.slicerCacheId}}},applyOp:function(o,t){var e,t,e,t=t.payload.slicerCacheId;o.odi.remove(t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/slicer/remove-slicer.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeSlicer,createOp:function(o){return{type:i.OpType.removeSlicer,module:n.OpModule.slicer,sheetId:o.sheetId,payload:{slicerId:o.slicerId}}},applyOp:function(o,t){var e,n,t,o,e,e=t.sheetId,n,t=t.payload.slicerId,o=o.c_r(e),e=o.slicers.get(t);delete o.slicers.z1i[t],e.FQt.remove(t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/slicer/update-slicer-cache.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.updateSlicerCache,createOp:function(o){var t=o.value;return{type:i.OpType.updateSlicerCache,module:n.OpModule.slicer,payload:{slicerCacheId:o.slicerCacheId,slicerCacheType:o.slicerCacheType,propertyName:o.propertyName,value:t}}},applyOp:function(o,t){var t,e,n,i,a,s,t=t.payload,e=t.slicerCacheId,n=t.propertyName,i=t.value,a;(s="table"===t.slicerCacheType?o.odi.get(e):s)&&(s["_"+n]=i)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/slicer/update-slicer.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.updateSlicer,createOp:function(o){var t=o.value;return"style"===o.propertyName&&(t=t.toJSON()),{type:i.OpType.updateSlicer,module:n.OpModule.slicer,sheetId:o.sheetId,payload:{slicerId:o.slicerId,propertyName:o.propertyName,value:t}}},applyOp:function(o,t){var e,t,n,i,t,a,o,e,e=t.sheetId,t=t.payload,n=t.slicerId,i=t.propertyName,t=t.value,a,o=o.c_r(e).slicers.get(n);o&&("style"===i?((e=o.style()).fromJSON(t),o.style(e)):o[i](t))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sort/ops.js":function(o,t,e){"use strict";var t,n,e,i,i,i;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),e("./dist/plugins/collaboration/ops/sort/sort-state.js"),i={type:t.OpType.swapNode,createOp:e=function(o){var t,e,n,i,a,t={type:o.type,module:"sort"},e=o.fromRow,n=o.fromCol,i=o.toRow,a=o.toCol;return t.sheetId=o.sheetId,t.payload={fromRow:e,fromCol:n,toRow:i,toCol:a,sheetArea:o.sheetArea},t},applyOp:function(o,t){var e,t,n,i,a,s,t,l,e=t.sheetId,t=t.payload,n=t.sheetArea,i=t.fromRow,a=t.fromCol,s=t.toRow,t=t.toCol,l;o.c_r(e).Ut.W_(n).I_r(i,a,s,t)}},(0,n.registerOpProcess)(i),i={type:t.OpType.swapDefaultValueNode,createOp:e,applyOp:function(o,t){var e,t,n,i,a,s,t,l,e=t.sheetId,t=t.payload,n=t.sheetArea,i=t.fromRow,a=t.fromCol,s=t.toRow,t=t.toCol,l;o.c_r(e).Ut.Ehe(n).I_r(i,a,s,t)}},(0,n.registerOpProcess)(i),i={type:t.OpType.swapComment,createOp:e,applyOp:function(o,t){var e,t,n,i,a,t,s,l,o,e,r,e=t.sheetId,t=t.payload,n=t.fromRow,i=t.fromCol,a=t.toRow,t=t.toCol,s,l,o=o.c_r(e).Ut.pI,e=o.get(n,i),r=o.get(a,t);o.CB(e,n,i,r,a,t,!1)}},(0,n.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/sort/sort-state.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/op-manager.js"),n=e("./dist/plugins/collaboration/enum.js"),i=e("CollaborationTypes"),a={type:n.OpType.updateSortState,createOp:function(o){return{type:a.type,module:i.OpModule.sort,sheetId:o.sheetId,payload:{sortState:o.sortState}}},applyOp:function(o,t){var e,t,n,e=t.sheetId,t=t.payload.sortState,n;o.c_r(e).N_r(t,!1)}},(0,t.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/sparkline/add-sparkline-for-group.js":function(o,t,e){"use strict";var u,i,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),u=e("Sparkline"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),e={type:i.OpType.addSparklineForGroup,createOp:function(o){var t,e,n,t=o.sparkline,e=t.group(),n=t.setting();return{type:i.OpType.addSparklineForGroup,module:a.OpModule.sparkline,sheetId:o.sheetId,target:{row:o.row,col:o.col},payload:{sparklineJson:t.toJSON({isServer:!0}),sparklineGroupId:e.jKe(),sparklineType:e.sparklineType,settingJson:null==n?void 0:n.toJSON()}}},applyOp:function(o,t){var e,n,t,i,t,a,s,l,n,o,e,r,n,l,e=t.sheetId,n=t.payload,t=t.target,i=t.row,t=t.col,a=n.sparklineJson,s=n.sparklineGroupId,l=n.sparklineType,n=n.settingJson,o=o.c_r(e);o&&o.RB&&(e=o.RB)&&a&&(r=void 0,a.row=i,a.col=t,n&&(r=new u.SparklineSetting(n)),(n=new u.Sparkline(i,t,null,null,l,r)).fromJSON(a),(l=e.hEr(s))?(l.XMt.push(n),n.rCt=l):((l=n.rCt).UKn(s),e.groups().push(l),(l.RB=e).hCt(l)),e._K(i,t,n),o.zw())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/add-sparkline-group.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Sparkline"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.addSparklineGroup,createOp:function(o){var t,e,t,e=o.group.toJSON({isServer:!0});return e.sparklines=[],{type:n.OpType.addSparklineGroup,module:i.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupJson:e}}},applyOp:function(o,t){var e,n,t,o,i,e,e=t.sheetId,n,t=t.payload.sparklineGroupJson,o=o.c_r(e);o&&o.RB&&(i=o.RB)&&((e=new a.SparklineGroup).fromJSON(t),i.groups().push(e),(e.RB=i).hCt(e),e.XMt.forEach(function(o){i._K(o.row,o.column,o)}))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/clear-sparkline.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.clearSparklineForGroup,createOp:function(o){var t=o.sparklineGroupId;return{type:i.OpType.clearSparklineForGroup,module:n.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t}}},applyOp:function(o,t){var e,n,t,o,i,e,e=t.sheetId,n,t=t.payload.sparklineGroupId,o=o.c_r(e);o&&o.RB&&(i=o.RB)&&(e=i.hEr(t))&&(e.XMt.forEach(function(o){i.cCt(o)}),e.XMt=[])}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/sparkline/sparkline-ex/add-sparkline-ex.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/sparkline-ex/remove-sparkline-ex.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/add-sparkline-for-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/remove-sparkline-for-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/clear-sparkline.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/update-sparkline.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/group-sparkline.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/add-sparkline-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/remove-sparkline-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/update-sparkline-group.js"),t)},"./dist/plugins/collaboration/ops/sparkline/group-sparkline.js":function(o,t,e){"use strict";var t,b,i,n,a,f,e;function v(o,t){for(var e,n,i,i,e=o.groups(),n=0;n<e.length;n++){if((i=e[n]).jKe()===t)return i;if(i=i.gEr(t))return i}return null}Object.defineProperty(t,"__esModule",{value:!0}),t=e("Common"),b=e("Sparkline"),i=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),f=t.Common.Uf.VP,e={type:i.OpType.groupSparkline,createOp:function(o){var t,e,n,t=o.group,e=t.toJSON({isServer:!0}),n=t.XMt.map(function(o){return o.jKe()});return{type:i.OpType.groupSparkline,module:a.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t.jKe(),sparklineGroupJson:e,sparklineIds:n}}},applyOp:function(o,t){var e,t,n,i,t,o,a,s,l,r,u,p,p,c,e,d,e=t.sheetId,t=t.payload,n=t.sparklineGroupId,i=t.sparklineGroupJson,t=t.sparklineIds,o=o.c_r(e);if(o&&o.RB&&(a=o.RB)){for(s=i.__ID__,l=!0,r=0,u=t;r<u.length;r++)p=u[r],(p=v(a,p))?(c=p.group()).jKe()!==s&&(l=!1,f(c.XMt,p),a._K(p.row,p.column,p),a.cCt(p)):l=!1;l||((e=a.hEr(n))||(e=new b.SparklineGroup,a.groups().push(e),(e.RB=a).hCt(e)),e.fromJSON(i),e.XMt.forEach(function(o){a._K(o.row,o.column,o)}),d=[],a.groups().forEach(function(o){0===o.XMt.length&&d.push(o)}),d.forEach(function(o){f(a.groups(),o),a.lCt(o)}),o.zw())}}},(0,n.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/remove-sparkline-for-group.js":function(o,t,e){"use strict";var n,i,t,a,e,s,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e=(a=e("Common")).Common.Uf,s=e.VP,e={type:i.OpType.removeSparklineForGroup,createOp:function(o){var t=o.sparklineGroupId,e=o.sparklineId;return{type:i.OpType.removeSparklineForGroup,module:n.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t,sparklineId:e}}},applyOp:function(o,t){var e,t,n,t,o,e,o,n,e=t.sheetId,t=t.payload,n=t.sparklineGroupId,t=t.sparklineId,o=o.c_r(e);o&&o.RB&&(e=o.RB)&&(o=e.hEr(n))&&(n=e.lEr(t))&&(e._K(n.row,n.column,null),s(o.XMt,n),e.cCt(n))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/remove-sparkline-group.js":function(o,t,e){"use strict";var n,i,t,a,e,s,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e=(a=e("Common")).Common.Uf,s=e.VP,e={type:i.OpType.removeSparklineGroup,createOp:function(o){var t=o.group;return{type:i.OpType.removeSparklineGroup,module:n.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t.jKe()}}},applyOp:function(o,t){var e,n,t,o,i,e,e=t.sheetId,n,t=t.payload.sparklineGroupId,o=o.c_r(e);o&&o.RB&&(i=o.RB)&&(e=i.hEr(t))&&(e.XMt.map(function(o){i._K(o.row,o.column,null)}),s(i.groups(),e),i.lCt(e))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/sparkline-ex/add-sparkline-ex.js":function(o,t,e){"use strict";var i,n,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),e={type:n.OpType.addSparklineEx,createOp:function(o){var t,o,t,o=o.sparklineEx,t=null==(t=null==o?void 0:o.toJSON)?void 0:t.call(o);return{type:n.OpType.addSparklineEx,module:a.OpModule.sparkline,payload:{name:null==o?void 0:o.name(),sparklineExJson:t}}},applyOp:function(o,t){var t,e,t,o,n,n,t=t.payload,e=t.name,t=t.sparklineExJson;o.WMt||(o.WMt={}),o=o.WMt,(n=(0,i.getTypeFromString)(t.typeName))&&((n=new n).fromJSON(t),o[e]=n)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/sparkline-ex/remove-sparkline-ex.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeSparklineEx,createOp:function(o){return{type:i.OpType.removeSparklineEx,module:n.OpModule.sparkline,payload:{name:o.name}}},applyOp:function(o,t){var e,t,o,e,t=t.payload.name,o=o.WMt;o&&(o[t]=void 0)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/update-sparkline-group.js":function(o,t,e){"use strict";var f,a,t,s,e;Object.defineProperty(t,"__esModule",{value:!0}),f=e("Core"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),e={type:a.OpType.updateSparklineGroup,createOp:function(o){var t=o.sparklineGroupId,e=o.isSetting,n=o.propName,i=o.value;return{type:a.OpType.updateSparklineGroup,module:s.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t,isSetting:e,propName:n,value:null!=i&&i.toJSON?i.toJSON():i}}},applyOp:function(o,t){var e,t,n,i,a,s,l,t,r,u,p,c,d,b,e=t.sheetId,t=t.payload,n=t.sparklineGroupId,i=t.isSetting,a=t.propName,s=t.value,l=o.c_r(e);if(l&&l.RB&&(t=l.RB)&&(r=t.hEr(n)))if(i)r.setting.options._ps[a]=s;else switch(a){case"dateAxisData":(u=s)&&s instanceof Object&&(p=s.row,c=s.col,d=s.rowCount,b=s.colCount,u=new f.Range(p,c,d,b)),r.nCt=u;break;case"dateAxisDataSheetName":r.jCt&&l.RB.ICt(self),(r.jCt=s)&&l.RB.ACt(self);break;case"dateAxisOrientation":r.eCt=s;break;case"sparklineType":r.sparklineType=s,l&&l.zw();break;case"displayDateAxis":r.displayDateAxis=s}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/sparkline/update-sparkline.js":function(o,t,e){"use strict";var v,a,t,s,e;Object.defineProperty(t,"__esModule",{value:!0}),v=e("Core"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),e={type:a.OpType.updateSparkline,createOp:function(o){var t=o.sparklineGroupId,e=o.sparklineId,n=o.propName,i=o.value;return{type:a.OpType.updateSparkline,module:s.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t,sparklineId:e,propName:n,value:null!=i&&i.toJSON?i.toJSON():i}}},applyOp:function(o,t){var e,t,n,i,a,s,l,r,t,u,p,c,d,b,f,e=t.sheetId,t=t.payload,n=t.sparklineGroupId,i=t.sparklineId,a=t.propName,s=t.value,l=o.c_r(e);if(l&&l.RB&&(t=(r=l.RB).hEr(n))&&(u=t.gEr(i)))switch(a){case"data":(p=s)&&p instanceof Object&&(c=p.row,d=p.col,b=p.rowCount,f=p.colCount,p=new v.Range(c,d,b,f)),u._data=p,u.onSparklineChanged(),l&&l.zw();break;case"dataSheetName":u.ZY&&r.cCt(u),(u.ZY=s)&&r.fCt(u),u.onSparklineChanged();break;case"dataOrientation":u.iCt=s,u.onSparklineChanged(),l.zw()}}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/add-table-column.js":function(o,t,e){"use strict";var n,i,a,t,e,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),e=n(n({},e.TableBaseOp),{type:a.OpType.addTableColumn,createOp:function(o){var t,e=o.column.toJSON({isServer:!0});return{type:a.OpType.addTableColumn,module:i.OpModule.table,sheetId:o.sheetId,payload:{tableId:o.tableId,index:o.index,columnJson:e}}},applyOp:function(o,t){var e,n,e,o,t,i,n,e=t.payload,n=e.index,e=e.columnJson,o=this.getTable(o,t);o&&(t=o.kEr(),i=o.BSt.length,n=Math.min(null!=n?n:i,i),o.NEr(n,t),t.fromJSON(e),o.y5t(n,0,t.name()))}}),(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/add-table.js":function(o,t,e){"use strict";var l,r,t,e;Object.defineProperty(t,"__esModule",{value:!0}),l=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:r.OpType.addTable,createOp:function(o){var t,e,n,i,a,e,s,t=o.table,e=t.range(),n=e.row,i=e.col,a=e.rowCount,e=e.colCount,s=t.toJSON(null,{isServer:!0});return{type:r.OpType.addTable,module:l.OpModule.table,sheetId:o.sheetId,target:{row:n,col:i,rowCount:a,colCount:e},payload:{tableId:t.jKe(),tableJson:s}}},applyOp:function(o,t){var e,n,i,t,a,o,e,o,t,s,n,e=t.sheetId,n=t.target,i,t=t.payload.tableJson,a,o=o.c_r(e).tables,e=o.GM();o.REr(e),e.fromJSON(t),o=n.row,t=n.col,s=n.rowCount,n=n.colCount,e.Ky=o,e.iw=t,e.Sx=s,e.Tx=n}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/delete-table-column.js":function(o,t,e){"use strict";var n,i,a,t,s,l,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),l=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),e=n(n({},s.TableBaseOp),{type:a.OpType.deleteTableColumn,createOp:function(o){var t,e,n,t=o.table,e=o.removedTcs.map(function(o){return o.jKe()}),n=(0,l.getTableFormulaEffectInfo)(t);return{type:a.OpType.deleteTableColumn,module:i.OpModule.table,sheetId:o.sheetId,payload:{tableId:t.jKe(),tcIds:e,formulaEffectInfo:n}}},applyOp:function(o,t){var e,n,i,e,n=t.payload.tcIds,i=this.getTable(o,t);i&&(n.forEach(function(o){var o=i.DEr(o);i.iGe(o)}),i.Mf)&&(i.A0r(),i.ccr(i.Mf))}}),(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/table/add-table.js"),t),i(e("./dist/plugins/collaboration/ops/table/remove-table.js"),t),i(e("./dist/plugins/collaboration/ops/table/show-header.js"),t),i(e("./dist/plugins/collaboration/ops/table/show-footer.js"),t),i(e("./dist/plugins/collaboration/ops/table/set-layout-style.js"),t),i(e("./dist/plugins/collaboration/ops/table/update-table-range.js"),t),i(e("./dist/plugins/collaboration/ops/table/set-table-property.js"),t),i(e("./dist/plugins/collaboration/ops/table/add-table-column.js"),t),i(e("./dist/plugins/collaboration/ops/table/set-table-column-property.js"),t),i(e("./dist/plugins/collaboration/ops/table/delete-table-column.js"),t)},"./dist/plugins/collaboration/ops/table/remove-table.js":function(o,t,e){"use strict";var n,i,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),e={type:i.OpType.removeTable,createOp:function(o){var t,e,o,e,t=o.tables,e=t.map(function(o){return o.jKe()}),o={type:i.OpType.removeTable,module:n.OpModule.table,sheetId:o.sheetId,payload:{tableIds:e}},e=t.map(function(o){return(0,a.getTableFormulaEffectInfo)(o)});return e.some(function(o){return!!o})&&(o.payload.formulaEffectInfos=e),o},applyOp:function(o,t){var e,n,t,i,a,e=t.sheetId,n,t=t.payload.tableIds,i,a=o.c_r(e).tables;t.forEach(function(o){var o,t,e,o=a.lEr(o);!o||(e=(t=a.U3).indexOf(o))<0||(t.splice(e,1),o.g5t()&&(o.OSt=[]),o.OEr())})}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/set-layout-style.js":function(o,t,e){"use strict";var n,i,t,a,s,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),e=n(n({},t.TableBaseOp),{type:i.OpType.setLayoutStyle,createOp:function(o){var t,t,t;return{type:i.OpType.setLayoutStyle,module:s.OpModule.table,sheetId:o.sheetId,payload:{tableId:o.tableId,header:null==(t=o.headerStyle)?void 0:t.toJSON(),data:null==(t=o.dataStyle)?void 0:t.toJSON(),footer:null==(t=o.footerStyle)?void 0:t.toJSON()}}},applyOp:function(o,t){var e,n,i,e,o,e=t.payload,n=e.header,i=e.data,e=e.footer,o=this.getTable(o,t);o&&o.MEr(n,i,e)}}),(0,a.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/set-table-column-property.js":function(o,t,e){"use strict";var n,l,r,u,t,i,p,c,d,b,f,e;function v(o,t,e,n,i){return i=void 0===i||i,o.Lp.unparse(o.Uw(),t,e,n,!1,i)}function g(o,t,e,n,i,a,s){var l,i;return t?((l=o.Uw())._wt=i,l.lsr=s,i=o.Lp.parse(l,t,e,n,!1,a,!1,o.options.keepUnknownFormulas),delete l._wt,delete l.lsr,i):null}n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),l=e("CollaborationTypes"),r=e("CalcEngine"),u=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),p=e("./dist/plugins/collaboration/util/formula-info/util.js"),c="footerFormula",d="dataAreaFormula",b="footerFormulaInfo",f="dataAreaFormulaInfo",e=n(n({},i.TableBaseOp),{type:u.OpType.setTableColumnProperty,createOp:function(o,t){var e,n,i,a,o,t,s,e=o.value,n=o.columnId,i=o.propName,a=o.table,o=o.sheetId;return e instanceof r.Expression&&(t=t.c_r(o),s=a.DEr(n),i===c?(i=b,e=v(t,e,a.footerIndex(),s+a.iw)):i===d&&(i=f,e=v(t,e,a.dataRange().row,s+a.iw)),e=(0,p.getFormulaInfo)(e,t)),{type:u.OpType.setTableColumnProperty,module:l.OpModule.table,sheetId:o,payload:{tableId:a.jKe(),columnId:n,propName:i,value:e}}},applyOp:function(o,t){var e,n,i,a,e,n,t,s,l,i,r,u,o,e=t.payload,n=t.sheetId,i=e.columnId,a=e.propName,e=e.value,n=o.c_r(n),t=this.getTable(o,t);t&&n&&(s=t.jEr(i))&&(l=e,i=t.DEr(i),(r=a)===b?(r=c,e&&(u=(0,p.unparseFormulaInfo)(e,o))&&"string"==typeof u&&(l=g(n,u,t.footerIndex(),i+t.iw,void 0,!0))):a===f&&(r=d,e)&&(u=(0,p.unparseFormulaInfo)(e,o))&&"string"==typeof u&&(l=g(n,u,t.dataRange().row,i+t.iw,void 0,!0)),o=s[r](),s[r](l,!1),r===d&&l&&t.NTr()&&(s.x5t(e),t._Ar(i,s,e,s.dataAreaFormula())),"name"===a)&&(t.y5t(i,1,s.name()),t._Er(o,e),t.A0r())}}),(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/set-table-property.js":function(o,t,e){"use strict";var n,i,a,t,e,s,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=void 0,e=n(n({},e.TableBaseOp),{type:a.OpType.setTableProperty,createOp:function(o){var t=o.propName,e=o.value;return"style"===t&&e&&e.toJSON&&(e=e.toJSON()),{type:a.OpType.setTableProperty,module:i.OpModule.table,sheetId:o.sheetId,payload:{tableId:o.tableId,propName:t,value:e}}},applyOp:function(o,t){var e,n,e,o,t,e=t.payload,n=e.propName,e=e.value,o=this.getTable(o,t);o&&("useFooterDropDownList"===n?(o.ESt=e)&&!o.g5t()&&o.h5t():"style"===n?((t=e)&&"string"!=typeof e&&(t=o.AEr(e)),o.TEr(e&&e.name&&e.name.toLowerCase(),!1),o.RN(t,s,{shouldModelCallback:!1})):o[n](e,s,{shouldModelCallback:!1}))}}),(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/show-footer.js":function(o,t,e){"use strict";var n,i,a,t,e,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),e=n(n({},e.TableBaseOp),{type:a.OpType.showFooter,createOp:function(o){return{type:a.OpType.showFooter,module:i.OpModule.table,sheetId:o.sheetId,payload:{tableId:o.tableId,value:o.value}}},applyOp:function(o,t){var e,o,t,e=t.payload.value,o=this.getTable(o,t);o&&(o.xEr(e),t=o.Sx,o.Sx=e?t+1:t-1)}}),(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/show-header.js":function(o,t,e){"use strict";var n,i,a,t,e,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),e=n(n({},e.TableBaseOp),{type:a.OpType.showHeader,createOp:function(o){return{type:a.OpType.showHeader,module:i.OpModule.table,sheetId:o.sheetId,payload:{tableId:o.tableId,value:o.value}}},applyOp:function(o,t){var e,o,t,e=t.payload.value,o=this.getTable(o,t);o&&(o.CEr(e),t=o.Sx,o.Sx=e?t+1:t-1)}}),(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/table/table-base-op.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableBaseOp=void 0,t.TableBaseOp={getSheet:function(o,t){return o.c_r(t)},getTable:function(o,t){var e,n,t,i,a,e=t.sheetId,n,t=t.payload.tableId,i,a;return this.getSheet(o,e).tables.lEr(t)}}},"./dist/plugins/collaboration/ops/table/update-table-range.js":function(o,t,e){"use strict";var n,i,a,t,e,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),e=n(n({},e.TableBaseOp),{type:a.OpType.updateTableRange,createOp:function(o){var t,e,t=o.table,e=t.jKe();return{type:a.OpType.updateTableRange,module:i.OpModule.table,sheetId:o.sheetId,target:t.range(),payload:{tableId:e,rangeInfo:o.rangeInfo}}},applyOp:function(o,t){var e,o,t,n,e,i,a,e=t.payload.rangeInfo,o=this.getTable(o,t);o&&(t=o.startColumn(),n=o.endColumn(),o.yEr(e),e=o.startColumn(),i=o.endColumn(),(a=o.jS).dl(),e!==t||i<n?o.ccr(o.Mf,!0):a.ssr())}}),(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/custom-name/clear-custom-name.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.clearCustomName,createOp:function(){return{type:i.OpType.clearCustomName,module:n.OpModule.workbook,payload:{}}},applyOp:function(o){o.aEr({ignoreModelChange:!0})}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/custom-name/set-custom-name.js":function(o,t,e){"use strict";var r,u,t,n,p,c,e;Object.defineProperty(t,"__esModule",{value:!0}),r=e("CollaborationTypes"),u=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),n=e("./dist/plugins/collaboration/util/common.js"),p=e("./dist/plugins/collaboration/util/formula-info/util.js"),e={type:u.OpType.setCustomName,createOp:function(o,t){var e,n,i,a,s,l,n,s,l,n,n,l,e=o.value?{}:null;if(o.value&&(i=(n=o.value).baseRow,a=n.baseCol,s=n.comment,l=n.isReadOnly,n=n.expr,i!==c&&(e.baseRow=i),a!==c&&(e.baseCol=a),s!==c&&(e.comment=s),l!==c&&(e.isReadOnly=l),s=o.value.formula,s=n&&(l=t.Lp,n=(n=t.getActiveSheet())?n.Uw():null,l)?l.unparse(n,o.value.expr,i,a,!1,!0,2):s)&&(l=(0,p.getFormulaInfo)(s,t,{row:i,col:a}))&&(e.formulaInfo=l),!e||e.formulaInfo)return{type:u.OpType.setCustomName,module:r.OpModule.workbook,payload:{name:o.name,value:e}}},mergeOp:function(o,t){if(o.payload.name===t.payload.name)return(0,n.clone)(t)},applyOp:function(o,t){var t,e,n,i,a,s,l,n,i,t=t.payload,e=t.name,n=t.value;n?(i=n.formulaInfo,a=n.comment,s=n.isReadOnly,l=n.baseRow,n=n.baseCol,i=(0,p.unparseFormulaInfo)(i,o),o.$_r(o.hyt,t.name,i,l,n,{ignoreError:!1,comment:a,isReadOnly:s,ignoreModelChange:!0})):o.removeCustomName(e)}},(c=void 0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/custom-theme/add-custom-theme.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.addCustomTheme,createOp:function(o){return{type:i.OpType.addCustomTheme,module:n.OpModule.workbook,payload:{customThemeType:o.customThemeType,themeJson:o.theme.toJSON()}}},applyOp:function(o,t){var t,e,t,o,e,t=t.payload,e=t.customThemeType,t=t.themeJson,o=o.l_r(e);o&&((e=o.kur()).fromJSON(t),o.xur.push(e))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/custom-theme/remove-custom-theme.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeCustomTheme,createOp:function(o){return{type:i.OpType.removeCustomTheme,module:n.OpModule.workbook,payload:{customThemeType:o.customThemeType,name:o.name}}},applyOp:function(o,t){var t,e,t,o,e,t=t.payload,e=t.customThemeType,t=t.name,o=o.l_r(e);o&&void 0!==(e=o.Rur(t))&&o.xur.splice(e,1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/custom-theme/update-custom-theme.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.updateCustomTheme,createOp:function(o){return{type:i.OpType.updateCustomTheme,module:n.OpModule.workbook,payload:{customThemeType:o.customThemeType,name:o.name,themeJson:o.theme.toJSON()}}},applyOp:function(o,t){var t,e,n,t,o,e,i,t=t.payload,e=t.customThemeType,n=t.name,t=t.themeJson,o=o.l_r(e);o&&void 0!==(e=o.Rur(n))&&((i=o.kur()).fromJSON(t),o.xur[e]=i,o.S0r(n,i))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/add-custom-doc-prop.js":function(o,t,e){"use strict";var i,a,t,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:a.OpType.addCustomDocProp,createOp:function(o){var t=o.property,e=o.isLinkTarget,n=o.mapKey,o=o.mapValue;return{type:a.OpType.addCustomDocProp,module:i.OpModule.workbook,payload:{property:t,isLinkTarget:e,mapKey:n,mapValue:o}}},applyOp:function(o,t){var t,e,n,i,t,a,t=t.payload,e=t.property,n=t.isLinkTarget,i=t.mapKey,t=t.mapValue;n&&((a=o.docProps.customDocPropsManager).qar[i]=t),o.Dp||(o.Dp={docPropsCustom:[]}),o.Dp.docPropsCustom||(o.Dp.docPropsCustom=[]),o.Dp.docPropsCustom.push(e)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/clear-custom-doc-prop.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.clearCustomDocProp,createOp:function(){return{type:i.OpType.clearCustomDocProp,module:n.OpModule.workbook,payload:{}}},applyOp:function(o){var o;null!=(o=o.Dp)&&delete o.docPropsCustom}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/remove-custom-doc-prop.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeCustomDocProp,createOp:function(o){var o=o.propName;return{type:i.OpType.removeCustomDocProp,module:n.OpModule.workbook,payload:{propName:o}}},applyOp:function(o,t){var e,t,e,t=t.payload.propName;o.docProps.customDocPropsManager.TOt(t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/set-custom-doc-props.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.setCustomDocProps,createOp:function(o){var o=o.props;return{type:i.OpType.setCustomDocProps,module:n.OpModule.workbook,payload:{props:o}}},applyOp:function(o,t){var e,t,e,t=t.payload.props;o.Dp.docPropsCustom=t,o.docProps.customDocPropsManager.$ar()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/set-doc-prop-for-app.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.setDocPropForApp,createOp:function(o){var t=o.propName,o=o.value;return{type:i.OpType.setDocPropForApp,module:n.OpModule.workbook,payload:{propName:t,value:o}}},applyOp:function(o,t){var t,e,t,t=t.payload,e=t.propName,t=t.value;o.docProps.appDocProps[e]=t}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/set-doc-prop-for-core.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.setDocPropForCore,createOp:function(o){var t=o.propName,o=o.value;return{type:i.OpType.setDocPropForCore,module:n.OpModule.workbook,payload:{propName:t,value:o}}},applyOp:function(o,t){var t,e,t,t=t.payload,e=t.propName,t=t.value;o.docProps.coreDocProps[e]=t}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/set-doc-prop.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.setDocProp,createOp:function(o){var t=o.propName,o=o.value;return{type:i.OpType.setDocProp,module:n.OpModule.workbook,payload:{propName:t,value:o}}},applyOp:function(o,t){var o,t,e,t,t=t.payload,e=t.propName,t=t.value;null!=(o=o.docProps[e])&&o.e_r(t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/doc-prop/update-custom-doc-prop.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.updateCustomDocProp,createOp:function(o){var t=o.customName,e=o.propType,o=o.propValue;return{type:i.OpType.updateCustomDocProp,module:n.OpModule.workbook,payload:{customName:t,propType:e,propValue:o}}},applyOp:function(o,t){var t,e,n,i,t=t.payload,e=t.customName,n=t.propType,i=t.propValue;o.Dp.docPropsCustom.forEach(function(o){var o;o.linkTarget===e&&(o.propertyItemChildElement=((o={})[n]=i,o))})}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/workbook/sheet/add-sheet.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet/remove-sheet.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet/clear-sheets.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-workbook-options.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-active-sheet-id.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-start-sheet-index.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/named-style/add-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/named-style/remove-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-name/set-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-name/clear-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-theme/add-custom-theme.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-theme/remove-custom-theme.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-theme/update-custom-theme.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/add-sheet-tab-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/remove-sheet-tab-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/clear-sheet-tab-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/add-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/remove-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/clear-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/update-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/set-custom-doc-props.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/set-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/set-doc-prop-for-app.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/set-doc-prop-for-core.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/reorder-sheettab-position.js"),t)},"./dist/plugins/collaboration/ops/workbook/named-style/add-named-style.js":function(o,t,e){"use strict";var i,n,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),e={type:n.OpType.addNamedStyle,createOp:function(o){var o=o.style.toJSON();return{type:n.OpType.addNamedStyle,module:a.OpModule.workbook,payload:{styleJson:o}}},applyOp:function(o,t){var e,t,n,t,e,t=t.payload.styleJson,n=new i.Style;n.fromJSON(t,void 0,void 0),t=t.name.toUpperCase(),o.Hp[t]=n,o.r3()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/named-style/remove-named-style.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.removeNamedStyle,createOp:function(o){return{type:i.OpType.removeNamedStyle,module:n.OpModule.workbook,payload:{name:o.name}}},applyOp:function(o,t){var e,t,n,n,e,t=t.payload.name,n=o.Hp;n[t]&&(delete n[t],o.r3(),n=o.getActiveSheet())&&n.zw()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/reorder-sheettab-position.js":function(o,t,e){"use strict";var n,t,e,i;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),t=e("./dist/plugins/collaboration/enum.js"),e=e("./dist/plugins/collaboration/op-manager.js"),i={type:t.OpType.reorderSheetTabPosition,createOp:function(o){return{type:i.type,module:n.OpModule.workbook,payload:{sheetId:o.sheetId,targetIndex:o.tarPosition,sourceIndex:o.sourceIndex}}},applyOp:function(o,t){var t,e,t,n,i,t,t=t.payload,e=t.targetIndex,t=t.sheetId,n=o.qv(),i=o.c_r(t),t=n.findIndex(function(o){return o===i});o.p_r(t,e)}},(0,e.registerOpProcess)(i)},"./dist/plugins/collaboration/ops/workbook/set-active-sheet-id.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.setActiveSheetId,createOp:function(o){return{type:i.OpType.setActiveSheetId,module:n.OpModule.workbook,payload:{id:o.id}}},applyOp:function(o,t){var t,e,t,t,e,t=t.payload.id,t=o.m_r(t);o._2=t,null!=(t=o.w2)&&t.repaint()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/set-start-sheet-index.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.setStartSheetIndex,createOp:function(o){return{type:i.OpType.setStartSheetIndex,module:n.OpModule.workbook,payload:{value:o.value}}},applyOp:function(o,t){var e,t,n,e,t=t.payload.value,n=null==o?void 0:o.w2;n&&(n.om=t,o.Xg())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/set-workbook-options.js":function(o,t,e){"use strict";var n,i,t,r,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/util/common.js"),e={type:i.OpType.setWorkbookOptions,createOp:function(o){return{type:i.OpType.setWorkbookOptions,module:n.OpModule.workbook,payload:{propertyName:[o.propertyName],value:[o.value]}}},mergeOp:function(o,t){for(var e,n,i,a,s,l,e=(0,r.clone)(o),n=o.payload.propertyName,i=t.payload.propertyName,a=t.payload.value,s=0;s<i.length;s++)l=i[s],-1===n.indexOf(l)?(e.payload.propertyName.push(l),e.payload.value.push(a[s])):e.payload.value[s]=a[s];return e},applyOp:function(o,t){for(var t,e,n,i,a,s,l,t=t.payload,e=t.value,n=t.propertyName,i=0;i<n.length;i++)a=n[i],s=e[i],a&&(l=o.options[a],o.options._ps[a]=s,o.Ob(a,s,l,!0))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/add-sheet-tab-style.js":function(o,t,e){"use strict";var i,t,a,s,e;Object.defineProperty(t,"__esModule",{value:!0}),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js"),s=e("CollaborationTypes"),e={type:i.OpType.addSheetTabStyle,createOp:function(o,t){var e=o.state,n=o.style,o=o.sheetNames;return{type:i.OpType.addSheetTabStyle,module:s.OpModule.workbook,payload:{state:e,style:n,sheetIds:(0,a.goo)(o,t)}}},applyOp:function(o,t){var t,e,n,t,t=t.payload,e=t.state,n=t.style,t=t.sheetIds;o.sheetTabStyles._Qt(e,n,(0,a.foo)(t,o),!1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/clear-sheet-tab-style.js":function(o,t,e){"use strict";var n,t,i,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js"),a=e("CollaborationTypes"),e={type:n.OpType.clearSheetTabStyle,createOp:function(o,t){var o=o.sheetNames;return{type:n.OpType.clearSheetTabStyle,module:a.OpModule.workbook,payload:{sheetIds:(0,i.goo)(o,t)}}},applyOp:function(o,t){var e,t,e,t=t.payload.sheetIds;o.sheetTabStyles.s_r((0,i.foo)(t,o),!1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/remove-sheet-tab-style.js":function(o,t,e){"use strict";var n,t,i,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js"),a=e("CollaborationTypes"),e={type:n.OpType.removeSheetTabStyle,createOp:function(o,t){var e=o.state,o=o.sheetNames;return{type:n.OpType.removeSheetTabStyle,module:a.OpModule.workbook,payload:{state:e,sheetIds:(0,i.goo)(o,t)}}},applyOp:function(o,t){var t,e,t,t=t.payload,e=t.state,t=t.sheetIds;o.sheetTabStyles.TOt(e,(0,i.foo)(t,o),!1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js":function(o,t){"use strict";function e(t,e){var n=[];return t.forEach(function(o){-1<t.indexOf(o)&&n.push(e.getSheetFromName(o).jKe())}),n}function n(t,e){var n=[];return t.forEach(function(o){-1<t.indexOf(o)&&n.push(e.c_r(o).name())}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.foo=t.goo=void 0,t.goo=e,t.foo=n},"./dist/plugins/collaboration/ops/workbook/sheet/add-sheet.js":function(o,t,e){"use strict";var l,i,t,a,s,r,u,e;Object.defineProperty(t,"__esModule",{value:!0}),l=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/ssjson-convert/to/worksheet.js"),r=e("./dist/plugins/collaboration/ssjson-convert/from/worksheet.js"),u=e("./dist/plugins/collaboration/util/formula-info/util.js"),e={type:i.OpType.addSheet,createOp:function(o,t){var e,n,e,n=o.sheet.toJSON({isServer:!0});return(n.isSelected=!1,s.convertToSheetCollaborationJSON)(n,t),{type:i.OpType.addSheet,module:a.OpModule.workbook,payload:{index:o.index,json:n}}},applyOp:function(o,t){var e,t,n,t,e,i,a,s,a,s,t=t.payload,n=t.index,t=t.json,e=null==(e=o.getActiveSheet())?void 0:e.jKe(),i=new l.Worksheet,a=o.sheets,s=a.length;o.v3(i),o.gse(a,i,s-n),i.pM(o),o.pse(o.dse,i,s-n),o.w2&&(o.w2.om<0&&(o.w2.om=o._2),o.w2.repaint()),a=(0,r.convertFromSheetCollaborationJSON)(t,(0,u.buildIdMapByWorkbook)(o)),i.fromJSON(a),e&&-1<(s=o.m_r(e))&&(o._2=s)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/sheet/clear-sheets.js":function(o,t,e){"use strict";var n,i,t,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),e={type:i.OpType.clearSheets,createOp:function(){return{type:i.OpType.clearSheets,module:n.OpModule.workbook,payload:{}}},applyOp:function(o){for(var t,e,n,i,a,s,t=o.sheets,e=o.Lp,n=o.w2,i=0,a=t;i<a.length;i++)(s=a[i]).bC(),s.L0(!0);t.splice(0,t.length),o.dse=o.yse(o.mp),e&&e.clearSource(),n&&(n.om=-1,n.repaint())}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/workbook/sheet/remove-sheet.js":function(o,t,e){"use strict";var n,i,t,a,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),e={type:i.OpType.removeSheet,createOp:function(o){var t,e,t=o.sheet.jKe(),e=(0,a.getSheetFormulaEffectInfo)(o.sheet);return{type:i.OpType.removeSheet,module:n.OpModule.workbook,payload:{sheetId:t,index:o.index,formulaEffectInfo:e}}},applyOp:function(o,t){var e,t,t,n,t,e,t=t.payload.sheetId,t=o.m_r(t);-1!==t&&(n=o.getActiveSheet(),o.m3(t,2,!0),t=o.getActiveSheet())&&t!==n&&t.b2(!0,!1)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/add-columns.js":function(o,t,e){"use strict";var t,a,s,n,l,i,r,u,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("CalcEngine"),a=e("Core"),s=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/util/common.js"),i=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/util/formula-info/util.js"),u=!!t,e={type:s.OpType.addColumns,createOp:function(o,t){var o={type:s.OpType.addColumns,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{col:o.col,colCount:o.colCount,sheetArea:o.sheetArea}};return(0,r.addFormulaEffectInfoToRowColOp)(o,t),o},applyOp:function(o,t){var e,t,n,i,t,o,e,e=t.sheetId,t=t.target,n=t.col,i=t.colCount,t=t.sheetArea,o=o.c_r(e),e=o.Ut;o.TMt({type:"",changeType:"addingColumns",col:n,colCount:i,sheetArea:t}),2===t?(e.W_(2).oE(n,i),e.Ehe(2).oE(n,i),e.Q_(!1,2).kE(n,i)):(e.W_(3).oE(n,i),e.W_(1).oE(n,i),e.Ehe(3).oE(n,i),e.Ehe(1).oE(n,i),e.Q_(!1,3).kE(n,i),u&&o.Uw(3).t8.oE(n,i)),o.TMt({type:"",changeType:"addColumns",col:n,colCount:i,sheetArea:t}),e.L8({type:a.AxisInfoChangeType.addColumns,index:n,count:i,sheetArea:t}),o.Zw=!0,a.Worksheet.et(o,"onLayoutChangedFromOp",{changeType:s.OpType.addColumns,col:n,colCount:i,sheetArea:t}),t===a.SheetArea.viewport&&o.tables&&o.tables.cL(!1,n),o.sL(!0,t),(0,l.updateSelections)(s.OpType.addColumns,n,i,o)}},(0,n.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/add-rows.js":function(o,t,e){"use strict";var t,a,s,n,l,i,r,u,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("CalcEngine"),a=e("Core"),s=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/util/common.js"),i=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/util/formula-info/util.js"),u=!!t,e={type:s.OpType.addRows,createOp:function(o,t){var o={type:s.OpType.addRows,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{row:o.row,rowCount:o.rowCount,sheetArea:o.sheetArea}};return(0,r.addFormulaEffectInfoToRowColOp)(o,t),o},applyOp:function(o,t){var e,t,n,i,t,o,e,e=t.sheetId,t=t.target,n=t.row,i=t.rowCount,t=t.sheetArea,o=o.c_r(e),e=o.Ut;o.TMt({type:"",changeType:"addingRows",row:n,rowCount:i,sheetArea:t}),1===t?(e.W_(1).rE(n,i),e.Ehe(1).rE(n,i),e.Q_(!0,1).kE(n,i)):(e.W_(3).rE(n,i),e.W_(2).rE(n,i),e.Q_(!0,3).kE(n,i),e.Ehe(3).rE(n,i),e.Ehe(2).rE(n,i),u&&o.Uw(3).t8.rE(n,i)),o.TMt({type:"",changeType:"addRows",row:n,rowCount:i,sheetArea:t}),e.L8({type:a.AxisInfoChangeType.addRows,index:n,count:i,sheetArea:t}),o.Ww=!0,a.Worksheet.et(o,"onLayoutChangedFromOp",{changeType:s.OpType.addRows,row:n,rowCount:i,sheetArea:t}),t===a.SheetArea.viewport&&o.tables&&o.tables.cL(!0,n),o.sL(!0,t),(0,l.updateSelections)(s.OpType.addRows,n,i,o)}},(0,n.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/add-span.js":function(o,t,e){"use strict";var u,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),u=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.addSpan,createOp:function(o){return{type:n.OpType.addSpan,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{row:o.value.row,col:o.value.col,rowCount:o.value.rowCount,colCount:o.value.colCount,sheetArea:o.sheetArea}}},applyOp:function(o,t){var e,t,n,i,a,s,t,l,r,e=t.sheetId,t=t.target,n=t.row,i=t.rowCount,a=t.col,s=t.colCount,t=t.sheetArea,l,r;o.c_r(e).Ut.K_(t)._Qt(new u.Range(n,a,i,s))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/axis-options.js":function(o,t,e){"use strict";var n,t,i,y,a,r,u,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),y=e("Core"),a=e("./dist/plugins/collaboration/util/common.js"),r=e("CollaborationTypes"),u={type:t.OpType.setAxisOptions,createOp:function(o){var t,e,n,i,i,a,s,l,o,t=o.sheetId,e=o.props,n=o.index,i=o.count,i=void 0===i?1:i,a=o.value,s=o.isRow,l,o={sheetArea:o.sheetArea};return s?(o.row=n,o.rowCount=i):(o.col=n,o.colCount=i),{type:u.type,module:r.OpModule.worksheet,sheetId:t,target:o,payload:{props:e,value:a}}},mergeOp:function(o,t){if(o.payload.value===t.payload.value&&o.payload.props===t.payload.props){var t=(0,a.mergeTarget)(o.target,t.target);if(t)return n(n({},o),{target:t})}},applyOp:function(o,t){for(var e,n,i,a,s,l,n,t,r,u,p,c,d,b,f,v,g,j,m,e=t.sheetId,n=t.target,i=n.sheetArea,a=n.row,s=n.col,l=n.rowCount,n=n.colCount,t=t.payload,r=t.props,u=t.value,p=void 0!==a,c=p?a:s,d=p?l:n,b,f=o.c_r(e).Ut,v=f.Q_(p,i),g=0;g<d;g++)j=c+g,"visible"===r?(v.setVisible(j,u),m=p?y.AxisInfoChangeType.setRowVisible:y.AxisInfoChangeType.setColumnVisible,f.L8({type:m,index:j,sheetArea:i})):"resizable"===r?v.setResizable(j,u):"pageBreak"===r&&v.setPageBreak(j,u)}},(0,i.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/worksheet/clear-sheet-scope-custom-name.js":function(o,t,e){"use strict";var n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.clearSheetScopeCustomName,createOp:function(o){return{type:n.OpType.clearSheetScopeCustomName,module:i.OpModule.worksheet,sheetId:o.sheetId,payload:{}}},applyOp:function(o,t){var t,e,t=t.sheetId,e;o.c_r(t).aEr({ignoreModelChange:!0})}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/clear.js":function(o,t,e){"use strict";var i,r,t,n,a,u;function s(o,t){if(o.length===t.length){for(var e=0;e<o.length;e++)if(o[e]!==t[e])return;return 1}}i=this&&this.__assign||function(){return(i=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),r=e("CollaborationTypes"),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),u={type:t.OpType.clearRange,createOp:function(o){var t=o.sheetId,e=o.row,n=o.column,i=o.rowCount,a=o.columnCount,s=o.clearType,l=o.ignoredRowList,o=o.sheetArea;return{type:u.type,module:r.OpModule.worksheet,sheetId:t,target:{row:e,col:n,rowCount:i,colCount:a,sheetArea:o},payload:{clearType:s,ignoredRowList:l}}},applyOp:function(o,t){var e,n,i,a,s,l,n,t,r,t,u,p,e=t.sheetId,n=t.target,i=n.row,a=n.col,s=n.rowCount,l=n.colCount,n=n.sheetArea,t=t.payload,r=t.clearType,t=t.ignoredRowList,u,p;o.c_r(e).Ut.W_(n).clear(i,a,s,l,r,t)},mergeOp:function(o,t){var e,n,e,e=o.payload,n=t.payload;if(e.clearType===n.clearType&&s(e.ignoredRowList,n.ignoredRowList)&&(e=(0,a.mergeTarget)(o.target,t.target)))return i(i({},o),{target:e})}},(0,n.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/worksheet/delete-columns.js":function(o,t,e){"use strict";var t,a,s,n,l,i,r,u,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("CalcEngine"),a=e("Core"),s=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/util/common.js"),i=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/util/formula-info/util.js"),u=!!t,e={type:s.OpType.deleteColumns,createOp:function(o,t){var o={type:s.OpType.deleteColumns,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{col:o.col,colCount:o.colCount,sheetArea:o.sheetArea}};return(0,r.addFormulaEffectInfoToRowColOp)(o,t),o},applyOp:function(o,t){var e,t,n,i,t,o,e,e=t.sheetId,t=t.target,n=t.col,i=t.colCount,t=t.sheetArea,o=o.c_r(e),e=o.Ut;o.TMt({type:"",changeType:"deletingColumns",col:n,colCount:i,sheetArea:t}),(2===t?(e.W_(2).wE(n,i),e.Ehe(2).wE(n,i),e.Q_(!1,2)):(u&&o.Uw(3).t8.uE(n,i,!0),e.W_(3).wE(n,i),e.W_(1).wE(n,i),e.Ehe(3).wE(n,i),e.Ehe(1).wE(n,i),e.Q_(!1,3))).DE(n,i),o.TMt({type:"",changeType:"deleteColumns",col:n,colCount:i,sheetArea:t}),e.L8({type:a.AxisInfoChangeType.deleteColumns,index:n,count:i,sheetArea:t}),o.Zw=!0,a.Worksheet.et(o,"onLayoutChangedFromOp",{changeType:s.OpType.deleteColumns,col:n,colCount:i,sheetArea:t}),t===a.SheetArea.viewport&&o.tables&&o.tables.cL(!1,n),o.sL(!1,t),(0,l.updateSelections)(s.OpType.deleteColumns,n,i,o)}},(0,n.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/delete-rows.js":function(o,t,e){"use strict";var t,a,s,n,l,i,r,u,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("CalcEngine"),a=e("Core"),s=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/util/common.js"),i=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/util/formula-info/util.js"),u=!!t,e={type:s.OpType.deleteRows,createOp:function(o,t){var o={type:s.OpType.deleteRows,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{row:o.row,rowCount:o.rowCount,sheetArea:o.sheetArea}};return(0,r.addFormulaEffectInfoToRowColOp)(o,t),o},applyOp:function(o,t){var e,t,n,i,t,o,e,e=t.sheetId,t=t.target,n=t.row,i=t.rowCount,t=t.sheetArea,o=o.c_r(e),e=o.Ut;o.TMt({type:"",changeType:"deletingRows",row:n,rowCount:i,sheetArea:t}),1===t?(e.W_(1).yE(n,i),e.Ehe(1).yE(n,i),e.Q_(!0,1).DE(n,i)):(u&&o.Uw(3).t8.aE(n,i,!0),e.W_(3).yE(n,i),e.W_(2).yE(n,i),e.Q_(!0,3).DE(n,i),e.Ehe(2).yE(n,i),e.Ehe(3).yE(n,i)),o.TMt({type:"",changeType:"deleteRows",row:n,rowCount:i,sheetArea:t}),e.L8({type:a.AxisInfoChangeType.deleteRows,index:n,count:i,sheetArea:t}),o.Ww=!0,a.Worksheet.et(o,"onLayoutChangedFromOp",{changeType:s.OpType.deleteRows,row:n,rowCount:i,sheetArea:t}),t===a.SheetArea.viewport&&o.tables&&o.tables.cL(!1,n),o.sL(!1,t),(0,l.updateSelections)(s.OpType.deleteColumns,n,i,o)}},(0,n.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/entry.js":function(o,t,e){"use strict";var n,i,n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/worksheet/set-name.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/add-rows.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/add-columns.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/delete-rows.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/delete-columns.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-axis-size.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-tab-selected.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/add-span.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/remove-span.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/update-span.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-sheet-scope-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/clear-sheet-scope-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-column-count.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-row-count.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/frozen.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-free-area.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/zoom.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/axis-options.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-header-fit-mode.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-worksheet-options.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/clear.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/named-style/add-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/named-style/remove-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-file-info.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-visible.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-range/set-range.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/update-top-left-position.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-current-theme.js"),t)},"./dist/plugins/collaboration/ops/worksheet/frozen.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/op-manager.js"),n=e("./dist/plugins/collaboration/enum.js"),i=e("CollaborationTypes"),a={type:n.OpType.setFrozen,createOp:function(o){return{type:a.type,module:i.OpModule.worksheet,sheetId:o.sheetId,payload:{beginIndex:o.beginIndex,count:o.count,isRow:o.isRow,isTrailing:o.isTrailing,isStickToEdge:o.isStickToEdge}}},applyOp:function(o,t){var e,t,n,i,a,s,t,o,e=t.sheetId,t=t.payload,n=t.count,i=t.beginIndex,a=t.isRow,s=t.isTrailing,t=t.isStickToEdge,o=o.c_r(e);a?(s?(o.fL=n,o.Ny=t):(o.ap=n,o._ve=i),o.Ww=!0):(s?(o.lL=n,o.Vy=t):(o.fp=n,o.Dve=i),o.Zw=!0),o.zw()}},(0,t.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/named-style/add-named-style.js":function(o,t,e){"use strict";var i,t,n,a,s;Object.defineProperty(t,"__esModule",{value:!0}),i=e("Core"),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:t.OpType.addSheetNamedStyle,createOp:function(o){var t=o.style.toJSON();return{type:s.type,module:a.OpModule.worksheet,sheetId:o.sheetId,payload:{styleJson:t}}},applyOp:function(o,t){var e,t,n,o,e,e=t.sheetId,t=t.payload.styleJson,n=new i.Style;n.fromJSON(t,void 0,void 0),o=o.c_r(e),e=t.name.toUpperCase(),o.Hp[e]=n,o.r3()}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/named-style/remove-named-style.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),a={type:t.OpType.removeSheetNamedStyle,createOp:function(o){return{type:a.type,module:i.OpModule.worksheet,sheetId:o.sheetId,payload:{name:o.name}}},applyOp:function(o,t){var e,t,o,e=t.sheetId,t=t.payload.name,o=o.c_r(e);o&&o.Hp[t]&&(delete o.Hp[t],o.r3(),o.zw())}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/remove-span.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),a={type:t.OpType.removeSpan,createOp:function(o){var t=o.span;return{type:a.type,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{sheetArea:o.sheetArea,row:t.row,col:t.col}}},applyOp:function(o,t){var e,t,n,i,t,a,s,o,e,e=t.sheetId,t=t.target,n=t.sheetArea,i=t.row,t=t.col,a,s,o=o.c_r(e).Ut.K_(n),e=o.x_r(i,t);-1<e&&o.S_r(e,1)}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/set-axis-size.js":function(o,t,e){"use strict";var n,m,i,t,a,s,e,n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),m=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),s=e("CollaborationTypes"),e={type:i.OpType.setAxisSize,createOp:function(o){var t,t,t,e,t,e={sheetArea:o.sheetArea};return o.isRow?(e.row=o.index,e.rowCount=null!=(t=o.count)?t:1):(e.col=o.index,e.colCount=null!=(t=o.count)?t:1),t=null!=(t=o.isStarSize)&&t,{type:i.OpType.setAxisSize,module:s.OpModule.worksheet,sheetId:o.sheetId,target:e,payload:{value:o.value,isStarSize:t}}},mergeOp:function(o,t){if(o.payload.value===t.payload.value&&o.payload.isStarSize===t.payload.isStarSize){var t=(0,a.mergeTarget)(o.target,t.target);if(t)return n(n({},o),{target:t})}},applyOp:function(o,t){for(var e,n,t,i,a,s,l,n,r,u,p,c,d,t,b,f,v,g,j,e=t.sheetId,n=t.target,t=t.payload,i=n.row,a=n.col,s=n.sheetArea,l=n.rowCount,n=n.colCount,r=t.value,u=t.isStarSize,p=void 0!==i,c=p?i:a,d=p?l:n,t=o.c_r(e),b=t.Ut,f=b.Q_(p,s),v=0;v<d;v++)g=c+v,u?f.setStarSize(g,r):(f.setSize(g,r),j=p?m.AxisInfoChangeType.setRowHeight:m.AxisInfoChangeType.setColumnWidth,b.L8({type:j,index:g,value:r,sheetArea:s}));t.Zw=!0}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-column-count.js":function(o,t,e){"use strict";var t,n,a,i,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/op-manager.js"),n=e("./dist/plugins/collaboration/enum.js"),a=e("Core"),i=e("CollaborationTypes"),e={type:n.OpType.setColumnCount,createOp:function(o){return{type:n.OpType.setColumnCount,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:{count:o.count}}},applyOp:function(o,t){var e,n,t,o,e,i,e=t.sheetId,n=t.target.sheetArea,t=t.payload.count,o=o.c_r(e),e=o.Ut,i=e.W_(n).getColumnCount();3===n||1===n?(e.W_(3).setColumnCount(t),e.W_(1).setColumnCount(t),e.Ehe(3).setColumnCount(t)):2===n&&(t<i&&e.Q_(!1,n).DE(t,i-t),e.W_(n).setColumnCount(t)),e.L8({type:a.AxisInfoChangeType.setColumnCount,count:t,sheetArea:n}),o.Zw=!0,o.zw(),o.clearPendingChanges()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-current-theme.js":function(o,t,e){"use strict";var s,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),s=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.setCurrentTheme,createOp:function(o){var t=o.sheetId,o=o.currentTheme;return{type:n.OpType.setCurrentTheme,module:i.OpModule.worksheet,sheetId:t,payload:{currentThemeJSON:o.toJSON()}}},applyOp:function(o,t){var e,t,o,n,i,e,a,e=t.sheetId,t=t.payload.currentThemeJSON,o=o.c_r(e);"string"!=typeof t&&(0,s.isDefined)(t)&&(e=t.themeColor||t[n="_themeColor"],(a=new s.ColorScheme(e.name||e[i="_name"])).fromJSON(e,void 0),t=new s.Theme(t.name||t.Zc,a,t.headingFont||t.Aee,t.bodyFont||t.See)),o.currentTheme(t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-file-info.js":function(o,t,e){"use strict";var n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.setFileInfo,createOp:function(o){return{type:n.OpType.setFileInfo,module:i.OpModule.worksheet,sheetId:o.sheetId,payload:{fileGUID:o.fileGUID,fileInfo:o.fileInfo}}},applyOp:function(o,t){var e,t,n,t,i,a,e=t.sheetId,t=t.payload,n=t.fileGUID,t=t.fileInfo,i,a;o.c_r(e).GRe().y_r(n,t)}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-free-area.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/op-manager.js"),n=e("./dist/plugins/collaboration/enum.js"),i=e("CollaborationTypes"),a={type:n.OpType.setFreeAreaCount,createOp:function(o){var t;return{type:a.type,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{sheetArea:null!=(t=o.sheetArea)?t:3},payload:{count:o.count,isRow:o.isRow}}},applyOp:function(o,t){var e,n,t,i,t,a,o,e=t.sheetId,n=t.target.sheetArea,t=t.payload,i=t.count,t=t.isRow,a,o=o.c_r(e).Ut.W_(n);t?o.j8=i:o.O8=i}},(0,t.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/set-header-fit-mode.js":function(o,t,e){"use strict";var t,n,a,s;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:t.OpType.setHeaderFitMode,createOp:function(o){var t=o.sheetId,e=o.index,n=o.value,i=o.sheetArea,o=o.isRow;return{type:s.type,module:a.OpModule.worksheet,sheetId:t,target:{row:o?e:void 0,col:o?void 0:e,sheetArea:i},payload:{value:n}}},applyOp:function(o,t){var e,n,i,a,n,t,s,l,o,e,s,i,e=t.sheetId,n=t.target,i=n.row,a=n.col,n=n.sheetArea,t=t.payload.value,s=void 0!==i,l,o=o.c_r(e).Ut,e=o.Q_(s,n),s=s?i:a,i=e.getColumnHeaderFitMode(s);e.setColumnHeaderFitMode(s,t),o.k_r(t,s,i,n,!1)}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/set-name.js":function(o,t,e){"use strict";var a,n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),a=e("Core"),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.setName,createOp:function(o){return{type:n.OpType.setName,module:i.OpModule.worksheet,sheetId:o.sheetId,payload:{value:o.value}}},applyOp:function(o,t){var e,n,t,o,e,i,e=t.sheetId,n,t=t.payload.value,o=o.c_r(e);o&&(e=o.Ut.name,o.Ut.name=t,(i=o.parent)&&i.Xg(),a.Worksheet.et(o,"onSetNameFromOp",{oldName:e,newName:t}))}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-range/set-default-value.js":function(o,t,d){"use strict";var b,f,v;function e(o,t,e,n,i){var a,s,t,l,t,r,u,p,a,l,c,s,l,t=(0,f.getData)(t,e,n,b.Type.defaultValue);v(t)||(l=t.isFormula,t=t.value,(p=(p=(u=(r=o.Ut).Ehe(i)).defaultCellData[e])||(u.defaultCellData[e]={}))[n]||(p[n]={}),a=null==(a=p[n])?void 0:a.value,l?t&&(l=d("SheetsCalc"))&&(c=p[n].expr,s=(null==(s=o.parent)?void 0:s.options.referenceStyle)===l.ReferenceStyle.r1c1,l=l.formulaToExpression(o,t,e,n,s,!0),p[n].expr=l,u.khe(e,n,l,l,i),u.A_r(e,n,c,l)):(p[n]&&p[n].expr&&u.khe(e,n,null),p[n]={value:t},u.A_r(e,n,a,t)))}Object.defineProperty(t,"__esModule",{value:!0}),t.setDefaultValue=void 0,b=d("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),f=d("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),v=function(o){return void 0===o},t.setDefaultValue=e},"./dist/plugins/collaboration/ops/worksheet/set-range/set-file-guid.js":function(o,t,e){"use strict";var s,l,r;function n(o,t,e,n,i){var t,o,i,a,t=(0,l.getData)(t,e,n,s.Type.fileGUID);r(t)||!(i=(o=o.Ut.W_(i)).J_(e,n,!0))||r(i.fileGUID)&&r(t)||i.fileGUID===t||(a=i.fileGUID,i.fileGUID=t,o.dE(e,n,{d6:a,mE:t},null))}Object.defineProperty(t,"__esModule",{value:!0}),t.setFileGuid=void 0,s=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),l=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),r=function(o){return void 0===o},t.setFileGuid=n},"./dist/plugins/collaboration/ops/worksheet/set-range/set-formula.js":function(o,t,e){"use strict";var n,i,O,C,_,k,w,M,T;function a(o,t,e,n,i,a){var s,t,o,s,t=(0,_.getFormulaInfo)(t,o,{row:e,col:n,sheetArea:a});if(t!==k)return o={formulaInfo:t},i&&i.row===e&&i.col===n&&(o.arrayInfo={rowCount:i.rowCount,colCount:i.colCount,isDynamicArray:i.isDynamicArray}),o}function s(o,t,e,n,i){var t,a,s,l,r,u,p,c,d,t,b,d,p,f,c,v,r,g,j,m,y,h,u,a,t=(0,C.getData)(t,e,n,O.Type.formula);if(t){if(a=o.Ut,s=o.options.keepUnknownFormulas,l=!0,r=0<=e?e:0,u=0<=n?n:0,p=o.Lp,c=o.Uw(i),d=t.formulaInfo,(t=t.arrayInfo)&&(t.row=e,t.col=n),d=(b=(0,_.unparseFormulaInfo)(d,o.getParent()))&&(0,_.parseExpressionImp)(p,c,b,r,u,{sheetArea:i,ignoreError:!0}),p=s&&b&&!d,f=o.b3(i),c=o.conditionalFormats,f){if((v=M(o.Dhe)&&!b&&!M(a.getDefaultValue(e,n,i)))&&(o.Dhe=!(b||o.Q5e&&o.Q5e(e,n))),r=o.Dhe&&b===w,S(t)){for(g=[],j=t.rowCount,m=t.colCount,y=e;y<e+j;y++)for(g[y]=[],h=n;h<n+m;h++)g[y][h]=f.getFormula(y,h);for(f.setArrayFormula(t.row,t.col,t.rowCount,t.colCount,b),y=e;y<e+j;y++)for(h=n;h<n+m;h++)f.usedRange&&T(f.usedRange,y,h,g[y][h],b)}else u=f.getFormula(e,n,k,!0),f.setFormula(e,n,b,d,!0,r,w,w,s),f.usedRange&&T(f.usedRange,e,n,u,b);delete o.Dhe,p&&(a=f.getNode(e,n,!0))&&(a.qbt=b),c&&c.dl(),o.hasFormula(e,n,i)&&o.Ut.JE(e,n,i),o.Lj(o,[{row:e,col:n}],0)}o.Q1i&&o.Q1i(e,n,1,1,i),o.Tj(),o.zw()}}function S(o){return o&&!o.isDynamicArray}Object.defineProperty(t,"__esModule",{value:!0}),t.applyFormula=t.createFormulaData=void 0,n=e("Core"),i=e("Common"),O=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),C=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),_=e("./dist/plugins/collaboration/util/formula-info/util.js"),k=void 0,w=null,M=i.Common.lt.ht,T=n.UsedRangeUtil.updateUsedRangeByData,t.createFormulaData=a,t.applyFormula=s},"./dist/plugins/collaboration/ops/worksheet/set-range/set-range.js":function(o,t,e){"use strict";var n,t,v,l,g,j,r,i,u,p,c,d,m,y,a,e;function h(o,n){var i={};return(0,l.forLoopRange)(o,function(o,t){var e;i[o]=null!=(e=i[o])?e:{},i[o][t]=n}),i}n=this&&this.__assign||function(){return(n=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/op-manager.js"),v=e("./dist/plugins/collaboration/enum.js"),l=e("./dist/plugins/collaboration/util/common.js"),g=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),j=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-value.js"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-style.js"),i=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),u=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-value-for-key.js"),p=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-file-guid.js"),c=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-default-value.js"),d=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-style-property.js"),m=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-formula.js"),y=e("CollaborationTypes"),a=[g.Type.value,g.Type.style,g.Type.formula,g.Type.valueForKey,g.Type.fileGUID,g.Type.defaultValue,g.Type.styleProperty],e={type:v.OpType.setRange,createOp:function(o,t){var e,e,n,i,a,s,l,r,u,p,c,d,o,a,l,b,e,e,t,f,n=o.row,i=o.col,a=o.rowCount,s,l=o.colCount,r,u=o.sheetId,p=o.sheetArea,c=o.setType,d=o.source,o=o.data,a={row:n,col:i,rowCount:void 0===a?1:a,colCount:void 0===l?1:l,sheetArea:p},l={},b={};if(c===g.Type.value)o=(0,j.convertToSSJSONNodeValue)(o);else if(c===g.Type.style){if(void 0===(o=null!=o&&o.toJSON?o.toJSON():o))return}else if(c===g.Type.styleProperty)(e=null==(e=t.c_r(u))?void 0:e.getStyle(n,i,p))&&e.toJSON&&(o.jsonValue=null==(e=e.toJSON())?void 0:e[o.propertyName]);else if(c===g.Type.formula&&(e=t.c_r(u),t=o.formula,f=o.arrayInfo,void 0===(o=(0,m.createFormulaData)(e,t,n,i,f,p))))return;return l[g.TYPE_TO_KEY_MAP[c]]=0,b[g.TYPE_TO_KEY_MAP[c]]={0:o},{type:v.OpType.setRange,module:y.OpModule.worksheet,sheetId:u,target:a,source:d,payload:{data:h(a,l),refs:b}}},mergeOp:function(e,n){var o=(0,l.mergeTarget)(e.target,n.target);if(o)return e.target=o,e.payload.rangeData&&!e.payload.data&&(0,l.forLoopRange)(e.target,function(o,t){(0,i.pickDataToOtherPayload)(e.payload,o,t,a,e.payload)}),(0,l.forLoopRange)(n.target,function(o,t){(0,i.pickDataToOtherPayload)(n.payload,o,t,a,e.payload)}),e.payload.refs&&e.payload.data&&delete e.payload.rangeData,e},minifyOp:function(o){var t=(0,i.reduceSize)(o.payload,a);return n(n({},o),{payload:t})},applyOp:function(o,t){var e,n,i,a,s,e=t.sheetId,n=t.target,i=t.payload,a=n.sheetArea,s=o.c_r(e);(0,l.forLoopRange)(n,function(o,t){(0,j.applyValues)(s,i,o,t,a),(0,r.applyStyle)(s,i,o,t,a),(0,m.applyFormula)(s,i,o,t,a),(0,u.applyValueKey)(s,i,o,t,a),(0,p.setFileGuid)(s,i,o,t,a),(0,c.setDefaultValue)(s,i,o,t,a),(0,d.applySetStyleProperty)(s,i,o,t,a)})}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-range/set-style-property.js":function(o,t,e){"use strict";var u,p,c,d;function n(o,t,e,n,i){var t,a,s,t,l,r,t=(0,c.getData)(t,e,n,p.Type.styleProperty);d(t)||(t=b(a=t.propertyName,s=t.jsonValue),"string"==typeof(l=(l=o.vI(e,n,i))||new u.Style)&&(r=l,(l=new u.Style).parentName=r),l[a]=t,o.setStyle(e,n,l,i))}function b(o,t){var e,n,n=new u.Style;return n.fromJSON(((e={})[o]=t,e),void 0,void 0),n[o]}Object.defineProperty(t,"__esModule",{value:!0}),t.convertStylePropertyJsonValueToValue=t.applySetStyleProperty=void 0,u=e("Core"),p=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),c=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),d=function(o){return void 0===o},t.applySetStyleProperty=n,t.convertStylePropertyJsonValueToValue=b},"./dist/plugins/collaboration/ops/worksheet/set-range/set-style.js":function(o,t,e){"use strict";var s,l,r,u;function n(o,t,e,n,i){var t,o,i,i,a,i,t=(0,r.getData)(t,e,n,l.Type.style);!u(t)&&(o=o.Ut.W_(i),t&&"string"!=typeof t&&((i=new s.Style).fromJSON(t,void 0,void 0),i.name=void 0,t=i),i=o.J_(e,n,!0))&&(!u(i.style)||!u(t))&&i.style!==t&&(a=i.style,i.style=t,i=o.a8)&&s.UsedRangeUtil.updateUsedRangeByData(i.data,e,n,a,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.applyStyle=void 0,s=e("Core"),l=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),u=function(o){return void 0===o},t.applyStyle=n},"./dist/plugins/collaboration/ops/worksheet/set-range/set-value-for-key.js":function(o,t,e){"use strict";var a,s,l;function n(o,t,e,n,i){var t=(0,s.getData)(t,e,n,a.Type.valueForKey);l(t)||o.Ut.W_(i).setValueForKey(e,n,t.key,t.value)}Object.defineProperty(t,"__esModule",{value:!0}),t.applyValueKey=void 0,a=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),s=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),l=function(o){return void 0===o},t.applyValueKey=n},"./dist/plugins/collaboration/ops/worksheet/set-range/set-value.js":function(o,t,e){"use strict";var n,r,i,u,p,a,c;function s(o,t,e,n,i){var t,a,s,l,s,t=(0,p.getData)(t,e,n,u.Type.value);!c(t)&&(t=d(t),s=(a=o.Ut.W_(i)).J_(e,n,!0))&&(!c(s.value)||!c(t))&&s.value!==t&&(l=s.value,s.value=t,o.gL(e,n,i),o.Q1i&&o.Q1i(e,n,1,1,i),o.Tj(),s=a.a8)&&r.UsedRangeUtil.updateUsedRangeByData(s.data,e,n,l,t)}function l(o){return a(o)||"object"==typeof(o=o instanceof i.CalcError?o.toJSON():o)&&0<Object.keys(o).length&&((o=JSON.parse(JSON.stringify(o))).richText&&(o.converted=void 0),o=(0,r.C_r)(o)),o}function d(o){var t;return a(o)||"object"==typeof(o=(o._calcError||o._error&&!a(o._code))&&void 0!==(t=i.CalcError.parse(o._calcError||o._error))?t:o)&&0<Object.keys(o).length&&((o=JSON.parse(JSON.stringify(o))).richText&&o.converted&&(o=r.util.g0(o)),o=(0,r.M_r)(o)),o}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToSSJSONNodeValue=t.applyValues=void 0,n=e("Common"),r=e("Core"),i=e("CalcEngine"),u=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),p=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),a=n.Common.lt.ht,c=function(o){return void 0===o},t.applyValues=s,t.convertToSSJSONNodeValue=l},"./dist/plugins/collaboration/ops/worksheet/set-range/type.js":function(o,t){"use strict";var e,n,e;Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_TO_KEY_MAP=t.Type=void 0,(e=n=t.Type||(t.Type={})).value="value",e.style="style",e.formula="formula",e.valueForKey="valueForKey",e.fileGUID="fileGUID",e.defaultValue="defaultValue",e.styleProperty="styleProperty",t.TYPE_TO_KEY_MAP=((e={})[n.value]="value",e[n.style]="style",e[n.formula]="formula",e[n.valueForKey]="valueForKey",e[n.fileGUID]="fileGUID",e[n.defaultValue]="defaultValue",e[n.styleProperty]="styleProperty",e)},"./dist/plugins/collaboration/ops/worksheet/set-range/utils.js":function(o,t,e){"use strict";var b,f,e,a,v;function n(e,n,i,o,a){o.forEach(function(o){var t=s(e,n,i,o);r(a,n,i,o,t)})}function s(o,t,e,n){var i,i,i=null==(i=o.rangeData)?void 0:i[f.TYPE_TO_KEY_MAP[n]];return a(i)?l(o,t,e,n):i}function l(o,t,e,n){var i,i,o,t,i,e,t,i=o.data,o=o.refs,t=null==(i=null==i?void 0:i[t])?void 0:i[e];if(t&&(e=i=void 0,i=t[t=f.TYPE_TO_KEY_MAP[n]],e=null==o?void 0:o[t],!v(i))&&e)return e[i]}function r(o,t,e,n,i){var a,a,n,s,s,l,l,r,a;void 0!==i&&(s=o.refs,l=void 0===(l=o.data)?{}:l,r=p(s=void 0===s?{}:s,n),l[t]=null!=(a=l[t])?a:{},l[t][e]=null!=(a=l[t][e])?a:{},a=f.TYPE_TO_KEY_MAP[n],l[t][e][a]=r,s[a]=null!=(n=s[a])?n:{},s[a][r]=i,o.data=l,o.refs=s)}function i(t,o){var e,n,i;if(o.forEach(function(o){u(t,o)}),e=t.data){for(n in e){for(i in e[n])Object.keys(e[n][i]).length<1&&delete e[n][i];Object.keys(e[n]).length<1&&delete e[n]}Object.keys(e).length<1&&delete t.data}return t.refs&&Object.keys(t.refs).length<1&&delete t.refs,t}function u(o,t){var e,n,e,i,a,s,l,r,u,p,c,d,e=o.refs,i=o.data;if(e){if(a=e[f.TYPE_TO_KEY_MAP[t]],s=new Map,l=new Map,a)for(r in delete a.maxId,a)u=JSON.stringify(a[r]),s.has(u)?(delete a[r],l.set(r,s.get(u))):(l.set(r,r),s.set(u,r));for(c in p=1===s.size,i)for(d in i[c])r=null==(n=i[c][d])?void 0:n[f.TYPE_TO_KEY_MAP[t]],v(r)?p=!1:i[c][d][f.TYPE_TO_KEY_MAP[t]]=Number(l.get(r+""));if(p)for(c in o.rangeData=b(b({},o.rangeData),((e={})[f.TYPE_TO_KEY_MAP[t]]=a[Object.keys(a)[0]],e)),delete o.refs[f.TYPE_TO_KEY_MAP[t]],i)for(d in i[c])delete i[c][d][f.TYPE_TO_KEY_MAP[t]]}}function p(o,t){var e,t,n,t=f.TYPE_TO_KEY_MAP[t],e=o[t],n=1;return e=e||(o[t]={}),v(e.maxId)||(n=e.maxId+1),e.maxId=n}b=this&&this.__assign||function(){return(b=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.reduceSize=t.setRefData=t.getData=t.pickDataToOtherPayload=void 0,f=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),e=e("Common"),a=function(o){return void 0===o},v=e.Common.lt.ht,t.pickDataToOtherPayload=n,t.getData=s,t.setRefData=r,t.reduceSize=i},"./dist/plugins/collaboration/ops/worksheet/set-row-count.js":function(o,t,e){"use strict";var t,n,a,i,e;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/op-manager.js"),n=e("./dist/plugins/collaboration/enum.js"),a=e("Core"),i=e("CollaborationTypes"),e={type:n.OpType.setRowCount,createOp:function(o){return{type:n.OpType.setRowCount,module:i.OpModule.worksheet,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:{count:o.count}}},applyOp:function(o,t){var e,n,t,o,e,i,e=t.sheetId,n=t.target.sheetArea,t=t.payload.count,o=o.c_r(e),e=o.Ut,i=e.W_(n).getRowCount();3===n||2===n?(e.W_(3).setRowCount(t),e.W_(2).setRowCount(t),e.Ehe(3).setRowCount(t)):1===n&&(t<i&&e.Q_(!0,n).DE(t,i-t),e.W_(n).setRowCount(t)),e.L8({type:a.AxisInfoChangeType.setRowCount,count:t,sheetArea:n}),o.Zw=!0,o.zw(),o.clearPendingChanges()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-sheet-scope-custom-name.js":function(o,t,e){"use strict";var u,t,p,c,d,e;Object.defineProperty(t,"__esModule",{value:!0}),u=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),p=e("CollaborationTypes"),c=e("./dist/plugins/collaboration/util/formula-info/util.js"),e={type:u.OpType.setSheetScopeCustomName,createOp:function(o,t){var e,n,i,a,s,l,n,s,l,r,r,e=o.value?{}:null;if(o.value&&(i=(n=o.value).baseRow,a=n.baseCol,s=n.comment,l=n.isReadOnly,n=n.expr,i!==d&&(e.baseRow=i),a!==d&&(e.baseCol=a),s!==d&&(e.comment=s),l!==d&&(e.isReadOnly=l),s=o.value.formula,s=n&&(r=null==(l=t.c_r(o.sheetId))?void 0:l.Lp)?r.unparse(l.qgt,n,i,a,!1,!0,2):s)&&(r=(0,c.getFormulaInfo)(s,t,{row:i,col:a}))&&(e.formulaInfo=r),!e||e.formulaInfo)return{type:u.OpType.setSheetScopeCustomName,module:p.OpModule.worksheet,sheetId:o.sheetId,payload:{name:o.name,value:e}}},mergeOp:function(o,t){if(o.sheetId===t.sheetId&&o.payload.name===t.payload.name)return t},applyOp:function(o,t){var e,t,e,n,t,i,a,s,l,t,i,e=t.sheetId,t=t.payload,e=o.c_r(e),n=t.name,t=t.value;t?(i=t.formulaInfo,a=t.comment,s=t.isReadOnly,l=t.baseRow,t=t.baseCol,i=(0,c.unparseFormulaInfo)(i,o),e.$_r(n,i,l,t,{ignoreError:!1,comment:a,isReadOnly:s,ignoreModelChange:!0})):e.removeCustomName(n)}},(d=void 0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-tab-selected.js":function(o,t,e){"use strict";var n,t,i,e;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),t=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),e={type:n.OpType.setTabSelected,createOp:function(o){return{type:n.OpType.setTabSelected,module:i.OpModule.worksheet,sheetId:o.sheetId,payload:{value:o.value}}},applyOp:function(o,t){var e,e,n,t,i,e=t.sheetId,n,t=t.payload.value,i;o.c_r(e).Ut.qj(t),null!=(e=null==o?void 0:o.w2)&&e.repaint()}},(0,t.registerOpProcess)(e)},"./dist/plugins/collaboration/ops/worksheet/set-visible.js":function(o,t,e){"use strict";var t,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),a={type:t.OpType.setSheetVisible,createOp:function(o){var t=o.sheetId,o=o.visible;return{type:a.type,module:i.OpModule.worksheet,sheetId:t,payload:{visible:o}}},applyOp:function(o,t){var e,t,n,e=t.sheetId,t=t.payload.visible,n;o.c_r(e).visible(t,void 0,{shouldModelCallback:!1})}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/set-worksheet-options.js":function(o,t,e){"use strict";var t,n,i,a,s;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("Core"),a=e("CollaborationTypes"),s={type:t.OpType.setWorksheetOptions,createOp:function(o){var t=o.sheetId,e=o.propertyName,n=o.value,o=o.secondLevelPropertyName;return{type:s.type,module:a.OpModule.worksheet,sheetId:t,payload:{propertyName:e,value:(0,i.RF)(n),secondLevelPropertyName:o}}},applyOp:function(o,t){var e,t,n,i,t,a,o,e=t.sheetId,t=t.payload,n=t.propertyName,i=t.value,t=t.secondLevelPropertyName,a=o.c_r(e);if(t)switch(a.options[n]["_".concat(t)]=i,n){case"sheetAreaOffset":case"gridline":a.zw();break;case"addRowButtonOption":a.rEe=null,a.zw();break;case"addColumnButtonOption":a.oEe=null,a.zw()}else o=a.options[n],a.options._ps[n]=i,a.Ob(n,i,o,!0)}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/update-span.js":function(o,t,e){"use strict";var f,t,n,d,b;Object.defineProperty(t,"__esModule",{value:!0}),f=e("Core"),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),d=e("CollaborationTypes"),b={type:t.OpType.updateSpan,createOp:function(o){var t,e,n,i,a,s,l,r,u,p,c,e,n,t=o.newRange,e=o.oldRange,n=o.useDelta;if(t&&e)return i=e.row,a=e.col,s=e.rowCount,l=e.colCount,r=t.row,u=t.col,p=t.rowCount,c=t.colCount,e={oldRange:e},n?(n={},i!==r&&(n.dRow=r-i),a!==u&&(n.dCol=u-a),s!==p&&(n.dRowCount=p-s),l!==c&&(n.dColCount=c-l),e.deltaInfo=n):e.newRange=t,{type:b.type,module:d.OpModule.worksheet,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:e}},applyOp:function(o,t){var e,n,t,i,a,t,s,i,l,r,o,e,n,s,u,i,p,c,d,a,b,s,i,c,n,e=t.sheetId,n=t.target.sheetArea,t=t.payload,i=t.oldRange,a=t.deltaInfo,t=t.newRange,s=i.row,i=i.col,l,r,o=o.c_r(e).Ut.K_(n),e=o.x_r(s,i);-1<e&&(n=o.spans[e],a?(s=a.dRow,i=a.dCol,c=a.dRowCount,a=a.dColCount,o.T_r(e,new f.Range(n.row+(u=void 0===s?0:s),n.col+(p=void 0===i?0:i),n.rowCount+(d=void 0===c?0:c),n.colCount+(b=void 0===a?0:a)))):(s=t.row,i=t.col,c=t.rowCount,n=t.colCount,o.T_r(e,new f.Range(s,i,c,n))))}},(0,n.registerOpProcess)(b)},"./dist/plugins/collaboration/ops/worksheet/update-top-left-position.js":function(o,t,e){"use strict";var t,n,a;Object.defineProperty(t,"__esModule",{value:!0}),t=e("./dist/plugins/collaboration/op-manager.js"),n=e("CollaborationTypes"),a=e("Core"),(0,t.registerOpProcess)({type:n.OpType.updateTopLeftPosition,createOp:function(o){var t=o.leftCol,e=o.topRow,o=o.sheetId;return{type:n.OpType.updateTopLeftPosition,module:n.OpModule.worksheet,sheetId:o,payload:{leftCol:t,topRow:e}}},applyOp:function(o,t){var e,t,n,t,i,e=t.sheetId,t=t.payload,n=t.leftCol,t=t.topRow,i;o.c_r(e).showCell(t,n,a.VerticalPosition.top,a.HorizontalPosition.left)},mergeOp:function(o,t){return t}})},"./dist/plugins/collaboration/ops/worksheet/zoom.js":function(o,t,e){"use strict";var i,t,n,a,s;Object.defineProperty(t,"__esModule",{value:!0}),i=e("Core"),t=e("./dist/plugins/collaboration/enum.js"),n=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:t.OpType.updateZoom,createOp:function(o){return{type:s.type,module:a.OpModule.worksheet,sheetId:o.sheetId,payload:{value:o.value}}},applyOp:function(o,t){var e,t,o,e,n,e=t.sheetId,t=t.payload.value,o=o.c_r(e),e=o.Ut,n=e.zoomFactor;e.zoomFactor=t,i.Worksheet.et(o,"onLayoutChangedFromOp",{changeType:"zoomSheet"}),o.my=o.my/n*t,o.ly=o.ly/n*t,o.Zw=!0,o.Ww=!0,o.zw()}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/presence/permissions.js":function(o,t,e){"use strict";var e,e,n,i,e,t,a,n,t,s,a,l,r,u,p,n,i,e,c;function d(o){return!o||!o.permission||o.permission.mode!==s.BrowsingMode.view}function b(o){var o;return(null==(o=null==o?void 0:o.permission)?void 0:o.mode)===s.BrowsingMode.view}function f(o,t){b(t)&&(o.r=!0)}function v(o){var o;return null==(o=null==o?void 0:o.parent)?void 0:o.moo}function g(o){var o,o,o;return null==(o=null==(o=null==(o=o.TZ)?void 0:o.Mf)?void 0:o.parent)?void 0:o.moo}function j(o){var o,o,o;return null==(o=null==(o=null==(o=o.TZ)?void 0:o.Mf)?void 0:o.parent)?void 0:o.moo}function m(o){var o,o,o,o,o;return null==(o=null==(o=o.Mf||(null==(o=null==(o=null==(o=null==o?void 0:o.hitTestResult)?void 0:o.shape)?void 0:o.JVV)?void 0:o.Mf))?void 0:o.parent)?void 0:o.moo}Object.defineProperty(t,"__esModule",{value:!0}),t=e("Core"),s=e("CollaborationTypes"),a=e("Comment"),l=e("FloatingObject"),r=e("PivotTable"),u=e("Shapes"),p=e("Validation"),n=e("Touch"),i=e("Filters"),e=e("DataChart"),t.Workbook.ch(c="permissions",{beforeOpenContextMenu:function(o){var t,e,n,i,t,a,e,n=this.moo,i=null==(t=null==n?void 0:n.permission)?void 0:t.viewModePermissions,t=o.itemsDataForShown;d(n)||(a=[],t.forEach(function(o){var t;(null==(t=null==o?void 0:o.metaData)?void 0:t.viewModePermission)&i&&a.push(o)}),o.itemsDataForShown=a)},init:function(){var e=this,o;e.commandManager().cM("permissionControl",function(o){var t,t,t;!o.isBefore||d(e.moo)||(t=o.metaData,!e.moo)||(null==t?void 0:t.viewModePermission)&(null==(t=null==(t=e.moo)?void 0:t.permission)?void 0:t.viewModePermissions)||(o.r=!0)})},dispose:function(){var o=this.commandManager();o&&o.zUt("permissionControl")}}),t.Worksheet.ch(c,{beforeResizingRowsOrColumns:function(o){var t,e,t,e,t=null==(t=this.parent)?void 0:t.moo;!b(t)||t.permission.viewModePermissions&s.PermissionTypes.allowResizeRowsOrColumns||(o.r=!0)},beforeDragHeaderToMove:function(o){f(o,v(this))},beforeDragMerge:function(o){f(o,v(this))},beforeDragDropping:function(o){f(o,v(this))},beforeDragFill:function(o){f(o,v(this))},beforeResizingTable:function(o){f(o,v(this))},beforeDoubleClickFill:function(o){f(o,v(this))},beforeStartEdit:function(o){f(o,v(this))},beforeDisplayResizeRowsOrColumnsCursor:function(o){var t,e,t,e,t=null==(t=this.parent)?void 0:t.moo;!b(t)||t.permission.viewModePermissions&s.PermissionTypes.allowResizeRowsOrColumns||(o.r=!0)},beforeDisplayDragHeaderCursor:function(o){f(o,v(this))},beforeDisplayDragDroppingCursor:function(o){f(o,v(this))},beforeDisplayDragFillCursor:function(o){f(o,v(this))},beforeDisplayDragMergeCursor:function(o){f(o,v(this))},beforeDisplayResizingTableCursor:function(o){f(o,v(this))},beforeAutoFitRow:function(o){f(o,v(this))},beforeAutoFitColumn:function(o){f(o,v(this))},preUploadFile:function(o){var t;b(v(this))&&(o.cancel=!0)},beforeMoveDataPoint:function(o){f(o,v(this))},formulaPanelCheckIsReadOnly:function(o){f(o,v(this))},preProcessFormulaTextBoxEdit:function(o){f(o,v(this))},preClickGroupArea:function(o){f(o,v(this))},preProcessOutlineColumnMouseDown:function(o){f(o,v(this))},processCompositionStart:function(o){f(o,v(this))}}),e&&null!=(e=e.DataChart)&&e.ch(c,{beforeSetDataChartType:function(o){f(o,v(this.Mf))},beforeSetDataChartConfig:function(o){f(o,v(this.Mf))}}),n.TouchToolStrip&&n.TouchToolStrip.ch(c,{beforeDoTabCut:function(o){var o;f(o,null==(o=this.Vv)?void 0:o.moo)},beforeDoTabPaste:function(o){var o;f(o,null==(o=this.Vv)?void 0:o.moo)}}),i&&null!=(e=i.HideRowFilter)&&e.ch(c,{beforeOpenFilterDialog:function(o){f(o,v(this.Mf))}}),t.CellTypes.Base.ch(c,{beforeAddRowOrColumnByCellType:function(o){f(o,v(this))},preProcessCellButtonMouseDown:function(o){f(o,v(this))},preProcessCellButtonMouseUp:function(o){f(o,v(this))},beforeEditCheckboxCellType:function(o){f(o,v(this))},beforeActivateComboboxCellTypeEditor:function(o){f(o,v(this))},beforeEditDataObjectCellType:function(o){f(o,v(this))},beforePopupDropdownCellType:function(o){f(o,v(this))},beforeEditRadioCheckListCellType:function(o){f(o,v(this))}}),t.Hv.ch(c,{beforeEditingSheetName:function(o){var o;f(o,null==(o=this.Vv)?void 0:o.moo)},beforeReorderSheet:function(o){var o;f(o,null==(o=this.Vv)?void 0:o.moo)},beforeAddSheetBySheetTab:function(o){var o;f(o,null==(o=this.Vv)?void 0:o.moo)}}),a&&null!=(n=a.hW)&&n.ch(c,{preProcessMouseDownEdit:function(o){f(o,g(this))},preProcessMouseDownDragResize:function(o){f(o,g(this))},preProcessMouseMove:function(o){f(o,g(this))},preProcessMouseUp:function(o){f(o,g(this))}}),p&&null!=(i=p.DefaultDataValidator)&&i.ch(c,{beforeUpdateDataValidationUI:function(o){f(o,v(this.Mf))}}),l&&null!=(e=l.FloatingObjectRender)&&e.ch(c,{preProcessMouseMove:function(o){f(o,j(this))},preProcessMouseUp:function(o){f(o,j(this))}}),r&&null!=(t=r.PivotPanelLayout)&&t.ch(c,{beforeDrag:function(o){var o,o,o,o;f(o,null==(o=null==(o=null==(o=null==(o=this.IWt)?void 0:o.z)?void 0:o.Ti)?void 0:o.parent)?void 0:o.moo)}}),u&&(null!=(a=u.ShapeBase)&&a.ch(c,{beforeOpenShapeTextEditor:function(o){var o,o,o;f(o,null==(o=null==(o=null==(o=null==this?void 0:this.JVV)?void 0:o.Mf)?void 0:o.parent)?void 0:o.moo)}}),null!=(n=u.Canvas))&&n.ch(c,{preProcessMouseDown:function(o){f(o,m(this))},preProcessMouseMove:function(o){f(o,m(this))},preProcessMouseUp:function(o){f(o,m(this))},preProcessMouseWheel:function(o){f(o,m(this))},preProcessMouseOut:function(o){f(o,m(this))},preProcessDbClick:function(o){f(o,m(this))},preProcessKeyDown:function(o){f(o,m(this))},preProcessKeyUp:function(o){f(o,m(this))}})},"./dist/plugins/collaboration/presence/presence.js":function(o,t,e){"use strict";var n,_,i,e,m,y,p,c;function r(){return Math.floor(10*Math.random())}function a(o){for(var t,e,n,t=0,e=0;e<o.length;e++)t=o.charCodeAt(e)+((t<<5)-t);return n=(t>>24&255).toString(16)+(t>>16&255).toString(16)+(t>>8&255).toString(16)+(255&t).toString(16),"#".concat(n.slice(0,6).padStart(6,"0"))}function u(o,t){var e;return a("".concat(o).concat(t))}function h(o,t,e,n,i){var a,s,a,s,l,r,e,u,n,p,c,d,n,e,u,r,l,a=t.frozenTrailingRowCount(),s=t.frozenTrailingColumnCount(),a=t.getRowCount()-a-1,s=t.getColumnCount()-s-1,l=t.Yy(1,3),r=t._y(1,3);1===n.length&&2007<e&&(e=t.frozenRowCount(),u=t.frozenColumnCount(),p=(n=n[0]).row,c=n.col,d=n.rowCount,n=n.colCount,0<e&&(e<=p&&t.nI(p)<e?(o.y-=2,o.height+=2):p+d<=e&&t.j5(p+d-1)===t.Tb&&(o.height+=2)),0<u&&(u<=c&&t.r6(c)<u?(o.x-=2,o.width+=2):c+n<=u&&t.O5(c+n-1)===t.Ab&&(o.width+=2)),0===p&&0===c&&(o.x-=2,o.y-=2,o.width+=2,o.height+=2),-1===p&&(p=0,d=t.getRowCount()),-1===c&&(c=0,n=t.getColumnCount()),u=e=!1,r=r.findRow(a),l=l.findCol(s),r&&r.y+r.height<i.Cy+t.Sy(i)&&(e=!0),l&&l.x+l.width<i.Py+t.Gy(i)&&(u=!0),e&&p+d-1==a&&(o.height+=2),u)&&c+n-1==s&&(o.width+=2)}function O(o,t,e,n,i,a,s,l,r){var u,p,c,d,b,f,v,g,e,n,j,m,y,h,O,y,g,h,v,C,u=o.parent,p=o&&o.zoom()||1,c=i.x,d=i.y,b=i.width,f=i.height,v=o.getViewportTopRow(e),g=o.getViewportLeftColumn(n),e=o.getViewportBottomRow(e),n=o.getViewportRightColumn(n),j=0,m=0,y=o.Fi(),h=0!==y.qC,O;0!==y.XC||s.col!==g&&-1!==s.col||(j=2),h||s.row!==v&&-1!==s.row||(m=2),s.row+s.rowCount===e+1&&(a.height=a.height+1),s.col+s.colCount===n+1&&(a.width=a.width+1),0<=b&&0<=f&&(!a||i.intersect(a.x-1,a.y-1,a.width+2,a.height+2))&&(t.save(),a&&!a.containsRect(i)&&(t.rect(a.x-j,a.y-m,a.width,a.height),t.clip()),t.beginPath(),t.strokeStyle=_.Pf.vl(o,l),t.lineWidth=2,v=h=g=y=void 0,0<b&&0<f?v=2007<(C=u&&u.SC)?(y=c-1,g=d-1,h=b+1,f+1):(y=c-.5,g=d-.5,h=b,f):0!==b&&0!==f||(y=c-1,g=d-1,h=b+1,v=f+1),t.rect(y,g,h,v),t.stroke(),k(t,r,y+h,g,l,p),t.beginPath(),t.restore())}function k(o,t,e,n,i,a){var s,l,r,r,r,u,a,r,s=4*a,l=4*a,r=o.font,r=p(r),r=parseInt(r.fontSize,10)*a;o.font=c(o.font,a).font,a=(u=o.measureText(t).width)+2*s,r=r+2*s,o.beginPath(),o.moveTo(e+l,n),o.lineTo(e+a-l,n),o.quadraticCurveTo(e+a,n,e+a,n+l),o.lineTo(e+a,n+r-l),o.quadraticCurveTo(e+a,n+r,e+a-l,n+r),o.lineTo(e+l,n+r),o.quadraticCurveTo(e,n+r,e,n+r-l),o.lineTo(e,n+l),o.quadraticCurveTo(e,n,e+l,n),o.closePath(),o.fillStyle=i,o.fill(),o.fillStyle="white",o.textAlign="center",o.textBaseline="middle",o.fillText(t,e+a/2,n+r/2)}function b(o,t,e,n,i,a,s,l,r,u,p){var c,d,b,f,v,i,e,e,g,j;if((!r||i.intersectRect(r))&&(b=void 0,!((d=(c=e.fO(u,p,s,r)).length)<=0))){for(f=!1,v=void 0,v=0;v<d;v++)if(b=c[v],!r.containsRect(b)){f=!0;break}if(l.save(),f&&(o.options.rightToLeft&&(r.x-=2),l.rect(r.x,r.y,r.width,r.height),l.clip()),l.beginPath(),i=a.color,0<d)for((e=m(_.Pf.vl(o,i))).a=.2,e=y(e),l.fillStyle!==e&&(l.fillStyle=e),j=g=0,2007<n&&(g=1,j=-3),v=0;v<d;v++)b=c[v],l.fillRect(b.x+g,b.y+g,b.width+j,b.height+j);l.restore(),l.save(),l.beginPath(),1===s.length&&b&&0<=b.width&&0<=b.height&&(h(r,o,n,s,t),O(o,l,u,p,b,r,s[0],i,a.name)),l.restore(),l.beginPath()}}function d(o,t,e,n,i){for(var a,s,l,r,u,p,c,d,a=o.Fi(),s=o.Dn,l=_.I.fl("gc-selection"),r=parseInt(l.zIndex,10),u=0;u<=2;u++)for(p=0;p<=2;p++)(c=a.c9(u,p))&&0!==c.width&&0!==c.height&&(d=s.uO(u,p,i))&&b(o,a,s,r,c,t,e,n,d,u,p)}function f(o,t){var e,e,t,n,i,a,s,l,r,t,t,t;if(o)return(e=null==(e=t.Dn)?void 0:e.E7)?(t=t.ot(),n=_.Bf.Kl(e),i=_.Bf.Jl(e),a=o.x,s=o.y,l=o.width,r=o.height,1!==n&&(a*=n,s*=i,l*=n,r*=i,t=new _.Rect(t.x*n,t.y*i,t.width*n,t.height*i)),(t=t.getIntersect(a,s,l,r))?(t.round(),a=t.x,s=t.y,l=t.width,r=t.height,(t=e.width)&&t<a+l&&(a=t-l)<0&&(l+=a,a=0),(t=e.height)&&t<s+r&&(s=t-r)<0&&(r+=s,s=0),new _.Rect(a/n,s/i,l/n,r/i)):void 0):new _.Rect(o.x,o.y,o.width,o.height)}Object.defineProperty(t,"__esModule",{value:!0}),t.BrowsingMode=t.PermissionTypes=void 0,n=e("Common"),_=e("Core"),i=e("CollaborationTypes"),Object.defineProperty(t,"BrowsingMode",{enumerable:!0,get:function(){return i.BrowsingMode}}),Object.defineProperty(t,"PermissionTypes",{enumerable:!0,get:function(){return i.PermissionTypes}}),e=n.Common.ft,m=e._,y=e.j,p=_.W.B2e,c=_.W.V,_.Workbook.prototype.updatePresences=function(o){var o,t,t=this;t.joo=o,null!=(o=t.getActiveSheet())&&o.repaint()},_.Workbook.prototype.bindUser=function(o){var t,t,e,e=this;(null==(t=null==o?void 0:o.permission)?void 0:t.mode)===i.BrowsingMode.view&&(o.permission.viewModePermissions=o.permission.viewModePermissions?o.permission.viewModePermissions|i.PermissionTypes.allowNonDataModifyingOperations:i.PermissionTypes.allowNonDataModifyingOperations),e.moo=o,e.ki(_.Events.UserInfoChanged,{user:o}),null!=(t=e.getActiveSheet())&&t.repaint()},_.Worksheet.ch("PAINT_USER_SELECTION",{beforePaintAdornment:function(o){var e,t,n,i,a,s,l,e=this;try{(t=e.parent)&&(n=t.joo,i=t.moo||{},a=e.jKe(),n)&&(s=o.ctx,l=f(o.clipRect,e),n.forEach(function(o){var o,t,o,t=(0,_.RF)(o.user||{});t.id!==i.id&&(o=null==(o=o.status)?void 0:o.selections).sheetId===a&&(t.name=t.name||"Guest"+r()+r()+r(),t.color=t.color||u(t.name,t.id),d(e,t,o.selections,s,l))}))}catch(o){}}})},"./dist/plugins/collaboration/ssjson-convert/from/chart.js":function(o,t,e){"use strict";var n,i;function a(o,t,e){t=t||(0,i.buildIdMapByWorkbook)(e),(0,n.traverseChartFormula)(o,function(o){s(o,t)})}function s(o,t){o&&(void 0!==o.formulaInfo?(o.f=(0,i.unparseFormulaInfoImp)(o.formulaInfo,t),delete o.formulaInfo):void 0!==o.txFormulaInfo?(o.formula=(0,i.unparseFormulaInfoImp)(o.txFormulaInfo,t),delete o.txFormulaInfo):void 0!==o.strDimFormulaInfo?(o.strDim=(0,i.unparseFormulaInfoImp)(o.strDimFormulaInfo,t),delete o.strDimFormulaInfo):void 0!==o.numDimFormulaInfo&&(o.numDim=(0,i.unparseFormulaInfoImp)(o.numDimFormulaInfo,t),delete o.numDimFormulaInfo))}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseChartNodeUnparseFormula=t.unparseChartFormulaNodes=void 0,n=e("./dist/plugins/collaboration/util/chart-util.js"),i=e("./dist/plugins/collaboration/util/formula-info/util.js"),t.unparseChartFormulaNodes=a,t.traverseChartNodeUnparseFormula=s},"./dist/plugins/collaboration/ssjson-convert/from/table.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unparseTableFormulaNodes=void 0;var n=e("./dist/plugins/collaboration/util/formula-info/util.js");function i(o,t,e){t=t||(0,n.buildIdMapByWorkbook)(e),o.columns.forEach(function(o){a(o,t)})}function a(o,t){o&&(void 0!==o.footerFormulaInfo&&(o.footerFormula=(0,n.unparseFormulaInfoImp)(o.footerFormulaInfo,t),delete o.footerFormulaInfo),void 0!==o.dataAreaFormulaInfo)&&(o.dataAreaFormula=(0,n.unparseFormulaInfoImp)(o.dataAreaFormulaInfo,t),delete o.dataAreaFormulaInfo)}t.unparseTableFormulaNodes=i},"./dist/plugins/collaboration/ssjson-convert/from/workbook.js":function(o,t,e){"use strict";var n,i;function a(o,t){return s(o)?(o.names&&o.names.forEach(function(o){o.formulaInfo&&(o.formula=(0,n.unparseFormulaInfoImp)(o.formulaInfo,t))}),o.sheets&&Object.values(o.sheets).forEach(function(o){(0,i.convertFromSheetCollaborationJSON)(o,t)}),u(o)):o}function s(o){return!!o.collaborationInfo}function l(o){var t,o,t={sheet:{},table:{},tableColumn:{}},o=o.sheets;return o&&Object.values(o).forEach(function(o){t.sheet[o.__ID__]=o.name,r(o,t)}),t}function r(o,e){var o=o.tables;o&&o.forEach(function(o){var t,o,t=o.__ID__;e.table[t]=o.name,e.tableColumn[t]={},(o=o.columns)&&o.forEach(function(o){e.tableColumn[t][o.__ID__]=o.name})})}function u(o){var t,e,n,t=o.sheets;for(e in t)e in t&&(t[(n=t[e]).name]=t[e],delete t[e]);return o}Object.defineProperty(t,"__esModule",{value:!0}),t.buildIdMap=t.isCollaborationJson=t.convertFromWorkbookCollaborationJSON=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),i=e("./dist/plugins/collaboration/ssjson-convert/from/worksheet.js"),t.convertFromWorkbookCollaborationJSON=a,t.isCollaborationJson=s,t.buildIdMap=l},"./dist/plugins/collaboration/ssjson-convert/from/worksheet.js":function(o,t,e){"use strict";var i,a,s;function n(o,n){var t,t,t,t;if(o)return o.names&&o.names.forEach(function(o){o.formulaInfo&&(o.formula=(0,i.unparseFormulaInfoImp)(o.formulaInfo,n))}),(t=null==(t=o.data)?void 0:t.dataTable)&&(0,i.traverseDataTable)(t,function(o,t,e){o.formulaInfo&&(o.formula=(0,i.unparseFormulaInfoImp)(o.formulaInfo,n),delete o.formulaInfo),o.arrayInfo&&(o.arrayInfo.row=t,o.arrayInfo.col=e)}),(t=o.shapes)&&t.forEach(function(o){var t,t,o,o,t,t;8===(null==(t=o.graphicFrame)?void 0:t.shapeType)&&(t=null==(o=null==(t=o.graphicFrame.graphic)?void 0:t.graphicData)?void 0:o.chart)&&(0,a.unparseChartFormulaNodes)(null==(t=null==(o=null==t?void 0:t.chartSpace)?void 0:o.chart)?void 0:t.plotArea,n)}),(t=o.tables)&&t.forEach(function(o){(0,s.unparseTableFormulaNodes)(o,n)}),o}Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromSheetCollaborationJSON=void 0,i=e("./dist/plugins/collaboration/util/formula-info/util.js"),a=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),s=e("./dist/plugins/collaboration/ssjson-convert/from/table.js"),t.convertFromSheetCollaborationJSON=n},"./dist/plugins/collaboration/ssjson-convert/to/chart.js":function(o,t,e){"use strict";var n,i;function a(o,t){(0,n.traverseChartFormula)(o,function(o){s(o,t)})}function s(o,t){o&&(void 0!==o.f?(o.formulaInfo=(0,i.getFormulaInfo)(o.f,t),delete o.f):void 0!==o.formula?(o.txFormulaInfo=(0,i.getFormulaInfo)(o.formula,t),delete o.formula):void 0!==o.strDim?(o.strDimFormulaInfo=(0,i.getFormulaInfo)(o.strDim,t),delete o.strDim):void 0!==o.numDim&&(o.numDimFormulaInfo=(0,i.getFormulaInfo)(o.numDim,t),delete o.numDim))}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseChartNodeParseFormula=t.parseChartFormulaNodes=void 0,n=e("./dist/plugins/collaboration/util/chart-util.js"),i=e("./dist/plugins/collaboration/util/formula-info/util.js"),t.parseChartFormulaNodes=a,t.traverseChartNodeParseFormula=s},"./dist/plugins/collaboration/ssjson-convert/to/table.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTableFormulaNodes=void 0;var n=e("./dist/plugins/collaboration/util/formula-info/util.js");function i(o,t){o.columns.forEach(function(o){a(o,t)})}function a(o,t){o&&(void 0!==o.footerFormula&&(o.footerFormulaInfo=(0,n.getFormulaInfo)(o.footerFormula,t),delete o.footerFormula),void 0!==o.dataAreaFormula)&&(o.dataAreaFormulaInfo=(0,n.getFormulaInfo)(o.dataAreaFormula,t),delete o.dataAreaFormula)}t.parseTableFormulaNodes=i},"./dist/plugins/collaboration/ssjson-convert/to/workbook.js":function(o,t,e){"use strict";var n,i;function a(o,t){return o.names&&o.names.forEach(function(o){o.formula&&(o.formulaInfo=(0,n.getFormulaInfo)(o.formula,t,{}),delete o.formula)}),o.sheets&&Object.values(o.sheets).forEach(function(o){(0,i.convertToSheetCollaborationJSON)(o,t)}),s(o)}function s(o){var t,e,n,t=o.sheets;for(e in t)e in t&&(t[(n=t[e]).__ID__]=t[e],delete t[e]);return o}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToWorkbookCollaborationJSON=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/worksheet.js"),t.convertToWorkbookCollaborationJSON=a},"./dist/plugins/collaboration/ssjson-convert/to/worksheet.js":function(o,t,e){"use strict";var i,a,s;function n(o,n){var t,t,t,t,t,t;if(o)return o.rowCount=null!=(t=o.rowCount)?t:200,o.columnCount=null!=(t=o.columnCount)?t:20,o.names&&o.names.forEach(function(o){void 0!==o.formula&&(o.formulaInfo=(0,i.getFormulaInfo)(o.formula,n,{}),delete o.formula)}),(t=null==(t=o.data)?void 0:t.dataTable)&&(0,i.traverseDataTable)(t,function(o,t,e){void 0!==o.formula&&(o.formulaInfo=(0,i.getFormulaInfo)(o.formula,n,{row:t,col:e}),delete o.formula),o.arrayInfo&&(o.arrayInfo.row===t&&delete o.arrayInfo.row,o.arrayInfo.col===e)&&delete o.arrayInfo.col}),(t=o.shapes)&&t.forEach(function(o){var o,o,o;8===o.shapeType&&(o=o.shapeData.graphicFrame.graphicData.chart,(0,a.parseChartFormulaNodes)(null==(o=null==(o=o.chartSpace)?void 0:o.chart)?void 0:o.plotArea,n))}),(t=o.tables)&&t.forEach(function(o){(0,s.parseTableFormulaNodes)(o,n)}),o}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToSheetCollaborationJSON=void 0,i=e("./dist/plugins/collaboration/util/formula-info/util.js"),a=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),s=e("./dist/plugins/collaboration/ssjson-convert/to/table.js"),t.convertToSheetCollaborationJSON=n},"./dist/plugins/collaboration/util/chart-util.js":function(o,t){"use strict";function e(o,n){var t,t,o,t=null==o?void 0:o.chartGroups,o=null==o?void 0:o.plotAreaRegion;t?t.forEach(function(o){var o;null!=(o=o.ser)&&o.forEach(function(o){var t,t,t,t,t,t,o,e,e;[(null==(t=o.cat)?void 0:t.numRef)||(null==(t=o.cat)?void 0:t.strRef),null==(t=o.val)?void 0:t.numRef,null==(t=o.tx)?void 0:t.strRef,null==(t=o.bubbleSize)?void 0:t.numRef].forEach(function(o){void 0!==o&&n(o)}),null!=(o=null==(t=o.extLst)?void 0:t.ext)&&o.forEach(function(o){n(o.dataObject)})})}):o&&null!=(t=o.series)&&t.forEach(function(o){var t,o,t=o.formulaObj,o=o.tx;t&&(n(t.numDim),n(t.strDim)),o&&n(o.txData.f)})}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseChartFormula=void 0,t.traverseChartFormula=e},"./dist/plugins/collaboration/util/common.js":function(o,t,e){"use strict";var d,n,a;function i(o,t,e){var n,n,i,a,s,l,r,u,p,a=o.row,s=o.col,l=null!=(n=o.rowCount)?n:1,r=null!=(n=o.colCount)?n:1;if(0<=a&&0<=s)for(u=0;u<l;u++)for(p=0;p<r;p++)t(u+a,p+s,null==(i=null==e?void 0:e[u])?void 0:i[p]);else if(0<=a)for(u=0;u<l;u++)t(u+a,-1);else if(0<=s)for(p=0;p<r;p++)t(-1,p+s)}function s(o){return JSON.parse(JSON.stringify(o))}function l(o){return new n.Range(o.row,o.col,o.rowCount,o.colCount)}function r(t,e,n,o){var i=o.getSelections();o.Ut.setSelections(i.map(function(o){switch(o=l(o),t){case a.OpType.addRows:e<o.row?o.row+=n:e>=o.row&&e<o.row+o.rowCount&&(o.rowCount+=n);break;case a.OpType.addColumns:e<o.col?o.col+=n:e>=o.col&&e<o.col+o.colCount&&(o.colCount+=n);break;case a.OpType.deleteRows:if(e+n<o.row)o.row=Math.max(0,o.row-n);else if(e+n<o.row+o.rowCount)e<=o.row?(o.rowCount-=e+n-o.row,o.row=e):o.rowCount-=n;else{if(e<o.row)return null;e<o.row+o.rowCount&&(o.rowCount=e-o.row)}break;case a.OpType.deleteColumns:if(e+n<o.col)o.col=Math.max(0,o.col-n);else if(e+n<o.col+o.colCount)e<=o.col?(o.colCount-=e+n-o.col,o.col=e):o.colCount-=n;else{if(e<o.col)return null;e<o.col+o.colCount&&(o.colCount=e-o.col)}}return o}).filter(function(o){return null!==o})),o.jA(i)}function u(o,t){var e,n,i,a,s,l,r,u,p,c,e=o.row,n=o.col,i=o.rowCount,a=o.colCount,s=o.sheetArea,l=t.row,r=t.col,u=t.rowCount,p=t.colCount,c=t.sheetArea;if(s===c){if(e===l&&i===u){if(n+a===r)return d(d({},o),{colCount:a+p});if(r+p===n)return d(d({},o),{col:r,colCount:a+p})}if(n===r&&a===p){if(e+i===l)return d(d({},o),{rowCount:i+u});if(l+u===e)return d(d({},o),{row:l,rowCount:i+u})}return b(o,t)?o:b(t,o)?t:void 0}}function b(o,t){var e=t.row,n=t.col,i=t.rowCount,a=t.colCount;return(-1===o.row&&-1===t.row||o.row<=t.row&&e+i<=o.row+o.rowCount)&&(-1===o.col&&-1===t.col||o.col<=n&&n+a<=o.col+o.colCount)}function p(o,t){var e,n,o,t,i,e,a,s,l,n,e=o.target,n=t.target;return!!(e&&n&&c(o,t))&&(o=e.row,t=e.col,i=e.rowCount,e=e.colCount,a=n.row,s=n.col,l=n.rowCount,n=n.colCount,o===a)&&t===s&&i===l&&e===n}function c(o,t){var o,o,o,t,e,n,e,n;return(null!=(o=null==(o=o.target)?void 0:o.sheetArea)?o:3)===(null!=(t=null==(o=t.target)?void 0:o.sheetArea)?t:3)}d=this&&this.__assign||function(){return(d=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.isSameSheetArea=t.isSameTarget=t.mergeTarget=t.updateSelections=t.clone=t.forLoopRange=void 0,n=e("Core"),a=e("./dist/plugins/collaboration/enum.js"),t.forLoopRange=i,t.clone=s,t.updateSelections=r,t.mergeTarget=u,t.isSameTarget=p,t.isSameSheetArea=c},"./dist/plugins/collaboration/util/formula-info/formula-effect-info.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTableFormulaEffectInfo=t.woo=t.getSheetFormulaEffectInfo=void 0;var a=e("CalcEngine");function n(t){var o,e,o,e;return c(i(t),u(t.getParent(),function(o){var o;if(o.type===a.ExpressionType.reference)return(null==(o=o.source)?void 0:o.Mf)===t}))}function i(o){var t=new Set;return s(o,function(o){var o,o,o,o=null==(o=null==(o=null==o?void 0:o.w3)?void 0:o.rT)?void 0:o.Mf;o&&t.add(o.jKe())}),Array.from(t)}function s(o,t){for(var e,n,i,a,s,l,r,u,p,c,e=o.getRowCount(),n=o.getColumnCount(),i=o.b3(),a=0;a<e;a++)for(s=0;s<n;s++)if((l=i.oT(a,s))&&l.aT)for(r=l.aT,u=0;u<r.length;u++)(p=l[r[u]])&&p.forEach(t);if((c=i.uT())&&c.aT)for(r=c.aT,u=0;u<r.length;u++)(p=c[r[u]])&&p.forEach(function(o){o&&o.content.forEach(t)})}function l(t){var o,e,n,i,e,n,i;return c(r(t),u(null==(o=t.Mf)?void 0:o.getParent(),function(o){if(o.type===a.ExpressionType.structReference)return o.abt===t}))}function r(o){var t=new Set;return o.osr(function(o){var o,o,o,o=null==(o=null==(o=null==o?void 0:o.w3)?void 0:o.rT)?void 0:o.Mf;o&&t.add(o.jKe())}),Array.from(t)}function u(o,t){if(o){var e={};if(p(o.getCustomNames(),t)&&(e.workbook=!0),o.sheets.forEach(function(o){p(o.getCustomNames(),t)&&(e.sheets=e.sheets||[],e.sheets.push(o.jKe()))}),e.workbook||e.sheets)return e}}function p(o,e){return o&&o.some(function(o){var o,t,o=o.getExpression(),t=!1;return o&&o.forEachNodes(function(o){!t&&e(o)&&(t=!0)}),t})}function c(o,t){var e,n,e=!o||!o.length;if(!e||t)return n={sheets:{}},o&&o.forEach(function(o){n.sheets[o]||(n.sheets[o]={}),n.sheets[o].cells=!0}),t&&(t.workbook&&(n.workbook={customNames:!0}),t.sheets)&&t.sheets.forEach(function(o){n.sheets[o]||(n.sheets[o]={}),n.sheets[o].customNames=!0}),n}t.getSheetFormulaEffectInfo=n,t.woo=s,t.getTableFormulaEffectInfo=l},"./dist/plugins/collaboration/util/formula-info/formula-info-parse.js":function(o,t,e){"use strict";var n,i;function a(o,t){var t,e,n,t=l(t);return t&&0!==t.length?(e=s(o,t),n={},t.forEach(function(o,t){n["R"+t]=r(o)}),{refs:n,parts:e}):{refs:{},parts:[{text:o}]}}function s(e,o){var n,i,n=[],i=0;return o.forEach(function(o,t){i<o.lit&&n.push({text:e.slice(i,o.lit)}),n.push({ref:"R"+t}),i=o.ywt}),i<e.length&&n.push({text:e.slice(i)}),n}function l(o){var t=[];return o.forEachNodes(function(o){o.type===n.ExpressionType.reference&&t.push(o),o.type===n.ExpressionType.structReference&&t.push(o)}),t.sort(function(o,t){return o.lit-t.lit}),t}function r(o){return o.type===n.ExpressionType.reference?u(o):o.type===n.ExpressionType.structReference?p(o):void 0}function u(o){var t,e,n,t,e,e,t,t,n={type:0},t=o.source,e=null==t?void 0:t.Mf;return e?n.sheetId=e.jKe():t&&(n.sheetName=t.getName()),(t=null==(e=o.endSource)?void 0:e.Mf)?n.endSheetId=t.jKe():e&&(n.endSheetName=e.getName()),n.row=o.row,n.rowCount=(null!=(t=o.endRow)?t:o.row)-o.row+1,n.col=o.column,n.colCount=(null!=(e=o.endColumn)?e:o.column)-o.column+1,t=0,o.rowRelative&&(t|=2),o.columnRelative&&(t|=4),o.endRowRelative&&(t|=8),o.endColumnRelative&&(t|=16),o.isFullRow&&(t|=32,delete n.row,delete n.rowCount),o.isFullColumn&&(t|=64,delete n.col,delete n.colCount),n.flags=t,n}function p(o){var t,e,n,n,t={type:1},e=o.abt;return t.tableId=e.jKe(),t.referencePortions=c(o.hbt),(n=o.ubt)&&(t.columnId=e.getColumn(n).jKe()),(n=o.sbt)&&o.lbt===i.StructReferenceColumnSpecifier.ColumnRange&&(t.endColumnId=e.getColumn(n).jKe()),t}function c(o){var t=0;return o===i.StructReferencePortions.All?t|=14:o===i.StructReferencePortions.HeadersAndData?t|=6:o===i.StructReferencePortions.DataAndTotals?t|=12:o===i.StructReferencePortions.Headers?t|=2:o===i.StructReferencePortions.Data?t|=4:o===i.StructReferencePortions.Totals?t|=8:o===i.StructReferencePortions.ThisRow&&(t|=1),t}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormulaInfo=void 0,n=e("CalcEngine"),i=e("SheetsCalc"),t.createFormulaInfo=a},"./dist/plugins/collaboration/util/formula-info/formula-info-unparse.js":function(o,t,e){"use strict";var n,m,l,y,i,a,s,r,u;function p(t,e){return t.parts.map(function(o){return c(o,t,e)}).join("")}function c(o,t,e){return o.ref?d(t.refs[o.ref],e):o.text}function d(o,t){return o.invalidRef?y:0===o.type?b(o,t):1===o.type?v(o,t):void 0}function b(o,t){var e,n,i,a,s,l,r,u,e,p,c,r,d,b,f,v,g,j,o,e,e=o.invalidRef,n=o.flags,i=o.row,a=o.col,s=o.rowCount,l=o.colCount,r=o.sheetId,u=o.endSheetId;if(e)return y;if(e=function(o){return"function"==typeof t.sheet?t.sheet(o):t.sheet[o]},p="",r||o.sheetName){if(c=o.sheetName,r&&!(c=e(r)))return y;if(r=o.endSheetName,u&&!(r=e(u)))return y;p+=(0,m.Y3e)({lyt:!0},c.split(""),null==r?void 0:r.split("")).join("")+"!"}return d=i+s-1,b=a+l-1,f=!!(2&n),v=!!(4&n),g=!!(8&n),j=!!(16&n),o=function(){return h(i,a,f,v)},e=function(){return h(d,b,g,j)},p+=32&n?O(i,f)+":"+O(d,g):64&n?C(a,v)+":"+C(b,j):1===s&&1===l?o():o()+":"+e()}function h(o,t,e,n){return C(t,n)+O(o,e)}function O(o,t){var o=o+1+"";return t?o:"$"+o}function C(o,t){var o=f(o);return t?o:"$"+o}function f(o){return n.IndexHelper.nr(o)}function v(o,e){var t,n,i,i,a,s,a,s,t,n=function(o,t){var o;if(e.tableColumn)return"function"==typeof e.tableColumn?e.tableColumn(o,t):(o=e.tableColumn[o])&&o[t]},i=function(o){return"function"==typeof e.table?e.table(o):e.table[o]}(o.tableId);if(!i)return y;if(i=i+"[",a=o.referencePortions,s=o.columnId,0!==a&&(i+=g(a,!!s)),s){if(i+=j(a),!(a=n(o.tableId,s)))return y;if(i+="[".concat((0,l.getValidaColumnName)(a),"]"),o.endColumnId){if(!(s=n(o.tableId,o.endColumnId)))return y;i+=":[".concat((0,l.getValidaColumnName)(s),"]")}}return i+="]"}function g(o,t){var e="";return 2&o&&4&o&&8&o?e+=t?"[".concat(u,"]"):u:2&o&&4&o?e+="[".concat(a,"], [").concat(s,"]"):4&o&&8&o?e+="[".concat(s,"], [").concat(r,"]"):1&o?e+="[".concat(i,"]"):2&o?e+=t?"[".concat(a,"]"):a:4&o?e+=t?"[".concat(s,"]"):s:8&o&&(e+=t?"[".concat(r,"]"):r),e}function j(o){return 0===o?"":2&o&&4&o||4&o&&8&o?", ":","}Object.defineProperty(t,"__esModule",{value:!0}),t.formulaInfoToFormulaText=void 0,n=e("Core"),m=e("CalcEngine"),l=e("SheetsCalc"),y="#REF!",i="#This row",a="#Headers",s="#Data",r="#Totals",u="#All",t.formulaInfoToFormulaText=p},"./dist/plugins/collaboration/util/formula-info/util.js":function(o,t,e){"use strict";var i,a,n,s,l,r;function u(o,t,e){var e,t;return o?(e=(null==e?void 0:e.sheetArea)||3,(t=p(o=c(o,t,{row:0,col:0}),t,{sheetArea:e}))?(0,s.createFormulaInfo)(o,t):void 0):null}function p(o,t,e){var t=b(t,(e=e||{}).sheetArea),n=t.calcService,t=t.source;try{return d(n,t,o,0,0,i(i({},e),{needRecordStartEndIndex:!0}))}catch(o){}}function c(o,t,e){var t,n,t,i,e,a;if(!o)return null;n=(t=b(t)).calcService,t=t.source,null==(i=e.row)&&(i=0),null==(e=e.col)&&(e=0);try{return a=n.parse(t,o,i,e),n.unparse(t,a,i,e,!1,1)}catch(o){}}function d(o,t,e,n,i,a){var n,t,s,l,r,u,p,i,t=o.getParserContext(t),s=t.useR1C1,l=t.culture,r=t.row,u=t.column,p=t.Jde;return t.useR1C1=!1,t.culture=!1,t.ignoreError=a.ignoreError,t.row=n,t.column=i,t.Jde=null!=(n=a.needRecordStartEndIndex)&&n,i=o.j3t.parse(t,e),t.useR1C1=s,t.culture=l,t.row=r,t.column=u,t.Jde=p,i}function b(o,t){var e,o,n,e=o.Lp,o=o instanceof a.Worksheet?o:(0,a.jf)(o),n;return{calcService:e,source:o?o.Uw(t):null}}function f(t){var e;return t?(e={},t.sheets.forEach(function(o){o.tables.all().forEach(function(o){e[o.jKe()]=o})}),{sheet:function(o){var o;return null==(o=t.c_r(o))?void 0:o.name()},table:function(o){var o;return null==(o=e[o])?void 0:o.name()},tableColumn:function(o,t){var o,o,o=e[o];if(o=o&&o.jEr(t))return o.name()}}):{sheet:function(){return r},table:function(){return r},tableColumn:function(){return r}}}function v(o,t){var t;return o?(t=f(t),(0,n.formulaInfoToFormulaText)(o,t)):null}function g(o,t){return(0,n.formulaInfoToFormulaText)(o,t)}function j(o,n){o&&Object.entries(o).forEach(function(o){var e=o[0],o=o[1];o&&Object.entries(o).forEach(function(o){var t=o[0],o=o[1];o&&n(o,+e,+t)})})}function m(o,t){var t,t,e,t=t.c_r(o.sheetId),t=(0,l.getSheetFormulaEffectInfo)(t);t&&(e=o.payload,(e=o.payload?e:o.payload={}).formulaEffectInfo=t)}i=this&&this.__assign||function(){return(i=Object.assign||function(o){for(var t,e,n,i,e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.addFormulaEffectInfoToRowColOp=t.traverseDataTable=t.unparseFormulaInfoImp=t.unparseFormulaInfo=t.buildIdMapByWorkbook=t.parseExpressionImp=t.getFormulaInfo=void 0,a=e("Core"),n=e("./dist/plugins/collaboration/util/formula-info/formula-info-unparse.js"),s=e("./dist/plugins/collaboration/util/formula-info/formula-info-parse.js"),l=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),r=null,t.getFormulaInfo=u,t.parseExpressionImp=d,t.buildIdMapByWorkbook=f,t.unparseFormulaInfo=v,t.unparseFormulaInfoImp=g,t.traverseDataTable=j,t.addFormulaEffectInfoToRowColOp=m},"./dist/plugins/collaboration/util/stack.js":function(o,t){"use strict";var e;function n(){this.items=[]}Object.defineProperty(t,"__esModule",{value:!0}),t.Stack=void 0,n.prototype.push=function(o){this.items.push(o)},n.prototype.pop=function(){return this.items.pop()},n.prototype.peek=function(){return this.items[this.items.length-1]},n.prototype.isEmpty=function(){return 0===this.items.length},n.prototype.size=function(){return this.items.length},n.prototype.clear=function(){this.items=[]},n.prototype.toArray=function(){return this.items},t.Stack=n},"./node_modules_local/@spreadjs/js-sheets-collaboration-types/dist/index.js":function(o){var t,e,n,i;t=this,e=()=>(()=>{"use strict";var n={399:function(o,t,e){var n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e(735),t),i(e(225),t),i(e(73),t)},225:(o,t)=>{var e,n;Object.defineProperty(t,"__esModule",{value:!0}),t.OpType=void 0,n=t.OpType=e={addSheet:"addSheet",removeSheet:"removeSheet",clearSheets:"clearSheets",reorderSheetTabPosition:"reorderSheetTabPosition",setStartSheetIndex:"setStartSheetIndex",setActiveSheetId:"setActiveSheetId",setWorkbookOptions:"setWorkbookOptions",addNamedStyle:"addNamedStyle",removeNamedStyle:"removeNamedStyle",addSheetNamedStyle:"addSheetNamedStyle",removeSheetNamedStyle:"removeSheetNamedStyle",addCustomTheme:"addCustomTheme",removeCustomTheme:"removeCustomTheme",updateCustomTheme:"updateCustomTheme",addSheetTabStyle:"addSheetTabStyle",removeSheetTabStyle:"removeSheetTabStyle",clearSheetTabStyle:"clearSheetTabStyle",setDocProp:"setDocProp",setDocPropForApp:"setDocPropForApp",setDocPropForCore:"setDocPropForCore",addCustomDocProp:"addCustomDocProp",removeCustomDocProp:"removeCustomDocProp",clearCustomDocProp:"clearCustomDocProp",updateCustomDocProp:"updateCustomDocProp",setCustomDocProps:"setCustomDocProps",setTabSelected:"setTabSelected",setOrder:"setOrder",setName:"setName",setRange:"setRange",setCustomName:"setCustomName",setSheetScopeCustomName:"setSheetScopeCustomName",clearCustomName:"clearCustomName",clearSheetScopeCustomName:"clearSheetScopeCustomName",addRows:"addRows",deleteRows:"deleteRows",addSpan:"addSpan",removeSpan:"removeSpan",updateSpan:"updateSpan",addColumns:"addColumns",deleteColumns:"deleteColumns",setRowCount:"setRowCount",setColumnCount:"setColumnCount",setFrozen:"setFrozen",setFreeAreaCount:"setFreeAreaCount",setAxisSize:"setAxisSize",updateZoom:"updateZoom",setAxisOptions:"setAxisOptions",setHeaderFitMode:"setHeaderFitMode",setWorksheetOptions:"setWorksheetOptions",setCurrentTheme:"setCurrentTheme",clearRange:"clearRange",setSheetVisible:"setSheetVisible",setFileInfo:"setFileInfo",updateTopLeftPosition:"updateTopLeftPosition",swapNode:"swapNode",swapDefaultValueNode:"swapDefaultValueNode",swapComment:"swapComment",updateSortState:"updateSortState",addFilter:"addFilter",filterItemMap:"filterItemMap",filteredColumns:"filteredColumns",filterItems:"filterItems",filteredInRowsWithColIndices:"filteredInRowsWithColIndices",updateFilterSortInfo:"updateFilterSortInfo",updateFilterButtonVisibleInfo:"updateFilterButtonVisibleInfo",updateFilterRange:"updateFilterRange",filterRowVisibleInfo:"filterRowVisibleInfo",addGroup:"addGroup",removeGroup:"removeGroup",resetGroup:"resetGroup",updateCollapsed:"updateCollapsed",setDirection:"setDirection",showOutline:"showOutline",insertGroupItem:"insertGroupItem",deleteGroupItem:"deleteGroupItem",setRowColumnCountForOutline:"setRowColumnCountForOutline",addComment:"addComment",removeComment:"removeComment",updateComment:"updateComment",addRowsForComment:"addRowsForComment",addColumnsForComment:"addColumnsForComment",addFloatingObject:"addFloatingObject",updateFloatingObject:"updateFloatingObject",addSlicer:"addSlicer",removeSlicer:"removeSlicer",addSlicerCache:"addSlicerCache",removeSlicerCache:"removeSlicerCache",updateSlicer:"updateSlicer",updateSlicerCache:"updateSlicerCache",addTable:"addTable",removeTable:"removeTable",updateTableList:"updateTableList",showHeader:"showHeader",showFooter:"showFooter",setTableProperty:"setTableProperty",setLayoutStyle:"setLayoutStyle",updateTableRange:"updateTableRange",tableInsertRows:"tableInsertRows",useFooterDropDownList:"useFooterDropDownList",addTableColumn:"addTableColumn",setTableColumnProperty:"setTableColumnProperty",deleteTableColumn:"deleteTableColumn",addShape:"addShape",removeShape:"removeShape",zIndexShape:"zIndexShape",updateShapeProp:"updateShapeProp",updateShapeFormula:"updateShapeFormula",updateShapeAnchor:"updateShapeAnchor",groupShape_add:"groupShape_add",groupShape_remove:"groupShape_remove",groupShape_zIndex:"groupShape_zIndex",groupShape:"groupShape",unGroupShape:"unGroupShape",updateChart:"updateChart",addSeries:"addSeries",removeSeries:"removeSeries",updateSeries:"updateSeries",setLegend:"setLegend",setTitle:"setTitle",updatePlotArea:"updatePlotArea",changeChartType:"changeChartType",setChartArea:"setChartArea",setAxes:"setAxes",setChartOptions:"setChartOptions",setHoverStyle:"setHoverStyle",updateChartGroup:"updateChartGroup",addPivotCache:"addPivotCache",removePivotCache:"removePivotCache",updatePivotCache:"updatePivotCache",updatePivotCacheField:"updatePivotCacheField",addPivotTable:"addPivotTable",removePivotTable:"removePivotTable",updatePivotTableLayout:"updatePivotTableLayout",updateFieldsModel:"updateFieldsModel",addPivotField:"addPivotField",removePivotField:"removePivotField",addRule:"addRule",removeRuleByRange:"removeRuleByRange",updateRule:"updateRule",removeRule:"removeRule",clearRule:"clearRule",addAutoMerge:"addAutoMerge",removeAutoMerge:"removeAutoMerge",updateAutoMergeRangeInfos:"updateAutoMergeRangeInfos",addSparklineEx:"addSparklineEx",removeSparklineEx:"removeSparklineEx",updateSparklineGroup:"updateSparklineGroup",addSparklineGroup:"addSparklineGroup",removeSparklineGroup:"removeSparklineGroup",groupSparkline:"groupSparkline",addSparklineForGroup:"addSparklineForGroup",removeSparklineForGroup:"removeSparklineForGroup",clearSparklineForGroup:"clearSparklineForGroup",updateSparkline:"updateSparkline",addCellState:"addCellState",removeCellState:"removeCellState",setCellState:"setCellState",addDataValidator:"addDataValidator",updateDataValidator:"updateDataValidator",removeDataValidator:"removeDataValidator",removeDataValidatorRange:"removeDataValidatorRange",setHyperlink:"setHyperlink",setOutlineColumnOptions:"setOutlineColumnOptions",setRowCheckStatus:"setRowCheckStatus",setPrintInfo:"setPrintInfo",setPrintInfoOption:"setPrintInfoOption"}},735:(o,t)=>{var e,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.OpModule=t.OpSource=void 0,(t.OpSource=e={}).calc="calc",i=t.OpModule=n={workbook:"workbook",worksheet:"worksheet",filter:"filter",sort:"sort",outline:"outline",table:"table",slicer:"slicer",conditional:"conditional",shape:"shape",chart:"chart",floatingObject:"floatingObject",comment:"comment",sparkline:"sparkline",cellState:"cellState",hyperlink:"hyperlink",outlineColumn:"outlineColumn",validation:"validation",pivotCache:"pivotCache",pivotTable:"pivotTable",print:"print"}},73:(o,t)=>{var e,n,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionTypes=t.BrowsingMode=void 0,a=t.BrowsingMode=e={edit:0,0:"edit",view:1,1:"view"},i=t.PermissionTypes=n={allowNonDataModifyingOperations:1,1:"allowNonDataModifyingOperations",allowHideRowsOrColumns:2,2:"allowHideRowsOrColumns",allowResizeRowsOrColumns:4,4:"allowResizeRowsOrColumns",allowFilter:8,8:"allowFilter",allowSort:16,16:"allowSort"}},368:function(o,t,e){var n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e(399),t),i(e(191),t)},171:(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},191:function(o,t,e){var n=this&&this.__createBinding||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){o[n=void 0===n?e:n]=t[e]}),i=this&&this.__exportStar||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e(684),t),i(e(571),t),i(e(454),t),i(e(171),t)},571:(o,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),e(399)},684:(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},454:(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})}},i={};return function o(t){var e,e,e=i[t];return void 0!==e||(e=i[t]={exports:{}},n[t].call(e.exports,e,e.exports,o)),e.exports}(368)})(),o.exports=e()},Common:function(o){"use strict";o.exports=n.Spread},CalcEngine:function(o){"use strict";o.exports=n.Spread.CalcEngine},PivotTable:function(o){"use strict";o.exports=n.Spread.Pivot},Core:function(o){"use strict";o.exports=n.Spread.Sheets},SheetsCalc:function(o){"use strict";o.exports=n.Spread.Sheets.CalcEngine},Chart:function(o){"use strict";o.exports=n.Spread.Sheets.Charts},CollaborationTypes:function(o){"use strict";o.exports=n.Spread.Sheets.Collaboration},Comment:function(o){"use strict";o.exports=n.Spread.Sheets.Comments},ConditionalFormatting:function(o){"use strict";o.exports=n.Spread.Sheets.ConditionalFormatting},DataChart:function(o){"use strict";o.exports=n.Spread.Sheets.DataCharts},Validation:function(o){"use strict";o.exports=n.Spread.Sheets.DataValidation},Filters:function(o){"use strict";o.exports=n.Spread.Sheets.Filter},FloatingObject:function(o){"use strict";o.exports=n.Spread.Sheets.FloatingObjects},Outlines:function(o){"use strict";o.exports=n.Spread.Sheets.Outlines},Print:function(o){"use strict";o.exports=n.Spread.Sheets.Print},Shapes:function(o){"use strict";o.exports=n.Spread.Sheets.Shapes},Sparkline:function(o){"use strict";o.exports=n.Spread.Sheets.Sparklines},Touch:function(o){"use strict";o.exports=n.Spread.Sheets.Touch}},a={},o=e("./dist/plugins/collaboration/all-entry.js"),(((n=void 0===n?{}:n).Spread=n.Spread||{}).Sheets=n.Spread.Sheets||{}).Collaboration=o});